{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 5.173594951629639, "policy_loss": -0.03570510074496269, "vf_loss": 5.20890998840332, "vf_explained_var": -0.0019218686502426863, "kl": 0.001952442224137485, "entropy": 3.3653323650360107, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 5.747944355010986, "policy_loss": -0.029257724061608315, "vf_loss": 5.776775360107422, "vf_explained_var": -0.0012713352916762233, "kl": 0.0021356637589633465, "entropy": 3.36513090133667, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 4.9364776611328125, "policy_loss": -0.031661100685596466, "vf_loss": 4.967741012573242, "vf_explained_var": -0.003346393583342433, "kl": 0.00198944634757936, "entropy": 3.365274429321289, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 4.866876602172852, "policy_loss": -0.028991492465138435, "vf_loss": 4.895443439483643, "vf_explained_var": -0.0030849098693579435, "kl": 0.0021219796035438776, "entropy": 3.365161657333374, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 5.826654434204102, "policy_loss": -0.028718480840325356, "vf_loss": 5.854983806610107, "vf_explained_var": -0.008391622453927994, "kl": 0.0019458323949947953, "entropy": 3.3653414249420166, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 798.6709585613311, "num_env_steps_trained_throughput_per_sec": 798.6709585613311, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3968, "timers": {"training_iteration_time_ms": 5008.26, "sample_time_ms": 1247.376, "learn_time_ms": 3699.71, "learn_throughput": 1081.166, "synch_weights_time_ms": 20.37}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 3968, "num_agent_steps_trained": 3968}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-07", "timestamp": 1742309947, "time_this_iter_s": 5.0121119022369385, "time_total_s": 5.0121119022369385, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee176950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 5.0121119022369385, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.375, "ram_util_percent": 6.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8043477535247803, "policy_loss": -0.046605635434389114, "vf_loss": 2.850386381149292, "vf_explained_var": 0.00032049132278189063, "kl": 0.0056721908040344715, "entropy": 3.350531578063965, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3.613495111465454, "policy_loss": -0.03549609333276749, "vf_loss": 3.6485557556152344, "vf_explained_var": -0.014301217161118984, "kl": 0.0043565439991652966, "entropy": 3.354074716567993, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9654483795166016, "policy_loss": -0.044848814606666565, "vf_loss": 3.0098633766174316, "vf_explained_var": -6.566842057509348e-05, "kl": 0.004338673781603575, "entropy": 3.3547403812408447, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8179123401641846, "policy_loss": -0.04356931149959564, "vf_loss": 2.8610246181488037, "vf_explained_var": -0.006290541496127844, "kl": 0.0045671965926885605, "entropy": 3.352442502975464, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 2.1250669956207275, "policy_loss": -0.04689090698957443, "vf_loss": 2.1714792251586914, "vf_explained_var": -0.024488558992743492, "kl": 0.004786605481058359, "entropy": 3.351613998413086, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 7968, "num_agent_steps_trained": 7968}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7968, "num_agent_steps_trained": 7968, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1139.6223528846774, "num_env_steps_trained_throughput_per_sec": 1139.6223528846774, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 7968, "timers": {"training_iteration_time_ms": 4259.072, "sample_time_ms": 888.727, "learn_time_ms": 3331.964, "learn_throughput": 1200.493, "synch_weights_time_ms": 16.995}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 7968, "num_agent_steps_trained": 7968}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-20", "timestamp": 1742309960, "time_this_iter_s": 3.520491361618042, "time_total_s": 8.53260326385498, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee03add0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 8.53260326385498, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.666666666666664, "ram_util_percent": 6.272222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8019533157348633, "policy_loss": -0.0448702797293663, "vf_loss": 1.8462785482406616, "vf_explained_var": -0.005612128879874945, "kl": 0.005449278745800257, "entropy": 3.330179214477539, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.6013333797454834, "policy_loss": -0.04654892161488533, "vf_loss": 2.6476311683654785, "vf_explained_var": -0.01071997918188572, "kl": 0.005021166987717152, "entropy": 3.33760404586792, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.893890857696533, "policy_loss": -0.0538039356470108, "vf_loss": 2.947380542755127, "vf_explained_var": -0.010440099984407425, "kl": 0.0062908632680773735, "entropy": 3.3384811878204346, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.460622549057007, "policy_loss": -0.04363026097416878, "vf_loss": 2.5039212703704834, "vf_explained_var": 0.001152378274127841, "kl": 0.006633129436522722, "entropy": 3.3292174339294434, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.168414354324341, "policy_loss": -0.05007675290107727, "vf_loss": 2.2181293964385986, "vf_explained_var": -0.0007433673017658293, "kl": 0.007230024319142103, "entropy": 3.328974723815918, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 11968, "num_agent_steps_trained": 11968}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11968, "num_agent_steps_trained": 11968, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1148.8318248818555, "num_env_steps_trained_throughput_per_sec": 1148.8318248818555, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 11968, "timers": {"training_iteration_time_ms": 3999.967, "sample_time_ms": 757.208, "learn_time_ms": 3212.572, "learn_throughput": 1245.108, "synch_weights_time_ms": 15.583}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 11968, "num_agent_steps_trained": 11968}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-23", "timestamp": 1742309963, "time_this_iter_s": 3.496318817138672, "time_total_s": 12.028922080993652, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee176950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 12.028922080993652, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 10.299999999999999, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 4.323326110839844, "policy_loss": -0.04834471270442009, "vf_loss": 4.3709797859191895, "vf_explained_var": 0.0028357666451483965, "kl": 0.006907491013407707, "entropy": 3.308666467666626, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.656678676605225, "policy_loss": -0.05320112407207489, "vf_loss": 4.709546089172363, "vf_explained_var": 0.0027809469029307365, "kl": 0.006663086824119091, "entropy": 3.320223808288574, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7576992511749268, "policy_loss": -0.047701116651296616, "vf_loss": 3.8051395416259766, "vf_explained_var": -0.0022457214072346687, "kl": 0.0052161491475999355, "entropy": 3.323113203048706, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.164388656616211, "policy_loss": -0.04267165809869766, "vf_loss": 3.2066545486450195, "vf_explained_var": -0.0044281273148953915, "kl": 0.008103318512439728, "entropy": 3.302976369857788, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.014217376708984, "policy_loss": -0.04475834220647812, "vf_loss": 4.058635234832764, "vf_explained_var": -0.0006887628696858883, "kl": 0.006810211110860109, "entropy": 3.3043015003204346, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 15968, "num_agent_steps_trained": 15968}, "sampler_results": {"episode_reward_max": 173.7039011861891, "episode_reward_min": 155.12837053243487, "episode_reward_mean": 161.66367811212913, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 24.84808436337391, "agent_1": 25.812089144413278, "agent_2": 24.34946350135674, "agent_3": 28.4346524709383, "agent_4": 26.65365663541307}, "policy_reward_max": {"agent_0": 37.2996480838538, "agent_1": 38.10871663662456, "agent_2": 39.212746915965745, "agent_3": 39.66843000640978, "agent_4": 36.8665938656719}, "policy_reward_mean": {"agent_0": 31.996581107280125, "agent_1": 31.762834028539352, "agent_2": 31.35026118198674, "agent_3": 34.197131068386845, "agent_4": 32.356870725935906}, "custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "hist_stats": {"episode_reward": [155.12837053243487, 158.7021635099833, 155.32691819956642, 163.2333306249413, 173.7039011861891, 156.2563437013632, 163.53472312857068, 167.42367401398408], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [24.84808436337391, 27.78036170356448, 29.097403306503313, 34.26657744737128, 36.696319672402794, 30.55327402850571, 37.2996480838538, 35.43098025266568], "policy_agent_1_reward": [26.561151613470066, 38.10871663662456, 34.09989346704915, 28.953557596274116, 32.49358826121008, 30.941308150706462, 25.812089144413278, 37.132367358567095], "policy_agent_2_reward": [29.83494109923375, 26.382578047252046, 24.34946350135674, 34.47398817912334, 39.212746915965745, 35.20832322290204, 27.92073902548411, 33.419309464576166], "policy_agent_3_reward": [39.4474538351396, 34.34309477698054, 31.09800941214749, 38.88555076675954, 28.4346524709383, 30.064095351460303, 39.66843000640978, 31.63576192725921], "policy_agent_4_reward": [34.43673962121744, 32.08741234556153, 36.68214851250954, 26.65365663541307, 36.8665938656719, 29.489342947788437, 32.83381686840964, 29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365901741607376, "mean_inference_ms": 0.5307706786893953, "mean_action_processing_ms": 0.10216127390387295, "mean_env_wait_ms": 0.36414781550894015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012208819389343262, "StateBufferConnector_ms": 0.0030219554901123047, "ViewRequirementAgentConnector_ms": 0.08218526840209961}}, "episode_reward_max": 173.7039011861891, "episode_reward_min": 155.12837053243487, "episode_reward_mean": 161.66367811212913, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 24.84808436337391, "agent_1": 25.812089144413278, "agent_2": 24.34946350135674, "agent_3": 28.4346524709383, "agent_4": 26.65365663541307}, "policy_reward_max": {"agent_0": 37.2996480838538, "agent_1": 38.10871663662456, "agent_2": 39.212746915965745, "agent_3": 39.66843000640978, "agent_4": 36.8665938656719}, "policy_reward_mean": {"agent_0": 31.996581107280125, "agent_1": 31.762834028539352, "agent_2": 31.35026118198674, "agent_3": 34.197131068386845, "agent_4": 32.356870725935906}, "hist_stats": {"episode_reward": [155.12837053243487, 158.7021635099833, 155.32691819956642, 163.2333306249413, 173.7039011861891, 156.2563437013632, 163.53472312857068, 167.42367401398408], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [24.84808436337391, 27.78036170356448, 29.097403306503313, 34.26657744737128, 36.696319672402794, 30.55327402850571, 37.2996480838538, 35.43098025266568], "policy_agent_1_reward": [26.561151613470066, 38.10871663662456, 34.09989346704915, 28.953557596274116, 32.49358826121008, 30.941308150706462, 25.812089144413278, 37.132367358567095], "policy_agent_2_reward": [29.83494109923375, 26.382578047252046, 24.34946350135674, 34.47398817912334, 39.212746915965745, 35.20832322290204, 27.92073902548411, 33.419309464576166], "policy_agent_3_reward": [39.4474538351396, 34.34309477698054, 31.09800941214749, 38.88555076675954, 28.4346524709383, 30.064095351460303, 39.66843000640978, 31.63576192725921], "policy_agent_4_reward": [34.43673962121744, 32.08741234556153, 36.68214851250954, 26.65365663541307, 36.8665938656719, 29.489342947788437, 32.83381686840964, 29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5365901741607376, "mean_inference_ms": 0.5307706786893953, "mean_action_processing_ms": 0.10216127390387295, "mean_env_wait_ms": 0.36414781550894015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012208819389343262, "StateBufferConnector_ms": 0.0030219554901123047, "ViewRequirementAgentConnector_ms": 0.08218526840209961}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15968, "num_agent_steps_trained": 15968, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 993.1555021627803, "num_env_steps_trained_throughput_per_sec": 993.1555021627803, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 15968, "timers": {"training_iteration_time_ms": 4006.853, "sample_time_ms": 832.533, "learn_time_ms": 3148.063, "learn_throughput": 1270.623, "synch_weights_time_ms": 15.046}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 15968, "num_agent_steps_trained": 15968}, "done": false, "episodes_total": 8, "training_iteration": 4, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-27", "timestamp": 1742309967, "time_this_iter_s": 4.041955947875977, "time_total_s": 16.07087802886963, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 16.07087802886963, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.516666666666666, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3.6100149154663086, "policy_loss": -0.05212095379829407, "vf_loss": 3.661146402359009, "vf_explained_var": -0.026951074600219727, "kl": 0.009892798960208893, "entropy": 3.2633206844329834, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.600147008895874, "policy_loss": -0.05405125394463539, "vf_loss": 2.6538498401641846, "vf_explained_var": -0.0005738530890084803, "kl": 0.006971594877541065, "entropy": 3.297095537185669, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.282121181488037, "policy_loss": -0.045552436262369156, "vf_loss": 4.327356338500977, "vf_explained_var": 0.0022570528090000153, "kl": 0.006345957983285189, "entropy": 3.2978131771087646, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.829196453094482, "policy_loss": -0.04310275986790657, "vf_loss": 4.871952533721924, "vf_explained_var": -0.0038444295059889555, "kl": 0.006934165023267269, "entropy": 3.283266544342041, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.453258514404297, "policy_loss": -0.05259481444954872, "vf_loss": 4.505476474761963, "vf_explained_var": -0.008207830600440502, "kl": 0.007543083745986223, "entropy": 3.283142566680908, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "sampler_results": {"episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}}, "episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1148.3747937134185, "num_env_steps_trained_throughput_per_sec": 1148.3747937134185, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 19968, "timers": {"training_iteration_time_ms": 3902.11, "sample_time_ms": 772.178, "learn_time_ms": 3106.224, "learn_throughput": 1287.737, "synch_weights_time_ms": 14.549}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 19968, "num_agent_steps_trained": 19968}, "done": false, "episodes_total": 8, "training_iteration": 5, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-31", "timestamp": 1742309971, "time_this_iter_s": 3.4966468811035156, "time_total_s": 19.567524909973145, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee176950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 19.567524909973145, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.219999999999999, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3.236851215362549, "policy_loss": -0.05048317834734917, "vf_loss": 3.286360025405884, "vf_explained_var": -0.001274865004234016, "kl": 0.009745992720127106, "entropy": 3.215195417404175, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.0408453941345215, "policy_loss": -0.04974830895662308, "vf_loss": 3.0901684761047363, "vf_explained_var": -0.0025701108388602734, "kl": 0.008505859412252903, "entropy": 3.271944522857666, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.976743221282959, "policy_loss": -0.05388932302594185, "vf_loss": 3.0301127433776855, "vf_explained_var": -0.0012281977105885744, "kl": 0.010396359488368034, "entropy": 3.2493374347686768, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.759901762008667, "policy_loss": -0.05041847378015518, "vf_loss": 2.8098433017730713, "vf_explained_var": 0.00026256838464178145, "kl": 0.009540566243231297, "entropy": 3.2420060634613037, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.704953670501709, "policy_loss": -0.04551060125231743, "vf_loss": 2.7500529289245605, "vf_explained_var": 0.00276221358217299, "kl": 0.008234343491494656, "entropy": 3.2588469982147217, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 23968, "num_agent_steps_trained": 23968}, "sampler_results": {"episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}}, "episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23968, "num_agent_steps_trained": 23968, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1155.1883310749029, "num_env_steps_trained_throughput_per_sec": 1155.1883310749029, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 23968, "timers": {"training_iteration_time_ms": 3828.853, "sample_time_ms": 725.484, "learn_time_ms": 3081.033, "learn_throughput": 1298.266, "synch_weights_time_ms": 14.489}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 23968, "num_agent_steps_trained": 23968}, "done": false, "episodes_total": 8, "training_iteration": 6, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-34", "timestamp": 1742309974, "time_this_iter_s": 3.476196050643921, "time_total_s": 23.043720960617065, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee0768c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 23.043720960617065, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 3.17486834526062, "policy_loss": -0.05423784628510475, "vf_loss": 3.2281813621520996, "vf_explained_var": -0.0038522419054061174, "kl": 0.0092473104596138, "entropy": 3.167001485824585, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9544742107391357, "policy_loss": -0.05552271008491516, "vf_loss": 3.0095808506011963, "vf_explained_var": 0.0017224348848685622, "kl": 0.008328261785209179, "entropy": 3.233729124069214, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.5695128440856934, "policy_loss": -0.05906354635953903, "vf_loss": 3.62807297706604, "vf_explained_var": 0.000987989827990532, "kl": 0.010071106255054474, "entropy": 3.1989920139312744, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.4908924102783203, "policy_loss": -0.050566092133522034, "vf_loss": 3.5410423278808594, "vf_explained_var": -0.0008444865816272795, "kl": 0.008314675651490688, "entropy": 3.2100586891174316, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 2.7151122093200684, "policy_loss": -0.054861947894096375, "vf_loss": 2.7694780826568604, "vf_explained_var": -0.002490366343408823, "kl": 0.009924438782036304, "entropy": 3.2203962802886963, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 27968, "num_agent_steps_trained": 27968}, "sampler_results": {"episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "custom_metrics": {"num_batches_mean": 20.0, "num_batches_min": 20, "num_batches_max": 20}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}}, "episode_reward_max": 167.42367401398408, "episode_reward_min": 167.42367401398408, "episode_reward_mean": 167.42367401398408, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_max": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "policy_reward_mean": {"agent_0": 35.43098025266568, "agent_1": 37.132367358567095, "agent_2": 33.419309464576166, "agent_3": 31.63576192725921, "agent_4": 29.805255010915715}, "hist_stats": {"episode_reward": [167.42367401398408], "episode_lengths": [1995], "policy_agent_0_reward": [35.43098025266568], "policy_agent_1_reward": [37.132367358567095], "policy_agent_2_reward": [33.419309464576166], "policy_agent_3_reward": [31.63576192725921], "policy_agent_4_reward": [29.805255010915715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5304843172438439, "mean_inference_ms": 0.5139860136993881, "mean_action_processing_ms": 0.09820343314975813, "mean_env_wait_ms": 0.3602442772372969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014190673828125, "StateBufferConnector_ms": 0.0030660629272460938, "ViewRequirementAgentConnector_ms": 0.09339332580566406}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27968, "num_agent_steps_trained": 27968, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1153.1504583193405, "num_env_steps_trained_throughput_per_sec": 1153.1504583193405, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 27968, "timers": {"training_iteration_time_ms": 3777.403, "sample_time_ms": 696.247, "learn_time_ms": 3059.985, "learn_throughput": 1307.196, "synch_weights_time_ms": 14.254}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 27968, "num_agent_steps_trained": 27968}, "done": false, "episodes_total": 8, "training_iteration": 7, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-38", "timestamp": 1742309978, "time_this_iter_s": 3.482321262359619, "time_total_s": 26.526042222976685, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 26.526042222976685, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.319999999999999, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 6.27212381362915, "policy_loss": -0.050271421670913696, "vf_loss": 6.321455478668213, "vf_explained_var": -0.005113734398037195, "kl": 0.009392333216965199, "entropy": 3.1317336559295654, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.525362491607666, "policy_loss": -0.043210189789533615, "vf_loss": 5.568120002746582, "vf_explained_var": 0.0007506041438318789, "kl": 0.009065312333405018, "entropy": 3.1884403228759766, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.301762580871582, "policy_loss": -0.061338722705841064, "vf_loss": 6.362597465515137, "vf_explained_var": -0.0013092849403619766, "kl": 0.01006319746375084, "entropy": 3.148421287536621, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.965773582458496, "policy_loss": -0.045344769954681396, "vf_loss": 6.010666847229004, "vf_explained_var": 0.003990526311099529, "kl": 0.009028850123286247, "entropy": 3.1550042629241943, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.49845027923584, "policy_loss": -0.055343177169561386, "vf_loss": 6.553320407867432, "vf_explained_var": 0.0038175650406628847, "kl": 0.00945993047207594, "entropy": 3.181962013244629, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 31968, "num_agent_steps_trained": 31968}, "sampler_results": {"episode_reward_max": 275.7976807118233, "episode_reward_min": 237.70902917582663, "episode_reward_mean": 260.72612922396405, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 45.282247650381215, "agent_1": 46.05945223812669, "agent_2": 43.180470970464235, "agent_3": 38.88477092930053, "agent_4": 46.460192840034}, "policy_reward_max": {"agent_0": 66.48090472165524, "agent_1": 61.96693693835044, "agent_2": 63.31007651774266, "agent_3": 59.03826799527528, "agent_4": 62.564034673765946}, "policy_reward_mean": {"agent_0": 55.34665828153716, "agent_1": 54.74889015636597, "agent_2": 52.04508706011407, "agent_3": 45.89703360020906, "agent_4": 52.688460125737684}, "custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "hist_stats": {"episode_reward": [267.45375100956477, 271.27107605851745, 257.9739054968148, 254.0727750231212, 264.02860740006065, 257.5022089159836, 237.70902917582663, 275.7976807118233], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [45.282247650381215, 61.87385331095972, 66.48090472165524, 53.84864364300792, 48.76688287127462, 58.819690074275115, 48.26607856608982, 59.434965414653675], "policy_agent_1_reward": [59.44916537551043, 46.05945223812669, 57.9850150632763, 61.96693693835044, 52.77514521158025, 51.479611623736545, 47.91866531638386, 60.357129483963234], "policy_agent_2_reward": [63.31007651774266, 61.72145356328095, 43.180470970464235, 50.019645729270145, 50.62863408074894, 48.637276112857954, 51.59171383225287, 47.27142567429481], "policy_agent_3_reward": [42.22539597181281, 42.03408569338056, 42.48645756506185, 38.88477092930053, 49.293910562690876, 52.10543826508, 41.10794181907062, 59.03826799527528], "policy_agent_4_reward": [57.186865494117484, 59.58223125276943, 47.84105717635704, 49.352777783192074, 62.564034673765946, 46.460192840034, 48.824629642029386, 49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347494541541007, "mean_inference_ms": 0.4929747694106556, "mean_action_processing_ms": 0.10025519128144905, "mean_env_wait_ms": 0.22244545049412315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011499524116516113, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.0782465934753418}}, "episode_reward_max": 275.7976807118233, "episode_reward_min": 237.70902917582663, "episode_reward_mean": 260.72612922396405, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 45.282247650381215, "agent_1": 46.05945223812669, "agent_2": 43.180470970464235, "agent_3": 38.88477092930053, "agent_4": 46.460192840034}, "policy_reward_max": {"agent_0": 66.48090472165524, "agent_1": 61.96693693835044, "agent_2": 63.31007651774266, "agent_3": 59.03826799527528, "agent_4": 62.564034673765946}, "policy_reward_mean": {"agent_0": 55.34665828153716, "agent_1": 54.74889015636597, "agent_2": 52.04508706011407, "agent_3": 45.89703360020906, "agent_4": 52.688460125737684}, "hist_stats": {"episode_reward": [267.45375100956477, 271.27107605851745, 257.9739054968148, 254.0727750231212, 264.02860740006065, 257.5022089159836, 237.70902917582663, 275.7976807118233], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [45.282247650381215, 61.87385331095972, 66.48090472165524, 53.84864364300792, 48.76688287127462, 58.819690074275115, 48.26607856608982, 59.434965414653675], "policy_agent_1_reward": [59.44916537551043, 46.05945223812669, 57.9850150632763, 61.96693693835044, 52.77514521158025, 51.479611623736545, 47.91866531638386, 60.357129483963234], "policy_agent_2_reward": [63.31007651774266, 61.72145356328095, 43.180470970464235, 50.019645729270145, 50.62863408074894, 48.637276112857954, 51.59171383225287, 47.27142567429481], "policy_agent_3_reward": [42.22539597181281, 42.03408569338056, 42.48645756506185, 38.88477092930053, 49.293910562690876, 52.10543826508, 41.10794181907062, 59.03826799527528], "policy_agent_4_reward": [57.186865494117484, 59.58223125276943, 47.84105717635704, 49.352777783192074, 62.564034673765946, 46.460192840034, 48.824629642029386, 49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5347494541541007, "mean_inference_ms": 0.4929747694106556, "mean_action_processing_ms": 0.10025519128144905, "mean_env_wait_ms": 0.22244545049412315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011499524116516113, "StateBufferConnector_ms": 0.0030183792114257812, "ViewRequirementAgentConnector_ms": 0.0782465934753418}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31968, "num_agent_steps_trained": 31968, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 999.7975640103255, "num_env_steps_trained_throughput_per_sec": 999.7975640103255, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 31968, "timers": {"training_iteration_time_ms": 3805.318, "sample_time_ms": 739.455, "learn_time_ms": 3045.413, "learn_throughput": 1313.451, "synch_weights_time_ms": 14.257}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 31968, "num_agent_steps_trained": 31968}, "done": false, "episodes_total": 16, "training_iteration": 8, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-42", "timestamp": 1742309982, "time_this_iter_s": 4.0146324634552, "time_total_s": 30.540674686431885, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 30.540674686431885, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.799999999999999, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 5.376197338104248, "policy_loss": -0.056306131184101105, "vf_loss": 5.43143367767334, "vf_explained_var": -0.0026952987536787987, "kl": 0.010700572282075882, "entropy": 3.042018413543701, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.371603012084961, "policy_loss": -0.04518303647637367, "vf_loss": 4.41633415222168, "vf_explained_var": -0.005017632152885199, "kl": 0.009036147966980934, "entropy": 3.1367948055267334, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.303962230682373, "policy_loss": -0.049399156123399734, "vf_loss": 5.352843284606934, "vf_explained_var": -0.004410079214721918, "kl": 0.010367165319621563, "entropy": 3.0896832942962646, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.8746337890625, "policy_loss": -0.0472678579390049, "vf_loss": 6.921483039855957, "vf_explained_var": -0.006882917135953903, "kl": 0.008375418372452259, "entropy": 3.102465867996216, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.425784587860107, "policy_loss": -0.04808027669787407, "vf_loss": 5.473358631134033, "vf_explained_var": -0.005765626672655344, "kl": 0.010133715346455574, "entropy": 3.1234829425811768, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 35968, "num_agent_steps_trained": 35968}, "sampler_results": {"episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}}, "episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35968, "num_agent_steps_trained": 35968, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1149.0005905528124, "num_env_steps_trained_throughput_per_sec": 1149.0005905528124, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 35968, "timers": {"training_iteration_time_ms": 3769.31, "sample_time_ms": 712.733, "learn_time_ms": 3036.856, "learn_throughput": 1317.152, "synch_weights_time_ms": 14.093}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 35968, "num_agent_steps_trained": 35968}, "done": false, "episodes_total": 16, "training_iteration": 9, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-46", "timestamp": 1742309986, "time_this_iter_s": 3.494722843170166, "time_total_s": 34.03539752960205, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 34.03539752960205, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 10.219999999999999, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 6.584009170532227, "policy_loss": -0.06603266298770905, "vf_loss": 6.648931980133057, "vf_explained_var": -2.9253107641125098e-05, "kl": 0.011102239601314068, "entropy": 2.9542438983917236, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.9531617164611816, "policy_loss": -0.04939927160739899, "vf_loss": 4.002042293548584, "vf_explained_var": 0.0029905952978879213, "kl": 0.010387947782874107, "entropy": 3.0730109214782715, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.516087532043457, "policy_loss": -0.052342791110277176, "vf_loss": 4.567928791046143, "vf_explained_var": -0.0045351143926382065, "kl": 0.010043217800557613, "entropy": 3.031714916229248, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.64487886428833, "policy_loss": -0.05388575792312622, "vf_loss": 5.698153972625732, "vf_explained_var": 0.0026427661068737507, "kl": 0.012217264622449875, "entropy": 3.012441396713257, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 4.612855911254883, "policy_loss": -0.05245107784867287, "vf_loss": 4.664748668670654, "vf_explained_var": 0.0035846452228724957, "kl": 0.011169790290296078, "entropy": 3.048964262008667, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 39968, "num_agent_steps_trained": 39968}, "sampler_results": {"episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}}, "episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39968, "num_agent_steps_trained": 39968, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1138.992499189063, "num_env_steps_trained_throughput_per_sec": 1138.992499189063, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 39968, "timers": {"training_iteration_time_ms": 3743.559, "sample_time_ms": 690.511, "learn_time_ms": 3033.923, "learn_throughput": 1318.425, "synch_weights_time_ms": 13.934}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 39968, "num_agent_steps_trained": 39968}, "done": false, "episodes_total": 16, "training_iteration": 10, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-49", "timestamp": 1742309989, "time_this_iter_s": 3.523352861404419, "time_total_s": 37.55875039100647, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 37.55875039100647, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 10.179999999999998, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 6.151010513305664, "policy_loss": -0.051115117967128754, "vf_loss": 6.200934886932373, "vf_explained_var": -0.0014450200833380222, "kl": 0.01190576795488596, "entropy": 2.8835697174072266, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.181349277496338, "policy_loss": -0.04515616595745087, "vf_loss": 5.226093769073486, "vf_explained_var": 0.0011385353282094002, "kl": 0.008220979943871498, "entropy": 3.010159492492676, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 3.965496301651001, "policy_loss": -0.04702607914805412, "vf_loss": 4.01194429397583, "vf_explained_var": -0.00226933928206563, "kl": 0.011559773236513138, "entropy": 2.9474031925201416, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.239844799041748, "policy_loss": -0.05082785338163376, "vf_loss": 5.290014743804932, "vf_explained_var": 0.001456947298720479, "kl": 0.013149525038897991, "entropy": 2.8739566802978516, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.5386881828308105, "policy_loss": -0.06424777954816818, "vf_loss": 5.602241516113281, "vf_explained_var": -0.0009724367409944534, "kl": 0.013890935108065605, "entropy": 2.955203056335449, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 43968, "num_agent_steps_trained": 43968}, "sampler_results": {"episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "custom_metrics": {"num_batches_mean": 21.0, "num_batches_min": 21, "num_batches_max": 21}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}}, "episode_reward_max": 275.7976807118233, "episode_reward_min": 275.7976807118233, "episode_reward_mean": 275.7976807118233, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_max": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "policy_reward_mean": {"agent_0": 59.434965414653675, "agent_1": 60.357129483963234, "agent_2": 47.27142567429481, "agent_3": 59.03826799527528, "agent_4": 49.69589214363609}, "hist_stats": {"episode_reward": [275.7976807118233], "episode_lengths": [1995], "policy_agent_0_reward": [59.434965414653675], "policy_agent_1_reward": [60.357129483963234], "policy_agent_2_reward": [47.27142567429481], "policy_agent_3_reward": [59.03826799527528], "policy_agent_4_reward": [49.69589214363609]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261050078666857, "mean_inference_ms": 0.47417039783022996, "mean_action_processing_ms": 0.09483446094042895, "mean_env_wait_ms": 0.21761895656228156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07300376892089844}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43968, "num_agent_steps_trained": 43968, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1150.8085051041132, "num_env_steps_trained_throughput_per_sec": 1150.8085051041132, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 43968, "timers": {"training_iteration_time_ms": 3590.31, "sample_time_ms": 615.869, "learn_time_ms": 2960.013, "learn_throughput": 1351.345, "synch_weights_time_ms": 13.177}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 43968, "num_agent_steps_trained": 43968}, "done": false, "episodes_total": 16, "training_iteration": 11, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-53", "timestamp": 1742309993, "time_this_iter_s": 3.488499164581299, "time_total_s": 41.04724955558777, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee176950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 41.04724955558777, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 10.18, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.012980461120605, "policy_loss": -0.04126213490962982, "vf_loss": 8.053072929382324, "vf_explained_var": -0.00014789360284339637, "kl": 0.011690933257341385, "entropy": 2.809830665588379, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.712264537811279, "policy_loss": -0.04649536311626434, "vf_loss": 7.758147239685059, "vf_explained_var": -0.0006229528225958347, "kl": 0.012253925204277039, "entropy": 2.9108686447143555, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.260494232177734, "policy_loss": -0.04197104275226593, "vf_loss": 8.301952362060547, "vf_explained_var": 0.000835498736705631, "kl": 0.010248180478811264, "entropy": 2.8753092288970947, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.300102233886719, "policy_loss": -0.04589151591062546, "vf_loss": 7.345526218414307, "vf_explained_var": 0.0019202301045879722, "kl": 0.009354088455438614, "entropy": 2.752140998840332, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.005959510803223, "policy_loss": -0.04252927750349045, "vf_loss": 8.047924995422363, "vf_explained_var": -0.0007155310595408082, "kl": 0.011292262002825737, "entropy": 2.8573007583618164, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 47968, "num_agent_steps_trained": 47968}, "sampler_results": {"episode_reward_max": 459.15509207199375, "episode_reward_min": 415.83004837915547, "episode_reward_mean": 435.2761417239651, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 87.14597103375401, "agent_1": 74.07287483895118, "agent_2": 90.49495468656566, "agent_3": 64.22450693666167, "agent_4": 73.65571475946705}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 109.57497561461112, "agent_3": 85.27828144329902, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 90.64643968853633, "agent_1": 91.51454185234903, "agent_2": 98.31274892717788, "agent_3": 71.63038561660817, "agent_4": 83.17202563929396}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [445.76009965799153, 419.1377692749342, 418.0324169019611, 446.7866971238187, 447.39454713337915, 415.83004837915547, 430.1124632484871, 459.15509207199375], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [88.62710111555133, 87.14597103375401, 89.34252422789572, 90.10261197411162, 92.6005664385916, 87.21783189956233, 91.45951381354965, 98.67539700527439], "policy_agent_1_reward": [90.68903100354996, 94.06810730982582, 74.07287483895118, 100.25399842497916, 95.69736309799903, 87.62734056000282, 88.70587199958402, 101.00174758390023], "policy_agent_2_reward": [109.57497561461112, 92.30401953020544, 98.37715457044531, 96.40344501505874, 90.49495468656566, 103.1046542234622, 93.38510775254073, 102.85768002453385], "policy_agent_3_reward": [69.49575870279432, 68.67668835212658, 71.89976023239866, 73.04369881892396, 85.27828144329902, 64.22450693666167, 73.00516009977468, 67.41923034688644], "policy_agent_4_reward": [87.37323322148508, 76.9429830490223, 84.34010303227069, 86.98294289074539, 83.32338146692393, 73.65571475946705, 83.55680958303833, 89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325338598530087, "mean_inference_ms": 0.47639864541117183, "mean_action_processing_ms": 0.09877676070680064, "mean_env_wait_ms": 0.17459400791542629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011232495307922363, "StateBufferConnector_ms": 0.00284731388092041, "ViewRequirementAgentConnector_ms": 0.07660806179046631}}, "episode_reward_max": 459.15509207199375, "episode_reward_min": 415.83004837915547, "episode_reward_mean": 435.2761417239651, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 87.14597103375401, "agent_1": 74.07287483895118, "agent_2": 90.49495468656566, "agent_3": 64.22450693666167, "agent_4": 73.65571475946705}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 109.57497561461112, "agent_3": 85.27828144329902, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 90.64643968853633, "agent_1": 91.51454185234903, "agent_2": 98.31274892717788, "agent_3": 71.63038561660817, "agent_4": 83.17202563929396}, "hist_stats": {"episode_reward": [445.76009965799153, 419.1377692749342, 418.0324169019611, 446.7866971238187, 447.39454713337915, 415.83004837915547, 430.1124632484871, 459.15509207199375], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [88.62710111555133, 87.14597103375401, 89.34252422789572, 90.10261197411162, 92.6005664385916, 87.21783189956233, 91.45951381354965, 98.67539700527439], "policy_agent_1_reward": [90.68903100354996, 94.06810730982582, 74.07287483895118, 100.25399842497916, 95.69736309799903, 87.62734056000282, 88.70587199958402, 101.00174758390023], "policy_agent_2_reward": [109.57497561461112, 92.30401953020544, 98.37715457044531, 96.40344501505874, 90.49495468656566, 103.1046542234622, 93.38510775254073, 102.85768002453385], "policy_agent_3_reward": [69.49575870279432, 68.67668835212658, 71.89976023239866, 73.04369881892396, 85.27828144329902, 64.22450693666167, 73.00516009977468, 67.41923034688644], "policy_agent_4_reward": [87.37323322148508, 76.9429830490223, 84.34010303227069, 86.98294289074539, 83.32338146692393, 73.65571475946705, 83.55680958303833, 89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5325338598530087, "mean_inference_ms": 0.47639864541117183, "mean_action_processing_ms": 0.09877676070680064, "mean_env_wait_ms": 0.17459400791542629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011232495307922363, "StateBufferConnector_ms": 0.00284731388092041, "ViewRequirementAgentConnector_ms": 0.07660806179046631}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47968, "num_agent_steps_trained": 47968, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1001.4195298707119, "num_env_steps_trained_throughput_per_sec": 1001.4195298707119, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 47968, "timers": {"training_iteration_time_ms": 3638.748, "sample_time_ms": 665.849, "learn_time_ms": 2958.639, "learn_throughput": 1351.973, "synch_weights_time_ms": 13.119}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 47968, "num_agent_steps_trained": 47968}, "done": false, "episodes_total": 24, "training_iteration": 12, "trial_id": "72c65_00000", "date": "2025-03-18_15-59-57", "timestamp": 1742309997, "time_this_iter_s": 4.00776219367981, "time_total_s": 45.05501174926758, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee0763b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 45.05501174926758, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 9.683333333333334, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 7.5142316818237305, "policy_loss": -0.0422697439789772, "vf_loss": 7.5554728507995605, "vf_explained_var": -0.0005524595617316663, "kl": 0.010286716744303703, "entropy": 2.710158586502075, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.708706378936768, "policy_loss": -0.04564080387353897, "vf_loss": 6.7538347244262695, "vf_explained_var": 0.0007150689489208162, "kl": 0.010254229418933392, "entropy": 2.8036952018737793, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.862722396850586, "policy_loss": -0.05718575417995453, "vf_loss": 6.919242858886719, "vf_explained_var": -0.005095557775348425, "kl": 0.013320660218596458, "entropy": 2.756516695022583, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.176493167877197, "policy_loss": -0.04606118053197861, "vf_loss": 7.222045421600342, "vf_explained_var": -0.0023741316981613636, "kl": 0.010174139402806759, "entropy": 2.644021511077881, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.078334331512451, "policy_loss": -0.05263110250234604, "vf_loss": 6.130202293395996, "vf_explained_var": 0.0001341269089607522, "kl": 0.015251191332936287, "entropy": 2.6894426345825195, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 51968, "num_agent_steps_trained": 51968}, "sampler_results": {"episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}}, "episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51968, "num_agent_steps_trained": 51968, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1150.0797374695912, "num_env_steps_trained_throughput_per_sec": 1150.0797374695912, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 51968, "timers": {"training_iteration_time_ms": 3638.37, "sample_time_ms": 668.962, "learn_time_ms": 2955.136, "learn_throughput": 1353.576, "synch_weights_time_ms": 13.11}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 51968, "num_agent_steps_trained": 51968}, "done": false, "episodes_total": 24, "training_iteration": 13, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-01", "timestamp": 1742310001, "time_this_iter_s": 3.490368604660034, "time_total_s": 48.54538035392761, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee176950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 48.54538035392761, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 10.22, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 7.7034406661987305, "policy_loss": -0.036666061729192734, "vf_loss": 7.739037990570068, "vf_explained_var": -0.0010708834743127227, "kl": 0.010687630623579025, "entropy": 2.6252782344818115, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.669923782348633, "policy_loss": -0.046718038618564606, "vf_loss": 7.7160515785217285, "vf_explained_var": -0.004203365184366703, "kl": 0.011801943182945251, "entropy": 2.6432361602783203, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.357178688049316, "policy_loss": -0.04830792918801308, "vf_loss": 7.40486478805542, "vf_explained_var": -7.441015623044223e-05, "kl": 0.012443727813661098, "entropy": 2.654310941696167, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.674918174743652, "policy_loss": -0.04776544123888016, "vf_loss": 6.722066402435303, "vf_explained_var": -0.001302301068790257, "kl": 0.01233979593962431, "entropy": 2.565048933029175, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.074542045593262, "policy_loss": -0.04757161810994148, "vf_loss": 8.121573448181152, "vf_explained_var": 1.6329970094375312e-05, "kl": 0.010783822275698185, "entropy": 2.6040103435516357, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 55968, "num_agent_steps_trained": 55968}, "sampler_results": {"episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}}, "episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55968, "num_agent_steps_trained": 55968, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1161.2977267528001, "num_env_steps_trained_throughput_per_sec": 1161.2977267528001, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 55968, "timers": {"training_iteration_time_ms": 3580.053, "sample_time_ms": 611.766, "learn_time_ms": 2953.655, "learn_throughput": 1354.254, "synch_weights_time_ms": 13.437}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 55968, "num_agent_steps_trained": 55968}, "done": false, "episodes_total": 24, "training_iteration": 14, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-04", "timestamp": 1742310004, "time_this_iter_s": 3.456056594848633, "time_total_s": 52.001436948776245, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee0763b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 52.001436948776245, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 10.280000000000001, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.174674034118652, "policy_loss": -0.04297126457095146, "vf_loss": 8.216618537902832, "vf_explained_var": -0.0010240277042612433, "kl": 0.010256465524435043, "entropy": 2.448878049850464, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.526442527770996, "policy_loss": -0.044145695865154266, "vf_loss": 8.570151329040527, "vf_explained_var": 7.067635306157172e-05, "kl": 0.008759072050452232, "entropy": 2.5402896404266357, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 5.311836242675781, "policy_loss": -0.04659910500049591, "vf_loss": 5.357751846313477, "vf_explained_var": 0.00029292446561157703, "kl": 0.013662581332027912, "entropy": 2.581165075302124, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.305298805236816, "policy_loss": -0.043432921171188354, "vf_loss": 7.34816312789917, "vf_explained_var": -0.0009004550520330667, "kl": 0.011381844989955425, "entropy": 2.3501362800598145, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.799938201904297, "policy_loss": -0.04931482672691345, "vf_loss": 7.8487548828125, "vf_explained_var": 0.00013820444291923195, "kl": 0.009959598071873188, "entropy": 2.552750587463379, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 59968, "num_agent_steps_trained": 59968}, "sampler_results": {"episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}}, "episode_reward_max": 459.15509207199375, "episode_reward_min": 459.15509207199375, "episode_reward_mean": 459.15509207199375, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_max": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "policy_reward_mean": {"agent_0": 98.67539700527439, "agent_1": 101.00174758390023, "agent_2": 102.85768002453385, "agent_3": 67.41923034688644, "agent_4": 89.20103711139892}, "hist_stats": {"episode_reward": [459.15509207199375], "episode_lengths": [1995], "policy_agent_0_reward": [98.67539700527439], "policy_agent_1_reward": [101.00174758390023], "policy_agent_2_reward": [102.85768002453385], "policy_agent_3_reward": [67.41923034688644], "policy_agent_4_reward": [89.20103711139892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5243143187505248, "mean_inference_ms": 0.4572850468754272, "mean_action_processing_ms": 0.09361014249344267, "mean_env_wait_ms": 0.1707343613380314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01102447509765625, "StateBufferConnector_ms": 0.0025844573974609375, "ViewRequirementAgentConnector_ms": 0.07323265075683594}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59968, "num_agent_steps_trained": 59968, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1171.320751344729, "num_env_steps_trained_throughput_per_sec": 1171.320751344729, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 59968, "timers": {"training_iteration_time_ms": 3573.228, "sample_time_ms": 608.423, "learn_time_ms": 2949.905, "learn_throughput": 1355.976, "synch_weights_time_ms": 13.678}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 59968, "num_agent_steps_trained": 59968}, "done": false, "episodes_total": 24, "training_iteration": 15, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-08", "timestamp": 1742310008, "time_this_iter_s": 3.426908254623413, "time_total_s": 55.42834520339966, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 55.42834520339966, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.24, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.189741134643555, "policy_loss": -0.04206748306751251, "vf_loss": 8.230719566345215, "vf_explained_var": -7.01532480889e-05, "kl": 0.010883607901632786, "entropy": 2.3263182640075684, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.640593528747559, "policy_loss": -0.041077014058828354, "vf_loss": 7.681166648864746, "vf_explained_var": -0.0007303726160898805, "kl": 0.010070442222058773, "entropy": 2.5532069206237793, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.111989974975586, "policy_loss": -0.04930282384157181, "vf_loss": 8.160590171813965, "vf_explained_var": 3.212974206689978e-07, "kl": 0.014074279926717281, "entropy": 2.5479440689086914, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.238370895385742, "policy_loss": -0.04168881103396416, "vf_loss": 8.279658317565918, "vf_explained_var": 9.100494207814336e-05, "kl": 0.008025206625461578, "entropy": 2.3030195236206055, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.696504592895508, "policy_loss": -0.04468756169080734, "vf_loss": 8.740669250488281, "vf_explained_var": -0.0009794945362955332, "kl": 0.010434930212795734, "entropy": 2.467733383178711, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 63968, "num_agent_steps_trained": 63968}, "sampler_results": {"episode_reward_max": 701.2345591854768, "episode_reward_min": 651.8146523283383, "episode_reward_mean": 680.2572825863198, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 123.63546933561194, "agent_1": 130.1307331678951, "agent_2": 134.62962670433296, "agent_3": 115.18386530759487, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 154.5757646604735, "agent_2": 152.07062910747982, "agent_3": 136.9032091501548, "agent_4": 138.8316120452715}, "policy_reward_mean": {"agent_0": 135.18293624186606, "agent_1": 143.59691523203986, "agent_2": 145.97815590399017, "agent_3": 127.47138288406566, "agent_4": 128.0278923243573}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [681.1568693593953, 701.2345591854768, 686.2839991910929, 665.5432223642533, 651.8146523283383, 696.7535955843709, 663.1666851663384, 696.1046775112923], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [128.01777882823137, 141.89216909938327, 129.06215657536345, 126.8185707230984, 123.63546933561194, 131.88215143721118, 149.37255968644078, 150.7826342495881], "policy_agent_1_reward": [154.5757646604735, 151.90242304802945, 143.25142908274216, 137.4978649224827, 130.1307331678951, 151.39537046454615, 135.79938584500815, 144.22235066514165], "policy_agent_2_reward": [145.45148681482985, 134.62962670433296, 151.18370305672212, 148.16770591429955, 152.07062910747982, 142.1908203388139, 142.8833279866281, 151.24794730881493], "policy_agent_3_reward": [124.94794898887241, 133.97872828845917, 129.5012997906021, 127.66835634592523, 120.69397587665648, 136.9032091501548, 115.18386530759487, 130.89367932426015], "policy_agent_4_reward": [128.16389006698765, 138.8316120452715, 133.28541068566201, 125.39072445844661, 125.28384484069385, 134.38204419364445, 119.92754634066559, 118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326388947830515, "mean_inference_ms": 0.4703257809786659, "mean_action_processing_ms": 0.09851924792898697, "mean_env_wait_ms": 0.1509575795537307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01111745834350586, "StateBufferConnector_ms": 0.0027936697006225586, "ViewRequirementAgentConnector_ms": 0.07591187953948975}}, "episode_reward_max": 701.2345591854768, "episode_reward_min": 651.8146523283383, "episode_reward_mean": 680.2572825863198, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 123.63546933561194, "agent_1": 130.1307331678951, "agent_2": 134.62962670433296, "agent_3": 115.18386530759487, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 154.5757646604735, "agent_2": 152.07062910747982, "agent_3": 136.9032091501548, "agent_4": 138.8316120452715}, "policy_reward_mean": {"agent_0": 135.18293624186606, "agent_1": 143.59691523203986, "agent_2": 145.97815590399017, "agent_3": 127.47138288406566, "agent_4": 128.0278923243573}, "hist_stats": {"episode_reward": [681.1568693593953, 701.2345591854768, 686.2839991910929, 665.5432223642533, 651.8146523283383, 696.7535955843709, 663.1666851663384, 696.1046775112923], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [128.01777882823137, 141.89216909938327, 129.06215657536345, 126.8185707230984, 123.63546933561194, 131.88215143721118, 149.37255968644078, 150.7826342495881], "policy_agent_1_reward": [154.5757646604735, 151.90242304802945, 143.25142908274216, 137.4978649224827, 130.1307331678951, 151.39537046454615, 135.79938584500815, 144.22235066514165], "policy_agent_2_reward": [145.45148681482985, 134.62962670433296, 151.18370305672212, 148.16770591429955, 152.07062910747982, 142.1908203388139, 142.8833279866281, 151.24794730881493], "policy_agent_3_reward": [124.94794898887241, 133.97872828845917, 129.5012997906021, 127.66835634592523, 120.69397587665648, 136.9032091501548, 115.18386530759487, 130.89367932426015], "policy_agent_4_reward": [128.16389006698765, 138.8316120452715, 133.28541068566201, 125.39072445844661, 125.28384484069385, 134.38204419364445, 119.92754634066559, 118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326388947830515, "mean_inference_ms": 0.4703257809786659, "mean_action_processing_ms": 0.09851924792898697, "mean_env_wait_ms": 0.1509575795537307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01111745834350586, "StateBufferConnector_ms": 0.0027936697006225586, "ViewRequirementAgentConnector_ms": 0.07591187953948975}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63968, "num_agent_steps_trained": 63968, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1005.1249509336153, "num_env_steps_trained_throughput_per_sec": 1005.1249509336153, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 63968, "timers": {"training_iteration_time_ms": 3624.928, "sample_time_ms": 664.859, "learn_time_ms": 2945.354, "learn_throughput": 1358.071, "synch_weights_time_ms": 13.511}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 63968, "num_agent_steps_trained": 63968}, "done": false, "episodes_total": 32, "training_iteration": 16, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-12", "timestamp": 1742310012, "time_this_iter_s": 3.994967222213745, "time_total_s": 59.4233124256134, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee0763b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 59.4233124256134, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 9.683333333333334, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.062209129333496, "policy_loss": -0.05386248603463173, "vf_loss": 8.114588737487793, "vf_explained_var": -0.0005627132486552, "kl": 0.014821115881204605, "entropy": 2.153615951538086, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.884068012237549, "policy_loss": -0.03867132216691971, "vf_loss": 7.922177791595459, "vf_explained_var": -0.0003947113291360438, "kl": 0.011246424168348312, "entropy": 2.4929542541503906, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.325479030609131, "policy_loss": -0.056548263877630234, "vf_loss": 7.381253719329834, "vf_explained_var": -0.0003351643099449575, "kl": 0.015477578155696392, "entropy": 2.427340030670166, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.862789630889893, "policy_loss": -0.042534224689006805, "vf_loss": 7.9047136306762695, "vf_explained_var": 0.00044712054659612477, "kl": 0.012189039029181004, "entropy": 2.236189126968384, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.807090759277344, "policy_loss": -0.05164683237671852, "vf_loss": 7.857999324798584, "vf_explained_var": 0.0003330361214466393, "kl": 0.014774104580283165, "entropy": 2.345452070236206, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 67968, "num_agent_steps_trained": 67968}, "sampler_results": {"episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}}, "episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67968, "num_agent_steps_trained": 67968, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1156.31284789909, "num_env_steps_trained_throughput_per_sec": 1156.31284789909, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 67968, "timers": {"training_iteration_time_ms": 3623.978, "sample_time_ms": 663.684, "learn_time_ms": 2945.641, "learn_throughput": 1357.939, "synch_weights_time_ms": 13.463}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 67968, "num_agent_steps_trained": 67968}, "done": false, "episodes_total": 32, "training_iteration": 17, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-15", "timestamp": 1742310015, "time_this_iter_s": 3.472419261932373, "time_total_s": 62.895731687545776, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 62.895731687545776, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 10.24, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.54171085357666, "policy_loss": -0.050636567175388336, "vf_loss": 8.591004371643066, "vf_explained_var": -0.00012197721662232652, "kl": 0.01343079749494791, "entropy": 2.047628164291382, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.531023025512695, "policy_loss": -0.03613604977726936, "vf_loss": 8.566679000854492, "vf_explained_var": 9.972679981729016e-05, "kl": 0.009587330743670464, "entropy": 2.3335583209991455, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.486061096191406, "policy_loss": -0.03680890053510666, "vf_loss": 8.522348403930664, "vf_explained_var": 7.219939288916066e-05, "kl": 0.010412288829684258, "entropy": 2.2586545944213867, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.805604934692383, "policy_loss": -0.03369298577308655, "vf_loss": 8.838865280151367, "vf_explained_var": 0.0008924223366193473, "kl": 0.008651637472212315, "entropy": 2.1324989795684814, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.186304092407227, "policy_loss": -0.055486056953668594, "vf_loss": 8.241151809692383, "vf_explained_var": 0.0007551457383669913, "kl": 0.012749087996780872, "entropy": 2.228996992111206, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 71968, "num_agent_steps_trained": 71968}, "sampler_results": {"episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}}, "episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71968, "num_agent_steps_trained": 71968, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1169.7524064084623, "num_env_steps_trained_throughput_per_sec": 1169.7524064084623, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 71968, "timers": {"training_iteration_time_ms": 3565.854, "sample_time_ms": 609.51, "learn_time_ms": 2941.853, "learn_throughput": 1359.687, "synch_weights_time_ms": 13.315}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 71968, "num_agent_steps_trained": 71968}, "done": false, "episodes_total": 32, "training_iteration": 18, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-19", "timestamp": 1742310019, "time_this_iter_s": 3.432586908340454, "time_total_s": 66.32831859588623, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb12d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 66.32831859588623, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 10.28, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.680093765258789, "policy_loss": -0.049944233149290085, "vf_loss": 8.729153633117676, "vf_explained_var": -0.0003601644712034613, "kl": 0.008846291340887547, "entropy": 1.9851213693618774, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.636277198791504, "policy_loss": -0.048053279519081116, "vf_loss": 8.683725357055664, "vf_explained_var": 0.0005834730109199882, "kl": 0.012123886495828629, "entropy": 2.228501319885254, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.784095764160156, "policy_loss": -0.048929497599601746, "vf_loss": 7.83230447769165, "vf_explained_var": -0.0001718393323244527, "kl": 0.014418590813875198, "entropy": 2.0674946308135986, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.534860610961914, "policy_loss": -0.052511896938085556, "vf_loss": 7.586751461029053, "vf_explained_var": 0.000986997620202601, "kl": 0.012429106049239635, "entropy": 2.0598745346069336, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.288429260253906, "policy_loss": -0.04452400282025337, "vf_loss": 8.332231521606445, "vf_explained_var": -3.454458055784926e-05, "kl": 0.014441880397498608, "entropy": 2.065866708755493, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 75968, "num_agent_steps_trained": 75968}, "sampler_results": {"episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}}, "episode_reward_max": 696.1046775112923, "episode_reward_min": 696.1046775112923, "episode_reward_mean": 696.1046775112923, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_max": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "policy_reward_mean": {"agent_0": 150.7826342495881, "agent_1": 144.22235066514165, "agent_2": 151.24794730881493, "agent_3": 130.89367932426015, "agent_4": 118.95806596348667}, "hist_stats": {"episode_reward": [696.1046775112923], "episode_lengths": [1995], "policy_agent_0_reward": [150.7826342495881], "policy_agent_1_reward": [144.22235066514165], "policy_agent_2_reward": [151.24794730881493], "policy_agent_3_reward": [130.89367932426015], "policy_agent_4_reward": [118.95806596348667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275996949222442, "mean_inference_ms": 0.454452958289958, "mean_action_processing_ms": 0.09440279144031558, "mean_env_wait_ms": 0.1480948580844509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010657310485839844, "StateBufferConnector_ms": 0.0024509429931640625, "ViewRequirementAgentConnector_ms": 0.07224082946777344}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75968, "num_agent_steps_trained": 75968, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1164.5185207910768, "num_env_steps_trained_throughput_per_sec": 1164.5185207910768, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 75968, "timers": {"training_iteration_time_ms": 3561.215, "sample_time_ms": 609.904, "learn_time_ms": 2936.897, "learn_throughput": 1361.982, "synch_weights_time_ms": 13.22}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 75968, "num_agent_steps_trained": 75968}, "done": false, "episodes_total": 32, "training_iteration": 19, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-22", "timestamp": 1742310022, "time_this_iter_s": 3.447995185852051, "time_total_s": 69.77631378173828, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 69.77631378173828, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.220000000000002, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 7.743813991546631, "policy_loss": -0.033304233103990555, "vf_loss": 7.776297569274902, "vf_explained_var": -9.63730490184389e-05, "kl": 0.00822283886373043, "entropy": 1.912212610244751, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.630365371704102, "policy_loss": -0.04169953614473343, "vf_loss": 7.671529769897461, "vf_explained_var": 0.0001836685842135921, "kl": 0.010701940394937992, "entropy": 2.170003890991211, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.881709098815918, "policy_loss": -0.03646005317568779, "vf_loss": 7.917752742767334, "vf_explained_var": 0.00013005307118874043, "kl": 0.008329144679009914, "entropy": 1.9982514381408691, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.459833145141602, "policy_loss": -0.04741807281970978, "vf_loss": 8.506709098815918, "vf_explained_var": 0.00028922982164658606, "kl": 0.010837056674063206, "entropy": 1.9679168462753296, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.125786781311035, "policy_loss": -0.03354821354150772, "vf_loss": 8.158733367919922, "vf_explained_var": 4.546642230707221e-05, "kl": 0.012041273526847363, "entropy": 1.9021751880645752, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 79968, "num_agent_steps_trained": 79968}, "sampler_results": {"episode_reward_max": 934.0632841085205, "episode_reward_min": 897.9480019894002, "episode_reward_mean": 912.9306694346981, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 183.6716471407222, "agent_2": 174.7731638809423, "agent_3": 156.33492539897355, "agent_4": 167.75875353086982}, "policy_reward_max": {"agent_0": 209.36384972702587, "agent_1": 195.56469846224022, "agent_2": 200.83290671547263, "agent_3": 175.37288754610208, "agent_4": 200.1967611932014}, "policy_reward_mean": {"agent_0": 191.80610229872144, "agent_1": 188.63752759991485, "agent_2": 188.35172289661259, "agent_3": 161.82742476487283, "agent_4": 182.3078918745756}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [897.9480019894002, 925.7923523872043, 923.3049406497303, 900.6921683224331, 934.0632841085205, 914.1073370377763, 902.9116002977453, 904.6256706847739], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [197.56068303903814, 209.36384972702587, 191.24791297652402, 179.7400985445501, 206.80664579750473, 188.23870084703796, 184.71633593528466, 176.7745915228059], "policy_agent_1_reward": [188.52947933207128, 191.61927629449934, 184.8940507719325, 184.8443609908723, 191.15686377963405, 188.81984402734702, 183.6716471407222, 195.56469846224022], "policy_agent_2_reward": [183.40682995590623, 188.9759284563286, 190.63129030909784, 200.83290671547263, 182.4411009277764, 185.09884420900488, 200.6537187183718, 174.7731638809423], "policy_agent_3_reward": [160.69225613151363, 158.48221684188792, 156.33492539897355, 163.4137366392702, 160.30073769529866, 175.37288754610208, 160.70004967323666, 159.32258819270004], "policy_agent_4_reward": [167.75875353086982, 177.3510810674617, 200.1967611932014, 171.86106543226748, 193.35793590830602, 176.57706040828413, 173.16984883012975, 198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323096294782601, "mean_inference_ms": 0.46626432170129845, "mean_action_processing_ms": 0.09824817877461368, "mean_env_wait_ms": 0.13669562118075607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011973977088928223, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.0794607400894165}}, "episode_reward_max": 934.0632841085205, "episode_reward_min": 897.9480019894002, "episode_reward_mean": 912.9306694346981, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 183.6716471407222, "agent_2": 174.7731638809423, "agent_3": 156.33492539897355, "agent_4": 167.75875353086982}, "policy_reward_max": {"agent_0": 209.36384972702587, "agent_1": 195.56469846224022, "agent_2": 200.83290671547263, "agent_3": 175.37288754610208, "agent_4": 200.1967611932014}, "policy_reward_mean": {"agent_0": 191.80610229872144, "agent_1": 188.63752759991485, "agent_2": 188.35172289661259, "agent_3": 161.82742476487283, "agent_4": 182.3078918745756}, "hist_stats": {"episode_reward": [897.9480019894002, 925.7923523872043, 923.3049406497303, 900.6921683224331, 934.0632841085205, 914.1073370377763, 902.9116002977453, 904.6256706847739], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [197.56068303903814, 209.36384972702587, 191.24791297652402, 179.7400985445501, 206.80664579750473, 188.23870084703796, 184.71633593528466, 176.7745915228059], "policy_agent_1_reward": [188.52947933207128, 191.61927629449934, 184.8940507719325, 184.8443609908723, 191.15686377963405, 188.81984402734702, 183.6716471407222, 195.56469846224022], "policy_agent_2_reward": [183.40682995590623, 188.9759284563286, 190.63129030909784, 200.83290671547263, 182.4411009277764, 185.09884420900488, 200.6537187183718, 174.7731638809423], "policy_agent_3_reward": [160.69225613151363, 158.48221684188792, 156.33492539897355, 163.4137366392702, 160.30073769529866, 175.37288754610208, 160.70004967323666, 159.32258819270004], "policy_agent_4_reward": [167.75875353086982, 177.3510810674617, 200.1967611932014, 171.86106543226748, 193.35793590830602, 176.57706040828413, 173.16984883012975, 198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5323096294782601, "mean_inference_ms": 0.46626432170129845, "mean_action_processing_ms": 0.09824817877461368, "mean_env_wait_ms": 0.13669562118075607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011973977088928223, "StateBufferConnector_ms": 0.002893209457397461, "ViewRequirementAgentConnector_ms": 0.0794607400894165}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79968, "num_agent_steps_trained": 79968, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1010.6186174912898, "num_env_steps_trained_throughput_per_sec": 1010.6186174912898, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 79968, "timers": {"training_iteration_time_ms": 3605.828, "sample_time_ms": 664.906, "learn_time_ms": 2926.461, "learn_throughput": 1366.839, "synch_weights_time_ms": 13.287}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 79968, "num_agent_steps_trained": 79968}, "done": false, "episodes_total": 40, "training_iteration": 20, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-27", "timestamp": 1742310027, "time_this_iter_s": 3.9753856658935547, "time_total_s": 73.75169944763184, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 73.75169944763184, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 9.6, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.814623832702637, "policy_loss": -0.04043487459421158, "vf_loss": 8.853885650634766, "vf_explained_var": 6.495799607364461e-05, "kl": 0.011731365695595741, "entropy": 1.9211242198944092, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.9745941162109375, "policy_loss": -0.045660119503736496, "vf_loss": 8.019648551940918, "vf_explained_var": -0.0005716570885851979, "kl": 0.012109635397791862, "entropy": 2.079535484313965, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.57966423034668, "policy_loss": -0.040937233716249466, "vf_loss": 8.620150566101074, "vf_explained_var": 0.0002471160260029137, "kl": 0.009020582772791386, "entropy": 1.8838753700256348, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.373621940612793, "policy_loss": -0.027490347623825073, "vf_loss": 8.400694847106934, "vf_explained_var": 0.0003073570260312408, "kl": 0.008358769118785858, "entropy": 1.878528356552124, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.692540168762207, "policy_loss": -0.03828898072242737, "vf_loss": 8.730284690856934, "vf_explained_var": -7.24707351764664e-05, "kl": 0.010898982174694538, "entropy": 1.8457914590835571, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "sampler_results": {"episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}}, "episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.9822765295257, "num_env_steps_trained_throughput_per_sec": 1090.9822765295257, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 3624.889, "sample_time_ms": 667.365, "learn_time_ms": 2943.204, "learn_throughput": 1359.063, "synch_weights_time_ms": 13.147}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "episodes_total": 40, "training_iteration": 21, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-30", "timestamp": 1742310030, "time_this_iter_s": 3.6791632175445557, "time_total_s": 77.43086266517639, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 77.43086266517639, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 10.24, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.411392211914062, "policy_loss": -0.031548887491226196, "vf_loss": 8.441974639892578, "vf_explained_var": -0.0001079976573237218, "kl": 0.009668230079114437, "entropy": 1.723596453666687, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.93251371383667, "policy_loss": -0.043437279760837555, "vf_loss": 7.9752984046936035, "vf_explained_var": -0.0006772776250727475, "kl": 0.013058511540293694, "entropy": 1.9834535121917725, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.755621910095215, "policy_loss": -0.03690138831734657, "vf_loss": 8.792082786560059, "vf_explained_var": 7.369518425548449e-05, "kl": 0.008823439478874207, "entropy": 1.8928382396697998, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.508377075195312, "policy_loss": -0.02961062081158161, "vf_loss": 8.537633895874023, "vf_explained_var": -0.0004716345283668488, "kl": 0.00709783099591732, "entropy": 1.844494104385376, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.825986862182617, "policy_loss": -0.03446267545223236, "vf_loss": 8.859846115112305, "vf_explained_var": 3.182235377607867e-05, "kl": 0.012065711431205273, "entropy": 1.7636059522628784, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 87968, "num_agent_steps_trained": 87968}, "sampler_results": {"episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}}, "episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87968, "num_agent_steps_trained": 87968, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1155.123191472647, "num_env_steps_trained_throughput_per_sec": 1155.123191472647, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 87968, "timers": {"training_iteration_time_ms": 3571.742, "sample_time_ms": 615.491, "learn_time_ms": 2941.822, "learn_throughput": 1359.701, "synch_weights_time_ms": 13.217}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 87968, "num_agent_steps_trained": 87968}, "done": false, "episodes_total": 40, "training_iteration": 22, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-34", "timestamp": 1742310034, "time_this_iter_s": 3.4753756523132324, "time_total_s": 80.90623831748962, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 80.90623831748962, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.040000000000001, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.752408981323242, "policy_loss": -0.03690199553966522, "vf_loss": 8.788491249084473, "vf_explained_var": 2.717148709052708e-05, "kl": 0.008193166926503181, "entropy": 1.6662002801895142, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.580647468566895, "policy_loss": -0.03376319631934166, "vf_loss": 8.614006996154785, "vf_explained_var": -0.00017124897567555308, "kl": 0.00806573498994112, "entropy": 1.8516043424606323, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.89686107635498, "policy_loss": -0.044208064675331116, "vf_loss": 8.940597534179688, "vf_explained_var": -0.00012899636931251734, "kl": 0.009440230205655098, "entropy": 1.8365981578826904, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.150185585021973, "policy_loss": -0.039321813732385635, "vf_loss": 8.189000129699707, "vf_explained_var": -0.00027866760501638055, "kl": 0.0101319570094347, "entropy": 1.7408301830291748, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.99739933013916, "policy_loss": -0.03148293495178223, "vf_loss": 9.028411865234375, "vf_explained_var": 0.00015853501099627465, "kl": 0.00941995345056057, "entropy": 1.6630860567092896, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 91968, "num_agent_steps_trained": 91968}, "sampler_results": {"episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}}, "episode_reward_max": 904.6256706847739, "episode_reward_min": 904.6256706847739, "episode_reward_mean": 904.6256706847739, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_max": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "policy_reward_mean": {"agent_0": 176.7745915228059, "agent_1": 195.56469846224022, "agent_2": 174.7731638809423, "agent_3": 159.32258819270004, "agent_4": 198.19062862608433}, "hist_stats": {"episode_reward": [904.6256706847739], "episode_lengths": [1995], "policy_agent_0_reward": [176.7745915228059], "policy_agent_1_reward": [195.56469846224022], "policy_agent_2_reward": [174.7731638809423], "policy_agent_3_reward": [159.32258819270004], "policy_agent_4_reward": [198.19062862608433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5258334039414051, "mean_inference_ms": 0.44983966912451817, "mean_action_processing_ms": 0.09325704220807167, "mean_env_wait_ms": 0.13346276799627166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010809898376464844, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0726318359375}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91968, "num_agent_steps_trained": 91968, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1176.2024161019247, "num_env_steps_trained_throughput_per_sec": 1176.2024161019247, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 91968, "timers": {"training_iteration_time_ms": 3564.016, "sample_time_ms": 609.758, "learn_time_ms": 2939.938, "learn_throughput": 1360.573, "synch_weights_time_ms": 13.126}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 91968, "num_agent_steps_trained": 91968}, "done": false, "episodes_total": 40, "training_iteration": 23, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-37", "timestamp": 1742310037, "time_this_iter_s": 3.4130308628082275, "time_total_s": 84.31926918029785, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb12d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 84.31926918029785, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.28, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.234684944152832, "policy_loss": -0.02777045965194702, "vf_loss": 8.2616605758667, "vf_explained_var": -8.309710392495617e-05, "kl": 0.0079518286511302, "entropy": 1.6507312059402466, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.837118625640869, "policy_loss": -0.03155280277132988, "vf_loss": 7.868251323699951, "vf_explained_var": -0.00012857488763984293, "kl": 0.008396822959184647, "entropy": 1.7838460206985474, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.172616004943848, "policy_loss": -0.04246867820620537, "vf_loss": 8.214552879333496, "vf_explained_var": 3.9310965803451836e-05, "kl": 0.010624733753502369, "entropy": 1.7740731239318848, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.230173110961914, "policy_loss": -0.024799203500151634, "vf_loss": 9.254643440246582, "vf_explained_var": 0.00010965125693473965, "kl": 0.006579569540917873, "entropy": 1.7675702571868896, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.111867904663086, "policy_loss": -0.03248409926891327, "vf_loss": 8.143912315368652, "vf_explained_var": 0.0001369365636492148, "kl": 0.008771060965955257, "entropy": 1.5619254112243652, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 95968, "num_agent_steps_trained": 95968}, "sampler_results": {"episode_reward_max": 1142.771497019594, "episode_reward_min": 1099.575575178152, "episode_reward_mean": 1117.859238018364, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 239.9981931947596, "agent_1": 205.53346166379623, "agent_2": 207.78927204176918, "agent_3": 194.00396656900497, "agent_4": 213.3741438908484}, "policy_reward_max": {"agent_0": 259.07118020813846, "agent_1": 236.36258336667876, "agent_2": 230.23928186015488, "agent_3": 204.9669215387557, "agent_4": 239.46784978669248}, "policy_reward_mean": {"agent_0": 251.71921160404162, "agent_1": 216.13253719314184, "agent_2": 220.69755259601365, "agent_3": 202.15718776239106, "agent_4": 227.1527488627757}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1099.575575178152, 1114.6670054480478, 1100.0500394424612, 1122.5717870137169, 1119.7094440335848, 1142.771497019594, 1123.7834135343833, 1119.7451424769738], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [239.9981931947596, 259.07118020813846, 250.97390876024875, 254.81496820083873, 256.2206716498325, 256.7190885261254, 246.6708746947541, 249.28480759763545], "policy_agent_1_reward": [205.77837371357643, 211.87218780103092, 205.53346166379623, 219.1245323206038, 212.44469171122785, 236.36258336667876, 225.00322348179074, 212.94124348643], "policy_agent_2_reward": [229.69175658691347, 225.5201595816126, 222.55063376564232, 209.4634167652778, 222.66729411098066, 230.23928186015488, 207.78927204176918, 217.65860605575827], "policy_agent_3_reward": [204.21055378403798, 204.8293339664171, 204.9669215387557, 204.69054581884703, 197.79677102004638, 194.00396656900497, 204.85219352937645, 201.9072158726429], "policy_agent_4_reward": [219.89669789886335, 213.3741438908484, 216.0251137140174, 234.47832390814966, 230.58001554149718, 225.44657669762984, 239.46784978669248, 237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5324179977588321, "mean_inference_ms": 0.4633236190655084, "mean_action_processing_ms": 0.09817121903227424, "mean_env_wait_ms": 0.12724789795542982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011327266693115234, "StateBufferConnector_ms": 0.002842545509338379, "ViewRequirementAgentConnector_ms": 0.07717907428741455}}, "episode_reward_max": 1142.771497019594, "episode_reward_min": 1099.575575178152, "episode_reward_mean": 1117.859238018364, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 239.9981931947596, "agent_1": 205.53346166379623, "agent_2": 207.78927204176918, "agent_3": 194.00396656900497, "agent_4": 213.3741438908484}, "policy_reward_max": {"agent_0": 259.07118020813846, "agent_1": 236.36258336667876, "agent_2": 230.23928186015488, "agent_3": 204.9669215387557, "agent_4": 239.46784978669248}, "policy_reward_mean": {"agent_0": 251.71921160404162, "agent_1": 216.13253719314184, "agent_2": 220.69755259601365, "agent_3": 202.15718776239106, "agent_4": 227.1527488627757}, "hist_stats": {"episode_reward": [1099.575575178152, 1114.6670054480478, 1100.0500394424612, 1122.5717870137169, 1119.7094440335848, 1142.771497019594, 1123.7834135343833, 1119.7451424769738], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [239.9981931947596, 259.07118020813846, 250.97390876024875, 254.81496820083873, 256.2206716498325, 256.7190885261254, 246.6708746947541, 249.28480759763545], "policy_agent_1_reward": [205.77837371357643, 211.87218780103092, 205.53346166379623, 219.1245323206038, 212.44469171122785, 236.36258336667876, 225.00322348179074, 212.94124348643], "policy_agent_2_reward": [229.69175658691347, 225.5201595816126, 222.55063376564232, 209.4634167652778, 222.66729411098066, 230.23928186015488, 207.78927204176918, 217.65860605575827], "policy_agent_3_reward": [204.21055378403798, 204.8293339664171, 204.9669215387557, 204.69054581884703, 197.79677102004638, 194.00396656900497, 204.85219352937645, 201.9072158726429], "policy_agent_4_reward": [219.89669789886335, 213.3741438908484, 216.0251137140174, 234.47832390814966, 230.58001554149718, 225.44657669762984, 239.46784978669248, 237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5324179977588321, "mean_inference_ms": 0.4633236190655084, "mean_action_processing_ms": 0.09817121903227424, "mean_env_wait_ms": 0.12724789795542982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011327266693115234, "StateBufferConnector_ms": 0.002842545509338379, "ViewRequirementAgentConnector_ms": 0.07717907428741455}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95968, "num_agent_steps_trained": 95968, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 991.0767029263235, "num_env_steps_trained_throughput_per_sec": 991.0767029263235, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 95968, "timers": {"training_iteration_time_ms": 3623.179, "sample_time_ms": 672.107, "learn_time_ms": 2937.191, "learn_throughput": 1361.846, "synch_weights_time_ms": 12.698}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 95968, "num_agent_steps_trained": 95968}, "done": false, "episodes_total": 48, "training_iteration": 24, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-42", "timestamp": 1742310042, "time_this_iter_s": 4.049574613571167, "time_total_s": 88.36884379386902, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 88.36884379386902, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 9.700000000000001, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.766575813293457, "policy_loss": -0.03646409139037132, "vf_loss": 8.801820755004883, "vf_explained_var": -0.00019618385704234242, "kl": 0.012184620834887028, "entropy": 1.7044916152954102, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.7369966506958, "policy_loss": -0.031292881816625595, "vf_loss": 8.76788330078125, "vf_explained_var": 0.000436931848526001, "kl": 0.008138556033372879, "entropy": 1.789257287979126, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.011087417602539, "policy_loss": -0.02633468061685562, "vf_loss": 9.037052154541016, "vf_explained_var": 0.00023631282965652645, "kl": 0.007403412368148565, "entropy": 1.7378522157669067, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.520227432250977, "policy_loss": -0.027915246784687042, "vf_loss": 8.547831535339355, "vf_explained_var": -9.12203686311841e-05, "kl": 0.0062277656979858875, "entropy": 1.648201584815979, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.159473419189453, "policy_loss": -0.037793535739183426, "vf_loss": 9.196773529052734, "vf_explained_var": 0.0001208350804517977, "kl": 0.009868970140814781, "entropy": 1.50299072265625, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 99968, "num_agent_steps_trained": 99968}, "sampler_results": {"episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}}, "episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99968, "num_agent_steps_trained": 99968, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.231933226005, "num_env_steps_trained_throughput_per_sec": 1159.231933226005, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 99968, "timers": {"training_iteration_time_ms": 3626.739, "sample_time_ms": 673.67, "learn_time_ms": 2939.48, "learn_throughput": 1360.785, "synch_weights_time_ms": 12.44}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 99968, "num_agent_steps_trained": 99968}, "done": false, "episodes_total": 48, "training_iteration": 25, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-45", "timestamp": 1742310045, "time_this_iter_s": 3.4640135765075684, "time_total_s": 91.83285737037659, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb12d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 91.83285737037659, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 7.893882751464844, "policy_loss": -0.03885028883814812, "vf_loss": 7.93178129196167, "vf_explained_var": -0.00032046265550889075, "kl": 0.009524963796138763, "entropy": 1.6656290292739868, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.999170303344727, "policy_loss": -0.039541907608509064, "vf_loss": 8.038262367248535, "vf_explained_var": -0.00015550595708191395, "kl": 0.008989664725959301, "entropy": 1.7585992813110352, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.820605278015137, "policy_loss": -0.03116545081138611, "vf_loss": 8.851295471191406, "vf_explained_var": 0.00015282744425348938, "kl": 0.009509320370852947, "entropy": 1.6559733152389526, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.056103706359863, "policy_loss": -0.02931007742881775, "vf_loss": 8.085140228271484, "vf_explained_var": 0.0002988960186485201, "kl": 0.005473543889820576, "entropy": 1.6712632179260254, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.67652416229248, "policy_loss": -0.0364128015935421, "vf_loss": 8.712387084960938, "vf_explained_var": -0.00022766250185668468, "kl": 0.010988988913595676, "entropy": 1.3919857740402222, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 103968, "num_agent_steps_trained": 103968}, "sampler_results": {"episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}}, "episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103968, "num_agent_steps_trained": 103968, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1150.454419187772, "num_env_steps_trained_throughput_per_sec": 1150.454419187772, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 103968, "timers": {"training_iteration_time_ms": 3576.467, "sample_time_ms": 620.759, "learn_time_ms": 2941.739, "learn_throughput": 1359.74, "synch_weights_time_ms": 12.81}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 103968, "num_agent_steps_trained": 103968}, "done": false, "episodes_total": 48, "training_iteration": 26, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-49", "timestamp": 1742310049, "time_this_iter_s": 3.489238977432251, "time_total_s": 95.32209634780884, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 95.32209634780884, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 7.787914276123047, "policy_loss": -0.03085762821137905, "vf_loss": 7.818230152130127, "vf_explained_var": 0.00025637945509515703, "kl": 0.005422496702522039, "entropy": 1.5604313611984253, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.778166770935059, "policy_loss": -0.029997339472174644, "vf_loss": 7.80775785446167, "vf_explained_var": -0.0003562138299457729, "kl": 0.008147725835442543, "entropy": 1.644793152809143, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.659302711486816, "policy_loss": -0.036201730370521545, "vf_loss": 8.695001602172852, "vf_explained_var": -9.72614434431307e-05, "kl": 0.010052712634205818, "entropy": 1.6225779056549072, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.287651538848877, "policy_loss": -0.03637295961380005, "vf_loss": 7.323539733886719, "vf_explained_var": 9.776467049960047e-05, "kl": 0.009701662696897984, "entropy": 1.6059643030166626, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.770605087280273, "policy_loss": -0.030638059601187706, "vf_loss": 8.800806999206543, "vf_explained_var": -2.5076526526390808e-06, "kl": 0.008737660944461823, "entropy": 1.209736943244934, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 107968, "num_agent_steps_trained": 107968}, "sampler_results": {"episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}}, "episode_reward_max": 1119.7451424769738, "episode_reward_min": 1119.7451424769738, "episode_reward_mean": 1119.7451424769738, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_max": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "policy_reward_mean": {"agent_0": 249.28480759763545, "agent_1": 212.94124348643, "agent_2": 217.65860605575827, "agent_3": 201.9072158726429, "agent_4": 237.95326946450712}, "hist_stats": {"episode_reward": [1119.7451424769738], "episode_lengths": [1995], "policy_agent_0_reward": [249.28480759763545], "policy_agent_1_reward": [212.94124348643], "policy_agent_2_reward": [217.65860605575827], "policy_agent_3_reward": [201.9072158726429], "policy_agent_4_reward": [237.95326946450712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.525420451698656, "mean_inference_ms": 0.44630211737243125, "mean_action_processing_ms": 0.09307403602596918, "mean_env_wait_ms": 0.1239586091023685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.07326602935791016}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107968, "num_agent_steps_trained": 107968, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1177.6534414876553, "num_env_steps_trained_throughput_per_sec": 1177.6534414876553, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 107968, "timers": {"training_iteration_time_ms": 3570.202, "sample_time_ms": 616.588, "learn_time_ms": 2939.748, "learn_throughput": 1360.661, "synch_weights_time_ms": 12.701}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 107968, "num_agent_steps_trained": 107968}, "done": false, "episodes_total": 48, "training_iteration": 27, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-52", "timestamp": 1742310052, "time_this_iter_s": 3.408848285675049, "time_total_s": 98.73094463348389, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb12d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 98.73094463348389, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 10.220000000000002, "ram_util_percent": 6.3}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.606846809387207, "policy_loss": -0.028879093006253242, "vf_loss": 8.634946823120117, "vf_explained_var": 4.12197332479991e-05, "kl": 0.00778571330010891, "entropy": 1.419739842414856, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.22391414642334, "policy_loss": -0.028893211856484413, "vf_loss": 9.25236701965332, "vf_explained_var": 5.0619386456673965e-05, "kl": 0.008801789954304695, "entropy": 1.5833473205566406, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.392544746398926, "policy_loss": -0.028649184852838516, "vf_loss": 8.420742988586426, "vf_explained_var": -2.5035937142092735e-05, "kl": 0.009029951877892017, "entropy": 1.6094226837158203, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.261903762817383, "policy_loss": -0.024371931329369545, "vf_loss": 9.286059379577637, "vf_explained_var": -5.4865507991053164e-05, "kl": 0.004310159012675285, "entropy": 1.495884895324707, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.299943923950195, "policy_loss": -0.02808046154677868, "vf_loss": 8.327686309814453, "vf_explained_var": -4.524645191850141e-05, "kl": 0.006764346268028021, "entropy": 1.1865917444229126, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 111968, "num_agent_steps_trained": 111968}, "sampler_results": {"episode_reward_max": 1255.3657952717529, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1229.6632974237407, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 278.86069984445743, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 209.98682118576983, "agent_4": 241.35365149520737}, "policy_reward_max": {"agent_0": 299.03617515707094, "agent_1": 247.31269889289757, "agent_2": 256.803166114384, "agent_3": 227.52651994429914, "agent_4": 267.70475407792605}, "policy_reward_mean": {"agent_0": 289.72224436770625, "agent_1": 230.71575827721685, "agent_2": 243.87885232548257, "agent_3": 217.84808063104316, "agent_4": 247.49836182229149}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1241.5431314864966, 1240.065473895638, 1255.3657952717529, 1234.5017455824589, 1223.1358649402514, 1223.263079564165, 1229.318730909351, 1190.1125577398122], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [296.0480731673513, 288.153605641812, 288.3458524491347, 299.03617515707094, 290.82707547917596, 278.86069984445743, 292.9830493171358, 283.52342388551233], "policy_agent_1_reward": [217.86230879833357, 238.1875259242754, 237.9771157270395, 247.31269889289757, 234.3181948015102, 231.7775449941507, 222.70215829708064, 215.5885187824473], "policy_agent_2_reward": [248.3686754868613, 256.803166114384, 254.15555247076446, 235.50678977720892, 242.27816809607, 247.55559444542118, 234.63114068784267, 231.7317315253082], "policy_agent_3_reward": [211.55931995602407, 214.06536950413405, 227.52651994429914, 209.98682118576983, 211.7231893677244, 223.7155887849279, 226.9289918321014, 217.27884447336461], "policy_agent_4_reward": [267.70475407792605, 242.85580671103207, 247.36075468051416, 242.65926056951162, 243.98923719577095, 241.35365149520737, 252.07339077518998, 241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.532831445641794, "mean_inference_ms": 0.4628888922634742, "mean_action_processing_ms": 0.09825490439042867, "mean_env_wait_ms": 0.12066812610959982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011879205703735352, "StateBufferConnector_ms": 0.003012418746948242, "ViewRequirementAgentConnector_ms": 0.0809168815612793}}, "episode_reward_max": 1255.3657952717529, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1229.6632974237407, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 278.86069984445743, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 209.98682118576983, "agent_4": 241.35365149520737}, "policy_reward_max": {"agent_0": 299.03617515707094, "agent_1": 247.31269889289757, "agent_2": 256.803166114384, "agent_3": 227.52651994429914, "agent_4": 267.70475407792605}, "policy_reward_mean": {"agent_0": 289.72224436770625, "agent_1": 230.71575827721685, "agent_2": 243.87885232548257, "agent_3": 217.84808063104316, "agent_4": 247.49836182229149}, "hist_stats": {"episode_reward": [1241.5431314864966, 1240.065473895638, 1255.3657952717529, 1234.5017455824589, 1223.1358649402514, 1223.263079564165, 1229.318730909351, 1190.1125577398122], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [296.0480731673513, 288.153605641812, 288.3458524491347, 299.03617515707094, 290.82707547917596, 278.86069984445743, 292.9830493171358, 283.52342388551233], "policy_agent_1_reward": [217.86230879833357, 238.1875259242754, 237.9771157270395, 247.31269889289757, 234.3181948015102, 231.7775449941507, 222.70215829708064, 215.5885187824473], "policy_agent_2_reward": [248.3686754868613, 256.803166114384, 254.15555247076446, 235.50678977720892, 242.27816809607, 247.55559444542118, 234.63114068784267, 231.7317315253082], "policy_agent_3_reward": [211.55931995602407, 214.06536950413405, 227.52651994429914, 209.98682118576983, 211.7231893677244, 223.7155887849279, 226.9289918321014, 217.27884447336461], "policy_agent_4_reward": [267.70475407792605, 242.85580671103207, 247.36075468051416, 242.65926056951162, 243.98923719577095, 241.35365149520737, 252.07339077518998, 241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.532831445641794, "mean_inference_ms": 0.4628888922634742, "mean_action_processing_ms": 0.09825490439042867, "mean_env_wait_ms": 0.12066812610959982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011879205703735352, "StateBufferConnector_ms": 0.003012418746948242, "ViewRequirementAgentConnector_ms": 0.0809168815612793}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111968, "num_agent_steps_trained": 111968, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 984.5014462484505, "num_env_steps_trained_throughput_per_sec": 984.5014462484505, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 111968, "timers": {"training_iteration_time_ms": 3634.548, "sample_time_ms": 677.528, "learn_time_ms": 2942.882, "learn_throughput": 1359.212, "synch_weights_time_ms": 12.869}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 111968, "num_agent_steps_trained": 111968}, "done": false, "episodes_total": 56, "training_iteration": 28, "trial_id": "72c65_00000", "date": "2025-03-18_16-00-56", "timestamp": 1742310056, "time_this_iter_s": 4.07440185546875, "time_total_s": 102.80534648895264, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 102.80534648895264, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 9.75, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 8.330066680908203, "policy_loss": -0.02463361620903015, "vf_loss": 8.354209899902344, "vf_explained_var": 9.124506323132664e-05, "kl": 0.004901250824332237, "entropy": 1.357054352760315, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.647880554199219, "policy_loss": -0.0321153849363327, "vf_loss": 8.679512977600098, "vf_explained_var": -0.00040456026908941567, "kl": 0.009660103358328342, "entropy": 1.5631382465362549, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.592479705810547, "policy_loss": -0.030063875019550323, "vf_loss": 8.622102737426758, "vf_explained_var": 0.00012280656665097922, "kl": 0.00881399866193533, "entropy": 1.6448471546173096, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.442917823791504, "policy_loss": -0.032040465623140335, "vf_loss": 7.474778175354004, "vf_explained_var": 0.00012921122834086418, "kl": 0.007216923404484987, "entropy": 1.5832505226135254, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.727787971496582, "policy_loss": -0.018773367628455162, "vf_loss": 8.746269226074219, "vf_explained_var": -1.64843731909059e-05, "kl": 0.005845953244715929, "entropy": 1.198797583580017, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 115968, "num_agent_steps_trained": 115968}, "sampler_results": {"episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}}, "episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115968, "num_agent_steps_trained": 115968, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1154.6678966815064, "num_env_steps_trained_throughput_per_sec": 1154.6678966815064, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 115968, "timers": {"training_iteration_time_ms": 3637.476, "sample_time_ms": 679.164, "learn_time_ms": 2944.17, "learn_throughput": 1358.617, "synch_weights_time_ms": 12.807}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 115968, "num_agent_steps_trained": 115968}, "done": false, "episodes_total": 56, "training_iteration": 29, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-00", "timestamp": 1742310060, "time_this_iter_s": 3.477243661880493, "time_total_s": 106.28259015083313, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede31e10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 106.28259015083313, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.400591850280762, "policy_loss": -0.02569577842950821, "vf_loss": 8.425857543945312, "vf_explained_var": 0.00015778570377733558, "kl": 0.008584827184677124, "entropy": 1.4264378547668457, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.1079740524292, "policy_loss": -0.02875472977757454, "vf_loss": 8.136287689208984, "vf_explained_var": 0.00030663807410746813, "kl": 0.008841171860694885, "entropy": 1.4900312423706055, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.351089477539062, "policy_loss": -0.03242278844118118, "vf_loss": 8.382997512817383, "vf_explained_var": -1.4344567716761958e-05, "kl": 0.010298147797584534, "entropy": 1.6061830520629883, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.958133220672607, "policy_loss": -0.04348523169755936, "vf_loss": 8.001388549804688, "vf_explained_var": 0.0003317645750939846, "kl": 0.009238570928573608, "entropy": 1.4235191345214844, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.086995124816895, "policy_loss": -0.006183754652738571, "vf_loss": 9.092896461486816, "vf_explained_var": -1.1478435226308648e-05, "kl": 0.005637529771775007, "entropy": 1.0787400007247925, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 119968, "num_agent_steps_trained": 119968}, "sampler_results": {"episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}}, "episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119968, "num_agent_steps_trained": 119968, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.6562866427178, "num_env_steps_trained_throughput_per_sec": 1159.6562866427178, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 119968, "timers": {"training_iteration_time_ms": 3586.607, "sample_time_ms": 626.078, "learn_time_ms": 2946.261, "learn_throughput": 1357.653, "synch_weights_time_ms": 12.914}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 119968, "num_agent_steps_trained": 119968}, "done": false, "episodes_total": 56, "training_iteration": 30, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-04", "timestamp": 1742310064, "time_this_iter_s": 3.4626872539520264, "time_total_s": 109.74527740478516, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb3eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 109.74527740478516, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.0881667137146, "policy_loss": -0.03307854384183884, "vf_loss": 7.1208624839782715, "vf_explained_var": 0.00015137706941459328, "kl": 0.007661622948944569, "entropy": 1.336587905883789, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.559643745422363, "policy_loss": -0.02832653932273388, "vf_loss": 8.587520599365234, "vf_explained_var": -0.00015984376659616828, "kl": 0.00898800790309906, "entropy": 1.4146839380264282, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.53458309173584, "policy_loss": -0.03870024159550667, "vf_loss": 8.572704315185547, "vf_explained_var": -1.4085712791711558e-05, "kl": 0.011579940095543861, "entropy": 1.4516334533691406, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.386076927185059, "policy_loss": -0.031790219247341156, "vf_loss": 7.4177350997924805, "vf_explained_var": 0.0001541228557471186, "kl": 0.0053037130273878574, "entropy": 1.3645373582839966, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.691688537597656, "policy_loss": -0.02034570463001728, "vf_loss": 8.711785316467285, "vf_explained_var": 7.32302651158534e-05, "kl": 0.004972806200385094, "entropy": 0.9897981286048889, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 123968, "num_agent_steps_trained": 123968}, "sampler_results": {"episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}}, "episode_reward_max": 1190.1125577398122, "episode_reward_min": 1190.1125577398122, "episode_reward_mean": 1190.1125577398122, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_max": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "policy_reward_mean": {"agent_0": 283.52342388551233, "agent_1": 215.5885187824473, "agent_2": 231.7317315253082, "agent_3": 217.27884447336461, "agent_4": 241.9900390731797}, "hist_stats": {"episode_reward": [1190.1125577398122], "episode_lengths": [1995], "policy_agent_0_reward": [283.52342388551233], "policy_agent_1_reward": [215.5885187824473], "policy_agent_2_reward": [231.7317315253082], "policy_agent_3_reward": [217.27884447336461], "policy_agent_4_reward": [241.9900390731797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5261646527135792, "mean_inference_ms": 0.4477090864860622, "mean_action_processing_ms": 0.09337441170780107, "mean_env_wait_ms": 0.11733444867223665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0109100341796875, "StateBufferConnector_ms": 0.0025177001953125, "ViewRequirementAgentConnector_ms": 0.07310867309570312}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123968, "num_agent_steps_trained": 123968, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1151.9888907321329, "num_env_steps_trained_throughput_per_sec": 1151.9888907321329, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 123968, "timers": {"training_iteration_time_ms": 3567.191, "sample_time_ms": 626.357, "learn_time_ms": 2926.068, "learn_throughput": 1367.022, "synch_weights_time_ms": 13.358}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 123968, "num_agent_steps_trained": 123968}, "done": false, "episodes_total": 56, "training_iteration": 31, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-07", "timestamp": 1742310067, "time_this_iter_s": 3.483768939971924, "time_total_s": 113.22904634475708, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb1480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 113.22904634475708, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 10.260000000000002, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.317038536071777, "policy_loss": -0.026293864473700523, "vf_loss": 9.342939376831055, "vf_explained_var": 9.61536443355726e-06, "kl": 0.007856473326683044, "entropy": 1.391740083694458, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.306960105895996, "policy_loss": -0.03231143578886986, "vf_loss": 9.338899612426758, "vf_explained_var": 6.073997269595566e-07, "kl": 0.00744217075407505, "entropy": 1.396389365196228, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.11166763305664, "policy_loss": -0.03188912570476532, "vf_loss": 9.143207550048828, "vf_explained_var": 2.023861452471465e-05, "kl": 0.00698936777189374, "entropy": 1.4057742357254028, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.351147651672363, "policy_loss": -0.025460246950387955, "vf_loss": 9.376441955566406, "vf_explained_var": 3.911200110451318e-06, "kl": 0.006632095668464899, "entropy": 1.3408012390136719, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.008376121520996, "policy_loss": -0.023474058136343956, "vf_loss": 9.031726837158203, "vf_explained_var": -1.1777878171415068e-05, "kl": 0.004957216326147318, "entropy": 0.9388483166694641, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 127968, "num_agent_steps_trained": 127968}, "sampler_results": {"episode_reward_max": 1391.2708554959338, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1338.1645167502866, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 293.33264477183275, "agent_1": 236.8623781864567, "agent_2": 250.6078840549743, "agent_3": 247.62841985418783, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 315.16919527163583, "agent_1": 259.25261529277, "agent_2": 279.42733794208266, "agent_3": 271.2430532921051, "agent_4": 280.92953449303604}, "policy_reward_mean": {"agent_0": 307.2238297582486, "agent_1": 247.69244939248443, "agent_2": 263.56066468575534, "agent_3": 255.96907856611077, "agent_4": 263.7184943476874}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1319.0816787673907, 1391.2708554959338, 1330.915627021732, 1316.9474070130661, 1344.8469763839314, 1341.3763418785857, 1362.743831441106, 1298.1334160005465], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [302.6070897988251, 314.87691396194197, 315.16919527163583, 309.11370752619473, 313.12595127338506, 293.33264477183275, 305.94163129028044, 303.6235041718928], "policy_agent_1_reward": [247.3730523881019, 252.29060421117046, 241.27760568343763, 236.8623781864567, 247.00927973601787, 254.73989030087236, 259.25261529277, 242.73416934104864], "policy_agent_2_reward": [252.34321167335492, 271.93074953768047, 264.2720794310779, 257.286189869351, 266.78959752612644, 265.82826745139494, 279.42733794208266, 250.6078840549743], "policy_agent_3_reward": [257.3872520450102, 271.2430532921051, 249.27218727435243, 248.19932264912484, 247.62841985418783, 253.34372847931024, 265.52973224214065, 255.14893269265497], "policy_agent_4_reward": [259.37107286209897, 280.92953449303604, 260.9245593612282, 265.48580878193894, 270.2937279942141, 274.131810875175, 252.5925146738322, 246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326192234912579, "mean_inference_ms": 0.4610881497134165, "mean_action_processing_ms": 0.09811525568054077, "mean_env_wait_ms": 0.11554650385434476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011564493179321289, "StateBufferConnector_ms": 0.002970099449157715, "ViewRequirementAgentConnector_ms": 0.0787431001663208}}, "episode_reward_max": 1391.2708554959338, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1338.1645167502866, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 293.33264477183275, "agent_1": 236.8623781864567, "agent_2": 250.6078840549743, "agent_3": 247.62841985418783, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 315.16919527163583, "agent_1": 259.25261529277, "agent_2": 279.42733794208266, "agent_3": 271.2430532921051, "agent_4": 280.92953449303604}, "policy_reward_mean": {"agent_0": 307.2238297582486, "agent_1": 247.69244939248443, "agent_2": 263.56066468575534, "agent_3": 255.96907856611077, "agent_4": 263.7184943476874}, "hist_stats": {"episode_reward": [1319.0816787673907, 1391.2708554959338, 1330.915627021732, 1316.9474070130661, 1344.8469763839314, 1341.3763418785857, 1362.743831441106, 1298.1334160005465], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [302.6070897988251, 314.87691396194197, 315.16919527163583, 309.11370752619473, 313.12595127338506, 293.33264477183275, 305.94163129028044, 303.6235041718928], "policy_agent_1_reward": [247.3730523881019, 252.29060421117046, 241.27760568343763, 236.8623781864567, 247.00927973601787, 254.73989030087236, 259.25261529277, 242.73416934104864], "policy_agent_2_reward": [252.34321167335492, 271.93074953768047, 264.2720794310779, 257.286189869351, 266.78959752612644, 265.82826745139494, 279.42733794208266, 250.6078840549743], "policy_agent_3_reward": [257.3872520450102, 271.2430532921051, 249.27218727435243, 248.19932264912484, 247.62841985418783, 253.34372847931024, 265.52973224214065, 255.14893269265497], "policy_agent_4_reward": [259.37107286209897, 280.92953449303604, 260.9245593612282, 265.48580878193894, 270.2937279942141, 274.131810875175, 252.5925146738322, 246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5326192234912579, "mean_inference_ms": 0.4610881497134165, "mean_action_processing_ms": 0.09811525568054077, "mean_env_wait_ms": 0.11554650385434476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011564493179321289, "StateBufferConnector_ms": 0.002970099449157715, "ViewRequirementAgentConnector_ms": 0.0787431001663208}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127968, "num_agent_steps_trained": 127968, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1010.8075547688933, "num_env_steps_trained_throughput_per_sec": 1010.8075547688933, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 127968, "timers": {"training_iteration_time_ms": 3616.63, "sample_time_ms": 679.771, "learn_time_ms": 2922.131, "learn_throughput": 1368.864, "synch_weights_time_ms": 13.285}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 127968, "num_agent_steps_trained": 127968}, "done": false, "episodes_total": 64, "training_iteration": 32, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-11", "timestamp": 1742310071, "time_this_iter_s": 3.969573974609375, "time_total_s": 117.19862031936646, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb3eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 117.19862031936646, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 9.666666666666666, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.979063034057617, "policy_loss": -0.023366665467619896, "vf_loss": 8.00211238861084, "vf_explained_var": 2.1511315935640596e-05, "kl": 0.006360860075801611, "entropy": 1.298580527305603, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.231224060058594, "policy_loss": -0.021271033212542534, "vf_loss": 8.252153396606445, "vf_explained_var": 9.637361654313281e-05, "kl": 0.006847263313829899, "entropy": 1.358444094657898, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.465472221374512, "policy_loss": -0.03533942997455597, "vf_loss": 8.500295639038086, "vf_explained_var": -1.1310123227303848e-05, "kl": 0.01031771395355463, "entropy": 1.3310741186141968, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.304185390472412, "policy_loss": -0.036027371883392334, "vf_loss": 7.340028762817383, "vf_explained_var": 0.00011245239147683606, "kl": 0.007366581354290247, "entropy": 1.344625473022461, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 8.675582885742188, "policy_loss": -0.01802973262965679, "vf_loss": 8.693559646606445, "vf_explained_var": 6.795468652853742e-05, "kl": 0.004314345773309469, "entropy": 0.8801946640014648, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 131968, "num_agent_steps_trained": 131968}, "sampler_results": {"episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}}, "episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131968, "num_agent_steps_trained": 131968, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1171.7670154590655, "num_env_steps_trained_throughput_per_sec": 1171.7670154590655, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 131968, "timers": {"training_iteration_time_ms": 3617.92, "sample_time_ms": 682.554, "learn_time_ms": 2920.691, "learn_throughput": 1369.539, "synch_weights_time_ms": 13.174}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 131968, "num_agent_steps_trained": 131968}, "done": false, "episodes_total": 64, "training_iteration": 33, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-15", "timestamp": 1742310075, "time_this_iter_s": 3.4278693199157715, "time_total_s": 120.62648963928223, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb1480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 120.62648963928223, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.16, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.224534034729004, "policy_loss": -0.022170597687363625, "vf_loss": 7.246400833129883, "vf_explained_var": 6.541751645272598e-06, "kl": 0.0060608577914536, "entropy": 1.2732526063919067, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.220868110656738, "policy_loss": -0.02879270538687706, "vf_loss": 7.249113082885742, "vf_explained_var": -7.477885083062574e-05, "kl": 0.010961578227579594, "entropy": 1.230992078781128, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.867870330810547, "policy_loss": -0.02908591367304325, "vf_loss": 8.896571159362793, "vf_explained_var": -3.105061477981508e-05, "kl": 0.007689753081649542, "entropy": 1.2201412916183472, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.059335708618164, "policy_loss": -0.017485998570919037, "vf_loss": 7.076661109924316, "vf_explained_var": 1.4088267562328838e-05, "kl": 0.006423988379538059, "entropy": 1.2168031930923462, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 8.945194244384766, "policy_loss": -0.01845802739262581, "vf_loss": 8.963628768920898, "vf_explained_var": -1.9799243091256358e-05, "kl": 0.0038214121013879776, "entropy": 0.7896267771720886, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 135968, "num_agent_steps_trained": 135968}, "sampler_results": {"episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}}, "episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135968, "num_agent_steps_trained": 135968, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1165.6941672547057, "num_env_steps_trained_throughput_per_sec": 1165.6941672547057, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 135968, "timers": {"training_iteration_time_ms": 3557.462, "sample_time_ms": 621.006, "learn_time_ms": 2921.387, "learn_throughput": 1369.212, "synch_weights_time_ms": 13.428}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 135968, "num_agent_steps_trained": 135968}, "done": false, "episodes_total": 64, "training_iteration": 34, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-18", "timestamp": 1742310078, "time_this_iter_s": 3.4416375160217285, "time_total_s": 124.06812715530396, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede31fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 124.06812715530396, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.319999999999999, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.482532978057861, "policy_loss": -0.03761698305606842, "vf_loss": 6.5196967124938965, "vf_explained_var": -4.502620140556246e-05, "kl": 0.009055579081177711, "entropy": 1.1259868144989014, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.193876266479492, "policy_loss": -0.02927474118769169, "vf_loss": 8.222856521606445, "vf_explained_var": -0.00013179211237002164, "kl": 0.005909756291657686, "entropy": 1.2315528392791748, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 8.291266441345215, "policy_loss": -0.031016383320093155, "vf_loss": 8.321752548217773, "vf_explained_var": 4.552999962470494e-05, "kl": 0.010614488273859024, "entropy": 1.1197178363800049, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.93507194519043, "policy_loss": -0.025120671838521957, "vf_loss": 5.9600677490234375, "vf_explained_var": 8.220842573791742e-05, "kl": 0.005000329576432705, "entropy": 1.1676884889602661, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 8.693883895874023, "policy_loss": -0.017580227926373482, "vf_loss": 8.711445808410645, "vf_explained_var": -1.043081283569336e-05, "kl": 0.006061075255274773, "entropy": 0.8097051978111267, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 139968, "num_agent_steps_trained": 139968}, "sampler_results": {"episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}}, "episode_reward_max": 1298.1334160005465, "episode_reward_min": 1298.1334160005465, "episode_reward_mean": 1298.1334160005465, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_max": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "policy_reward_mean": {"agent_0": 303.6235041718928, "agent_1": 242.73416934104864, "agent_2": 250.6078840549743, "agent_3": 255.14893269265497, "agent_4": 246.01892573997594}, "hist_stats": {"episode_reward": [1298.1334160005465], "episode_lengths": [1995], "policy_agent_0_reward": [303.6235041718928], "policy_agent_1_reward": [242.73416934104864], "policy_agent_2_reward": [250.6078840549743], "policy_agent_3_reward": [255.14893269265497], "policy_agent_4_reward": [246.01892573997594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5256806185197684, "mean_inference_ms": 0.44564150041449435, "mean_action_processing_ms": 0.09325218009960651, "mean_env_wait_ms": 0.11205056348254357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010900497436523438, "StateBufferConnector_ms": 0.002498626708984375, "ViewRequirementAgentConnector_ms": 0.07221221923828125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139968, "num_agent_steps_trained": 139968, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1149.3903965856207, "num_env_steps_trained_throughput_per_sec": 1149.3903965856207, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 139968, "timers": {"training_iteration_time_ms": 3560.416, "sample_time_ms": 622.812, "learn_time_ms": 2922.604, "learn_throughput": 1368.642, "synch_weights_time_ms": 13.335}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 139968, "num_agent_steps_trained": 139968}, "done": false, "episodes_total": 64, "training_iteration": 35, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-22", "timestamp": 1742310082, "time_this_iter_s": 3.4918978214263916, "time_total_s": 127.56002497673035, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede323b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 127.56002497673035, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 9.98, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.230971336364746, "policy_loss": -0.01599791646003723, "vf_loss": 9.246735572814941, "vf_explained_var": -1.1027994332835078e-05, "kl": 0.0046715945936739445, "entropy": 1.1083487272262573, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.23633861541748, "policy_loss": -0.024916568771004677, "vf_loss": 9.260907173156738, "vf_explained_var": -1.4327821190818213e-05, "kl": 0.00695654796436429, "entropy": 1.1608197689056396, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.204217910766602, "policy_loss": -0.020067397505044937, "vf_loss": 9.224092483520508, "vf_explained_var": 1.8213193470728584e-05, "kl": 0.003850710578262806, "entropy": 1.0884943008422852, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.257832527160645, "policy_loss": -0.026693563908338547, "vf_loss": 9.284284591674805, "vf_explained_var": 1.2151400369475596e-05, "kl": 0.009614280425012112, "entropy": 1.1998958587646484, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 9.168703079223633, "policy_loss": -0.018872134387493134, "vf_loss": 9.187562942504883, "vf_explained_var": 8.056845217652153e-06, "kl": 0.0038295637350529432, "entropy": 0.8305068016052246, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 143968, "num_agent_steps_trained": 143968}, "sampler_results": {"episode_reward_max": 1458.0644303362203, "episode_reward_min": 1438.6913107582975, "episode_reward_mean": 1448.5742716348889, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 313.4640987393254, "agent_1": 255.08465030849393, "agent_2": 272.3291687131471, "agent_3": 262.15192939666906, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 282.35085801383593, "agent_2": 291.8111697574783, "agent_3": 280.21875213074327, "agent_4": 313.3262412786769}, "policy_reward_mean": {"agent_0": 324.6986429415911, "agent_1": 267.24466546255087, "agent_2": 283.67281963885773, "agent_3": 271.57287269523016, "agent_4": 301.38527089665905}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1444.7287892891911, 1451.4198626692796, 1438.6913107582975, 1439.1259567430204, 1458.0644303362203, 1451.1266098649223, 1456.989103663369, 1448.4481097548112], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [328.6701430604639, 322.99810787636375, 313.4640987393254, 321.589408670002, 329.7399138617282, 318.1749501475959, 327.15823667360803, 335.7942845036418], "policy_agent_1_reward": [265.2323330417028, 273.2878084288073, 255.08465030849393, 263.4943432579101, 282.35085801383593, 256.55374267170134, 269.6617031552739, 272.2918848226817], "policy_agent_2_reward": [290.16837966972, 281.86229623988993, 287.21541959179854, 281.522358162955, 279.6431958290866, 291.8111697574783, 284.83056914678616, 272.3291687131471], "policy_agent_3_reward": [262.15192939666906, 270.8575138804753, 269.6009008400024, 280.21875213074327, 266.4114569211732, 276.27174331465886, 271.27439450444797, 275.7962905736713], "policy_agent_4_reward": [298.50600412063557, 302.4141362437429, 313.3262412786769, 292.30109452141, 299.91900571039616, 308.31500397348816, 304.064200183253, 292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321832843823113, "mean_inference_ms": 0.4596581598644979, "mean_action_processing_ms": 0.09783787711727163, "mean_env_wait_ms": 0.11138795223588925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011311769485473633, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.07753491401672363}}, "episode_reward_max": 1458.0644303362203, "episode_reward_min": 1438.6913107582975, "episode_reward_mean": 1448.5742716348889, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 313.4640987393254, "agent_1": 255.08465030849393, "agent_2": 272.3291687131471, "agent_3": 262.15192939666906, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 282.35085801383593, "agent_2": 291.8111697574783, "agent_3": 280.21875213074327, "agent_4": 313.3262412786769}, "policy_reward_mean": {"agent_0": 324.6986429415911, "agent_1": 267.24466546255087, "agent_2": 283.67281963885773, "agent_3": 271.57287269523016, "agent_4": 301.38527089665905}, "hist_stats": {"episode_reward": [1444.7287892891911, 1451.4198626692796, 1438.6913107582975, 1439.1259567430204, 1458.0644303362203, 1451.1266098649223, 1456.989103663369, 1448.4481097548112], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [328.6701430604639, 322.99810787636375, 313.4640987393254, 321.589408670002, 329.7399138617282, 318.1749501475959, 327.15823667360803, 335.7942845036418], "policy_agent_1_reward": [265.2323330417028, 273.2878084288073, 255.08465030849393, 263.4943432579101, 282.35085801383593, 256.55374267170134, 269.6617031552739, 272.2918848226817], "policy_agent_2_reward": [290.16837966972, 281.86229623988993, 287.21541959179854, 281.522358162955, 279.6431958290866, 291.8111697574783, 284.83056914678616, 272.3291687131471], "policy_agent_3_reward": [262.15192939666906, 270.8575138804753, 269.6009008400024, 280.21875213074327, 266.4114569211732, 276.27174331465886, 271.27439450444797, 275.7962905736713], "policy_agent_4_reward": [298.50600412063557, 302.4141362437429, 313.3262412786769, 292.30109452141, 299.91900571039616, 308.31500397348816, 304.064200183253, 292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321832843823113, "mean_inference_ms": 0.4596581598644979, "mean_action_processing_ms": 0.09783787711727163, "mean_env_wait_ms": 0.11138795223588925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011311769485473633, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.07753491401672363}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143968, "num_agent_steps_trained": 143968, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1000.8050122046293, "num_env_steps_trained_throughput_per_sec": 1000.8050122046293, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 143968, "timers": {"training_iteration_time_ms": 3612.406, "sample_time_ms": 676.292, "learn_time_ms": 2921.229, "learn_throughput": 1369.287, "synch_weights_time_ms": 13.076}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 143968, "num_agent_steps_trained": 143968}, "done": false, "episodes_total": 72, "training_iteration": 36, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-26", "timestamp": 1742310086, "time_this_iter_s": 4.011033058166504, "time_total_s": 131.57105803489685, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 131.57105803489685, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 9.700000000000001, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.359136581420898, "policy_loss": -0.019745519384741783, "vf_loss": 5.378717422485352, "vf_explained_var": 4.343589171185158e-05, "kl": 0.006605471950024366, "entropy": 1.0335100889205933, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 7.786065578460693, "policy_loss": -0.028193850070238113, "vf_loss": 7.813918113708496, "vf_explained_var": -0.00015473479288630188, "kl": 0.00682621356099844, "entropy": 1.1156710386276245, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 8.632580757141113, "policy_loss": -0.020675823092460632, "vf_loss": 8.653105735778809, "vf_explained_var": 7.073936103552114e-06, "kl": 0.006007764954119921, "entropy": 1.0379366874694824, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.831902027130127, "policy_loss": -0.03623628243803978, "vf_loss": 5.867913722991943, "vf_explained_var": 2.7716443582903594e-05, "kl": 0.008970106020569801, "entropy": 1.0826221704483032, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 7.767996788024902, "policy_loss": -0.024504903703927994, "vf_loss": 7.792486667633057, "vf_explained_var": -2.2150220502226148e-06, "kl": 0.009393668733537197, "entropy": 0.8331494927406311, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 147968, "num_agent_steps_trained": 147968}, "sampler_results": {"episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}}, "episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147968, "num_agent_steps_trained": 147968, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1157.8401442033135, "num_env_steps_trained_throughput_per_sec": 1157.8401442033135, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 147968, "timers": {"training_iteration_time_ms": 3618.218, "sample_time_ms": 679.916, "learn_time_ms": 2923.444, "learn_throughput": 1368.249, "synch_weights_time_ms": 13.046}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 147968, "num_agent_steps_trained": 147968}, "done": false, "episodes_total": 72, "training_iteration": 37, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-30", "timestamp": 1742310090, "time_this_iter_s": 3.468604803085327, "time_total_s": 135.03966283798218, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 135.03966283798218, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.4408278465271, "policy_loss": -0.025722432881593704, "vf_loss": 5.466305255889893, "vf_explained_var": 2.3565122319268994e-05, "kl": 0.009809989482164383, "entropy": 0.9804819822311401, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.779275894165039, "policy_loss": -0.03548474237322807, "vf_loss": 6.814162254333496, "vf_explained_var": 2.088064320560079e-05, "kl": 0.01196611113846302, "entropy": 1.0531699657440186, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 8.447888374328613, "policy_loss": -0.021876467391848564, "vf_loss": 8.46965217590332, "vf_explained_var": 4.1944640543079e-06, "kl": 0.004519733600318432, "entropy": 0.9628183841705322, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 6.799528121948242, "policy_loss": -0.02378939650952816, "vf_loss": 6.823200225830078, "vf_explained_var": 4.408530003274791e-05, "kl": 0.004702521953731775, "entropy": 0.9766697287559509, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 8.035426139831543, "policy_loss": -0.019590575248003006, "vf_loss": 8.055009841918945, "vf_explained_var": 6.525090429931879e-05, "kl": 0.005073841195553541, "entropy": 0.8138519525527954, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 151968, "num_agent_steps_trained": 151968}, "sampler_results": {"episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}}, "episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151968, "num_agent_steps_trained": 151968, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1142.6083853313228, "num_env_steps_trained_throughput_per_sec": 1142.6083853313228, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 151968, "timers": {"training_iteration_time_ms": 3561.997, "sample_time_ms": 619.774, "learn_time_ms": 2927.44, "learn_throughput": 1366.382, "synch_weights_time_ms": 12.958}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 151968, "num_agent_steps_trained": 151968}, "done": false, "episodes_total": 72, "training_iteration": 38, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-33", "timestamp": 1742310093, "time_this_iter_s": 3.513657808303833, "time_total_s": 138.553320646286, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 138.553320646286, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.597701072692871, "policy_loss": -0.018996383994817734, "vf_loss": 5.616459846496582, "vf_explained_var": 5.5639800848439336e-05, "kl": 0.009511776268482208, "entropy": 0.9721947312355042, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 6.140337944030762, "policy_loss": -0.023722821846604347, "vf_loss": 6.163781642913818, "vf_explained_var": 7.855693547753617e-05, "kl": 0.00557554280385375, "entropy": 0.9215405583381653, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 8.358866691589355, "policy_loss": -0.011798141524195671, "vf_loss": 8.370630264282227, "vf_explained_var": 1.173246437247144e-05, "kl": 0.002731530461460352, "entropy": 0.8944058418273926, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 4.881694793701172, "policy_loss": -0.010843551717698574, "vf_loss": 4.892487525939941, "vf_explained_var": 1.9985152903245762e-05, "kl": 0.0040411329828202724, "entropy": 0.9586212635040283, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 7.608480930328369, "policy_loss": -0.016183841973543167, "vf_loss": 7.624653339385986, "vf_explained_var": 5.429983048088616e-06, "kl": 0.007108275778591633, "entropy": 0.7352330684661865, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 155968, "num_agent_steps_trained": 155968}, "sampler_results": {"episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}}, "episode_reward_max": 1448.4481097548112, "episode_reward_min": 1448.4481097548112, "episode_reward_mean": 1448.4481097548112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_max": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "policy_reward_mean": {"agent_0": 335.7942845036418, "agent_1": 272.2918848226817, "agent_2": 272.3291687131471, "agent_3": 275.7962905736713, "agent_4": 292.2364811416696}, "hist_stats": {"episode_reward": [1448.4481097548112], "episode_lengths": [1995], "policy_agent_0_reward": [335.7942845036418], "policy_agent_1_reward": [272.2918848226817], "policy_agent_2_reward": [272.3291687131471], "policy_agent_3_reward": [275.7962905736713], "policy_agent_4_reward": [292.2364811416696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5255706521790727, "mean_inference_ms": 0.4448340367055007, "mean_action_processing_ms": 0.09311700448692657, "mean_env_wait_ms": 0.10796377615268797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010972023010253906, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.0742197036743164}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155968, "num_agent_steps_trained": 155968, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.8137353582056, "num_env_steps_trained_throughput_per_sec": 1159.8137353582056, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 155968, "timers": {"training_iteration_time_ms": 3560.461, "sample_time_ms": 619.466, "learn_time_ms": 2926.166, "learn_throughput": 1366.976, "synch_weights_time_ms": 12.961}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 155968, "num_agent_steps_trained": 155968}, "done": false, "episodes_total": 72, "training_iteration": 39, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-37", "timestamp": 1742310097, "time_this_iter_s": 3.4604852199554443, "time_total_s": 142.01380586624146, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede33e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 142.01380586624146, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.173544883728027, "policy_loss": -0.02342412993311882, "vf_loss": 9.196821212768555, "vf_explained_var": 6.682248567813076e-06, "kl": 0.005867140833288431, "entropy": 0.9330079555511475, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.159433364868164, "policy_loss": -0.02351399138569832, "vf_loss": 9.182701110839844, "vf_explained_var": 5.542096459976165e-06, "kl": 0.004918962251394987, "entropy": 0.919632077217102, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.210689544677734, "policy_loss": -0.020233089104294777, "vf_loss": 9.230895042419434, "vf_explained_var": -2.169892923120642e-06, "kl": 0.0043915132991969585, "entropy": 0.8481222987174988, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.130568504333496, "policy_loss": -0.015401833690702915, "vf_loss": 9.145936965942383, "vf_explained_var": 5.501792657014448e-06, "kl": 0.005372307263314724, "entropy": 0.9706043004989624, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 9.062434196472168, "policy_loss": -0.022079728543758392, "vf_loss": 9.08450984954834, "vf_explained_var": -4.512923226229759e-07, "kl": 0.0026282556354999542, "entropy": 0.7457636594772339, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 159968, "num_agent_steps_trained": 159968}, "sampler_results": {"episode_reward_max": 1554.006333250438, "episode_reward_min": 1500.6390502230063, "episode_reward_mean": 1538.7442842495007, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 316.6912773723365, "agent_1": 273.083916503464, "agent_2": 291.0696465527201, "agent_3": 285.71621778338175, "agent_4": 310.43245751951144}, "policy_reward_max": {"agent_0": 333.41643280804254, "agent_1": 300.7021101947428, "agent_2": 315.5534591845494, "agent_3": 302.54932400038456, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 324.41514784082267, "agent_1": 287.34181956805537, "agent_2": 307.0978953513642, "agent_3": 292.28345254679516, "agent_4": 327.60596894246373}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1553.357087978078, 1532.374881319401, 1543.3589294416809, 1543.5757951890168, 1500.6390502230063, 1536.5522800663066, 1554.006333250438, 1546.089916528078], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [325.9834912658847, 333.41643280804254, 323.55543603844325, 323.32615893386793, 316.6912773723365, 329.151301079867, 325.863127705496, 317.3339575226434], "policy_agent_1_reward": [300.7021101947428, 282.19204743952673, 293.90846889187856, 294.02890374211404, 273.083916503464, 282.60283175842477, 287.25162158818034, 284.9646564261114], "policy_agent_2_reward": [315.5534591845494, 306.9863070874896, 305.21097816103537, 308.7470278363265, 291.0696465527201, 306.1478370637741, 311.74712631179125, 311.3207806132267], "policy_agent_3_reward": [291.72108663592644, 299.3476364648311, 295.44282939631955, 288.37375195394486, 288.65475694557864, 285.71621778338175, 302.54932400038456, 286.46201719399437], "policy_agent_4_reward": [319.3969406969748, 310.43245751951144, 325.24121695400476, 329.0999527227639, 331.1394528489071, 332.9340923808592, 326.5951336445858, 346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321494877728801, "mean_inference_ms": 0.4588104425016138, "mean_action_processing_ms": 0.09780822560272362, "mean_env_wait_ms": 0.10823705519302435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012024641036987305, "StateBufferConnector_ms": 0.0030416250228881836, "ViewRequirementAgentConnector_ms": 0.08201301097869873}}, "episode_reward_max": 1554.006333250438, "episode_reward_min": 1500.6390502230063, "episode_reward_mean": 1538.7442842495007, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 316.6912773723365, "agent_1": 273.083916503464, "agent_2": 291.0696465527201, "agent_3": 285.71621778338175, "agent_4": 310.43245751951144}, "policy_reward_max": {"agent_0": 333.41643280804254, "agent_1": 300.7021101947428, "agent_2": 315.5534591845494, "agent_3": 302.54932400038456, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 324.41514784082267, "agent_1": 287.34181956805537, "agent_2": 307.0978953513642, "agent_3": 292.28345254679516, "agent_4": 327.60596894246373}, "hist_stats": {"episode_reward": [1553.357087978078, 1532.374881319401, 1543.3589294416809, 1543.5757951890168, 1500.6390502230063, 1536.5522800663066, 1554.006333250438, 1546.089916528078], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [325.9834912658847, 333.41643280804254, 323.55543603844325, 323.32615893386793, 316.6912773723365, 329.151301079867, 325.863127705496, 317.3339575226434], "policy_agent_1_reward": [300.7021101947428, 282.19204743952673, 293.90846889187856, 294.02890374211404, 273.083916503464, 282.60283175842477, 287.25162158818034, 284.9646564261114], "policy_agent_2_reward": [315.5534591845494, 306.9863070874896, 305.21097816103537, 308.7470278363265, 291.0696465527201, 306.1478370637741, 311.74712631179125, 311.3207806132267], "policy_agent_3_reward": [291.72108663592644, 299.3476364648311, 295.44282939631955, 288.37375195394486, 288.65475694557864, 285.71621778338175, 302.54932400038456, 286.46201719399437], "policy_agent_4_reward": [319.3969406969748, 310.43245751951144, 325.24121695400476, 329.0999527227639, 331.1394528489071, 332.9340923808592, 326.5951336445858, 346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321494877728801, "mean_inference_ms": 0.4588104425016138, "mean_action_processing_ms": 0.09780822560272362, "mean_env_wait_ms": 0.10823705519302435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012024641036987305, "StateBufferConnector_ms": 0.0030416250228881836, "ViewRequirementAgentConnector_ms": 0.08201301097869873}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159968, "num_agent_steps_trained": 159968, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 994.2552379218538, "num_env_steps_trained_throughput_per_sec": 994.2552379218538, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 159968, "timers": {"training_iteration_time_ms": 3617.843, "sample_time_ms": 678.553, "learn_time_ms": 2924.586, "learn_throughput": 1367.715, "synch_weights_time_ms": 12.789}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 159968, "num_agent_steps_trained": 159968}, "done": false, "episodes_total": 80, "training_iteration": 40, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-41", "timestamp": 1742310101, "time_this_iter_s": 4.040625333786011, "time_total_s": 146.05443120002747, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede31e10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 146.05443120002747, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 9.883333333333333, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.50120210647583, "policy_loss": -0.018996890634298325, "vf_loss": 5.520046710968018, "vf_explained_var": 4.081016595591791e-05, "kl": 0.006068327464163303, "entropy": 0.8943507075309753, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 6.697420597076416, "policy_loss": -0.024363970384001732, "vf_loss": 6.721647262573242, "vf_explained_var": -5.852778849657625e-05, "kl": 0.005485111381858587, "entropy": 0.8932090401649475, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 7.814657688140869, "policy_loss": -0.026571718975901604, "vf_loss": 7.841210842132568, "vf_explained_var": -8.427528882748447e-06, "kl": 0.005955345928668976, "entropy": 0.7843137979507446, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 4.627719402313232, "policy_loss": -0.024577118456363678, "vf_loss": 4.652244567871094, "vf_explained_var": 9.422614675713703e-05, "kl": 0.008274659514427185, "entropy": 0.9161885380744934, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 7.288902282714844, "policy_loss": -0.011678753420710564, "vf_loss": 7.300577640533447, "vf_explained_var": -1.790665373846423e-05, "kl": 0.0036513942759484053, "entropy": 0.7053149342536926, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 163968}, "sampler_results": {"episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}}, "episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 163968, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1165.456419284933, "num_env_steps_trained_throughput_per_sec": 1165.456419284933, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 163968, "timers": {"training_iteration_time_ms": 3613.83, "sample_time_ms": 673.92, "learn_time_ms": 2925.563, "learn_throughput": 1367.258, "synch_weights_time_ms": 12.471}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 163968, "num_agent_steps_trained": 163968}, "done": false, "episodes_total": 80, "training_iteration": 41, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-44", "timestamp": 1742310104, "time_this_iter_s": 3.445591449737549, "time_total_s": 149.50002264976501, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede32290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 149.50002264976501, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 4.476658821105957, "policy_loss": -0.02282552234828472, "vf_loss": 4.499320030212402, "vf_explained_var": 4.3741008994402364e-05, "kl": 0.006571487989276648, "entropy": 0.8531534671783447, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 7.062976837158203, "policy_loss": -0.01998497173190117, "vf_loss": 7.082888126373291, "vf_explained_var": -4.907988477498293e-05, "kl": 0.0030005720909684896, "entropy": 0.8814297914505005, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 7.968467712402344, "policy_loss": -0.018861448392271996, "vf_loss": 7.987318515777588, "vf_explained_var": -3.2510076835023938e-06, "kl": 0.003500772640109062, "entropy": 0.7544194459915161, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 4.529614448547363, "policy_loss": -0.034230154007673264, "vf_loss": 4.563796043395996, "vf_explained_var": 3.709423981490545e-05, "kl": 0.007755805738270283, "entropy": 0.8854950070381165, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 4.508249282836914, "policy_loss": -0.019065309315919876, "vf_loss": 4.527312755584717, "vf_explained_var": 1.027811140374979e-05, "kl": 0.0040418896824121475, "entropy": 0.6720740795135498, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 167968, "num_agent_steps_trained": 167968}, "sampler_results": {"episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}}, "episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167968, "num_agent_steps_trained": 167968, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.1562444731255, "num_env_steps_trained_throughput_per_sec": 1098.1562444731255, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 167968, "timers": {"training_iteration_time_ms": 3582.354, "sample_time_ms": 620.889, "learn_time_ms": 2947.059, "learn_throughput": 1357.285, "synch_weights_time_ms": 12.501}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 167968, "num_agent_steps_trained": 167968}, "done": false, "episodes_total": 80, "training_iteration": 42, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-48", "timestamp": 1742310108, "time_this_iter_s": 3.6529080867767334, "time_total_s": 153.15293073654175, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 153.15293073654175, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.066666666666668, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.229084491729736, "policy_loss": -0.017899340018630028, "vf_loss": 5.246814727783203, "vf_explained_var": 2.98315571853891e-05, "kl": 0.006772321183234453, "entropy": 0.8732057213783264, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 6.2541022300720215, "policy_loss": -0.021616727113723755, "vf_loss": 6.275662899017334, "vf_explained_var": 2.298468643857632e-06, "kl": 0.004500513430684805, "entropy": 0.8328992128372192, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 7.793233871459961, "policy_loss": -0.014136972837150097, "vf_loss": 7.8073649406433105, "vf_explained_var": -9.166910786007065e-06, "kl": 0.003599896328523755, "entropy": 0.6988137364387512, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 3.74233078956604, "policy_loss": -0.02376580983400345, "vf_loss": 3.7660579681396484, "vf_explained_var": 1.4358758562593721e-05, "kl": 0.006159243173897266, "entropy": 0.8256493210792542, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 5.118483066558838, "policy_loss": -0.021552493795752525, "vf_loss": 5.140035152435303, "vf_explained_var": 4.205306322546676e-05, "kl": 0.005277466028928757, "entropy": 0.5988783836364746, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 171968, "num_agent_steps_trained": 171968}, "sampler_results": {"episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}}, "episode_reward_max": 1546.089916528078, "episode_reward_min": 1546.089916528078, "episode_reward_mean": 1546.089916528078, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_max": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "policy_reward_mean": {"agent_0": 317.3339575226434, "agent_1": 284.9646564261114, "agent_2": 311.3207806132267, "agent_3": 286.46201719399437, "agent_4": 346.008504772103}, "hist_stats": {"episode_reward": [1546.089916528078], "episode_lengths": [1995], "policy_agent_0_reward": [317.3339575226434], "policy_agent_1_reward": [284.9646564261114], "policy_agent_2_reward": [311.3207806132267], "policy_agent_3_reward": [286.46201719399437], "policy_agent_4_reward": [346.008504772103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5274045813662381, "mean_inference_ms": 0.44948891051846335, "mean_action_processing_ms": 0.09393440497576562, "mean_env_wait_ms": 0.10539853485231013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.0028133392333984375, "ViewRequirementAgentConnector_ms": 0.08248329162597656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171968, "num_agent_steps_trained": 171968, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1165.216178606859, "num_env_steps_trained_throughput_per_sec": 1165.216178606859, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 171968, "timers": {"training_iteration_time_ms": 3584.271, "sample_time_ms": 622.339, "learn_time_ms": 2947.444, "learn_throughput": 1357.108, "synch_weights_time_ms": 12.569}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 171968, "num_agent_steps_trained": 171968}, "done": false, "episodes_total": 80, "training_iteration": 43, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-52", "timestamp": 1742310112, "time_this_iter_s": 3.451812267303467, "time_total_s": 156.60474300384521, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede331c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 156.60474300384521, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.16, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.048195838928223, "policy_loss": -0.01850232668220997, "vf_loss": 9.066571235656738, "vf_explained_var": 2.9078551051497925e-06, "kl": 0.0050597283989191055, "entropy": 0.8654170632362366, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.098222732543945, "policy_loss": -0.022347215563058853, "vf_loss": 9.120537757873535, "vf_explained_var": -2.998397576448042e-06, "kl": 0.005142333451658487, "entropy": 0.8057762384414673, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 9.095990180969238, "policy_loss": -0.014562861062586308, "vf_loss": 9.110549926757812, "vf_explained_var": 2.68107373813109e-06, "kl": 0.0038332680705934763, "entropy": 0.629532516002655, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.041601181030273, "policy_loss": -0.01412658579647541, "vf_loss": 9.055697441101074, "vf_explained_var": 3.1210126962832874e-06, "kl": 0.004760381765663624, "entropy": 0.7351453304290771, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 8.939547538757324, "policy_loss": -0.01770050823688507, "vf_loss": 8.957246780395508, "vf_explained_var": -1.9811449192275177e-07, "kl": 0.005720903165638447, "entropy": 0.6195283532142639, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 175968, "num_agent_steps_trained": 175968}, "sampler_results": {"episode_reward_max": 1660.9279677176478, "episode_reward_min": 1606.876860801399, "episode_reward_mean": 1635.0271633041325, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 315.1258408701036, "agent_1": 302.70340853791606, "agent_2": 314.8540585962726, "agent_3": 306.6770554759049, "agent_4": 341.0584608398297}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 316.9825200122774, "agent_2": 329.2261893961409, "agent_3": 327.19659555806714, "agent_4": 359.0227935261386}, "policy_reward_mean": {"agent_0": 334.76188629699925, "agent_1": 313.2373646084766, "agent_2": 323.5905452389511, "agent_3": 316.38566795144544, "agent_4": 347.05169920826046}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1643.0903958441318, 1621.7079285948562, 1606.876860801399, 1627.0690100608563, 1628.9496997616754, 1631.8334504490056, 1660.9279677176478, 1659.7619932034893], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [333.49899370204264, 336.7477109851696, 315.1258408701036, 329.9655128696347, 335.791302994902, 336.1350102923386, 345.3364299864012, 345.4942886754017], "policy_agent_1_reward": [316.9825200122774, 314.0348615161853, 316.8011709428524, 316.2004499206587, 309.69567827157937, 302.70340853791606, 316.5327023268949, 312.94812533944884], "policy_agent_2_reward": [314.8540585962726, 323.18983977776645, 314.95804749923354, 324.15786724416614, 324.1959098261743, 329.21496590491415, 328.9274836669405, 329.2261893961409], "policy_agent_3_reward": [318.73203000740074, 306.6770554759049, 316.5217926950588, 314.3993140406313, 312.0061782376868, 316.14075903376875, 327.19659555806714, 319.4116185630451], "policy_agent_4_reward": [359.0227935261386, 341.0584608398297, 343.47000879415083, 342.34586598576607, 347.2606304313329, 347.639306680068, 342.93475617934456, 352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53222753840042, "mean_inference_ms": 0.45898625793351266, "mean_action_processing_ms": 0.097857458277955, "mean_env_wait_ms": 0.10575459012226227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102557182312012, "StateBufferConnector_ms": 0.002810955047607422, "ViewRequirementAgentConnector_ms": 0.07651269435882568}}, "episode_reward_max": 1660.9279677176478, "episode_reward_min": 1606.876860801399, "episode_reward_mean": 1635.0271633041325, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 315.1258408701036, "agent_1": 302.70340853791606, "agent_2": 314.8540585962726, "agent_3": 306.6770554759049, "agent_4": 341.0584608398297}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 316.9825200122774, "agent_2": 329.2261893961409, "agent_3": 327.19659555806714, "agent_4": 359.0227935261386}, "policy_reward_mean": {"agent_0": 334.76188629699925, "agent_1": 313.2373646084766, "agent_2": 323.5905452389511, "agent_3": 316.38566795144544, "agent_4": 347.05169920826046}, "hist_stats": {"episode_reward": [1643.0903958441318, 1621.7079285948562, 1606.876860801399, 1627.0690100608563, 1628.9496997616754, 1631.8334504490056, 1660.9279677176478, 1659.7619932034893], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [333.49899370204264, 336.7477109851696, 315.1258408701036, 329.9655128696347, 335.791302994902, 336.1350102923386, 345.3364299864012, 345.4942886754017], "policy_agent_1_reward": [316.9825200122774, 314.0348615161853, 316.8011709428524, 316.2004499206587, 309.69567827157937, 302.70340853791606, 316.5327023268949, 312.94812533944884], "policy_agent_2_reward": [314.8540585962726, 323.18983977776645, 314.95804749923354, 324.15786724416614, 324.1959098261743, 329.21496590491415, 328.9274836669405, 329.2261893961409], "policy_agent_3_reward": [318.73203000740074, 306.6770554759049, 316.5217926950588, 314.3993140406313, 312.0061782376868, 316.14075903376875, 327.19659555806714, 319.4116185630451], "policy_agent_4_reward": [359.0227935261386, 341.0584608398297, 343.47000879415083, 342.34586598576607, 347.2606304313329, 347.639306680068, 342.93475617934456, 352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.53222753840042, "mean_inference_ms": 0.45898625793351266, "mean_action_processing_ms": 0.097857458277955, "mean_env_wait_ms": 0.10575459012226227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011102557182312012, "StateBufferConnector_ms": 0.002810955047607422, "ViewRequirementAgentConnector_ms": 0.07651269435882568}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175968, "num_agent_steps_trained": 175968, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 992.0009460458241, "num_env_steps_trained_throughput_per_sec": 992.0009460458241, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 175968, "timers": {"training_iteration_time_ms": 3644.353, "sample_time_ms": 677.866, "learn_time_ms": 2952.328, "learn_throughput": 1354.863, "synch_weights_time_ms": 12.252}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 175968, "num_agent_steps_trained": 175968}, "done": false, "episodes_total": 88, "training_iteration": 44, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-56", "timestamp": 1742310116, "time_this_iter_s": 4.044688701629639, "time_total_s": 160.64943170547485, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 160.64943170547485, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 9.74, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 4.249712944030762, "policy_loss": -0.0245542973279953, "vf_loss": 4.274087429046631, "vf_explained_var": 2.011514879995957e-05, "kl": 0.007193697150796652, "entropy": 0.7259171009063721, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 4.227213382720947, "policy_loss": -0.023152627050876617, "vf_loss": 4.250333786010742, "vf_explained_var": -2.0484128981479444e-05, "kl": 0.005199351813644171, "entropy": 0.7414888143539429, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 8.04797649383545, "policy_loss": -0.010999280959367752, "vf_loss": 8.058974266052246, "vf_explained_var": -8.547305696993135e-06, "kl": 0.0028740097768604755, "entropy": 0.5759829878807068, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 2.8089702129364014, "policy_loss": -0.026258187368512154, "vf_loss": 2.8352010250091553, "vf_explained_var": 5.389168291003443e-05, "kl": 0.008759262040257454, "entropy": 0.6787314414978027, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2090017795562744, "policy_loss": -0.013354489579796791, "vf_loss": 3.2223551273345947, "vf_explained_var": 3.045797348022461e-05, "kl": 0.00539102079346776, "entropy": 0.5832194089889526, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 179968, "num_agent_steps_trained": 179968}, "sampler_results": {"episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}}, "episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179968, "num_agent_steps_trained": 179968, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1144.294129936039, "num_env_steps_trained_throughput_per_sec": 1144.294129936039, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 179968, "timers": {"training_iteration_time_ms": 3645.904, "sample_time_ms": 673.512, "learn_time_ms": 2957.973, "learn_throughput": 1352.277, "synch_weights_time_ms": 12.42}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 179968, "num_agent_steps_trained": 179968}, "done": false, "episodes_total": 88, "training_iteration": 45, "trial_id": "72c65_00000", "date": "2025-03-18_16-01-59", "timestamp": 1742310119, "time_this_iter_s": 3.508815050125122, "time_total_s": 164.15824675559998, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfdb40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 164.15824675559998, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 10.116666666666665, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 5.0627336502075195, "policy_loss": -0.01660938747227192, "vf_loss": 5.07914400100708, "vf_explained_var": 2.6725019779405557e-05, "kl": 0.007959876209497452, "entropy": 0.7013478875160217, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 3.878966808319092, "policy_loss": -0.02499551698565483, "vf_loss": 3.9039225578308105, "vf_explained_var": 3.4199725632788613e-05, "kl": 0.006340907886624336, "entropy": 0.6763301491737366, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 7.530833721160889, "policy_loss": -0.016254456713795662, "vf_loss": 7.547087669372559, "vf_explained_var": -9.408451660419814e-06, "kl": 0.0027884102892130613, "entropy": 0.5345346927642822, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 4.153517723083496, "policy_loss": -0.013613302260637283, "vf_loss": 4.167116641998291, "vf_explained_var": 1.726547816360835e-05, "kl": 0.004593442659825087, "entropy": 0.5742953419685364, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 4.3342742919921875, "policy_loss": -0.011082635261118412, "vf_loss": 4.345355987548828, "vf_explained_var": 3.6696310417028144e-05, "kl": 0.0044840299524366856, "entropy": 0.5297134518623352, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 183968, "num_agent_steps_trained": 183968}, "sampler_results": {"episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}}, "episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183968, "num_agent_steps_trained": 183968, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1170.4789706838455, "num_env_steps_trained_throughput_per_sec": 1170.4789706838455, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 183968, "timers": {"training_iteration_time_ms": 3587.966, "sample_time_ms": 616.272, "learn_time_ms": 2957.372, "learn_throughput": 1352.552, "synch_weights_time_ms": 12.389}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 183968, "num_agent_steps_trained": 183968}, "done": false, "episodes_total": 88, "training_iteration": 46, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-03", "timestamp": 1742310123, "time_this_iter_s": 3.4320454597473145, "time_total_s": 167.5902922153473, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 167.5902922153473, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 4.073663711547852, "policy_loss": -0.025316093116998672, "vf_loss": 4.098826885223389, "vf_explained_var": 7.325127171498025e-06, "kl": 0.006106143351644278, "entropy": 0.5846994519233704, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 4.683079242706299, "policy_loss": -0.010915787890553474, "vf_loss": 4.693969249725342, "vf_explained_var": 5.7728516367205884e-06, "kl": 0.004187684040516615, "entropy": 0.6077302694320679, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 6.544738292694092, "policy_loss": -0.018823517486453056, "vf_loss": 6.56356143951416, "vf_explained_var": -5.916470399824902e-06, "kl": 0.0026653988752514124, "entropy": 0.47185981273651123, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 3.3882365226745605, "policy_loss": -0.0156390443444252, "vf_loss": 3.4038684368133545, "vf_explained_var": 8.520341907569673e-06, "kl": 0.00480416975915432, "entropy": 0.45767444372177124, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 3.4214794635772705, "policy_loss": -0.020551402121782303, "vf_loss": 3.442030191421509, "vf_explained_var": 5.08038756379392e-05, "kl": 0.004094418603926897, "entropy": 0.5196815133094788, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 187968, "num_agent_steps_trained": 187968}, "sampler_results": {"episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}}, "episode_reward_max": 1659.7619932034893, "episode_reward_min": 1659.7619932034893, "episode_reward_mean": 1659.7619932034893, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_max": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "policy_reward_mean": {"agent_0": 345.4942886754017, "agent_1": 312.94812533944884, "agent_2": 329.2261893961409, "agent_3": 319.4116185630451, "agent_4": 352.681771229453}, "hist_stats": {"episode_reward": [1659.7619932034893], "episode_lengths": [1995], "policy_agent_0_reward": [345.4942886754017], "policy_agent_1_reward": [312.94812533944884], "policy_agent_2_reward": [329.2261893961409], "policy_agent_3_reward": [319.4116185630451], "policy_agent_4_reward": [352.681771229453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5272324803384736, "mean_inference_ms": 0.4482236343494064, "mean_action_processing_ms": 0.09378500025053793, "mean_env_wait_ms": 0.1027403211144988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010728836059570312, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07194042205810547}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187968, "num_agent_steps_trained": 187968, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.2057418258116, "num_env_steps_trained_throughput_per_sec": 1159.2057418258116, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 187968, "timers": {"training_iteration_time_ms": 3587.559, "sample_time_ms": 617.395, "learn_time_ms": 2955.784, "learn_throughput": 1353.279, "synch_weights_time_ms": 12.368}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 187968, "num_agent_steps_trained": 187968}, "done": false, "episodes_total": 88, "training_iteration": 47, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-07", "timestamp": 1742310127, "time_this_iter_s": 3.4621498584747314, "time_total_s": 171.05244207382202, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfdb40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 171.05244207382202, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 10.22, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 8.929128646850586, "policy_loss": -0.01615138165652752, "vf_loss": 8.945151329040527, "vf_explained_var": -6.130763381406723e-07, "kl": 0.005134626291692257, "entropy": 0.581845760345459, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 9.023436546325684, "policy_loss": -0.016127465292811394, "vf_loss": 9.039551734924316, "vf_explained_var": -2.418245685475995e-06, "kl": 0.003935976419597864, "entropy": 0.6224474310874939, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8.986104011535645, "policy_loss": -0.01298440620303154, "vf_loss": 8.999088287353516, "vf_explained_var": -1.0700453145773281e-07, "kl": 0.0016735901590436697, "entropy": 0.4813847839832306, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 8.964998245239258, "policy_loss": -0.005866672843694687, "vf_loss": 8.970863342285156, "vf_explained_var": 7.493155607107838e-08, "kl": 0.0017746837111189961, "entropy": 0.46076345443725586, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8.861227989196777, "policy_loss": -0.008930503390729427, "vf_loss": 8.870159149169922, "vf_explained_var": -1.7393202824678156e-06, "kl": 0.0014850838342681527, "entropy": 0.4822028875350952, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 191968, "num_agent_steps_trained": 191968}, "sampler_results": {"episode_reward_max": 1761.5209926903424, "episode_reward_min": 1718.5781860048694, "episode_reward_mean": 1742.191137406613, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 341.8490853541006, "agent_1": 326.3301156088455, "agent_2": 346.5631220839222, "agent_3": 330.18376486962813, "agent_4": 362.3107436114676}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 346.69054811924946, "agent_2": 363.25179977780624, "agent_3": 344.57636999288445, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 348.07516060898655, "agent_1": 335.014522988266, "agent_2": 353.5441800165245, "agent_3": 336.63587139985106, "agent_4": 368.9214023929852}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1742.6562030594346, 1738.5113236052491, 1718.5781860048694, 1726.8081666272578, 1761.27061548959, 1730.1312372016919, 1758.0523745744697, 1761.5209926903424], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [347.7827395515466, 344.3962179432932, 341.8490853541006, 345.08992012601, 344.2093298990035, 347.9369616631976, 355.0929533318894, 358.24407700285155], "policy_agent_1_reward": [336.97813434212753, 332.86372019506103, 331.52639949530175, 332.80590979948965, 346.69054811924946, 326.3301156088455, 340.3885567178799, 332.53279962817305], "policy_agent_2_reward": [353.2729527634933, 351.27714391178336, 346.5631220839222, 353.32622883565773, 363.25179977780624, 350.10976337071855, 352.9402239077084, 357.61220548110623], "policy_agent_3_reward": [331.02278497300466, 340.0253613058348, 331.1251336196147, 330.18376486962813, 337.31347307780254, 343.44365294746257, 344.57636999288445, 335.3964304125768], "policy_agent_4_reward": [373.5995914292628, 369.94888024927644, 367.51444545193016, 365.40234299647324, 369.8054646157288, 362.3107436114676, 365.05427062410763, 377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321158507899302, "mean_inference_ms": 0.45778159970845, "mean_action_processing_ms": 0.09767977075126588, "mean_env_wait_ms": 0.10350240026383165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011584162712097168, "StateBufferConnector_ms": 0.0029486417770385742, "ViewRequirementAgentConnector_ms": 0.0787574052810669}}, "episode_reward_max": 1761.5209926903424, "episode_reward_min": 1718.5781860048694, "episode_reward_mean": 1742.191137406613, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 341.8490853541006, "agent_1": 326.3301156088455, "agent_2": 346.5631220839222, "agent_3": 330.18376486962813, "agent_4": 362.3107436114676}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 346.69054811924946, "agent_2": 363.25179977780624, "agent_3": 344.57636999288445, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 348.07516060898655, "agent_1": 335.014522988266, "agent_2": 353.5441800165245, "agent_3": 336.63587139985106, "agent_4": 368.9214023929852}, "hist_stats": {"episode_reward": [1742.6562030594346, 1738.5113236052491, 1718.5781860048694, 1726.8081666272578, 1761.27061548959, 1730.1312372016919, 1758.0523745744697, 1761.5209926903424], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [347.7827395515466, 344.3962179432932, 341.8490853541006, 345.08992012601, 344.2093298990035, 347.9369616631976, 355.0929533318894, 358.24407700285155], "policy_agent_1_reward": [336.97813434212753, 332.86372019506103, 331.52639949530175, 332.80590979948965, 346.69054811924946, 326.3301156088455, 340.3885567178799, 332.53279962817305], "policy_agent_2_reward": [353.2729527634933, 351.27714391178336, 346.5631220839222, 353.32622883565773, 363.25179977780624, 350.10976337071855, 352.9402239077084, 357.61220548110623], "policy_agent_3_reward": [331.02278497300466, 340.0253613058348, 331.1251336196147, 330.18376486962813, 337.31347307780254, 343.44365294746257, 344.57636999288445, 335.3964304125768], "policy_agent_4_reward": [373.5995914292628, 369.94888024927644, 367.51444545193016, 365.40234299647324, 369.8054646157288, 362.3107436114676, 365.05427062410763, 377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321158507899302, "mean_inference_ms": 0.45778159970845, "mean_action_processing_ms": 0.09767977075126588, "mean_env_wait_ms": 0.10350240026383165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011584162712097168, "StateBufferConnector_ms": 0.0029486417770385742, "ViewRequirementAgentConnector_ms": 0.0787574052810669}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191968, "num_agent_steps_trained": 191968, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 999.3211470179222, "num_env_steps_trained_throughput_per_sec": 999.3211470179222, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 191968, "timers": {"training_iteration_time_ms": 3637.754, "sample_time_ms": 672.87, "learn_time_ms": 2950.353, "learn_throughput": 1355.77, "synch_weights_time_ms": 12.479}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 191968, "num_agent_steps_trained": 191968}, "done": false, "episodes_total": 96, "training_iteration": 48, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-11", "timestamp": 1742310131, "time_this_iter_s": 4.017255544662476, "time_total_s": 175.0696976184845, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 175.0696976184845, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 9.819999999999999, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 2.5646374225616455, "policy_loss": -0.01482766680419445, "vf_loss": 2.579374074935913, "vf_explained_var": 1.72566797118634e-05, "kl": 0.003638491267338395, "entropy": 0.5115221738815308, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 3.6059224605560303, "policy_loss": -0.015269231982529163, "vf_loss": 3.6211838722229004, "vf_explained_var": -9.97781717160251e-06, "kl": 0.00496081355959177, "entropy": 0.5393641591072083, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 5.109807014465332, "policy_loss": -0.013396299444139004, "vf_loss": 5.123203754425049, "vf_explained_var": 9.81035645963857e-06, "kl": 0.0033591613173484802, "entropy": 0.460300087928772, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2126035690307617, "policy_loss": -0.015670541673898697, "vf_loss": 3.2282726764678955, "vf_explained_var": 2.8874192139483057e-05, "kl": 0.004329874645918608, "entropy": 0.4591902494430542, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 2.650583028793335, "policy_loss": -0.016276290640234947, "vf_loss": 2.6668591499328613, "vf_explained_var": 2.7776048227678984e-05, "kl": 0.005618696566671133, "entropy": 0.4583917558193207, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 195968, "num_agent_steps_trained": 195968}, "sampler_results": {"episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}}, "episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195968, "num_agent_steps_trained": 195968, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1165.5047545965708, "num_env_steps_trained_throughput_per_sec": 1165.5047545965708, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 195968, "timers": {"training_iteration_time_ms": 3636.071, "sample_time_ms": 672.842, "learn_time_ms": 2948.723, "learn_throughput": 1356.519, "synch_weights_time_ms": 12.484}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 195968, "num_agent_steps_trained": 195968}, "done": false, "episodes_total": 96, "training_iteration": 49, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-14", "timestamp": 1742310134, "time_this_iter_s": 3.4431817531585693, "time_total_s": 178.51287937164307, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 178.51287937164307, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2114651203155518, "policy_loss": -0.01481504738330841, "vf_loss": 3.2262277603149414, "vf_explained_var": 1.4313061910797842e-05, "kl": 0.004210833925753832, "entropy": 0.44804686307907104, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 3.279052734375, "policy_loss": -0.015838049352169037, "vf_loss": 3.294887065887451, "vf_explained_var": 1.5822763089090586e-05, "kl": 0.00508216442540288, "entropy": 0.5514485836029053, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9061081409454346, "policy_loss": -0.012400887906551361, "vf_loss": 2.918508768081665, "vf_explained_var": 7.280281693056168e-07, "kl": 0.004954961594194174, "entropy": 0.411283403635025, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 2.890516996383667, "policy_loss": -0.01557920128107071, "vf_loss": 2.906095266342163, "vf_explained_var": -2.8911090339533985e-06, "kl": 0.0051053473725914955, "entropy": 0.3696950376033783, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 2.1195948123931885, "policy_loss": -0.01059390977025032, "vf_loss": 2.1301889419555664, "vf_explained_var": 9.530016541248187e-05, "kl": 0.003950068261474371, "entropy": 0.4166773557662964, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 199968, "num_agent_steps_trained": 199968}, "sampler_results": {"episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}}, "episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199968, "num_agent_steps_trained": 199968, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1158.939569785231, "num_env_steps_trained_throughput_per_sec": 1158.939569785231, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 199968, "timers": {"training_iteration_time_ms": 3578.901, "sample_time_ms": 613.632, "learn_time_ms": 2950.673, "learn_throughput": 1355.623, "synch_weights_time_ms": 12.543}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 199968, "num_agent_steps_trained": 199968}, "done": false, "episodes_total": 96, "training_iteration": 50, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-18", "timestamp": 1742310138, "time_this_iter_s": 3.461751699447632, "time_total_s": 181.9746310710907, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfdbd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 181.9746310710907, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.15, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 3.428203582763672, "policy_loss": -0.014862948097288609, "vf_loss": 3.4430484771728516, "vf_explained_var": 4.284949682187289e-05, "kl": 0.0028905635699629784, "entropy": 0.4331142008304596, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 3.945449113845825, "policy_loss": -0.02195742540061474, "vf_loss": 3.967400312423706, "vf_explained_var": 1.1755455489037558e-05, "kl": 0.008109658025205135, "entropy": 0.4646010994911194, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 2.9245166778564453, "policy_loss": -0.010790051892399788, "vf_loss": 2.9353065490722656, "vf_explained_var": 4.861468369199429e-06, "kl": 0.0018858779221773148, "entropy": 0.34783709049224854, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 2.592158317565918, "policy_loss": -0.01564844511449337, "vf_loss": 2.60780668258667, "vf_explained_var": 1.1370295396773145e-05, "kl": 0.0028965973760932684, "entropy": 0.3110298216342926, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0607004165649414, "policy_loss": -0.018028968945145607, "vf_loss": 2.0787291526794434, "vf_explained_var": 8.829349826555699e-05, "kl": 0.004730205982923508, "entropy": 0.3428553342819214, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 203968, "num_agent_steps_trained": 203968}, "sampler_results": {"episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}}, "episode_reward_max": 1761.5209926903424, "episode_reward_min": 1761.5209926903424, "episode_reward_mean": 1761.5209926903424, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_max": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "policy_reward_mean": {"agent_0": 358.24407700285155, "agent_1": 332.53279962817305, "agent_2": 357.61220548110623, "agent_3": 335.3964304125768, "agent_4": 377.7354801656347}, "hist_stats": {"episode_reward": [1761.5209926903424], "episode_lengths": [1995], "policy_agent_0_reward": [358.24407700285155], "policy_agent_1_reward": [332.53279962817305], "policy_agent_2_reward": [357.61220548110623], "policy_agent_3_reward": [335.3964304125768], "policy_agent_4_reward": [377.7354801656347]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5269676321501792, "mean_inference_ms": 0.44651832348515325, "mean_action_processing_ms": 0.09356001596501269, "mean_env_wait_ms": 0.10044310203289361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013146400451660156, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.08808135986328125}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203968, "num_agent_steps_trained": 203968, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1173.8344838423698, "num_env_steps_trained_throughput_per_sec": 1173.8344838423698, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 203968, "timers": {"training_iteration_time_ms": 3576.453, "sample_time_ms": 614.747, "learn_time_ms": 2947.125, "learn_throughput": 1357.255, "synch_weights_time_ms": 12.468}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 203968, "num_agent_steps_trained": 203968}, "done": false, "episodes_total": 96, "training_iteration": 51, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-21", "timestamp": 1742310141, "time_this_iter_s": 3.418882131576538, "time_total_s": 185.39351320266724, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 185.39351320266724, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 4.999999873689376e-05, "total_loss": 8.884272575378418, "policy_loss": -0.012197306379675865, "vf_loss": 8.896456718444824, "vf_explained_var": 1.209122757472869e-07, "kl": 0.004370573908090591, "entropy": 0.38909584283828735, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 8.858580589294434, "policy_loss": -0.011276950128376484, "vf_loss": 8.869856834411621, "vf_explained_var": -2.4877842861315003e-06, "kl": 0.0012150760740041733, "entropy": 0.4160618484020233, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.808544158935547, "policy_loss": -0.012845332734286785, "vf_loss": 8.821389198303223, "vf_explained_var": -7.493155607107838e-08, "kl": 0.00296210334636271, "entropy": 0.3407665491104126, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8.821639060974121, "policy_loss": -0.006156724877655506, "vf_loss": 8.82779598236084, "vf_explained_var": 9.89720888355805e-07, "kl": 0.0011540270643308759, "entropy": 0.2661195993423462, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.727203369140625, "policy_loss": -0.005725383292883635, "vf_loss": 8.732929229736328, "vf_explained_var": 5.182765789868427e-07, "kl": 0.0011278659803792834, "entropy": 0.30614137649536133, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 207968, "num_agent_steps_trained": 207968}, "sampler_results": {"episode_reward_max": 1829.6599168731793, "episode_reward_min": 1806.5998746546945, "episode_reward_mean": 1818.1902024896929, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 340.4751168554059, "agent_2": 367.31898899852865, "agent_3": 341.64429116345804, "agent_4": 367.063234494963}, "policy_reward_max": {"agent_0": 370.76405408759945, "agent_1": 359.8861703426696, "agent_2": 379.34004520291495, "agent_3": 370.8793846676705, "agent_4": 375.83468928947053}, "policy_reward_mean": {"agent_0": 365.3553998328737, "agent_1": 353.0583004543811, "agent_2": 372.6866327276896, "agent_3": 354.90273273670243, "agent_4": 372.1871367380462}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1818.6419471303266, 1812.654642313442, 1826.2090459341205, 1806.5998746546945, 1822.1534147526474, 1813.487217307953, 1829.6599168731793, 1816.1155609511802], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [370.76405408759945, 366.2497117847146, 369.18449470673295, 361.2969605098387, 362.420467960372, 365.6320954301449, 368.39591128455567, 358.89950289903095], "policy_agent_1_reward": [350.74751391641416, 340.4751168554059, 351.09052991431145, 356.3561255360912, 352.731081412462, 357.95086377924935, 359.8861703426696, 355.22900187844493], "policy_agent_2_reward": [376.1276179524631, 375.4764221233873, 379.34004520291495, 372.6255077881534, 367.31898899852865, 367.7277080462622, 370.93602864270395, 371.9407430671033], "policy_agent_3_reward": [348.489473826305, 355.14009065865105, 359.53074161519845, 341.64429116345804, 370.8793846676705, 352.8272194786081, 354.60711731377984, 356.1035431699488], "policy_agent_4_reward": [372.5132873475445, 375.3133008912835, 367.063234494963, 374.6769896571531, 368.8034917136144, 369.3493305736886, 375.83468928947053, 373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319407020989328, "mean_inference_ms": 0.457046465306854, "mean_action_processing_ms": 0.09754056550187287, "mean_env_wait_ms": 0.10160097461137205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.002835988998413086, "ViewRequirementAgentConnector_ms": 0.076904296875}}, "episode_reward_max": 1829.6599168731793, "episode_reward_min": 1806.5998746546945, "episode_reward_mean": 1818.1902024896929, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 340.4751168554059, "agent_2": 367.31898899852865, "agent_3": 341.64429116345804, "agent_4": 367.063234494963}, "policy_reward_max": {"agent_0": 370.76405408759945, "agent_1": 359.8861703426696, "agent_2": 379.34004520291495, "agent_3": 370.8793846676705, "agent_4": 375.83468928947053}, "policy_reward_mean": {"agent_0": 365.3553998328737, "agent_1": 353.0583004543811, "agent_2": 372.6866327276896, "agent_3": 354.90273273670243, "agent_4": 372.1871367380462}, "hist_stats": {"episode_reward": [1818.6419471303266, 1812.654642313442, 1826.2090459341205, 1806.5998746546945, 1822.1534147526474, 1813.487217307953, 1829.6599168731793, 1816.1155609511802], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [370.76405408759945, 366.2497117847146, 369.18449470673295, 361.2969605098387, 362.420467960372, 365.6320954301449, 368.39591128455567, 358.89950289903095], "policy_agent_1_reward": [350.74751391641416, 340.4751168554059, 351.09052991431145, 356.3561255360912, 352.731081412462, 357.95086377924935, 359.8861703426696, 355.22900187844493], "policy_agent_2_reward": [376.1276179524631, 375.4764221233873, 379.34004520291495, 372.6255077881534, 367.31898899852865, 367.7277080462622, 370.93602864270395, 371.9407430671033], "policy_agent_3_reward": [348.489473826305, 355.14009065865105, 359.53074161519845, 341.64429116345804, 370.8793846676705, 352.8272194786081, 354.60711731377984, 356.1035431699488], "policy_agent_4_reward": [372.5132873475445, 375.3133008912835, 367.063234494963, 374.6769896571531, 368.8034917136144, 369.3493305736886, 375.83468928947053, 373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319407020989328, "mean_inference_ms": 0.457046465306854, "mean_action_processing_ms": 0.09754056550187287, "mean_env_wait_ms": 0.10160097461137205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.002835988998413086, "ViewRequirementAgentConnector_ms": 0.076904296875}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207968, "num_agent_steps_trained": 207968, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1002.9001655836975, "num_env_steps_trained_throughput_per_sec": 1002.9001655836975, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 207968, "timers": {"training_iteration_time_ms": 3611.049, "sample_time_ms": 669.911, "learn_time_ms": 2926.472, "learn_throughput": 1366.833, "synch_weights_time_ms": 12.452}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 207968, "num_agent_steps_trained": 207968}, "done": false, "episodes_total": 104, "training_iteration": 52, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-25", "timestamp": 1742310145, "time_this_iter_s": 4.0019004344940186, "time_total_s": 189.39541363716125, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 189.39541363716125, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 9.76, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3373053073883057, "policy_loss": -0.011052976362407207, "vf_loss": 2.3483529090881348, "vf_explained_var": 8.362815606233198e-06, "kl": 0.003507146844640374, "entropy": 0.35581809282302856, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4670042991638184, "policy_loss": -0.009257863275706768, "vf_loss": 2.4762613773345947, "vf_explained_var": 5.832740043842932e-06, "kl": 0.002156374277547002, "entropy": 0.3794601559638977, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3294447660446167, "policy_loss": -0.00737954443320632, "vf_loss": 1.3368245363235474, "vf_explained_var": 1.8498159988666885e-05, "kl": 0.0026448320131748915, "entropy": 0.3105835020542145, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 2.095999002456665, "policy_loss": -0.011070066131651402, "vf_loss": 2.1070690155029297, "vf_explained_var": 6.885187758598477e-06, "kl": 0.0024167951196432114, "entropy": 0.24462763965129852, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8318638801574707, "policy_loss": -0.009718548506498337, "vf_loss": 1.8415824174880981, "vf_explained_var": 3.001888580911327e-05, "kl": 0.005080883856862783, "entropy": 0.2924956679344177, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "sampler_results": {"episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}}, "episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1166.9910971905279, "num_env_steps_trained_throughput_per_sec": 1166.9910971905279, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 211968, "timers": {"training_iteration_time_ms": 3610.527, "sample_time_ms": 668.008, "learn_time_ms": 2927.773, "learn_throughput": 1366.226, "synch_weights_time_ms": 12.425}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "done": false, "episodes_total": 104, "training_iteration": 53, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-29", "timestamp": 1742310149, "time_this_iter_s": 3.4382123947143555, "time_total_s": 192.8336260318756, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 192.8336260318756, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 10.28, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 2.485976457595825, "policy_loss": -0.02053828537464142, "vf_loss": 2.5065064430236816, "vf_explained_var": 4.3891726818401366e-05, "kl": 0.010372595861554146, "entropy": 0.3607083857059479, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 2.379307746887207, "policy_loss": -0.014034395106136799, "vf_loss": 2.393341302871704, "vf_explained_var": -1.188857186207315e-05, "kl": 0.00303911161608994, "entropy": 0.30620479583740234, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5901741981506348, "policy_loss": -0.010404431261122227, "vf_loss": 1.600578784942627, "vf_explained_var": -2.810784735629568e-06, "kl": 0.0011925322469323874, "entropy": 0.26194700598716736, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4954595565795898, "policy_loss": -0.003492689225822687, "vf_loss": 1.4989523887634277, "vf_explained_var": 4.298062776797451e-06, "kl": 0.0006988405948504806, "entropy": 0.20596614480018616, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 2.682032346725464, "policy_loss": -0.009380610659718513, "vf_loss": 2.691413164138794, "vf_explained_var": 9.236420737579465e-05, "kl": 0.0014262873446568847, "entropy": 0.2406768649816513, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 215968, "num_agent_steps_trained": 215968}, "sampler_results": {"episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}}, "episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215968, "num_agent_steps_trained": 215968, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1158.1628130768477, "num_env_steps_trained_throughput_per_sec": 1158.1628130768477, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 215968, "timers": {"training_iteration_time_ms": 3552.677, "sample_time_ms": 614.17, "learn_time_ms": 2923.729, "learn_throughput": 1368.116, "synch_weights_time_ms": 12.517}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 215968, "num_agent_steps_trained": 215968}, "done": false, "episodes_total": 104, "training_iteration": 54, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-33", "timestamp": 1742310153, "time_this_iter_s": 3.466838836669922, "time_total_s": 196.30046486854553, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ee076b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 196.30046486854553, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8783310651779175, "policy_loss": -0.013510663993656635, "vf_loss": 1.8918370008468628, "vf_explained_var": 4.9926838983083144e-05, "kl": 0.005827951245009899, "entropy": 0.3638141453266144, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.9209630489349365, "policy_loss": -0.011814755387604237, "vf_loss": 1.9327775239944458, "vf_explained_var": 2.1859577827854082e-05, "kl": 0.0032754859421402216, "entropy": 0.2618958652019501, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 1.031376838684082, "policy_loss": -0.009908211417496204, "vf_loss": 1.0412850379943848, "vf_explained_var": 1.4884415577398613e-05, "kl": 0.0013606889406219125, "entropy": 0.2211153507232666, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2123966217041016, "policy_loss": -0.011707129888236523, "vf_loss": 1.2241038084030151, "vf_explained_var": 8.638416147732642e-06, "kl": 0.0018584331264719367, "entropy": 0.17817917466163635, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4111907482147217, "policy_loss": -0.011887681670486927, "vf_loss": 1.4230784177780151, "vf_explained_var": 6.131416012067348e-05, "kl": 0.004323270171880722, "entropy": 0.19852955639362335, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 219968, "num_agent_steps_trained": 219968}, "sampler_results": {"episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}}, "episode_reward_max": 1816.1155609511802, "episode_reward_min": 1816.1155609511802, "episode_reward_mean": 1816.1155609511802, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_max": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "policy_reward_mean": {"agent_0": 358.89950289903095, "agent_1": 355.22900187844493, "agent_2": 371.9407430671033, "agent_3": 356.1035431699488, "agent_4": 373.94276993665216}, "hist_stats": {"episode_reward": [1816.1155609511802], "episode_lengths": [1995], "policy_agent_0_reward": [358.89950289903095], "policy_agent_1_reward": [355.22900187844493], "policy_agent_2_reward": [371.9407430671033], "policy_agent_3_reward": [356.1035431699488], "policy_agent_4_reward": [373.94276993665216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526570883179063, "mean_inference_ms": 0.44540279503304386, "mean_action_processing_ms": 0.0933208519126593, "mean_env_wait_ms": 0.09859164381645252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010805130004882812, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.07166385650634766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219968, "num_agent_steps_trained": 219968, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1165.9536466942543, "num_env_steps_trained_throughput_per_sec": 1165.9536466942543, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 219968, "timers": {"training_iteration_time_ms": 3546.183, "sample_time_ms": 616.287, "learn_time_ms": 2915.298, "learn_throughput": 1372.072, "synch_weights_time_ms": 12.349}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 219968, "num_agent_steps_trained": 219968}, "done": false, "episodes_total": 104, "training_iteration": 55, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-36", "timestamp": 1742310156, "time_this_iter_s": 3.4423444271087646, "time_total_s": 199.7428092956543, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 199.7428092956543, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 10.16, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 4.999999873689376e-05, "total_loss": 8.752490043640137, "policy_loss": -0.007939334958791733, "vf_loss": 8.760427474975586, "vf_explained_var": -1.2037299939038348e-06, "kl": 0.0028178233187645674, "entropy": 0.34720903635025024, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8.70266056060791, "policy_loss": -0.014286693185567856, "vf_loss": 8.716947555541992, "vf_explained_var": 6.828989285168063e-07, "kl": 0.0015662434743717313, "entropy": 0.24139349162578583, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 8.693333625793457, "policy_loss": -0.014084135182201862, "vf_loss": 8.707418441772461, "vf_explained_var": -1.0785602455598564e-07, "kl": 0.0006700326921418309, "entropy": 0.2058083713054657, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.694976806640625, "policy_loss": -0.005902878474444151, "vf_loss": 8.700879096984863, "vf_explained_var": 4.297210978165822e-07, "kl": 0.00032768587698228657, "entropy": 0.16653791069984436, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 8.608890533447266, "policy_loss": -0.005704257637262344, "vf_loss": 8.614594459533691, "vf_explained_var": 3.146273684251355e-06, "kl": 0.0007729401695542037, "entropy": 0.2170678675174713, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 223968, "num_agent_steps_trained": 223968}, "sampler_results": {"episode_reward_max": 1897.6930856105412, "episode_reward_min": 1880.1038682171095, "episode_reward_mean": 1886.8657135025417, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 374.6651812740423, "agent_1": 355.8964171890748, "agent_2": 383.39075811193163, "agent_3": 367.9631616339424, "agent_4": 380.3577435433627}, "policy_reward_max": {"agent_0": 387.6636393051605, "agent_1": 365.86489683673597, "agent_2": 391.1278234182529, "agent_3": 380.38327534365726, "agent_4": 388.169330599683}, "policy_reward_mean": {"agent_0": 381.6645349933732, "agent_1": 360.3555302737601, "agent_2": 387.28111645871934, "agent_3": 373.8414185079223, "agent_4": 383.7231132687667}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1884.4970927215015, 1888.689417725002, 1880.1038682171095, 1897.6930856105412, 1882.047980578558, 1886.6104593782554, 1893.2107637473741, 1882.073040041992], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [374.6651812740423, 385.8472939061288, 375.8854335004605, 381.43808447712274, 379.0636123397003, 382.0464796761454, 387.6636393051605, 386.70655546822536], "policy_agent_1_reward": [360.87748257319936, 356.3493898868687, 363.1462392532514, 363.0342775284563, 357.946602188189, 365.86489683673597, 359.7289367343052, 355.8964171890748], "policy_agent_2_reward": [387.74717108761547, 389.5087654393983, 384.96067974606217, 391.1278234182529, 383.39075811193163, 390.3781776880687, 387.25080251029226, 383.8847536681333], "policy_agent_3_reward": [377.68251679350686, 375.79275910888816, 371.0686099502501, 380.38327534365726, 373.4776773390547, 367.9631616339424, 372.4924923310978, 371.8708555629813], "policy_agent_4_reward": [383.5247409931376, 381.1912093837179, 385.0429057670855, 381.7096248430517, 388.169330599683, 380.3577435433627, 386.07489286651827, 383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321157384755753, "mean_inference_ms": 0.4568482453446487, "mean_action_processing_ms": 0.09756082019858359, "mean_env_wait_ms": 0.10007241062511568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011827349662780762, "StateBufferConnector_ms": 0.0029206275939941406, "ViewRequirementAgentConnector_ms": 0.07859408855438232}}, "episode_reward_max": 1897.6930856105412, "episode_reward_min": 1880.1038682171095, "episode_reward_mean": 1886.8657135025417, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 374.6651812740423, "agent_1": 355.8964171890748, "agent_2": 383.39075811193163, "agent_3": 367.9631616339424, "agent_4": 380.3577435433627}, "policy_reward_max": {"agent_0": 387.6636393051605, "agent_1": 365.86489683673597, "agent_2": 391.1278234182529, "agent_3": 380.38327534365726, "agent_4": 388.169330599683}, "policy_reward_mean": {"agent_0": 381.6645349933732, "agent_1": 360.3555302737601, "agent_2": 387.28111645871934, "agent_3": 373.8414185079223, "agent_4": 383.7231132687667}, "hist_stats": {"episode_reward": [1884.4970927215015, 1888.689417725002, 1880.1038682171095, 1897.6930856105412, 1882.047980578558, 1886.6104593782554, 1893.2107637473741, 1882.073040041992], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [374.6651812740423, 385.8472939061288, 375.8854335004605, 381.43808447712274, 379.0636123397003, 382.0464796761454, 387.6636393051605, 386.70655546822536], "policy_agent_1_reward": [360.87748257319936, 356.3493898868687, 363.1462392532514, 363.0342775284563, 357.946602188189, 365.86489683673597, 359.7289367343052, 355.8964171890748], "policy_agent_2_reward": [387.74717108761547, 389.5087654393983, 384.96067974606217, 391.1278234182529, 383.39075811193163, 390.3781776880687, 387.25080251029226, 383.8847536681333], "policy_agent_3_reward": [377.68251679350686, 375.79275910888816, 371.0686099502501, 380.38327534365726, 373.4776773390547, 367.9631616339424, 372.4924923310978, 371.8708555629813], "policy_agent_4_reward": [383.5247409931376, 381.1912093837179, 385.0429057670855, 381.7096248430517, 388.169330599683, 380.3577435433627, 386.07489286651827, 383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321157384755753, "mean_inference_ms": 0.4568482453446487, "mean_action_processing_ms": 0.09756082019858359, "mean_env_wait_ms": 0.10007241062511568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011827349662780762, "StateBufferConnector_ms": 0.0029206275939941406, "ViewRequirementAgentConnector_ms": 0.07859408855438232}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223968, "num_agent_steps_trained": 223968, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 980.2923286758605, "num_env_steps_trained_throughput_per_sec": 980.2923286758605, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 223968, "timers": {"training_iteration_time_ms": 3612.484, "sample_time_ms": 676.476, "learn_time_ms": 2921.314, "learn_throughput": 1369.247, "synch_weights_time_ms": 12.352}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 223968, "num_agent_steps_trained": 223968}, "done": false, "episodes_total": 112, "training_iteration": 56, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-40", "timestamp": 1742310160, "time_this_iter_s": 4.092606544494629, "time_total_s": 203.83541584014893, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfdb40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 203.83541584014893, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 9.75, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 4.999999873689376e-05, "total_loss": 1.302975058555603, "policy_loss": -0.016514208167791367, "vf_loss": 1.3194878101348877, "vf_explained_var": 2.656635842868127e-05, "kl": 0.003895330475643277, "entropy": 0.30613604187965393, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.326595664024353, "policy_loss": -0.012092620134353638, "vf_loss": 1.3386881351470947, "vf_explained_var": -1.3923929145676084e-05, "kl": 0.002335286233574152, "entropy": 0.19711348414421082, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6320558190345764, "policy_loss": -0.005349333398044109, "vf_loss": 0.6374051570892334, "vf_explained_var": 6.865887371532153e-06, "kl": 0.0014060508692637086, "entropy": 0.16573555767536163, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.45946770906448364, "policy_loss": -0.004968052729964256, "vf_loss": 0.46443575620651245, "vf_explained_var": 9.148745448328555e-06, "kl": 0.0008657505386509001, "entropy": 0.1446683704853058, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9589753746986389, "policy_loss": -0.00912144873291254, "vf_loss": 0.9680967926979065, "vf_explained_var": 9.582951315678656e-05, "kl": 0.001583696692250669, "entropy": 0.18990743160247803, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 227968, "num_agent_steps_trained": 227968}, "sampler_results": {"episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}}, "episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227968, "num_agent_steps_trained": 227968, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1162.5726416647587, "num_env_steps_trained_throughput_per_sec": 1162.5726416647587, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 227968, "timers": {"training_iteration_time_ms": 3611.484, "sample_time_ms": 675.582, "learn_time_ms": 2921.182, "learn_throughput": 1369.309, "synch_weights_time_ms": 12.367}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 227968, "num_agent_steps_trained": 227968}, "done": false, "episodes_total": 112, "training_iteration": 57, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-44", "timestamp": 1742310164, "time_this_iter_s": 3.4518349170684814, "time_total_s": 207.2872507572174, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede331c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 207.2872507572174, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 9.85, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2714259624481201, "policy_loss": -0.009757043793797493, "vf_loss": 1.2811815738677979, "vf_explained_var": 0.00011002535029547289, "kl": 0.006549361161887646, "entropy": 0.3307879567146301, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0695515871047974, "policy_loss": -0.0010738795390352607, "vf_loss": 1.0706254243850708, "vf_explained_var": -1.0202328667219263e-05, "kl": 0.00083797553088516, "entropy": 0.17371179163455963, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7262526750564575, "policy_loss": -0.009215173311531544, "vf_loss": 0.735467791557312, "vf_explained_var": -1.9425153368501924e-05, "kl": 0.000812080514151603, "entropy": 0.13941432535648346, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.41628047823905945, "policy_loss": -0.007523026783019304, "vf_loss": 0.4238034784793854, "vf_explained_var": -8.933884600992315e-06, "kl": 0.0004972461611032486, "entropy": 0.11580254882574081, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8484417200088501, "policy_loss": -0.009753931313753128, "vf_loss": 0.8581955432891846, "vf_explained_var": -7.779002044117078e-05, "kl": 0.0035542708355933428, "entropy": 0.14115898311138153, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 231968, "num_agent_steps_trained": 231968}, "sampler_results": {"episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}}, "episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231968, "num_agent_steps_trained": 231968, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1149.1091145775185, "num_env_steps_trained_throughput_per_sec": 1149.1091145775185, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 231968, "timers": {"training_iteration_time_ms": 3559.308, "sample_time_ms": 620.093, "learn_time_ms": 2924.819, "learn_throughput": 1367.606, "synch_weights_time_ms": 12.07}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 231968, "num_agent_steps_trained": 231968}, "done": false, "episodes_total": 112, "training_iteration": 58, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-48", "timestamp": 1742310168, "time_this_iter_s": 3.4937403202056885, "time_total_s": 210.7809910774231, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede31e10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 210.7809910774231, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2429091930389404, "policy_loss": -0.014577426947653294, "vf_loss": 1.2574856281280518, "vf_explained_var": 0.00020693143596872687, "kl": 0.00378607795573771, "entropy": 0.2998826801776886, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6676483750343323, "policy_loss": -0.00987947080284357, "vf_loss": 0.6775278449058533, "vf_explained_var": 2.8170574296382256e-05, "kl": 0.0007721369038335979, "entropy": 0.1488412469625473, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3779849112033844, "policy_loss": -0.0007684498559683561, "vf_loss": 0.37875333428382874, "vf_explained_var": 8.600666660640854e-06, "kl": 0.0004516488406807184, "entropy": 0.11428796499967575, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2882821559906006, "policy_loss": -0.0008188809733837843, "vf_loss": 0.2891010344028473, "vf_explained_var": 1.5026047321953229e-06, "kl": 0.0002518085530027747, "entropy": 0.09591604024171829, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5464659929275513, "policy_loss": -0.0010766573250293732, "vf_loss": 0.5475426316261292, "vf_explained_var": -5.6399334425805137e-05, "kl": 0.0006900072330608964, "entropy": 0.115425705909729, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 235968, "num_agent_steps_trained": 235968}, "sampler_results": {"episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}}, "episode_reward_max": 1882.073040041992, "episode_reward_min": 1882.073040041992, "episode_reward_mean": 1882.073040041992, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_max": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "policy_reward_mean": {"agent_0": 386.70655546822536, "agent_1": 355.8964171890748, "agent_2": 383.8847536681333, "agent_3": 371.8708555629813, "agent_4": 383.71445815357714}, "hist_stats": {"episode_reward": [1882.073040041992], "episode_lengths": [1995], "policy_agent_0_reward": [386.70655546822536], "policy_agent_1_reward": [355.8964171890748], "policy_agent_2_reward": [383.8847536681333], "policy_agent_3_reward": [371.8708555629813], "policy_agent_4_reward": [383.71445815357714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5262078551248859, "mean_inference_ms": 0.4445632642211456, "mean_action_processing_ms": 0.09315118019608344, "mean_env_wait_ms": 0.09685673674005836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010662078857421875, "StateBufferConnector_ms": 0.0025606155395507812, "ViewRequirementAgentConnector_ms": 0.07221698760986328}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235968, "num_agent_steps_trained": 235968, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1150.945873654566, "num_env_steps_trained_throughput_per_sec": 1150.945873654566, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 235968, "timers": {"training_iteration_time_ms": 3563.649, "sample_time_ms": 617.892, "learn_time_ms": 2931.101, "learn_throughput": 1364.675, "synch_weights_time_ms": 12.298}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 235968, "num_agent_steps_trained": 235968}, "done": false, "episodes_total": 112, "training_iteration": 59, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-51", "timestamp": 1742310171, "time_this_iter_s": 3.4902358055114746, "time_total_s": 214.27122688293457, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddb9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 214.27122688293457, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 8.629169464111328, "policy_loss": -0.009939883835613728, "vf_loss": 8.639108657836914, "vf_explained_var": -1.0870751339098206e-06, "kl": 0.00230698985978961, "entropy": 0.3220374584197998, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.604522705078125, "policy_loss": -0.00310357753187418, "vf_loss": 8.607626914978027, "vf_explained_var": -4.433450158103369e-07, "kl": 0.0002679104218259454, "entropy": 0.14347684383392334, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 8.584497451782227, "policy_loss": -0.0036145271733403206, "vf_loss": 8.588111877441406, "vf_explained_var": 9.934107758624577e-09, "kl": 0.00034353448427282274, "entropy": 0.11929313838481903, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 8.616058349609375, "policy_loss": 0.0005183003377169371, "vf_loss": 8.615540504455566, "vf_explained_var": 3.542218962593324e-07, "kl": 7.025475497357547e-05, "entropy": 0.09108276665210724, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 8.499459266662598, "policy_loss": -0.0033835722133517265, "vf_loss": 8.502842903137207, "vf_explained_var": 5.744752229475125e-07, "kl": 0.00021537566499318928, "entropy": 0.11007121205329895, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 239968, "num_agent_steps_trained": 239968}, "sampler_results": {"episode_reward_max": 1937.564185146284, "episode_reward_min": 1926.2793132972495, "episode_reward_mean": 1931.5474369911467, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 386.4248183746696, "agent_1": 364.1475176828258, "agent_2": 388.3104682229026, "agent_3": 388.3007684572229, "agent_4": 385.88343948883175}, "policy_reward_max": {"agent_0": 391.8894098782125, "agent_1": 375.39608215507405, "agent_2": 394.503231433792, "agent_3": 392.20324588811854, "agent_4": 390.1063057065403}, "policy_reward_mean": {"agent_0": 389.78524659850837, "agent_1": 371.2717658254919, "agent_2": 391.7758929632643, "agent_3": 390.00442910725974, "agent_4": 388.7101024966225}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1930.2159454757957, 1936.9201429059924, 1926.2793132972495, 1933.195191698882, 1931.9579073974994, 1929.8824266725512, 1937.564185146284, 1926.3643833349197], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [391.504373433505, 389.6568991845752, 387.6670112417148, 391.16255913880946, 386.4248183746696, 390.5579361903159, 391.8894098782125, 389.4189653462647], "policy_agent_1_reward": [374.1522701928277, 375.07413602080953, 364.70711563298596, 371.571302800949, 374.5558554005153, 370.56984671794817, 375.39608215507405, 364.1475176828258], "policy_agent_2_reward": [388.3104682229026, 393.42014588128797, 394.0000009462277, 392.3746443821732, 391.00677112709093, 390.34756960052414, 390.2443121121157, 394.503231433792], "policy_agent_3_reward": [389.3253921017662, 390.39339919073575, 389.89615323320163, 392.20324588811854, 390.2318823208532, 388.3007684572229, 390.44958150380387, 389.23501016237594], "policy_agent_4_reward": [386.92344152479427, 388.37556262858396, 390.00903224311935, 385.88343948883175, 389.7385801743707, 390.1063057065403, 389.58479949707805, 389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320551446992426, "mean_inference_ms": 0.4565375597690496, "mean_action_processing_ms": 0.0975090544810514, "mean_env_wait_ms": 0.09868982783842356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0028377771377563477, "ViewRequirementAgentConnector_ms": 0.07695615291595459}}, "episode_reward_max": 1937.564185146284, "episode_reward_min": 1926.2793132972495, "episode_reward_mean": 1931.5474369911467, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 386.4248183746696, "agent_1": 364.1475176828258, "agent_2": 388.3104682229026, "agent_3": 388.3007684572229, "agent_4": 385.88343948883175}, "policy_reward_max": {"agent_0": 391.8894098782125, "agent_1": 375.39608215507405, "agent_2": 394.503231433792, "agent_3": 392.20324588811854, "agent_4": 390.1063057065403}, "policy_reward_mean": {"agent_0": 389.78524659850837, "agent_1": 371.2717658254919, "agent_2": 391.7758929632643, "agent_3": 390.00442910725974, "agent_4": 388.7101024966225}, "hist_stats": {"episode_reward": [1930.2159454757957, 1936.9201429059924, 1926.2793132972495, 1933.195191698882, 1931.9579073974994, 1929.8824266725512, 1937.564185146284, 1926.3643833349197], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [391.504373433505, 389.6568991845752, 387.6670112417148, 391.16255913880946, 386.4248183746696, 390.5579361903159, 391.8894098782125, 389.4189653462647], "policy_agent_1_reward": [374.1522701928277, 375.07413602080953, 364.70711563298596, 371.571302800949, 374.5558554005153, 370.56984671794817, 375.39608215507405, 364.1475176828258], "policy_agent_2_reward": [388.3104682229026, 393.42014588128797, 394.0000009462277, 392.3746443821732, 391.00677112709093, 390.34756960052414, 390.2443121121157, 394.503231433792], "policy_agent_3_reward": [389.3253921017662, 390.39339919073575, 389.89615323320163, 392.20324588811854, 390.2318823208532, 388.3007684572229, 390.44958150380387, 389.23501016237594], "policy_agent_4_reward": [386.92344152479427, 388.37556262858396, 390.00903224311935, 385.88343948883175, 389.7385801743707, 390.1063057065403, 389.58479949707805, 389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320551446992426, "mean_inference_ms": 0.4565375597690496, "mean_action_processing_ms": 0.0975090544810514, "mean_env_wait_ms": 0.09868982783842356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011186599731445312, "StateBufferConnector_ms": 0.0028377771377563477, "ViewRequirementAgentConnector_ms": 0.07695615291595459}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239968, "num_agent_steps_trained": 239968, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 995.640649151482, "num_env_steps_trained_throughput_per_sec": 995.640649151482, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 239968, "timers": {"training_iteration_time_ms": 3620.256, "sample_time_ms": 672.246, "learn_time_ms": 2933.362, "learn_throughput": 1363.623, "synch_weights_time_ms": 12.241}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 239968, "num_agent_steps_trained": 239968}, "done": false, "episodes_total": 120, "training_iteration": 60, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-55", "timestamp": 1742310175, "time_this_iter_s": 4.0319976806640625, "time_total_s": 218.30322456359863, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 218.30322456359863, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 9.700000000000001, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9725180268287659, "policy_loss": -0.011673466302454472, "vf_loss": 0.9841912984848022, "vf_explained_var": 0.0003734409692697227, "kl": 0.0030656089074909687, "entropy": 0.26346442103385925, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.907015860080719, "policy_loss": -0.0016498435288667679, "vf_loss": 0.9086655974388123, "vf_explained_var": -1.8040339000435779e-06, "kl": 0.0005930815823376179, "entropy": 0.12295377254486084, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3321710526943207, "policy_loss": -0.006478373892605305, "vf_loss": 0.3386494219303131, "vf_explained_var": -8.712212547834497e-06, "kl": 0.0003113026323262602, "entropy": 0.1061672568321228, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20344895124435425, "policy_loss": -0.003088642843067646, "vf_loss": 0.2065376341342926, "vf_explained_var": 4.568837994156638e-06, "kl": 0.00026845186948776245, "entropy": 0.08579706400632858, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.33072713017463684, "policy_loss": -0.001104805269278586, "vf_loss": 0.3318319320678711, "vf_explained_var": 3.627141268225387e-05, "kl": 0.00028826456400565803, "entropy": 0.10068246722221375, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 243968, "num_agent_steps_trained": 243968}, "sampler_results": {"episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}}, "episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243968, "num_agent_steps_trained": 243968, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.0579067602182, "num_env_steps_trained_throughput_per_sec": 1159.0579067602182, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 243968, "timers": {"training_iteration_time_ms": 3624.598, "sample_time_ms": 672.923, "learn_time_ms": 2936.938, "learn_throughput": 1361.963, "synch_weights_time_ms": 12.289}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 243968, "num_agent_steps_trained": 243968}, "done": false, "episodes_total": 120, "training_iteration": 61, "trial_id": "72c65_00000", "date": "2025-03-18_16-02-59", "timestamp": 1742310179, "time_this_iter_s": 3.4629342555999756, "time_total_s": 221.7661588191986, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede331c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 221.7661588191986, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 10.42, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4055752754211426, "policy_loss": -0.012792695313692093, "vf_loss": 1.418367862701416, "vf_explained_var": 0.0005887987790629268, "kl": 0.0036605685018002987, "entropy": 0.24293579161167145, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.4262561500072479, "policy_loss": -0.0023453894536942244, "vf_loss": 0.42860153317451477, "vf_explained_var": 2.396589297859464e-05, "kl": 0.00033816337236203253, "entropy": 0.10733849555253983, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.48493844270706177, "policy_loss": -0.008929122239351273, "vf_loss": 0.49386757612228394, "vf_explained_var": -1.5452646039193496e-05, "kl": 0.0006361347041092813, "entropy": 0.08871596306562424, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09961473196744919, "policy_loss": -0.0046980734914541245, "vf_loss": 0.10431280732154846, "vf_explained_var": 3.825993917416781e-05, "kl": 0.00014592721709050238, "entropy": 0.08509176969528198, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20349204540252686, "policy_loss": -0.007798486854881048, "vf_loss": 0.21129052340984344, "vf_explained_var": -8.146280015353113e-05, "kl": 0.0007300900761038065, "entropy": 0.0901229977607727, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 247968, "num_agent_steps_trained": 247968}, "sampler_results": {"episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}}, "episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247968, "num_agent_steps_trained": 247968, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1149.2904009216127, "num_env_steps_trained_throughput_per_sec": 1149.2904009216127, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 247968, "timers": {"training_iteration_time_ms": 3573.796, "sample_time_ms": 615.977, "learn_time_ms": 2942.654, "learn_throughput": 1359.317, "synch_weights_time_ms": 12.767}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 247968, "num_agent_steps_trained": 247968}, "done": false, "episodes_total": 120, "training_iteration": 62, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-03", "timestamp": 1742310183, "time_this_iter_s": 3.4907312393188477, "time_total_s": 225.25689005851746, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 225.25689005851746, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7973949909210205, "policy_loss": -0.013485676608979702, "vf_loss": 0.8108805418014526, "vf_explained_var": 0.0025550550781190395, "kl": 0.0045286850072443485, "entropy": 0.2153850942850113, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2855694591999054, "policy_loss": -0.007333809044212103, "vf_loss": 0.29290327429771423, "vf_explained_var": 3.527601438690908e-05, "kl": 0.000681321369484067, "entropy": 0.08780664950609207, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.21644343435764313, "policy_loss": -0.0060702040791511536, "vf_loss": 0.22251363098621368, "vf_explained_var": -1.804459679988213e-05, "kl": 0.0003405429015401751, "entropy": 0.07737775892019272, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.19731441140174866, "policy_loss": -0.0061058844439685345, "vf_loss": 0.20342031121253967, "vf_explained_var": 3.2805830414872617e-05, "kl": 0.0005152358789928257, "entropy": 0.07844337821006775, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12785065174102783, "policy_loss": -0.0008935590740293264, "vf_loss": 0.1287442147731781, "vf_explained_var": -4.306293703848496e-06, "kl": 0.00014568846381735057, "entropy": 0.07739579677581787, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 251968, "num_agent_steps_trained": 251968}, "sampler_results": {"episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}}, "episode_reward_max": 1926.3643833349197, "episode_reward_min": 1926.3643833349197, "episode_reward_mean": 1926.3643833349197, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_max": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "policy_reward_mean": {"agent_0": 389.4189653462647, "agent_1": 364.1475176828258, "agent_2": 394.503231433792, "agent_3": 389.23501016237594, "agent_4": 389.05965870966133}, "hist_stats": {"episode_reward": [1926.3643833349197], "episode_lengths": [1995], "policy_agent_0_reward": [389.4189653462647], "policy_agent_1_reward": [364.1475176828258], "policy_agent_2_reward": [394.503231433792], "policy_agent_3_reward": [389.23501016237594], "policy_agent_4_reward": [389.05965870966133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268743604720623, "mean_inference_ms": 0.44600975751471533, "mean_action_processing_ms": 0.0933292511999478, "mean_env_wait_ms": 0.095614838300556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010943412780761719, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.07332801818847656}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251968, "num_agent_steps_trained": 251968, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1146.0379307235582, "num_env_steps_trained_throughput_per_sec": 1146.0379307235582, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 251968, "timers": {"training_iteration_time_ms": 3580.064, "sample_time_ms": 617.719, "learn_time_ms": 2947.232, "learn_throughput": 1357.206, "synch_weights_time_ms": 12.773}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 251968, "num_agent_steps_trained": 251968}, "done": false, "episodes_total": 120, "training_iteration": 63, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-06", "timestamp": 1742310186, "time_this_iter_s": 3.5099480152130127, "time_total_s": 228.76683807373047, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb1000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 228.76683807373047, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 8.548095703125, "policy_loss": -0.006349158938974142, "vf_loss": 8.554444313049316, "vf_explained_var": -7.041948265396059e-05, "kl": 0.002498216461390257, "entropy": 0.19599609076976776, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 8.518266677856445, "policy_loss": -0.0002716793096624315, "vf_loss": 8.518538475036621, "vf_explained_var": 4.7116051860029984e-07, "kl": 0.00016302772564813495, "entropy": 0.08488178253173828, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 8.50446891784668, "policy_loss": -0.0010514225577935576, "vf_loss": 8.505520820617676, "vf_explained_var": -4.17232506322307e-08, "kl": 0.00010114908218383789, "entropy": 0.0793795958161354, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 8.484792709350586, "policy_loss": -0.0033256541937589645, "vf_loss": 8.488118171691895, "vf_explained_var": -2.7049156869907165e-07, "kl": 0.00010225568257737905, "entropy": 0.06902777403593063, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 8.393486022949219, "policy_loss": -0.004101344849914312, "vf_loss": 8.397587776184082, "vf_explained_var": -2.6424726229379303e-07, "kl": 0.0001928197016241029, "entropy": 0.0771918073296547, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 255968, "num_agent_steps_trained": 255968}, "sampler_results": {"episode_reward_max": 1962.6395944390954, "episode_reward_min": 1947.9130828678215, "episode_reward_mean": 1954.3985079918898, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 390.4244662102283, "agent_1": 372.61815946196214, "agent_2": 394.0522727949033, "agent_3": 389.11144503529505, "agent_4": 391.6633842408637}, "policy_reward_max": {"agent_0": 396.1536509208381, "agent_1": 383.52462347953065, "agent_2": 397.0003354626242, "agent_3": 392.19219659512225, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 394.6524362416337, "agent_1": 379.00557045569496, "agent_2": 395.2566530916949, "agent_3": 391.418110108695, "agent_4": 394.06573809417154}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1948.5522456059196, 1947.9130828678215, 1960.4235828823303, 1954.0457350389006, 1962.6395944390954, 1955.1790297656469, 1953.5904992674873, 1952.8442940679179], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [394.68833708018064, 390.4244662102283, 395.7855459675193, 396.00033547785415, 396.0067379470361, 395.7357589014007, 396.1536509208381, 392.4246574280123], "policy_agent_1_reward": [372.61815946196214, 380.27261963806495, 383.52462347953065, 378.2948811307673, 381.22122524903403, 378.0281624061561, 379.5665232637167, 378.5183690163277], "policy_agent_2_reward": [395.3687913378966, 395.73667078261496, 394.7858814301435, 394.0522727949033, 397.0003354626242, 394.73823765320657, 394.37069366533325, 396.0003416068366], "policy_agent_3_reward": [391.1411821234344, 389.11144503529505, 392.19219659512225, 391.94169234234323, 391.3929801410542, 391.5664945069218, 391.8362471767359, 392.1626429486528], "policy_agent_4_reward": [394.73577560244564, 392.36788120161805, 394.1353354100147, 393.7565532930327, 397.01831563934684, 395.1103762979619, 391.6633842408637, 393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5322473167847858, "mean_inference_ms": 0.45691577666498917, "mean_action_processing_ms": 0.09758229989684532, "mean_env_wait_ms": 0.09755390941536071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011334419250488281, "StateBufferConnector_ms": 0.0028467178344726562, "ViewRequirementAgentConnector_ms": 0.07865011692047119}}, "episode_reward_max": 1962.6395944390954, "episode_reward_min": 1947.9130828678215, "episode_reward_mean": 1954.3985079918898, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 390.4244662102283, "agent_1": 372.61815946196214, "agent_2": 394.0522727949033, "agent_3": 389.11144503529505, "agent_4": 391.6633842408637}, "policy_reward_max": {"agent_0": 396.1536509208381, "agent_1": 383.52462347953065, "agent_2": 397.0003354626242, "agent_3": 392.19219659512225, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 394.6524362416337, "agent_1": 379.00557045569496, "agent_2": 395.2566530916949, "agent_3": 391.418110108695, "agent_4": 394.06573809417154}, "hist_stats": {"episode_reward": [1948.5522456059196, 1947.9130828678215, 1960.4235828823303, 1954.0457350389006, 1962.6395944390954, 1955.1790297656469, 1953.5904992674873, 1952.8442940679179], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [394.68833708018064, 390.4244662102283, 395.7855459675193, 396.00033547785415, 396.0067379470361, 395.7357589014007, 396.1536509208381, 392.4246574280123], "policy_agent_1_reward": [372.61815946196214, 380.27261963806495, 383.52462347953065, 378.2948811307673, 381.22122524903403, 378.0281624061561, 379.5665232637167, 378.5183690163277], "policy_agent_2_reward": [395.3687913378966, 395.73667078261496, 394.7858814301435, 394.0522727949033, 397.0003354626242, 394.73823765320657, 394.37069366533325, 396.0003416068366], "policy_agent_3_reward": [391.1411821234344, 389.11144503529505, 392.19219659512225, 391.94169234234323, 391.3929801410542, 391.5664945069218, 391.8362471767359, 392.1626429486528], "policy_agent_4_reward": [394.73577560244564, 392.36788120161805, 394.1353354100147, 393.7565532930327, 397.01831563934684, 395.1103762979619, 391.6633842408637, 393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5322473167847858, "mean_inference_ms": 0.45691577666498917, "mean_action_processing_ms": 0.09758229989684532, "mean_env_wait_ms": 0.09755390941536071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011334419250488281, "StateBufferConnector_ms": 0.0028467178344726562, "ViewRequirementAgentConnector_ms": 0.07865011692047119}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255968, "num_agent_steps_trained": 255968, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 957.1639148201833, "num_env_steps_trained_throughput_per_sec": 957.1639148201833, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 255968, "timers": {"training_iteration_time_ms": 3652.591, "sample_time_ms": 671.651, "learn_time_ms": 2965.852, "learn_throughput": 1348.685, "synch_weights_time_ms": 12.736}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 255968, "num_agent_steps_trained": 255968}, "done": false, "episodes_total": 128, "training_iteration": 64, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-10", "timestamp": 1742310190, "time_this_iter_s": 4.191037178039551, "time_total_s": 232.95787525177002, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddb9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 232.95787525177002, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 9.683333333333334, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8958455324172974, "policy_loss": -0.010663256980478764, "vf_loss": 0.9065088033676147, "vf_explained_var": 0.0011921258410438895, "kl": 0.0018087239004671574, "entropy": 0.14514337480068207, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17591898143291473, "policy_loss": -0.0009926620405167341, "vf_loss": 0.1769116371870041, "vf_explained_var": 8.311896090162918e-05, "kl": 0.00022600778902415186, "entropy": 0.07428202033042908, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.26227250695228577, "policy_loss": 0.0010568504221737385, "vf_loss": 0.2612156569957733, "vf_explained_var": -6.448371095757466e-06, "kl": 0.00028995214961469173, "entropy": 0.07267353683710098, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18228337168693542, "policy_loss": -0.008312077261507511, "vf_loss": 0.19059543311595917, "vf_explained_var": -1.4131409443507437e-05, "kl": 0.00025817545247264206, "entropy": 0.058036625385284424, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17114973068237305, "policy_loss": -0.0007491052383556962, "vf_loss": 0.17189885675907135, "vf_explained_var": -6.767738523194566e-05, "kl": 0.00014371344877872616, "entropy": 0.06901584565639496, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 259968, "num_agent_steps_trained": 259968}, "sampler_results": {"episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}}, "episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259968, "num_agent_steps_trained": 259968, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1155.2705017591188, "num_env_steps_trained_throughput_per_sec": 1155.2705017591188, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 259968, "timers": {"training_iteration_time_ms": 3655.765, "sample_time_ms": 671.843, "learn_time_ms": 2968.824, "learn_throughput": 1347.335, "synch_weights_time_ms": 12.699}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 259968, "num_agent_steps_trained": 259968}, "done": false, "episodes_total": 128, "training_iteration": 65, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-14", "timestamp": 1742310194, "time_this_iter_s": 3.4729959964752197, "time_total_s": 236.43087124824524, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edfb1000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 236.43087124824524, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 10.079999999999998, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8587484359741211, "policy_loss": -0.01122482493519783, "vf_loss": 0.8699732422828674, "vf_explained_var": -0.0013006613589823246, "kl": 0.0017212420934811234, "entropy": 0.11493081599473953, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16331863403320312, "policy_loss": -0.006522230338305235, "vf_loss": 0.16984085738658905, "vf_explained_var": 4.999410521122627e-05, "kl": 0.00015805618022568524, "entropy": 0.06904121488332748, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2025701105594635, "policy_loss": -0.00792712066322565, "vf_loss": 0.21049723029136658, "vf_explained_var": 1.0110083167091943e-05, "kl": 0.00026204934692941606, "entropy": 0.06648552417755127, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1366557776927948, "policy_loss": -0.002964637940749526, "vf_loss": 0.13962039351463318, "vf_explained_var": -2.6082992917508818e-05, "kl": 0.0001702869194559753, "entropy": 0.05192408710718155, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.253349632024765, "policy_loss": 6.459355063270777e-05, "vf_loss": 0.2532850503921509, "vf_explained_var": 6.92952235112898e-05, "kl": 0.0002348801208427176, "entropy": 0.058945756405591965, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 263968, "num_agent_steps_trained": 263968}, "sampler_results": {"episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}}, "episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263968, "num_agent_steps_trained": 263968, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1161.0870796485656, "num_env_steps_trained_throughput_per_sec": 1161.0870796485656, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 263968, "timers": {"training_iteration_time_ms": 3592.23, "sample_time_ms": 614.093, "learn_time_ms": 2963.171, "learn_throughput": 1349.905, "synch_weights_time_ms": 12.663}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 263968, "num_agent_steps_trained": 263968}, "done": false, "episodes_total": 128, "training_iteration": 66, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-18", "timestamp": 1742310198, "time_this_iter_s": 3.455887794494629, "time_total_s": 239.88675904273987, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddb9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 239.88675904273987, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 10.22, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3222607672214508, "policy_loss": -0.010585888288915157, "vf_loss": 0.33284664154052734, "vf_explained_var": 9.131772094406188e-05, "kl": 0.0007119308575056493, "entropy": 0.09226099401712418, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0898532122373581, "policy_loss": -0.006087707355618477, "vf_loss": 0.09594092518091202, "vf_explained_var": -6.103912892285734e-05, "kl": 0.00015004190208856016, "entropy": 0.06494321674108505, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14546902477741241, "policy_loss": -0.0037368133198469877, "vf_loss": 0.14920581877231598, "vf_explained_var": -1.744656401569955e-05, "kl": 0.0002148191852029413, "entropy": 0.05908598378300667, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.17718155682086945, "policy_loss": -0.009059103205800056, "vf_loss": 0.18624067306518555, "vf_explained_var": 1.6317197150783613e-05, "kl": 0.00019341021834407002, "entropy": 0.044157352298498154, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10329923778772354, "policy_loss": 0.0018930818187072873, "vf_loss": 0.10140616446733475, "vf_explained_var": -1.2219803465995938e-05, "kl": 0.00018204223306383938, "entropy": 0.05474883317947388, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 267968, "num_agent_steps_trained": 267968}, "sampler_results": {"episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}}, "episode_reward_max": 1952.8442940679179, "episode_reward_min": 1952.8442940679179, "episode_reward_mean": 1952.8442940679179, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_max": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "policy_reward_mean": {"agent_0": 392.4246574280123, "agent_1": 378.5183690163277, "agent_2": 396.0003416068366, "agent_3": 392.1626429486528, "agent_4": 393.73828306808855}, "hist_stats": {"episode_reward": [1952.8442940679179], "episode_lengths": [1995], "policy_agent_0_reward": [392.4246574280123], "policy_agent_1_reward": [378.5183690163277], "policy_agent_2_reward": [396.0003416068366], "policy_agent_3_reward": [392.1626429486528], "policy_agent_4_reward": [393.73828306808855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5275807020526457, "mean_inference_ms": 0.4477861661366539, "mean_action_processing_ms": 0.09362302956396794, "mean_env_wait_ms": 0.09466349298158834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011224746704101562, "StateBufferConnector_ms": 0.0026082992553710938, "ViewRequirementAgentConnector_ms": 0.08692264556884766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267968, "num_agent_steps_trained": 267968, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1152.3587229966408, "num_env_steps_trained_throughput_per_sec": 1152.3587229966408, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 267968, "timers": {"training_iteration_time_ms": 3595.277, "sample_time_ms": 615.951, "learn_time_ms": 2964.242, "learn_throughput": 1349.417, "synch_weights_time_ms": 12.785}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 267968, "num_agent_steps_trained": 267968}, "done": false, "episodes_total": 128, "training_iteration": 67, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-21", "timestamp": 1742310201, "time_this_iter_s": 3.483314275741577, "time_total_s": 243.37007331848145, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede332e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 243.37007331848145, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 10.18, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 8.396053314208984, "policy_loss": -0.0021195998415350914, "vf_loss": 8.398173332214355, "vf_explained_var": -6.544590178236831e-06, "kl": 0.00017842666420619935, "entropy": 0.09030498564243317, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 8.407029151916504, "policy_loss": -0.0008942604181356728, "vf_loss": 8.407922744750977, "vf_explained_var": 7.041862772894092e-07, "kl": 0.00017811452562455088, "entropy": 0.06211518868803978, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 8.391051292419434, "policy_loss": -0.004665504675358534, "vf_loss": 8.395716667175293, "vf_explained_var": -6.357829107628277e-08, "kl": 4.6039764129091054e-05, "entropy": 0.05838179960846901, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 8.405345916748047, "policy_loss": -0.004896515980362892, "vf_loss": 8.410242080688477, "vf_explained_var": 7.893357860666583e-07, "kl": 3.487624053377658e-05, "entropy": 0.0424162819981575, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 8.348756790161133, "policy_loss": 0.006284166127443314, "vf_loss": 8.342473030090332, "vf_explained_var": 9.020169500217889e-07, "kl": 5.621878517558798e-05, "entropy": 0.055475812405347824, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 271968, "num_agent_steps_trained": 271968}, "sampler_results": {"episode_reward_max": 1977.0286335352553, "episode_reward_min": 1968.538921837439, "episode_reward_mean": 1972.0917047188746, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.27753192538546, "agent_1": 387.8962578973077, "agent_2": 393.13811632733996, "agent_3": 392.5227780216584, "agent_4": 392.6260806040955}, "policy_reward_max": {"agent_0": 397.1353352814913, "agent_1": 394.0000000057244, "agent_2": 397.3678794503212, "agent_3": 395.73580430057336, "agent_4": 397.3678794503212}, "policy_reward_mean": {"agent_0": 395.79508031733997, "agent_1": 391.4652262340329, "agent_2": 395.1136951593503, "agent_3": 394.076234689232, "agent_4": 395.64146831891946}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1970.296533126433, 1972.6912560746682, 1968.538921837439, 1970.9787227116428, 1972.842892704238, 1972.222632713769, 1977.0286335352553, 1972.1340450475525], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [395.01831565467944, 393.27753192538546, 397.1353352814913, 397.0000167017006, 397.0067379469983, 394.41857839944964, 395.50412661378505, 397.00000001522994], "policy_agent_1_reward": [387.8962578973077, 392.97066842842264, 391.37462724519474, 390.5756150399043, 394.0000000057244, 392.23897589560374, 392.0529428887256, 390.61272247138027], "policy_agent_2_reward": [395.3755292792921, 396.0000001539346, 393.13811632733996, 394.3687937051584, 395.73588231044414, 395.5056934840977, 397.3678794503212, 393.41766656421413], "policy_agent_3_reward": [394.6385508448325, 393.44305556616746, 392.5227780216584, 395.37069366523065, 393.4741918369756, 393.0569061823327, 395.73580430057336, 394.3678970960857], "policy_agent_4_reward": [397.3678794503212, 397.0000000007583, 394.3680649617545, 393.6636035996489, 392.6260806040955, 397.00247875228524, 396.3678802818499, 396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5322023465813535, "mean_inference_ms": 0.4566610315253372, "mean_action_processing_ms": 0.09757127748798305, "mean_env_wait_ms": 0.09648735595238195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011733174324035645, "StateBufferConnector_ms": 0.0029289722442626953, "ViewRequirementAgentConnector_ms": 0.08019208908081055}}, "episode_reward_max": 1977.0286335352553, "episode_reward_min": 1968.538921837439, "episode_reward_mean": 1972.0917047188746, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.27753192538546, "agent_1": 387.8962578973077, "agent_2": 393.13811632733996, "agent_3": 392.5227780216584, "agent_4": 392.6260806040955}, "policy_reward_max": {"agent_0": 397.1353352814913, "agent_1": 394.0000000057244, "agent_2": 397.3678794503212, "agent_3": 395.73580430057336, "agent_4": 397.3678794503212}, "policy_reward_mean": {"agent_0": 395.79508031733997, "agent_1": 391.4652262340329, "agent_2": 395.1136951593503, "agent_3": 394.076234689232, "agent_4": 395.64146831891946}, "hist_stats": {"episode_reward": [1970.296533126433, 1972.6912560746682, 1968.538921837439, 1970.9787227116428, 1972.842892704238, 1972.222632713769, 1977.0286335352553, 1972.1340450475525], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [395.01831565467944, 393.27753192538546, 397.1353352814913, 397.0000167017006, 397.0067379469983, 394.41857839944964, 395.50412661378505, 397.00000001522994], "policy_agent_1_reward": [387.8962578973077, 392.97066842842264, 391.37462724519474, 390.5756150399043, 394.0000000057244, 392.23897589560374, 392.0529428887256, 390.61272247138027], "policy_agent_2_reward": [395.3755292792921, 396.0000001539346, 393.13811632733996, 394.3687937051584, 395.73588231044414, 395.5056934840977, 397.3678794503212, 393.41766656421413], "policy_agent_3_reward": [394.6385508448325, 393.44305556616746, 392.5227780216584, 395.37069366523065, 393.4741918369756, 393.0569061823327, 395.73580430057336, 394.3678970960857], "policy_agent_4_reward": [397.3678794503212, 397.0000000007583, 394.3680649617545, 393.6636035996489, 392.6260806040955, 397.00247875228524, 396.3678802818499, 396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5322023465813535, "mean_inference_ms": 0.4566610315253372, "mean_action_processing_ms": 0.09757127748798305, "mean_env_wait_ms": 0.09648735595238195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011733174324035645, "StateBufferConnector_ms": 0.0029289722442626953, "ViewRequirementAgentConnector_ms": 0.08019208908081055}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271968, "num_agent_steps_trained": 271968, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 990.6327160612284, "num_env_steps_trained_throughput_per_sec": 990.6327160612284, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 271968, "timers": {"training_iteration_time_ms": 3650.964, "sample_time_ms": 672.854, "learn_time_ms": 2962.833, "learn_throughput": 1350.059, "synch_weights_time_ms": 12.963}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 271968, "num_agent_steps_trained": 271968}, "done": false, "episodes_total": 136, "training_iteration": 68, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-25", "timestamp": 1742310205, "time_this_iter_s": 4.0505475997924805, "time_total_s": 247.42062091827393, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddba200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 247.42062091827393, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 9.633333333333335, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 4.999999873689376e-05, "total_loss": 0.30362337827682495, "policy_loss": -0.009445593692362309, "vf_loss": 0.3130689263343811, "vf_explained_var": 9.145055628323462e-06, "kl": 0.000286762195173651, "entropy": 0.08791156858205795, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14695414900779724, "policy_loss": -0.002744479803368449, "vf_loss": 0.14969861507415771, "vf_explained_var": 9.622857760405168e-05, "kl": 0.00024159849272109568, "entropy": 0.055892348289489746, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12573841214179993, "policy_loss": 0.0030851508490741253, "vf_loss": 0.12265326827764511, "vf_explained_var": 1.344368592981482e-05, "kl": 0.0002660795289557427, "entropy": 0.05370967462658882, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09363541007041931, "policy_loss": -0.002752405358478427, "vf_loss": 0.09638781100511551, "vf_explained_var": 2.3728041924186982e-05, "kl": 7.731084042461589e-05, "entropy": 0.04106594994664192, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16644145548343658, "policy_loss": -0.002469691215083003, "vf_loss": 0.1689111590385437, "vf_explained_var": -2.906095323851332e-05, "kl": 0.00011620407167356461, "entropy": 0.05024978145956993, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 275968, "num_agent_steps_trained": 275968}, "sampler_results": {"episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}}, "episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275968, "num_agent_steps_trained": 275968, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1154.413018435003, "num_env_steps_trained_throughput_per_sec": 1154.413018435003, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 275968, "timers": {"training_iteration_time_ms": 3649.922, "sample_time_ms": 672.848, "learn_time_ms": 2962.101, "learn_throughput": 1350.393, "synch_weights_time_ms": 12.684}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 275968, "num_agent_steps_trained": 275968}, "done": false, "episodes_total": 136, "training_iteration": 69, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-29", "timestamp": 1742310209, "time_this_iter_s": 3.4783575534820557, "time_total_s": 250.89897847175598, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede331c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 250.89897847175598, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 10.26, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15432024002075195, "policy_loss": -0.0068732681684195995, "vf_loss": 0.16119350492954254, "vf_explained_var": 0.0017643689643591642, "kl": 0.00016184744890779257, "entropy": 0.07984593510627747, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1058584675192833, "policy_loss": -0.010779068805277348, "vf_loss": 0.11663752794265747, "vf_explained_var": 4.713847374659963e-05, "kl": 0.00014473342162091285, "entropy": 0.049721673130989075, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06743723899126053, "policy_loss": -0.007388407830148935, "vf_loss": 0.07482564449310303, "vf_explained_var": 6.4810114963620435e-06, "kl": 0.00012955728743690997, "entropy": 0.057343557476997375, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05680409446358681, "policy_loss": -0.006695857271552086, "vf_loss": 0.06349995732307434, "vf_explained_var": 1.680709101492539e-05, "kl": 3.183376247761771e-05, "entropy": 0.041386932134628296, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2173416167497635, "policy_loss": -0.012670104391872883, "vf_loss": 0.2300117313861847, "vf_explained_var": 4.465353049454279e-05, "kl": 0.00014401358203031123, "entropy": 0.04537812992930412, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 279968, "num_agent_steps_trained": 279968}, "sampler_results": {"episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}}, "episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279968, "num_agent_steps_trained": 279968, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1145.4586804160904, "num_env_steps_trained_throughput_per_sec": 1145.4586804160904, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 279968, "timers": {"training_iteration_time_ms": 3597.379, "sample_time_ms": 618.28, "learn_time_ms": 2964.155, "learn_throughput": 1349.457, "synch_weights_time_ms": 12.701}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 279968, "num_agent_steps_trained": 279968}, "done": false, "episodes_total": 136, "training_iteration": 70, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-32", "timestamp": 1742310212, "time_this_iter_s": 3.5036075115203857, "time_total_s": 254.40258598327637, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddba200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 254.40258598327637, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.0, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1766575276851654, "policy_loss": -0.01358916237950325, "vf_loss": 0.19024667143821716, "vf_explained_var": 0.0007350234664045274, "kl": 0.00035475922049954534, "entropy": 0.06428731977939606, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10758759826421738, "policy_loss": -0.005571453832089901, "vf_loss": 0.11315905302762985, "vf_explained_var": 8.08863387646852e-06, "kl": 8.424289990216494e-05, "entropy": 0.04495957866311073, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5769962072372437, "policy_loss": -0.001976545201614499, "vf_loss": 0.5789727568626404, "vf_explained_var": 7.979358997545205e-06, "kl": 0.0002503967843949795, "entropy": 0.052608951926231384, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.051181621849536896, "policy_loss": -0.004718529526144266, "vf_loss": 0.05590014532208443, "vf_explained_var": 7.187667506514117e-05, "kl": 0.000122476601973176, "entropy": 0.03766398876905441, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1408611536026001, "policy_loss": 0.0008178222924470901, "vf_loss": 0.14004333317279816, "vf_explained_var": -2.6979616450262256e-05, "kl": 0.00011811149306595325, "entropy": 0.04056600108742714, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 283968, "num_agent_steps_trained": 283968}, "sampler_results": {"episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}}, "episode_reward_max": 1972.1340450475525, "episode_reward_min": 1972.1340450475525, "episode_reward_mean": 1972.1340450475525, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_max": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "policy_reward_mean": {"agent_0": 397.00000001522994, "agent_1": 390.61272247138027, "agent_2": 393.41766656421413, "agent_3": 394.3678970960857, "agent_4": 396.7357589006424}, "hist_stats": {"episode_reward": [1972.1340450475525], "episode_lengths": [1995], "policy_agent_0_reward": [397.00000001522994], "policy_agent_1_reward": [390.61272247138027], "policy_agent_2_reward": [393.41766656421413], "policy_agent_3_reward": [394.3678970960857], "policy_agent_4_reward": [396.7357589006424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.527327062312247, "mean_inference_ms": 0.445821061491535, "mean_action_processing_ms": 0.0934769120596005, "mean_env_wait_ms": 0.09349358684508044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.0030469894409179688, "ViewRequirementAgentConnector_ms": 0.08763313293457031}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283968, "num_agent_steps_trained": 283968, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.4978389193013, "num_env_steps_trained_throughput_per_sec": 1159.4978389193013, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 283968, "timers": {"training_iteration_time_ms": 3597.249, "sample_time_ms": 619.198, "learn_time_ms": 2963.254, "learn_throughput": 1349.867, "synch_weights_time_ms": 12.57}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 283968, "num_agent_steps_trained": 283968}, "done": false, "episodes_total": 136, "training_iteration": 71, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-36", "timestamp": 1742310216, "time_this_iter_s": 3.4610791206359863, "time_total_s": 257.86366510391235, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede331c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 257.86366510391235, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.12, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 8.317564010620117, "policy_loss": 0.0019695283845067024, "vf_loss": 8.315594673156738, "vf_explained_var": 2.4452097022731323e-06, "kl": 8.518399408785626e-05, "entropy": 0.06246317923069, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 8.325953483581543, "policy_loss": 0.005406978074461222, "vf_loss": 8.320547103881836, "vf_explained_var": -8.571715426342053e-08, "kl": 1.6209045497816987e-05, "entropy": 0.04230658337473869, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 8.30337905883789, "policy_loss": -0.0006023725145496428, "vf_loss": 8.303980827331543, "vf_explained_var": -1.1438415015163628e-07, "kl": 0.0004056039033457637, "entropy": 0.04129219800233841, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 8.288232803344727, "policy_loss": -0.0009134304127655923, "vf_loss": 8.289146423339844, "vf_explained_var": -8.259500816620857e-08, "kl": 7.438518514391035e-05, "entropy": 0.03403769060969353, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 8.201411247253418, "policy_loss": 0.00030147985671646893, "vf_loss": 8.201109886169434, "vf_explained_var": 9.664466915637604e-07, "kl": 8.664793858770281e-05, "entropy": 0.04017377644777298, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 287968, "num_agent_steps_trained": 287968}, "sampler_results": {"episode_reward_max": 1983.424740289352, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1977.9518261012536, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.1103763131919, "agent_2": 395.3678856097636, "agent_3": 393.36891478555606, "agent_4": 392.4368948852762}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0067379469983, "agent_4": 397.0000167017006}, "policy_reward_mean": {"agent_0": 395.7413383087519, "agent_1": 395.27701018072895, "agent_2": 396.538432963592, "agent_3": 395.39935599471255, "agent_4": 394.99568865346816}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1980.0135948112988, 1977.2581162249355, 1980.295548471494, 1978.3957961912972, 1983.424740289352, 1972.0758751340452, 1980.939532771494, 1971.2114049161112], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [395.1356715756442, 397.00000000206114, 398.0, 395.18512265427046, 397.0000000413994, 393.5035501952976, 397.0497870668769, 393.05657493446506], "policy_agent_1_reward": [395.50321503771477, 394.47151791382, 394.5213048681617, 395.73823765292764, 397.3678794503212, 394.1103763131919, 396.13533528150515, 394.3682149281893], "policy_agent_2_reward": [396.00004540068926, 398.0, 395.5035501944367, 395.3678856097636, 398.0, 397.0000000413994, 397.01831563934684, 395.4176668231004], "policy_agent_3_reward": [397.0067379469983, 394.78645784949185, 395.270676707195, 396.36879133229377, 397.0000003059023, 395.02505369888036, 394.3682153313829, 393.36891478555606], "policy_agent_4_reward": [396.36792485025217, 393.0001404595623, 397.0000167017006, 395.7357589420418, 394.0568604917294, 392.4368948852762, 396.36787945238234, 395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321873995612811, "mean_inference_ms": 0.45657257484610236, "mean_action_processing_ms": 0.09755139029564777, "mean_env_wait_ms": 0.09555477956404855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01147150993347168, "StateBufferConnector_ms": 0.002880096435546875, "ViewRequirementAgentConnector_ms": 0.07858216762542725}}, "episode_reward_max": 1983.424740289352, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1977.9518261012536, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.1103763131919, "agent_2": 395.3678856097636, "agent_3": 393.36891478555606, "agent_4": 392.4368948852762}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0067379469983, "agent_4": 397.0000167017006}, "policy_reward_mean": {"agent_0": 395.7413383087519, "agent_1": 395.27701018072895, "agent_2": 396.538432963592, "agent_3": 395.39935599471255, "agent_4": 394.99568865346816}, "hist_stats": {"episode_reward": [1980.0135948112988, 1977.2581162249355, 1980.295548471494, 1978.3957961912972, 1983.424740289352, 1972.0758751340452, 1980.939532771494, 1971.2114049161112], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [395.1356715756442, 397.00000000206114, 398.0, 395.18512265427046, 397.0000000413994, 393.5035501952976, 397.0497870668769, 393.05657493446506], "policy_agent_1_reward": [395.50321503771477, 394.47151791382, 394.5213048681617, 395.73823765292764, 397.3678794503212, 394.1103763131919, 396.13533528150515, 394.3682149281893], "policy_agent_2_reward": [396.00004540068926, 398.0, 395.5035501944367, 395.3678856097636, 398.0, 397.0000000413994, 397.01831563934684, 395.4176668231004], "policy_agent_3_reward": [397.0067379469983, 394.78645784949185, 395.270676707195, 396.36879133229377, 397.0000003059023, 395.02505369888036, 394.3682153313829, 393.36891478555606], "policy_agent_4_reward": [396.36792485025217, 393.0001404595623, 397.0000167017006, 395.7357589420418, 394.0568604917294, 392.4368948852762, 396.36787945238234, 395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321873995612811, "mean_inference_ms": 0.45657257484610236, "mean_action_processing_ms": 0.09755139029564777, "mean_env_wait_ms": 0.09555477956404855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01147150993347168, "StateBufferConnector_ms": 0.002880096435546875, "ViewRequirementAgentConnector_ms": 0.07858216762542725}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287968, "num_agent_steps_trained": 287968, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1010.4198925067282, "num_env_steps_trained_throughput_per_sec": 1010.4198925067282, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 287968, "timers": {"training_iteration_time_ms": 3645.084, "sample_time_ms": 675.962, "learn_time_ms": 2954.883, "learn_throughput": 1353.691, "synch_weights_time_ms": 11.99}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 287968, "num_agent_steps_trained": 287968}, "done": false, "episodes_total": 144, "training_iteration": 72, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-40", "timestamp": 1742310220, "time_this_iter_s": 3.971174955368042, "time_total_s": 261.8348400592804, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 261.8348400592804, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 9.86, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 4.999999873689376e-05, "total_loss": 0.23262083530426025, "policy_loss": -0.0005507197347469628, "vf_loss": 0.23317155241966248, "vf_explained_var": -0.0007135655032470822, "kl": 0.00019560569489840418, "entropy": 0.057088788598775864, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.017079299315810204, "policy_loss": -0.0027030264027416706, "vf_loss": 0.01978232152760029, "vf_explained_var": -2.4456068786093965e-05, "kl": 4.3290259782224894e-05, "entropy": 0.041182227432727814, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10044410079717636, "policy_loss": 0.002307942369952798, "vf_loss": 0.09813617169857025, "vf_explained_var": -1.3383513760345522e-05, "kl": 0.00013697829854208976, "entropy": 0.03838791698217392, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025286318734288216, "policy_loss": -0.001751261530444026, "vf_loss": 0.02703757956624031, "vf_explained_var": -0.0001389015233144164, "kl": 8.299780893139541e-05, "entropy": 0.031164737418293953, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009992597624659538, "policy_loss": -0.0025608493015170097, "vf_loss": 0.012553446926176548, "vf_explained_var": -0.00030419768881984055, "kl": 1.6336700355168432e-05, "entropy": 0.03983177989721298, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 291968, "num_agent_steps_trained": 291968}, "sampler_results": {"episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}}, "episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291968, "num_agent_steps_trained": 291968, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1157.769991322185, "num_env_steps_trained_throughput_per_sec": 1157.769991322185, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 291968, "timers": {"training_iteration_time_ms": 3641.547, "sample_time_ms": 674.928, "learn_time_ms": 2952.398, "learn_throughput": 1354.831, "synch_weights_time_ms": 11.995}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 291968, "num_agent_steps_trained": 291968}, "done": false, "episodes_total": 144, "training_iteration": 73, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-44", "timestamp": 1742310224, "time_this_iter_s": 3.4649765491485596, "time_total_s": 265.29981660842896, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 265.29981660842896, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 10.219999999999999, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.054269980639219284, "policy_loss": -0.005659995134919882, "vf_loss": 0.059929974377155304, "vf_explained_var": 0.0004071729490533471, "kl": 5.2934228733647615e-05, "entropy": 0.052561648190021515, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09007691591978073, "policy_loss": -0.0022366216871887445, "vf_loss": 0.09231355041265488, "vf_explained_var": -2.0194052922306582e-05, "kl": 0.0001236594980582595, "entropy": 0.036656949669122696, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06422775238752365, "policy_loss": -0.004387449007481337, "vf_loss": 0.06861519813537598, "vf_explained_var": 2.765910903690383e-05, "kl": 5.877949297428131e-05, "entropy": 0.035539790987968445, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10257081687450409, "policy_loss": 0.00026217670529149473, "vf_loss": 0.10230863839387894, "vf_explained_var": -1.9926115783164278e-05, "kl": 7.689690391998738e-05, "entropy": 0.028206417337059975, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05635112524032593, "policy_loss": -0.0036197591107338667, "vf_loss": 0.059970881789922714, "vf_explained_var": -0.00012196245370432734, "kl": 7.853238639654592e-05, "entropy": 0.03666802495718002, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 295968, "num_agent_steps_trained": 295968}, "sampler_results": {"episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}}, "episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295968, "num_agent_steps_trained": 295968, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1175.848273861959, "num_env_steps_trained_throughput_per_sec": 1175.848273861959, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 295968, "timers": {"training_iteration_time_ms": 3563.823, "sample_time_ms": 616.963, "learn_time_ms": 2932.479, "learn_throughput": 1364.034, "synch_weights_time_ms": 12.105}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 295968, "num_agent_steps_trained": 295968}, "done": false, "episodes_total": 144, "training_iteration": 74, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-47", "timestamp": 1742310227, "time_this_iter_s": 3.411949872970581, "time_total_s": 268.71176648139954, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 268.71176648139954, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034993067383766174, "policy_loss": -0.0021658632904291153, "vf_loss": 0.03715892881155014, "vf_explained_var": -0.00016415318532381207, "kl": 0.00013372453395277262, "entropy": 0.0512547641992569, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04389788210391998, "policy_loss": -0.001965984469279647, "vf_loss": 0.045863863080739975, "vf_explained_var": -3.785178705584258e-06, "kl": 5.368825077312067e-05, "entropy": 0.03445625677704811, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06854799389839172, "policy_loss": 0.0021583500783890486, "vf_loss": 0.06638964265584946, "vf_explained_var": 1.964313560165465e-05, "kl": 0.0001355195854557678, "entropy": 0.03347907215356827, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1485932171344757, "policy_loss": 0.004040083382278681, "vf_loss": 0.14455313980579376, "vf_explained_var": -2.293501529493369e-05, "kl": 4.580684253596701e-05, "entropy": 0.02650401182472706, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13603895902633667, "policy_loss": 0.0021807632874697447, "vf_loss": 0.13385817408561707, "vf_explained_var": -2.941829734481871e-05, "kl": 8.759425691096112e-05, "entropy": 0.03379494696855545, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 299968, "num_agent_steps_trained": 299968}, "sampler_results": {"episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}}, "episode_reward_max": 1971.2114049161112, "episode_reward_min": 1971.2114049161112, "episode_reward_mean": 1971.2114049161112, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_max": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "policy_reward_mean": {"agent_0": 393.05657493446506, "agent_1": 394.3682149281893, "agent_2": 395.4176668231004, "agent_3": 393.36891478555606, "agent_4": 395.0000334448006}, "hist_stats": {"episode_reward": [1971.2114049161112], "episode_lengths": [1995], "policy_agent_0_reward": [393.05657493446506], "policy_agent_1_reward": [394.3682149281893], "policy_agent_2_reward": [395.4176668231004], "policy_agent_3_reward": [393.36891478555606], "policy_agent_4_reward": [395.0000334448006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5271588625873064, "mean_inference_ms": 0.44527650127801355, "mean_action_processing_ms": 0.09335774467546461, "mean_env_wait_ms": 0.09246574620770626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012960433959960938, "StateBufferConnector_ms": 0.0030612945556640625, "ViewRequirementAgentConnector_ms": 0.08723735809326172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299968, "num_agent_steps_trained": 299968, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1164.3428227520637, "num_env_steps_trained_throughput_per_sec": 1164.3428227520637, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 299968, "timers": {"training_iteration_time_ms": 3561.124, "sample_time_ms": 614.9, "learn_time_ms": 2931.696, "learn_throughput": 1364.398, "synch_weights_time_ms": 12.25}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 299968, "num_agent_steps_trained": 299968}, "done": false, "episodes_total": 144, "training_iteration": 75, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-51", "timestamp": 1742310231, "time_this_iter_s": 3.4464187622070312, "time_total_s": 272.15818524360657, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 272.15818524360657, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 10.183333333333332, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 4.999999873689376e-05, "total_loss": 8.217506408691406, "policy_loss": 0.00010905662929872051, "vf_loss": 8.217397689819336, "vf_explained_var": -4.175163326181064e-07, "kl": 0.00014123838627710938, "entropy": 0.051715027540922165, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 8.177454948425293, "policy_loss": -0.0045217485167086124, "vf_loss": 8.181977272033691, "vf_explained_var": 2.9007594548602356e-07, "kl": 1.2590981896209996e-05, "entropy": 0.034838732331991196, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 8.212191581726074, "policy_loss": -0.0021510489750653505, "vf_loss": 8.214343070983887, "vf_explained_var": 2.2763298090922035e-07, "kl": 4.569785960484296e-05, "entropy": 0.0331253781914711, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 8.226545333862305, "policy_loss": 0.0043545616790652275, "vf_loss": 8.222189903259277, "vf_explained_var": -3.394626446606708e-07, "kl": 9.491557648289017e-06, "entropy": 0.02537396363914013, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 8.096315383911133, "policy_loss": 0.00020303115888964385, "vf_loss": 8.096112251281738, "vf_explained_var": 1.6206786312977783e-07, "kl": 6.86391576891765e-05, "entropy": 0.034465666860342026, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 303968, "num_agent_steps_trained": 303968}, "sampler_results": {"episode_reward_max": 1985.871094407204, "episode_reward_min": 1980.8011922437213, "episode_reward_mean": 1983.9061814629733, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 393.2457116919884, "agent_2": 394.3703590361963, "agent_3": 396.18512234836817, "agent_4": 395.0067379629866}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.4925639408325, "agent_1": 396.59587794199115, "agent_2": 396.88826553852283, "agent_3": 397.03609518313385, "agent_4": 396.89337885849307}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.7382544672012, 1983.0134885043121, 1980.8011922437213, 1982.1061190798723, 1985.871094407204, 1984.7919754311442, 1985.1036551672605, 1984.8236724030712], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0000167017006, 397.0067379469983, 398.0, 397.3678794503212, 397.1353352814913, 394.60685308277607, 396.3678961520218, 394.4557929113507], "policy_agent_1_reward": [397.00000000003774, 397.0000061442124, 393.2457116919884, 396.3678802818499, 396.7357589006424, 397.0497870668769, 398.0, 397.3678794503212], "policy_agent_2_reward": [397.0000001125352, 397.0000061442124, 397.3678794503212, 394.3703590361963, 398.0, 398.0, 395.36787956491753, 398.0], "policy_agent_3_reward": [396.7357589006424, 397.0000003059023, 396.18512234836817, 397.0000003059023, 397.0000001125352, 398.0, 397.3678794503212, 397.0000000413994], "policy_agent_4_reward": [397.00247875228524, 395.0067379629866, 396.00247875304353, 397.00000000560283, 397.0000001125352, 397.1353352814913, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320679072985408, "mean_inference_ms": 0.45615192391471426, "mean_action_processing_ms": 0.09743615168119266, "mean_env_wait_ms": 0.09463298449701128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011668205261230469, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.07945895195007324}}, "episode_reward_max": 1985.871094407204, "episode_reward_min": 1980.8011922437213, "episode_reward_mean": 1983.9061814629733, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 393.2457116919884, "agent_2": 394.3703590361963, "agent_3": 396.18512234836817, "agent_4": 395.0067379629866}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.4925639408325, "agent_1": 396.59587794199115, "agent_2": 396.88826553852283, "agent_3": 397.03609518313385, "agent_4": 396.89337885849307}, "hist_stats": {"episode_reward": [1984.7382544672012, 1983.0134885043121, 1980.8011922437213, 1982.1061190798723, 1985.871094407204, 1984.7919754311442, 1985.1036551672605, 1984.8236724030712], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0000167017006, 397.0067379469983, 398.0, 397.3678794503212, 397.1353352814913, 394.60685308277607, 396.3678961520218, 394.4557929113507], "policy_agent_1_reward": [397.00000000003774, 397.0000061442124, 393.2457116919884, 396.3678802818499, 396.7357589006424, 397.0497870668769, 398.0, 397.3678794503212], "policy_agent_2_reward": [397.0000001125352, 397.0000061442124, 397.3678794503212, 394.3703590361963, 398.0, 398.0, 395.36787956491753, 398.0], "policy_agent_3_reward": [396.7357589006424, 397.0000003059023, 396.18512234836817, 397.0000003059023, 397.0000001125352, 398.0, 397.3678794503212, 397.0000000413994], "policy_agent_4_reward": [397.00247875228524, 395.0067379629866, 396.00247875304353, 397.00000000560283, 397.0000001125352, 397.1353352814913, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320679072985408, "mean_inference_ms": 0.45615192391471426, "mean_action_processing_ms": 0.09743615168119266, "mean_env_wait_ms": 0.09463298449701128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011668205261230469, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.07945895195007324}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303968, "num_agent_steps_trained": 303968, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 998.96793894257, "num_env_steps_trained_throughput_per_sec": 998.96793894257, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 303968, "timers": {"training_iteration_time_ms": 3617.031, "sample_time_ms": 670.152, "learn_time_ms": 2932.362, "learn_throughput": 1364.088, "synch_weights_time_ms": 12.197}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 303968, "num_agent_steps_trained": 303968}, "done": false, "episodes_total": 152, "training_iteration": 76, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-55", "timestamp": 1742310235, "time_this_iter_s": 4.018952369689941, "time_total_s": 276.1771376132965, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 276.1771376132965, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 9.780000000000001, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16148577630519867, "policy_loss": -0.0030095474794507027, "vf_loss": 0.1644953340291977, "vf_explained_var": -0.00031124523957259953, "kl": 0.00014088496391195804, "entropy": 0.04676426202058792, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.056552860885858536, "policy_loss": -0.0006448898930102587, "vf_loss": 0.057197753340005875, "vf_explained_var": -5.40316104888916e-05, "kl": 5.198727740207687e-05, "entropy": 0.033162642270326614, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.045052606612443924, "policy_loss": -0.0024571947287768126, "vf_loss": 0.04750979691743851, "vf_explained_var": 4.404499486554414e-05, "kl": 2.9252314561745152e-05, "entropy": 0.03258280083537102, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033172693103551865, "policy_loss": -0.0033339017536491156, "vf_loss": 0.03650659695267677, "vf_explained_var": -4.218873527861433e-06, "kl": 3.746639777091332e-05, "entropy": 0.023959150537848473, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.017082078382372856, "policy_loss": -0.003427092917263508, "vf_loss": 0.02050917036831379, "vf_explained_var": -9.487469651503488e-05, "kl": 2.912980562541634e-05, "entropy": 0.033614084124565125, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 307968, "num_agent_steps_trained": 307968}, "sampler_results": {"episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}}, "episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307968, "num_agent_steps_trained": 307968, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1142.799847419759, "num_env_steps_trained_throughput_per_sec": 1142.799847419759, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 307968, "timers": {"training_iteration_time_ms": 3619.936, "sample_time_ms": 669.322, "learn_time_ms": 2936.092, "learn_throughput": 1362.355, "synch_weights_time_ms": 12.191}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 307968, "num_agent_steps_trained": 307968}, "done": false, "episodes_total": 152, "training_iteration": 77, "trial_id": "72c65_00000", "date": "2025-03-18_16-03-58", "timestamp": 1742310238, "time_this_iter_s": 3.5120677947998047, "time_total_s": 279.6892054080963, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 279.6892054080963, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1669788360595703, "policy_loss": -0.0020188894122838974, "vf_loss": 0.16899773478507996, "vf_explained_var": 0.00019020523177459836, "kl": 0.00011786798859247938, "entropy": 0.03935394436120987, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04409066215157509, "policy_loss": -0.0015004994347691536, "vf_loss": 0.04559116065502167, "vf_explained_var": -1.1119672308268491e-05, "kl": 5.4694071877747774e-05, "entropy": 0.03297101706266403, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1204829066991806, "policy_loss": -0.0074591669254004955, "vf_loss": 0.1279420703649521, "vf_explained_var": 1.2745459571306128e-05, "kl": 8.379446080652997e-05, "entropy": 0.029147882014513016, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09912213683128357, "policy_loss": 0.0005502270651049912, "vf_loss": 0.09857191145420074, "vf_explained_var": 3.3049356716219336e-05, "kl": 7.18964365660213e-05, "entropy": 0.021229857578873634, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0681222528219223, "policy_loss": 0.000741644820664078, "vf_loss": 0.06738060712814331, "vf_explained_var": -4.103354149265215e-05, "kl": 5.067298479843885e-05, "entropy": 0.03384645655751228, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 311968, "num_agent_steps_trained": 311968}, "sampler_results": {"episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}}, "episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311968, "num_agent_steps_trained": 311968, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1152.7767910136101, "num_env_steps_trained_throughput_per_sec": 1152.7767910136101, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 311968, "timers": {"training_iteration_time_ms": 3563.14, "sample_time_ms": 611.703, "learn_time_ms": 2937.013, "learn_throughput": 1361.928, "synch_weights_time_ms": 12.132}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 311968, "num_agent_steps_trained": 311968}, "done": false, "episodes_total": 152, "training_iteration": 78, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-02", "timestamp": 1742310242, "time_this_iter_s": 3.4804251194000244, "time_total_s": 283.16963052749634, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a4d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 283.16963052749634, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 10.049999999999999, "ram_util_percent": 6.3999999999999995}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16264735162258148, "policy_loss": -0.008341259323060513, "vf_loss": 0.17098860442638397, "vf_explained_var": -4.42226737504825e-05, "kl": 0.00015335017815232277, "entropy": 0.03341875225305557, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13092146813869476, "policy_loss": -0.00565669359639287, "vf_loss": 0.13657815754413605, "vf_explained_var": -2.6583670660329517e-06, "kl": 0.00017028494039550424, "entropy": 0.028928551822900772, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009279740042984486, "policy_loss": 0.003850989043712616, "vf_loss": 0.005428750533610582, "vf_explained_var": 9.694808977656066e-05, "kl": 7.426471711369231e-06, "entropy": 0.029292335733771324, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07605849206447601, "policy_loss": -0.0036751520819962025, "vf_loss": 0.07973363995552063, "vf_explained_var": -1.713207780085213e-06, "kl": 3.0513763704220764e-05, "entropy": 0.019791357219219208, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1780935674905777, "policy_loss": -0.00795451644808054, "vf_loss": 0.18604806065559387, "vf_explained_var": 1.7745722288964316e-05, "kl": 0.0001545241248095408, "entropy": 0.027222387492656708, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 315968, "num_agent_steps_trained": 315968}, "sampler_results": {"episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}}, "episode_reward_max": 1984.8236724030712, "episode_reward_min": 1984.8236724030712, "episode_reward_mean": 1984.8236724030712, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 394.4557929113507, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 397.0000000413994, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.8236724030712], "episode_lengths": [1995], "policy_agent_0_reward": [394.4557929113507], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [397.0000000413994], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268298344581881, "mean_inference_ms": 0.444736541194328, "mean_action_processing_ms": 0.09318449720514846, "mean_env_wait_ms": 0.09150609339931406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010962486267089844, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0731801986694336}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315968, "num_agent_steps_trained": 315968, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1160.7128291466133, "num_env_steps_trained_throughput_per_sec": 1160.7128291466133, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 315968, "timers": {"training_iteration_time_ms": 3561.258, "sample_time_ms": 610.507, "learn_time_ms": 2936.181, "learn_throughput": 1362.314, "synch_weights_time_ms": 12.283}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 315968, "num_agent_steps_trained": 315968}, "done": false, "episodes_total": 152, "training_iteration": 79, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-06", "timestamp": 1742310246, "time_this_iter_s": 3.4577462673187256, "time_total_s": 286.62737679481506, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 286.62737679481506, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 10.179999999999998, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 8.116218566894531, "policy_loss": 0.003205243730917573, "vf_loss": 8.11301326751709, "vf_explained_var": -2.368574996580719e-06, "kl": 1.4766957974643447e-05, "entropy": 0.03280755132436752, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 8.086678504943848, "policy_loss": -0.004169077146798372, "vf_loss": 8.090847969055176, "vf_explained_var": -1.033147185580674e-07, "kl": 4.0994429582497105e-05, "entropy": 0.027232836931943893, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 8.108118057250977, "policy_loss": 0.0011890142923220992, "vf_loss": 8.106927871704102, "vf_explained_var": 3.2072975386654434e-08, "kl": 4.235137384966947e-05, "entropy": 0.030134178698062897, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 8.134042739868164, "policy_loss": 0.002821481553837657, "vf_loss": 8.131220817565918, "vf_explained_var": -9.025846026133877e-08, "kl": 1.0704640772019047e-05, "entropy": 0.02077939547598362, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 8.014100074768066, "policy_loss": 0.0028879849705845118, "vf_loss": 8.011211395263672, "vf_explained_var": -2.9234659137955532e-08, "kl": 8.766697646933608e-06, "entropy": 0.026507282629609108, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 319968, "num_agent_steps_trained": 319968}, "sampler_results": {"episode_reward_max": 1986.5032158692436, "episode_reward_min": 1975.3371995818477, "episode_reward_mean": 1983.2326595577524, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.04992943872253, "agent_1": 394.2389736325575, "agent_2": 395.00012342506943, "agent_3": 395.467453584075, "agent_4": 395.4359821565449}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.0003354626242, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.9159326698132, "agent_1": 395.4803336828911, "agent_2": 396.97325064539706, "agent_3": 396.9656348280504, "agent_4": 396.89750773160074}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.5243612877694, 1984.613591029877, 1984.1546728038365, 1984.4250815336572, 1975.3371995818477, 1982.2958341112944, 1986.5032158692436, 1984.0073202444937], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 398.0, 393.04992943872253, 397.1353352814913, 397.1353352814913, 396.0068613568001], "policy_agent_1_reward": [396.00249545398583, 394.2389736325575, 395.4180019798223, 395.37462354153195, 394.3838340966031, 395.0565250141542, 396.3678802818499, 397.0003354626242], "policy_agent_2_reward": [397.0003354626242, 398.0, 398.0, 397.0497870668769, 397.0000003059023, 395.73575890270354, 398.0, 395.00012342506943], "policy_agent_3_reward": [396.1536509208381, 397.3678794503212, 396.7357589006424, 398.0, 395.467453584075, 397.0003354626242, 397.0000003059023, 398.0], "policy_agent_4_reward": [397.3678794503212, 397.0067379469983, 396.000911923372, 396.0006709252484, 395.4359821565449, 397.3678794503212, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320722554755841, "mean_inference_ms": 0.45577852920467765, "mean_action_processing_ms": 0.09744220628001947, "mean_env_wait_ms": 0.0938725293879181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011807680130004883, "StateBufferConnector_ms": 0.0029778480529785156, "ViewRequirementAgentConnector_ms": 0.08047819137573242}}, "episode_reward_max": 1986.5032158692436, "episode_reward_min": 1975.3371995818477, "episode_reward_mean": 1983.2326595577524, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 393.04992943872253, "agent_1": 394.2389736325575, "agent_2": 395.00012342506943, "agent_3": 395.467453584075, "agent_4": 395.4359821565449}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.0003354626242, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.9159326698132, "agent_1": 395.4803336828911, "agent_2": 396.97325064539706, "agent_3": 396.9656348280504, "agent_4": 396.89750773160074}, "hist_stats": {"episode_reward": [1984.5243612877694, 1984.613591029877, 1984.1546728038365, 1984.4250815336572, 1975.3371995818477, 1982.2958341112944, 1986.5032158692436, 1984.0073202444937], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 398.0, 393.04992943872253, 397.1353352814913, 397.1353352814913, 396.0068613568001], "policy_agent_1_reward": [396.00249545398583, 394.2389736325575, 395.4180019798223, 395.37462354153195, 394.3838340966031, 395.0565250141542, 396.3678802818499, 397.0003354626242], "policy_agent_2_reward": [397.0003354626242, 398.0, 398.0, 397.0497870668769, 397.0000003059023, 395.73575890270354, 398.0, 395.00012342506943], "policy_agent_3_reward": [396.1536509208381, 397.3678794503212, 396.7357589006424, 398.0, 395.467453584075, 397.0003354626242, 397.0000003059023, 398.0], "policy_agent_4_reward": [397.3678794503212, 397.0067379469983, 396.000911923372, 396.0006709252484, 395.4359821565449, 397.3678794503212, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320722554755841, "mean_inference_ms": 0.45577852920467765, "mean_action_processing_ms": 0.09744220628001947, "mean_env_wait_ms": 0.0938725293879181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011807680130004883, "StateBufferConnector_ms": 0.0029778480529785156, "ViewRequirementAgentConnector_ms": 0.08047819137573242}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319968, "num_agent_steps_trained": 319968, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1002.0202000896951, "num_env_steps_trained_throughput_per_sec": 1002.0202000896951, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 319968, "timers": {"training_iteration_time_ms": 3611.247, "sample_time_ms": 664.987, "learn_time_ms": 2931.669, "learn_throughput": 1364.41, "synch_weights_time_ms": 12.273}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 319968, "num_agent_steps_trained": 319968}, "done": false, "episodes_total": 160, "training_iteration": 80, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-10", "timestamp": 1742310250, "time_this_iter_s": 4.005879163742065, "time_total_s": 290.63325595855713, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 290.63325595855713, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 9.8, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12737177312374115, "policy_loss": -0.007333637215197086, "vf_loss": 0.13470540940761566, "vf_explained_var": 0.0009858105331659317, "kl": 0.00013946967374067754, "entropy": 0.029683001339435577, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01826643757522106, "policy_loss": -0.0031604624819010496, "vf_loss": 0.02142689749598503, "vf_explained_var": -7.2161356001743115e-06, "kl": 9.411427890881896e-05, "entropy": 0.025625523179769516, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08560077846050262, "policy_loss": -0.0009339857497252524, "vf_loss": 0.0865347757935524, "vf_explained_var": 3.5100609238725156e-05, "kl": 6.214450695551932e-05, "entropy": 0.028713911771774292, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.034626491367816925, "policy_loss": -0.0032610350754112005, "vf_loss": 0.03788752853870392, "vf_explained_var": 1.0964699868054595e-05, "kl": 7.064096280373633e-05, "entropy": 0.019936997443437576, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04987512156367302, "policy_loss": 0.004482372663915157, "vf_loss": 0.04539274424314499, "vf_explained_var": -5.301889905240387e-05, "kl": 2.6075887944898568e-05, "entropy": 0.026883220300078392, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 323968, "num_agent_steps_trained": 323968}, "sampler_results": {"episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}}, "episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323968, "num_agent_steps_trained": 323968, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1168.4495792326345, "num_env_steps_trained_throughput_per_sec": 1168.4495792326345, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 323968, "timers": {"training_iteration_time_ms": 3608.604, "sample_time_ms": 661.707, "learn_time_ms": 2932.298, "learn_throughput": 1364.118, "synch_weights_time_ms": 12.309}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 323968, "num_agent_steps_trained": 323968}, "done": false, "episodes_total": 160, "training_iteration": 81, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-13", "timestamp": 1742310253, "time_this_iter_s": 3.4339890480041504, "time_total_s": 294.0672450065613, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 294.0672450065613, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 10.059999999999999, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04254734516143799, "policy_loss": -0.0055909473448991776, "vf_loss": 0.04813829064369202, "vf_explained_var": -0.0001119210573961027, "kl": 0.00011695446301018819, "entropy": 0.028864094987511635, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.046501487493515015, "policy_loss": -0.0017208711942657828, "vf_loss": 0.04822235926985741, "vf_explained_var": -2.4493250748491846e-05, "kl": 8.374663593713194e-05, "entropy": 0.023181024938821793, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15086273849010468, "policy_loss": -0.0017766492674127221, "vf_loss": 0.15263938903808594, "vf_explained_var": 8.66509617480915e-06, "kl": 0.00014526420272886753, "entropy": 0.025007715448737144, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.011085144244134426, "policy_loss": -0.005622147582471371, "vf_loss": 0.016707291826605797, "vf_explained_var": -5.002617763238959e-05, "kl": 4.832394188269973e-05, "entropy": 0.018555602058768272, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07765370607376099, "policy_loss": -0.0051287440583109856, "vf_loss": 0.08278244733810425, "vf_explained_var": 9.143068382400088e-06, "kl": 9.591437265044078e-05, "entropy": 0.02505360171198845, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 327968, "num_agent_steps_trained": 327968}, "sampler_results": {"episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}}, "episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327968, "num_agent_steps_trained": 327968, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1170.4146264435794, "num_env_steps_trained_throughput_per_sec": 1170.4146264435794, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 327968, "timers": {"training_iteration_time_ms": 3554.488, "sample_time_ms": 602.256, "learn_time_ms": 2937.557, "learn_throughput": 1361.676, "synch_weights_time_ms": 12.339}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 327968, "num_agent_steps_trained": 327968}, "done": false, "episodes_total": 160, "training_iteration": 82, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-17", "timestamp": 1742310257, "time_this_iter_s": 3.4272921085357666, "time_total_s": 297.49453711509705, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 297.49453711509705, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 10.18, "ram_util_percent": 6.4}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14210224151611328, "policy_loss": -0.001323590986430645, "vf_loss": 0.1434258371591568, "vf_explained_var": -0.0010868257377296686, "kl": 4.479542258195579e-05, "entropy": 0.028072571381926537, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.003406594507396221, "policy_loss": -0.002356224460527301, "vf_loss": 0.00576282013207674, "vf_explained_var": 1.745422741805669e-05, "kl": 4.860876651946455e-05, "entropy": 0.021786337718367577, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0006271942984312773, "policy_loss": -0.004378469195216894, "vf_loss": 0.00500566465780139, "vf_explained_var": -0.00022383870964404196, "kl": 1.2424055057635996e-05, "entropy": 0.02404789626598358, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07822931557893753, "policy_loss": -0.0028227006550878286, "vf_loss": 0.08105200529098511, "vf_explained_var": -8.629333024146035e-06, "kl": 2.8407574063749053e-05, "entropy": 0.018224412575364113, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.020040225237607956, "policy_loss": -0.00894526019692421, "vf_loss": 0.028985487297177315, "vf_explained_var": 9.570178372086957e-05, "kl": 7.814157288521528e-05, "entropy": 0.024055294692516327, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 331968, "num_agent_steps_trained": 331968}, "sampler_results": {"episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}}, "episode_reward_max": 1984.0073202444937, "episode_reward_min": 1984.0073202444937, "episode_reward_mean": 1984.0073202444937, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.0068613568001, "agent_1": 397.0003354626242, "agent_2": 395.00012342506943, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1984.0073202444937], "episode_lengths": [1995], "policy_agent_0_reward": [396.0068613568001], "policy_agent_1_reward": [397.0003354626242], "policy_agent_2_reward": [395.00012342506943], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266637802839261, "mean_inference_ms": 0.44355434535881905, "mean_action_processing_ms": 0.09313863127390322, "mean_env_wait_ms": 0.0907005701913574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010762214660644531, "StateBufferConnector_ms": 0.0024747848510742188, "ViewRequirementAgentConnector_ms": 0.0727987289428711}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331968, "num_agent_steps_trained": 331968, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1156.7598702366145, "num_env_steps_trained_throughput_per_sec": 1156.7598702366145, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 331968, "timers": {"training_iteration_time_ms": 3554.787, "sample_time_ms": 601.839, "learn_time_ms": 2938.165, "learn_throughput": 1361.394, "synch_weights_time_ms": 12.405}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 331968, "num_agent_steps_trained": 331968}, "done": false, "episodes_total": 160, "training_iteration": 83, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-20", "timestamp": 1742310260, "time_this_iter_s": 3.4694020748138428, "time_total_s": 300.9639391899109, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a4d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 300.9639391899109, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 10.083333333333334, "ram_util_percent": 6.466666666666666}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 7.988431453704834, "policy_loss": -0.0016149120638146996, "vf_loss": 7.990045547485352, "vf_explained_var": -3.095183956247638e-06, "kl": 9.094177585211582e-06, "entropy": 0.02596060000360012, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 8.020662307739258, "policy_loss": 0.001753689837642014, "vf_loss": 8.018908500671387, "vf_explained_var": -5.384286509979574e-07, "kl": 4.0745300793787464e-05, "entropy": 0.023210756480693817, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 8.025909423828125, "policy_loss": 0.002250267192721367, "vf_loss": 8.023658752441406, "vf_explained_var": 2.6254426188643265e-07, "kl": 1.640521441004239e-05, "entropy": 0.02546142414212227, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 7.99851655960083, "policy_loss": -0.0004089678986929357, "vf_loss": 7.99892520904541, "vf_explained_var": -1.331170409457627e-07, "kl": 1.5406993043143302e-05, "entropy": 0.018194016069173813, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 7.905226707458496, "policy_loss": 0.001171632669866085, "vf_loss": 7.904055595397949, "vf_explained_var": -3.5251889585197205e-07, "kl": 4.195123983663507e-05, "entropy": 0.02252594567835331, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 335968, "num_agent_steps_trained": 335968}, "sampler_results": {"episode_reward_max": 1987.000123410839, "episode_reward_min": 1983.246623589191, "episode_reward_mean": 1985.3382689679433, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 395.41766651719877, "agent_1": 395.5099526788108, "agent_2": 395.15365175236684, "agent_3": 395.73667078261496, "agent_4": 396.00000012776513}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.8384618733804, "agent_1": 396.61228597796, "agent_2": 397.31519140224145, "agent_3": 397.27602924797884, "agent_4": 397.2963004663826}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1986.4186237991016, 1985.7565532978772, 1985.8353330343969, 1986.1536525838956, 1983.7421945084936, 1983.246623589191, 1984.5530475197525, 1987.000123410839], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.00091188197257, 397.01831563934684, 395.41766651719877, 397.0000008315287, 396.1353414257037, 398.0, 397.1353352814913, 397.00012340980174], "policy_agent_1_reward": [397.0497870668769, 396.36787945592397, 396.4176665171981, 398.0, 396.5032147318125, 395.5099526788108, 396.0497873727792, 397.000000000279], "policy_agent_2_reward": [397.3678794503212, 398.0, 398.0, 395.15365175236684, 397.00000000001387, 398.0, 397.00000001523, 398.0], "policy_agent_3_reward": [398.0, 398.0, 398.0, 398.0, 396.1036383509636, 395.73667078261496, 396.36792485025217, 398.0], "policy_agent_4_reward": [397.00004539993097, 396.37035820260644, 398.0, 398.0, 398.0, 396.00000012776513, 398.0, 397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319952114727187, "mean_inference_ms": 0.45541345282698337, "mean_action_processing_ms": 0.09738135651739913, "mean_env_wait_ms": 0.09315829342772418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010967254638671875, "StateBufferConnector_ms": 0.0027376413345336914, "ViewRequirementAgentConnector_ms": 0.07458388805389404}}, "episode_reward_max": 1987.000123410839, "episode_reward_min": 1983.246623589191, "episode_reward_mean": 1985.3382689679433, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 395.41766651719877, "agent_1": 395.5099526788108, "agent_2": 395.15365175236684, "agent_3": 395.73667078261496, "agent_4": 396.00000012776513}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 396.8384618733804, "agent_1": 396.61228597796, "agent_2": 397.31519140224145, "agent_3": 397.27602924797884, "agent_4": 397.2963004663826}, "hist_stats": {"episode_reward": [1986.4186237991016, 1985.7565532978772, 1985.8353330343969, 1986.1536525838956, 1983.7421945084936, 1983.246623589191, 1984.5530475197525, 1987.000123410839], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.00091188197257, 397.01831563934684, 395.41766651719877, 397.0000008315287, 396.1353414257037, 398.0, 397.1353352814913, 397.00012340980174], "policy_agent_1_reward": [397.0497870668769, 396.36787945592397, 396.4176665171981, 398.0, 396.5032147318125, 395.5099526788108, 396.0497873727792, 397.000000000279], "policy_agent_2_reward": [397.3678794503212, 398.0, 398.0, 395.15365175236684, 397.00000000001387, 398.0, 397.00000001523, 398.0], "policy_agent_3_reward": [398.0, 398.0, 398.0, 398.0, 396.1036383509636, 395.73667078261496, 396.36792485025217, 398.0], "policy_agent_4_reward": [397.00004539993097, 396.37035820260644, 398.0, 398.0, 398.0, 396.00000012776513, 398.0, 397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5319952114727187, "mean_inference_ms": 0.45541345282698337, "mean_action_processing_ms": 0.09738135651739913, "mean_env_wait_ms": 0.09315829342772418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010967254638671875, "StateBufferConnector_ms": 0.0027376413345336914, "ViewRequirementAgentConnector_ms": 0.07458388805389404}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 335968, "num_agent_steps_trained": 335968, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1002.0526973666607, "num_env_steps_trained_throughput_per_sec": 1002.0526973666607, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 335968, "timers": {"training_iteration_time_ms": 3613.789, "sample_time_ms": 661.781, "learn_time_ms": 2937.227, "learn_throughput": 1361.829, "synch_weights_time_ms": 12.422}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 335968, "num_agent_steps_trained": 335968}, "done": false, "episodes_total": 168, "training_iteration": 84, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-24", "timestamp": 1742310264, "time_this_iter_s": 4.005298614501953, "time_total_s": 304.96923780441284, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87eddba200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 304.96923780441284, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 9.780000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09902414679527283, "policy_loss": -0.006548350211232901, "vf_loss": 0.10557250678539276, "vf_explained_var": -0.00039100731373764575, "kl": 4.912001168122515e-05, "entropy": 0.024480102583765984, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.017226075753569603, "policy_loss": -0.0068939742632210255, "vf_loss": 0.02412004955112934, "vf_explained_var": -3.1928220778354444e-06, "kl": 4.412931957631372e-05, "entropy": 0.02247372269630432, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03865961357951164, "policy_loss": -0.0029574986547231674, "vf_loss": 0.04161711037158966, "vf_explained_var": 1.4394805475603789e-05, "kl": 7.864070357754827e-05, "entropy": 0.022942274808883667, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0017745986115187407, "policy_loss": -0.00026715753483586013, "vf_loss": 0.0020417554769665003, "vf_explained_var": -4.179421011940576e-05, "kl": 9.684719088909333e-07, "entropy": 0.017976636067032814, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05548058822751045, "policy_loss": 0.0009246899862773716, "vf_loss": 0.054555900394916534, "vf_explained_var": 1.0208004823653027e-05, "kl": 2.316686550329905e-05, "entropy": 0.019706062972545624, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 339968, "num_agent_steps_trained": 339968}, "sampler_results": {"episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}}, "episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 339968, "num_agent_steps_trained": 339968, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1169.1702886413402, "num_env_steps_trained_throughput_per_sec": 1169.1702886413402, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 339968, "timers": {"training_iteration_time_ms": 3612.371, "sample_time_ms": 661.599, "learn_time_ms": 2935.875, "learn_throughput": 1362.456, "synch_weights_time_ms": 12.478}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 339968, "num_agent_steps_trained": 339968}, "done": false, "episodes_total": 168, "training_iteration": 85, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-28", "timestamp": 1742310268, "time_this_iter_s": 3.4349288940429688, "time_total_s": 308.4041666984558, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a4d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 308.4041666984558, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 4.999999873689376e-05, "total_loss": 0.047092460095882416, "policy_loss": -0.002415346447378397, "vf_loss": 0.049507807940244675, "vf_explained_var": -0.0011670782696455717, "kl": 0.0001437696919310838, "entropy": 0.02164272591471672, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": -0.002560462336987257, "policy_loss": -0.003696147818118334, "vf_loss": 0.001135686063207686, "vf_explained_var": 0.0002958056575153023, "kl": 3.9945462049217895e-06, "entropy": 0.022105535492300987, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12424009293317795, "policy_loss": 0.00228299992159009, "vf_loss": 0.12195708602666855, "vf_explained_var": 0.00010896864114329219, "kl": 0.00012098298611817881, "entropy": 0.020525291562080383, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.012546907179057598, "policy_loss": -0.00498801888898015, "vf_loss": 0.017534926533699036, "vf_explained_var": -4.539886958809802e-06, "kl": 7.613364869030192e-05, "entropy": 0.017693283036351204, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.003471729811280966, "policy_loss": 0.0019348186906427145, "vf_loss": 0.0015369096072390676, "vf_explained_var": -6.364641012623906e-05, "kl": 1.7458673937653657e-06, "entropy": 0.019609874114394188, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 343968, "num_agent_steps_trained": 343968}, "sampler_results": {"episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}}, "episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 343968, "num_agent_steps_trained": 343968, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1153.2214000547563, "num_env_steps_trained_throughput_per_sec": 1153.2214000547563, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 343968, "timers": {"training_iteration_time_ms": 3558.813, "sample_time_ms": 606.747, "learn_time_ms": 2937.01, "learn_throughput": 1361.929, "synch_weights_time_ms": 12.575}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 343968, "num_agent_steps_trained": 343968}, "done": false, "episodes_total": 168, "training_iteration": 86, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-32", "timestamp": 1742310272, "time_this_iter_s": 3.4788858890533447, "time_total_s": 311.88305258750916, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829aef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 311.88305258750916, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 10.24, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03626294806599617, "policy_loss": -0.001467443653382361, "vf_loss": 0.037730392068624496, "vf_explained_var": -0.00018270214786753058, "kl": 5.073684951639734e-05, "entropy": 0.019662555307149887, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029588885605335236, "policy_loss": -0.0069540333934128284, "vf_loss": 0.036542925983667374, "vf_explained_var": 0.00013173790648579597, "kl": 6.134209979791194e-05, "entropy": 0.020658178254961967, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033365506678819656, "policy_loss": -0.0017189279897138476, "vf_loss": 0.03508443757891655, "vf_explained_var": 9.843792213359848e-05, "kl": 1.4576770809071604e-05, "entropy": 0.019897116348147392, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004618304315954447, "policy_loss": 0.004023822024464607, "vf_loss": 0.0005944803124293685, "vf_explained_var": -0.00027430595946498215, "kl": 4.7868743422441185e-06, "entropy": 0.017367344349622726, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0029522066470235586, "policy_loss": 0.0023429703433066607, "vf_loss": 0.0006092343828640878, "vf_explained_var": -0.000854337471537292, "kl": 1.2427253750502132e-06, "entropy": 0.01967085339128971, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 347968, "num_agent_steps_trained": 347968}, "sampler_results": {"episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}}, "episode_reward_max": 1987.000123410839, "episode_reward_min": 1987.000123410839, "episode_reward_mean": 1987.000123410839, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_max": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "policy_reward_mean": {"agent_0": 397.00012340980174, "agent_1": 397.000000000279, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000000007583}, "hist_stats": {"episode_reward": [1987.000123410839], "episode_lengths": [1995], "policy_agent_0_reward": [397.00012340980174], "policy_agent_1_reward": [397.000000000279], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000000007583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266658011136948, "mean_inference_ms": 0.4429224175994293, "mean_action_processing_ms": 0.0930559220494198, "mean_env_wait_ms": 0.0900392211512984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013256072998046875, "StateBufferConnector_ms": 0.0030755996704101562, "ViewRequirementAgentConnector_ms": 0.08906841278076172}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 347968, "num_agent_steps_trained": 347968, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.9892615821163, "num_env_steps_trained_throughput_per_sec": 1091.9892615821163, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 347968, "timers": {"training_iteration_time_ms": 3575.1, "sample_time_ms": 605.709, "learn_time_ms": 2954.375, "learn_throughput": 1353.924, "synch_weights_time_ms": 12.558}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 347968, "num_agent_steps_trained": 347968}, "done": false, "episodes_total": 168, "training_iteration": 87, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-35", "timestamp": 1742310275, "time_this_iter_s": 3.674060583114624, "time_total_s": 315.5571131706238, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 315.5571131706238, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.016666666666666, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 7.872727394104004, "policy_loss": -0.005703961476683617, "vf_loss": 7.8784308433532715, "vf_explained_var": 1.0368370340074762e-06, "kl": 4.940860435453942e-06, "entropy": 0.019197672605514526, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 7.926783561706543, "policy_loss": 0.004893874749541283, "vf_loss": 7.921888828277588, "vf_explained_var": 2.9802322387695312e-08, "kl": 3.267050487920642e-06, "entropy": 0.021153436973690987, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 7.905783653259277, "policy_loss": -0.0027713242452591658, "vf_loss": 7.908555030822754, "vf_explained_var": -2.838316426334586e-08, "kl": 0.0001963680551853031, "entropy": 0.025295238941907883, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 7.910094738006592, "policy_loss": -0.0006244063260965049, "vf_loss": 7.91071891784668, "vf_explained_var": -4.793916446033109e-07, "kl": 1.5747240468044765e-05, "entropy": 0.017435971647500992, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 7.798170566558838, "policy_loss": -0.0009418982663191855, "vf_loss": 7.799112319946289, "vf_explained_var": -5.46375929388887e-07, "kl": 3.88532043871237e-06, "entropy": 0.019195465371012688, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 351968, "num_agent_steps_trained": 351968}, "sampler_results": {"episode_reward_max": 1989.0000000413993, "episode_reward_min": 1983.4782891930836, "episode_reward_mean": 1986.442823727783, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 396.37035820260644, "agent_2": 397.00012340980174, "agent_3": 395.3746340990201, "agent_4": 395.18512238976757}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.6718272129027, "agent_1": 396.9348770251464, "agent_2": 397.59820867216513, "agent_3": 397.18478482436933, "agent_4": 397.0531259931993}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1985.555480592374, 1988.5032147318125, 1985.1061174099095, 1985.1543434440255, 1989.0000000413993, 1987.3704816124082, 1983.4782891930836, 1987.3746627972505], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 397.0000003059023, 398.0, 398.0, 398.0, 397.3678794503212, 397.0067379469983], "policy_agent_1_reward": [396.37035820260644, 397.3678794503212, 396.37035820260644, 397.3678794503212, 397.0000000413994, 397.00247875228524, 397.0000167017006, 397.00004539993097], "policy_agent_2_reward": [398.0, 398.0, 398.0, 397.0497870668769, 398.0, 397.00012340980174, 397.3678794503212, 397.3678794503212], "policy_agent_3_reward": [398.0, 398.0, 396.3678794510795, 396.3678855945336, 398.0, 397.3678794503212, 395.3746340990201, 398.0], "policy_agent_4_reward": [395.18512238976757, 397.1353352814913, 397.3678794503212, 396.36879133229377, 398.0, 398.0, 396.3678794917206, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321067188688875, "mean_inference_ms": 0.4558069812002806, "mean_action_processing_ms": 0.09745951931665318, "mean_env_wait_ms": 0.09259299533924881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011816620826721191, "StateBufferConnector_ms": 0.0029653310775756836, "ViewRequirementAgentConnector_ms": 0.0801229476928711}}, "episode_reward_max": 1989.0000000413993, "episode_reward_min": 1983.4782891930836, "episode_reward_mean": 1986.442823727783, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 396.37035820260644, "agent_2": 397.00012340980174, "agent_3": 395.3746340990201, "agent_4": 395.18512238976757}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.6718272129027, "agent_1": 396.9348770251464, "agent_2": 397.59820867216513, "agent_3": 397.18478482436933, "agent_4": 397.0531259931993}, "hist_stats": {"episode_reward": [1985.555480592374, 1988.5032147318125, 1985.1061174099095, 1985.1543434440255, 1989.0000000413993, 1987.3704816124082, 1983.4782891930836, 1987.3746627972505], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 397.0000003059023, 398.0, 398.0, 398.0, 397.3678794503212, 397.0067379469983], "policy_agent_1_reward": [396.37035820260644, 397.3678794503212, 396.37035820260644, 397.3678794503212, 397.0000000413994, 397.00247875228524, 397.0000167017006, 397.00004539993097], "policy_agent_2_reward": [398.0, 398.0, 398.0, 397.0497870668769, 398.0, 397.00012340980174, 397.3678794503212, 397.3678794503212], "policy_agent_3_reward": [398.0, 398.0, 396.3678794510795, 396.3678855945336, 398.0, 397.3678794503212, 395.3746340990201, 398.0], "policy_agent_4_reward": [395.18512238976757, 397.1353352814913, 397.3678794503212, 396.36879133229377, 398.0, 398.0, 396.3678794917206, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321067188688875, "mean_inference_ms": 0.4558069812002806, "mean_action_processing_ms": 0.09745951931665318, "mean_env_wait_ms": 0.09259299533924881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011816620826721191, "StateBufferConnector_ms": 0.0029653310775756836, "ViewRequirementAgentConnector_ms": 0.0801229476928711}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 351968, "num_agent_steps_trained": 351968, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1005.7918766011111, "num_env_steps_trained_throughput_per_sec": 1005.7918766011111, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 351968, "timers": {"training_iteration_time_ms": 3625.811, "sample_time_ms": 661.681, "learn_time_ms": 2949.11, "learn_throughput": 1356.341, "synch_weights_time_ms": 12.545}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 351968, "num_agent_steps_trained": 351968}, "done": false, "episodes_total": 176, "training_iteration": 88, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-39", "timestamp": 1742310279, "time_this_iter_s": 3.9950613975524902, "time_total_s": 319.55217456817627, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829aef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 319.55217456817627, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 9.86, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08139360696077347, "policy_loss": -0.004003226291388273, "vf_loss": 0.08539683371782303, "vf_explained_var": -0.0003539187600836158, "kl": 4.013878060504794e-05, "entropy": 0.01714993827044964, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05195903778076172, "policy_loss": 0.004943354520946741, "vf_loss": 0.047015681862831116, "vf_explained_var": -1.4705885405419394e-05, "kl": 2.2291733330348507e-05, "entropy": 0.02086574211716652, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07260549068450928, "policy_loss": -0.004582763649523258, "vf_loss": 0.07718825340270996, "vf_explained_var": 0.00019755022367462516, "kl": 0.0002449575695209205, "entropy": 0.02521403133869171, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04372244328260422, "policy_loss": -0.004681705497205257, "vf_loss": 0.04840414971113205, "vf_explained_var": -1.9678331227623858e-05, "kl": 6.171125278342515e-05, "entropy": 0.016484536230564117, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.043148014694452286, "policy_loss": -0.0015179141191765666, "vf_loss": 0.044665925204753876, "vf_explained_var": 9.257679630536586e-05, "kl": 1.4677988474431913e-05, "entropy": 0.018131710588932037, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 355968, "num_agent_steps_trained": 355968}, "sampler_results": {"episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}}, "episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355968, "num_agent_steps_trained": 355968, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1142.2584713065125, "num_env_steps_trained_throughput_per_sec": 1142.2584713065125, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 355968, "timers": {"training_iteration_time_ms": 3631.379, "sample_time_ms": 665.727, "learn_time_ms": 2950.659, "learn_throughput": 1355.629, "synch_weights_time_ms": 12.51}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 355968, "num_agent_steps_trained": 355968}, "done": false, "episodes_total": 176, "training_iteration": 89, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-43", "timestamp": 1742310283, "time_this_iter_s": 3.513465166091919, "time_total_s": 323.0656397342682, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 323.0656397342682, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 10.133333333333335, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.012776322662830353, "policy_loss": 0.0003489214868750423, "vf_loss": 0.012427398934960365, "vf_explained_var": -0.0005630090017803013, "kl": 1.719264400890097e-05, "entropy": 0.016699928790330887, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": -0.002009880729019642, "policy_loss": -0.0025143027305603027, "vf_loss": 0.0005044204299338162, "vf_explained_var": 0.0007726604235358536, "kl": 4.921827894577291e-06, "entropy": 0.020578298717737198, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0016272859647870064, "policy_loss": -0.0022295997478067875, "vf_loss": 0.0038568859454244375, "vf_explained_var": -0.001022049691528082, "kl": 1.0232908607576974e-05, "entropy": 0.02329430729150772, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05701373890042305, "policy_loss": 0.00028183512040413916, "vf_loss": 0.05673190578818321, "vf_explained_var": 2.4301664325321326e-06, "kl": 4.315204205340706e-05, "entropy": 0.016449803486466408, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004416679497808218, "policy_loss": 0.0038772844709455967, "vf_loss": 0.0005393960163928568, "vf_explained_var": 3.88202206522692e-05, "kl": 3.443497007538099e-06, "entropy": 0.019048096612095833, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 359968, "num_agent_steps_trained": 359968}, "sampler_results": {"episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}}, "episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 359968, "num_agent_steps_trained": 359968, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1160.1801855503725, "num_env_steps_trained_throughput_per_sec": 1160.1801855503725, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 359968, "timers": {"training_iteration_time_ms": 3576.958, "sample_time_ms": 610.218, "learn_time_ms": 2951.81, "learn_throughput": 1355.101, "synch_weights_time_ms": 12.47}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 359968, "num_agent_steps_trained": 359968}, "done": false, "episodes_total": 176, "training_iteration": 90, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-47", "timestamp": 1742310287, "time_this_iter_s": 3.4588887691497803, "time_total_s": 326.52452850341797, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 326.52452850341797, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 10.139999999999999, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0287385992705822, "policy_loss": -0.004432907793670893, "vf_loss": 0.033171508461236954, "vf_explained_var": -9.268039866583422e-05, "kl": 1.880451600300148e-05, "entropy": 0.016291888430714607, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03665051609277725, "policy_loss": 0.00045028625754639506, "vf_loss": 0.036200232803821564, "vf_explained_var": -8.713745046406984e-05, "kl": 6.538192246807739e-05, "entropy": 0.019358869642019272, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.021993691101670265, "policy_loss": -0.005999668501317501, "vf_loss": 0.027993356809020042, "vf_explained_var": -0.000123091260320507, "kl": 2.1673984520020895e-05, "entropy": 0.023056067526340485, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06875993311405182, "policy_loss": -0.003329585073515773, "vf_loss": 0.07208952307701111, "vf_explained_var": 4.2926982132485136e-05, "kl": 4.94879532197956e-05, "entropy": 0.015154662542045116, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05409888178110123, "policy_loss": -0.006587060168385506, "vf_loss": 0.06068594008684158, "vf_explained_var": -2.501039307389874e-05, "kl": 2.0930672690155916e-05, "entropy": 0.017797663807868958, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 363968, "num_agent_steps_trained": 363968}, "sampler_results": {"episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}}, "episode_reward_max": 1987.3746627972505, "episode_reward_min": 1987.3746627972505, "episode_reward_mean": 1987.3746627972505, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0067379469983, "agent_1": 397.00004539993097, "agent_2": 397.3678794503212, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1987.3746627972505], "episode_lengths": [1995], "policy_agent_0_reward": [397.0067379469983], "policy_agent_1_reward": [397.00004539993097], "policy_agent_2_reward": [397.3678794503212], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266638398807142, "mean_inference_ms": 0.4433734111196791, "mean_action_processing_ms": 0.09310802804678966, "mean_env_wait_ms": 0.08950627708144628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010991096496582031, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.07257938385009766}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 363968, "num_agent_steps_trained": 363968, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1159.6065917501935, "num_env_steps_trained_throughput_per_sec": 1159.6065917501935, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 363968, "timers": {"training_iteration_time_ms": 3579.569, "sample_time_ms": 611.327, "learn_time_ms": 2953.262, "learn_throughput": 1354.434, "synch_weights_time_ms": 12.51}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 363968, "num_agent_steps_trained": 363968}, "done": false, "episodes_total": 176, "training_iteration": 91, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-50", "timestamp": 1742310290, "time_this_iter_s": 3.4603917598724365, "time_total_s": 329.9849202632904, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829ad40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 329.9849202632904, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 10.120000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 7.789504051208496, "policy_loss": -0.0007071092259138823, "vf_loss": 7.7902116775512695, "vf_explained_var": 3.320546284157899e-06, "kl": 6.940158073120983e-06, "entropy": 0.015839718282222748, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 7.789840221405029, "policy_loss": -0.0014661825262010098, "vf_loss": 7.791306495666504, "vf_explained_var": 3.860110453501875e-08, "kl": 5.9106741900905035e-06, "entropy": 0.019147686660289764, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 7.758630752563477, "policy_loss": -0.007017802447080612, "vf_loss": 7.76564884185791, "vf_explained_var": 1.2971105434189667e-07, "kl": 8.383646672882605e-06, "entropy": 0.022020481526851654, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 7.818988800048828, "policy_loss": 0.004215471912175417, "vf_loss": 7.814772605895996, "vf_explained_var": 1.1410031675040955e-07, "kl": 1.4495573168460396e-06, "entropy": 0.014720062725245953, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 7.6999406814575195, "policy_loss": -0.0021394549403339624, "vf_loss": 7.702080249786377, "vf_explained_var": -1.5667507113903412e-07, "kl": 4.311783050070517e-05, "entropy": 0.01713092438876629, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 367968, "num_agent_steps_trained": 367968}, "sampler_results": {"episode_reward_max": 1989.0000022603294, "episode_reward_min": 1984.503231557711, "episode_reward_mean": 1986.9490384912117, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0000167431, "agent_1": 396.13538068142225, "agent_2": 396.0000000827988, "agent_3": 397.00012340980174, "agent_4": 396.0681027062237}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.3772918303598, "agent_1": 397.21777922242853, "agent_2": 397.30225027189454, "agent_3": 397.65884924659804, "agent_4": 397.3928679199307}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1986.2349094153476, 1985.8897452841047, 1989.0000022603294, 1988.1353806814222, 1988.0067379622283, 1984.8223006560147, 1984.503231557711, 1989.0000001125352], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0000000001026, 398.0, 397.00000226032944, 398.0, 398.0, 397.01831563934684, 396.0000167431, 398.0], "policy_agent_1_reward": [398.0, 397.3678794503212, 398.0, 396.13538068142225, 397.00000001522994, 396.7357589006424, 396.5032147318125, 398.0], "policy_agent_2_reward": [397.0497870668769, 396.3682149129454, 398.0, 398.0, 398.0, 398.0, 396.0000000827988, 397.0000001125352], "policy_agent_3_reward": [397.1353352814913, 397.1353352814913, 398.0, 398.0, 398.0, 397.00012340980174, 398.0, 398.0], "policy_agent_4_reward": [397.0497870668769, 397.01831563934684, 398.0, 398.0, 397.0067379469983, 396.0681027062237, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321478423096637, "mean_inference_ms": 0.45581632680352474, "mean_action_processing_ms": 0.09745578074366634, "mean_env_wait_ms": 0.09202072043586915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012360215187072754, "StateBufferConnector_ms": 0.0030940771102905273, "ViewRequirementAgentConnector_ms": 0.08449137210845947}}, "episode_reward_max": 1989.0000022603294, "episode_reward_min": 1984.503231557711, "episode_reward_mean": 1986.9490384912117, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0000167431, "agent_1": 396.13538068142225, "agent_2": 396.0000000827988, "agent_3": 397.00012340980174, "agent_4": 396.0681027062237}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.3772918303598, "agent_1": 397.21777922242853, "agent_2": 397.30225027189454, "agent_3": 397.65884924659804, "agent_4": 397.3928679199307}, "hist_stats": {"episode_reward": [1986.2349094153476, 1985.8897452841047, 1989.0000022603294, 1988.1353806814222, 1988.0067379622283, 1984.8223006560147, 1984.503231557711, 1989.0000001125352], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0000000001026, 398.0, 397.00000226032944, 398.0, 398.0, 397.01831563934684, 396.0000167431, 398.0], "policy_agent_1_reward": [398.0, 397.3678794503212, 398.0, 396.13538068142225, 397.00000001522994, 396.7357589006424, 396.5032147318125, 398.0], "policy_agent_2_reward": [397.0497870668769, 396.3682149129454, 398.0, 398.0, 398.0, 398.0, 396.0000000827988, 397.0000001125352], "policy_agent_3_reward": [397.1353352814913, 397.1353352814913, 398.0, 398.0, 398.0, 397.00012340980174, 398.0, 398.0], "policy_agent_4_reward": [397.0497870668769, 397.01831563934684, 398.0, 398.0, 397.0067379469983, 396.0681027062237, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321478423096637, "mean_inference_ms": 0.45581632680352474, "mean_action_processing_ms": 0.09745578074366634, "mean_env_wait_ms": 0.09202072043586915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012360215187072754, "StateBufferConnector_ms": 0.0030940771102905273, "ViewRequirementAgentConnector_ms": 0.08449137210845947}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367968, "num_agent_steps_trained": 367968, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 989.0329990971071, "num_env_steps_trained_throughput_per_sec": 989.0329990971071, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 367968, "timers": {"training_iteration_time_ms": 3642.245, "sample_time_ms": 671.051, "learn_time_ms": 2956.209, "learn_throughput": 1353.084, "synch_weights_time_ms": 12.603}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 367968, "num_agent_steps_trained": 367968}, "done": false, "episodes_total": 184, "training_iteration": 92, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-54", "timestamp": 1742310294, "time_this_iter_s": 4.05816650390625, "time_total_s": 334.04308676719666, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 334.04308676719666, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 9.700000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06645230948925018, "policy_loss": -0.004369176924228668, "vf_loss": 0.07082148641347885, "vf_explained_var": 3.956754881073721e-05, "kl": 3.55084594048094e-05, "entropy": 0.015146896243095398, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06050510331988335, "policy_loss": -0.002319662133231759, "vf_loss": 0.06282476335763931, "vf_explained_var": 6.323712295852602e-05, "kl": 5.0658625696087256e-05, "entropy": 0.01818685233592987, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07284871488809586, "policy_loss": 0.0014648655196651816, "vf_loss": 0.07138385623693466, "vf_explained_var": 0.00011969634215347469, "kl": 6.861871224828064e-05, "entropy": 0.017927145585417747, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.029760073870420456, "policy_loss": -0.004816011991351843, "vf_loss": 0.03457608446478844, "vf_explained_var": 4.169231397099793e-05, "kl": 1.7178266716655344e-05, "entropy": 0.014102890156209469, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11181613057851791, "policy_loss": -0.0019406464416533709, "vf_loss": 0.11375679820775986, "vf_explained_var": 5.448318552225828e-05, "kl": 7.30013707652688e-05, "entropy": 0.0147370221093297, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 371968, "num_agent_steps_trained": 371968}, "sampler_results": {"episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}}, "episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 371968, "num_agent_steps_trained": 371968, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1162.3466338107228, "num_env_steps_trained_throughput_per_sec": 1162.3466338107228, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 371968, "timers": {"training_iteration_time_ms": 3640.585, "sample_time_ms": 669.571, "learn_time_ms": 2955.643, "learn_throughput": 1353.343, "synch_weights_time_ms": 12.955}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 371968, "num_agent_steps_trained": 371968}, "done": false, "episodes_total": 184, "training_iteration": 93, "trial_id": "72c65_00000", "date": "2025-03-18_16-04-58", "timestamp": 1742310298, "time_this_iter_s": 3.45253324508667, "time_total_s": 337.4956200122833, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829ad40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 337.4956200122833, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 10.28, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08416636288166046, "policy_loss": -0.0026218057610094547, "vf_loss": 0.08678816258907318, "vf_explained_var": 1.4167740118864458e-05, "kl": 5.569887434830889e-05, "entropy": 0.014155900105834007, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08158371597528458, "policy_loss": 0.006018832791596651, "vf_loss": 0.07556488364934921, "vf_explained_var": -1.038341270032106e-05, "kl": 9.09499722183682e-05, "entropy": 0.015482793562114239, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03396698087453842, "policy_loss": -0.0021761003881692886, "vf_loss": 0.03614307940006256, "vf_explained_var": 0.00020878372015431523, "kl": 7.635169822606258e-06, "entropy": 0.018054239451885223, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.013178514316678047, "policy_loss": -0.003885046113282442, "vf_loss": 0.01706356182694435, "vf_explained_var": -0.00019776423869188875, "kl": 4.584152338793501e-05, "entropy": 0.013302689418196678, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.010690628550946712, "policy_loss": -0.006950464099645615, "vf_loss": 0.017641091719269753, "vf_explained_var": -0.0003333372587803751, "kl": 9.507612048764713e-06, "entropy": 0.014605692587792873, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 375968, "num_agent_steps_trained": 375968}, "sampler_results": {"episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}}, "episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375968, "num_agent_steps_trained": 375968, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1151.7085493402628, "num_env_steps_trained_throughput_per_sec": 1151.7085493402628, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 375968, "timers": {"training_iteration_time_ms": 3588.712, "sample_time_ms": 614.415, "learn_time_ms": 2959.046, "learn_throughput": 1351.787, "synch_weights_time_ms": 12.799}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 375968, "num_agent_steps_trained": 375968}, "done": false, "episodes_total": 184, "training_iteration": 94, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-02", "timestamp": 1742310302, "time_this_iter_s": 3.4842965602874756, "time_total_s": 340.9799165725708, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 340.9799165725708, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004223337396979332, "policy_loss": 0.0007166453870013356, "vf_loss": 0.0035066911950707436, "vf_explained_var": -0.00021580061002168804, "kl": 1.5064678109411034e-06, "entropy": 0.014271901920437813, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03201235830783844, "policy_loss": -0.005668528378009796, "vf_loss": 0.037680886685848236, "vf_explained_var": -3.0813898774795234e-05, "kl": 3.950876271119341e-05, "entropy": 0.014679152518510818, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07354654371738434, "policy_loss": 0.001965190749615431, "vf_loss": 0.07158134877681732, "vf_explained_var": 0.0002948692999780178, "kl": 3.392232611076906e-05, "entropy": 0.016728661954402924, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0015407956670969725, "policy_loss": -0.0021168210078030825, "vf_loss": 0.0005760227795690298, "vf_explained_var": -0.0007641431875526905, "kl": 1.9084970972471638e-06, "entropy": 0.013216043822467327, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04421531409025192, "policy_loss": -0.00485163414850831, "vf_loss": 0.04906695336103439, "vf_explained_var": 0.0003198967024218291, "kl": 6.368380127241835e-05, "entropy": 0.013096695765852928, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 379968, "num_agent_steps_trained": 379968}, "sampler_results": {"episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}}, "episode_reward_max": 1989.0000001125352, "episode_reward_min": 1989.0000001125352, "episode_reward_mean": 1989.0000001125352, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 397.0000001125352, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.0000001125352], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [397.0000001125352], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268384595505142, "mean_inference_ms": 0.44363084190506147, "mean_action_processing_ms": 0.09319161915788962, "mean_env_wait_ms": 0.08895795699453948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015816688537597656, "StateBufferConnector_ms": 0.0036478042602539062, "ViewRequirementAgentConnector_ms": 0.10548591613769531}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 379968, "num_agent_steps_trained": 379968, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1148.789188907894, "num_env_steps_trained_throughput_per_sec": 1148.789188907894, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 379968, "timers": {"training_iteration_time_ms": 3594.781, "sample_time_ms": 616.429, "learn_time_ms": 2963.284, "learn_throughput": 1349.854, "synch_weights_time_ms": 12.656}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 379968, "num_agent_steps_trained": 379968}, "done": false, "episodes_total": 184, "training_iteration": 95, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-05", "timestamp": 1742310305, "time_this_iter_s": 3.494147777557373, "time_total_s": 344.4740643501282, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829acb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 344.4740643501282, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 4.999999873689376e-05, "total_loss": 7.684133529663086, "policy_loss": -0.0022884688805788755, "vf_loss": 7.686422348022461, "vf_explained_var": -1.4231318345991895e-06, "kl": 2.0359497284516692e-05, "entropy": 0.013779261149466038, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 7.711242198944092, "policy_loss": 0.0036148906219750643, "vf_loss": 7.707627296447754, "vf_explained_var": 3.510997430566931e-07, "kl": 1.1302588063699659e-05, "entropy": 0.013879910111427307, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 7.71559476852417, "policy_loss": 0.0023808495607227087, "vf_loss": 7.713213920593262, "vf_explained_var": 2.190328814322129e-06, "kl": 1.338535912509542e-05, "entropy": 0.01646803691983223, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 7.686694145202637, "policy_loss": -0.003043490694835782, "vf_loss": 7.689738750457764, "vf_explained_var": 2.1627971591442474e-07, "kl": 1.0190509556196048e-06, "entropy": 0.013271446339786053, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 7.606560230255127, "policy_loss": 0.0016170733142644167, "vf_loss": 7.60494327545166, "vf_explained_var": -1.7370496152580017e-07, "kl": 1.1116738960481598e-06, "entropy": 0.012865584343671799, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 383968, "num_agent_steps_trained": 383968}, "sampler_results": {"episode_reward_max": 1987.135335628793, "episode_reward_min": 1983.5200815659691, "episode_reward_mean": 1985.618193407735, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0000061856118, "agent_1": 394.50569348485595, "agent_2": 397.00247875228524, "agent_3": 394.3755295851944, "agent_4": 396.00000226108773}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.02484306743486, "agent_1": 397.06485761193494, "agent_2": 397.76722675422207, "agent_3": 396.7434699722664, "agent_4": 397.0177960018767}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1983.5200815659691, 1984.5056957459437, 1986.0574377273765, 1984.3930626320798, 1986.0565871155068, 1987.135335628793, 1986.4061292542756, 1986.8712175919354], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0067379469983, 398.0, 397.0067379469983, 396.0000061856118, 396.0498037685775, 398.0, 396.135458691293, 398.0], "policy_agent_1_reward": [398.0, 394.50569348485595, 398.0, 396.3746173973195, 398.0, 397.1353352814913, 397.1353352814913, 397.3678794503212], "policy_agent_2_reward": [397.00247875228524, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 397.1353352814913], "policy_agent_3_reward": [394.3755295851944, 398.0, 395.0506997803782, 397.01831563934684, 398.0, 397.0000000413994, 397.1353352814913, 397.3678794503212], "policy_agent_4_reward": [397.1353352814913, 396.00000226108773, 398.0, 397.00012340980174, 396.0067833469293, 397.0000003059023, 398.0, 397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320198935609677, "mean_inference_ms": 0.45565973569724927, "mean_action_processing_ms": 0.09739546226373835, "mean_env_wait_ms": 0.09147972889844161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155771255493164, "StateBufferConnector_ms": 0.0030565261840820312, "ViewRequirementAgentConnector_ms": 0.08272051811218262}}, "episode_reward_max": 1987.135335628793, "episode_reward_min": 1983.5200815659691, "episode_reward_mean": 1985.618193407735, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0000061856118, "agent_1": 394.50569348485595, "agent_2": 397.00247875228524, "agent_3": 394.3755295851944, "agent_4": 396.00000226108773}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.02484306743486, "agent_1": 397.06485761193494, "agent_2": 397.76722675422207, "agent_3": 396.7434699722664, "agent_4": 397.0177960018767}, "hist_stats": {"episode_reward": [1983.5200815659691, 1984.5056957459437, 1986.0574377273765, 1984.3930626320798, 1986.0565871155068, 1987.135335628793, 1986.4061292542756, 1986.8712175919354], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.0067379469983, 398.0, 397.0067379469983, 396.0000061856118, 396.0498037685775, 398.0, 396.135458691293, 398.0], "policy_agent_1_reward": [398.0, 394.50569348485595, 398.0, 396.3746173973195, 398.0, 397.1353352814913, 397.1353352814913, 397.3678794503212], "policy_agent_2_reward": [397.00247875228524, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 397.1353352814913], "policy_agent_3_reward": [394.3755295851944, 398.0, 395.0506997803782, 397.01831563934684, 398.0, 397.0000000413994, 397.1353352814913, 397.3678794503212], "policy_agent_4_reward": [397.1353352814913, 396.00000226108773, 398.0, 397.00012340980174, 396.0067833469293, 397.0000003059023, 398.0, 397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320198935609677, "mean_inference_ms": 0.45565973569724927, "mean_action_processing_ms": 0.09739546226373835, "mean_env_wait_ms": 0.09147972889844161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155771255493164, "StateBufferConnector_ms": 0.0030565261840820312, "ViewRequirementAgentConnector_ms": 0.08272051811218262}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 383968, "num_agent_steps_trained": 383968, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1004.7859825026832, "num_env_steps_trained_throughput_per_sec": 1004.7859825026832, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 383968, "timers": {"training_iteration_time_ms": 3646.022, "sample_time_ms": 668.794, "learn_time_ms": 2962.33, "learn_throughput": 1350.288, "synch_weights_time_ms": 12.563}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 383968, "num_agent_steps_trained": 383968}, "done": false, "episodes_total": 192, "training_iteration": 96, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-09", "timestamp": 1742310309, "time_this_iter_s": 3.9942474365234375, "time_total_s": 348.4683117866516, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcffd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 348.4683117866516, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 9.75, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0002680439210962504, "policy_loss": -0.0008610850782133639, "vf_loss": 0.0011291276896372437, "vf_explained_var": 0.0009908332722261548, "kl": 4.3915198943977884e-07, "entropy": 0.013625501655042171, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": -0.007716531399637461, "policy_loss": -0.008806472644209862, "vf_loss": 0.0010899421758949757, "vf_explained_var": 0.0007121778908185661, "kl": 8.424819952779217e-07, "entropy": 0.013837318867444992, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004612922668457031, "policy_loss": -0.005855891853570938, "vf_loss": 0.01046881452202797, "vf_explained_var": -0.0012720497325062752, "kl": 1.007694208965404e-05, "entropy": 0.01633569598197937, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0015437129186466336, "policy_loss": 0.0013625267893075943, "vf_loss": 0.00018118500884156674, "vf_explained_var": 0.001266766106709838, "kl": 9.298577765548544e-07, "entropy": 0.012947948649525642, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028539065271615982, "policy_loss": -0.005759519524872303, "vf_loss": 0.03429858386516571, "vf_explained_var": -0.0001488520938437432, "kl": 6.197334187163506e-06, "entropy": 0.012372124008834362, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 387968, "num_agent_steps_trained": 387968}, "sampler_results": {"episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}}, "episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 387968, "num_agent_steps_trained": 387968, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1151.799240070811, "num_env_steps_trained_throughput_per_sec": 1151.799240070811, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 387968, "timers": {"training_iteration_time_ms": 3627.0, "sample_time_ms": 667.174, "learn_time_ms": 2944.661, "learn_throughput": 1358.391, "synch_weights_time_ms": 12.792}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 387968, "num_agent_steps_trained": 387968}, "done": false, "episodes_total": 192, "training_iteration": 97, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-13", "timestamp": 1742310313, "time_this_iter_s": 3.48730206489563, "time_total_s": 351.95561385154724, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 351.95561385154724, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 10.26, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00032617588294669986, "policy_loss": -0.00014425927656702697, "vf_loss": 0.0004704351886175573, "vf_explained_var": -0.002904267283156514, "kl": 8.339692385561648e-07, "entropy": 0.013654905371367931, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1808629035949707, "policy_loss": -0.005596933886408806, "vf_loss": 0.18645983934402466, "vf_explained_var": -1.664984847593587e-05, "kl": 4.079037535120733e-05, "entropy": 0.012278472073376179, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0009432696388103068, "policy_loss": -0.0015285235131159425, "vf_loss": 0.0005852544563822448, "vf_explained_var": -0.0019317226251587272, "kl": 3.814368028542958e-06, "entropy": 0.016597023233771324, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07141003012657166, "policy_loss": -0.0043395934626460075, "vf_loss": 0.07574963569641113, "vf_explained_var": 0.00010281971481163055, "kl": 0.0001906340621644631, "entropy": 0.011312989518046379, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.01467014942318201, "policy_loss": -0.0001806531654438004, "vf_loss": 0.014850799925625324, "vf_explained_var": 0.00014635977277066559, "kl": 1.744580367812887e-05, "entropy": 0.012090083211660385, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 391968, "num_agent_steps_trained": 391968}, "sampler_results": {"episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}}, "episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 391968, "num_agent_steps_trained": 391968, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1163.3058790116445, "num_env_steps_trained_throughput_per_sec": 1163.3058790116445, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 391968, "timers": {"training_iteration_time_ms": 3573.15, "sample_time_ms": 611.036, "learn_time_ms": 2946.862, "learn_throughput": 1357.376, "synch_weights_time_ms": 12.867}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 391968, "num_agent_steps_trained": 391968}, "done": false, "episodes_total": 192, "training_iteration": 98, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-16", "timestamp": 1742310316, "time_this_iter_s": 3.4494526386260986, "time_total_s": 355.40506649017334, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 355.40506649017334, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 10.080000000000002, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04361793026328087, "policy_loss": -0.0017876069759950042, "vf_loss": 0.04540553316473961, "vf_explained_var": 7.18193405191414e-05, "kl": 2.035128272837028e-05, "entropy": 0.013058042153716087, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.011116256937384605, "policy_loss": 0.0006204639212228358, "vf_loss": 0.010495792143046856, "vf_explained_var": 0.00030611015972681344, "kl": 1.5024461390567012e-05, "entropy": 0.011897102929651737, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": -0.001841480378061533, "policy_loss": -0.0020681151654571295, "vf_loss": 0.00022663362324237823, "vf_explained_var": -0.004231627564877272, "kl": 7.344083314819727e-07, "entropy": 0.016326095908880234, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0019139868672937155, "policy_loss": 0.0015327666187658906, "vf_loss": 0.00038121987017802894, "vf_explained_var": -0.00012608936231117696, "kl": 6.3608791833758e-07, "entropy": 0.011180490255355835, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.031171252951025963, "policy_loss": -0.006309764925390482, "vf_loss": 0.03748101741075516, "vf_explained_var": -0.00016943216905929148, "kl": 6.658055099251214e-06, "entropy": 0.01154053583741188, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 395968, "num_agent_steps_trained": 395968}, "sampler_results": {"episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}}, "episode_reward_max": 1986.8712175919354, "episode_reward_min": 1986.8712175919354, "episode_reward_mean": 1986.8712175919354, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 397.1353352814913, "agent_3": 397.3678794503212, "agent_4": 397.00012340980174}, "hist_stats": {"episode_reward": [1986.8712175919354], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [397.1353352814913], "policy_agent_3_reward": [397.3678794503212], "policy_agent_4_reward": [397.00012340980174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5266087961327034, "mean_inference_ms": 0.4434114754074566, "mean_action_processing_ms": 0.09306085444731488, "mean_env_wait_ms": 0.08842677926622837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010814666748046875, "StateBufferConnector_ms": 0.0024843215942382812, "ViewRequirementAgentConnector_ms": 0.07219791412353516}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395968, "num_agent_steps_trained": 395968, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1154.3284281829747, "num_env_steps_trained_throughput_per_sec": 1154.3284281829747, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 395968, "timers": {"training_iteration_time_ms": 3569.488, "sample_time_ms": 610.932, "learn_time_ms": 2943.363, "learn_throughput": 1358.99, "synch_weights_time_ms": 12.782}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 395968, "num_agent_steps_trained": 395968}, "done": false, "episodes_total": 192, "training_iteration": 99, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-20", "timestamp": 1742310320, "time_this_iter_s": 3.476888418197632, "time_total_s": 358.881954908371, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87edcfda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 358.881954908371, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 10.26, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 7.57274055480957, "policy_loss": -0.00539880245923996, "vf_loss": 7.578138828277588, "vf_explained_var": 1.4049666106075165e-06, "kl": 1.272711051569786e-05, "entropy": 0.012789436616003513, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 7.596799373626709, "policy_loss": -0.0003286570427007973, "vf_loss": 7.597127914428711, "vf_explained_var": 2.5147483029286377e-07, "kl": 1.930527560034534e-06, "entropy": 0.011759699322283268, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 7.609797954559326, "policy_loss": 0.0004207662132102996, "vf_loss": 7.609376907348633, "vf_explained_var": 1.9226754375267774e-06, "kl": 1.9022173773919349e-06, "entropy": 0.01658899523317814, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 7.608482837677002, "policy_loss": 0.001335622277110815, "vf_loss": 7.607146739959717, "vf_explained_var": 6.516774533338321e-07, "kl": 3.0089302072155988e-06, "entropy": 0.011287523433566093, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 7.465684413909912, "policy_loss": -0.007546381093561649, "vf_loss": 7.473230361938477, "vf_explained_var": 3.366243390701129e-07, "kl": 5.678195975633571e-07, "entropy": 0.011428575962781906, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 399968, "num_agent_steps_trained": 399968}, "sampler_results": {"episode_reward_max": 1990.0, "episode_reward_min": 1987.0211298542563, "episode_reward_mean": 1987.999402141068, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000000000019, "agent_1": 397.00247875228524, "agent_2": 396.37035820260644, "agent_3": 395.5215303711593, "agent_4": 397.0003354626242}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.6427591535614, "agent_1": 397.7962947753258, "agent_2": 397.5923936918625, "agent_3": 397.0929125874902, "agent_4": 397.875041932828}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.5215303711593, 1987.0211298542563, 1990.0, 1987.0506989488513, 1988.0250535863452, 1988.1353519831919, 1987.8710941821337, 1988.3703582026064], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 397.0000000000019, 397.0067379469983, 398.0, 397.1353352814913, 398.0], "policy_agent_1_reward": [398.0, 397.00247875228524, 398.0, 398.0, 398.0, 398.0, 397.3678794503212, 398.0], "policy_agent_2_reward": [398.0, 398.0, 398.0, 397.00091188197257, 398.0, 398.0, 397.3678794503212, 396.37035820260644], "policy_agent_3_reward": [395.5215303711593, 397.01831563934684, 398.0, 397.0497870668769, 397.01831563934684, 396.13535198319187, 398.0, 398.0], "policy_agent_4_reward": [398.0, 397.0003354626242, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320433626098444, "mean_inference_ms": 0.45570128929738757, "mean_action_processing_ms": 0.09740280431760902, "mean_env_wait_ms": 0.09101131925992767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013055801391601562, "StateBufferConnector_ms": 0.003343820571899414, "ViewRequirementAgentConnector_ms": 0.08969724178314209}}, "episode_reward_max": 1990.0, "episode_reward_min": 1987.0211298542563, "episode_reward_mean": 1987.999402141068, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000000000019, "agent_1": 397.00247875228524, "agent_2": 396.37035820260644, "agent_3": 395.5215303711593, "agent_4": 397.0003354626242}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.6427591535614, "agent_1": 397.7962947753258, "agent_2": 397.5923936918625, "agent_3": 397.0929125874902, "agent_4": 397.875041932828}, "hist_stats": {"episode_reward": [1987.5215303711593, 1987.0211298542563, 1990.0, 1987.0506989488513, 1988.0250535863452, 1988.1353519831919, 1987.8710941821337, 1988.3703582026064], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 397.0000000000019, 397.0067379469983, 398.0, 397.1353352814913, 398.0], "policy_agent_1_reward": [398.0, 397.00247875228524, 398.0, 398.0, 398.0, 398.0, 397.3678794503212, 398.0], "policy_agent_2_reward": [398.0, 398.0, 398.0, 397.00091188197257, 398.0, 398.0, 397.3678794503212, 396.37035820260644], "policy_agent_3_reward": [395.5215303711593, 397.01831563934684, 398.0, 397.0497870668769, 397.01831563934684, 396.13535198319187, 398.0, 398.0], "policy_agent_4_reward": [398.0, 397.0003354626242, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320433626098444, "mean_inference_ms": 0.45570128929738757, "mean_action_processing_ms": 0.09740280431760902, "mean_env_wait_ms": 0.09101131925992767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013055801391601562, "StateBufferConnector_ms": 0.003343820571899414, "ViewRequirementAgentConnector_ms": 0.08969724178314209}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 399968, "num_agent_steps_trained": 399968, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 989.1353339861452, "num_env_steps_trained_throughput_per_sec": 989.1353339861452, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 399968, "timers": {"training_iteration_time_ms": 3629.108, "sample_time_ms": 667.864, "learn_time_ms": 2946.069, "learn_throughput": 1357.741, "synch_weights_time_ms": 12.728}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 399968, "num_agent_steps_trained": 399968}, "done": false, "episodes_total": 200, "training_iteration": 100, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-24", "timestamp": 1742310324, "time_this_iter_s": 4.056237459182739, "time_total_s": 362.9381923675537, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f87ede30160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 362.9381923675537, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 9.866666666666667, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0888073667883873, "policy_loss": 1.6560370568186045e-05, "vf_loss": 0.08879080414772034, "vf_explained_var": 0.00016255491937045008, "kl": 3.1113711884245276e-05, "entropy": 0.012409305199980736, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": -0.003034676192328334, "policy_loss": -0.0038752674590796232, "vf_loss": 0.0008405899861827493, "vf_explained_var": -0.0001092930615413934, "kl": 3.287901108706137e-06, "entropy": 0.011810636147856712, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0022317066323012114, "policy_loss": 0.0021637140307575464, "vf_loss": 6.799169204896316e-05, "vf_explained_var": -0.011714966967701912, "kl": 4.45954128736048e-06, "entropy": 0.01614432968199253, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0011167358607053757, "policy_loss": -0.0012327906442806125, "vf_loss": 0.00011605379404500127, "vf_explained_var": -0.001170194474980235, "kl": 9.448834248360072e-07, "entropy": 0.011116694658994675, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16060511767864227, "policy_loss": 0.0015625999076291919, "vf_loss": 0.15904250741004944, "vf_explained_var": 0.00010832236148416996, "kl": 2.551866418798454e-05, "entropy": 0.010570177808403969, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 403968, "num_agent_steps_trained": 403968}, "sampler_results": {"episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}}, "episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 403968, "num_agent_steps_trained": 403968, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1134.3589919730446, "num_env_steps_trained_throughput_per_sec": 1134.3589919730446, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 403968, "timers": {"training_iteration_time_ms": 3636.784, "sample_time_ms": 672.509, "learn_time_ms": 2948.833, "learn_throughput": 1356.469, "synch_weights_time_ms": 12.966}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 403968, "num_agent_steps_trained": 403968}, "done": false, "episodes_total": 200, "training_iteration": 101, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-28", "timestamp": 1742310328, "time_this_iter_s": 3.5366272926330566, "time_total_s": 366.47481966018677, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 366.47481966018677, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 10.16, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0036681415513157845, "policy_loss": 0.00098329724278301, "vf_loss": 0.0026848434936255217, "vf_explained_var": 0.0010231148917227983, "kl": 8.691900461599289e-07, "entropy": 0.012053428217768669, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.018975447863340378, "policy_loss": -0.007774739060550928, "vf_loss": 0.026750188320875168, "vf_explained_var": -1.5511966921621934e-05, "kl": 2.040111030510161e-05, "entropy": 0.01027652621269226, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08322396129369736, "policy_loss": -0.004740132950246334, "vf_loss": 0.08796410262584686, "vf_explained_var": -0.0009142790804617107, "kl": 5.636700370814651e-05, "entropy": 0.01591815985739231, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07073560357093811, "policy_loss": -0.0014087214367464185, "vf_loss": 0.07214432954788208, "vf_explained_var": 0.0001525702973594889, "kl": 4.004749280284159e-05, "entropy": 0.010093139484524727, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": -0.003603834193199873, "policy_loss": -0.004696188028901815, "vf_loss": 0.001092350808903575, "vf_explained_var": -0.00024216572637669742, "kl": 5.322765446180711e-07, "entropy": 0.01040553580969572, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 407968, "num_agent_steps_trained": 407968}, "sampler_results": {"episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}}, "episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407968, "num_agent_steps_trained": 407968, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1148.467318663507, "num_env_steps_trained_throughput_per_sec": 1148.467318663507, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 407968, "timers": {"training_iteration_time_ms": 3580.639, "sample_time_ms": 617.652, "learn_time_ms": 2947.646, "learn_throughput": 1357.015, "synch_weights_time_ms": 12.836}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 407968, "num_agent_steps_trained": 407968}, "done": false, "episodes_total": 200, "training_iteration": 102, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-31", "timestamp": 1742310331, "time_this_iter_s": 3.494293451309204, "time_total_s": 369.969113111496, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879829ac20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 369.969113111496, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 10.280000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0024381147231906652, "policy_loss": 0.0013615521602332592, "vf_loss": 0.0010765607003122568, "vf_explained_var": -0.0018469583010300994, "kl": 3.6381570112098416e-07, "entropy": 0.01217434648424387, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0038604321889579296, "policy_loss": -0.0041995299980044365, "vf_loss": 0.0003390971396584064, "vf_explained_var": -0.0016597537323832512, "kl": 5.126767632646079e-07, "entropy": 0.01017360482364893, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004596383776515722, "policy_loss": 0.004488227888941765, "vf_loss": 0.00010815541463671252, "vf_explained_var": -0.006222988478839397, "kl": 8.264525604317896e-06, "entropy": 0.016459772363305092, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": -0.00403097877278924, "policy_loss": -0.0047779991291463375, "vf_loss": 0.0007470194832421839, "vf_explained_var": -0.001711268094368279, "kl": 4.3231094082329946e-07, "entropy": 0.009969697333872318, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0006305297138169408, "policy_loss": 0.00018491517403163016, "vf_loss": 0.00044561424874700606, "vf_explained_var": -0.004371501039713621, "kl": 5.901488293602597e-07, "entropy": 0.010303620249032974, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 411968, "num_agent_steps_trained": 411968}, "sampler_results": {"episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}}, "episode_reward_max": 1988.3703582026064, "episode_reward_min": 1988.3703582026064, "episode_reward_mean": 1988.3703582026064, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 396.37035820260644, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1988.3703582026064], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [396.37035820260644], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267369876143737, "mean_inference_ms": 0.4441842935373348, "mean_action_processing_ms": 0.09313810992456908, "mean_env_wait_ms": 0.08804765558894144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010933876037597656, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.07258415222167969}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 411968, "num_agent_steps_trained": 411968, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1135.7210856018862, "num_env_steps_trained_throughput_per_sec": 1135.7210856018862, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 411968, "timers": {"training_iteration_time_ms": 3588.705, "sample_time_ms": 621.713, "learn_time_ms": 2951.847, "learn_throughput": 1355.084, "synch_weights_time_ms": 12.66}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 411968, "num_agent_steps_trained": 411968}, "done": false, "episodes_total": 200, "training_iteration": 103, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-35", "timestamp": 1742310335, "time_this_iter_s": 3.5340728759765625, "time_total_s": 373.50318598747253, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 373.50318598747253, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 10.120000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 7.521493911743164, "policy_loss": 0.00362213933840394, "vf_loss": 7.517870903015137, "vf_explained_var": 2.7063347260991577e-06, "kl": 4.339683812304429e-07, "entropy": 0.01227459218353033, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 7.546643257141113, "policy_loss": 0.009807840920984745, "vf_loss": 7.536833763122559, "vf_explained_var": -2.6651790108189743e-07, "kl": 7.130092853913084e-07, "entropy": 0.009990780614316463, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 7.53524112701416, "policy_loss": -0.0004868085088673979, "vf_loss": 7.535727500915527, "vf_explained_var": -4.15529513020374e-07, "kl": 2.4883573132683523e-05, "entropy": 0.016139768064022064, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 7.483788013458252, "policy_loss": -0.0017128833569586277, "vf_loss": 7.485500335693359, "vf_explained_var": -8.628482106587398e-08, "kl": 2.2381516373570776e-06, "entropy": 0.010042651556432247, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 7.409842491149902, "policy_loss": 0.00470184488222003, "vf_loss": 7.4051408767700195, "vf_explained_var": -1.2982459338672925e-06, "kl": 1.8859818737837486e-06, "entropy": 0.010643530637025833, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 415968, "num_agent_steps_trained": 415968}, "sampler_results": {"episode_reward_max": 1990.0, "episode_reward_min": 1986.1854578130535, "episode_reward_mean": 1988.447401677019, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0001234098156, "agent_1": 397.00247875228524, "agent_2": 396.1353352835524, "agent_3": 397.0000008315287, "agent_4": 396.0501225295011}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.7500154262269, "agent_1": 397.67160461936146, "agent_2": 397.6422267544797, "agent_3": 397.75228955885945, "agent_4": 397.6312653180914}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.0001234098156, 1990.0, 1988.0049575045705, 1987.002479599044, 1986.1854578130535, 1989.0183156393468, 1990.0, 1989.3678794503212], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [396.0001234098156, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_1_reward": [398.0, 398.0, 397.00247875228524, 397.00247875228524, 398.0, 398.0, 398.0, 397.3678794503212], "policy_agent_2_reward": [398.0, 398.0, 397.00247875228524, 398.0, 396.1353352835524, 398.0, 398.0, 398.0], "policy_agent_3_reward": [398.0, 398.0, 398.0, 397.0000008315287, 398.0, 397.01831563934684, 398.0, 398.0], "policy_agent_4_reward": [398.0, 398.0, 398.0, 397.00000001523, 396.0501225295011, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320301766748696, "mean_inference_ms": 0.4555740238797176, "mean_action_processing_ms": 0.09741310509270731, "mean_env_wait_ms": 0.09057398704457212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011031627655029297, "StateBufferConnector_ms": 0.0028330087661743164, "ViewRequirementAgentConnector_ms": 0.07509350776672363}}, "episode_reward_max": 1990.0, "episode_reward_min": 1986.1854578130535, "episode_reward_mean": 1988.447401677019, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0001234098156, "agent_1": 397.00247875228524, "agent_2": 396.1353352835524, "agent_3": 397.0000008315287, "agent_4": 396.0501225295011}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.7500154262269, "agent_1": 397.67160461936146, "agent_2": 397.6422267544797, "agent_3": 397.75228955885945, "agent_4": 397.6312653180914}, "hist_stats": {"episode_reward": [1988.0001234098156, 1990.0, 1988.0049575045705, 1987.002479599044, 1986.1854578130535, 1989.0183156393468, 1990.0, 1989.3678794503212], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [396.0001234098156, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_1_reward": [398.0, 398.0, 397.00247875228524, 397.00247875228524, 398.0, 398.0, 398.0, 397.3678794503212], "policy_agent_2_reward": [398.0, 398.0, 397.00247875228524, 398.0, 396.1353352835524, 398.0, 398.0, 398.0], "policy_agent_3_reward": [398.0, 398.0, 398.0, 397.0000008315287, 398.0, 397.01831563934684, 398.0, 398.0], "policy_agent_4_reward": [398.0, 398.0, 398.0, 397.00000001523, 396.0501225295011, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320301766748696, "mean_inference_ms": 0.4555740238797176, "mean_action_processing_ms": 0.09741310509270731, "mean_env_wait_ms": 0.09057398704457212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011031627655029297, "StateBufferConnector_ms": 0.0028330087661743164, "ViewRequirementAgentConnector_ms": 0.07509350776672363}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 415968, "num_agent_steps_trained": 415968, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1010.0942499663597, "num_env_steps_trained_throughput_per_sec": 1010.0942499663597, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 415968, "timers": {"training_iteration_time_ms": 3637.4, "sample_time_ms": 673.226, "learn_time_ms": 2948.983, "learn_throughput": 1356.4, "synch_weights_time_ms": 12.721}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 415968, "num_agent_steps_trained": 415968}, "done": false, "episodes_total": 208, "training_iteration": 104, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-39", "timestamp": 1742310339, "time_this_iter_s": 3.9733879566192627, "time_total_s": 377.4765739440918, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 377.4765739440918, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 9.85, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0018745476845651865, "policy_loss": 0.0015443006996065378, "vf_loss": 0.00033024747972376645, "vf_explained_var": -0.004185657016932964, "kl": 4.013864781882148e-06, "entropy": 0.012413346208631992, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1356581300497055, "policy_loss": -0.0039075640961527824, "vf_loss": 0.13956570625305176, "vf_explained_var": 5.9733789385063574e-05, "kl": 2.1720246877521276e-05, "entropy": 0.009603225626051426, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.020792970433831215, "policy_loss": 0.0007090151193551719, "vf_loss": 0.02008395455777645, "vf_explained_var": 6.835517524450552e-06, "kl": 2.3340084226219915e-05, "entropy": 0.01676851511001587, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.057725727558135986, "policy_loss": -0.0005438298103399575, "vf_loss": 0.05826955661177635, "vf_explained_var": -5.555152711167466e-06, "kl": 1.6612773833912797e-05, "entropy": 0.009920467622578144, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.00851443875581026, "policy_loss": -0.0013947106199339032, "vf_loss": 0.009909147396683693, "vf_explained_var": -0.0009312195470556617, "kl": 2.9661770895472728e-05, "entropy": 0.010738887824118137, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 419968, "num_agent_steps_trained": 419968}, "sampler_results": {"episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}}, "episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419968, "num_agent_steps_trained": 419968, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1147.3827979325354, "num_env_steps_trained_throughput_per_sec": 1147.3827979325354, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 419968, "timers": {"training_iteration_time_ms": 3637.825, "sample_time_ms": 675.444, "learn_time_ms": 2947.122, "learn_throughput": 1357.256, "synch_weights_time_ms": 12.799}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 419968, "num_agent_steps_trained": 419968}, "done": false, "episodes_total": 208, "training_iteration": 105, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-43", "timestamp": 1742310343, "time_this_iter_s": 3.502671480178833, "time_total_s": 380.97924542427063, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878deff760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 380.97924542427063, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 10.120000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 4.999999873689376e-05, "total_loss": -0.003518132958561182, "policy_loss": -0.003656270680949092, "vf_loss": 0.00013813591795042157, "vf_explained_var": -0.00708361342549324, "kl": 3.1638680866308277e-06, "entropy": 0.012282012961804867, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04266917705535889, "policy_loss": 0.0013320357538759708, "vf_loss": 0.04133714362978935, "vf_explained_var": 0.00017347675748169422, "kl": 2.064012187474873e-05, "entropy": 0.008977172896265984, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0019962915685027838, "policy_loss": -0.0026431260630488396, "vf_loss": 0.0006468351930379868, "vf_explained_var": -0.00023727303778287023, "kl": 2.8698323149001226e-06, "entropy": 0.015876462683081627, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.002737694652751088, "policy_loss": 0.0017537071835249662, "vf_loss": 0.0009839870035648346, "vf_explained_var": -0.0006125140935182571, "kl": 1.0615718792905682e-06, "entropy": 0.009612485766410828, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04689227417111397, "policy_loss": 0.00018685303803067654, "vf_loss": 0.04670542851090431, "vf_explained_var": -1.3612281691166572e-05, "kl": 8.979252925200853e-06, "entropy": 0.010411590337753296, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 423968, "num_agent_steps_trained": 423968}, "sampler_results": {"episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}}, "episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 423968, "num_agent_steps_trained": 423968, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1172.5228807447693, "num_env_steps_trained_throughput_per_sec": 1172.5228807447693, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 423968, "timers": {"training_iteration_time_ms": 3580.875, "sample_time_ms": 620.129, "learn_time_ms": 2945.442, "learn_throughput": 1358.03, "synch_weights_time_ms": 12.853}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 423968, "num_agent_steps_trained": 423968}, "done": false, "episodes_total": 208, "training_iteration": 106, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-46", "timestamp": 1742310346, "time_this_iter_s": 3.4220707416534424, "time_total_s": 384.4013161659241, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 384.4013161659241, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 10.260000000000002, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04989008232951164, "policy_loss": -0.007046934682875872, "vf_loss": 0.05693701654672623, "vf_explained_var": -0.00022593396715819836, "kl": 2.298865729244426e-05, "entropy": 0.011389616876840591, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0018140600295737386, "policy_loss": 0.000820100016426295, "vf_loss": 0.0009939572773873806, "vf_explained_var": -0.0003324591089040041, "kl": 1.0557607055261542e-07, "entropy": 0.008958588354289532, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.006950582843273878, "policy_loss": -0.003563745180144906, "vf_loss": 0.010514325462281704, "vf_explained_var": -0.00015264835383277386, "kl": 2.012584991462063e-05, "entropy": 0.016200603917241096, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03862181678414345, "policy_loss": -0.003885401412844658, "vf_loss": 0.04250721633434296, "vf_explained_var": -0.0002936448436230421, "kl": 1.0619035492709372e-05, "entropy": 0.009687349200248718, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0027281229849904776, "policy_loss": -0.003305200720205903, "vf_loss": 0.0005770769203081727, "vf_explained_var": 0.0011979242553934455, "kl": 1.509939579591446e-06, "entropy": 0.010689635761082172, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 427968, "num_agent_steps_trained": 427968}, "sampler_results": {"episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}}, "episode_reward_max": 1989.3678794503212, "episode_reward_min": 1989.3678794503212, "episode_reward_mean": 1989.3678794503212, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 397.3678794503212, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1989.3678794503212], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5268395143055815, "mean_inference_ms": 0.44488610676812596, "mean_action_processing_ms": 0.09324103098085658, "mean_env_wait_ms": 0.08769334824011282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843276977539062, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.07259845733642578}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427968, "num_agent_steps_trained": 427968, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1145.5780349011352, "num_env_steps_trained_throughput_per_sec": 1145.5780349011352, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 427968, "timers": {"training_iteration_time_ms": 3582.761, "sample_time_ms": 623.565, "learn_time_ms": 2944.225, "learn_throughput": 1358.592, "synch_weights_time_ms": 12.557}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 427968, "num_agent_steps_trained": 427968}, "done": false, "episodes_total": 208, "training_iteration": 107, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-50", "timestamp": 1742310350, "time_this_iter_s": 3.5035903453826904, "time_total_s": 387.90490651130676, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878deff760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 387.90490651130676, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 10.2, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 7.443157196044922, "policy_loss": 0.006755952723324299, "vf_loss": 7.4364013671875, "vf_explained_var": -1.339685411494429e-07, "kl": 2.345015900573344e-06, "entropy": 0.011903251521289349, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 7.380410671234131, "policy_loss": -0.001299680327065289, "vf_loss": 7.381710529327393, "vf_explained_var": 1.5131064401430194e-06, "kl": 3.624973885507643e-07, "entropy": 0.009019630961120129, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.406734943389893, "policy_loss": 0.00047809042735025287, "vf_loss": 7.406257629394531, "vf_explained_var": -2.954687374767673e-07, "kl": 8.866802090778947e-06, "entropy": 0.014716981910169125, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 7.383425235748291, "policy_loss": -0.0016408439259976149, "vf_loss": 7.38506555557251, "vf_explained_var": -4.1808399942055985e-07, "kl": 1.4062293303140905e-05, "entropy": 0.010170118883252144, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 7.292879104614258, "policy_loss": 0.0004587946168612689, "vf_loss": 7.29241943359375, "vf_explained_var": -3.7380627304628433e-07, "kl": 6.480631782324053e-06, "entropy": 0.010479545220732689, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 431968, "num_agent_steps_trained": 431968}, "sampler_results": {"episode_reward_max": 1990.0, "episode_reward_min": 1984.0250764434638, "episode_reward_mean": 1987.975536720402, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 397.0000167017006, "agent_2": 397.0000001125352, "agent_3": 396.0183323410474, "agent_4": 396.1356707441155}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.71696986328067, "agent_1": 397.75084433108736, "agent_2": 397.56290262357004, "agent_3": 397.6272972176223, "agent_4": 397.31752268484166}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.5032147318125, 1988.0183610392778, 1990.0, 1989.0000001125352, 1988.1356707441155, 1988.3678961520218, 1984.0250764434638, 1987.7540745399892], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 397.00000000560283, 396.7357589006424], "policy_agent_1_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 397.0000167017006, 397.0067379469983, 398.0], "policy_agent_2_reward": [397.1353352814913, 398.0, 398.0, 397.0000001125352, 398.0, 397.3678794503212, 397.0000061442124, 398.0], "policy_agent_3_reward": [398.0, 397.00004539993097, 398.0, 398.0, 398.0, 398.0, 396.0183323410474, 398.0], "policy_agent_4_reward": [397.3678794503212, 397.01831563934684, 398.0, 398.0, 396.1356707441155, 398.0, 397.00000000560283, 397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321953166902261, "mean_inference_ms": 0.4558993796260641, "mean_action_processing_ms": 0.097529392251615, "mean_env_wait_ms": 0.09024737874692604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013487935066223145, "StateBufferConnector_ms": 0.00330507755279541, "ViewRequirementAgentConnector_ms": 0.0897359848022461}}, "episode_reward_max": 1990.0, "episode_reward_min": 1984.0250764434638, "episode_reward_mean": 1987.975536720402, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 397.0000167017006, "agent_2": 397.0000001125352, "agent_3": 396.0183323410474, "agent_4": 396.1356707441155}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.71696986328067, "agent_1": 397.75084433108736, "agent_2": 397.56290262357004, "agent_3": 397.6272972176223, "agent_4": 397.31752268484166}, "hist_stats": {"episode_reward": [1988.5032147318125, 1988.0183610392778, 1990.0, 1989.0000001125352, 1988.1356707441155, 1988.3678961520218, 1984.0250764434638, 1987.7540745399892], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 398.0, 397.00000000560283, 396.7357589006424], "policy_agent_1_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 397.0000167017006, 397.0067379469983, 398.0], "policy_agent_2_reward": [397.1353352814913, 398.0, 398.0, 397.0000001125352, 398.0, 397.3678794503212, 397.0000061442124, 398.0], "policy_agent_3_reward": [398.0, 397.00004539993097, 398.0, 398.0, 398.0, 398.0, 396.0183323410474, 398.0], "policy_agent_4_reward": [397.3678794503212, 397.01831563934684, 398.0, 398.0, 396.1356707441155, 398.0, 397.00000000560283, 397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321953166902261, "mean_inference_ms": 0.4558993796260641, "mean_action_processing_ms": 0.097529392251615, "mean_env_wait_ms": 0.09024737874692604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013487935066223145, "StateBufferConnector_ms": 0.00330507755279541, "ViewRequirementAgentConnector_ms": 0.0897359848022461}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 431968, "num_agent_steps_trained": 431968, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 986.6970229269278, "num_env_steps_trained_throughput_per_sec": 986.6970229269278, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 431968, "timers": {"training_iteration_time_ms": 3644.308, "sample_time_ms": 681.321, "learn_time_ms": 2948.191, "learn_throughput": 1356.764, "synch_weights_time_ms": 12.431}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 431968, "num_agent_steps_trained": 431968}, "done": false, "episodes_total": 216, "training_iteration": 108, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-54", "timestamp": 1742310354, "time_this_iter_s": 4.0680108070373535, "time_total_s": 391.9729173183441, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defdb40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 391.9729173183441, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 9.733333333333333, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 4.999999873689376e-05, "total_loss": 0.057249054312705994, "policy_loss": -0.006551417987793684, "vf_loss": 0.06380046904087067, "vf_explained_var": -2.948443125205813e-06, "kl": 5.829223300679587e-05, "entropy": 0.011423040181398392, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.026458732783794403, "policy_loss": 0.0004566606949083507, "vf_loss": 0.026002071797847748, "vf_explained_var": 0.00024382444098591805, "kl": 5.239749043539632e-06, "entropy": 0.008720963262021542, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10091569274663925, "policy_loss": -0.005263475701212883, "vf_loss": 0.10617916285991669, "vf_explained_var": -1.9326947949593887e-05, "kl": 0.00012530719686765224, "entropy": 0.012069997377693653, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0071448031812906265, "policy_loss": -0.007566298823803663, "vf_loss": 0.00042149421642534435, "vf_explained_var": -0.00017272091645281762, "kl": 5.508811682375381e-06, "entropy": 0.010246006771922112, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0012969200033694506, "policy_loss": 0.0011205959599465132, "vf_loss": 0.00017632391245570034, "vf_explained_var": -0.0090463412925601, "kl": 2.4286880488944007e-06, "entropy": 0.010656015947461128, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 435968, "num_agent_steps_trained": 435968}, "sampler_results": {"episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}}, "episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 435968, "num_agent_steps_trained": 435968, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1100.96558498207, "num_env_steps_trained_throughput_per_sec": 1100.96558498207, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 435968, "timers": {"training_iteration_time_ms": 3661.104, "sample_time_ms": 696.909, "learn_time_ms": 2949.4, "learn_throughput": 1356.208, "synch_weights_time_ms": 12.463}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 435968, "num_agent_steps_trained": 435968}, "done": false, "episodes_total": 216, "training_iteration": 109, "trial_id": "72c65_00000", "date": "2025-03-18_16-05-58", "timestamp": 1742310358, "time_this_iter_s": 3.643439292907715, "time_total_s": 395.61635661125183, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878deff760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 395.61635661125183, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 9.966666666666667, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0015922653255984187, "policy_loss": 0.0008256483124569058, "vf_loss": 0.0007666175370104611, "vf_explained_var": 0.0005908909370191395, "kl": 3.6812368762184633e-06, "entropy": 0.011032740585505962, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0036028441973030567, "policy_loss": 0.0031924459617584944, "vf_loss": 0.0004103979154024273, "vf_explained_var": -0.3125988245010376, "kl": 2.4726954507059418e-05, "entropy": 0.00952170044183731, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03223082795739174, "policy_loss": -0.003903357544913888, "vf_loss": 0.036134183406829834, "vf_explained_var": 0.00015835989324841648, "kl": 1.4671002645627595e-05, "entropy": 0.011686204001307487, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0022826851345598698, "policy_loss": 0.00212256726808846, "vf_loss": 0.00016011756088119, "vf_explained_var": -0.001517915166914463, "kl": 7.614289643242955e-05, "entropy": 0.011196090839803219, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04095493629574776, "policy_loss": -0.003579414915293455, "vf_loss": 0.0445343479514122, "vf_explained_var": -4.600286411005072e-05, "kl": 2.0945235519320704e-05, "entropy": 0.01044749841094017, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 439968, "num_agent_steps_trained": 439968}, "sampler_results": {"episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}}, "episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 439968, "num_agent_steps_trained": 439968, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1147.548312413663, "num_env_steps_trained_throughput_per_sec": 1147.548312413663, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 439968, "timers": {"training_iteration_time_ms": 3605.28, "sample_time_ms": 640.485, "learn_time_ms": 2949.686, "learn_throughput": 1356.077, "synch_weights_time_ms": 12.768}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 439968, "num_agent_steps_trained": 439968}, "done": false, "episodes_total": 216, "training_iteration": 110, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-01", "timestamp": 1742310361, "time_this_iter_s": 3.4967236518859863, "time_total_s": 399.1130802631378, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 399.1130802631378, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 10.180000000000001, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03442452847957611, "policy_loss": 0.0005618660361506045, "vf_loss": 0.03386266529560089, "vf_explained_var": -0.00012193776638014242, "kl": 5.413151484390255e-06, "entropy": 0.010538540780544281, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0017574942903593183, "policy_loss": 0.001621261122636497, "vf_loss": 0.00013623276026919484, "vf_explained_var": -0.18984277546405792, "kl": 3.057640424231067e-05, "entropy": 0.011002316139638424, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0004292091471143067, "policy_loss": -0.0012634065933525562, "vf_loss": 0.0008341962238773704, "vf_explained_var": -0.0010853208368644118, "kl": 8.20985314931022e-06, "entropy": 0.011536148376762867, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": -0.002105560153722763, "policy_loss": -0.002169582759961486, "vf_loss": 6.402202416211367e-05, "vf_explained_var": -0.0016351415542885661, "kl": 7.301486766664311e-05, "entropy": 0.01681044138967991, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.041562117636203766, "policy_loss": -0.0028763532172888517, "vf_loss": 0.04443846642971039, "vf_explained_var": -9.221774962497875e-05, "kl": 1.748091381159611e-05, "entropy": 0.010232754983007908, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 443968, "num_agent_steps_trained": 443968}, "sampler_results": {"episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}}, "episode_reward_max": 1987.7540745399892, "episode_reward_min": 1987.7540745399892, "episode_reward_mean": 1987.7540745399892, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "policy_reward_mean": {"agent_0": 396.7357589006424, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.01831563934684}, "hist_stats": {"episode_reward": [1987.7540745399892], "episode_lengths": [1995], "policy_agent_0_reward": [396.7357589006424], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.01831563934684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267562937911789, "mean_inference_ms": 0.44430144833042917, "mean_action_processing_ms": 0.09318029515617558, "mean_env_wait_ms": 0.08726616691292238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015082359313964844, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.09383201599121094}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 443968, "num_agent_steps_trained": 443968, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1151.6610353132605, "num_env_steps_trained_throughput_per_sec": 1151.6610353132605, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 443968, "timers": {"training_iteration_time_ms": 3599.982, "sample_time_ms": 636.828, "learn_time_ms": 2948.121, "learn_throughput": 1356.796, "synch_weights_time_ms": 12.653}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 443968, "num_agent_steps_trained": 443968}, "done": false, "episodes_total": 216, "training_iteration": 111, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-05", "timestamp": 1742310365, "time_this_iter_s": 3.4834251403808594, "time_total_s": 402.5965054035187, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878deff760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 402.5965054035187, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 10.24, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 7.28338098526001, "policy_loss": -0.004592092242091894, "vf_loss": 7.287973403930664, "vf_explained_var": 2.5857062269096787e-07, "kl": 6.939286777196685e-06, "entropy": 0.01091469544917345, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 7.296414852142334, "policy_loss": -0.0015805222792550921, "vf_loss": 7.297995090484619, "vf_explained_var": 6.606465376535198e-06, "kl": 5.591349690803327e-06, "entropy": 0.010608904995024204, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 7.3467583656311035, "policy_loss": 0.006343722343444824, "vf_loss": 7.340414524078369, "vf_explained_var": -4.93299410209147e-07, "kl": 1.2325303941906895e-06, "entropy": 0.011406718753278255, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.282633304595947, "policy_loss": -0.0041984631679952145, "vf_loss": 7.286830425262451, "vf_explained_var": -6.286870757321594e-07, "kl": 0.012036700733006, "entropy": 0.03987094759941101, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.190722465515137, "policy_loss": -0.0012669367715716362, "vf_loss": 7.191989421844482, "vf_explained_var": -2.2422700141078167e-08, "kl": 1.2435278222255874e-05, "entropy": 0.009901816956698895, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 447968, "num_agent_steps_trained": 447968}, "sampler_results": {"episode_reward_max": 1989.0000061442124, "episode_reward_min": 1986.1603896993652, "episode_reward_mean": 1987.8806298117797, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0003354626381, "agent_1": 395.7357589420418, "agent_2": 396.00004551246616, "agent_3": 397.0000008315287, "agent_4": 396.02505358634517}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.53387575320255, "agent_1": 397.4847290213164, "agent_2": 397.7500056890583, "agent_3": 397.8750001039411, "agent_4": 397.2370192442613}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1988.2706705629826, 1986.1603896993652, 1989.0000000413993, 1986.871094223533, 1988.3746173973195, 1988.0000455124662, 1987.3682149129593, 1989.0000061442124], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.1353352814913, 397.1353352814913, 398.0, 398.0, 398.0, 398.0, 396.0003354626381, 398.0], "policy_agent_1_reward": [397.1353352814913, 398.0, 398.0, 395.7357589420418, 397.0067379469983, 398.0, 398.0, 398.0], "policy_agent_2_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 396.00004551246616, 398.0, 398.0], "policy_agent_3_reward": [398.0, 397.0000008315287, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_4_reward": [398.0, 396.02505358634517, 397.0000000413994, 397.1353352814913, 397.3678794503212, 398.0, 397.3678794503212, 397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320585711070767, "mean_inference_ms": 0.45541621945129596, "mean_action_processing_ms": 0.09744520447164393, "mean_env_wait_ms": 0.08981135936233053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011594295501708984, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.07912576198577881}}, "episode_reward_max": 1989.0000061442124, "episode_reward_min": 1986.1603896993652, "episode_reward_mean": 1987.8806298117797, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 396.0003354626381, "agent_1": 395.7357589420418, "agent_2": 396.00004551246616, "agent_3": 397.0000008315287, "agent_4": 396.02505358634517}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.53387575320255, "agent_1": 397.4847290213164, "agent_2": 397.7500056890583, "agent_3": 397.8750001039411, "agent_4": 397.2370192442613}, "hist_stats": {"episode_reward": [1988.2706705629826, 1986.1603896993652, 1989.0000000413993, 1986.871094223533, 1988.3746173973195, 1988.0000455124662, 1987.3682149129593, 1989.0000061442124], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.1353352814913, 397.1353352814913, 398.0, 398.0, 398.0, 398.0, 396.0003354626381, 398.0], "policy_agent_1_reward": [397.1353352814913, 398.0, 398.0, 395.7357589420418, 397.0067379469983, 398.0, 398.0, 398.0], "policy_agent_2_reward": [398.0, 398.0, 398.0, 398.0, 398.0, 396.00004551246616, 398.0, 398.0], "policy_agent_3_reward": [398.0, 397.0000008315287, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_4_reward": [398.0, 396.02505358634517, 397.0000000413994, 397.1353352814913, 397.3678794503212, 398.0, 397.3678794503212, 397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5320585711070767, "mean_inference_ms": 0.45541621945129596, "mean_action_processing_ms": 0.09744520447164393, "mean_env_wait_ms": 0.08981135936233053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011594295501708984, "StateBufferConnector_ms": 0.0029528141021728516, "ViewRequirementAgentConnector_ms": 0.07912576198577881}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 447968, "num_agent_steps_trained": 447968, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1005.6767826286124, "num_env_steps_trained_throughput_per_sec": 1005.6767826286124, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 447968, "timers": {"training_iteration_time_ms": 3649.434, "sample_time_ms": 688.955, "learn_time_ms": 2945.433, "learn_throughput": 1358.035, "synch_weights_time_ms": 12.728}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 447968, "num_agent_steps_trained": 447968}, "done": false, "episodes_total": 224, "training_iteration": 112, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-09", "timestamp": 1742310369, "time_this_iter_s": 3.9935178756713867, "time_total_s": 406.59002327919006, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 406.59002327919006, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 9.683333333333334, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04839838296175003, "policy_loss": 0.0006545498035848141, "vf_loss": 0.04774383082985878, "vf_explained_var": -8.900023385649547e-05, "kl": 2.7647163733490743e-05, "entropy": 0.010216769762337208, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0493258535861969, "policy_loss": 0.0017518415115773678, "vf_loss": 0.047574009746313095, "vf_explained_var": -0.0007275274838320911, "kl": 2.8980204660911113e-05, "entropy": 0.009690620936453342, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.045899540185928345, "policy_loss": 0.0021524839103221893, "vf_loss": 0.043747056275606155, "vf_explained_var": 1.5031723705760669e-05, "kl": 2.3858041458879597e-05, "entropy": 0.01068158820271492, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4090861082077026, "policy_loss": -0.01044014934450388, "vf_loss": 1.4195263385772705, "vf_explained_var": 0.010733090341091156, "kl": 0.004471844527870417, "entropy": 0.070850670337677, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.009001638740301132, "policy_loss": 0.00855543278157711, "vf_loss": 0.000446205900516361, "vf_explained_var": 0.00025597072090022266, "kl": 2.640726052050013e-06, "entropy": 0.009302009828388691, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 451968, "num_agent_steps_trained": 451968}, "sampler_results": {"episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}}, "episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 451968, "num_agent_steps_trained": 451968, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1154.0837025626768, "num_env_steps_trained_throughput_per_sec": 1154.0837025626768, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 451968, "timers": {"training_iteration_time_ms": 3643.833, "sample_time_ms": 685.614, "learn_time_ms": 2943.23, "learn_throughput": 1359.051, "synch_weights_time_ms": 12.722}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 451968, "num_agent_steps_trained": 451968}, "done": false, "episodes_total": 224, "training_iteration": 113, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-13", "timestamp": 1742310373, "time_this_iter_s": 3.4788477420806885, "time_total_s": 410.06887102127075, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defdd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 410.06887102127075, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 10.26, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.005180893465876579, "policy_loss": 0.004427224397659302, "vf_loss": 0.0007536683697253466, "vf_explained_var": -0.0003857578558381647, "kl": 6.751552973582875e-06, "entropy": 0.010591640137135983, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.028710773214697838, "policy_loss": -0.003976823762059212, "vf_loss": 0.03268760070204735, "vf_explained_var": -0.001567751169204712, "kl": 1.7517086234875023e-05, "entropy": 0.009376507252454758, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.035692229866981506, "policy_loss": -0.0030583336483687162, "vf_loss": 0.03875056281685829, "vf_explained_var": 3.5835164453601465e-05, "kl": 7.560763606306864e-06, "entropy": 0.010147619061172009, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3673292398452759, "policy_loss": -0.010862249881029129, "vf_loss": 1.3781914710998535, "vf_explained_var": 0.003989155404269695, "kl": 0.01401214487850666, "entropy": 0.03217947483062744, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.048946961760520935, "policy_loss": -0.0022583717945963144, "vf_loss": 0.051205337047576904, "vf_explained_var": 6.046919588698074e-05, "kl": 1.9120227079838514e-05, "entropy": 0.008732800371944904, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 455968, "num_agent_steps_trained": 455968}, "sampler_results": {"episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}}, "episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 455968, "num_agent_steps_trained": 455968, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1134.3375170829627, "num_env_steps_trained_throughput_per_sec": 1134.3375170829627, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 455968, "timers": {"training_iteration_time_ms": 3600.458, "sample_time_ms": 635.745, "learn_time_ms": 2949.873, "learn_throughput": 1355.99, "synch_weights_time_ms": 12.606}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 455968, "num_agent_steps_trained": 455968}, "done": false, "episodes_total": 224, "training_iteration": 114, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-16", "timestamp": 1742310376, "time_this_iter_s": 3.5388896465301514, "time_total_s": 413.6077606678009, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defde10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 413.6077606678009, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 10.02, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 0.025490762665867805, "policy_loss": -0.005398591980338097, "vf_loss": 0.03088935650885105, "vf_explained_var": 0.00020413512538652867, "kl": 6.982071499805897e-05, "entropy": 0.010395059362053871, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.015257683582603931, "policy_loss": -0.002844133647158742, "vf_loss": 0.01810181699693203, "vf_explained_var": -0.0005254745483398438, "kl": 3.0089817300904542e-05, "entropy": 0.00916188582777977, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03850182890892029, "policy_loss": -0.00849579181522131, "vf_loss": 0.04699762165546417, "vf_explained_var": 0.00046575581654906273, "kl": 2.3891483579063788e-05, "entropy": 0.008917602710425854, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.16825681924819946, "policy_loss": -0.004132385831326246, "vf_loss": 0.1723892092704773, "vf_explained_var": -0.02944238670170307, "kl": 0.0021988137159496546, "entropy": 0.019641831517219543, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03902047500014305, "policy_loss": -0.0027317467611283064, "vf_loss": 0.04175221920013428, "vf_explained_var": 7.313177775358781e-05, "kl": 1.0313444363418967e-05, "entropy": 0.00849135871976614, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 459968, "num_agent_steps_trained": 459968}, "sampler_results": {"episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}}, "episode_reward_max": 1989.0000061442124, "episode_reward_min": 1989.0000061442124, "episode_reward_mean": 1989.0000061442124, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "policy_reward_mean": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 398.0, "agent_4": 397.0000061442124}, "hist_stats": {"episode_reward": [1989.0000061442124], "episode_lengths": [1995], "policy_agent_0_reward": [398.0], "policy_agent_1_reward": [398.0], "policy_agent_2_reward": [398.0], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [397.0000061442124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5267543734483398, "mean_inference_ms": 0.4441608065134824, "mean_action_processing_ms": 0.09317195078523728, "mean_env_wait_ms": 0.08689040607734336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011506080627441406, "StateBufferConnector_ms": 0.0026273727416992188, "ViewRequirementAgentConnector_ms": 0.0765848159790039}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 459968, "num_agent_steps_trained": 459968, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1141.384390209787, "num_env_steps_trained_throughput_per_sec": 1141.384390209787, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 459968, "timers": {"training_iteration_time_ms": 3602.292, "sample_time_ms": 638.413, "learn_time_ms": 2949.178, "learn_throughput": 1356.31, "synch_weights_time_ms": 12.484}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 459968, "num_agent_steps_trained": 459968}, "done": false, "episodes_total": 224, "training_iteration": 115, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-20", "timestamp": 1742310380, "time_this_iter_s": 3.5153019428253174, "time_total_s": 417.1230626106262, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878defdd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 417.1230626106262, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 10.14, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 4.999999873689376e-05, "total_loss": 7.2004923820495605, "policy_loss": -0.0004288123163860291, "vf_loss": 7.200920581817627, "vf_explained_var": -4.555497810088127e-07, "kl": 1.030245766742155e-05, "entropy": 0.009570394642651081, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.1716790199279785, "policy_loss": -0.004678166471421719, "vf_loss": 7.176356792449951, "vf_explained_var": 1.2789454331141314e-06, "kl": 3.6966923744330416e-06, "entropy": 0.009554385207593441, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 7.2155866622924805, "policy_loss": 0.0012670076685026288, "vf_loss": 7.214319229125977, "vf_explained_var": 6.509678769361926e-06, "kl": 1.0007087212215993e-06, "entropy": 0.009338127449154854, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.176333904266357, "policy_loss": -0.005295900162309408, "vf_loss": 7.1816301345825195, "vf_explained_var": -1.0483321602805518e-05, "kl": 8.969931514002383e-05, "entropy": 0.014072214253246784, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 7.107119560241699, "policy_loss": -0.0014360907953232527, "vf_loss": 7.108556747436523, "vf_explained_var": -5.722046125811175e-07, "kl": 2.2337952032103203e-05, "entropy": 0.008806907571852207, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 463968, "num_agent_steps_trained": 463968}, "sampler_results": {"episode_reward_max": 1985.0009146824611, "episode_reward_min": 1977.3938969707997, "episode_reward_mean": 1980.6612383757977, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.00000000001387, "agent_2": 388.3678869340797, "agent_3": 396.02505358634517, "agent_4": 396.00095728190354}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 395.00000249458617, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.5522083911253, "agent_1": 397.4214090431153, "agent_2": 390.6709909598734, "agent_3": 397.6741166295833, "agent_4": 397.34251335210047}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1977.3938969707997, 1979.3737546575653, 1982.0000066522298, 1985.0009146824611, 1979.735766384401, 1979.3678891944091, 1983.0497912245344, 1979.3678872399819], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.3678794503212, 398.0, 398.0, 397.0000003059023, 398.0, 398.0, 397.0497870668769, 397.0000003059023], "policy_agent_1_reward": [398.0, 397.00247875228524, 398.0, 397.00091188197257, 398.0, 397.00000226032944, 397.00000000001387, 397.3678794503212], "policy_agent_2_reward": [390.0000066522298, 391.00000582070106, 390.0000066522298, 395.00000249458617, 388.3678869340797, 389.0000074837585, 393.0000041576436, 389.0000074837585], "policy_agent_3_reward": [396.02505358634517, 397.3678794503212, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_4_reward": [396.00095728190354, 396.0033906342578, 398.0, 398.0, 397.3678794503212, 397.3678794503212, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321653472421719, "mean_inference_ms": 0.45557071041628006, "mean_action_processing_ms": 0.09751179457076657, "mean_env_wait_ms": 0.08951211565106193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012169480323791504, "StateBufferConnector_ms": 0.0031054019927978516, "ViewRequirementAgentConnector_ms": 0.08350610733032227}}, "episode_reward_max": 1985.0009146824611, "episode_reward_min": 1977.3938969707997, "episode_reward_mean": 1980.6612383757977, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.00000000001387, "agent_2": 388.3678869340797, "agent_3": 396.02505358634517, "agent_4": 396.00095728190354}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 395.00000249458617, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.5522083911253, "agent_1": 397.4214090431153, "agent_2": 390.6709909598734, "agent_3": 397.6741166295833, "agent_4": 397.34251335210047}, "hist_stats": {"episode_reward": [1977.3938969707997, 1979.3737546575653, 1982.0000066522298, 1985.0009146824611, 1979.735766384401, 1979.3678891944091, 1983.0497912245344, 1979.3678872399819], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [397.3678794503212, 398.0, 398.0, 397.0000003059023, 398.0, 398.0, 397.0497870668769, 397.0000003059023], "policy_agent_1_reward": [398.0, 397.00247875228524, 398.0, 397.00091188197257, 398.0, 397.00000226032944, 397.00000000001387, 397.3678794503212], "policy_agent_2_reward": [390.0000066522298, 391.00000582070106, 390.0000066522298, 395.00000249458617, 388.3678869340797, 389.0000074837585, 393.0000041576436, 389.0000074837585], "policy_agent_3_reward": [396.02505358634517, 397.3678794503212, 398.0, 398.0, 398.0, 398.0, 398.0, 398.0], "policy_agent_4_reward": [396.00095728190354, 396.0033906342578, 398.0, 398.0, 397.3678794503212, 397.3678794503212, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321653472421719, "mean_inference_ms": 0.45557071041628006, "mean_action_processing_ms": 0.09751179457076657, "mean_env_wait_ms": 0.08951211565106193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012169480323791504, "StateBufferConnector_ms": 0.0031054019927978516, "ViewRequirementAgentConnector_ms": 0.08350610733032227}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 463968, "num_agent_steps_trained": 463968, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1001.0716466172483, "num_env_steps_trained_throughput_per_sec": 1001.0716466172483, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 463968, "timers": {"training_iteration_time_ms": 3660.719, "sample_time_ms": 697.559, "learn_time_ms": 2948.553, "learn_throughput": 1356.598, "synch_weights_time_ms": 12.414}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 463968, "num_agent_steps_trained": 463968}, "done": false, "episodes_total": 232, "training_iteration": 116, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-24", "timestamp": 1742310384, "time_this_iter_s": 4.011990785598755, "time_total_s": 421.135053396225, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878dfc7010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 421.135053396225, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 9.716666666666667, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0272174421697855, "policy_loss": -0.00298137660138309, "vf_loss": 0.030198821797966957, "vf_explained_var": 5.864444392500445e-05, "kl": 4.0623013774165884e-05, "entropy": 0.008818280883133411, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": -0.0028858964797109365, "policy_loss": -0.003161061555147171, "vf_loss": 0.0002751635911408812, "vf_explained_var": -0.005087363068014383, "kl": 0.009092938154935837, "entropy": 0.031735192984342575, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.015169486403465271, "policy_loss": -0.0029370542615652084, "vf_loss": 0.01810653693974018, "vf_explained_var": -0.0004447743995115161, "kl": 2.0408746422617696e-05, "entropy": 0.008609939366579056, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08457399904727936, "policy_loss": -0.003992039710283279, "vf_loss": 0.08856604248285294, "vf_explained_var": 0.007558942772448063, "kl": 7.548458233941346e-05, "entropy": 0.01320643350481987, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.006183666177093983, "policy_loss": 0.005242549814283848, "vf_loss": 0.0009411162463948131, "vf_explained_var": -0.0019053868018090725, "kl": 2.2243943021749146e-05, "entropy": 0.009198452346026897, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 467968, "num_agent_steps_trained": 467968}, "sampler_results": {"episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}}, "episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 467968, "num_agent_steps_trained": 467968, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1143.1121616587934, "num_env_steps_trained_throughput_per_sec": 1143.1121616587934, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 467968, "timers": {"training_iteration_time_ms": 3661.472, "sample_time_ms": 699.523, "learn_time_ms": 2946.652, "learn_throughput": 1357.473, "synch_weights_time_ms": 13.061}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 467968, "num_agent_steps_trained": 467968}, "done": false, "episodes_total": 232, "training_iteration": 117, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-28", "timestamp": 1742310388, "time_this_iter_s": 3.517444610595703, "time_total_s": 424.6524980068207, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 424.6524980068207, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 10.239999999999998, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004654928110539913, "policy_loss": 0.003951855469495058, "vf_loss": 0.0007030731067061424, "vf_explained_var": -1.3592981304100249e-05, "kl": 2.186372284995741e-06, "entropy": 0.00885641761124134, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8865876793861389, "policy_loss": -0.00585513049736619, "vf_loss": 0.8924427628517151, "vf_explained_var": 0.0001361103350063786, "kl": 0.019857104867696762, "entropy": 0.11400993168354034, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.004510960541665554, "policy_loss": 0.004148057661950588, "vf_loss": 0.00036290238494984806, "vf_explained_var": -0.0002225941134383902, "kl": 2.0511590719252126e-06, "entropy": 0.00892028957605362, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05692208930850029, "policy_loss": -0.0035899823997169733, "vf_loss": 0.06051207333803177, "vf_explained_var": -0.0026564067229628563, "kl": 3.7039142625872046e-05, "entropy": 0.011196736246347427, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 4.999999873689376e-05, "total_loss": 0.0023492726031690836, "policy_loss": 0.001982184825465083, "vf_loss": 0.0003670888254418969, "vf_explained_var": -0.0058075361885130405, "kl": 3.033068651348003e-06, "entropy": 0.008826990611851215, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 471968, "num_agent_steps_trained": 471968}, "sampler_results": {"episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}}, "episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 471968, "num_agent_steps_trained": 471968, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1151.7311613854783, "num_env_steps_trained_throughput_per_sec": 1151.7311613854783, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 471968, "timers": {"training_iteration_time_ms": 3603.38, "sample_time_ms": 643.799, "learn_time_ms": 2944.101, "learn_throughput": 1358.649, "synch_weights_time_ms": 13.202}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 471968, "num_agent_steps_trained": 471968}, "done": false, "episodes_total": 232, "training_iteration": 118, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-31", "timestamp": 1742310391, "time_this_iter_s": 3.4839649200439453, "time_total_s": 428.1364629268646, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878deff760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 428.1364629268646, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 10.080000000000002, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 4.999999873689376e-05, "total_loss": 0.02144773118197918, "policy_loss": 0.0035396430175751448, "vf_loss": 0.017908090725541115, "vf_explained_var": -5.666159268002957e-05, "kl": 2.355521974095609e-05, "entropy": 0.009065752848982811, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 2.136725664138794, "policy_loss": -0.014365855604410172, "vf_loss": 2.1510913372039795, "vf_explained_var": 0.010212443768978119, "kl": 0.005392902065068483, "entropy": 0.11829429119825363, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 4.999999873689376e-05, "total_loss": -0.00924108549952507, "policy_loss": -0.009383638389408588, "vf_loss": 0.0001425501104677096, "vf_explained_var": -0.001185565604828298, "kl": 1.2296708291614777e-06, "entropy": 0.008881277404725552, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 0.007553087547421455, "policy_loss": -0.007595052011311054, "vf_loss": 0.015148138627409935, "vf_explained_var": -0.05182165279984474, "kl": 3.991476660303306e-06, "entropy": 0.010983424261212349, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03292815014719963, "policy_loss": -0.0012415437959134579, "vf_loss": 0.03416969254612923, "vf_explained_var": 0.0010245712473988533, "kl": 6.764953468518797e-06, "entropy": 0.008358100429177284, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 475968, "num_agent_steps_trained": 475968}, "sampler_results": {"episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}}, "episode_reward_max": 1979.3678872399819, "episode_reward_min": 1979.3678872399819, "episode_reward_mean": 1979.3678872399819, "episode_len_mean": 1995.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_max": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.0000003059023, "agent_1": 397.3678794503212, "agent_2": 389.0000074837585, "agent_3": 398.0, "agent_4": 398.0}, "hist_stats": {"episode_reward": [1979.3678872399819], "episode_lengths": [1995], "policy_agent_0_reward": [397.0000003059023], "policy_agent_1_reward": [397.3678794503212], "policy_agent_2_reward": [389.0000074837585], "policy_agent_3_reward": [398.0], "policy_agent_4_reward": [398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.526662633405924, "mean_inference_ms": 0.4439058267824202, "mean_action_processing_ms": 0.09313038046143264, "mean_env_wait_ms": 0.08653734896121806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010652542114257812, "StateBufferConnector_ms": 0.0025081634521484375, "ViewRequirementAgentConnector_ms": 0.0719308853149414}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 475968, "num_agent_steps_trained": 475968, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1157.9129427974767, "num_env_steps_trained_throughput_per_sec": 1157.9129427974767, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 475968, "timers": {"training_iteration_time_ms": 3585.511, "sample_time_ms": 626.828, "learn_time_ms": 2943.177, "learn_throughput": 1359.076, "synch_weights_time_ms": 13.222}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 475968, "num_agent_steps_trained": 475968}, "done": false, "episodes_total": 232, "training_iteration": 119, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-35", "timestamp": 1742310395, "time_this_iter_s": 3.465975046157837, "time_total_s": 431.60243797302246, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f879820a3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 431.60243797302246, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 10.1, "ram_util_percent": 6.5}}
{"custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "episode_media": {}, "info": {"learner": {"agent_1": {"learner_stats": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.117287635803223, "policy_loss": 0.0034315180964767933, "vf_loss": 7.113855361938477, "vf_explained_var": 3.726709394413774e-07, "kl": 2.8426924473023973e-05, "entropy": 0.009528566151857376, "entropy_coeff": 0.0, "model": {}}}, "agent_3": {"learner_stats": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 4.999999873689376e-05, "total_loss": 7.174663066864014, "policy_loss": 0.0019151768647134304, "vf_loss": 7.172747611999512, "vf_explained_var": 1.9245488147134893e-05, "kl": 0.002048393478617072, "entropy": 0.11290301382541656, "entropy_coeff": 0.0, "model": {}}}, "agent_4": {"learner_stats": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 7.09165620803833, "policy_loss": -0.0009805499576032162, "vf_loss": 7.0926361083984375, "vf_explained_var": 1.7171814192806778e-07, "kl": 1.0998726793332025e-05, "entropy": 0.009439324960112572, "entropy_coeff": 0.0, "model": {}}}, "agent_2": {"learner_stats": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 4.999999873689376e-05, "total_loss": 7.081862449645996, "policy_loss": -0.0023552915081381798, "vf_loss": 7.0842180252075195, "vf_explained_var": 6.532413681270555e-05, "kl": 2.28470926231239e-05, "entropy": 0.011130533181130886, "entropy_coeff": 0.0, "model": {}}}, "agent_0": {"learner_stats": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 4.999999873689376e-05, "total_loss": 7.025308132171631, "policy_loss": 0.005201881285756826, "vf_loss": 7.020105361938477, "vf_explained_var": -4.966485903423745e-06, "kl": 5.999266704748152e-06, "entropy": 0.008444163016974926, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 479968, "num_agent_steps_trained": 479968}, "sampler_results": {"episode_reward_max": 1981.0681395716008, "episode_reward_min": 1971.4595253460297, "episode_reward_mean": 1976.984034811933, "episode_len_mean": 1995.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000000056028, "agent_1": 397.3678794503212, "agent_2": 397.0000001125352, "agent_3": 380.0916458957086, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 390.018352504724, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.5065335106368, "agent_1": 397.76295479387045, "agent_2": 397.6272895729263, "agent_3": 386.209967479581, "agent_4": 397.87728945491835}, "custom_metrics": {"num_batches_mean": 25.0, "num_batches_min": 25, "num_batches_max": 25}, "hist_stats": {"episode_reward": [1976.4961527585224, 1978.4726506064155, 1977.0984323519729, 1979.0733016829913, 1976.112409566176, 1981.0681395716008, 1976.0916666117548, 1971.4595253460297], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 397.00000226032944, 397.00247875228524, 397.0497870668769, 397.0000000056028, 398.0], "policy_agent_1_reward": [397.3678794503212, 397.3678794503212, 398.0, 398.0, 398.0, 398.0, 398.0, 397.3678794503212], "policy_agent_2_reward": [398.0, 398.0, 397.0000008315287, 398.0, 397.0000001125352, 398.0, 397.01831563934684, 398.0], "policy_agent_3_reward": [385.1282733082013, 387.1047711560942, 387.0801158810973, 388.0732994226619, 386.10993070135555, 390.018352504724, 386.07335096680526, 380.0916458957086], "policy_agent_4_reward": [398.0, 398.0, 397.01831563934684, 398.0, 398.0, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321417973857349, "mean_inference_ms": 0.45547318302395556, "mean_action_processing_ms": 0.09750433082260773, "mean_env_wait_ms": 0.08918582221885174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011855363845825195, "StateBufferConnector_ms": 0.003032684326171875, "ViewRequirementAgentConnector_ms": 0.08150339126586914}}, "episode_reward_max": 1981.0681395716008, "episode_reward_min": 1971.4595253460297, "episode_reward_mean": 1976.984034811933, "episode_len_mean": 1995.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 397.0000000056028, "agent_1": 397.3678794503212, "agent_2": 397.0000001125352, "agent_3": 380.0916458957086, "agent_4": 397.01831563934684}, "policy_reward_max": {"agent_0": 398.0, "agent_1": 398.0, "agent_2": 398.0, "agent_3": 390.018352504724, "agent_4": 398.0}, "policy_reward_mean": {"agent_0": 397.5065335106368, "agent_1": 397.76295479387045, "agent_2": 397.6272895729263, "agent_3": 386.209967479581, "agent_4": 397.87728945491835}, "hist_stats": {"episode_reward": [1976.4961527585224, 1978.4726506064155, 1977.0984323519729, 1979.0733016829913, 1976.112409566176, 1981.0681395716008, 1976.0916666117548, 1971.4595253460297], "episode_lengths": [1995, 1995, 1995, 1995, 1995, 1995, 1995, 1995], "policy_agent_0_reward": [398.0, 398.0, 398.0, 397.00000226032944, 397.00247875228524, 397.0497870668769, 397.0000000056028, 398.0], "policy_agent_1_reward": [397.3678794503212, 397.3678794503212, 398.0, 398.0, 398.0, 398.0, 398.0, 397.3678794503212], "policy_agent_2_reward": [398.0, 398.0, 397.0000008315287, 398.0, 397.0000001125352, 398.0, 397.01831563934684, 398.0], "policy_agent_3_reward": [385.1282733082013, 387.1047711560942, 387.0801158810973, 388.0732994226619, 386.10993070135555, 390.018352504724, 386.07335096680526, 380.0916458957086], "policy_agent_4_reward": [398.0, 398.0, 397.01831563934684, 398.0, 398.0, 398.0, 398.0, 398.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5321417973857349, "mean_inference_ms": 0.45547318302395556, "mean_action_processing_ms": 0.09750433082260773, "mean_env_wait_ms": 0.08918582221885174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011855363845825195, "StateBufferConnector_ms": 0.003032684326171875, "ViewRequirementAgentConnector_ms": 0.08150339126586914}, "num_healthy_workers": 8, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 479968, "num_agent_steps_trained": 479968, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 999.4218713485337, "num_env_steps_trained_throughput_per_sec": 999.4218713485337, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 479968, "timers": {"training_iteration_time_ms": 3637.174, "sample_time_ms": 682.625, "learn_time_ms": 2939.257, "learn_throughput": 1360.888, "synch_weights_time_ms": 13.038}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 479968, "num_agent_steps_trained": 479968}, "done": true, "episodes_total": 240, "training_iteration": 120, "trial_id": "72c65_00000", "date": "2025-03-18_16-06-39", "timestamp": 1742310399, "time_this_iter_s": 4.018995046615601, "time_total_s": 435.62143301963806, "pid": 3950241, "hostname": "cx22", "node_ip": "172.20.32.75", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 5}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f878dfc48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_2": [null, "Discrete(10)", "Discrete(29)", null], "agent_3": [null, "Discrete(10)", "Discrete(29)", null], "agent_0": [null, "Discrete(10)", "Discrete(29)", null], "agent_1": [null, "Discrete(10)", "Discrete(29)", null], "agent_4": [null, "Discrete(10)", "Discrete(29)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 8}, "time_since_restore": 435.62143301963806, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 9.783333333333333, "ram_util_percent": 6.5}}
