{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98664379119873, "policy_loss": -0.016243526712059975, "vf_loss": 10.0, "vf_explained_var": -1.038114234575005e-07, "kl": 0.014430111274123192, "entropy": 1.3725711107254028, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.253420558876, "num_env_steps_trained_throughput_per_sec": 188.253420558876, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 21247.888, "sample_time_ms": 16805.93, "learn_time_ms": 4340.3, "learn_throughput": 921.595, "synch_weights_time_ms": 100.532}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "185f8_00000", "date": "2025-03-21_11-44-39", "timestamp": 1742557479, "time_this_iter_s": 21.2908775806427, "time_total_s": 21.2908775806427, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0c6bb50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 21.2908775806427, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 93.6366666666667, "ram_util_percent": 13.386666666666663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.994547843933105, "policy_loss": -0.0068839541636407375, "vf_loss": 10.0, "vf_explained_var": 2.55368661328248e-07, "kl": 0.007159429602324963, "entropy": 1.3652234077453613, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.3110417014259, "num_env_steps_trained_throughput_per_sec": 297.3110417014259, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17350.875, "sample_time_ms": 13195.576, "learn_time_ms": 4017.718, "learn_throughput": 995.59, "synch_weights_time_ms": 136.724}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "185f8_00000", "date": "2025-03-21_11-45-02", "timestamp": 1742557502, "time_this_iter_s": 13.504715919494629, "time_total_s": 34.79559350013733, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0caecb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 34.79559350013733, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 98.95151515151515, "ram_util_percent": 13.484848484848484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988300323486328, "policy_loss": -0.010610484518110752, "vf_loss": 9.9973726272583, "vf_explained_var": -2.400310040684417e-05, "kl": 0.007690840866416693, "entropy": 1.346152424812317, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.57886312113135, "num_env_steps_trained_throughput_per_sec": 287.57886312113135, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 16203.635, "sample_time_ms": 12127.223, "learn_time_ms": 3920.901, "learn_throughput": 1020.174, "synch_weights_time_ms": 154.534}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "185f8_00000", "date": "2025-03-21_11-45-16", "timestamp": 1742557516, "time_this_iter_s": 13.96466064453125, "time_total_s": 48.76025414466858, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0caeb90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 48.76025414466858, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.63684210526317, "ram_util_percent": 13.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981019973754883, "policy_loss": -0.013703904114663601, "vf_loss": 9.992431640625, "vf_explained_var": 1.140739732363727e-05, "kl": 0.011462078429758549, "entropy": 1.3218190670013428, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.431156684711, "num_env_steps_trained_throughput_per_sec": 293.431156684711, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15560.661, "sample_time_ms": 11552.106, "learn_time_ms": 3849.127, "learn_throughput": 1039.197, "synch_weights_time_ms": 158.461}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "185f8_00000", "date": "2025-03-21_11-45-30", "timestamp": 1742557530, "time_this_iter_s": 13.697496891021729, "time_total_s": 62.45775103569031, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0cae050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 62.45775103569031, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 99.53500000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.669546127319336, "policy_loss": -0.014640412293374538, "vf_loss": 9.681883811950684, "vf_explained_var": -5.63661251362646e-06, "kl": 0.011508115567266941, "entropy": 1.3186078071594238, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 46673.493302702904, "episode_reward_min": 29018.100017547607, "episode_reward_mean": 38813.45305773207, "episode_len_mean": 138.59677419354838, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 29018.100017547607}, "policy_reward_max": {"agent_0": 46673.493302702904}, "policy_reward_mean": {"agent_0": 38813.45305773207}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [38134.89318680763, 34822.879915714264, 37804.493320941925, 38250.90672186017, 39171.726857185364, 37616.12004995346, 33761.59992599487, 41816.333193063736, 33083.32006263733, 46253.566665649414, 33993.96010804176, 35311.41348993778, 44854.04666805267, 43582.48674964905, 34517.98010635376, 42407.48654174805, 41336.8801279068, 38634.86009699106, 40477.77996444702, 37642.526753902435, 38455.22005486488, 43922.57345581055, 39552.546647548676, 36539.44670236111, 40423.48664522171, 43707.053718566895, 43659.72681951523, 35165.1399230957, 33240.97346931696, 40727.953501701355, 43570.18649291992, 42882.12664318085, 42109.13330435753, 34761.96003961563, 34981.64010930061, 36378.519894361496, 40463.72019767761, 38304.14668178558, 37347.66675758362, 39264.426626205444, 36374.03341436386, 39366.460057497025, 36678.333475112915, 38614.22006213665, 41285.433487296104, 42464.653341293335, 39177.613408088684, 38117.57343292236, 42012.99335193634, 37358.11993122101, 46673.493302702904, 35483.746697068214, 39194.25330978632, 36065.600118637085, 38364.27999687195, 38808.5999519825, 39085.07326078415, 35699.5000538826, 31822.906725883484, 39929.70672798157, 41848.25352525711, 45405.766770362854, 41837.46668052673, 34718.13343024254, 41283.300048828125, 41145.14677286148, 31422.793502926826, 42921.76679897308, 35834.11351966858, 39623.100080013275, 43438.94006443024, 41107.50004851818, 39259.68008494377, 35083.946628153324, 39098.04660195112, 31267.380081534386, 39744.29334831238, 35752.780237197876, 37318.239839076996, 37063.053384661674, 37540.09340906143, 40110.993299007416, 45059.66688632965, 36274.099910736084, 40684.74670982361, 40265.706834197044, 44705.940366744995, 39411.82678604126, 42177.05335664749, 32734.319996595383, 38949.6734341979, 40046.313422203064, 42111.21989917755, 38677.52004146576, 38907.846714019775, 45337.19343948364, 36916.61342096329, 38542.68678188324, 36681.913280546665, 33053.62674188614, 39567.7133808136, 29018.100017547607, 38478.65337181091, 41041.6200504303, 35840.05342698097, 36887.79345488548, 43841.18015575409, 36314.619998931885, 36522.86665284634, 39623.713429927826, 39835.353244781494, 39332.9333820343, 36752.70661687851, 38249.02674293518, 43968.10670661926, 33056.826791763306, 37615.059889793396, 31808.499993920326, 40049.14669632912, 44498.37333393097, 38594.96660375595, 37135.71343636513, 38657.54662322998, 41305.34667778015], "episode_lengths": [139, 138, 139, 139, 139, 140, 139, 139, 138, 139, 139, 139, 138, 140, 139, 139, 139, 139, 139, 139, 138, 139, 138, 139, 138, 138, 139, 138, 138, 139, 139, 138, 139, 138, 139, 138, 139, 139, 138, 138, 138, 139, 139, 139, 138, 139, 138, 138, 138, 138, 139, 138, 138, 138, 138, 139, 138, 139, 138, 138, 138, 139, 139, 139, 139, 139, 139, 138, 138, 138, 139, 139, 139, 138, 138, 138, 139, 139, 139, 139, 139, 138, 139, 139, 140, 138, 139, 139, 139, 139, 139, 138, 139, 138, 139, 138, 138, 138, 138, 138, 138, 138, 138, 139, 139, 139, 138, 138, 139, 139, 139, 138, 138, 138, 139, 138, 139, 139, 138, 140, 140, 139, 138, 138], "policy_agent_0_reward": [38134.89318680763, 34822.879915714264, 37804.493320941925, 38250.90672186017, 39171.726857185364, 37616.12004995346, 33761.59992599487, 41816.333193063736, 33083.32006263733, 46253.566665649414, 33993.96010804176, 35311.41348993778, 44854.04666805267, 43582.48674964905, 34517.98010635376, 42407.48654174805, 41336.8801279068, 38634.86009699106, 40477.77996444702, 37642.526753902435, 38455.22005486488, 43922.57345581055, 39552.546647548676, 36539.44670236111, 40423.48664522171, 43707.053718566895, 43659.72681951523, 35165.1399230957, 33240.97346931696, 40727.953501701355, 43570.18649291992, 42882.12664318085, 42109.13330435753, 34761.96003961563, 34981.64010930061, 36378.519894361496, 40463.72019767761, 38304.14668178558, 37347.66675758362, 39264.426626205444, 36374.03341436386, 39366.460057497025, 36678.333475112915, 38614.22006213665, 41285.433487296104, 42464.653341293335, 39177.613408088684, 38117.57343292236, 42012.99335193634, 37358.11993122101, 46673.493302702904, 35483.746697068214, 39194.25330978632, 36065.600118637085, 38364.27999687195, 38808.5999519825, 39085.07326078415, 35699.5000538826, 31822.906725883484, 39929.70672798157, 41848.25352525711, 45405.766770362854, 41837.46668052673, 34718.13343024254, 41283.300048828125, 41145.14677286148, 31422.793502926826, 42921.76679897308, 35834.11351966858, 39623.100080013275, 43438.94006443024, 41107.50004851818, 39259.68008494377, 35083.946628153324, 39098.04660195112, 31267.380081534386, 39744.29334831238, 35752.780237197876, 37318.239839076996, 37063.053384661674, 37540.09340906143, 40110.993299007416, 45059.66688632965, 36274.099910736084, 40684.74670982361, 40265.706834197044, 44705.940366744995, 39411.82678604126, 42177.05335664749, 32734.319996595383, 38949.6734341979, 40046.313422203064, 42111.21989917755, 38677.52004146576, 38907.846714019775, 45337.19343948364, 36916.61342096329, 38542.68678188324, 36681.913280546665, 33053.62674188614, 39567.7133808136, 29018.100017547607, 38478.65337181091, 41041.6200504303, 35840.05342698097, 36887.79345488548, 43841.18015575409, 36314.619998931885, 36522.86665284634, 39623.713429927826, 39835.353244781494, 39332.9333820343, 36752.70661687851, 38249.02674293518, 43968.10670661926, 33056.826791763306, 37615.059889793396, 31808.499993920326, 40049.14669632912, 44498.37333393097, 38594.96660375595, 37135.71343636513, 38657.54662322998, 41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.2237948585837, "mean_inference_ms": 6.582274383537828, "mean_action_processing_ms": 0.20794064033224066, "mean_env_wait_ms": 246.90556696500337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05499509073072864, "StateBufferConnector_ms": 0.016227268403576266, "ViewRequirementAgentConnector_ms": 0.29883327022675543}}, "episode_reward_max": 46673.493302702904, "episode_reward_min": 29018.100017547607, "episode_reward_mean": 38813.45305773207, "episode_len_mean": 138.59677419354838, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 29018.100017547607}, "policy_reward_max": {"agent_0": 46673.493302702904}, "policy_reward_mean": {"agent_0": 38813.45305773207}, "hist_stats": {"episode_reward": [38134.89318680763, 34822.879915714264, 37804.493320941925, 38250.90672186017, 39171.726857185364, 37616.12004995346, 33761.59992599487, 41816.333193063736, 33083.32006263733, 46253.566665649414, 33993.96010804176, 35311.41348993778, 44854.04666805267, 43582.48674964905, 34517.98010635376, 42407.48654174805, 41336.8801279068, 38634.86009699106, 40477.77996444702, 37642.526753902435, 38455.22005486488, 43922.57345581055, 39552.546647548676, 36539.44670236111, 40423.48664522171, 43707.053718566895, 43659.72681951523, 35165.1399230957, 33240.97346931696, 40727.953501701355, 43570.18649291992, 42882.12664318085, 42109.13330435753, 34761.96003961563, 34981.64010930061, 36378.519894361496, 40463.72019767761, 38304.14668178558, 37347.66675758362, 39264.426626205444, 36374.03341436386, 39366.460057497025, 36678.333475112915, 38614.22006213665, 41285.433487296104, 42464.653341293335, 39177.613408088684, 38117.57343292236, 42012.99335193634, 37358.11993122101, 46673.493302702904, 35483.746697068214, 39194.25330978632, 36065.600118637085, 38364.27999687195, 38808.5999519825, 39085.07326078415, 35699.5000538826, 31822.906725883484, 39929.70672798157, 41848.25352525711, 45405.766770362854, 41837.46668052673, 34718.13343024254, 41283.300048828125, 41145.14677286148, 31422.793502926826, 42921.76679897308, 35834.11351966858, 39623.100080013275, 43438.94006443024, 41107.50004851818, 39259.68008494377, 35083.946628153324, 39098.04660195112, 31267.380081534386, 39744.29334831238, 35752.780237197876, 37318.239839076996, 37063.053384661674, 37540.09340906143, 40110.993299007416, 45059.66688632965, 36274.099910736084, 40684.74670982361, 40265.706834197044, 44705.940366744995, 39411.82678604126, 42177.05335664749, 32734.319996595383, 38949.6734341979, 40046.313422203064, 42111.21989917755, 38677.52004146576, 38907.846714019775, 45337.19343948364, 36916.61342096329, 38542.68678188324, 36681.913280546665, 33053.62674188614, 39567.7133808136, 29018.100017547607, 38478.65337181091, 41041.6200504303, 35840.05342698097, 36887.79345488548, 43841.18015575409, 36314.619998931885, 36522.86665284634, 39623.713429927826, 39835.353244781494, 39332.9333820343, 36752.70661687851, 38249.02674293518, 43968.10670661926, 33056.826791763306, 37615.059889793396, 31808.499993920326, 40049.14669632912, 44498.37333393097, 38594.96660375595, 37135.71343636513, 38657.54662322998, 41305.34667778015], "episode_lengths": [139, 138, 139, 139, 139, 140, 139, 139, 138, 139, 139, 139, 138, 140, 139, 139, 139, 139, 139, 139, 138, 139, 138, 139, 138, 138, 139, 138, 138, 139, 139, 138, 139, 138, 139, 138, 139, 139, 138, 138, 138, 139, 139, 139, 138, 139, 138, 138, 138, 138, 139, 138, 138, 138, 138, 139, 138, 139, 138, 138, 138, 139, 139, 139, 139, 139, 139, 138, 138, 138, 139, 139, 139, 138, 138, 138, 139, 139, 139, 139, 139, 138, 139, 139, 140, 138, 139, 139, 139, 139, 139, 138, 139, 138, 139, 138, 138, 138, 138, 138, 138, 138, 138, 139, 139, 139, 138, 138, 139, 139, 139, 138, 138, 138, 139, 138, 139, 139, 138, 140, 140, 139, 138, 138], "policy_agent_0_reward": [38134.89318680763, 34822.879915714264, 37804.493320941925, 38250.90672186017, 39171.726857185364, 37616.12004995346, 33761.59992599487, 41816.333193063736, 33083.32006263733, 46253.566665649414, 33993.96010804176, 35311.41348993778, 44854.04666805267, 43582.48674964905, 34517.98010635376, 42407.48654174805, 41336.8801279068, 38634.86009699106, 40477.77996444702, 37642.526753902435, 38455.22005486488, 43922.57345581055, 39552.546647548676, 36539.44670236111, 40423.48664522171, 43707.053718566895, 43659.72681951523, 35165.1399230957, 33240.97346931696, 40727.953501701355, 43570.18649291992, 42882.12664318085, 42109.13330435753, 34761.96003961563, 34981.64010930061, 36378.519894361496, 40463.72019767761, 38304.14668178558, 37347.66675758362, 39264.426626205444, 36374.03341436386, 39366.460057497025, 36678.333475112915, 38614.22006213665, 41285.433487296104, 42464.653341293335, 39177.613408088684, 38117.57343292236, 42012.99335193634, 37358.11993122101, 46673.493302702904, 35483.746697068214, 39194.25330978632, 36065.600118637085, 38364.27999687195, 38808.5999519825, 39085.07326078415, 35699.5000538826, 31822.906725883484, 39929.70672798157, 41848.25352525711, 45405.766770362854, 41837.46668052673, 34718.13343024254, 41283.300048828125, 41145.14677286148, 31422.793502926826, 42921.76679897308, 35834.11351966858, 39623.100080013275, 43438.94006443024, 41107.50004851818, 39259.68008494377, 35083.946628153324, 39098.04660195112, 31267.380081534386, 39744.29334831238, 35752.780237197876, 37318.239839076996, 37063.053384661674, 37540.09340906143, 40110.993299007416, 45059.66688632965, 36274.099910736084, 40684.74670982361, 40265.706834197044, 44705.940366744995, 39411.82678604126, 42177.05335664749, 32734.319996595383, 38949.6734341979, 40046.313422203064, 42111.21989917755, 38677.52004146576, 38907.846714019775, 45337.19343948364, 36916.61342096329, 38542.68678188324, 36681.913280546665, 33053.62674188614, 39567.7133808136, 29018.100017547607, 38478.65337181091, 41041.6200504303, 35840.05342698097, 36887.79345488548, 43841.18015575409, 36314.619998931885, 36522.86665284634, 39623.713429927826, 39835.353244781494, 39332.9333820343, 36752.70661687851, 38249.02674293518, 43968.10670661926, 33056.826791763306, 37615.059889793396, 31808.499993920326, 40049.14669632912, 44498.37333393097, 38594.96660375595, 37135.71343636513, 38657.54662322998, 41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.2237948585837, "mean_inference_ms": 6.582274383537828, "mean_action_processing_ms": 0.20794064033224066, "mean_env_wait_ms": 246.90556696500337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05499509073072864, "StateBufferConnector_ms": 0.016227268403576266, "ViewRequirementAgentConnector_ms": 0.29883327022675543}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.59005012083662, "num_env_steps_trained_throughput_per_sec": 185.59005012083662, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 16759.09, "sample_time_ms": 12761.808, "learn_time_ms": 3822.78, "learn_throughput": 1046.359, "synch_weights_time_ms": 173.521}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 124, "training_iteration": 5, "trial_id": "185f8_00000", "date": "2025-03-21_11-45-51", "timestamp": 1742557551, "time_this_iter_s": 21.620795726776123, "time_total_s": 84.07854676246643, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b80550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 84.07854676246643, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.72857142857143, "ram_util_percent": 13.492857142857144}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98315715789795, "policy_loss": -0.017229905351996422, "vf_loss": 9.997872352600098, "vf_explained_var": 5.664986929332372e-06, "kl": 0.012566627934575081, "entropy": 1.2906806468963623, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}}, "episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.76138671052337, "num_env_steps_trained_throughput_per_sec": 284.76138671052337, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16307.042, "sample_time_ms": 12331.495, "learn_time_ms": 3807.812, "learn_throughput": 1050.472, "synch_weights_time_ms": 166.742}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 124, "training_iteration": 6, "trial_id": "185f8_00000", "date": "2025-03-21_11-46-05", "timestamp": 1742557565, "time_this_iter_s": 14.101072311401367, "time_total_s": 98.1796190738678, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b80430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 98.1796190738678, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.46842105263157, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.97905158996582, "policy_loss": -0.021704919636249542, "vf_loss": 9.997588157653809, "vf_explained_var": -2.4276475869555725e-06, "kl": 0.015839476138353348, "entropy": 1.2388529777526855, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}}, "episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.9470257102898, "num_env_steps_trained_throughput_per_sec": 285.9470257102898, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15975.826, "sample_time_ms": 11998.904, "learn_time_ms": 3814.206, "learn_throughput": 1048.711, "synch_weights_time_ms": 161.72}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 124, "training_iteration": 7, "trial_id": "185f8_00000", "date": "2025-03-21_11-46-19", "timestamp": 1742557579, "time_this_iter_s": 14.047083854675293, "time_total_s": 112.22670292854309, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 112.22670292854309, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.45500000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98877239227295, "policy_loss": -0.013078846968710423, "vf_loss": 10.0, "vf_explained_var": 1.380157937092008e-05, "kl": 0.009256887249648571, "entropy": 1.2380305528640747, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}}, "episode_reward_max": 41305.34667778015, "episode_reward_min": 41305.34667778015, "episode_reward_mean": 41305.34667778015, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 41305.34667778015}, "policy_reward_max": {"agent_0": 41305.34667778015}, "policy_reward_mean": {"agent_0": 41305.34667778015}, "hist_stats": {"episode_reward": [41305.34667778015], "episode_lengths": [138], "policy_agent_0_reward": [41305.34667778015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.447439537285277, "mean_inference_ms": 5.778933163755429, "mean_action_processing_ms": 0.19538920858631964, "mean_env_wait_ms": 263.60428703497655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039124488830566406, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.16303062438964844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.6382787381086, "num_env_steps_trained_throughput_per_sec": 295.6382787381086, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15670.095, "sample_time_ms": 11686.102, "learn_time_ms": 3818.506, "learn_throughput": 1047.53, "synch_weights_time_ms": 164.475}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 124, "training_iteration": 8, "trial_id": "185f8_00000", "date": "2025-03-21_11-46-33", "timestamp": 1742557593, "time_this_iter_s": 13.585756063461304, "time_total_s": 125.8124589920044, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81b40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 125.8124589920044, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.53684210526316, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.672257423400879, "policy_loss": -0.02086869440972805, "vf_loss": 9.69028091430664, "vf_explained_var": -8.946284424382611e-07, "kl": 0.014222219586372375, "entropy": 1.2003934383392334, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 48457.11329269409, "episode_reward_min": 31523.186655044556, "episode_reward_mean": 41831.292900026805, "episode_len_mean": 138.34677419354838, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 31523.186655044556}, "policy_reward_max": {"agent_0": 48457.11329269409}, "policy_reward_mean": {"agent_0": 41831.292900026805}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [38236.57330989838, 44932.09351992607, 44082.38667535782, 36452.56013250351, 39607.69994544983, 41202.720052719116, 40794.27320289612, 42725.84670448303, 42968.74010848999, 47449.073221206665, 42548.69336891174, 41515.24680715799, 38165.20673751831, 43678.133400440216, 44755.540024757385, 43600.953411102295, 42146.40661025047, 41798.69346046448, 41357.50014305115, 44053.046866834164, 41519.96674442291, 41083.10022568703, 46872.779930114746, 37568.853387355804, 41743.37338447571, 43144.50685119629, 41436.933404922485, 41946.98006129265, 47091.506690979004, 39956.91330635548, 40026.813392043114, 43231.66009902954, 48457.11329269409, 41076.36002635956, 40464.76675605774, 43713.69337940216, 40108.859966278076, 42951.320039987564, 46476.17329978943, 40641.800088882446, 38785.05346775055, 43860.299974918365, 47154.153458595276, 47959.47328567505, 37635.75340652466, 40508.24012851715, 41234.69342803955, 40368.39335769415, 42125.346742630005, 33537.20009243488, 37503.67998313904, 38666.24661874771, 42822.186715602875, 45410.15348434448, 42495.43336105347, 36420.69336628914, 37074.45330572128, 42423.69351196289, 45495.046702861786, 39034.333319664, 42857.84008407593, 41182.35324794054, 43534.2401638031, 43225.6333732605, 42996.22686290741, 47456.10655593872, 35626.52668762207, 35253.33330535889, 39474.0002014637, 41894.706773757935, 46206.78017425537, 42783.786657333374, 42702.57997608185, 40092.54019141197, 41254.76655483246, 41575.78668117523, 45489.113399505615, 44761.560170173645, 47335.24674987793, 45847.0601978302, 37304.80003273487, 45713.69330215454, 42742.46671581268, 44551.17992687225, 39266.700152397156, 45457.83364391327, 41128.64665222168, 41461.32002735138, 45733.17997837067, 37411.07349073887, 43346.25328683853, 42898.180006980896, 45281.379806518555, 40581.8600358963, 39416.646773815155, 43109.82665157318, 39826.94665622711, 38289.906502723694, 40261.366745233536, 42328.72669792175, 41045.3668050766, 34692.993297457695, 41255.14667749405, 44882.68008041382, 42401.09344291687, 41522.60663700104, 39741.05340766907, 34992.246790885925, 40818.246831297874, 40581.193343997, 46113.58672952652, 37699.380071640015, 45914.15999639034, 36947.24681043625, 39379.98006820679, 44102.01336288452, 43572.33352088928, 46237.23327255249, 40863.70678758621, 40858.93989801407, 31523.186655044556, 46206.419982910156, 40404.726786613464, 45563.21350860596], "episode_lengths": [140, 138, 138, 139, 139, 139, 138, 138, 138, 139, 138, 139, 138, 139, 139, 138, 139, 138, 139, 138, 139, 137, 138, 139, 139, 140, 138, 138, 138, 138, 137, 139, 138, 138, 138, 139, 139, 138, 139, 137, 138, 138, 138, 138, 138, 138, 137, 139, 139, 139, 139, 138, 138, 139, 138, 138, 138, 138, 137, 138, 138, 138, 139, 139, 139, 138, 138, 138, 138, 138, 139, 139, 139, 138, 138, 139, 140, 138, 138, 138, 139, 138, 138, 137, 139, 137, 138, 138, 137, 139, 138, 138, 138, 138, 138, 139, 139, 138, 138, 139, 139, 139, 138, 139, 138, 139, 138, 139, 140, 139, 138, 138, 138, 139, 138, 138, 138, 139, 138, 138, 138, 139, 137, 139], "policy_agent_0_reward": [38236.57330989838, 44932.09351992607, 44082.38667535782, 36452.56013250351, 39607.69994544983, 41202.720052719116, 40794.27320289612, 42725.84670448303, 42968.74010848999, 47449.073221206665, 42548.69336891174, 41515.24680715799, 38165.20673751831, 43678.133400440216, 44755.540024757385, 43600.953411102295, 42146.40661025047, 41798.69346046448, 41357.50014305115, 44053.046866834164, 41519.96674442291, 41083.10022568703, 46872.779930114746, 37568.853387355804, 41743.37338447571, 43144.50685119629, 41436.933404922485, 41946.98006129265, 47091.506690979004, 39956.91330635548, 40026.813392043114, 43231.66009902954, 48457.11329269409, 41076.36002635956, 40464.76675605774, 43713.69337940216, 40108.859966278076, 42951.320039987564, 46476.17329978943, 40641.800088882446, 38785.05346775055, 43860.299974918365, 47154.153458595276, 47959.47328567505, 37635.75340652466, 40508.24012851715, 41234.69342803955, 40368.39335769415, 42125.346742630005, 33537.20009243488, 37503.67998313904, 38666.24661874771, 42822.186715602875, 45410.15348434448, 42495.43336105347, 36420.69336628914, 37074.45330572128, 42423.69351196289, 45495.046702861786, 39034.333319664, 42857.84008407593, 41182.35324794054, 43534.2401638031, 43225.6333732605, 42996.22686290741, 47456.10655593872, 35626.52668762207, 35253.33330535889, 39474.0002014637, 41894.706773757935, 46206.78017425537, 42783.786657333374, 42702.57997608185, 40092.54019141197, 41254.76655483246, 41575.78668117523, 45489.113399505615, 44761.560170173645, 47335.24674987793, 45847.0601978302, 37304.80003273487, 45713.69330215454, 42742.46671581268, 44551.17992687225, 39266.700152397156, 45457.83364391327, 41128.64665222168, 41461.32002735138, 45733.17997837067, 37411.07349073887, 43346.25328683853, 42898.180006980896, 45281.379806518555, 40581.8600358963, 39416.646773815155, 43109.82665157318, 39826.94665622711, 38289.906502723694, 40261.366745233536, 42328.72669792175, 41045.3668050766, 34692.993297457695, 41255.14667749405, 44882.68008041382, 42401.09344291687, 41522.60663700104, 39741.05340766907, 34992.246790885925, 40818.246831297874, 40581.193343997, 46113.58672952652, 37699.380071640015, 45914.15999639034, 36947.24681043625, 39379.98006820679, 44102.01336288452, 43572.33352088928, 46237.23327255249, 40863.70678758621, 40858.93989801407, 31523.186655044556, 46206.419982910156, 40404.726786613464, 45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.17012501064461, "mean_inference_ms": 6.718212792841254, "mean_action_processing_ms": 0.20812464843027595, "mean_env_wait_ms": 232.5662129532846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06853226692445817, "StateBufferConnector_ms": 0.010578286263250535, "ViewRequirementAgentConnector_ms": 0.2054772069377284}}, "episode_reward_max": 48457.11329269409, "episode_reward_min": 31523.186655044556, "episode_reward_mean": 41831.292900026805, "episode_len_mean": 138.34677419354838, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 31523.186655044556}, "policy_reward_max": {"agent_0": 48457.11329269409}, "policy_reward_mean": {"agent_0": 41831.292900026805}, "hist_stats": {"episode_reward": [38236.57330989838, 44932.09351992607, 44082.38667535782, 36452.56013250351, 39607.69994544983, 41202.720052719116, 40794.27320289612, 42725.84670448303, 42968.74010848999, 47449.073221206665, 42548.69336891174, 41515.24680715799, 38165.20673751831, 43678.133400440216, 44755.540024757385, 43600.953411102295, 42146.40661025047, 41798.69346046448, 41357.50014305115, 44053.046866834164, 41519.96674442291, 41083.10022568703, 46872.779930114746, 37568.853387355804, 41743.37338447571, 43144.50685119629, 41436.933404922485, 41946.98006129265, 47091.506690979004, 39956.91330635548, 40026.813392043114, 43231.66009902954, 48457.11329269409, 41076.36002635956, 40464.76675605774, 43713.69337940216, 40108.859966278076, 42951.320039987564, 46476.17329978943, 40641.800088882446, 38785.05346775055, 43860.299974918365, 47154.153458595276, 47959.47328567505, 37635.75340652466, 40508.24012851715, 41234.69342803955, 40368.39335769415, 42125.346742630005, 33537.20009243488, 37503.67998313904, 38666.24661874771, 42822.186715602875, 45410.15348434448, 42495.43336105347, 36420.69336628914, 37074.45330572128, 42423.69351196289, 45495.046702861786, 39034.333319664, 42857.84008407593, 41182.35324794054, 43534.2401638031, 43225.6333732605, 42996.22686290741, 47456.10655593872, 35626.52668762207, 35253.33330535889, 39474.0002014637, 41894.706773757935, 46206.78017425537, 42783.786657333374, 42702.57997608185, 40092.54019141197, 41254.76655483246, 41575.78668117523, 45489.113399505615, 44761.560170173645, 47335.24674987793, 45847.0601978302, 37304.80003273487, 45713.69330215454, 42742.46671581268, 44551.17992687225, 39266.700152397156, 45457.83364391327, 41128.64665222168, 41461.32002735138, 45733.17997837067, 37411.07349073887, 43346.25328683853, 42898.180006980896, 45281.379806518555, 40581.8600358963, 39416.646773815155, 43109.82665157318, 39826.94665622711, 38289.906502723694, 40261.366745233536, 42328.72669792175, 41045.3668050766, 34692.993297457695, 41255.14667749405, 44882.68008041382, 42401.09344291687, 41522.60663700104, 39741.05340766907, 34992.246790885925, 40818.246831297874, 40581.193343997, 46113.58672952652, 37699.380071640015, 45914.15999639034, 36947.24681043625, 39379.98006820679, 44102.01336288452, 43572.33352088928, 46237.23327255249, 40863.70678758621, 40858.93989801407, 31523.186655044556, 46206.419982910156, 40404.726786613464, 45563.21350860596], "episode_lengths": [140, 138, 138, 139, 139, 139, 138, 138, 138, 139, 138, 139, 138, 139, 139, 138, 139, 138, 139, 138, 139, 137, 138, 139, 139, 140, 138, 138, 138, 138, 137, 139, 138, 138, 138, 139, 139, 138, 139, 137, 138, 138, 138, 138, 138, 138, 137, 139, 139, 139, 139, 138, 138, 139, 138, 138, 138, 138, 137, 138, 138, 138, 139, 139, 139, 138, 138, 138, 138, 138, 139, 139, 139, 138, 138, 139, 140, 138, 138, 138, 139, 138, 138, 137, 139, 137, 138, 138, 137, 139, 138, 138, 138, 138, 138, 139, 139, 138, 138, 139, 139, 139, 138, 139, 138, 139, 138, 139, 140, 139, 138, 138, 138, 139, 138, 138, 138, 139, 138, 138, 138, 139, 137, 139], "policy_agent_0_reward": [38236.57330989838, 44932.09351992607, 44082.38667535782, 36452.56013250351, 39607.69994544983, 41202.720052719116, 40794.27320289612, 42725.84670448303, 42968.74010848999, 47449.073221206665, 42548.69336891174, 41515.24680715799, 38165.20673751831, 43678.133400440216, 44755.540024757385, 43600.953411102295, 42146.40661025047, 41798.69346046448, 41357.50014305115, 44053.046866834164, 41519.96674442291, 41083.10022568703, 46872.779930114746, 37568.853387355804, 41743.37338447571, 43144.50685119629, 41436.933404922485, 41946.98006129265, 47091.506690979004, 39956.91330635548, 40026.813392043114, 43231.66009902954, 48457.11329269409, 41076.36002635956, 40464.76675605774, 43713.69337940216, 40108.859966278076, 42951.320039987564, 46476.17329978943, 40641.800088882446, 38785.05346775055, 43860.299974918365, 47154.153458595276, 47959.47328567505, 37635.75340652466, 40508.24012851715, 41234.69342803955, 40368.39335769415, 42125.346742630005, 33537.20009243488, 37503.67998313904, 38666.24661874771, 42822.186715602875, 45410.15348434448, 42495.43336105347, 36420.69336628914, 37074.45330572128, 42423.69351196289, 45495.046702861786, 39034.333319664, 42857.84008407593, 41182.35324794054, 43534.2401638031, 43225.6333732605, 42996.22686290741, 47456.10655593872, 35626.52668762207, 35253.33330535889, 39474.0002014637, 41894.706773757935, 46206.78017425537, 42783.786657333374, 42702.57997608185, 40092.54019141197, 41254.76655483246, 41575.78668117523, 45489.113399505615, 44761.560170173645, 47335.24674987793, 45847.0601978302, 37304.80003273487, 45713.69330215454, 42742.46671581268, 44551.17992687225, 39266.700152397156, 45457.83364391327, 41128.64665222168, 41461.32002735138, 45733.17997837067, 37411.07349073887, 43346.25328683853, 42898.180006980896, 45281.379806518555, 40581.8600358963, 39416.646773815155, 43109.82665157318, 39826.94665622711, 38289.906502723694, 40261.366745233536, 42328.72669792175, 41045.3668050766, 34692.993297457695, 41255.14667749405, 44882.68008041382, 42401.09344291687, 41522.60663700104, 39741.05340766907, 34992.246790885925, 40818.246831297874, 40581.193343997, 46113.58672952652, 37699.380071640015, 45914.15999639034, 36947.24681043625, 39379.98006820679, 44102.01336288452, 43572.33352088928, 46237.23327255249, 40863.70678758621, 40858.93989801407, 31523.186655044556, 46206.419982910156, 40404.726786613464, 45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.17012501064461, "mean_inference_ms": 6.718212792841254, "mean_action_processing_ms": 0.20812464843027595, "mean_env_wait_ms": 232.5662129532846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06853226692445817, "StateBufferConnector_ms": 0.010578286263250535, "ViewRequirementAgentConnector_ms": 0.2054772069377284}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.05507422426945, "num_env_steps_trained_throughput_per_sec": 199.05507422426945, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16161.736, "sample_time_ms": 12173.905, "learn_time_ms": 3816.074, "learn_throughput": 1048.198, "synch_weights_time_ms": 170.774}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 248, "training_iteration": 9, "trial_id": "185f8_00000", "date": "2025-03-21_11-46-53", "timestamp": 1742557613, "time_this_iter_s": 20.152010202407837, "time_total_s": 145.96446919441223, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 145.96446919441223, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 90.95172413793105, "ram_util_percent": 13.54827586206897}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982584953308105, "policy_loss": -0.02048543281853199, "vf_loss": 10.0, "vf_explained_var": -5.848705768585205e-07, "kl": 0.01535151805728674, "entropy": 1.201758623123169, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}}, "episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4773465901367, "num_env_steps_trained_throughput_per_sec": 292.4773465901367, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15913.178, "sample_time_ms": 11938.814, "learn_time_ms": 3807.315, "learn_throughput": 1050.609, "synch_weights_time_ms": 166.094}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 248, "training_iteration": 10, "trial_id": "185f8_00000", "date": "2025-03-21_11-47-07", "timestamp": 1742557627, "time_this_iter_s": 13.728352546691895, "time_total_s": 159.69282174110413, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 159.69282174110413, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.60000000000001, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986480712890625, "policy_loss": -0.01554431114345789, "vf_loss": 10.0, "vf_explained_var": -4.0382147403761337e-07, "kl": 0.010123618878424168, "entropy": 1.1644097566604614, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}}, "episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.7272363084884, "num_env_steps_trained_throughput_per_sec": 304.7272363084884, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 15101.031, "sample_time_ms": 11173.192, "learn_time_ms": 3751.378, "learn_throughput": 1066.275, "synch_weights_time_ms": 175.543}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 248, "training_iteration": 11, "trial_id": "185f8_00000", "date": "2025-03-21_11-47-20", "timestamp": 1742557640, "time_this_iter_s": 13.180711030960083, "time_total_s": 172.8735327720642, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0caf7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 172.8735327720642, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.59473684210528, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983272552490234, "policy_loss": -0.01631784439086914, "vf_loss": 9.99755859375, "vf_explained_var": -1.2765327994657127e-07, "kl": 0.010159481316804886, "entropy": 1.1310933828353882, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}}, "episode_reward_max": 45563.21350860596, "episode_reward_min": 45563.21350860596, "episode_reward_mean": 45563.21350860596, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45563.21350860596}, "policy_reward_max": {"agent_0": 45563.21350860596}, "policy_reward_mean": {"agent_0": 45563.21350860596}, "hist_stats": {"episode_reward": [45563.21350860596], "episode_lengths": [139], "policy_agent_0_reward": [45563.21350860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.47963269111607, "mean_inference_ms": 6.1305641715501835, "mean_action_processing_ms": 0.19285340622634625, "mean_env_wait_ms": 258.3687429197107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029802322387695312, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.12540817260742188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.83608558373834, "num_env_steps_trained_throughput_per_sec": 279.83608558373834, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15185.05, "sample_time_ms": 11237.081, "learn_time_ms": 3771.613, "learn_throughput": 1060.554, "synch_weights_time_ms": 175.436}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 248, "training_iteration": 12, "trial_id": "185f8_00000", "date": "2025-03-21_11-47-35", "timestamp": 1742557655, "time_this_iter_s": 14.353597164154053, "time_total_s": 187.22712993621826, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 187.22712993621826, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.44285714285715, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.683013916015625, "policy_loss": -0.017183732241392136, "vf_loss": 9.698246002197266, "vf_explained_var": 1.9508102866439003e-07, "kl": 0.009757299907505512, "entropy": 1.1046918630599976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 51091.180124759674, "episode_reward_min": 32716.393362998962, "episode_reward_mean": 44225.116099755134, "episode_len_mean": 137.88429752066116, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 32716.393362998962}, "policy_reward_max": {"agent_0": 51091.180124759674}, "policy_reward_mean": {"agent_0": 44225.116099755134}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [45859.246658325195, 46648.45339679718, 48199.15330505371, 45398.53330993652, 48596.04014015198, 32716.393362998962, 43859.893639564514, 42202.42688846588, 42585.16011238098, 39755.9667532444, 43653.606731414795, 44102.540125370026, 42711.50669503212, 41858.500056266785, 46688.91340684891, 42821.166657447815, 46383.99328041077, 46595.499957084656, 46887.333453178406, 47936.619985580444, 40835.82678413391, 38808.71332335472, 44164.48010921478, 50896.5866317749, 48175.27342605591, 41086.14670205116, 46462.42004299164, 38817.9134042263, 43286.320152282715, 45141.0534286499, 47826.31357574463, 42795.4734954834, 47168.70021915436, 48687.22017097473, 46493.66657447815, 40131.32005691528, 45376.00644445419, 44664.4335770607, 48207.76661682129, 47185.17324542999, 44523.40651512146, 44970.23992919922, 43573.83991622925, 47462.02656745911, 46095.033327937126, 36164.913427352905, 43382.98005437851, 38931.08654344082, 48890.99349784851, 43533.89339160919, 44292.22663021088, 40812.02004182339, 43300.773529052734, 46506.133350372314, 45661.04033088684, 41643.486696243286, 42278.89342498779, 44348.22011756897, 47385.03333616257, 43352.05335140228, 46375.64667892456, 46077.30672836304, 41076.76005363464, 45114.306659698486, 45692.56679916382, 47444.486689567566, 44775.98016643524, 43981.03351831436, 49104.42676925659, 42550.700145721436, 48033.393406391144, 43162.32673549652, 44601.51347541809, 38986.96003341675, 45474.153307914734, 43160.093563079834, 45199.34671831131, 46707.42683517933, 44676.84002685547, 43118.34668588638, 45136.633584976196, 41383.00670564175, 40171.12667751312, 45016.04010772705, 43955.30002117157, 43259.19331741333, 43751.95331954956, 51091.180124759674, 44953.88017272949, 46449.46004962921, 44652.93334150314, 39000.38691806793, 42998.02020549774, 46630.47344017029, 43090.893403053284, 39450.40020275116, 48083.039940834045, 43607.50014877319, 43824.720017910004, 42049.073369026184, 45715.093411028385, 42032.56676495075, 43570.68660581112, 47771.95347118378, 43254.6869007349, 44577.43320655823, 39669.58015489578, 43110.18026351929, 42419.72684288025, 45321.48685455322, 34683.160086631775, 44879.80683326721, 45896.033432006836, 39769.24669826031, 46919.29993724823, 49413.15997886658, 42532.033390045166, 47062.79327297211, 43404.5798368454, 47236.69338226318, 39349.96680402756], "episode_lengths": [138, 137, 138, 138, 137, 137, 138, 139, 136, 138, 138, 137, 137, 138, 137, 139, 139, 137, 138, 138, 139, 138, 137, 139, 138, 137, 138, 139, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 139, 138, 137, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 138, 137, 139, 138, 137, 139, 138, 138, 138, 138, 137, 137, 137, 138, 137, 137, 138, 138, 137, 138, 139, 139, 139, 138, 138, 138, 138, 139, 138, 138, 137, 138, 139, 137, 138, 137, 139, 138, 138, 138, 138, 137, 138, 138, 138, 138, 137, 137, 138, 138, 138, 137, 137, 139, 138, 138, 138, 137, 139, 139, 138, 138, 138, 138, 138, 138, 137], "policy_agent_0_reward": [45859.246658325195, 46648.45339679718, 48199.15330505371, 45398.53330993652, 48596.04014015198, 32716.393362998962, 43859.893639564514, 42202.42688846588, 42585.16011238098, 39755.9667532444, 43653.606731414795, 44102.540125370026, 42711.50669503212, 41858.500056266785, 46688.91340684891, 42821.166657447815, 46383.99328041077, 46595.499957084656, 46887.333453178406, 47936.619985580444, 40835.82678413391, 38808.71332335472, 44164.48010921478, 50896.5866317749, 48175.27342605591, 41086.14670205116, 46462.42004299164, 38817.9134042263, 43286.320152282715, 45141.0534286499, 47826.31357574463, 42795.4734954834, 47168.70021915436, 48687.22017097473, 46493.66657447815, 40131.32005691528, 45376.00644445419, 44664.4335770607, 48207.76661682129, 47185.17324542999, 44523.40651512146, 44970.23992919922, 43573.83991622925, 47462.02656745911, 46095.033327937126, 36164.913427352905, 43382.98005437851, 38931.08654344082, 48890.99349784851, 43533.89339160919, 44292.22663021088, 40812.02004182339, 43300.773529052734, 46506.133350372314, 45661.04033088684, 41643.486696243286, 42278.89342498779, 44348.22011756897, 47385.03333616257, 43352.05335140228, 46375.64667892456, 46077.30672836304, 41076.76005363464, 45114.306659698486, 45692.56679916382, 47444.486689567566, 44775.98016643524, 43981.03351831436, 49104.42676925659, 42550.700145721436, 48033.393406391144, 43162.32673549652, 44601.51347541809, 38986.96003341675, 45474.153307914734, 43160.093563079834, 45199.34671831131, 46707.42683517933, 44676.84002685547, 43118.34668588638, 45136.633584976196, 41383.00670564175, 40171.12667751312, 45016.04010772705, 43955.30002117157, 43259.19331741333, 43751.95331954956, 51091.180124759674, 44953.88017272949, 46449.46004962921, 44652.93334150314, 39000.38691806793, 42998.02020549774, 46630.47344017029, 43090.893403053284, 39450.40020275116, 48083.039940834045, 43607.50014877319, 43824.720017910004, 42049.073369026184, 45715.093411028385, 42032.56676495075, 43570.68660581112, 47771.95347118378, 43254.6869007349, 44577.43320655823, 39669.58015489578, 43110.18026351929, 42419.72684288025, 45321.48685455322, 34683.160086631775, 44879.80683326721, 45896.033432006836, 39769.24669826031, 46919.29993724823, 49413.15997886658, 42532.033390045166, 47062.79327297211, 43404.5798368454, 47236.69338226318, 39349.96680402756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.60087151245082, "mean_inference_ms": 6.696898200939571, "mean_action_processing_ms": 0.20890243666662892, "mean_env_wait_ms": 226.7839217947817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04758361942511945, "StateBufferConnector_ms": 0.009116653568488507, "ViewRequirementAgentConnector_ms": 0.20429161954517208}}, "episode_reward_max": 51091.180124759674, "episode_reward_min": 32716.393362998962, "episode_reward_mean": 44225.116099755134, "episode_len_mean": 137.88429752066116, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 32716.393362998962}, "policy_reward_max": {"agent_0": 51091.180124759674}, "policy_reward_mean": {"agent_0": 44225.116099755134}, "hist_stats": {"episode_reward": [45859.246658325195, 46648.45339679718, 48199.15330505371, 45398.53330993652, 48596.04014015198, 32716.393362998962, 43859.893639564514, 42202.42688846588, 42585.16011238098, 39755.9667532444, 43653.606731414795, 44102.540125370026, 42711.50669503212, 41858.500056266785, 46688.91340684891, 42821.166657447815, 46383.99328041077, 46595.499957084656, 46887.333453178406, 47936.619985580444, 40835.82678413391, 38808.71332335472, 44164.48010921478, 50896.5866317749, 48175.27342605591, 41086.14670205116, 46462.42004299164, 38817.9134042263, 43286.320152282715, 45141.0534286499, 47826.31357574463, 42795.4734954834, 47168.70021915436, 48687.22017097473, 46493.66657447815, 40131.32005691528, 45376.00644445419, 44664.4335770607, 48207.76661682129, 47185.17324542999, 44523.40651512146, 44970.23992919922, 43573.83991622925, 47462.02656745911, 46095.033327937126, 36164.913427352905, 43382.98005437851, 38931.08654344082, 48890.99349784851, 43533.89339160919, 44292.22663021088, 40812.02004182339, 43300.773529052734, 46506.133350372314, 45661.04033088684, 41643.486696243286, 42278.89342498779, 44348.22011756897, 47385.03333616257, 43352.05335140228, 46375.64667892456, 46077.30672836304, 41076.76005363464, 45114.306659698486, 45692.56679916382, 47444.486689567566, 44775.98016643524, 43981.03351831436, 49104.42676925659, 42550.700145721436, 48033.393406391144, 43162.32673549652, 44601.51347541809, 38986.96003341675, 45474.153307914734, 43160.093563079834, 45199.34671831131, 46707.42683517933, 44676.84002685547, 43118.34668588638, 45136.633584976196, 41383.00670564175, 40171.12667751312, 45016.04010772705, 43955.30002117157, 43259.19331741333, 43751.95331954956, 51091.180124759674, 44953.88017272949, 46449.46004962921, 44652.93334150314, 39000.38691806793, 42998.02020549774, 46630.47344017029, 43090.893403053284, 39450.40020275116, 48083.039940834045, 43607.50014877319, 43824.720017910004, 42049.073369026184, 45715.093411028385, 42032.56676495075, 43570.68660581112, 47771.95347118378, 43254.6869007349, 44577.43320655823, 39669.58015489578, 43110.18026351929, 42419.72684288025, 45321.48685455322, 34683.160086631775, 44879.80683326721, 45896.033432006836, 39769.24669826031, 46919.29993724823, 49413.15997886658, 42532.033390045166, 47062.79327297211, 43404.5798368454, 47236.69338226318, 39349.96680402756], "episode_lengths": [138, 137, 138, 138, 137, 137, 138, 139, 136, 138, 138, 137, 137, 138, 137, 139, 139, 137, 138, 138, 139, 138, 137, 139, 138, 137, 138, 139, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 139, 138, 137, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 138, 137, 139, 138, 137, 139, 138, 138, 138, 138, 137, 137, 137, 138, 137, 137, 138, 138, 137, 138, 139, 139, 139, 138, 138, 138, 138, 139, 138, 138, 137, 138, 139, 137, 138, 137, 139, 138, 138, 138, 138, 137, 138, 138, 138, 138, 137, 137, 138, 138, 138, 137, 137, 139, 138, 138, 138, 137, 139, 139, 138, 138, 138, 138, 138, 138, 137], "policy_agent_0_reward": [45859.246658325195, 46648.45339679718, 48199.15330505371, 45398.53330993652, 48596.04014015198, 32716.393362998962, 43859.893639564514, 42202.42688846588, 42585.16011238098, 39755.9667532444, 43653.606731414795, 44102.540125370026, 42711.50669503212, 41858.500056266785, 46688.91340684891, 42821.166657447815, 46383.99328041077, 46595.499957084656, 46887.333453178406, 47936.619985580444, 40835.82678413391, 38808.71332335472, 44164.48010921478, 50896.5866317749, 48175.27342605591, 41086.14670205116, 46462.42004299164, 38817.9134042263, 43286.320152282715, 45141.0534286499, 47826.31357574463, 42795.4734954834, 47168.70021915436, 48687.22017097473, 46493.66657447815, 40131.32005691528, 45376.00644445419, 44664.4335770607, 48207.76661682129, 47185.17324542999, 44523.40651512146, 44970.23992919922, 43573.83991622925, 47462.02656745911, 46095.033327937126, 36164.913427352905, 43382.98005437851, 38931.08654344082, 48890.99349784851, 43533.89339160919, 44292.22663021088, 40812.02004182339, 43300.773529052734, 46506.133350372314, 45661.04033088684, 41643.486696243286, 42278.89342498779, 44348.22011756897, 47385.03333616257, 43352.05335140228, 46375.64667892456, 46077.30672836304, 41076.76005363464, 45114.306659698486, 45692.56679916382, 47444.486689567566, 44775.98016643524, 43981.03351831436, 49104.42676925659, 42550.700145721436, 48033.393406391144, 43162.32673549652, 44601.51347541809, 38986.96003341675, 45474.153307914734, 43160.093563079834, 45199.34671831131, 46707.42683517933, 44676.84002685547, 43118.34668588638, 45136.633584976196, 41383.00670564175, 40171.12667751312, 45016.04010772705, 43955.30002117157, 43259.19331741333, 43751.95331954956, 51091.180124759674, 44953.88017272949, 46449.46004962921, 44652.93334150314, 39000.38691806793, 42998.02020549774, 46630.47344017029, 43090.893403053284, 39450.40020275116, 48083.039940834045, 43607.50014877319, 43824.720017910004, 42049.073369026184, 45715.093411028385, 42032.56676495075, 43570.68660581112, 47771.95347118378, 43254.6869007349, 44577.43320655823, 39669.58015489578, 43110.18026351929, 42419.72684288025, 45321.48685455322, 34683.160086631775, 44879.80683326721, 45896.033432006836, 39769.24669826031, 46919.29993724823, 49413.15997886658, 42532.033390045166, 47062.79327297211, 43404.5798368454, 47236.69338226318, 39349.96680402756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.60087151245082, "mean_inference_ms": 6.696898200939571, "mean_action_processing_ms": 0.20890243666662892, "mean_env_wait_ms": 226.7839217947817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04758361942511945, "StateBufferConnector_ms": 0.009116653568488507, "ViewRequirementAgentConnector_ms": 0.20429161954517208}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.42949672418223, "num_env_steps_trained_throughput_per_sec": 202.42949672418223, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 15770.124, "sample_time_ms": 11856.338, "learn_time_ms": 3745.495, "learn_throughput": 1067.95, "synch_weights_time_ms": 167.393}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 369, "training_iteration": 13, "trial_id": "185f8_00000", "date": "2025-03-21_11-47-55", "timestamp": 1742557675, "time_this_iter_s": 19.81547474861145, "time_total_s": 207.0426046848297, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81f30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 207.0426046848297, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 90.49230769230766, "ram_util_percent": 13.580769230769231}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.976346015930176, "policy_loss": -0.017952272668480873, "vf_loss": 9.992431640625, "vf_explained_var": 3.8333237739607284e-07, "kl": 0.009330661967396736, "entropy": 1.0897200107574463, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 47964.0934715271, "episode_reward_min": 36995.69993031025, "episode_reward_mean": 44153.17114897569, "episode_len_mean": 138.33333333333334, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 36995.69993031025}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 44153.17114897569}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [36995.69993031025, 47499.72004508972, 47964.0934715271], "episode_lengths": [138, 138, 139], "policy_agent_0_reward": [36995.69993031025, 47499.72004508972, 47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.73818594628825, "mean_inference_ms": 6.798199219622255, "mean_action_processing_ms": 0.2049024492701337, "mean_env_wait_ms": 225.6478380077223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03848870595296224, "StateBufferConnector_ms": 0.006333986918131511, "ViewRequirementAgentConnector_ms": 0.15982786814371744}}, "episode_reward_max": 47964.0934715271, "episode_reward_min": 36995.69993031025, "episode_reward_mean": 44153.17114897569, "episode_len_mean": 138.33333333333334, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 36995.69993031025}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 44153.17114897569}, "hist_stats": {"episode_reward": [36995.69993031025, 47499.72004508972, 47964.0934715271], "episode_lengths": [138, 138, 139], "policy_agent_0_reward": [36995.69993031025, 47499.72004508972, 47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.73818594628825, "mean_inference_ms": 6.798199219622255, "mean_action_processing_ms": 0.2049024492701337, "mean_env_wait_ms": 225.6478380077223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03848870595296224, "StateBufferConnector_ms": 0.006333986918131511, "ViewRequirementAgentConnector_ms": 0.15982786814371744}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.25885400772137, "num_env_steps_trained_throughput_per_sec": 297.25885400772137, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 15752.572, "sample_time_ms": 11831.531, "learn_time_ms": 3757.334, "learn_throughput": 1064.585, "synch_weights_time_ms": 162.832}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 372, "training_iteration": 14, "trial_id": "185f8_00000", "date": "2025-03-21_11-48-08", "timestamp": 1742557688, "time_this_iter_s": 13.512956380844116, "time_total_s": 220.55556106567383, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83b50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 220.55556106567383, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.485, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989084243774414, "policy_loss": -0.012636047787964344, "vf_loss": 10.0, "vf_explained_var": 5.420918114396045e-07, "kl": 0.00860039982944727, "entropy": 1.0657076835632324, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 47964.0934715271, "episode_reward_min": 47964.0934715271, "episode_reward_mean": 47964.0934715271, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47964.0934715271}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 47964.0934715271}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [47964.0934715271], "episode_lengths": [139], "policy_agent_0_reward": [47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.63194949908352, "mean_inference_ms": 7.164841505360762, "mean_action_processing_ms": 0.21237413707979538, "mean_env_wait_ms": 227.77296546307332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239082336425781, "StateBufferConnector_ms": 0.006556510925292969, "ViewRequirementAgentConnector_ms": 0.1737356185913086}}, "episode_reward_max": 47964.0934715271, "episode_reward_min": 47964.0934715271, "episode_reward_mean": 47964.0934715271, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47964.0934715271}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 47964.0934715271}, "hist_stats": {"episode_reward": [47964.0934715271], "episode_lengths": [139], "policy_agent_0_reward": [47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.63194949908352, "mean_inference_ms": 7.164841505360762, "mean_action_processing_ms": 0.21237413707979538, "mean_env_wait_ms": 227.77296546307332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239082336425781, "StateBufferConnector_ms": 0.006556510925292969, "ViewRequirementAgentConnector_ms": 0.1737356185913086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.3935260635494, "num_env_steps_trained_throughput_per_sec": 286.3935260635494, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14993.966, "sample_time_ms": 11074.413, "learn_time_ms": 3763.462, "learn_throughput": 1062.851, "synch_weights_time_ms": 155.256}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 372, "training_iteration": 15, "trial_id": "185f8_00000", "date": "2025-03-21_11-48-22", "timestamp": 1742557702, "time_this_iter_s": 14.024022817611694, "time_total_s": 234.57958388328552, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81cf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 234.57958388328552, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.475, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986209869384766, "policy_loss": -0.015546622686088085, "vf_loss": 10.0, "vf_explained_var": 4.276633376321115e-07, "kl": 0.008782384917140007, "entropy": 1.0496509075164795, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 47964.0934715271, "episode_reward_min": 47964.0934715271, "episode_reward_mean": 47964.0934715271, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47964.0934715271}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 47964.0934715271}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [47964.0934715271], "episode_lengths": [139], "policy_agent_0_reward": [47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.63194949908352, "mean_inference_ms": 7.164841505360762, "mean_action_processing_ms": 0.21237413707979538, "mean_env_wait_ms": 227.77296546307332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239082336425781, "StateBufferConnector_ms": 0.006556510925292969, "ViewRequirementAgentConnector_ms": 0.1737356185913086}}, "episode_reward_max": 47964.0934715271, "episode_reward_min": 47964.0934715271, "episode_reward_mean": 47964.0934715271, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47964.0934715271}, "policy_reward_max": {"agent_0": 47964.0934715271}, "policy_reward_mean": {"agent_0": 47964.0934715271}, "hist_stats": {"episode_reward": [47964.0934715271], "episode_lengths": [139], "policy_agent_0_reward": [47964.0934715271]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.63194949908352, "mean_inference_ms": 7.164841505360762, "mean_action_processing_ms": 0.21237413707979538, "mean_env_wait_ms": 227.77296546307332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04239082336425781, "StateBufferConnector_ms": 0.006556510925292969, "ViewRequirementAgentConnector_ms": 0.1737356185913086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.01236473371273, "num_env_steps_trained_throughput_per_sec": 299.01236473371273, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14927.016, "sample_time_ms": 11000.784, "learn_time_ms": 3770.096, "learn_throughput": 1060.981, "synch_weights_time_ms": 155.185}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 372, "training_iteration": 16, "trial_id": "185f8_00000", "date": "2025-03-21_11-48-36", "timestamp": 1742557716, "time_this_iter_s": 13.445075511932373, "time_total_s": 248.0246593952179, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b820e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 248.0246593952179, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 99.5578947368421, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.902767181396484, "policy_loss": -0.020370665937662125, "vf_loss": 9.920654296875, "vf_explained_var": 4.5361619527284347e-07, "kl": 0.01241594459861517, "entropy": 1.0112268924713135, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 51525.71356201172, "episode_reward_min": 39809.36015892029, "episode_reward_mean": 45209.74634444527, "episode_len_mean": 137.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 39809.36015892029}, "policy_reward_max": {"agent_0": 51525.71356201172}, "policy_reward_mean": {"agent_0": 45209.74634444527}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50057.460030555725, 43868.999994277954, 40569.126861572266, 44819.660067379475, 41688.846813201904, 44360.98002243042, 46102.88000011444, 43602.11330699921, 46481.42005825043, 48081.846672058105, 48530.63349533081, 44652.580030441284, 39818.27341079712, 47983.7934384346, 44107.44003868103, 49771.31997680664, 44512.15349769592, 44953.14022350311, 45551.12018966675, 44730.31332206726, 49504.56028306484, 41196.24673008919, 45085.11351490021, 46901.42667675018, 45046.353518247604, 44748.52008628845, 42844.226680755615, 46663.08680725098, 43365.70680260658, 45777.46675109863, 51525.71356201172, 39809.36015892029], "episode_lengths": [138, 137, 137, 137, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 137, 138, 137, 137, 137, 138, 137, 138, 138, 137, 137, 138, 137, 137, 138, 137, 137, 137], "policy_agent_0_reward": [50057.460030555725, 43868.999994277954, 40569.126861572266, 44819.660067379475, 41688.846813201904, 44360.98002243042, 46102.88000011444, 43602.11330699921, 46481.42005825043, 48081.846672058105, 48530.63349533081, 44652.580030441284, 39818.27341079712, 47983.7934384346, 44107.44003868103, 49771.31997680664, 44512.15349769592, 44953.14022350311, 45551.12018966675, 44730.31332206726, 49504.56028306484, 41196.24673008919, 45085.11351490021, 46901.42667675018, 45046.353518247604, 44748.52008628845, 42844.226680755615, 46663.08680725098, 43365.70680260658, 45777.46675109863, 51525.71356201172, 39809.36015892029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.8584609409244, "mean_inference_ms": 6.7555051416264735, "mean_action_processing_ms": 0.20950410873016007, "mean_env_wait_ms": 220.3476499646796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11527910828590393, "StateBufferConnector_ms": 0.00729486346244812, "ViewRequirementAgentConnector_ms": 0.18256530165672302}}, "episode_reward_max": 51525.71356201172, "episode_reward_min": 39809.36015892029, "episode_reward_mean": 45209.74634444527, "episode_len_mean": 137.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 39809.36015892029}, "policy_reward_max": {"agent_0": 51525.71356201172}, "policy_reward_mean": {"agent_0": 45209.74634444527}, "hist_stats": {"episode_reward": [50057.460030555725, 43868.999994277954, 40569.126861572266, 44819.660067379475, 41688.846813201904, 44360.98002243042, 46102.88000011444, 43602.11330699921, 46481.42005825043, 48081.846672058105, 48530.63349533081, 44652.580030441284, 39818.27341079712, 47983.7934384346, 44107.44003868103, 49771.31997680664, 44512.15349769592, 44953.14022350311, 45551.12018966675, 44730.31332206726, 49504.56028306484, 41196.24673008919, 45085.11351490021, 46901.42667675018, 45046.353518247604, 44748.52008628845, 42844.226680755615, 46663.08680725098, 43365.70680260658, 45777.46675109863, 51525.71356201172, 39809.36015892029], "episode_lengths": [138, 137, 137, 137, 138, 138, 138, 138, 138, 138, 138, 138, 138, 137, 137, 138, 137, 137, 137, 138, 137, 138, 138, 137, 137, 138, 137, 137, 138, 137, 137, 137], "policy_agent_0_reward": [50057.460030555725, 43868.999994277954, 40569.126861572266, 44819.660067379475, 41688.846813201904, 44360.98002243042, 46102.88000011444, 43602.11330699921, 46481.42005825043, 48081.846672058105, 48530.63349533081, 44652.580030441284, 39818.27341079712, 47983.7934384346, 44107.44003868103, 49771.31997680664, 44512.15349769592, 44953.14022350311, 45551.12018966675, 44730.31332206726, 49504.56028306484, 41196.24673008919, 45085.11351490021, 46901.42667675018, 45046.353518247604, 44748.52008628845, 42844.226680755615, 46663.08680725098, 43365.70680260658, 45777.46675109863, 51525.71356201172, 39809.36015892029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.8584609409244, "mean_inference_ms": 6.7555051416264735, "mean_action_processing_ms": 0.20950410873016007, "mean_env_wait_ms": 220.3476499646796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11527910828590393, "StateBufferConnector_ms": 0.00729486346244812, "ViewRequirementAgentConnector_ms": 0.18256530165672302}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.3708012628821, "num_env_steps_trained_throughput_per_sec": 258.3708012628821, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 15076.319, "sample_time_ms": 11152.117, "learn_time_ms": 3769.706, "learn_throughput": 1061.091, "synch_weights_time_ms": 153.564}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 404, "training_iteration": 17, "trial_id": "185f8_00000", "date": "2025-03-21_11-48-51", "timestamp": 1742557731, "time_this_iter_s": 15.535138607025146, "time_total_s": 263.55979800224304, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83a30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 263.55979800224304, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 99.43809523809526, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.771739130434782, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.747000694274902, "policy_loss": -0.01977125182747841, "vf_loss": 9.7646484375, "vf_explained_var": 1.7366060944823403e-07, "kl": 0.010613433085381985, "entropy": 0.9675487875938416, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 51993.90015411377, "episode_reward_min": 38550.74678206444, "episode_reward_mean": 45669.62152938221, "episode_len_mean": 137.47826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 38550.74678206444}, "policy_reward_max": {"agent_0": 51993.90015411377}, "policy_reward_mean": {"agent_0": 45669.62152938221}, "custom_metrics": {"num_batches_mean": 5.771739130434782, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [44568.020104289055, 40440.139949798584, 47088.60665130615, 46906.34005641937, 47404.793504714966, 41622.65332078934, 40032.07998466492, 49284.22011566162, 44058.6534986496, 40850.34682941437, 48976.226707458496, 44287.620178222656, 46113.25338745117, 44281.36658287048, 49067.96014022827, 45993.98686790466, 46641.74001312256, 45412.8466899395, 47953.46020317078, 38550.74678206444, 51993.90015411377, 48221.27336990833, 41802.873430252075, 49837.373494148254, 47654.926836013794, 42682.23349195719, 45682.91336154938, 50548.14653587341, 43696.39356803894, 44425.560099601746, 43404.21985912323, 46731.81347024441, 43123.44006252289, 44455.893466472626, 47624.486678123474, 43026.086681842804, 45822.56687438488, 44707.88663673401, 42917.63336443901, 43401.68681526184, 43855.78017234802, 45324.180099487305, 47611.57343375683, 40429.49341249466, 49239.31376647949, 51079.573375701904, 46431.43330860138, 45921.61344909668, 49428.600217819214, 45387.21329021454, 46500.74004936218, 47357.66011548042, 46571.433452129364, 48565.45334625244, 49830.33339250088, 44550.51995754242, 46879.57344818115, 45803.11339759827, 51372.37321662903, 41231.58671379089, 46288.28003978729, 45587.75339126587, 43817.22677898407, 45617.48671537638, 43355.04676532745, 43798.80666446686, 49155.55342102051, 46229.80675697327, 41036.2134860754, 43561.50665283203, 41827.81344985962, 44912.54695940018, 43369.346727371216, 44577.54672050476, 44717.69329738617, 49592.24673652649, 46070.48012924194, 48264.18677902222, 44632.57346057892, 41176.773438453674, 47722.06002998352, 48194.906851768494, 47896.14669418335, 49319.44681739807, 45808.49350118637, 51040.64673614502, 42040.77328300476, 50047.50008392334, 42355.93330574036, 40835.82003879547, 45959.70673751831, 48126.926818847656], "episode_lengths": [137, 137, 138, 138, 138, 137, 138, 138, 137, 139, 138, 137, 138, 138, 137, 137, 137, 137, 138, 138, 138, 137, 137, 137, 138, 138, 137, 137, 138, 138, 137, 137, 137, 137, 138, 137, 137, 138, 137, 137, 138, 138, 137, 138, 137, 137, 138, 138, 136, 137, 137, 137, 137, 138, 138, 137, 138, 138, 138, 137, 137, 137, 138, 137, 136, 137, 138, 137, 137, 137, 138, 138, 138, 138, 136, 138, 138, 137, 137, 138, 139, 138, 138, 137, 138, 138, 138, 137, 138, 138, 137, 137], "policy_agent_0_reward": [44568.020104289055, 40440.139949798584, 47088.60665130615, 46906.34005641937, 47404.793504714966, 41622.65332078934, 40032.07998466492, 49284.22011566162, 44058.6534986496, 40850.34682941437, 48976.226707458496, 44287.620178222656, 46113.25338745117, 44281.36658287048, 49067.96014022827, 45993.98686790466, 46641.74001312256, 45412.8466899395, 47953.46020317078, 38550.74678206444, 51993.90015411377, 48221.27336990833, 41802.873430252075, 49837.373494148254, 47654.926836013794, 42682.23349195719, 45682.91336154938, 50548.14653587341, 43696.39356803894, 44425.560099601746, 43404.21985912323, 46731.81347024441, 43123.44006252289, 44455.893466472626, 47624.486678123474, 43026.086681842804, 45822.56687438488, 44707.88663673401, 42917.63336443901, 43401.68681526184, 43855.78017234802, 45324.180099487305, 47611.57343375683, 40429.49341249466, 49239.31376647949, 51079.573375701904, 46431.43330860138, 45921.61344909668, 49428.600217819214, 45387.21329021454, 46500.74004936218, 47357.66011548042, 46571.433452129364, 48565.45334625244, 49830.33339250088, 44550.51995754242, 46879.57344818115, 45803.11339759827, 51372.37321662903, 41231.58671379089, 46288.28003978729, 45587.75339126587, 43817.22677898407, 45617.48671537638, 43355.04676532745, 43798.80666446686, 49155.55342102051, 46229.80675697327, 41036.2134860754, 43561.50665283203, 41827.81344985962, 44912.54695940018, 43369.346727371216, 44577.54672050476, 44717.69329738617, 49592.24673652649, 46070.48012924194, 48264.18677902222, 44632.57346057892, 41176.773438453674, 47722.06002998352, 48194.906851768494, 47896.14669418335, 49319.44681739807, 45808.49350118637, 51040.64673614502, 42040.77328300476, 50047.50008392334, 42355.93330574036, 40835.82003879547, 45959.70673751831, 48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.0143790662931, "mean_inference_ms": 6.744336483661972, "mean_action_processing_ms": 0.20826816846283996, "mean_env_wait_ms": 222.84246516851127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.48735685970472253, "StateBufferConnector_ms": 0.007621879162995711, "ViewRequirementAgentConnector_ms": 0.28336048126220703}}, "episode_reward_max": 51993.90015411377, "episode_reward_min": 38550.74678206444, "episode_reward_mean": 45669.62152938221, "episode_len_mean": 137.47826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 38550.74678206444}, "policy_reward_max": {"agent_0": 51993.90015411377}, "policy_reward_mean": {"agent_0": 45669.62152938221}, "hist_stats": {"episode_reward": [44568.020104289055, 40440.139949798584, 47088.60665130615, 46906.34005641937, 47404.793504714966, 41622.65332078934, 40032.07998466492, 49284.22011566162, 44058.6534986496, 40850.34682941437, 48976.226707458496, 44287.620178222656, 46113.25338745117, 44281.36658287048, 49067.96014022827, 45993.98686790466, 46641.74001312256, 45412.8466899395, 47953.46020317078, 38550.74678206444, 51993.90015411377, 48221.27336990833, 41802.873430252075, 49837.373494148254, 47654.926836013794, 42682.23349195719, 45682.91336154938, 50548.14653587341, 43696.39356803894, 44425.560099601746, 43404.21985912323, 46731.81347024441, 43123.44006252289, 44455.893466472626, 47624.486678123474, 43026.086681842804, 45822.56687438488, 44707.88663673401, 42917.63336443901, 43401.68681526184, 43855.78017234802, 45324.180099487305, 47611.57343375683, 40429.49341249466, 49239.31376647949, 51079.573375701904, 46431.43330860138, 45921.61344909668, 49428.600217819214, 45387.21329021454, 46500.74004936218, 47357.66011548042, 46571.433452129364, 48565.45334625244, 49830.33339250088, 44550.51995754242, 46879.57344818115, 45803.11339759827, 51372.37321662903, 41231.58671379089, 46288.28003978729, 45587.75339126587, 43817.22677898407, 45617.48671537638, 43355.04676532745, 43798.80666446686, 49155.55342102051, 46229.80675697327, 41036.2134860754, 43561.50665283203, 41827.81344985962, 44912.54695940018, 43369.346727371216, 44577.54672050476, 44717.69329738617, 49592.24673652649, 46070.48012924194, 48264.18677902222, 44632.57346057892, 41176.773438453674, 47722.06002998352, 48194.906851768494, 47896.14669418335, 49319.44681739807, 45808.49350118637, 51040.64673614502, 42040.77328300476, 50047.50008392334, 42355.93330574036, 40835.82003879547, 45959.70673751831, 48126.926818847656], "episode_lengths": [137, 137, 138, 138, 138, 137, 138, 138, 137, 139, 138, 137, 138, 138, 137, 137, 137, 137, 138, 138, 138, 137, 137, 137, 138, 138, 137, 137, 138, 138, 137, 137, 137, 137, 138, 137, 137, 138, 137, 137, 138, 138, 137, 138, 137, 137, 138, 138, 136, 137, 137, 137, 137, 138, 138, 137, 138, 138, 138, 137, 137, 137, 138, 137, 136, 137, 138, 137, 137, 137, 138, 138, 138, 138, 136, 138, 138, 137, 137, 138, 139, 138, 138, 137, 138, 138, 138, 137, 138, 138, 137, 137], "policy_agent_0_reward": [44568.020104289055, 40440.139949798584, 47088.60665130615, 46906.34005641937, 47404.793504714966, 41622.65332078934, 40032.07998466492, 49284.22011566162, 44058.6534986496, 40850.34682941437, 48976.226707458496, 44287.620178222656, 46113.25338745117, 44281.36658287048, 49067.96014022827, 45993.98686790466, 46641.74001312256, 45412.8466899395, 47953.46020317078, 38550.74678206444, 51993.90015411377, 48221.27336990833, 41802.873430252075, 49837.373494148254, 47654.926836013794, 42682.23349195719, 45682.91336154938, 50548.14653587341, 43696.39356803894, 44425.560099601746, 43404.21985912323, 46731.81347024441, 43123.44006252289, 44455.893466472626, 47624.486678123474, 43026.086681842804, 45822.56687438488, 44707.88663673401, 42917.63336443901, 43401.68681526184, 43855.78017234802, 45324.180099487305, 47611.57343375683, 40429.49341249466, 49239.31376647949, 51079.573375701904, 46431.43330860138, 45921.61344909668, 49428.600217819214, 45387.21329021454, 46500.74004936218, 47357.66011548042, 46571.433452129364, 48565.45334625244, 49830.33339250088, 44550.51995754242, 46879.57344818115, 45803.11339759827, 51372.37321662903, 41231.58671379089, 46288.28003978729, 45587.75339126587, 43817.22677898407, 45617.48671537638, 43355.04676532745, 43798.80666446686, 49155.55342102051, 46229.80675697327, 41036.2134860754, 43561.50665283203, 41827.81344985962, 44912.54695940018, 43369.346727371216, 44577.54672050476, 44717.69329738617, 49592.24673652649, 46070.48012924194, 48264.18677902222, 44632.57346057892, 41176.773438453674, 47722.06002998352, 48194.906851768494, 47896.14669418335, 49319.44681739807, 45808.49350118637, 51040.64673614502, 42040.77328300476, 50047.50008392334, 42355.93330574036, 40835.82003879547, 45959.70673751831, 48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.0143790662931, "mean_inference_ms": 6.744336483661972, "mean_action_processing_ms": 0.20826816846283996, "mean_env_wait_ms": 222.84246516851127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.48735685970472253, "StateBufferConnector_ms": 0.007621879162995711, "ViewRequirementAgentConnector_ms": 0.28336048126220703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.46026881289805, "num_env_steps_trained_throughput_per_sec": 210.46026881289805, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 15623.91, "sample_time_ms": 11704.266, "learn_time_ms": 3763.823, "learn_throughput": 1062.749, "synch_weights_time_ms": 154.904}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 496, "training_iteration": 18, "trial_id": "185f8_00000", "date": "2025-03-21_11-49-11", "timestamp": 1742557751, "time_this_iter_s": 19.075762271881104, "time_total_s": 282.63556027412415, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 282.63556027412415, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 95.2423076923077, "ram_util_percent": 13.565384615384618}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986496925354004, "policy_loss": -0.015431242063641548, "vf_loss": 10.0, "vf_explained_var": 4.1387974647477677e-07, "kl": 0.009638790972530842, "entropy": 0.9217385649681091, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 48126.926818847656, "episode_reward_min": 48126.926818847656, "episode_reward_mean": 48126.926818847656, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48126.926818847656}, "policy_reward_max": {"agent_0": 48126.926818847656}, "policy_reward_mean": {"agent_0": 48126.926818847656}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48126.926818847656], "episode_lengths": [137], "policy_agent_0_reward": [48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.077304678112014, "mean_inference_ms": 6.4214325447016405, "mean_action_processing_ms": 0.21528536566828524, "mean_env_wait_ms": 228.0329182821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04591941833496094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.1798391342163086}}, "episode_reward_max": 48126.926818847656, "episode_reward_min": 48126.926818847656, "episode_reward_mean": 48126.926818847656, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48126.926818847656}, "policy_reward_max": {"agent_0": 48126.926818847656}, "policy_reward_mean": {"agent_0": 48126.926818847656}, "hist_stats": {"episode_reward": [48126.926818847656], "episode_lengths": [137], "policy_agent_0_reward": [48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.077304678112014, "mean_inference_ms": 6.4214325447016405, "mean_action_processing_ms": 0.21528536566828524, "mean_env_wait_ms": 228.0329182821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04591941833496094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.1798391342163086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.46356687507205, "num_env_steps_trained_throughput_per_sec": 281.46356687507205, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 15035.561, "sample_time_ms": 11068.838, "learn_time_ms": 3820.832, "learn_throughput": 1046.892, "synch_weights_time_ms": 144.979}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 496, "training_iteration": 19, "trial_id": "185f8_00000", "date": "2025-03-21_11-49-25", "timestamp": 1742557765, "time_this_iter_s": 14.257726192474365, "time_total_s": 296.8932864665985, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 296.8932864665985, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.55500000000002, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988056182861328, "policy_loss": -0.013820097781717777, "vf_loss": 10.0, "vf_explained_var": -1.2417634698280722e-09, "kl": 0.00938490405678749, "entropy": 0.8963848352432251, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 48126.926818847656, "episode_reward_min": 48126.926818847656, "episode_reward_mean": 48126.926818847656, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48126.926818847656}, "policy_reward_max": {"agent_0": 48126.926818847656}, "policy_reward_mean": {"agent_0": 48126.926818847656}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48126.926818847656], "episode_lengths": [137], "policy_agent_0_reward": [48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.077304678112014, "mean_inference_ms": 6.4214325447016405, "mean_action_processing_ms": 0.21528536566828524, "mean_env_wait_ms": 228.0329182821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04591941833496094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.1798391342163086}}, "episode_reward_max": 48126.926818847656, "episode_reward_min": 48126.926818847656, "episode_reward_mean": 48126.926818847656, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48126.926818847656}, "policy_reward_max": {"agent_0": 48126.926818847656}, "policy_reward_mean": {"agent_0": 48126.926818847656}, "hist_stats": {"episode_reward": [48126.926818847656], "episode_lengths": [137], "policy_agent_0_reward": [48126.926818847656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.077304678112014, "mean_inference_ms": 6.4214325447016405, "mean_action_processing_ms": 0.21528536566828524, "mean_env_wait_ms": 228.0329182821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04591941833496094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.1798391342163086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.1187826443903, "num_env_steps_trained_throughput_per_sec": 267.1187826443903, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15165.399, "sample_time_ms": 11154.081, "learn_time_ms": 3859.91, "learn_throughput": 1036.294, "synch_weights_time_ms": 150.433}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 496, "training_iteration": 20, "trial_id": "185f8_00000", "date": "2025-03-21_11-49-40", "timestamp": 1742557780, "time_this_iter_s": 15.02933120727539, "time_total_s": 311.9226176738739, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81e10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 311.9226176738739, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 99.51818181818184, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.907207489013672, "policy_loss": -0.01292483787983656, "vf_loss": 9.918212890625, "vf_explained_var": 2.179294789073083e-08, "kl": 0.009590769186615944, "entropy": 0.8719877600669861, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 50419.319969177246, "episode_reward_min": 40634.36007857323, "episode_reward_mean": 46701.05548872147, "episode_len_mean": 137.1875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 40634.36007857323}, "policy_reward_max": {"agent_0": 50419.319969177246}, "policy_reward_mean": {"agent_0": 46701.05548872147}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47785.22027015686, 46342.23354101181, 45562.85349273682, 46450.44001200795, 49560.626831531525, 49929.08000469208, 50310.266860961914, 50419.319969177246, 47359.56656265259, 44523.94013595581, 43503.2799282074, 49824.140281677246, 50176.873416900635, 40634.36007857323, 50395.40665817261, 41950.11340522766, 49324.33346557617, 45197.83333802223, 47070.026779174805, 49962.9933052063, 50209.02674293518, 49766.220153808594, 42522.35323524475, 40976.50672531128, 41236.7467212677, 46970.606669425964, 42760.820088386536, 49620.9469127655, 43513.35340118408, 48468.40671539307, 45612.326679229736, 46493.55325651169], "episode_lengths": [137, 138, 138, 137, 137, 138, 137, 137, 137, 137, 137, 137, 138, 137, 138, 137, 137, 137, 137, 136, 138, 137, 137, 138, 137, 137, 137, 138, 137, 137, 136, 137], "policy_agent_0_reward": [47785.22027015686, 46342.23354101181, 45562.85349273682, 46450.44001200795, 49560.626831531525, 49929.08000469208, 50310.266860961914, 50419.319969177246, 47359.56656265259, 44523.94013595581, 43503.2799282074, 49824.140281677246, 50176.873416900635, 40634.36007857323, 50395.40665817261, 41950.11340522766, 49324.33346557617, 45197.83333802223, 47070.026779174805, 49962.9933052063, 50209.02674293518, 49766.220153808594, 42522.35323524475, 40976.50672531128, 41236.7467212677, 46970.606669425964, 42760.820088386536, 49620.9469127655, 43513.35340118408, 48468.40671539307, 45612.326679229736, 46493.55325651169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.564679168572685, "mean_inference_ms": 6.635077179594754, "mean_action_processing_ms": 0.20936052033124808, "mean_env_wait_ms": 216.5033429517526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0742502510547638, "StateBufferConnector_ms": 0.0073753297328948975, "ViewRequirementAgentConnector_ms": 0.21130889654159546}}, "episode_reward_max": 50419.319969177246, "episode_reward_min": 40634.36007857323, "episode_reward_mean": 46701.05548872147, "episode_len_mean": 137.1875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 40634.36007857323}, "policy_reward_max": {"agent_0": 50419.319969177246}, "policy_reward_mean": {"agent_0": 46701.05548872147}, "hist_stats": {"episode_reward": [47785.22027015686, 46342.23354101181, 45562.85349273682, 46450.44001200795, 49560.626831531525, 49929.08000469208, 50310.266860961914, 50419.319969177246, 47359.56656265259, 44523.94013595581, 43503.2799282074, 49824.140281677246, 50176.873416900635, 40634.36007857323, 50395.40665817261, 41950.11340522766, 49324.33346557617, 45197.83333802223, 47070.026779174805, 49962.9933052063, 50209.02674293518, 49766.220153808594, 42522.35323524475, 40976.50672531128, 41236.7467212677, 46970.606669425964, 42760.820088386536, 49620.9469127655, 43513.35340118408, 48468.40671539307, 45612.326679229736, 46493.55325651169], "episode_lengths": [137, 138, 138, 137, 137, 138, 137, 137, 137, 137, 137, 137, 138, 137, 138, 137, 137, 137, 137, 136, 138, 137, 137, 138, 137, 137, 137, 138, 137, 137, 136, 137], "policy_agent_0_reward": [47785.22027015686, 46342.23354101181, 45562.85349273682, 46450.44001200795, 49560.626831531525, 49929.08000469208, 50310.266860961914, 50419.319969177246, 47359.56656265259, 44523.94013595581, 43503.2799282074, 49824.140281677246, 50176.873416900635, 40634.36007857323, 50395.40665817261, 41950.11340522766, 49324.33346557617, 45197.83333802223, 47070.026779174805, 49962.9933052063, 50209.02674293518, 49766.220153808594, 42522.35323524475, 40976.50672531128, 41236.7467212677, 46970.606669425964, 42760.820088386536, 49620.9469127655, 43513.35340118408, 48468.40671539307, 45612.326679229736, 46493.55325651169]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.564679168572685, "mean_inference_ms": 6.635077179594754, "mean_action_processing_ms": 0.20936052033124808, "mean_env_wait_ms": 216.5033429517526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0742502510547638, "StateBufferConnector_ms": 0.0073753297328948975, "ViewRequirementAgentConnector_ms": 0.21130889654159546}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.7030819151526, "num_env_steps_trained_throughput_per_sec": 256.7030819151526, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 15410.97, "sample_time_ms": 11388.786, "learn_time_ms": 3879.14, "learn_throughput": 1031.156, "synch_weights_time_ms": 142.026}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 528, "training_iteration": 21, "trial_id": "185f8_00000", "date": "2025-03-21_11-49-56", "timestamp": 1742557796, "time_this_iter_s": 15.625405311584473, "time_total_s": 327.5480229854584, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b829e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 327.5480229854584, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 99.33809523809524, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.751384735107422, "policy_loss": -0.01885477639734745, "vf_loss": 9.76806640625, "vf_explained_var": 2.4338563164860716e-08, "kl": 0.010862692259252071, "entropy": 0.8309163451194763, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 54705.18000411987, "episode_reward_min": 35261.8066778779, "episode_reward_mean": 47427.58775040378, "episode_len_mean": 136.94565217391303, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 35261.8066778779}, "policy_reward_max": {"agent_0": 54705.18000411987}, "policy_reward_mean": {"agent_0": 47427.58775040378}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51909.08679199219, 48529.279970645905, 48039.74668979645, 42994.946838378906, 47448.55357837677, 38800.48003959656, 35261.8066778779, 49980.27347564697, 53307.940346717834, 49759.38660812378, 50507.593457102776, 46984.800075531006, 47556.76008987427, 52287.82674789429, 45809.239963531494, 49024.553313314915, 48397.526695251465, 48123.4332818985, 46065.06681370735, 44387.05332279205, 49221.480038166046, 50973.75357913971, 46225.140117645264, 47073.64669418335, 46751.487027168274, 50052.24013328552, 43450.73333930969, 50969.83357048035, 49368.560084581375, 47382.693313121796, 42162.76004362106, 45586.6331717968, 47615.25339317322, 51430.10023880005, 52622.27341461182, 47608.313558101654, 39411.713512420654, 48859.13315200806, 52862.6135559082, 49270.2001953125, 43077.47994232178, 47643.88669204712, 44949.506715774536, 47942.47344875336, 48021.773445129395, 47883.94664001465, 51172.09327316284, 45347.72014760971, 46389.48665237427, 47129.919940948486, 48655.18678474426, 49244.00660896301, 46731.47333884239, 43007.4333190918, 47714.39334774017, 46025.64006900787, 49812.07318031788, 47247.79351687431, 49531.453592300415, 39085.419951438904, 52436.06671357155, 47039.546739935875, 46771.46000289917, 46232.180028915405, 51505.16681289673, 47836.700026512146, 40064.67995977402, 46142.50012397766, 45821.60667037964, 44306.68689131737, 45257.21332359314, 45771.980251312256, 46158.07991027832, 52952.186571121216, 52118.35336303711, 41800.43333053589, 51350.473361968994, 43797.51342582703, 49569.03345108032, 48302.11362743378, 47319.31342458725, 41405.06011080742, 42666.04017448425, 52021.80685424805, 47291.053480148315, 54705.18000411987, 49406.36672210693, 47113.82010555267, 47023.07335853577, 50652.800148010254, 48731.213386535645, 49081.29316329956], "episode_lengths": [137, 136, 138, 137, 137, 137, 137, 138, 137, 138, 137, 137, 136, 136, 137, 138, 137, 136, 138, 137, 137, 136, 138, 137, 137, 137, 138, 137, 137, 136, 137, 138, 137, 137, 137, 137, 138, 137, 137, 137, 136, 137, 137, 137, 138, 137, 137, 137, 137, 136, 136, 137, 137, 137, 136, 137, 137, 137, 136, 137, 137, 137, 136, 137, 137, 138, 137, 137, 137, 136, 137, 137, 137, 137, 136, 137, 136, 137, 137, 136, 137, 138, 137, 137, 136, 137, 137, 138, 137, 136, 137, 137], "policy_agent_0_reward": [51909.08679199219, 48529.279970645905, 48039.74668979645, 42994.946838378906, 47448.55357837677, 38800.48003959656, 35261.8066778779, 49980.27347564697, 53307.940346717834, 49759.38660812378, 50507.593457102776, 46984.800075531006, 47556.76008987427, 52287.82674789429, 45809.239963531494, 49024.553313314915, 48397.526695251465, 48123.4332818985, 46065.06681370735, 44387.05332279205, 49221.480038166046, 50973.75357913971, 46225.140117645264, 47073.64669418335, 46751.487027168274, 50052.24013328552, 43450.73333930969, 50969.83357048035, 49368.560084581375, 47382.693313121796, 42162.76004362106, 45586.6331717968, 47615.25339317322, 51430.10023880005, 52622.27341461182, 47608.313558101654, 39411.713512420654, 48859.13315200806, 52862.6135559082, 49270.2001953125, 43077.47994232178, 47643.88669204712, 44949.506715774536, 47942.47344875336, 48021.773445129395, 47883.94664001465, 51172.09327316284, 45347.72014760971, 46389.48665237427, 47129.919940948486, 48655.18678474426, 49244.00660896301, 46731.47333884239, 43007.4333190918, 47714.39334774017, 46025.64006900787, 49812.07318031788, 47247.79351687431, 49531.453592300415, 39085.419951438904, 52436.06671357155, 47039.546739935875, 46771.46000289917, 46232.180028915405, 51505.16681289673, 47836.700026512146, 40064.67995977402, 46142.50012397766, 45821.60667037964, 44306.68689131737, 45257.21332359314, 45771.980251312256, 46158.07991027832, 52952.186571121216, 52118.35336303711, 41800.43333053589, 51350.473361968994, 43797.51342582703, 49569.03345108032, 48302.11362743378, 47319.31342458725, 41405.06011080742, 42666.04017448425, 52021.80685424805, 47291.053480148315, 54705.18000411987, 49406.36672210693, 47113.82010555267, 47023.07335853577, 50652.800148010254, 48731.213386535645, 49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.71804659549667, "mean_inference_ms": 6.733829538431794, "mean_action_processing_ms": 0.20823178745661478, "mean_env_wait_ms": 222.77077683467317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05601359450298807, "StateBufferConnector_ms": 0.007302605587503184, "ViewRequirementAgentConnector_ms": 0.22362522456956946}}, "episode_reward_max": 54705.18000411987, "episode_reward_min": 35261.8066778779, "episode_reward_mean": 47427.58775040378, "episode_len_mean": 136.94565217391303, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 35261.8066778779}, "policy_reward_max": {"agent_0": 54705.18000411987}, "policy_reward_mean": {"agent_0": 47427.58775040378}, "hist_stats": {"episode_reward": [51909.08679199219, 48529.279970645905, 48039.74668979645, 42994.946838378906, 47448.55357837677, 38800.48003959656, 35261.8066778779, 49980.27347564697, 53307.940346717834, 49759.38660812378, 50507.593457102776, 46984.800075531006, 47556.76008987427, 52287.82674789429, 45809.239963531494, 49024.553313314915, 48397.526695251465, 48123.4332818985, 46065.06681370735, 44387.05332279205, 49221.480038166046, 50973.75357913971, 46225.140117645264, 47073.64669418335, 46751.487027168274, 50052.24013328552, 43450.73333930969, 50969.83357048035, 49368.560084581375, 47382.693313121796, 42162.76004362106, 45586.6331717968, 47615.25339317322, 51430.10023880005, 52622.27341461182, 47608.313558101654, 39411.713512420654, 48859.13315200806, 52862.6135559082, 49270.2001953125, 43077.47994232178, 47643.88669204712, 44949.506715774536, 47942.47344875336, 48021.773445129395, 47883.94664001465, 51172.09327316284, 45347.72014760971, 46389.48665237427, 47129.919940948486, 48655.18678474426, 49244.00660896301, 46731.47333884239, 43007.4333190918, 47714.39334774017, 46025.64006900787, 49812.07318031788, 47247.79351687431, 49531.453592300415, 39085.419951438904, 52436.06671357155, 47039.546739935875, 46771.46000289917, 46232.180028915405, 51505.16681289673, 47836.700026512146, 40064.67995977402, 46142.50012397766, 45821.60667037964, 44306.68689131737, 45257.21332359314, 45771.980251312256, 46158.07991027832, 52952.186571121216, 52118.35336303711, 41800.43333053589, 51350.473361968994, 43797.51342582703, 49569.03345108032, 48302.11362743378, 47319.31342458725, 41405.06011080742, 42666.04017448425, 52021.80685424805, 47291.053480148315, 54705.18000411987, 49406.36672210693, 47113.82010555267, 47023.07335853577, 50652.800148010254, 48731.213386535645, 49081.29316329956], "episode_lengths": [137, 136, 138, 137, 137, 137, 137, 138, 137, 138, 137, 137, 136, 136, 137, 138, 137, 136, 138, 137, 137, 136, 138, 137, 137, 137, 138, 137, 137, 136, 137, 138, 137, 137, 137, 137, 138, 137, 137, 137, 136, 137, 137, 137, 138, 137, 137, 137, 137, 136, 136, 137, 137, 137, 136, 137, 137, 137, 136, 137, 137, 137, 136, 137, 137, 138, 137, 137, 137, 136, 137, 137, 137, 137, 136, 137, 136, 137, 137, 136, 137, 138, 137, 137, 136, 137, 137, 138, 137, 136, 137, 137], "policy_agent_0_reward": [51909.08679199219, 48529.279970645905, 48039.74668979645, 42994.946838378906, 47448.55357837677, 38800.48003959656, 35261.8066778779, 49980.27347564697, 53307.940346717834, 49759.38660812378, 50507.593457102776, 46984.800075531006, 47556.76008987427, 52287.82674789429, 45809.239963531494, 49024.553313314915, 48397.526695251465, 48123.4332818985, 46065.06681370735, 44387.05332279205, 49221.480038166046, 50973.75357913971, 46225.140117645264, 47073.64669418335, 46751.487027168274, 50052.24013328552, 43450.73333930969, 50969.83357048035, 49368.560084581375, 47382.693313121796, 42162.76004362106, 45586.6331717968, 47615.25339317322, 51430.10023880005, 52622.27341461182, 47608.313558101654, 39411.713512420654, 48859.13315200806, 52862.6135559082, 49270.2001953125, 43077.47994232178, 47643.88669204712, 44949.506715774536, 47942.47344875336, 48021.773445129395, 47883.94664001465, 51172.09327316284, 45347.72014760971, 46389.48665237427, 47129.919940948486, 48655.18678474426, 49244.00660896301, 46731.47333884239, 43007.4333190918, 47714.39334774017, 46025.64006900787, 49812.07318031788, 47247.79351687431, 49531.453592300415, 39085.419951438904, 52436.06671357155, 47039.546739935875, 46771.46000289917, 46232.180028915405, 51505.16681289673, 47836.700026512146, 40064.67995977402, 46142.50012397766, 45821.60667037964, 44306.68689131737, 45257.21332359314, 45771.980251312256, 46158.07991027832, 52952.186571121216, 52118.35336303711, 41800.43333053589, 51350.473361968994, 43797.51342582703, 49569.03345108032, 48302.11362743378, 47319.31342458725, 41405.06011080742, 42666.04017448425, 52021.80685424805, 47291.053480148315, 54705.18000411987, 49406.36672210693, 47113.82010555267, 47023.07335853577, 50652.800148010254, 48731.213386535645, 49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.71804659549667, "mean_inference_ms": 6.733829538431794, "mean_action_processing_ms": 0.20823178745661478, "mean_env_wait_ms": 222.77077683467317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05601359450298807, "StateBufferConnector_ms": 0.007302605587503184, "ViewRequirementAgentConnector_ms": 0.22362522456956946}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.24061209028517, "num_env_steps_trained_throughput_per_sec": 203.24061209028517, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 15949.669, "sample_time_ms": 11902.183, "learn_time_ms": 3909.813, "learn_throughput": 1023.067, "synch_weights_time_ms": 136.611}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 620, "training_iteration": 22, "trial_id": "185f8_00000", "date": "2025-03-21_11-50-15", "timestamp": 1742557815, "time_this_iter_s": 19.74266266822815, "time_total_s": 347.2906856536865, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 347.2906856536865, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 94.5857142857143, "ram_util_percent": 13.585714285714289}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987462997436523, "policy_loss": -0.014358997344970703, "vf_loss": 10.0, "vf_explained_var": 3.979851825874903e-08, "kl": 0.009108812548220158, "entropy": 0.818127453327179, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 49081.29316329956, "episode_reward_min": 49081.29316329956, "episode_reward_mean": 49081.29316329956, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49081.29316329956}, "policy_reward_max": {"agent_0": 49081.29316329956}, "policy_reward_mean": {"agent_0": 49081.29316329956}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49081.29316329956], "episode_lengths": [137], "policy_agent_0_reward": [49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.45478672000534, "mean_inference_ms": 6.679722941513603, "mean_action_processing_ms": 0.21653209172242077, "mean_env_wait_ms": 229.98497131023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.007319450378417969, "ViewRequirementAgentConnector_ms": 0.18832683563232422}}, "episode_reward_max": 49081.29316329956, "episode_reward_min": 49081.29316329956, "episode_reward_mean": 49081.29316329956, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49081.29316329956}, "policy_reward_max": {"agent_0": 49081.29316329956}, "policy_reward_mean": {"agent_0": 49081.29316329956}, "hist_stats": {"episode_reward": [49081.29316329956], "episode_lengths": [137], "policy_agent_0_reward": [49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.45478672000534, "mean_inference_ms": 6.679722941513603, "mean_action_processing_ms": 0.21653209172242077, "mean_env_wait_ms": 229.98497131023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.007319450378417969, "ViewRequirementAgentConnector_ms": 0.18832683563232422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.2493142774939, "num_env_steps_trained_throughput_per_sec": 280.2493142774939, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 15400.976, "sample_time_ms": 11233.3, "learn_time_ms": 4017.799, "learn_throughput": 995.57, "synch_weights_time_ms": 148.847}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 620, "training_iteration": 23, "trial_id": "185f8_00000", "date": "2025-03-21_11-50-30", "timestamp": 1742557830, "time_this_iter_s": 14.358877658843994, "time_total_s": 361.6495633125305, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83b50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 361.6495633125305, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.51500000000001, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986858367919922, "policy_loss": -0.014833478257060051, "vf_loss": 10.0, "vf_explained_var": 4.4889748096466064e-07, "kl": 0.008456080220639706, "entropy": 0.7799208760261536, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 49081.29316329956, "episode_reward_min": 49081.29316329956, "episode_reward_mean": 49081.29316329956, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49081.29316329956}, "policy_reward_max": {"agent_0": 49081.29316329956}, "policy_reward_mean": {"agent_0": 49081.29316329956}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49081.29316329956], "episode_lengths": [137], "policy_agent_0_reward": [49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.45478672000534, "mean_inference_ms": 6.679722941513603, "mean_action_processing_ms": 0.21653209172242077, "mean_env_wait_ms": 229.98497131023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.007319450378417969, "ViewRequirementAgentConnector_ms": 0.18832683563232422}}, "episode_reward_max": 49081.29316329956, "episode_reward_min": 49081.29316329956, "episode_reward_mean": 49081.29316329956, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49081.29316329956}, "policy_reward_max": {"agent_0": 49081.29316329956}, "policy_reward_mean": {"agent_0": 49081.29316329956}, "hist_stats": {"episode_reward": [49081.29316329956], "episode_lengths": [137], "policy_agent_0_reward": [49081.29316329956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.45478672000534, "mean_inference_ms": 6.679722941513603, "mean_action_processing_ms": 0.21653209172242077, "mean_env_wait_ms": 229.98497131023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.007319450378417969, "ViewRequirementAgentConnector_ms": 0.18832683563232422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.1280519190581, "num_env_steps_trained_throughput_per_sec": 290.1280519190581, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15434.046, "sample_time_ms": 11200.511, "learn_time_ms": 4075.664, "learn_throughput": 981.435, "synch_weights_time_ms": 156.826}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 620, "training_iteration": 24, "trial_id": "185f8_00000", "date": "2025-03-21_11-50-44", "timestamp": 1742557844, "time_this_iter_s": 13.846796751022339, "time_total_s": 375.49636006355286, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 375.49636006355286, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.53500000000001, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.965795516967773, "policy_loss": -0.015576058067381382, "vf_loss": 9.9794921875, "vf_explained_var": -1.4466544406843695e-08, "kl": 0.00939901452511549, "entropy": 0.7907314300537109, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 52070.4200630188, "episode_reward_min": 46373.18669986725, "episode_reward_mean": 49004.279267430305, "episode_len_mean": 136.25, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 46373.18669986725}, "policy_reward_max": {"agent_0": 52070.4200630188}, "policy_reward_mean": {"agent_0": 49004.279267430305}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49314.106815338135, 47107.393451690674, 52070.4200630188, 46373.18669986725, 47572.65366744995, 49405.25993156433, 48704.52681541443, 51486.68669509888], "episode_lengths": [137, 137, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [49314.106815338135, 47107.393451690674, 52070.4200630188, 46373.18669986725, 47572.65366744995, 49405.25993156433, 48704.52681541443, 51486.68669509888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.65981704472918, "mean_inference_ms": 6.8648233829341265, "mean_action_processing_ms": 0.20862971466332314, "mean_env_wait_ms": 216.1499642863978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041988492012023926, "StateBufferConnector_ms": 0.007814168930053711, "ViewRequirementAgentConnector_ms": 0.2921551465988159}}, "episode_reward_max": 52070.4200630188, "episode_reward_min": 46373.18669986725, "episode_reward_mean": 49004.279267430305, "episode_len_mean": 136.25, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 46373.18669986725}, "policy_reward_max": {"agent_0": 52070.4200630188}, "policy_reward_mean": {"agent_0": 49004.279267430305}, "hist_stats": {"episode_reward": [49314.106815338135, 47107.393451690674, 52070.4200630188, 46373.18669986725, 47572.65366744995, 49405.25993156433, 48704.52681541443, 51486.68669509888], "episode_lengths": [137, 137, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [49314.106815338135, 47107.393451690674, 52070.4200630188, 46373.18669986725, 47572.65366744995, 49405.25993156433, 48704.52681541443, 51486.68669509888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.65981704472918, "mean_inference_ms": 6.8648233829341265, "mean_action_processing_ms": 0.20862971466332314, "mean_env_wait_ms": 216.1499642863978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041988492012023926, "StateBufferConnector_ms": 0.007814168930053711, "ViewRequirementAgentConnector_ms": 0.2921551465988159}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.94823872204137, "num_env_steps_trained_throughput_per_sec": 299.94823872204137, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 15370.93, "sample_time_ms": 11145.935, "learn_time_ms": 4068.616, "learn_throughput": 983.135, "synch_weights_time_ms": 155.335}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 628, "training_iteration": 25, "trial_id": "185f8_00000", "date": "2025-03-21_11-50-57", "timestamp": 1742557857, "time_this_iter_s": 13.391216516494751, "time_total_s": 388.8875765800476, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 388.8875765800476, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 98.28333333333335, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.206896551724138, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.699978828430176, "policy_loss": -0.011875650845468044, "vf_loss": 9.71044921875, "vf_explained_var": 1.1033068147980885e-07, "kl": 0.0070204464718699455, "entropy": 0.7675492763519287, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 54743.79998397827, "episode_reward_min": 36077.080134391785, "episode_reward_mean": 47989.94862155925, "episode_len_mean": 136.5948275862069, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {"agent_0": 36077.080134391785}, "policy_reward_max": {"agent_0": 54743.79998397827}, "policy_reward_mean": {"agent_0": 47989.94862155925}, "custom_metrics": {"num_batches_mean": 5.206896551724138, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53596.03360366821, 46978.12014770508, 45983.013301849365, 46559.746908187866, 48142.28687667847, 52064.34697341919, 43925.68667733669, 47187.439989089966, 50322.43367385864, 48396.039978027344, 49713.23329162598, 51422.17332839966, 43768.87332057953, 46018.4467754364, 51422.97367668152, 44278.48670196533, 43391.71997833252, 47828.06664991379, 51321.34684801102, 50733.04679298401, 48819.02003502846, 45780.04006910324, 51794.84714066982, 49669.84020841122, 47081.51997947693, 44559.066873550415, 42539.24692630768, 51278.326847076416, 46983.14701843262, 48540.18019104004, 47756.54011154175, 54203.30670928955, 49722.89340591431, 50093.71357727051, 42656.13356399536, 48084.64662361145, 49973.8667678833, 42136.66703224182, 43974.45352315903, 52464.373317718506, 46336.0132484436, 41327.43997001648, 52160.88667392731, 52786.6466217041, 49581.533420562744, 51428.57350540161, 45334.720180511475, 54743.79998397827, 45217.246900081635, 49891.10675621033, 45204.41346693039, 39494.63338184357, 48572.89344406128, 44328.71345901489, 43967.84661722183, 50524.140254974365, 47641.88688659668, 52546.10689163208, 53490.853481292725, 46257.253229141235, 49756.19353103638, 36077.080134391785, 50009.68011665344, 45502.29327774048, 50492.58688354492, 49663.38689613342, 47900.760190963745, 47468.08686542511, 52024.46027612686, 47198.260063409805, 48306.4401512146, 43931.0069065094, 51284.859938800335, 47738.40001678467, 46948.43993186951, 50168.37368619442, 47873.45365333557, 44689.900270462036, 51200.96021652222, 48462.526779174805, 50057.61353111267, 44498.986824035645, 49891.000186920166, 49500.01347923279, 49271.58013534546, 52242.96674823761, 44120.240263938904, 49344.83340072632, 45440.77346229553, 42639.32008075714, 49635.82018280029, 49279.62692642212, 44849.48003578186, 53658.0065536499, 40711.07991480827, 49765.9800195694, 49433.54025268555, 47953.559807777405, 49349.07321166992, 42138.41340768337, 49931.3602104187, 52059.76008796692, 43770.72681236267, 52125.533447265625, 48904.4934387207, 50259.953269958496, 49756.0400352478, 47043.713216781616, 44984.04664897919, 52312.14010620117, 52294.25339126587, 40724.860218048096, 45528.76004219055, 49885.7867269516, 52119.48032474518, 42652.02012300491], "episode_lengths": [136, 137, 137, 137, 136, 136, 136, 136, 137, 137, 137, 137, 137, 138, 137, 136, 137, 137, 137, 136, 138, 137, 136, 137, 136, 137, 137, 136, 137, 136, 137, 137, 137, 136, 137, 136, 137, 137, 136, 136, 136, 137, 136, 136, 137, 137, 137, 137, 136, 137, 137, 137, 138, 136, 136, 137, 137, 136, 136, 136, 135, 137, 136, 137, 137, 137, 137, 137, 136, 136, 137, 136, 138, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 137, 135, 137, 137, 136, 136, 137, 136, 137, 136, 137, 136, 137, 137, 136, 135, 137, 136, 137, 137, 137, 138, 136, 138, 137, 137, 136, 136, 137, 136, 135, 137], "policy_agent_0_reward": [53596.03360366821, 46978.12014770508, 45983.013301849365, 46559.746908187866, 48142.28687667847, 52064.34697341919, 43925.68667733669, 47187.439989089966, 50322.43367385864, 48396.039978027344, 49713.23329162598, 51422.17332839966, 43768.87332057953, 46018.4467754364, 51422.97367668152, 44278.48670196533, 43391.71997833252, 47828.06664991379, 51321.34684801102, 50733.04679298401, 48819.02003502846, 45780.04006910324, 51794.84714066982, 49669.84020841122, 47081.51997947693, 44559.066873550415, 42539.24692630768, 51278.326847076416, 46983.14701843262, 48540.18019104004, 47756.54011154175, 54203.30670928955, 49722.89340591431, 50093.71357727051, 42656.13356399536, 48084.64662361145, 49973.8667678833, 42136.66703224182, 43974.45352315903, 52464.373317718506, 46336.0132484436, 41327.43997001648, 52160.88667392731, 52786.6466217041, 49581.533420562744, 51428.57350540161, 45334.720180511475, 54743.79998397827, 45217.246900081635, 49891.10675621033, 45204.41346693039, 39494.63338184357, 48572.89344406128, 44328.71345901489, 43967.84661722183, 50524.140254974365, 47641.88688659668, 52546.10689163208, 53490.853481292725, 46257.253229141235, 49756.19353103638, 36077.080134391785, 50009.68011665344, 45502.29327774048, 50492.58688354492, 49663.38689613342, 47900.760190963745, 47468.08686542511, 52024.46027612686, 47198.260063409805, 48306.4401512146, 43931.0069065094, 51284.859938800335, 47738.40001678467, 46948.43993186951, 50168.37368619442, 47873.45365333557, 44689.900270462036, 51200.96021652222, 48462.526779174805, 50057.61353111267, 44498.986824035645, 49891.000186920166, 49500.01347923279, 49271.58013534546, 52242.96674823761, 44120.240263938904, 49344.83340072632, 45440.77346229553, 42639.32008075714, 49635.82018280029, 49279.62692642212, 44849.48003578186, 53658.0065536499, 40711.07991480827, 49765.9800195694, 49433.54025268555, 47953.559807777405, 49349.07321166992, 42138.41340768337, 49931.3602104187, 52059.76008796692, 43770.72681236267, 52125.533447265625, 48904.4934387207, 50259.953269958496, 49756.0400352478, 47043.713216781616, 44984.04664897919, 52312.14010620117, 52294.25339126587, 40724.860218048096, 45528.76004219055, 49885.7867269516, 52119.48032474518, 42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.23353201325303, "mean_inference_ms": 6.642088718281043, "mean_action_processing_ms": 0.2085422223215348, "mean_env_wait_ms": 222.4233424635337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05052336331071525, "StateBufferConnector_ms": 0.007246280538624731, "ViewRequirementAgentConnector_ms": 0.2585943402915165}}, "episode_reward_max": 54743.79998397827, "episode_reward_min": 36077.080134391785, "episode_reward_mean": 47989.94862155925, "episode_len_mean": 136.5948275862069, "episodes_this_iter": 116, "policy_reward_min": {"agent_0": 36077.080134391785}, "policy_reward_max": {"agent_0": 54743.79998397827}, "policy_reward_mean": {"agent_0": 47989.94862155925}, "hist_stats": {"episode_reward": [53596.03360366821, 46978.12014770508, 45983.013301849365, 46559.746908187866, 48142.28687667847, 52064.34697341919, 43925.68667733669, 47187.439989089966, 50322.43367385864, 48396.039978027344, 49713.23329162598, 51422.17332839966, 43768.87332057953, 46018.4467754364, 51422.97367668152, 44278.48670196533, 43391.71997833252, 47828.06664991379, 51321.34684801102, 50733.04679298401, 48819.02003502846, 45780.04006910324, 51794.84714066982, 49669.84020841122, 47081.51997947693, 44559.066873550415, 42539.24692630768, 51278.326847076416, 46983.14701843262, 48540.18019104004, 47756.54011154175, 54203.30670928955, 49722.89340591431, 50093.71357727051, 42656.13356399536, 48084.64662361145, 49973.8667678833, 42136.66703224182, 43974.45352315903, 52464.373317718506, 46336.0132484436, 41327.43997001648, 52160.88667392731, 52786.6466217041, 49581.533420562744, 51428.57350540161, 45334.720180511475, 54743.79998397827, 45217.246900081635, 49891.10675621033, 45204.41346693039, 39494.63338184357, 48572.89344406128, 44328.71345901489, 43967.84661722183, 50524.140254974365, 47641.88688659668, 52546.10689163208, 53490.853481292725, 46257.253229141235, 49756.19353103638, 36077.080134391785, 50009.68011665344, 45502.29327774048, 50492.58688354492, 49663.38689613342, 47900.760190963745, 47468.08686542511, 52024.46027612686, 47198.260063409805, 48306.4401512146, 43931.0069065094, 51284.859938800335, 47738.40001678467, 46948.43993186951, 50168.37368619442, 47873.45365333557, 44689.900270462036, 51200.96021652222, 48462.526779174805, 50057.61353111267, 44498.986824035645, 49891.000186920166, 49500.01347923279, 49271.58013534546, 52242.96674823761, 44120.240263938904, 49344.83340072632, 45440.77346229553, 42639.32008075714, 49635.82018280029, 49279.62692642212, 44849.48003578186, 53658.0065536499, 40711.07991480827, 49765.9800195694, 49433.54025268555, 47953.559807777405, 49349.07321166992, 42138.41340768337, 49931.3602104187, 52059.76008796692, 43770.72681236267, 52125.533447265625, 48904.4934387207, 50259.953269958496, 49756.0400352478, 47043.713216781616, 44984.04664897919, 52312.14010620117, 52294.25339126587, 40724.860218048096, 45528.76004219055, 49885.7867269516, 52119.48032474518, 42652.02012300491], "episode_lengths": [136, 137, 137, 137, 136, 136, 136, 136, 137, 137, 137, 137, 137, 138, 137, 136, 137, 137, 137, 136, 138, 137, 136, 137, 136, 137, 137, 136, 137, 136, 137, 137, 137, 136, 137, 136, 137, 137, 136, 136, 136, 137, 136, 136, 137, 137, 137, 137, 136, 137, 137, 137, 138, 136, 136, 137, 137, 136, 136, 136, 135, 137, 136, 137, 137, 137, 137, 137, 136, 136, 137, 136, 138, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 137, 135, 137, 137, 136, 136, 137, 136, 137, 136, 137, 136, 137, 137, 136, 135, 137, 136, 137, 137, 137, 138, 136, 138, 137, 137, 136, 136, 137, 136, 135, 137], "policy_agent_0_reward": [53596.03360366821, 46978.12014770508, 45983.013301849365, 46559.746908187866, 48142.28687667847, 52064.34697341919, 43925.68667733669, 47187.439989089966, 50322.43367385864, 48396.039978027344, 49713.23329162598, 51422.17332839966, 43768.87332057953, 46018.4467754364, 51422.97367668152, 44278.48670196533, 43391.71997833252, 47828.06664991379, 51321.34684801102, 50733.04679298401, 48819.02003502846, 45780.04006910324, 51794.84714066982, 49669.84020841122, 47081.51997947693, 44559.066873550415, 42539.24692630768, 51278.326847076416, 46983.14701843262, 48540.18019104004, 47756.54011154175, 54203.30670928955, 49722.89340591431, 50093.71357727051, 42656.13356399536, 48084.64662361145, 49973.8667678833, 42136.66703224182, 43974.45352315903, 52464.373317718506, 46336.0132484436, 41327.43997001648, 52160.88667392731, 52786.6466217041, 49581.533420562744, 51428.57350540161, 45334.720180511475, 54743.79998397827, 45217.246900081635, 49891.10675621033, 45204.41346693039, 39494.63338184357, 48572.89344406128, 44328.71345901489, 43967.84661722183, 50524.140254974365, 47641.88688659668, 52546.10689163208, 53490.853481292725, 46257.253229141235, 49756.19353103638, 36077.080134391785, 50009.68011665344, 45502.29327774048, 50492.58688354492, 49663.38689613342, 47900.760190963745, 47468.08686542511, 52024.46027612686, 47198.260063409805, 48306.4401512146, 43931.0069065094, 51284.859938800335, 47738.40001678467, 46948.43993186951, 50168.37368619442, 47873.45365333557, 44689.900270462036, 51200.96021652222, 48462.526779174805, 50057.61353111267, 44498.986824035645, 49891.000186920166, 49500.01347923279, 49271.58013534546, 52242.96674823761, 44120.240263938904, 49344.83340072632, 45440.77346229553, 42639.32008075714, 49635.82018280029, 49279.62692642212, 44849.48003578186, 53658.0065536499, 40711.07991480827, 49765.9800195694, 49433.54025268555, 47953.559807777405, 49349.07321166992, 42138.41340768337, 49931.3602104187, 52059.76008796692, 43770.72681236267, 52125.533447265625, 48904.4934387207, 50259.953269958496, 49756.0400352478, 47043.713216781616, 44984.04664897919, 52312.14010620117, 52294.25339126587, 40724.860218048096, 45528.76004219055, 49885.7867269516, 52119.48032474518, 42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.23353201325303, "mean_inference_ms": 6.642088718281043, "mean_action_processing_ms": 0.2085422223215348, "mean_env_wait_ms": 222.4233424635337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05052336331071525, "StateBufferConnector_ms": 0.007246280538624731, "ViewRequirementAgentConnector_ms": 0.2585943402915165}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.74078378650657, "num_env_steps_trained_throughput_per_sec": 191.74078378650657, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 16119.345, "sample_time_ms": 11886.215, "learn_time_ms": 4072.715, "learn_throughput": 982.146, "synch_weights_time_ms": 159.511}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 744, "training_iteration": 26, "trial_id": "185f8_00000", "date": "2025-03-21_11-51-18", "timestamp": 1742557878, "time_this_iter_s": 20.927963972091675, "time_total_s": 409.8155405521393, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b82cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 409.8155405521393, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 95.49310344827589, "ram_util_percent": 13.593103448275865}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985888481140137, "policy_loss": -0.015794318169355392, "vf_loss": 10.0, "vf_explained_var": 6.239861249923706e-08, "kl": 0.008414342068135738, "entropy": 0.730358898639679, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}}, "episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.6446044925329, "num_env_steps_trained_throughput_per_sec": 270.6446044925329, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 16049.134, "sample_time_ms": 11798.813, "learn_time_ms": 4088.981, "learn_throughput": 978.239, "synch_weights_time_ms": 160.376}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 744, "training_iteration": 27, "trial_id": "185f8_00000", "date": "2025-03-21_11-51-33", "timestamp": 1742557893, "time_this_iter_s": 14.832913637161255, "time_total_s": 424.64845418930054, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b81fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 424.64845418930054, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.4809523809524, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984724998474121, "policy_loss": -0.017105069011449814, "vf_loss": 10.0, "vf_explained_var": -4.34617203337595e-10, "kl": 0.009151201695203781, "entropy": 0.7377744317054749, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}}, "episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.55824290903445, "num_env_steps_trained_throughput_per_sec": 286.55824290903445, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 15544.418, "sample_time_ms": 11259.811, "learn_time_ms": 4125.283, "learn_throughput": 969.63, "synch_weights_time_ms": 158.348}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 744, "training_iteration": 28, "trial_id": "185f8_00000", "date": "2025-03-21_11-51-47", "timestamp": 1742557907, "time_this_iter_s": 14.007789611816406, "time_total_s": 438.65624380111694, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83b50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 438.65624380111694, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.50500000000001, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98721694946289, "policy_loss": -0.01447763666510582, "vf_loss": 10.0, "vf_explained_var": 1.6614794162705948e-07, "kl": 0.008475419133901596, "entropy": 0.7179105281829834, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}}, "episode_reward_max": 42652.02012300491, "episode_reward_min": 42652.02012300491, "episode_reward_mean": 42652.02012300491, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 42652.02012300491}, "policy_reward_max": {"agent_0": 42652.02012300491}, "policy_reward_mean": {"agent_0": 42652.02012300491}, "hist_stats": {"episode_reward": [42652.02012300491], "episode_lengths": [137], "policy_agent_0_reward": [42652.02012300491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.04558901426171, "mean_inference_ms": 6.433500104448517, "mean_action_processing_ms": 0.213210322275883, "mean_env_wait_ms": 227.50639142680996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169940948486328, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.5927562713623047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.93073086731374, "num_env_steps_trained_throughput_per_sec": 286.93073086731374, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 15517.341, "sample_time_ms": 11277.217, "learn_time_ms": 4078.837, "learn_throughput": 980.672, "synch_weights_time_ms": 160.286}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 744, "training_iteration": 29, "trial_id": "185f8_00000", "date": "2025-03-21_11-52-01", "timestamp": 1742557921, "time_this_iter_s": 13.987394094467163, "time_total_s": 452.6436378955841, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0b83be0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 452.6436378955841, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 99.56315789473685, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.090909090909091, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.879959106445312, "policy_loss": -0.012598980218172073, "vf_loss": 9.89111328125, "vf_explained_var": 2.8504680926744186e-07, "kl": 0.0072206659242510796, "entropy": 0.7204956412315369, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 55160.386642456055, "episode_reward_min": 42564.52000331879, "episode_reward_mean": 49122.25057111274, "episode_len_mean": 136.3181818181818, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"agent_0": 42564.52000331879}, "policy_reward_max": {"agent_0": 55160.386642456055}, "policy_reward_mean": {"agent_0": 49122.25057111274}, "custom_metrics": {"num_batches_mean": 5.090909090909091, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52657.80014181137, 52795.000195503235, 48888.26010513306, 51977.79360961914, 42564.52000331879, 50293.69344377518, 51510.106746673584, 53245.21332168579, 55160.386642456055, 47076.99989318848, 49168.05356025696, 51922.78671455383, 46975.34673500061, 50956.51362991333, 45780.82677555084, 52458.19998931885, 44280.04678964615, 52498.326805114746, 48681.03347682953, 44753.65324628353, 48776.92665672302, 52054.80673980713, 51192.846868515015, 51639.86664199829, 45862.9602394104, 47677.21993160248, 46329.460074424744, 49942.42671298981, 47500.21342468262, 48261.713609695435, 50046.4269361496, 51640.90022659302, 47507.42691230774, 50000.30677604675, 51793.553367614746, 50340.406665802, 46569.08004260063, 46076.08692359924, 42931.06028366089, 51494.45342254639, 47766.480112075806, 46650.06012916565, 49357.32048034668, 46322.46012496948], "episode_lengths": [136, 136, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 137, 137, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [52657.80014181137, 52795.000195503235, 48888.26010513306, 51977.79360961914, 42564.52000331879, 50293.69344377518, 51510.106746673584, 53245.21332168579, 55160.386642456055, 47076.99989318848, 49168.05356025696, 51922.78671455383, 46975.34673500061, 50956.51362991333, 45780.82677555084, 52458.19998931885, 44280.04678964615, 52498.326805114746, 48681.03347682953, 44753.65324628353, 48776.92665672302, 52054.80673980713, 51192.846868515015, 51639.86664199829, 45862.9602394104, 47677.21993160248, 46329.460074424744, 49942.42671298981, 47500.21342468262, 48261.713609695435, 50046.4269361496, 51640.90022659302, 47507.42691230774, 50000.30677604675, 51793.553367614746, 50340.406665802, 46569.08004260063, 46076.08692359924, 42931.06028366089, 51494.45342254639, 47766.480112075806, 46650.06012916565, 49357.32048034668, 46322.46012496948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.24001540079582, "mean_inference_ms": 6.556550446058034, "mean_action_processing_ms": 0.20851122379996986, "mean_env_wait_ms": 216.8059121772516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08563995361328125, "StateBufferConnector_ms": 0.007278810847889294, "ViewRequirementAgentConnector_ms": 0.2354583956978538}}, "episode_reward_max": 55160.386642456055, "episode_reward_min": 42564.52000331879, "episode_reward_mean": 49122.25057111274, "episode_len_mean": 136.3181818181818, "episodes_this_iter": 44, "policy_reward_min": {"agent_0": 42564.52000331879}, "policy_reward_max": {"agent_0": 55160.386642456055}, "policy_reward_mean": {"agent_0": 49122.25057111274}, "hist_stats": {"episode_reward": [52657.80014181137, 52795.000195503235, 48888.26010513306, 51977.79360961914, 42564.52000331879, 50293.69344377518, 51510.106746673584, 53245.21332168579, 55160.386642456055, 47076.99989318848, 49168.05356025696, 51922.78671455383, 46975.34673500061, 50956.51362991333, 45780.82677555084, 52458.19998931885, 44280.04678964615, 52498.326805114746, 48681.03347682953, 44753.65324628353, 48776.92665672302, 52054.80673980713, 51192.846868515015, 51639.86664199829, 45862.9602394104, 47677.21993160248, 46329.460074424744, 49942.42671298981, 47500.21342468262, 48261.713609695435, 50046.4269361496, 51640.90022659302, 47507.42691230774, 50000.30677604675, 51793.553367614746, 50340.406665802, 46569.08004260063, 46076.08692359924, 42931.06028366089, 51494.45342254639, 47766.480112075806, 46650.06012916565, 49357.32048034668, 46322.46012496948], "episode_lengths": [136, 136, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 137, 137, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [52657.80014181137, 52795.000195503235, 48888.26010513306, 51977.79360961914, 42564.52000331879, 50293.69344377518, 51510.106746673584, 53245.21332168579, 55160.386642456055, 47076.99989318848, 49168.05356025696, 51922.78671455383, 46975.34673500061, 50956.51362991333, 45780.82677555084, 52458.19998931885, 44280.04678964615, 52498.326805114746, 48681.03347682953, 44753.65324628353, 48776.92665672302, 52054.80673980713, 51192.846868515015, 51639.86664199829, 45862.9602394104, 47677.21993160248, 46329.460074424744, 49942.42671298981, 47500.21342468262, 48261.713609695435, 50046.4269361496, 51640.90022659302, 47507.42691230774, 50000.30677604675, 51793.553367614746, 50340.406665802, 46569.08004260063, 46076.08692359924, 42931.06028366089, 51494.45342254639, 47766.480112075806, 46650.06012916565, 49357.32048034668, 46322.46012496948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.24001540079582, "mean_inference_ms": 6.556550446058034, "mean_action_processing_ms": 0.20851122379996986, "mean_env_wait_ms": 216.8059121772516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08563995361328125, "StateBufferConnector_ms": 0.007278810847889294, "ViewRequirementAgentConnector_ms": 0.2354583956978538}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.46959608765863, "num_env_steps_trained_throughput_per_sec": 240.46959608765863, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 15683.295, "sample_time_ms": 11540.29, "learn_time_ms": 3989.661, "learn_throughput": 1002.591, "synch_weights_time_ms": 152.376}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 788, "training_iteration": 30, "trial_id": "185f8_00000", "date": "2025-03-21_11-52-18", "timestamp": 1742557938, "time_this_iter_s": 16.683363676071167, "time_total_s": 469.3270015716553, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a227a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 469.3270015716553, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 96.14782608695653, "ram_util_percent": 13.600000000000003}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.787145614624023, "policy_loss": -0.012098300270736217, "vf_loss": 9.7978515625, "vf_explained_var": -6.314367340110039e-08, "kl": 0.006962789688259363, "entropy": 0.7141934633255005, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 54103.1668510437, "episode_reward_min": 36051.39335894585, "episode_reward_mean": 48883.758613720536, "episode_len_mean": 136.375, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {"agent_0": 36051.39335894585}, "policy_reward_max": {"agent_0": 54103.1668510437}, "policy_reward_mean": {"agent_0": 48883.758613720536}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [46631.92666339874, 49614.6802444458, 52902.200145721436, 52244.48670578003, 50855.133403778076, 50804.18012237549, 49519.37992095947, 48015.24681854248, 49099.36002159119, 48902.72005844116, 47974.0733795166, 48333.38656044006, 45668.44662857056, 51323.186641693115, 42648.04016017914, 48868.373443603516, 48591.3601436615, 49484.96692276001, 51800.81352233887, 51305.886880874634, 49034.62017059326, 50765.4334526062, 43542.95346450806, 49485.75332450867, 47760.76020812988, 47955.34682846069, 48181.22031402588, 50170.72008705139, 50727.206802368164, 49887.160175323486, 51529.77347755432, 47825.36657333374, 42415.013359069824, 50970.79346561432, 44176.96006441116, 47432.21346664429, 46667.80679798126, 46528.10665512085, 49948.973687171936, 48095.16693019867, 50002.573501586914, 53602.22676849365, 48840.62026596069, 49206.64665412903, 48547.38671541214, 51500.36672973633, 52670.74015045166, 45703.64686155319, 51242.1466794014, 49350.2134437561, 47361.55347251892, 46692.13338470459, 52594.70714318752, 48445.1400680542, 51758.11349105835, 42460.95337486267, 51969.600160598755, 50022.260138750076, 48344.466608047485, 45692.3132648468, 52475.26680755615, 54103.1668510437, 48362.0867061615, 45528.12021005154, 36051.39335894585, 52283.213397979736, 49760.72002220154, 52474.31336116791, 45880.46022796631, 47647.060106277466, 51337.18672943115, 47044.45341300964, 48477.61343383789, 47397.6600151062, 49164.46705532074, 45239.63354682922, 43864.293494701385, 52813.46670913696, 53452.60018348694, 53646.506896972656], "episode_lengths": [136, 137, 136, 136, 137, 136, 137, 137, 137, 136, 136, 137, 136, 136, 137, 137, 136, 136, 135, 137, 136, 136, 137, 137, 137, 136, 136, 137, 136, 137, 137, 137, 136, 137, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136, 136, 136, 136, 137, 138, 136, 136, 136, 136, 136, 137, 137, 136, 137, 136, 136, 136, 135, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 136, 137, 136, 136, 136], "policy_agent_0_reward": [46631.92666339874, 49614.6802444458, 52902.200145721436, 52244.48670578003, 50855.133403778076, 50804.18012237549, 49519.37992095947, 48015.24681854248, 49099.36002159119, 48902.72005844116, 47974.0733795166, 48333.38656044006, 45668.44662857056, 51323.186641693115, 42648.04016017914, 48868.373443603516, 48591.3601436615, 49484.96692276001, 51800.81352233887, 51305.886880874634, 49034.62017059326, 50765.4334526062, 43542.95346450806, 49485.75332450867, 47760.76020812988, 47955.34682846069, 48181.22031402588, 50170.72008705139, 50727.206802368164, 49887.160175323486, 51529.77347755432, 47825.36657333374, 42415.013359069824, 50970.79346561432, 44176.96006441116, 47432.21346664429, 46667.80679798126, 46528.10665512085, 49948.973687171936, 48095.16693019867, 50002.573501586914, 53602.22676849365, 48840.62026596069, 49206.64665412903, 48547.38671541214, 51500.36672973633, 52670.74015045166, 45703.64686155319, 51242.1466794014, 49350.2134437561, 47361.55347251892, 46692.13338470459, 52594.70714318752, 48445.1400680542, 51758.11349105835, 42460.95337486267, 51969.600160598755, 50022.260138750076, 48344.466608047485, 45692.3132648468, 52475.26680755615, 54103.1668510437, 48362.0867061615, 45528.12021005154, 36051.39335894585, 52283.213397979736, 49760.72002220154, 52474.31336116791, 45880.46022796631, 47647.060106277466, 51337.18672943115, 47044.45341300964, 48477.61343383789, 47397.6600151062, 49164.46705532074, 45239.63354682922, 43864.293494701385, 52813.46670913696, 53452.60018348694, 53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.26008802046108, "mean_inference_ms": 6.658857232494297, "mean_action_processing_ms": 0.20752597191302558, "mean_env_wait_ms": 224.7749898909082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05379378795623779, "StateBufferConnector_ms": 0.007447302341461182, "ViewRequirementAgentConnector_ms": 0.22480309009552002}}, "episode_reward_max": 54103.1668510437, "episode_reward_min": 36051.39335894585, "episode_reward_mean": 48883.758613720536, "episode_len_mean": 136.375, "episodes_this_iter": 80, "policy_reward_min": {"agent_0": 36051.39335894585}, "policy_reward_max": {"agent_0": 54103.1668510437}, "policy_reward_mean": {"agent_0": 48883.758613720536}, "hist_stats": {"episode_reward": [46631.92666339874, 49614.6802444458, 52902.200145721436, 52244.48670578003, 50855.133403778076, 50804.18012237549, 49519.37992095947, 48015.24681854248, 49099.36002159119, 48902.72005844116, 47974.0733795166, 48333.38656044006, 45668.44662857056, 51323.186641693115, 42648.04016017914, 48868.373443603516, 48591.3601436615, 49484.96692276001, 51800.81352233887, 51305.886880874634, 49034.62017059326, 50765.4334526062, 43542.95346450806, 49485.75332450867, 47760.76020812988, 47955.34682846069, 48181.22031402588, 50170.72008705139, 50727.206802368164, 49887.160175323486, 51529.77347755432, 47825.36657333374, 42415.013359069824, 50970.79346561432, 44176.96006441116, 47432.21346664429, 46667.80679798126, 46528.10665512085, 49948.973687171936, 48095.16693019867, 50002.573501586914, 53602.22676849365, 48840.62026596069, 49206.64665412903, 48547.38671541214, 51500.36672973633, 52670.74015045166, 45703.64686155319, 51242.1466794014, 49350.2134437561, 47361.55347251892, 46692.13338470459, 52594.70714318752, 48445.1400680542, 51758.11349105835, 42460.95337486267, 51969.600160598755, 50022.260138750076, 48344.466608047485, 45692.3132648468, 52475.26680755615, 54103.1668510437, 48362.0867061615, 45528.12021005154, 36051.39335894585, 52283.213397979736, 49760.72002220154, 52474.31336116791, 45880.46022796631, 47647.060106277466, 51337.18672943115, 47044.45341300964, 48477.61343383789, 47397.6600151062, 49164.46705532074, 45239.63354682922, 43864.293494701385, 52813.46670913696, 53452.60018348694, 53646.506896972656], "episode_lengths": [136, 137, 136, 136, 137, 136, 137, 137, 137, 136, 136, 137, 136, 136, 137, 137, 136, 136, 135, 137, 136, 136, 137, 137, 137, 136, 136, 137, 136, 137, 137, 137, 136, 137, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136, 136, 136, 136, 137, 138, 136, 136, 136, 136, 136, 137, 137, 136, 137, 136, 136, 136, 135, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 136, 137, 136, 136, 136], "policy_agent_0_reward": [46631.92666339874, 49614.6802444458, 52902.200145721436, 52244.48670578003, 50855.133403778076, 50804.18012237549, 49519.37992095947, 48015.24681854248, 49099.36002159119, 48902.72005844116, 47974.0733795166, 48333.38656044006, 45668.44662857056, 51323.186641693115, 42648.04016017914, 48868.373443603516, 48591.3601436615, 49484.96692276001, 51800.81352233887, 51305.886880874634, 49034.62017059326, 50765.4334526062, 43542.95346450806, 49485.75332450867, 47760.76020812988, 47955.34682846069, 48181.22031402588, 50170.72008705139, 50727.206802368164, 49887.160175323486, 51529.77347755432, 47825.36657333374, 42415.013359069824, 50970.79346561432, 44176.96006441116, 47432.21346664429, 46667.80679798126, 46528.10665512085, 49948.973687171936, 48095.16693019867, 50002.573501586914, 53602.22676849365, 48840.62026596069, 49206.64665412903, 48547.38671541214, 51500.36672973633, 52670.74015045166, 45703.64686155319, 51242.1466794014, 49350.2134437561, 47361.55347251892, 46692.13338470459, 52594.70714318752, 48445.1400680542, 51758.11349105835, 42460.95337486267, 51969.600160598755, 50022.260138750076, 48344.466608047485, 45692.3132648468, 52475.26680755615, 54103.1668510437, 48362.0867061615, 45528.12021005154, 36051.39335894585, 52283.213397979736, 49760.72002220154, 52474.31336116791, 45880.46022796631, 47647.060106277466, 51337.18672943115, 47044.45341300964, 48477.61343383789, 47397.6600151062, 49164.46705532074, 45239.63354682922, 43864.293494701385, 52813.46670913696, 53452.60018348694, 53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.26008802046108, "mean_inference_ms": 6.658857232494297, "mean_action_processing_ms": 0.20752597191302558, "mean_env_wait_ms": 224.7749898909082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05379378795623779, "StateBufferConnector_ms": 0.007447302341461182, "ViewRequirementAgentConnector_ms": 0.22480309009552002}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.55156879403964, "num_env_steps_trained_throughput_per_sec": 202.55156879403964, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 16099.88, "sample_time_ms": 11956.909, "learn_time_ms": 3983.979, "learn_throughput": 1004.021, "synch_weights_time_ms": 158.04}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 868, "training_iteration": 31, "trial_id": "185f8_00000", "date": "2025-03-21_11-52-38", "timestamp": 1742557958, "time_this_iter_s": 19.815722465515137, "time_total_s": 489.1427240371704, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a231c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 489.1427240371704, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 97.43333333333337, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98780345916748, "policy_loss": -0.013794071041047573, "vf_loss": 10.0, "vf_explained_var": 1.3566265977260628e-07, "kl": 0.007989843375980854, "entropy": 0.6910486817359924, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 53646.506896972656, "episode_reward_min": 53646.506896972656, "episode_reward_mean": 53646.506896972656, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53646.506896972656}, "policy_reward_max": {"agent_0": 53646.506896972656}, "policy_reward_mean": {"agent_0": 53646.506896972656}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53646.506896972656], "episode_lengths": [136], "policy_agent_0_reward": [53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.40453227601142, "mean_inference_ms": 6.338171368279125, "mean_action_processing_ms": 0.20993224083476916, "mean_env_wait_ms": 226.92275623540505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04379749298095703, "StateBufferConnector_ms": 0.007343292236328125, "ViewRequirementAgentConnector_ms": 0.5381584167480469}}, "episode_reward_max": 53646.506896972656, "episode_reward_min": 53646.506896972656, "episode_reward_mean": 53646.506896972656, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53646.506896972656}, "policy_reward_max": {"agent_0": 53646.506896972656}, "policy_reward_mean": {"agent_0": 53646.506896972656}, "hist_stats": {"episode_reward": [53646.506896972656], "episode_lengths": [136], "policy_agent_0_reward": [53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.40453227601142, "mean_inference_ms": 6.338171368279125, "mean_action_processing_ms": 0.20993224083476916, "mean_env_wait_ms": 226.92275623540505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04379749298095703, "StateBufferConnector_ms": 0.007343292236328125, "ViewRequirementAgentConnector_ms": 0.5381584167480469}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.87589585989474, "num_env_steps_trained_throughput_per_sec": 276.87589585989474, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 15576.462, "sample_time_ms": 11413.305, "learn_time_ms": 3992.904, "learn_throughput": 1001.777, "synch_weights_time_ms": 169.347}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 868, "training_iteration": 32, "trial_id": "185f8_00000", "date": "2025-03-21_11-52-52", "timestamp": 1742557972, "time_this_iter_s": 14.506913661956787, "time_total_s": 503.6496376991272, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 503.6496376991272, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.57619047619048, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988781929016113, "policy_loss": -0.012488039210438728, "vf_loss": 10.0, "vf_explained_var": 3.656993285972021e-08, "kl": 0.006346491165459156, "entropy": 0.6535259485244751, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 53646.506896972656, "episode_reward_min": 53646.506896972656, "episode_reward_mean": 53646.506896972656, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53646.506896972656}, "policy_reward_max": {"agent_0": 53646.506896972656}, "policy_reward_mean": {"agent_0": 53646.506896972656}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53646.506896972656], "episode_lengths": [136], "policy_agent_0_reward": [53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.40453227601142, "mean_inference_ms": 6.338171368279125, "mean_action_processing_ms": 0.20993224083476916, "mean_env_wait_ms": 226.92275623540505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04379749298095703, "StateBufferConnector_ms": 0.007343292236328125, "ViewRequirementAgentConnector_ms": 0.5381584167480469}}, "episode_reward_max": 53646.506896972656, "episode_reward_min": 53646.506896972656, "episode_reward_mean": 53646.506896972656, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53646.506896972656}, "policy_reward_max": {"agent_0": 53646.506896972656}, "policy_reward_mean": {"agent_0": 53646.506896972656}, "hist_stats": {"episode_reward": [53646.506896972656], "episode_lengths": [136], "policy_agent_0_reward": [53646.506896972656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.40453227601142, "mean_inference_ms": 6.338171368279125, "mean_action_processing_ms": 0.20993224083476916, "mean_env_wait_ms": 226.92275623540505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04379749298095703, "StateBufferConnector_ms": 0.007343292236328125, "ViewRequirementAgentConnector_ms": 0.5381584167480469}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.36073031515184, "num_env_steps_trained_throughput_per_sec": 288.36073031515184, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 15536.309, "sample_time_ms": 11441.467, "learn_time_ms": 3931.842, "learn_throughput": 1017.335, "synch_weights_time_ms": 162.065}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 868, "training_iteration": 33, "trial_id": "185f8_00000", "date": "2025-03-21_11-53-06", "timestamp": 1742557986, "time_this_iter_s": 13.934213876724243, "time_total_s": 517.5838515758514, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 517.5838515758514, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.485, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906734466552734, "policy_loss": -0.01467202976346016, "vf_loss": 9.919921875, "vf_explained_var": 1.411264207717977e-07, "kl": 0.007419807370752096, "entropy": 0.6707949042320251, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 55877.24012756348, "episode_reward_min": 43508.46008682251, "episode_reward_mean": 50549.82111318596, "episode_len_mean": 136.125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43508.46008682251}, "policy_reward_max": {"agent_0": 55877.24012756348}, "policy_reward_mean": {"agent_0": 50549.82111318596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51165.28660583496, 47744.446663856506, 50747.90014362335, 48952.000062942505, 50738.033473968506, 52601.83358001709, 50096.833292007446, 46200.453311920166, 51275.280168533325, 46942.26683664322, 55769.44007873535, 52591.739879608154, 48837.14023113251, 48851.06652069092, 52108.360008239746, 51546.30010986328, 51725.27350997925, 50864.206800460815, 55877.24012756348, 48311.5933971405, 52616.66645812988, 51998.95350265503, 50281.22011947632, 48736.62011152506, 43508.46008682251, 47083.60011577606, 51028.45344924927, 49234.78021430969, 55302.64671707153, 51472.279972076416, 52604.546730041504, 50779.353342056274], "episode_lengths": [135, 136, 136, 136, 135, 136, 138, 136, 136, 137, 136, 137, 136, 137, 136, 137, 136, 137, 136, 136, 135, 136, 136, 136, 137, 136, 136, 136, 136, 136, 135, 136], "policy_agent_0_reward": [51165.28660583496, 47744.446663856506, 50747.90014362335, 48952.000062942505, 50738.033473968506, 52601.83358001709, 50096.833292007446, 46200.453311920166, 51275.280168533325, 46942.26683664322, 55769.44007873535, 52591.739879608154, 48837.14023113251, 48851.06652069092, 52108.360008239746, 51546.30010986328, 51725.27350997925, 50864.206800460815, 55877.24012756348, 48311.5933971405, 52616.66645812988, 51998.95350265503, 50281.22011947632, 48736.62011152506, 43508.46008682251, 47083.60011577606, 51028.45344924927, 49234.78021430969, 55302.64671707153, 51472.279972076416, 52604.546730041504, 50779.353342056274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.33036354016961, "mean_inference_ms": 6.378901443997346, "mean_action_processing_ms": 0.20683567410373094, "mean_env_wait_ms": 211.08462151309158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1003846526145935, "StateBufferConnector_ms": 0.006954371929168701, "ViewRequirementAgentConnector_ms": 0.30019283294677734}}, "episode_reward_max": 55877.24012756348, "episode_reward_min": 43508.46008682251, "episode_reward_mean": 50549.82111318596, "episode_len_mean": 136.125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43508.46008682251}, "policy_reward_max": {"agent_0": 55877.24012756348}, "policy_reward_mean": {"agent_0": 50549.82111318596}, "hist_stats": {"episode_reward": [51165.28660583496, 47744.446663856506, 50747.90014362335, 48952.000062942505, 50738.033473968506, 52601.83358001709, 50096.833292007446, 46200.453311920166, 51275.280168533325, 46942.26683664322, 55769.44007873535, 52591.739879608154, 48837.14023113251, 48851.06652069092, 52108.360008239746, 51546.30010986328, 51725.27350997925, 50864.206800460815, 55877.24012756348, 48311.5933971405, 52616.66645812988, 51998.95350265503, 50281.22011947632, 48736.62011152506, 43508.46008682251, 47083.60011577606, 51028.45344924927, 49234.78021430969, 55302.64671707153, 51472.279972076416, 52604.546730041504, 50779.353342056274], "episode_lengths": [135, 136, 136, 136, 135, 136, 138, 136, 136, 137, 136, 137, 136, 137, 136, 137, 136, 137, 136, 136, 135, 136, 136, 136, 137, 136, 136, 136, 136, 136, 135, 136], "policy_agent_0_reward": [51165.28660583496, 47744.446663856506, 50747.90014362335, 48952.000062942505, 50738.033473968506, 52601.83358001709, 50096.833292007446, 46200.453311920166, 51275.280168533325, 46942.26683664322, 55769.44007873535, 52591.739879608154, 48837.14023113251, 48851.06652069092, 52108.360008239746, 51546.30010986328, 51725.27350997925, 50864.206800460815, 55877.24012756348, 48311.5933971405, 52616.66645812988, 51998.95350265503, 50281.22011947632, 48736.62011152506, 43508.46008682251, 47083.60011577606, 51028.45344924927, 49234.78021430969, 55302.64671707153, 51472.279972076416, 52604.546730041504, 50779.353342056274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.33036354016961, "mean_inference_ms": 6.378901443997346, "mean_action_processing_ms": 0.20683567410373094, "mean_env_wait_ms": 211.08462151309158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1003846526145935, "StateBufferConnector_ms": 0.006954371929168701, "ViewRequirementAgentConnector_ms": 0.30019283294677734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.78486647383454, "num_env_steps_trained_throughput_per_sec": 218.78486647383454, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 15985.889, "sample_time_ms": 11918.989, "learn_time_ms": 3914.862, "learn_throughput": 1021.747, "synch_weights_time_ms": 151.107}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 900, "training_iteration": 34, "trial_id": "185f8_00000", "date": "2025-03-21_11-53-25", "timestamp": 1742558005, "time_this_iter_s": 18.348137855529785, "time_total_s": 535.9319894313812, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 535.9319894313812, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 99.3, "ram_util_percent": 13.612499999999997}}
{"custom_metrics": {"num_batches_mean": 5.076086956521739, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.754911422729492, "policy_loss": -0.015729235485196114, "vf_loss": 9.76904296875, "vf_explained_var": -5.57551764757136e-08, "kl": 0.007986914366483688, "entropy": 0.6859999299049377, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 56056.43336868286, "episode_reward_min": 41970.50659656525, "episode_reward_mean": 50083.03473749368, "episode_len_mean": 136.0108695652174, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41970.50659656525}, "policy_reward_max": {"agent_0": 56056.43336868286}, "policy_reward_mean": {"agent_0": 50083.03473749368}, "custom_metrics": {"num_batches_mean": 5.076086956521739, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53266.419692993164, 50670.126673698425, 54809.90704345703, 55235.76673030853, 48760.07331085205, 49350.54681587219, 48066.660232543945, 50764.72013282776, 47504.053210258484, 54013.50693130493, 52707.50679683685, 52399.613414764404, 56056.43336868286, 49639.673376083374, 54227.60018539429, 49879.85997390747, 47299.05339050293, 54854.22026062012, 44945.55335366726, 49494.69332885742, 50506.50701236725, 49311.49356675148, 52943.44668960571, 49151.63335609436, 52716.713329315186, 46822.25344181061, 51689.15348434448, 52291.040088653564, 50058.559871673584, 52317.70027923584, 53841.72032165527, 48648.10003852844, 50131.220291137695, 52530.180236816406, 44514.30674934387, 49086.36000442505, 47028.58018684387, 49612.46662712097, 53033.6665430069, 50715.020151138306, 50473.99353599548, 51471.553315639496, 49221.28692531586, 46609.4534778595, 48775.24017047882, 53815.79997253418, 48832.89346790314, 48571.660011291504, 50827.800033569336, 52977.54008483887, 51592.27334213257, 43119.58660316467, 50865.09360122681, 48861.29332733154, 51034.1667175293, 54926.973529815674, 48619.91365623474, 49704.9932346344, 48442.84000015259, 51308.46691894531, 48185.84019088745, 53723.64013671875, 52037.16018676758, 50276.16670417786, 50971.846632003784, 52579.23354721069, 47061.40011501312, 46057.94680976868, 43515.439873456955, 51239.900104522705, 51777.81349945068, 45942.606772542, 51466.43344116211, 51565.613456726074, 50453.933450460434, 51819.58012390137, 42561.2335062027, 45659.63998794556, 50289.71336364746, 47129.61356019974, 52422.17352581024, 51040.60690116882, 53262.046813964844, 46817.8334236145, 48170.76027369499, 53928.659996032715, 49209.38674163818, 41970.50659656525, 47176.1733007431, 46549.78671455383, 50897.473640441895, 50930.10003852844], "episode_lengths": [136, 135, 135, 136, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 136, 136, 136, 137, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136, 137, 136, 137, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136, 136, 136, 136, 135, 135, 136, 136, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 137, 136, 136, 137, 136, 136, 136, 136, 135, 137, 136, 135, 136, 135, 137, 136, 136, 135, 135, 136, 135, 137, 135, 137, 136, 136, 136, 136], "policy_agent_0_reward": [53266.419692993164, 50670.126673698425, 54809.90704345703, 55235.76673030853, 48760.07331085205, 49350.54681587219, 48066.660232543945, 50764.72013282776, 47504.053210258484, 54013.50693130493, 52707.50679683685, 52399.613414764404, 56056.43336868286, 49639.673376083374, 54227.60018539429, 49879.85997390747, 47299.05339050293, 54854.22026062012, 44945.55335366726, 49494.69332885742, 50506.50701236725, 49311.49356675148, 52943.44668960571, 49151.63335609436, 52716.713329315186, 46822.25344181061, 51689.15348434448, 52291.040088653564, 50058.559871673584, 52317.70027923584, 53841.72032165527, 48648.10003852844, 50131.220291137695, 52530.180236816406, 44514.30674934387, 49086.36000442505, 47028.58018684387, 49612.46662712097, 53033.6665430069, 50715.020151138306, 50473.99353599548, 51471.553315639496, 49221.28692531586, 46609.4534778595, 48775.24017047882, 53815.79997253418, 48832.89346790314, 48571.660011291504, 50827.800033569336, 52977.54008483887, 51592.27334213257, 43119.58660316467, 50865.09360122681, 48861.29332733154, 51034.1667175293, 54926.973529815674, 48619.91365623474, 49704.9932346344, 48442.84000015259, 51308.46691894531, 48185.84019088745, 53723.64013671875, 52037.16018676758, 50276.16670417786, 50971.846632003784, 52579.23354721069, 47061.40011501312, 46057.94680976868, 43515.439873456955, 51239.900104522705, 51777.81349945068, 45942.606772542, 51466.43344116211, 51565.613456726074, 50453.933450460434, 51819.58012390137, 42561.2335062027, 45659.63998794556, 50289.71336364746, 47129.61356019974, 52422.17352581024, 51040.60690116882, 53262.046813964844, 46817.8334236145, 48170.76027369499, 53928.659996032715, 49209.38674163818, 41970.50659656525, 47176.1733007431, 46549.78671455383, 50897.473640441895, 50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.849292778596144, "mean_inference_ms": 6.587461437546699, "mean_action_processing_ms": 0.20666741623897159, "mean_env_wait_ms": 225.44288638028044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08360354796699855, "StateBufferConnector_ms": 0.010912833006485649, "ViewRequirementAgentConnector_ms": 0.24542678957400116}}, "episode_reward_max": 56056.43336868286, "episode_reward_min": 41970.50659656525, "episode_reward_mean": 50083.03473749368, "episode_len_mean": 136.0108695652174, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41970.50659656525}, "policy_reward_max": {"agent_0": 56056.43336868286}, "policy_reward_mean": {"agent_0": 50083.03473749368}, "hist_stats": {"episode_reward": [53266.419692993164, 50670.126673698425, 54809.90704345703, 55235.76673030853, 48760.07331085205, 49350.54681587219, 48066.660232543945, 50764.72013282776, 47504.053210258484, 54013.50693130493, 52707.50679683685, 52399.613414764404, 56056.43336868286, 49639.673376083374, 54227.60018539429, 49879.85997390747, 47299.05339050293, 54854.22026062012, 44945.55335366726, 49494.69332885742, 50506.50701236725, 49311.49356675148, 52943.44668960571, 49151.63335609436, 52716.713329315186, 46822.25344181061, 51689.15348434448, 52291.040088653564, 50058.559871673584, 52317.70027923584, 53841.72032165527, 48648.10003852844, 50131.220291137695, 52530.180236816406, 44514.30674934387, 49086.36000442505, 47028.58018684387, 49612.46662712097, 53033.6665430069, 50715.020151138306, 50473.99353599548, 51471.553315639496, 49221.28692531586, 46609.4534778595, 48775.24017047882, 53815.79997253418, 48832.89346790314, 48571.660011291504, 50827.800033569336, 52977.54008483887, 51592.27334213257, 43119.58660316467, 50865.09360122681, 48861.29332733154, 51034.1667175293, 54926.973529815674, 48619.91365623474, 49704.9932346344, 48442.84000015259, 51308.46691894531, 48185.84019088745, 53723.64013671875, 52037.16018676758, 50276.16670417786, 50971.846632003784, 52579.23354721069, 47061.40011501312, 46057.94680976868, 43515.439873456955, 51239.900104522705, 51777.81349945068, 45942.606772542, 51466.43344116211, 51565.613456726074, 50453.933450460434, 51819.58012390137, 42561.2335062027, 45659.63998794556, 50289.71336364746, 47129.61356019974, 52422.17352581024, 51040.60690116882, 53262.046813964844, 46817.8334236145, 48170.76027369499, 53928.659996032715, 49209.38674163818, 41970.50659656525, 47176.1733007431, 46549.78671455383, 50897.473640441895, 50930.10003852844], "episode_lengths": [136, 135, 135, 136, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 136, 136, 136, 137, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136, 137, 136, 137, 136, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136, 136, 136, 136, 135, 135, 136, 136, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 137, 136, 136, 137, 136, 136, 136, 136, 135, 137, 136, 135, 136, 135, 137, 136, 136, 135, 135, 136, 135, 137, 135, 137, 136, 136, 136, 136], "policy_agent_0_reward": [53266.419692993164, 50670.126673698425, 54809.90704345703, 55235.76673030853, 48760.07331085205, 49350.54681587219, 48066.660232543945, 50764.72013282776, 47504.053210258484, 54013.50693130493, 52707.50679683685, 52399.613414764404, 56056.43336868286, 49639.673376083374, 54227.60018539429, 49879.85997390747, 47299.05339050293, 54854.22026062012, 44945.55335366726, 49494.69332885742, 50506.50701236725, 49311.49356675148, 52943.44668960571, 49151.63335609436, 52716.713329315186, 46822.25344181061, 51689.15348434448, 52291.040088653564, 50058.559871673584, 52317.70027923584, 53841.72032165527, 48648.10003852844, 50131.220291137695, 52530.180236816406, 44514.30674934387, 49086.36000442505, 47028.58018684387, 49612.46662712097, 53033.6665430069, 50715.020151138306, 50473.99353599548, 51471.553315639496, 49221.28692531586, 46609.4534778595, 48775.24017047882, 53815.79997253418, 48832.89346790314, 48571.660011291504, 50827.800033569336, 52977.54008483887, 51592.27334213257, 43119.58660316467, 50865.09360122681, 48861.29332733154, 51034.1667175293, 54926.973529815674, 48619.91365623474, 49704.9932346344, 48442.84000015259, 51308.46691894531, 48185.84019088745, 53723.64013671875, 52037.16018676758, 50276.16670417786, 50971.846632003784, 52579.23354721069, 47061.40011501312, 46057.94680976868, 43515.439873456955, 51239.900104522705, 51777.81349945068, 45942.606772542, 51466.43344116211, 51565.613456726074, 50453.933450460434, 51819.58012390137, 42561.2335062027, 45659.63998794556, 50289.71336364746, 47129.61356019974, 52422.17352581024, 51040.60690116882, 53262.046813964844, 46817.8334236145, 48170.76027369499, 53928.659996032715, 49209.38674163818, 41970.50659656525, 47176.1733007431, 46549.78671455383, 50897.473640441895, 50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.849292778596144, "mean_inference_ms": 6.587461437546699, "mean_action_processing_ms": 0.20666741623897159, "mean_env_wait_ms": 225.44288638028044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08360354796699855, "StateBufferConnector_ms": 0.010912833006485649, "ViewRequirementAgentConnector_ms": 0.24542678957400116}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.63427964036677, "num_env_steps_trained_throughput_per_sec": 214.63427964036677, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 16515.961, "sample_time_ms": 12438.445, "learn_time_ms": 3929.431, "learn_throughput": 1017.959, "synch_weights_time_ms": 147.132}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 992, "training_iteration": 35, "trial_id": "185f8_00000", "date": "2025-03-21_11-53-44", "timestamp": 1742558024, "time_this_iter_s": 18.694219827651978, "time_total_s": 554.6262092590332, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 554.6262092590332, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 94.96153846153848, "ram_util_percent": 13.665384615384614}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.977578163146973, "policy_loss": -0.017063438892364502, "vf_loss": 9.992676734924316, "vf_explained_var": 1.019798219203949e-06, "kl": 0.009822108782827854, "entropy": 0.6540314555168152, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 50930.10003852844, "episode_reward_min": 50930.10003852844, "episode_reward_mean": 50930.10003852844, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50930.10003852844}, "policy_reward_max": {"agent_0": 50930.10003852844}, "policy_reward_mean": {"agent_0": 50930.10003852844}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50930.10003852844], "episode_lengths": [136], "policy_agent_0_reward": [50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.69123002698015, "mean_inference_ms": 6.312328614261297, "mean_action_processing_ms": 0.20704303438593297, "mean_env_wait_ms": 230.1889554822583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058078765869140625, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16508102416992188}}, "episode_reward_max": 50930.10003852844, "episode_reward_min": 50930.10003852844, "episode_reward_mean": 50930.10003852844, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50930.10003852844}, "policy_reward_max": {"agent_0": 50930.10003852844}, "policy_reward_mean": {"agent_0": 50930.10003852844}, "hist_stats": {"episode_reward": [50930.10003852844], "episode_lengths": [136], "policy_agent_0_reward": [50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.69123002698015, "mean_inference_ms": 6.312328614261297, "mean_action_processing_ms": 0.20704303438593297, "mean_env_wait_ms": 230.1889554822583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058078765869140625, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16508102416992188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.8687386550529, "num_env_steps_trained_throughput_per_sec": 278.8687386550529, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 15864.177, "sample_time_ms": 11800.444, "learn_time_ms": 3923.14, "learn_throughput": 1019.591, "synch_weights_time_ms": 139.644}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 992, "training_iteration": 36, "trial_id": "185f8_00000", "date": "2025-03-21_11-53-58", "timestamp": 1742558038, "time_this_iter_s": 14.397265672683716, "time_total_s": 569.0234749317169, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a216c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 569.0234749317169, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.50952380952383, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988133430480957, "policy_loss": -0.01332034170627594, "vf_loss": 10.0, "vf_explained_var": 7.399916739814216e-06, "kl": 0.0072723617777228355, "entropy": 0.658077597618103, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 50930.10003852844, "episode_reward_min": 50930.10003852844, "episode_reward_mean": 50930.10003852844, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50930.10003852844}, "policy_reward_max": {"agent_0": 50930.10003852844}, "policy_reward_mean": {"agent_0": 50930.10003852844}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50930.10003852844], "episode_lengths": [136], "policy_agent_0_reward": [50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.69123002698015, "mean_inference_ms": 6.312328614261297, "mean_action_processing_ms": 0.20704303438593297, "mean_env_wait_ms": 230.1889554822583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058078765869140625, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16508102416992188}}, "episode_reward_max": 50930.10003852844, "episode_reward_min": 50930.10003852844, "episode_reward_mean": 50930.10003852844, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50930.10003852844}, "policy_reward_max": {"agent_0": 50930.10003852844}, "policy_reward_mean": {"agent_0": 50930.10003852844}, "hist_stats": {"episode_reward": [50930.10003852844], "episode_lengths": [136], "policy_agent_0_reward": [50930.10003852844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.69123002698015, "mean_inference_ms": 6.312328614261297, "mean_action_processing_ms": 0.20704303438593297, "mean_env_wait_ms": 230.1889554822583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058078765869140625, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16508102416992188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.742520009758, "num_env_steps_trained_throughput_per_sec": 290.742520009758, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 15762.013, "sample_time_ms": 11724.402, "learn_time_ms": 3900.446, "learn_throughput": 1025.524, "synch_weights_time_ms": 136.268}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 992, "training_iteration": 37, "trial_id": "185f8_00000", "date": "2025-03-21_11-54-12", "timestamp": 1742558052, "time_this_iter_s": 13.795892715454102, "time_total_s": 582.819367647171, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 582.819367647171, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.61578947368422, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909987449645996, "policy_loss": -0.012061027809977531, "vf_loss": 9.920655250549316, "vf_explained_var": 8.02800030896833e-08, "kl": 0.006965931970626116, "entropy": 0.6099942326545715, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 54307.313735961914, "episode_reward_min": 43330.020027160645, "episode_reward_mean": 49865.673016229644, "episode_len_mean": 136.0625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43330.020027160645}, "policy_reward_max": {"agent_0": 54307.313735961914}, "policy_reward_mean": {"agent_0": 49865.673016229644}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52167.88014793396, 51012.1135597229, 53604.77990722656, 47023.90681552887, 48509.16030883789, 53258.033363342285, 54211.02686691284, 46345.92689037323, 44879.03994369507, 47757.01322746277, 52145.77998352051, 51863.386726379395, 52391.62690734863, 50656.66677093506, 49113.58666610718, 45939.76678353548, 43330.020027160645, 48548.646560668945, 49766.82007884979, 53165.45352935791, 45437.013372421265, 51776.25343322754, 51398.50678253174, 50764.90679168701, 48983.1467256546, 50839.88014602661, 54307.313735961914, 51284.873388290405, 52052.506633758545, 48421.74675369263, 46222.700199604034, 48522.05349159241], "episode_lengths": [136, 136, 136, 136, 136, 135, 135, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 135, 137, 136, 135, 136, 135, 136, 137, 137], "policy_agent_0_reward": [52167.88014793396, 51012.1135597229, 53604.77990722656, 47023.90681552887, 48509.16030883789, 53258.033363342285, 54211.02686691284, 46345.92689037323, 44879.03994369507, 47757.01322746277, 52145.77998352051, 51863.386726379395, 52391.62690734863, 50656.66677093506, 49113.58666610718, 45939.76678353548, 43330.020027160645, 48548.646560668945, 49766.82007884979, 53165.45352935791, 45437.013372421265, 51776.25343322754, 51398.50678253174, 50764.90679168701, 48983.1467256546, 50839.88014602661, 54307.313735961914, 51284.873388290405, 52052.506633758545, 48421.74675369263, 46222.700199604034, 48522.05349159241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.1872055675404, "mean_inference_ms": 6.303712606904991, "mean_action_processing_ms": 0.20537118156592682, "mean_env_wait_ms": 208.85948842740152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062249600887298584, "StateBufferConnector_ms": 0.006765127182006836, "ViewRequirementAgentConnector_ms": 0.24665966629981995}}, "episode_reward_max": 54307.313735961914, "episode_reward_min": 43330.020027160645, "episode_reward_mean": 49865.673016229644, "episode_len_mean": 136.0625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43330.020027160645}, "policy_reward_max": {"agent_0": 54307.313735961914}, "policy_reward_mean": {"agent_0": 49865.673016229644}, "hist_stats": {"episode_reward": [52167.88014793396, 51012.1135597229, 53604.77990722656, 47023.90681552887, 48509.16030883789, 53258.033363342285, 54211.02686691284, 46345.92689037323, 44879.03994369507, 47757.01322746277, 52145.77998352051, 51863.386726379395, 52391.62690734863, 50656.66677093506, 49113.58666610718, 45939.76678353548, 43330.020027160645, 48548.646560668945, 49766.82007884979, 53165.45352935791, 45437.013372421265, 51776.25343322754, 51398.50678253174, 50764.90679168701, 48983.1467256546, 50839.88014602661, 54307.313735961914, 51284.873388290405, 52052.506633758545, 48421.74675369263, 46222.700199604034, 48522.05349159241], "episode_lengths": [136, 136, 136, 136, 136, 135, 135, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 135, 137, 136, 135, 136, 135, 136, 137, 137], "policy_agent_0_reward": [52167.88014793396, 51012.1135597229, 53604.77990722656, 47023.90681552887, 48509.16030883789, 53258.033363342285, 54211.02686691284, 46345.92689037323, 44879.03994369507, 47757.01322746277, 52145.77998352051, 51863.386726379395, 52391.62690734863, 50656.66677093506, 49113.58666610718, 45939.76678353548, 43330.020027160645, 48548.646560668945, 49766.82007884979, 53165.45352935791, 45437.013372421265, 51776.25343322754, 51398.50678253174, 50764.90679168701, 48983.1467256546, 50839.88014602661, 54307.313735961914, 51284.873388290405, 52052.506633758545, 48421.74675369263, 46222.700199604034, 48522.05349159241]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.1872055675404, "mean_inference_ms": 6.303712606904991, "mean_action_processing_ms": 0.20537118156592682, "mean_env_wait_ms": 208.85948842740152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062249600887298584, "StateBufferConnector_ms": 0.006765127182006836, "ViewRequirementAgentConnector_ms": 0.24665966629981995}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.9272252205456, "num_env_steps_trained_throughput_per_sec": 230.9272252205456, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 16098.283, "sample_time_ms": 12100.11, "learn_time_ms": 3859.553, "learn_throughput": 1036.39, "synch_weights_time_ms": 137.771}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1024, "training_iteration": 38, "trial_id": "185f8_00000", "date": "2025-03-21_11-54-29", "timestamp": 1742558069, "time_this_iter_s": 17.388240337371826, "time_total_s": 600.2076079845428, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 600.2076079845428, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 99.2913043478261, "ram_util_percent": 13.673913043478256}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75820541381836, "policy_loss": -0.012647701427340508, "vf_loss": 9.76953125, "vf_explained_var": -7.947286384535346e-09, "kl": 0.006606628652662039, "entropy": 0.6025604009628296, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 57576.84033203125, "episode_reward_min": 43082.753331542015, "episode_reward_mean": 50041.223611284855, "episode_len_mean": 136.06521739130434, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43082.753331542015}, "policy_reward_max": {"agent_0": 57576.84033203125}, "policy_reward_mean": {"agent_0": 50041.223611284855}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48003.68675994873, 46669.38016319275, 50627.53343009949, 48452.51358413696, 52216.053554058075, 50359.25354719162, 46273.60683441162, 47937.20674133301, 51912.96689605713, 52704.8334980011, 47495.40008378029, 56391.566886901855, 48071.98042297363, 47532.60690307617, 50697.6535949707, 51061.39340591431, 47671.033502578735, 46801.839777469635, 51002.386726379395, 48243.099994659424, 50255.420249938965, 44372.01997900009, 49613.54012298584, 50062.58015155792, 52210.12676239014, 51825.07332992554, 48200.11345863342, 53060.13357543945, 49824.16682624817, 50983.14031982422, 45133.87323093414, 51916.21340179443, 51478.333435058594, 53991.520406246185, 51101.440165787935, 50561.86672592163, 53810.66022872925, 51078.166650772095, 52921.14704704285, 44077.160048007965, 51683.12665468454, 48504.71363449097, 48275.8334980011, 48992.26017510891, 47199.593408584595, 47824.88688850403, 51204.09985733032, 54370.84685134888, 48958.73338222504, 52339.446685791016, 46070.06010055542, 48656.446793079376, 50428.39351081848, 48721.41326904297, 52619.77356338501, 52453.8402671814, 53997.499908447266, 43082.753331542015, 53624.440448760986, 48934.673428058624, 45312.946758270264, 47993.47354745865, 53132.713428497314, 51858.266777038574, 48778.000034332275, 51872.91361808777, 55021.713691711426, 44862.00015449524, 51529.386758208275, 51474.69343948364, 48379.99338531494, 53020.47325134277, 55380.26672363281, 52300.36001586914, 46275.70004081726, 44617.17337226868, 46239.813363075256, 53091.49355316162, 57576.84033203125, 50033.300110816956, 47745.906814575195, 49774.72678184509, 52261.76015663147, 51591.49360537529, 50458.366621017456, 50239.247089385986, 48499.573415756226, 52765.06022644043, 51250.84007358551, 48258.35348033905, 47841.439942359924, 49808.75359466672], "episode_lengths": [136, 136, 136, 135, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 137, 137, 136, 137, 135, 136, 135, 137, 136, 134, 136, 136, 137, 135, 136, 136, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 137, 136, 137, 136, 136, 135, 136, 136, 136, 137, 137, 136, 135, 136, 136, 136, 135, 136, 135, 137, 136, 135, 136, 137, 136, 136, 136, 136, 135, 135, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [48003.68675994873, 46669.38016319275, 50627.53343009949, 48452.51358413696, 52216.053554058075, 50359.25354719162, 46273.60683441162, 47937.20674133301, 51912.96689605713, 52704.8334980011, 47495.40008378029, 56391.566886901855, 48071.98042297363, 47532.60690307617, 50697.6535949707, 51061.39340591431, 47671.033502578735, 46801.839777469635, 51002.386726379395, 48243.099994659424, 50255.420249938965, 44372.01997900009, 49613.54012298584, 50062.58015155792, 52210.12676239014, 51825.07332992554, 48200.11345863342, 53060.13357543945, 49824.16682624817, 50983.14031982422, 45133.87323093414, 51916.21340179443, 51478.333435058594, 53991.520406246185, 51101.440165787935, 50561.86672592163, 53810.66022872925, 51078.166650772095, 52921.14704704285, 44077.160048007965, 51683.12665468454, 48504.71363449097, 48275.8334980011, 48992.26017510891, 47199.593408584595, 47824.88688850403, 51204.09985733032, 54370.84685134888, 48958.73338222504, 52339.446685791016, 46070.06010055542, 48656.446793079376, 50428.39351081848, 48721.41326904297, 52619.77356338501, 52453.8402671814, 53997.499908447266, 43082.753331542015, 53624.440448760986, 48934.673428058624, 45312.946758270264, 47993.47354745865, 53132.713428497314, 51858.266777038574, 48778.000034332275, 51872.91361808777, 55021.713691711426, 44862.00015449524, 51529.386758208275, 51474.69343948364, 48379.99338531494, 53020.47325134277, 55380.26672363281, 52300.36001586914, 46275.70004081726, 44617.17337226868, 46239.813363075256, 53091.49355316162, 57576.84033203125, 50033.300110816956, 47745.906814575195, 49774.72678184509, 52261.76015663147, 51591.49360537529, 50458.366621017456, 50239.247089385986, 48499.573415756226, 52765.06022644043, 51250.84007358551, 48258.35348033905, 47841.439942359924, 49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.76036739168437, "mean_inference_ms": 6.563205709366769, "mean_action_processing_ms": 0.20606543644565048, "mean_env_wait_ms": 225.68442235602325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05079404167507006, "StateBufferConnector_ms": 0.006243716115536897, "ViewRequirementAgentConnector_ms": 0.2313188884569251}}, "episode_reward_max": 57576.84033203125, "episode_reward_min": 43082.753331542015, "episode_reward_mean": 50041.223611284855, "episode_len_mean": 136.06521739130434, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43082.753331542015}, "policy_reward_max": {"agent_0": 57576.84033203125}, "policy_reward_mean": {"agent_0": 50041.223611284855}, "hist_stats": {"episode_reward": [48003.68675994873, 46669.38016319275, 50627.53343009949, 48452.51358413696, 52216.053554058075, 50359.25354719162, 46273.60683441162, 47937.20674133301, 51912.96689605713, 52704.8334980011, 47495.40008378029, 56391.566886901855, 48071.98042297363, 47532.60690307617, 50697.6535949707, 51061.39340591431, 47671.033502578735, 46801.839777469635, 51002.386726379395, 48243.099994659424, 50255.420249938965, 44372.01997900009, 49613.54012298584, 50062.58015155792, 52210.12676239014, 51825.07332992554, 48200.11345863342, 53060.13357543945, 49824.16682624817, 50983.14031982422, 45133.87323093414, 51916.21340179443, 51478.333435058594, 53991.520406246185, 51101.440165787935, 50561.86672592163, 53810.66022872925, 51078.166650772095, 52921.14704704285, 44077.160048007965, 51683.12665468454, 48504.71363449097, 48275.8334980011, 48992.26017510891, 47199.593408584595, 47824.88688850403, 51204.09985733032, 54370.84685134888, 48958.73338222504, 52339.446685791016, 46070.06010055542, 48656.446793079376, 50428.39351081848, 48721.41326904297, 52619.77356338501, 52453.8402671814, 53997.499908447266, 43082.753331542015, 53624.440448760986, 48934.673428058624, 45312.946758270264, 47993.47354745865, 53132.713428497314, 51858.266777038574, 48778.000034332275, 51872.91361808777, 55021.713691711426, 44862.00015449524, 51529.386758208275, 51474.69343948364, 48379.99338531494, 53020.47325134277, 55380.26672363281, 52300.36001586914, 46275.70004081726, 44617.17337226868, 46239.813363075256, 53091.49355316162, 57576.84033203125, 50033.300110816956, 47745.906814575195, 49774.72678184509, 52261.76015663147, 51591.49360537529, 50458.366621017456, 50239.247089385986, 48499.573415756226, 52765.06022644043, 51250.84007358551, 48258.35348033905, 47841.439942359924, 49808.75359466672], "episode_lengths": [136, 136, 136, 135, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 137, 137, 136, 137, 135, 136, 135, 137, 136, 134, 136, 136, 137, 135, 136, 136, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 137, 136, 137, 136, 136, 135, 136, 136, 136, 137, 137, 136, 135, 136, 136, 136, 135, 136, 135, 137, 136, 135, 136, 137, 136, 136, 136, 136, 135, 135, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [48003.68675994873, 46669.38016319275, 50627.53343009949, 48452.51358413696, 52216.053554058075, 50359.25354719162, 46273.60683441162, 47937.20674133301, 51912.96689605713, 52704.8334980011, 47495.40008378029, 56391.566886901855, 48071.98042297363, 47532.60690307617, 50697.6535949707, 51061.39340591431, 47671.033502578735, 46801.839777469635, 51002.386726379395, 48243.099994659424, 50255.420249938965, 44372.01997900009, 49613.54012298584, 50062.58015155792, 52210.12676239014, 51825.07332992554, 48200.11345863342, 53060.13357543945, 49824.16682624817, 50983.14031982422, 45133.87323093414, 51916.21340179443, 51478.333435058594, 53991.520406246185, 51101.440165787935, 50561.86672592163, 53810.66022872925, 51078.166650772095, 52921.14704704285, 44077.160048007965, 51683.12665468454, 48504.71363449097, 48275.8334980011, 48992.26017510891, 47199.593408584595, 47824.88688850403, 51204.09985733032, 54370.84685134888, 48958.73338222504, 52339.446685791016, 46070.06010055542, 48656.446793079376, 50428.39351081848, 48721.41326904297, 52619.77356338501, 52453.8402671814, 53997.499908447266, 43082.753331542015, 53624.440448760986, 48934.673428058624, 45312.946758270264, 47993.47354745865, 53132.713428497314, 51858.266777038574, 48778.000034332275, 51872.91361808777, 55021.713691711426, 44862.00015449524, 51529.386758208275, 51474.69343948364, 48379.99338531494, 53020.47325134277, 55380.26672363281, 52300.36001586914, 46275.70004081726, 44617.17337226868, 46239.813363075256, 53091.49355316162, 57576.84033203125, 50033.300110816956, 47745.906814575195, 49774.72678184509, 52261.76015663147, 51591.49360537529, 50458.366621017456, 50239.247089385986, 48499.573415756226, 52765.06022644043, 51250.84007358551, 48258.35348033905, 47841.439942359924, 49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.76036739168437, "mean_inference_ms": 6.563205709366769, "mean_action_processing_ms": 0.20606543644565048, "mean_env_wait_ms": 225.68442235602325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05079404167507006, "StateBufferConnector_ms": 0.006243716115536897, "ViewRequirementAgentConnector_ms": 0.2313188884569251}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.88820755540152, "num_env_steps_trained_throughput_per_sec": 203.88820755540152, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 16666.074, "sample_time_ms": 12607.404, "learn_time_ms": 3920.412, "learn_throughput": 1020.301, "synch_weights_time_ms": 137.4}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1116, "training_iteration": 39, "trial_id": "185f8_00000", "date": "2025-03-21_11-54-49", "timestamp": 1742558089, "time_this_iter_s": 19.671629667282104, "time_total_s": 619.879237651825, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 619.879237651825, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 95.01481481481481, "ram_util_percent": 13.614814814814816}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989166259765625, "policy_loss": -0.01220779214054346, "vf_loss": 10.0, "vf_explained_var": 7.655471279122139e-08, "kl": 0.006868287455290556, "entropy": 0.5754178166389465, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 49808.75359466672, "episode_reward_min": 49808.75359466672, "episode_reward_mean": 49808.75359466672, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49808.75359466672}, "policy_reward_max": {"agent_0": 49808.75359466672}, "policy_reward_mean": {"agent_0": 49808.75359466672}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49808.75359466672], "episode_lengths": [136], "policy_agent_0_reward": [49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.65000042789359, "mean_inference_ms": 6.282469289029857, "mean_action_processing_ms": 0.20772920216055657, "mean_env_wait_ms": 231.8835271846017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03948211669921875, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1903533935546875}}, "episode_reward_max": 49808.75359466672, "episode_reward_min": 49808.75359466672, "episode_reward_mean": 49808.75359466672, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49808.75359466672}, "policy_reward_max": {"agent_0": 49808.75359466672}, "policy_reward_mean": {"agent_0": 49808.75359466672}, "hist_stats": {"episode_reward": [49808.75359466672], "episode_lengths": [136], "policy_agent_0_reward": [49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.65000042789359, "mean_inference_ms": 6.282469289029857, "mean_action_processing_ms": 0.20772920216055657, "mean_env_wait_ms": 231.8835271846017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03948211669921875, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1903533935546875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.2160682407129, "num_env_steps_trained_throughput_per_sec": 291.2160682407129, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 16376.213, "sample_time_ms": 12210.067, "learn_time_ms": 4017.932, "learn_throughput": 995.537, "synch_weights_time_ms": 147.383}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1116, "training_iteration": 40, "trial_id": "185f8_00000", "date": "2025-03-21_11-55-03", "timestamp": 1742558103, "time_this_iter_s": 13.79322600364685, "time_total_s": 633.6724636554718, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a216c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 633.6724636554718, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.58000000000001, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.990195274353027, "policy_loss": -0.011041446588933468, "vf_loss": 10.0, "vf_explained_var": -1.892447443196943e-07, "kl": 0.006185511592775583, "entropy": 0.5567448735237122, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 49808.75359466672, "episode_reward_min": 49808.75359466672, "episode_reward_mean": 49808.75359466672, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49808.75359466672}, "policy_reward_max": {"agent_0": 49808.75359466672}, "policy_reward_mean": {"agent_0": 49808.75359466672}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49808.75359466672], "episode_lengths": [136], "policy_agent_0_reward": [49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.65000042789359, "mean_inference_ms": 6.282469289029857, "mean_action_processing_ms": 0.20772920216055657, "mean_env_wait_ms": 231.8835271846017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03948211669921875, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1903533935546875}}, "episode_reward_max": 49808.75359466672, "episode_reward_min": 49808.75359466672, "episode_reward_mean": 49808.75359466672, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49808.75359466672}, "policy_reward_max": {"agent_0": 49808.75359466672}, "policy_reward_mean": {"agent_0": 49808.75359466672}, "hist_stats": {"episode_reward": [49808.75359466672], "episode_lengths": [136], "policy_agent_0_reward": [49808.75359466672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.65000042789359, "mean_inference_ms": 6.282469289029857, "mean_action_processing_ms": 0.20772920216055657, "mean_env_wait_ms": 231.8835271846017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03948211669921875, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1903533935546875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.022329404002, "num_env_steps_trained_throughput_per_sec": 276.022329404002, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 15850.569, "sample_time_ms": 11616.577, "learn_time_ms": 4084.668, "learn_throughput": 979.272, "synch_weights_time_ms": 148.502}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1116, "training_iteration": 41, "trial_id": "185f8_00000", "date": "2025-03-21_11-55-17", "timestamp": 1742558117, "time_this_iter_s": 14.542256832122803, "time_total_s": 648.2147204875946, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 648.2147204875946, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.57500000000002, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908506393432617, "policy_loss": -0.012990163639187813, "vf_loss": 9.919921875, "vf_explained_var": 5.656232460182764e-08, "kl": 0.007868503220379353, "entropy": 0.5670928955078125, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 56326.00020980835, "episode_reward_min": 42353.03344345093, "episode_reward_mean": 50789.39805919118, "episode_len_mean": 135.875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42353.03344345093}, "policy_reward_max": {"agent_0": 56326.00020980835}, "policy_reward_mean": {"agent_0": 50789.39805919118}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53746.220138549805, 51315.12655258179, 46474.84659862518, 52169.64677810669, 51599.30695772171, 48457.040159225464, 51729.88705444336, 52582.286710739136, 55014.986978530884, 52484.207094192505, 51047.126646995544, 52500.01336288452, 52100.240045547485, 52660.54023742676, 49972.726987838745, 49237.24680709839, 54235.57349395752, 48477.04676055908, 56326.00020980835, 46384.573434352875, 50043.51353645325, 48775.48025512695, 46825.38692855835, 53840.67337709665, 49938.40018081665, 51177.93336105347, 42353.03344345093, 50676.06686401367, 52454.90008544922, 53170.300090789795, 50903.299949645996, 46587.10681247711], "episode_lengths": [136, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 138, 136, 136, 135, 135, 137, 136, 136, 136, 136, 137], "policy_agent_0_reward": [53746.220138549805, 51315.12655258179, 46474.84659862518, 52169.64677810669, 51599.30695772171, 48457.040159225464, 51729.88705444336, 52582.286710739136, 55014.986978530884, 52484.207094192505, 51047.126646995544, 52500.01336288452, 52100.240045547485, 52660.54023742676, 49972.726987838745, 49237.24680709839, 54235.57349395752, 48477.04676055908, 56326.00020980835, 46384.573434352875, 50043.51353645325, 48775.48025512695, 46825.38692855835, 53840.67337709665, 49938.40018081665, 51177.93336105347, 42353.03344345093, 50676.06686401367, 52454.90008544922, 53170.300090789795, 50903.299949645996, 46587.10681247711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.90384770316362, "mean_inference_ms": 6.328809482637032, "mean_action_processing_ms": 0.20453467073419923, "mean_env_wait_ms": 208.9904172167386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07987245917320251, "StateBufferConnector_ms": 0.006663799285888672, "ViewRequirementAgentConnector_ms": 0.28791576623916626}}, "episode_reward_max": 56326.00020980835, "episode_reward_min": 42353.03344345093, "episode_reward_mean": 50789.39805919118, "episode_len_mean": 135.875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42353.03344345093}, "policy_reward_max": {"agent_0": 56326.00020980835}, "policy_reward_mean": {"agent_0": 50789.39805919118}, "hist_stats": {"episode_reward": [53746.220138549805, 51315.12655258179, 46474.84659862518, 52169.64677810669, 51599.30695772171, 48457.040159225464, 51729.88705444336, 52582.286710739136, 55014.986978530884, 52484.207094192505, 51047.126646995544, 52500.01336288452, 52100.240045547485, 52660.54023742676, 49972.726987838745, 49237.24680709839, 54235.57349395752, 48477.04676055908, 56326.00020980835, 46384.573434352875, 50043.51353645325, 48775.48025512695, 46825.38692855835, 53840.67337709665, 49938.40018081665, 51177.93336105347, 42353.03344345093, 50676.06686401367, 52454.90008544922, 53170.300090789795, 50903.299949645996, 46587.10681247711], "episode_lengths": [136, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 138, 136, 136, 135, 135, 137, 136, 136, 136, 136, 137], "policy_agent_0_reward": [53746.220138549805, 51315.12655258179, 46474.84659862518, 52169.64677810669, 51599.30695772171, 48457.040159225464, 51729.88705444336, 52582.286710739136, 55014.986978530884, 52484.207094192505, 51047.126646995544, 52500.01336288452, 52100.240045547485, 52660.54023742676, 49972.726987838745, 49237.24680709839, 54235.57349395752, 48477.04676055908, 56326.00020980835, 46384.573434352875, 50043.51353645325, 48775.48025512695, 46825.38692855835, 53840.67337709665, 49938.40018081665, 51177.93336105347, 42353.03344345093, 50676.06686401367, 52454.90008544922, 53170.300090789795, 50903.299949645996, 46587.10681247711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.90384770316362, "mean_inference_ms": 6.328809482637032, "mean_action_processing_ms": 0.20453467073419923, "mean_env_wait_ms": 208.9904172167386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07987245917320251, "StateBufferConnector_ms": 0.006663799285888672, "ViewRequirementAgentConnector_ms": 0.28791576623916626}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.81247497895862, "num_env_steps_trained_throughput_per_sec": 231.81247497895862, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 16131.411, "sample_time_ms": 11928.694, "learn_time_ms": 4056.674, "learn_throughput": 986.029, "synch_weights_time_ms": 145.18}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 1148, "training_iteration": 42, "trial_id": "185f8_00000", "date": "2025-03-21_11-55-35", "timestamp": 1742558135, "time_this_iter_s": 17.31468105316162, "time_total_s": 665.5294015407562, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a231c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 665.5294015407562, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 99.35416666666667, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75919246673584, "policy_loss": -0.011706010438501835, "vf_loss": 9.76953125, "vf_explained_var": -1.214444580455165e-07, "kl": 0.006838745437562466, "entropy": 0.5661751627922058, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 56044.27353286743, "episode_reward_min": 44232.066626906395, "episode_reward_mean": 50944.63317111912, "episode_len_mean": 135.72826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44232.066626906395}, "policy_reward_max": {"agent_0": 56044.27353286743}, "policy_reward_mean": {"agent_0": 50944.63317111912}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52974.333320617676, 49721.90010929108, 44232.066626906395, 47902.40675520897, 51372.90014624596, 54717.38684654236, 48464.70657634735, 50170.260122299194, 47172.62702178955, 51275.12010383606, 47756.30681228638, 50197.000188827515, 53124.46031188965, 48195.78009033203, 54729.413471221924, 51313.12687301636, 51447.09342002869, 51802.10028839111, 55308.280128479004, 52675.89356422424, 51883.60006713867, 50275.94011116028, 48313.40661048889, 45133.05986452103, 51191.126667022705, 53218.73359966278, 48263.34014797211, 47554.640016555786, 53548.74677276611, 45869.066655516624, 56044.27353286743, 54381.640033721924, 45742.83373641968, 50148.19997024536, 53702.58716583252, 49960.77329444885, 50886.84003782272, 49371.80668067932, 52354.500186920166, 47742.49353599548, 49533.86003780365, 49164.673347473145, 52725.35997056961, 52021.97326374054, 53291.10005187988, 55661.63385772705, 50857.066719055176, 51535.35339164734, 55149.74034118652, 51597.96034240723, 53856.766845703125, 47945.85323524475, 45702.41349983215, 51526.973373413086, 51501.333568573, 54983.22696685791, 50112.2069568634, 45709.60696029663, 50551.73356437683, 53944.00676727295, 47674.00676727295, 52246.34685087204, 48308.94006538391, 51698.560203552246, 49543.54688644409, 52016.49333190918, 53547.4868183136, 51712.940002441406, 50020.92000770569, 49028.00675678253, 54942.05333805084, 53380.020235061646, 51292.90022468567, 48686.93356895447, 50206.24016666412, 53865.833404541016, 46083.826652526855, 51999.16014099121, 49372.50026035309, 52564.92681503296, 46963.76000213623, 52550.59322166443, 53641.26014328003, 54390.153549194336, 53782.306911468506, 49631.41351699829, 53170.773429870605, 45013.973533034325, 52647.17346954346, 54723.08670043945, 50693.22671127319, 53993.273529052734], "episode_lengths": [136, 136, 136, 136, 136, 135, 137, 136, 136, 136, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 136, 136, 135, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 136, 136, 135, 137, 136, 136, 135, 137, 136, 135, 136, 136, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52974.333320617676, 49721.90010929108, 44232.066626906395, 47902.40675520897, 51372.90014624596, 54717.38684654236, 48464.70657634735, 50170.260122299194, 47172.62702178955, 51275.12010383606, 47756.30681228638, 50197.000188827515, 53124.46031188965, 48195.78009033203, 54729.413471221924, 51313.12687301636, 51447.09342002869, 51802.10028839111, 55308.280128479004, 52675.89356422424, 51883.60006713867, 50275.94011116028, 48313.40661048889, 45133.05986452103, 51191.126667022705, 53218.73359966278, 48263.34014797211, 47554.640016555786, 53548.74677276611, 45869.066655516624, 56044.27353286743, 54381.640033721924, 45742.83373641968, 50148.19997024536, 53702.58716583252, 49960.77329444885, 50886.84003782272, 49371.80668067932, 52354.500186920166, 47742.49353599548, 49533.86003780365, 49164.673347473145, 52725.35997056961, 52021.97326374054, 53291.10005187988, 55661.63385772705, 50857.066719055176, 51535.35339164734, 55149.74034118652, 51597.96034240723, 53856.766845703125, 47945.85323524475, 45702.41349983215, 51526.973373413086, 51501.333568573, 54983.22696685791, 50112.2069568634, 45709.60696029663, 50551.73356437683, 53944.00676727295, 47674.00676727295, 52246.34685087204, 48308.94006538391, 51698.560203552246, 49543.54688644409, 52016.49333190918, 53547.4868183136, 51712.940002441406, 50020.92000770569, 49028.00675678253, 54942.05333805084, 53380.020235061646, 51292.90022468567, 48686.93356895447, 50206.24016666412, 53865.833404541016, 46083.826652526855, 51999.16014099121, 49372.50026035309, 52564.92681503296, 46963.76000213623, 52550.59322166443, 53641.26014328003, 54390.153549194336, 53782.306911468506, 49631.41351699829, 53170.773429870605, 45013.973533034325, 52647.17346954346, 54723.08670043945, 50693.22671127319, 53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.3237757234434, "mean_inference_ms": 6.59508995116858, "mean_action_processing_ms": 0.20585318780939818, "mean_env_wait_ms": 226.14077656613333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04287310268567956, "StateBufferConnector_ms": 0.027338318202806557, "ViewRequirementAgentConnector_ms": 0.20155440206113068}}, "episode_reward_max": 56044.27353286743, "episode_reward_min": 44232.066626906395, "episode_reward_mean": 50944.63317111912, "episode_len_mean": 135.72826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44232.066626906395}, "policy_reward_max": {"agent_0": 56044.27353286743}, "policy_reward_mean": {"agent_0": 50944.63317111912}, "hist_stats": {"episode_reward": [52974.333320617676, 49721.90010929108, 44232.066626906395, 47902.40675520897, 51372.90014624596, 54717.38684654236, 48464.70657634735, 50170.260122299194, 47172.62702178955, 51275.12010383606, 47756.30681228638, 50197.000188827515, 53124.46031188965, 48195.78009033203, 54729.413471221924, 51313.12687301636, 51447.09342002869, 51802.10028839111, 55308.280128479004, 52675.89356422424, 51883.60006713867, 50275.94011116028, 48313.40661048889, 45133.05986452103, 51191.126667022705, 53218.73359966278, 48263.34014797211, 47554.640016555786, 53548.74677276611, 45869.066655516624, 56044.27353286743, 54381.640033721924, 45742.83373641968, 50148.19997024536, 53702.58716583252, 49960.77329444885, 50886.84003782272, 49371.80668067932, 52354.500186920166, 47742.49353599548, 49533.86003780365, 49164.673347473145, 52725.35997056961, 52021.97326374054, 53291.10005187988, 55661.63385772705, 50857.066719055176, 51535.35339164734, 55149.74034118652, 51597.96034240723, 53856.766845703125, 47945.85323524475, 45702.41349983215, 51526.973373413086, 51501.333568573, 54983.22696685791, 50112.2069568634, 45709.60696029663, 50551.73356437683, 53944.00676727295, 47674.00676727295, 52246.34685087204, 48308.94006538391, 51698.560203552246, 49543.54688644409, 52016.49333190918, 53547.4868183136, 51712.940002441406, 50020.92000770569, 49028.00675678253, 54942.05333805084, 53380.020235061646, 51292.90022468567, 48686.93356895447, 50206.24016666412, 53865.833404541016, 46083.826652526855, 51999.16014099121, 49372.50026035309, 52564.92681503296, 46963.76000213623, 52550.59322166443, 53641.26014328003, 54390.153549194336, 53782.306911468506, 49631.41351699829, 53170.773429870605, 45013.973533034325, 52647.17346954346, 54723.08670043945, 50693.22671127319, 53993.273529052734], "episode_lengths": [136, 136, 136, 136, 136, 135, 137, 136, 136, 136, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 136, 136, 135, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 136, 136, 135, 137, 136, 136, 135, 137, 136, 135, 136, 136, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52974.333320617676, 49721.90010929108, 44232.066626906395, 47902.40675520897, 51372.90014624596, 54717.38684654236, 48464.70657634735, 50170.260122299194, 47172.62702178955, 51275.12010383606, 47756.30681228638, 50197.000188827515, 53124.46031188965, 48195.78009033203, 54729.413471221924, 51313.12687301636, 51447.09342002869, 51802.10028839111, 55308.280128479004, 52675.89356422424, 51883.60006713867, 50275.94011116028, 48313.40661048889, 45133.05986452103, 51191.126667022705, 53218.73359966278, 48263.34014797211, 47554.640016555786, 53548.74677276611, 45869.066655516624, 56044.27353286743, 54381.640033721924, 45742.83373641968, 50148.19997024536, 53702.58716583252, 49960.77329444885, 50886.84003782272, 49371.80668067932, 52354.500186920166, 47742.49353599548, 49533.86003780365, 49164.673347473145, 52725.35997056961, 52021.97326374054, 53291.10005187988, 55661.63385772705, 50857.066719055176, 51535.35339164734, 55149.74034118652, 51597.96034240723, 53856.766845703125, 47945.85323524475, 45702.41349983215, 51526.973373413086, 51501.333568573, 54983.22696685791, 50112.2069568634, 45709.60696029663, 50551.73356437683, 53944.00676727295, 47674.00676727295, 52246.34685087204, 48308.94006538391, 51698.560203552246, 49543.54688644409, 52016.49333190918, 53547.4868183136, 51712.940002441406, 50020.92000770569, 49028.00675678253, 54942.05333805084, 53380.020235061646, 51292.90022468567, 48686.93356895447, 50206.24016666412, 53865.833404541016, 46083.826652526855, 51999.16014099121, 49372.50026035309, 52564.92681503296, 46963.76000213623, 52550.59322166443, 53641.26014328003, 54390.153549194336, 53782.306911468506, 49631.41351699829, 53170.773429870605, 45013.973533034325, 52647.17346954346, 54723.08670043945, 50693.22671127319, 53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.3237757234434, "mean_inference_ms": 6.59508995116858, "mean_action_processing_ms": 0.20585318780939818, "mean_env_wait_ms": 226.14077656613333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04287310268567956, "StateBufferConnector_ms": 0.027338318202806557, "ViewRequirementAgentConnector_ms": 0.20155440206113068}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.73485942346818, "num_env_steps_trained_throughput_per_sec": 211.73485942346818, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 16633.408, "sample_time_ms": 12416.524, "learn_time_ms": 4067.084, "learn_throughput": 983.506, "synch_weights_time_ms": 148.93}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 1240, "training_iteration": 43, "trial_id": "185f8_00000", "date": "2025-03-21_11-55-54", "timestamp": 1742558154, "time_this_iter_s": 18.951775550842285, "time_total_s": 684.4811770915985, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0d8f400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 684.4811770915985, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 94.27307692307691, "ram_util_percent": 13.638461538461538}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987197875976562, "policy_loss": -0.01449816394597292, "vf_loss": 10.0, "vf_explained_var": -6.488213699640255e-08, "kl": 0.008481398224830627, "entropy": 0.5174678564071655, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 53993.273529052734, "episode_reward_min": 53993.273529052734, "episode_reward_mean": 53993.273529052734, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53993.273529052734}, "policy_reward_max": {"agent_0": 53993.273529052734}, "policy_reward_mean": {"agent_0": 53993.273529052734}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53993.273529052734], "episode_lengths": [135], "policy_agent_0_reward": [53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.26295528120984, "mean_inference_ms": 6.311160719905457, "mean_action_processing_ms": 0.20677349060102918, "mean_env_wait_ms": 229.70994867617094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03628730773925781, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.15821456909179688}}, "episode_reward_max": 53993.273529052734, "episode_reward_min": 53993.273529052734, "episode_reward_mean": 53993.273529052734, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53993.273529052734}, "policy_reward_max": {"agent_0": 53993.273529052734}, "policy_reward_mean": {"agent_0": 53993.273529052734}, "hist_stats": {"episode_reward": [53993.273529052734], "episode_lengths": [135], "policy_agent_0_reward": [53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.26295528120984, "mean_inference_ms": 6.311160719905457, "mean_action_processing_ms": 0.20677349060102918, "mean_env_wait_ms": 229.70994867617094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03628730773925781, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.15821456909179688}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.5716307412058, "num_env_steps_trained_throughput_per_sec": 277.5716307412058, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 16246.202, "sample_time_ms": 12051.748, "learn_time_ms": 4042.166, "learn_throughput": 989.569, "synch_weights_time_ms": 151.431}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 1240, "training_iteration": 44, "trial_id": "185f8_00000", "date": "2025-03-21_11-56-08", "timestamp": 1742558168, "time_this_iter_s": 14.460437774658203, "time_total_s": 698.9416148662567, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 698.9416148662567, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.4809523809524, "ram_util_percent": 13.695238095238093}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98813247680664, "policy_loss": -0.013319491408765316, "vf_loss": 10.0, "vf_explained_var": -1.6205012443037958e-08, "kl": 0.007259811274707317, "entropy": 0.5201044678688049, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 53993.273529052734, "episode_reward_min": 53993.273529052734, "episode_reward_mean": 53993.273529052734, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53993.273529052734}, "policy_reward_max": {"agent_0": 53993.273529052734}, "policy_reward_mean": {"agent_0": 53993.273529052734}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53993.273529052734], "episode_lengths": [135], "policy_agent_0_reward": [53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.26295528120984, "mean_inference_ms": 6.311160719905457, "mean_action_processing_ms": 0.20677349060102918, "mean_env_wait_ms": 229.70994867617094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03628730773925781, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.15821456909179688}}, "episode_reward_max": 53993.273529052734, "episode_reward_min": 53993.273529052734, "episode_reward_mean": 53993.273529052734, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53993.273529052734}, "policy_reward_max": {"agent_0": 53993.273529052734}, "policy_reward_mean": {"agent_0": 53993.273529052734}, "hist_stats": {"episode_reward": [53993.273529052734], "episode_lengths": [135], "policy_agent_0_reward": [53993.273529052734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.26295528120984, "mean_inference_ms": 6.311160719905457, "mean_action_processing_ms": 0.20677349060102918, "mean_env_wait_ms": 229.70994867617094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03628730773925781, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.15821456909179688}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.46550290168125, "num_env_steps_trained_throughput_per_sec": 281.46550290168125, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 15803.692, "sample_time_ms": 11592.791, "learn_time_ms": 4056.432, "learn_throughput": 986.088, "synch_weights_time_ms": 153.622}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 1240, "training_iteration": 45, "trial_id": "185f8_00000", "date": "2025-03-21_11-56-23", "timestamp": 1742558183, "time_this_iter_s": 14.263721227645874, "time_total_s": 713.2053360939026, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 713.2053360939026, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.61, "ram_util_percent": 13.64}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.905975341796875, "policy_loss": -0.01388951949775219, "vf_loss": 9.917970657348633, "vf_explained_var": -7.905810889496934e-06, "kl": 0.009469802491366863, "entropy": 0.5376777648925781, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 56325.26693725586, "episode_reward_min": 42697.89340019226, "episode_reward_mean": 50401.256585713476, "episode_len_mean": 135.6875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42697.89340019226}, "policy_reward_max": {"agent_0": 56325.26693725586}, "policy_reward_mean": {"agent_0": 50401.256585713476}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50124.27356719971, 53070.78679084778, 50508.48675632477, 53086.793478012085, 50444.07322263718, 45817.76013183594, 49167.32688522339, 53866.36002731323, 56325.26693725586, 54801.39359474182, 45516.927070617676, 53015.82020187378, 48676.17331695557, 50001.42699718475, 52626.65987491608, 48778.32673406601, 48586.02686190605, 43579.15350437164, 52941.386778354645, 49022.153517246246, 52467.6799325943, 54960.860191345215, 45908.193408966064, 53554.30679321289, 51917.83335876465, 42697.89340019226, 50194.19349861145, 52286.87324714661, 53657.49376296997, 49202.566858291626, 51477.38653385639, 44558.353507995605], "episode_lengths": [136, 135, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136], "policy_agent_0_reward": [50124.27356719971, 53070.78679084778, 50508.48675632477, 53086.793478012085, 50444.07322263718, 45817.76013183594, 49167.32688522339, 53866.36002731323, 56325.26693725586, 54801.39359474182, 45516.927070617676, 53015.82020187378, 48676.17331695557, 50001.42699718475, 52626.65987491608, 48778.32673406601, 48586.02686190605, 43579.15350437164, 52941.386778354645, 49022.153517246246, 52467.6799325943, 54960.860191345215, 45908.193408966064, 53554.30679321289, 51917.83335876465, 42697.89340019226, 50194.19349861145, 52286.87324714661, 53657.49376296997, 49202.566858291626, 51477.38653385639, 44558.353507995605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.15009989151443, "mean_inference_ms": 6.370485343966067, "mean_action_processing_ms": 0.20445121539274747, "mean_env_wait_ms": 208.9636999919981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04230290651321411, "StateBufferConnector_ms": 0.0347822904586792, "ViewRequirementAgentConnector_ms": 0.2648688852787018}}, "episode_reward_max": 56325.26693725586, "episode_reward_min": 42697.89340019226, "episode_reward_mean": 50401.256585713476, "episode_len_mean": 135.6875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42697.89340019226}, "policy_reward_max": {"agent_0": 56325.26693725586}, "policy_reward_mean": {"agent_0": 50401.256585713476}, "hist_stats": {"episode_reward": [50124.27356719971, 53070.78679084778, 50508.48675632477, 53086.793478012085, 50444.07322263718, 45817.76013183594, 49167.32688522339, 53866.36002731323, 56325.26693725586, 54801.39359474182, 45516.927070617676, 53015.82020187378, 48676.17331695557, 50001.42699718475, 52626.65987491608, 48778.32673406601, 48586.02686190605, 43579.15350437164, 52941.386778354645, 49022.153517246246, 52467.6799325943, 54960.860191345215, 45908.193408966064, 53554.30679321289, 51917.83335876465, 42697.89340019226, 50194.19349861145, 52286.87324714661, 53657.49376296997, 49202.566858291626, 51477.38653385639, 44558.353507995605], "episode_lengths": [136, 135, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 136, 136, 136], "policy_agent_0_reward": [50124.27356719971, 53070.78679084778, 50508.48675632477, 53086.793478012085, 50444.07322263718, 45817.76013183594, 49167.32688522339, 53866.36002731323, 56325.26693725586, 54801.39359474182, 45516.927070617676, 53015.82020187378, 48676.17331695557, 50001.42699718475, 52626.65987491608, 48778.32673406601, 48586.02686190605, 43579.15350437164, 52941.386778354645, 49022.153517246246, 52467.6799325943, 54960.860191345215, 45908.193408966064, 53554.30679321289, 51917.83335876465, 42697.89340019226, 50194.19349861145, 52286.87324714661, 53657.49376296997, 49202.566858291626, 51477.38653385639, 44558.353507995605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.15009989151443, "mean_inference_ms": 6.370485343966067, "mean_action_processing_ms": 0.20445121539274747, "mean_env_wait_ms": 208.9636999919981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04230290651321411, "StateBufferConnector_ms": 0.0347822904586792, "ViewRequirementAgentConnector_ms": 0.2648688852787018}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.88214015993003, "num_env_steps_trained_throughput_per_sec": 234.88214015993003, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 16072.308, "sample_time_ms": 11783.49, "learn_time_ms": 4118.315, "learn_throughput": 971.271, "synch_weights_time_ms": 169.633}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 1272, "training_iteration": 46, "trial_id": "185f8_00000", "date": "2025-03-21_11-56-40", "timestamp": 1742558200, "time_this_iter_s": 17.105119466781616, "time_total_s": 730.3104555606842, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a232e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 730.3104555606842, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 99.316, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.912306785583496, "policy_loss": -0.012237627990543842, "vf_loss": 9.923096656799316, "vf_explained_var": -6.572529855475295e-06, "kl": 0.0072396607138216496, "entropy": 0.552500307559967, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 56100.50668525696, "episode_reward_min": 40511.41997528076, "episode_reward_mean": 51044.22443165318, "episode_len_mean": 135.29032258064515, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 40511.41997528076}, "policy_reward_max": {"agent_0": 56100.50668525696}, "policy_reward_mean": {"agent_0": 51044.22443165318}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52920.54668998718, 53202.44705200195, 52692.68033409119, 49936.5933971405, 53477.38018798828, 52031.58693122864, 55812.106689453125, 50179.21355056763, 49938.26676940918, 55035.953466415405, 51063.40684509277, 52885.340032577515, 48757.39353752136, 56100.50668525696, 44514.86014652252, 51474.03347015381, 51979.58679962158, 53706.48013496399, 54679.387004852295, 49830.71995162964, 51414.16019821167, 46535.4734787941, 44045.380084991455, 48597.61998271942, 53620.326778411865, 49520.47348403931, 52616.573247909546, 53733.00671386719, 50841.22034072876, 40511.41997528076, 50716.81341981888], "episode_lengths": [136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 134, 135, 135, 136, 136, 135, 136, 134, 136, 135, 135, 136, 136], "policy_agent_0_reward": [52920.54668998718, 53202.44705200195, 52692.68033409119, 49936.5933971405, 53477.38018798828, 52031.58693122864, 55812.106689453125, 50179.21355056763, 49938.26676940918, 55035.953466415405, 51063.40684509277, 52885.340032577515, 48757.39353752136, 56100.50668525696, 44514.86014652252, 51474.03347015381, 51979.58679962158, 53706.48013496399, 54679.387004852295, 49830.71995162964, 51414.16019821167, 46535.4734787941, 44045.380084991455, 48597.61998271942, 53620.326778411865, 49520.47348403931, 52616.573247909546, 53733.00671386719, 50841.22034072876, 40511.41997528076, 50716.81341981888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.552309536445875, "mean_inference_ms": 6.582728899913947, "mean_action_processing_ms": 0.20579925343328806, "mean_env_wait_ms": 225.19016345588992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07656928031675277, "StateBufferConnector_ms": 0.0058512533864667335, "ViewRequirementAgentConnector_ms": 0.2590148679671749}}, "episode_reward_max": 56100.50668525696, "episode_reward_min": 40511.41997528076, "episode_reward_mean": 51044.22443165318, "episode_len_mean": 135.29032258064515, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 40511.41997528076}, "policy_reward_max": {"agent_0": 56100.50668525696}, "policy_reward_mean": {"agent_0": 51044.22443165318}, "hist_stats": {"episode_reward": [52920.54668998718, 53202.44705200195, 52692.68033409119, 49936.5933971405, 53477.38018798828, 52031.58693122864, 55812.106689453125, 50179.21355056763, 49938.26676940918, 55035.953466415405, 51063.40684509277, 52885.340032577515, 48757.39353752136, 56100.50668525696, 44514.86014652252, 51474.03347015381, 51979.58679962158, 53706.48013496399, 54679.387004852295, 49830.71995162964, 51414.16019821167, 46535.4734787941, 44045.380084991455, 48597.61998271942, 53620.326778411865, 49520.47348403931, 52616.573247909546, 53733.00671386719, 50841.22034072876, 40511.41997528076, 50716.81341981888], "episode_lengths": [136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 134, 135, 135, 136, 136, 135, 136, 134, 136, 135, 135, 136, 136], "policy_agent_0_reward": [52920.54668998718, 53202.44705200195, 52692.68033409119, 49936.5933971405, 53477.38018798828, 52031.58693122864, 55812.106689453125, 50179.21355056763, 49938.26676940918, 55035.953466415405, 51063.40684509277, 52885.340032577515, 48757.39353752136, 56100.50668525696, 44514.86014652252, 51474.03347015381, 51979.58679962158, 53706.48013496399, 54679.387004852295, 49830.71995162964, 51414.16019821167, 46535.4734787941, 44045.380084991455, 48597.61998271942, 53620.326778411865, 49520.47348403931, 52616.573247909546, 53733.00671386719, 50841.22034072876, 40511.41997528076, 50716.81341981888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.552309536445875, "mean_inference_ms": 6.582728899913947, "mean_action_processing_ms": 0.20579925343328806, "mean_env_wait_ms": 225.19016345588992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07656928031675277, "StateBufferConnector_ms": 0.0058512533864667335, "ViewRequirementAgentConnector_ms": 0.2590148679671749}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.15794222232364, "num_env_steps_trained_throughput_per_sec": 284.15794222232364, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 16104.187, "sample_time_ms": 11833.302, "learn_time_ms": 4098.397, "learn_throughput": 975.991, "synch_weights_time_ms": 171.614}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 1303, "training_iteration": 47, "trial_id": "185f8_00000", "date": "2025-03-21_11-56-54", "timestamp": 1742558214, "time_this_iter_s": 14.119965076446533, "time_total_s": 744.4304206371307, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 744.4304206371307, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 95.51578947368421, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.835535049438477, "policy_loss": -0.014278910122811794, "vf_loss": 9.848150253295898, "vf_explained_var": 3.5097823456453625e-06, "kl": 0.008310486562550068, "entropy": 0.5218773484230042, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 55600.386863708496, "episode_reward_min": 41809.07349228859, "episode_reward_mean": 50483.18708487906, "episode_len_mean": 135.72131147540983, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {"agent_0": 41809.07349228859}, "policy_reward_max": {"agent_0": 55600.386863708496}, "policy_reward_mean": {"agent_0": 50483.18708487906}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48211.54011821747, 48222.49330997467, 45213.67363166809, 55507.806732177734, 50396.373542785645, 51698.44009590149, 51587.25332343578, 47273.31338703632, 53273.47333526611, 50971.993198394775, 54229.03344535828, 50565.0266456604, 52301.446908950806, 49710.70674133301, 50733.47369194031, 51664.79321670532, 49914.006652235985, 48069.62009429932, 50495.533573150635, 52718.68016052246, 50996.56019115448, 53203.8065032959, 54930.10704803467, 45376.39342689514, 48893.46660041809, 50731.113399505615, 53629.16701889038, 52934.566650390625, 53084.73344421387, 42774.073291778564, 51946.853256225586, 52013.85332107544, 50896.10660272837, 51421.033363342285, 43294.1067199707, 49123.45332336426, 55600.386863708496, 52028.55349993706, 50987.06027793884, 44012.733501434326, 53541.12682342529, 51145.433349609375, 51939.40019798279, 44155.160095095634, 48381.36692428589, 52871.12673854828, 53838.62664794922, 48883.746504068375, 52915.71343040466, 51946.00010108948, 55372.73358154297, 54620.32018280029, 50004.020067214966, 51237.16001224518, 53827.24671268463, 51030.466873168945, 41809.07349228859, 50642.69337081909, 45736.21336936951, 44309.92002391815, 50630.0535697937], "episode_lengths": [136, 136, 137, 135, 137, 136, 135, 136, 136, 136, 135, 136, 135, 136, 136, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 137, 135, 136, 136, 136, 137, 135, 136, 136, 135, 137, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 137, 136, 136, 136, 136, 136, 135, 136, 135], "policy_agent_0_reward": [48211.54011821747, 48222.49330997467, 45213.67363166809, 55507.806732177734, 50396.373542785645, 51698.44009590149, 51587.25332343578, 47273.31338703632, 53273.47333526611, 50971.993198394775, 54229.03344535828, 50565.0266456604, 52301.446908950806, 49710.70674133301, 50733.47369194031, 51664.79321670532, 49914.006652235985, 48069.62009429932, 50495.533573150635, 52718.68016052246, 50996.56019115448, 53203.8065032959, 54930.10704803467, 45376.39342689514, 48893.46660041809, 50731.113399505615, 53629.16701889038, 52934.566650390625, 53084.73344421387, 42774.073291778564, 51946.853256225586, 52013.85332107544, 50896.10660272837, 51421.033363342285, 43294.1067199707, 49123.45332336426, 55600.386863708496, 52028.55349993706, 50987.06027793884, 44012.733501434326, 53541.12682342529, 51145.433349609375, 51939.40019798279, 44155.160095095634, 48381.36692428589, 52871.12673854828, 53838.62664794922, 48883.746504068375, 52915.71343040466, 51946.00010108948, 55372.73358154297, 54620.32018280029, 50004.020067214966, 51237.16001224518, 53827.24671268463, 51030.466873168945, 41809.07349228859, 50642.69337081909, 45736.21336936951, 44309.92002391815, 50630.0535697937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.602406416927316, "mean_inference_ms": 6.623118126943039, "mean_action_processing_ms": 0.20488350065662542, "mean_env_wait_ms": 225.27981412460701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044956363615442495, "StateBufferConnector_ms": 0.006293859638151576, "ViewRequirementAgentConnector_ms": 0.27811214572093523}}, "episode_reward_max": 55600.386863708496, "episode_reward_min": 41809.07349228859, "episode_reward_mean": 50483.18708487906, "episode_len_mean": 135.72131147540983, "episodes_this_iter": 61, "policy_reward_min": {"agent_0": 41809.07349228859}, "policy_reward_max": {"agent_0": 55600.386863708496}, "policy_reward_mean": {"agent_0": 50483.18708487906}, "hist_stats": {"episode_reward": [48211.54011821747, 48222.49330997467, 45213.67363166809, 55507.806732177734, 50396.373542785645, 51698.44009590149, 51587.25332343578, 47273.31338703632, 53273.47333526611, 50971.993198394775, 54229.03344535828, 50565.0266456604, 52301.446908950806, 49710.70674133301, 50733.47369194031, 51664.79321670532, 49914.006652235985, 48069.62009429932, 50495.533573150635, 52718.68016052246, 50996.56019115448, 53203.8065032959, 54930.10704803467, 45376.39342689514, 48893.46660041809, 50731.113399505615, 53629.16701889038, 52934.566650390625, 53084.73344421387, 42774.073291778564, 51946.853256225586, 52013.85332107544, 50896.10660272837, 51421.033363342285, 43294.1067199707, 49123.45332336426, 55600.386863708496, 52028.55349993706, 50987.06027793884, 44012.733501434326, 53541.12682342529, 51145.433349609375, 51939.40019798279, 44155.160095095634, 48381.36692428589, 52871.12673854828, 53838.62664794922, 48883.746504068375, 52915.71343040466, 51946.00010108948, 55372.73358154297, 54620.32018280029, 50004.020067214966, 51237.16001224518, 53827.24671268463, 51030.466873168945, 41809.07349228859, 50642.69337081909, 45736.21336936951, 44309.92002391815, 50630.0535697937], "episode_lengths": [136, 136, 137, 135, 137, 136, 135, 136, 136, 136, 135, 136, 135, 136, 136, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 137, 135, 136, 136, 136, 137, 135, 136, 136, 135, 137, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 137, 136, 136, 136, 136, 136, 135, 136, 135], "policy_agent_0_reward": [48211.54011821747, 48222.49330997467, 45213.67363166809, 55507.806732177734, 50396.373542785645, 51698.44009590149, 51587.25332343578, 47273.31338703632, 53273.47333526611, 50971.993198394775, 54229.03344535828, 50565.0266456604, 52301.446908950806, 49710.70674133301, 50733.47369194031, 51664.79321670532, 49914.006652235985, 48069.62009429932, 50495.533573150635, 52718.68016052246, 50996.56019115448, 53203.8065032959, 54930.10704803467, 45376.39342689514, 48893.46660041809, 50731.113399505615, 53629.16701889038, 52934.566650390625, 53084.73344421387, 42774.073291778564, 51946.853256225586, 52013.85332107544, 50896.10660272837, 51421.033363342285, 43294.1067199707, 49123.45332336426, 55600.386863708496, 52028.55349993706, 50987.06027793884, 44012.733501434326, 53541.12682342529, 51145.433349609375, 51939.40019798279, 44155.160095095634, 48381.36692428589, 52871.12673854828, 53838.62664794922, 48883.746504068375, 52915.71343040466, 51946.00010108948, 55372.73358154297, 54620.32018280029, 50004.020067214966, 51237.16001224518, 53827.24671268463, 51030.466873168945, 41809.07349228859, 50642.69337081909, 45736.21336936951, 44309.92002391815, 50630.0535697937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.602406416927316, "mean_inference_ms": 6.623118126943039, "mean_action_processing_ms": 0.20488350065662542, "mean_env_wait_ms": 225.27981412460701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044956363615442495, "StateBufferConnector_ms": 0.006293859638151576, "ViewRequirementAgentConnector_ms": 0.27811214572093523}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.21762513939845, "num_env_steps_trained_throughput_per_sec": 212.21762513939845, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 16256.896, "sample_time_ms": 11975.69, "learn_time_ms": 4111.131, "learn_throughput": 972.968, "synch_weights_time_ms": 169.08}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 1364, "training_iteration": 48, "trial_id": "185f8_00000", "date": "2025-03-21_11-57-13", "timestamp": 1742558233, "time_this_iter_s": 18.906733512878418, "time_total_s": 763.3371541500092, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 763.3371541500092, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 98.3923076923077, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98569393157959, "policy_loss": -0.016149070113897324, "vf_loss": 10.0, "vf_explained_var": -1.1560445273062214e-05, "kl": 0.009213355369865894, "entropy": 0.5320990085601807, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 50630.0535697937, "episode_reward_min": 50630.0535697937, "episode_reward_mean": 50630.0535697937, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50630.0535697937}, "policy_reward_max": {"agent_0": 50630.0535697937}, "policy_reward_mean": {"agent_0": 50630.0535697937}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50630.0535697937], "episode_lengths": [135], "policy_agent_0_reward": [50630.0535697937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.195582164598115, "mean_inference_ms": 6.340107517577489, "mean_action_processing_ms": 0.20684029424663636, "mean_env_wait_ms": 218.24401884631203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04565715789794922, "StateBufferConnector_ms": 0.006890296936035156, "ViewRequirementAgentConnector_ms": 0.19729137420654297}}, "episode_reward_max": 50630.0535697937, "episode_reward_min": 50630.0535697937, "episode_reward_mean": 50630.0535697937, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50630.0535697937}, "policy_reward_max": {"agent_0": 50630.0535697937}, "policy_reward_mean": {"agent_0": 50630.0535697937}, "hist_stats": {"episode_reward": [50630.0535697937], "episode_lengths": [135], "policy_agent_0_reward": [50630.0535697937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.195582164598115, "mean_inference_ms": 6.340107517577489, "mean_action_processing_ms": 0.20684029424663636, "mean_env_wait_ms": 218.24401884631203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04565715789794922, "StateBufferConnector_ms": 0.006890296936035156, "ViewRequirementAgentConnector_ms": 0.19729137420654297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.7050530825091, "num_env_steps_trained_throughput_per_sec": 281.7050530825091, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 15714.964, "sample_time_ms": 11469.251, "learn_time_ms": 4075.059, "learn_throughput": 981.581, "synch_weights_time_ms": 169.672}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 1364, "training_iteration": 49, "trial_id": "185f8_00000", "date": "2025-03-21_11-57-27", "timestamp": 1742558247, "time_this_iter_s": 14.248288631439209, "time_total_s": 777.5854427814484, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0d8f400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 777.5854427814484, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.54, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.907340049743652, "policy_loss": -0.014020871371030807, "vf_loss": 9.919690132141113, "vf_explained_var": -1.3336538984276558e-07, "kl": 0.00835209246724844, "entropy": 0.552565336227417, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 56542.24674987793, "episode_reward_min": 43557.90679574013, "episode_reward_mean": 50806.57491680235, "episode_len_mean": 135.71875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43557.90679574013}, "policy_reward_max": {"agent_0": 56542.24674987793}, "policy_reward_mean": {"agent_0": 50806.57491680235}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48175.88697767258, 50521.753454208374, 51295.42018890381, 44048.26019859314, 51206.593334198, 52476.86689949036, 56542.24674987793, 52952.76670837402, 51854.80667877197, 48798.726680755615, 49241.053550720215, 54059.926818847656, 48277.5334444046, 53354.01359319687, 52617.42698287964, 47518.97332048416, 44377.13349914551, 45593.14686203003, 54780.40684509277, 51256.69344329834, 53101.64005470276, 52588.98670387268, 55811.46691894531, 43557.90679574013, 48863.34656333923, 53329.420150756836, 54784.96011352539, 51136.806858062744, 48922.686584472656, 53404.013387680054, 49410.94690704346, 51948.58006858826], "episode_lengths": [136, 135, 136, 136, 135, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 135, 137, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 137], "policy_agent_0_reward": [48175.88697767258, 50521.753454208374, 51295.42018890381, 44048.26019859314, 51206.593334198, 52476.86689949036, 56542.24674987793, 52952.76670837402, 51854.80667877197, 48798.726680755615, 49241.053550720215, 54059.926818847656, 48277.5334444046, 53354.01359319687, 52617.42698287964, 47518.97332048416, 44377.13349914551, 45593.14686203003, 54780.40684509277, 51256.69344329834, 53101.64005470276, 52588.98670387268, 55811.46691894531, 43557.90679574013, 48863.34656333923, 53329.420150756836, 54784.96011352539, 51136.806858062744, 48922.686584472656, 53404.013387680054, 49410.94690704346, 51948.58006858826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.005215458080016, "mean_inference_ms": 6.372984645404216, "mean_action_processing_ms": 0.20505039800953534, "mean_env_wait_ms": 209.94169832286804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06108582019805908, "StateBufferConnector_ms": 0.006485730409622192, "ViewRequirementAgentConnector_ms": 0.25964826345443726}}, "episode_reward_max": 56542.24674987793, "episode_reward_min": 43557.90679574013, "episode_reward_mean": 50806.57491680235, "episode_len_mean": 135.71875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43557.90679574013}, "policy_reward_max": {"agent_0": 56542.24674987793}, "policy_reward_mean": {"agent_0": 50806.57491680235}, "hist_stats": {"episode_reward": [48175.88697767258, 50521.753454208374, 51295.42018890381, 44048.26019859314, 51206.593334198, 52476.86689949036, 56542.24674987793, 52952.76670837402, 51854.80667877197, 48798.726680755615, 49241.053550720215, 54059.926818847656, 48277.5334444046, 53354.01359319687, 52617.42698287964, 47518.97332048416, 44377.13349914551, 45593.14686203003, 54780.40684509277, 51256.69344329834, 53101.64005470276, 52588.98670387268, 55811.46691894531, 43557.90679574013, 48863.34656333923, 53329.420150756836, 54784.96011352539, 51136.806858062744, 48922.686584472656, 53404.013387680054, 49410.94690704346, 51948.58006858826], "episode_lengths": [136, 135, 136, 136, 135, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 135, 137, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 137], "policy_agent_0_reward": [48175.88697767258, 50521.753454208374, 51295.42018890381, 44048.26019859314, 51206.593334198, 52476.86689949036, 56542.24674987793, 52952.76670837402, 51854.80667877197, 48798.726680755615, 49241.053550720215, 54059.926818847656, 48277.5334444046, 53354.01359319687, 52617.42698287964, 47518.97332048416, 44377.13349914551, 45593.14686203003, 54780.40684509277, 51256.69344329834, 53101.64005470276, 52588.98670387268, 55811.46691894531, 43557.90679574013, 48863.34656333923, 53329.420150756836, 54784.96011352539, 51136.806858062744, 48922.686584472656, 53404.013387680054, 49410.94690704346, 51948.58006858826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.005215458080016, "mean_inference_ms": 6.372984645404216, "mean_action_processing_ms": 0.20505039800953534, "mean_env_wait_ms": 209.94169832286804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06108582019805908, "StateBufferConnector_ms": 0.006485730409622192, "ViewRequirementAgentConnector_ms": 0.25964826345443726}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.51839703974346, "num_env_steps_trained_throughput_per_sec": 247.51839703974346, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 15957.452, "sample_time_ms": 11729.902, "learn_time_ms": 4060.659, "learn_throughput": 985.062, "synch_weights_time_ms": 165.907}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 1396, "training_iteration": 50, "trial_id": "185f8_00000", "date": "2025-03-21_11-57-44", "timestamp": 1742558264, "time_this_iter_s": 16.222782373428345, "time_total_s": 793.8082251548767, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 793.8082251548767, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.40434782608696, "ram_util_percent": 13.660869565217387}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986577987670898, "policy_loss": -0.015124499797821045, "vf_loss": 10.0, "vf_explained_var": -1.2173627510492224e-06, "kl": 0.008513364940881729, "entropy": 0.5478469729423523, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 51948.58006858826, "episode_reward_min": 51948.58006858826, "episode_reward_mean": 51948.58006858826, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51948.58006858826}, "policy_reward_max": {"agent_0": 51948.58006858826}, "policy_reward_mean": {"agent_0": 51948.58006858826}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51948.58006858826], "episode_lengths": [137], "policy_agent_0_reward": [51948.58006858826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.960664280106414, "mean_inference_ms": 6.352435596634734, "mean_action_processing_ms": 0.19528243413193885, "mean_env_wait_ms": 208.90810733705055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04279613494873047, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.17478466033935547}}, "episode_reward_max": 51948.58006858826, "episode_reward_min": 51948.58006858826, "episode_reward_mean": 51948.58006858826, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51948.58006858826}, "policy_reward_max": {"agent_0": 51948.58006858826}, "policy_reward_mean": {"agent_0": 51948.58006858826}, "hist_stats": {"episode_reward": [51948.58006858826], "episode_lengths": [137], "policy_agent_0_reward": [51948.58006858826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.960664280106414, "mean_inference_ms": 6.352435596634734, "mean_action_processing_ms": 0.19528243413193885, "mean_env_wait_ms": 208.90810733705055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04279613494873047, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.17478466033935547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.78878180412556, "num_env_steps_trained_throughput_per_sec": 299.78878180412556, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 15842.566, "sample_time_ms": 11703.629, "learn_time_ms": 3980.977, "learn_throughput": 1004.778, "synch_weights_time_ms": 156.977}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 1396, "training_iteration": 51, "trial_id": "185f8_00000", "date": "2025-03-21_11-57-57", "timestamp": 1742558277, "time_this_iter_s": 13.412256717681885, "time_total_s": 807.2204818725586, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 807.2204818725586, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 99.47368421052633, "ram_util_percent": 13.689473684210524}}
{"custom_metrics": {"num_batches_mean": 5.119565217391305, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.753118515014648, "policy_loss": -0.01689029484987259, "vf_loss": 9.76821517944336, "vf_explained_var": -3.077027713516145e-06, "kl": 0.008969615213572979, "entropy": 0.5350046753883362, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 55918.81999206543, "episode_reward_min": 43241.4399433136, "episode_reward_mean": 50275.75982780431, "episode_len_mean": 135.70652173913044, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43241.4399433136}, "policy_reward_max": {"agent_0": 55918.81999206543}, "policy_reward_mean": {"agent_0": 50275.75982780431}, "custom_metrics": {"num_batches_mean": 5.119565217391305, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51841.28680419922, 47935.64673995972, 45555.73324584961, 48108.96006011963, 46192.22010040283, 51029.46027946472, 54907.500299453735, 51784.15348625183, 52983.93332672119, 49451.88020324707, 51324.1802406311, 53820.646575927734, 48055.56025886536, 50052.03991317749, 52271.65368461609, 43901.020154953, 52505.42004966736, 52375.59370803833, 51730.58669281006, 53893.580253601074, 50560.720026016235, 51683.280097961426, 48442.260164260864, 53853.7333984375, 51298.08678436279, 52493.440101623535, 47776.41994702816, 51268.926961898804, 46930.2266368866, 48968.14008462429, 46200.56015586853, 55507.693435668945, 55508.573165893555, 48731.273554086685, 48342.07355117798, 50564.46686553955, 46304.38020610809, 48189.56676483154, 47730.706537246704, 51636.40676498413, 52156.55355262756, 48537.000160217285, 48249.38009119034, 47001.893367767334, 50387.90019989014, 43241.4399433136, 49327.81328582764, 50386.29365158081, 52924.93340301514, 46275.42678260803, 53315.70026016235, 48232.02687072754, 52793.380071640015, 52959.493512392044, 54553.20680999756, 55918.81999206543, 51424.27365398407, 49640.75337600708, 51115.50003051758, 48278.766620635986, 52323.69351005554, 44454.493228435516, 49988.960092544556, 55182.22679042816, 47192.033279418945, 51941.86706864834, 47347.99328041077, 44152.9132270813, 49553.5801525116, 47916.49361228943, 50651.90027523041, 47653.98029708862, 52669.80672454834, 52707.82013130188, 50642.866735458374, 47249.81332778931, 52446.493476867676, 47798.39354252815, 52342.63998413086, 47551.82008743286, 53147.54027938843, 48173.07339954376, 51494.280351638794, 53507.02681159973, 52213.16679382324, 54826.1000289917, 49546.386830329895, 47707.273387908936, 50481.193645477295, 53439.24673461914, 50513.18681001663, 50119.09334182739], "episode_lengths": [135, 137, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135, 137, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 136, 136, 135, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 137, 134, 136, 135, 135, 135, 135, 135, 135, 137, 136, 136, 136, 136, 135, 136, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 136, 136], "policy_agent_0_reward": [51841.28680419922, 47935.64673995972, 45555.73324584961, 48108.96006011963, 46192.22010040283, 51029.46027946472, 54907.500299453735, 51784.15348625183, 52983.93332672119, 49451.88020324707, 51324.1802406311, 53820.646575927734, 48055.56025886536, 50052.03991317749, 52271.65368461609, 43901.020154953, 52505.42004966736, 52375.59370803833, 51730.58669281006, 53893.580253601074, 50560.720026016235, 51683.280097961426, 48442.260164260864, 53853.7333984375, 51298.08678436279, 52493.440101623535, 47776.41994702816, 51268.926961898804, 46930.2266368866, 48968.14008462429, 46200.56015586853, 55507.693435668945, 55508.573165893555, 48731.273554086685, 48342.07355117798, 50564.46686553955, 46304.38020610809, 48189.56676483154, 47730.706537246704, 51636.40676498413, 52156.55355262756, 48537.000160217285, 48249.38009119034, 47001.893367767334, 50387.90019989014, 43241.4399433136, 49327.81328582764, 50386.29365158081, 52924.93340301514, 46275.42678260803, 53315.70026016235, 48232.02687072754, 52793.380071640015, 52959.493512392044, 54553.20680999756, 55918.81999206543, 51424.27365398407, 49640.75337600708, 51115.50003051758, 48278.766620635986, 52323.69351005554, 44454.493228435516, 49988.960092544556, 55182.22679042816, 47192.033279418945, 51941.86706864834, 47347.99328041077, 44152.9132270813, 49553.5801525116, 47916.49361228943, 50651.90027523041, 47653.98029708862, 52669.80672454834, 52707.82013130188, 50642.866735458374, 47249.81332778931, 52446.493476867676, 47798.39354252815, 52342.63998413086, 47551.82008743286, 53147.54027938843, 48173.07339954376, 51494.280351638794, 53507.02681159973, 52213.16679382324, 54826.1000289917, 49546.386830329895, 47707.273387908936, 50481.193645477295, 53439.24673461914, 50513.18681001663, 50119.09334182739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.64963594923008, "mean_inference_ms": 6.618979746406018, "mean_action_processing_ms": 0.20456360158137077, "mean_env_wait_ms": 224.59728065802759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04635530969370966, "StateBufferConnector_ms": 0.017624316008194633, "ViewRequirementAgentConnector_ms": 0.20986769510352093}}, "episode_reward_max": 55918.81999206543, "episode_reward_min": 43241.4399433136, "episode_reward_mean": 50275.75982780431, "episode_len_mean": 135.70652173913044, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43241.4399433136}, "policy_reward_max": {"agent_0": 55918.81999206543}, "policy_reward_mean": {"agent_0": 50275.75982780431}, "hist_stats": {"episode_reward": [51841.28680419922, 47935.64673995972, 45555.73324584961, 48108.96006011963, 46192.22010040283, 51029.46027946472, 54907.500299453735, 51784.15348625183, 52983.93332672119, 49451.88020324707, 51324.1802406311, 53820.646575927734, 48055.56025886536, 50052.03991317749, 52271.65368461609, 43901.020154953, 52505.42004966736, 52375.59370803833, 51730.58669281006, 53893.580253601074, 50560.720026016235, 51683.280097961426, 48442.260164260864, 53853.7333984375, 51298.08678436279, 52493.440101623535, 47776.41994702816, 51268.926961898804, 46930.2266368866, 48968.14008462429, 46200.56015586853, 55507.693435668945, 55508.573165893555, 48731.273554086685, 48342.07355117798, 50564.46686553955, 46304.38020610809, 48189.56676483154, 47730.706537246704, 51636.40676498413, 52156.55355262756, 48537.000160217285, 48249.38009119034, 47001.893367767334, 50387.90019989014, 43241.4399433136, 49327.81328582764, 50386.29365158081, 52924.93340301514, 46275.42678260803, 53315.70026016235, 48232.02687072754, 52793.380071640015, 52959.493512392044, 54553.20680999756, 55918.81999206543, 51424.27365398407, 49640.75337600708, 51115.50003051758, 48278.766620635986, 52323.69351005554, 44454.493228435516, 49988.960092544556, 55182.22679042816, 47192.033279418945, 51941.86706864834, 47347.99328041077, 44152.9132270813, 49553.5801525116, 47916.49361228943, 50651.90027523041, 47653.98029708862, 52669.80672454834, 52707.82013130188, 50642.866735458374, 47249.81332778931, 52446.493476867676, 47798.39354252815, 52342.63998413086, 47551.82008743286, 53147.54027938843, 48173.07339954376, 51494.280351638794, 53507.02681159973, 52213.16679382324, 54826.1000289917, 49546.386830329895, 47707.273387908936, 50481.193645477295, 53439.24673461914, 50513.18681001663, 50119.09334182739], "episode_lengths": [135, 137, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135, 137, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 136, 136, 135, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 137, 134, 136, 135, 135, 135, 135, 135, 135, 137, 136, 136, 136, 136, 135, 136, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 136, 136], "policy_agent_0_reward": [51841.28680419922, 47935.64673995972, 45555.73324584961, 48108.96006011963, 46192.22010040283, 51029.46027946472, 54907.500299453735, 51784.15348625183, 52983.93332672119, 49451.88020324707, 51324.1802406311, 53820.646575927734, 48055.56025886536, 50052.03991317749, 52271.65368461609, 43901.020154953, 52505.42004966736, 52375.59370803833, 51730.58669281006, 53893.580253601074, 50560.720026016235, 51683.280097961426, 48442.260164260864, 53853.7333984375, 51298.08678436279, 52493.440101623535, 47776.41994702816, 51268.926961898804, 46930.2266368866, 48968.14008462429, 46200.56015586853, 55507.693435668945, 55508.573165893555, 48731.273554086685, 48342.07355117798, 50564.46686553955, 46304.38020610809, 48189.56676483154, 47730.706537246704, 51636.40676498413, 52156.55355262756, 48537.000160217285, 48249.38009119034, 47001.893367767334, 50387.90019989014, 43241.4399433136, 49327.81328582764, 50386.29365158081, 52924.93340301514, 46275.42678260803, 53315.70026016235, 48232.02687072754, 52793.380071640015, 52959.493512392044, 54553.20680999756, 55918.81999206543, 51424.27365398407, 49640.75337600708, 51115.50003051758, 48278.766620635986, 52323.69351005554, 44454.493228435516, 49988.960092544556, 55182.22679042816, 47192.033279418945, 51941.86706864834, 47347.99328041077, 44152.9132270813, 49553.5801525116, 47916.49361228943, 50651.90027523041, 47653.98029708862, 52669.80672454834, 52707.82013130188, 50642.866735458374, 47249.81332778931, 52446.493476867676, 47798.39354252815, 52342.63998413086, 47551.82008743286, 53147.54027938843, 48173.07339954376, 51494.280351638794, 53507.02681159973, 52213.16679382324, 54826.1000289917, 49546.386830329895, 47707.273387908936, 50481.193645477295, 53439.24673461914, 50513.18681001663, 50119.09334182739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.64963594923008, "mean_inference_ms": 6.618979746406018, "mean_action_processing_ms": 0.20456360158137077, "mean_env_wait_ms": 224.59728065802759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04635530969370966, "StateBufferConnector_ms": 0.017624316008194633, "ViewRequirementAgentConnector_ms": 0.20986769510352093}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.3720002698762, "num_env_steps_trained_throughput_per_sec": 212.3720002698762, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 16000.519, "sample_time_ms": 11891.293, "learn_time_ms": 3953.644, "learn_throughput": 1011.725, "synch_weights_time_ms": 154.636}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 1488, "training_iteration": 52, "trial_id": "185f8_00000", "date": "2025-03-21_11-58-16", "timestamp": 1742558296, "time_this_iter_s": 18.8911874294281, "time_total_s": 826.1116693019867, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 826.1116693019867, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 94.66153846153848, "ram_util_percent": 13.661538461538461}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988526344299316, "policy_loss": -0.012976271100342274, "vf_loss": 10.0, "vf_explained_var": -9.202087767334888e-07, "kl": 0.007513562683016062, "entropy": 0.5007070302963257, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 50119.09334182739, "episode_reward_min": 50119.09334182739, "episode_reward_mean": 50119.09334182739, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50119.09334182739}, "policy_reward_max": {"agent_0": 50119.09334182739}, "policy_reward_mean": {"agent_0": 50119.09334182739}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50119.09334182739], "episode_lengths": [136], "policy_agent_0_reward": [50119.09334182739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.7893857870016, "mean_inference_ms": 6.263386379849088, "mean_action_processing_ms": 0.2054714225791954, "mean_env_wait_ms": 227.28663235455303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03731250762939453, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.15895366668701172}}, "episode_reward_max": 50119.09334182739, "episode_reward_min": 50119.09334182739, "episode_reward_mean": 50119.09334182739, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50119.09334182739}, "policy_reward_max": {"agent_0": 50119.09334182739}, "policy_reward_mean": {"agent_0": 50119.09334182739}, "hist_stats": {"episode_reward": [50119.09334182739], "episode_lengths": [136], "policy_agent_0_reward": [50119.09334182739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.7893857870016, "mean_inference_ms": 6.263386379849088, "mean_action_processing_ms": 0.2054714225791954, "mean_env_wait_ms": 227.28663235455303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03731250762939453, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.15895366668701172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.16133671888474, "num_env_steps_trained_throughput_per_sec": 276.16133671888474, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 15559.802, "sample_time_ms": 11432.982, "learn_time_ms": 3969.256, "learn_throughput": 1007.745, "synch_weights_time_ms": 156.658}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 1488, "training_iteration": 53, "trial_id": "185f8_00000", "date": "2025-03-21_11-58-31", "timestamp": 1742558311, "time_this_iter_s": 14.57373833656311, "time_total_s": 840.6854076385498, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 840.6854076385498, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.54761904761905, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909127235412598, "policy_loss": -0.012786293402314186, "vf_loss": 9.92041015625, "vf_explained_var": 4.3989470555061416e-07, "kl": 0.0075119431130588055, "entropy": 0.4765675365924835, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 56480.37352848053, "episode_reward_min": 47938.38688659668, "episode_reward_mean": 52050.54767704587, "episode_len_mean": 135.58064516129033, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 47938.38688659668}, "policy_reward_max": {"agent_0": 56480.37352848053}, "policy_reward_mean": {"agent_0": 52050.54767704587}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51655.89334869385, 52107.50012969971, 54902.106857299805, 55663.10027885437, 54096.35367393494, 56480.37352848053, 51464.259967803955, 51321.31344413757, 55718.52682495117, 47957.24695777893, 53744.79348754883, 47938.38688659668, 54054.99362945557, 51878.60676574707, 54723.80019760132, 51675.593421936035, 52183.486598968506, 50928.58680725098, 52102.04669189453, 53201.34683609009, 50542.58017158508, 48005.86003780365, 54301.03369140625, 54364.71339416504, 49330.38692212105, 51868.48002624512, 49737.83353424072, 55070.36018371582, 48748.35327619314, 48012.57361316681, 49786.48680305481], "episode_lengths": [135, 136, 136, 135, 136, 136, 135, 135, 135, 137, 135, 137, 135, 135, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 136, 136, 136], "policy_agent_0_reward": [51655.89334869385, 52107.50012969971, 54902.106857299805, 55663.10027885437, 54096.35367393494, 56480.37352848053, 51464.259967803955, 51321.31344413757, 55718.52682495117, 47957.24695777893, 53744.79348754883, 47938.38688659668, 54054.99362945557, 51878.60676574707, 54723.80019760132, 51675.593421936035, 52183.486598968506, 50928.58680725098, 52102.04669189453, 53201.34683609009, 50542.58017158508, 48005.86003780365, 54301.03369140625, 54364.71339416504, 49330.38692212105, 51868.48002624512, 49737.83353424072, 55070.36018371582, 48748.35327619314, 48012.57361316681, 49786.48680305481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46986547878699, "mean_inference_ms": 6.33107351812056, "mean_action_processing_ms": 0.20405487143503578, "mean_env_wait_ms": 208.71095237820273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06611962472238848, "StateBufferConnector_ms": 0.006291174119518649, "ViewRequirementAgentConnector_ms": 0.28055406385852444}}, "episode_reward_max": 56480.37352848053, "episode_reward_min": 47938.38688659668, "episode_reward_mean": 52050.54767704587, "episode_len_mean": 135.58064516129033, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 47938.38688659668}, "policy_reward_max": {"agent_0": 56480.37352848053}, "policy_reward_mean": {"agent_0": 52050.54767704587}, "hist_stats": {"episode_reward": [51655.89334869385, 52107.50012969971, 54902.106857299805, 55663.10027885437, 54096.35367393494, 56480.37352848053, 51464.259967803955, 51321.31344413757, 55718.52682495117, 47957.24695777893, 53744.79348754883, 47938.38688659668, 54054.99362945557, 51878.60676574707, 54723.80019760132, 51675.593421936035, 52183.486598968506, 50928.58680725098, 52102.04669189453, 53201.34683609009, 50542.58017158508, 48005.86003780365, 54301.03369140625, 54364.71339416504, 49330.38692212105, 51868.48002624512, 49737.83353424072, 55070.36018371582, 48748.35327619314, 48012.57361316681, 49786.48680305481], "episode_lengths": [135, 136, 136, 135, 136, 136, 135, 135, 135, 137, 135, 137, 135, 135, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 136, 136, 136], "policy_agent_0_reward": [51655.89334869385, 52107.50012969971, 54902.106857299805, 55663.10027885437, 54096.35367393494, 56480.37352848053, 51464.259967803955, 51321.31344413757, 55718.52682495117, 47957.24695777893, 53744.79348754883, 47938.38688659668, 54054.99362945557, 51878.60676574707, 54723.80019760132, 51675.593421936035, 52183.486598968506, 50928.58680725098, 52102.04669189453, 53201.34683609009, 50542.58017158508, 48005.86003780365, 54301.03369140625, 54364.71339416504, 49330.38692212105, 51868.48002624512, 49737.83353424072, 55070.36018371582, 48748.35327619314, 48012.57361316681, 49786.48680305481]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46986547878699, "mean_inference_ms": 6.33107351812056, "mean_action_processing_ms": 0.20405487143503578, "mean_env_wait_ms": 208.71095237820273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06611962472238848, "StateBufferConnector_ms": 0.006291174119518649, "ViewRequirementAgentConnector_ms": 0.28055406385852444}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.5141057092289, "num_env_steps_trained_throughput_per_sec": 260.5141057092289, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 15654.15, "sample_time_ms": 11553.044, "learn_time_ms": 3937.781, "learn_throughput": 1015.801, "synch_weights_time_ms": 162.388}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 1519, "training_iteration": 54, "trial_id": "185f8_00000", "date": "2025-03-21_11-58-46", "timestamp": 1742558326, "time_this_iter_s": 15.405123472213745, "time_total_s": 856.0905311107635, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a22e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 856.0905311107635, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.14545454545456, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984975814819336, "policy_loss": -0.0141519820317626, "vf_loss": 9.99755859375, "vf_explained_var": -2.2041301406261482e-07, "kl": 0.007848110981285572, "entropy": 0.4769713282585144, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 48004.98011302948, "episode_reward_min": 48004.98011302948, "episode_reward_mean": 48004.98011302948, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 48004.98011302948}, "policy_reward_max": {"agent_0": 48004.98011302948}, "policy_reward_mean": {"agent_0": 48004.98011302948}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48004.98011302948], "episode_lengths": [136], "policy_agent_0_reward": [48004.98011302948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.526291151929, "mean_inference_ms": 6.479198712084261, "mean_action_processing_ms": 0.2232061346196918, "mean_env_wait_ms": 210.66323920493608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047326087951660156, "StateBufferConnector_ms": 0.006937980651855469, "ViewRequirementAgentConnector_ms": 0.18999576568603516}}, "episode_reward_max": 48004.98011302948, "episode_reward_min": 48004.98011302948, "episode_reward_mean": 48004.98011302948, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 48004.98011302948}, "policy_reward_max": {"agent_0": 48004.98011302948}, "policy_reward_mean": {"agent_0": 48004.98011302948}, "hist_stats": {"episode_reward": [48004.98011302948], "episode_lengths": [136], "policy_agent_0_reward": [48004.98011302948]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.526291151929, "mean_inference_ms": 6.479198712084261, "mean_action_processing_ms": 0.2232061346196918, "mean_env_wait_ms": 210.66323920493608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047326087951660156, "StateBufferConnector_ms": 0.006937980651855469, "ViewRequirementAgentConnector_ms": 0.18999576568603516}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.20992923673293, "num_env_steps_trained_throughput_per_sec": 271.20992923673293, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 15707.897, "sample_time_ms": 11600.572, "learn_time_ms": 3939.084, "learn_throughput": 1015.465, "synch_weights_time_ms": 167.291}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 1520, "training_iteration": 55, "trial_id": "185f8_00000", "date": "2025-03-21_11-59-01", "timestamp": 1742558341, "time_this_iter_s": 14.80785870552063, "time_total_s": 870.8983898162842, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 870.8983898162842, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 99.50000000000003, "ram_util_percent": 13.642857142857142}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.759112358093262, "policy_loss": -0.0115631939843297, "vf_loss": 9.769288063049316, "vf_explained_var": -2.2289652790163927e-08, "kl": 0.006939016282558441, "entropy": 0.46611833572387695, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 57773.59338378906, "episode_reward_min": 42317.773347854614, "episode_reward_mean": 51160.42069371887, "episode_len_mean": 135.52173913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42317.773347854614}, "policy_reward_max": {"agent_0": 57773.59338378906}, "policy_reward_mean": {"agent_0": 51160.42069371887}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52048.34692764282, 47985.313426971436, 43946.59352302551, 52055.553300857544, 53053.693450927734, 46262.60012435913, 47498.38687992096, 52637.28677368164, 54158.28024864197, 55586.4401550293, 54327.56673049927, 51584.899935781956, 51061.02670669556, 52839.58672332764, 52450.76658630371, 49385.56676483154, 52870.820083618164, 52876.63341522217, 49164.30006980896, 44007.40002822876, 52182.24036026001, 46214.45337867737, 55586.800117492676, 51820.826778411865, 53420.24673461914, 51970.26693916321, 51115.41995239258, 52058.193603515625, 52824.80683898926, 49639.213497161865, 52847.79369354248, 51555.79361438751, 51095.37315368652, 52986.00001144409, 51185.7534828186, 54783.33362579346, 46872.453313827515, 49664.406620025635, 53451.55358695984, 50916.113428115845, 50647.2399597168, 51661.346771240234, 51912.180210113525, 51720.27346801758, 51373.173374176025, 51779.80673599243, 51024.08019924164, 53126.07350540161, 48686.59355258942, 52116.02695465088, 47111.9465675354, 50433.14007616043, 54169.940311431885, 57773.59338378906, 50875.42011260986, 50573.406958043575, 53570.88004589081, 48290.90682029724, 51714.580125808716, 50837.76014304161, 51529.333335876465, 53106.20667266846, 49679.61339187622, 54205.27320098877, 45928.14009094238, 48320.40676212311, 53037.0066947937, 52331.026958465576, 53534.866916656494, 54403.60674571991, 44399.773599624634, 54752.653369903564, 48374.20693588257, 54690.45371246338, 50669.67346572876, 46110.886672496796, 52740.460121154785, 50329.57999801636, 42317.773347854614, 50729.76676940918, 53331.153277397156, 50702.57370185852, 53769.96014213562, 53364.80006027222, 52890.893478393555, 49043.32692527771, 49111.793478012085, 52237.80675125122, 52718.95990109444, 48316.28666639328, 49632.24661254883, 53057.720202445984], "episode_lengths": [136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 137, 136, 135, 135, 136, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 137, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135], "policy_agent_0_reward": [52048.34692764282, 47985.313426971436, 43946.59352302551, 52055.553300857544, 53053.693450927734, 46262.60012435913, 47498.38687992096, 52637.28677368164, 54158.28024864197, 55586.4401550293, 54327.56673049927, 51584.899935781956, 51061.02670669556, 52839.58672332764, 52450.76658630371, 49385.56676483154, 52870.820083618164, 52876.63341522217, 49164.30006980896, 44007.40002822876, 52182.24036026001, 46214.45337867737, 55586.800117492676, 51820.826778411865, 53420.24673461914, 51970.26693916321, 51115.41995239258, 52058.193603515625, 52824.80683898926, 49639.213497161865, 52847.79369354248, 51555.79361438751, 51095.37315368652, 52986.00001144409, 51185.7534828186, 54783.33362579346, 46872.453313827515, 49664.406620025635, 53451.55358695984, 50916.113428115845, 50647.2399597168, 51661.346771240234, 51912.180210113525, 51720.27346801758, 51373.173374176025, 51779.80673599243, 51024.08019924164, 53126.07350540161, 48686.59355258942, 52116.02695465088, 47111.9465675354, 50433.14007616043, 54169.940311431885, 57773.59338378906, 50875.42011260986, 50573.406958043575, 53570.88004589081, 48290.90682029724, 51714.580125808716, 50837.76014304161, 51529.333335876465, 53106.20667266846, 49679.61339187622, 54205.27320098877, 45928.14009094238, 48320.40676212311, 53037.0066947937, 52331.026958465576, 53534.866916656494, 54403.60674571991, 44399.773599624634, 54752.653369903564, 48374.20693588257, 54690.45371246338, 50669.67346572876, 46110.886672496796, 52740.460121154785, 50329.57999801636, 42317.773347854614, 50729.76676940918, 53331.153277397156, 50702.57370185852, 53769.96014213562, 53364.80006027222, 52890.893478393555, 49043.32692527771, 49111.793478012085, 52237.80675125122, 52718.95990109444, 48316.28666639328, 49632.24661254883, 53057.720202445984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.79798496480322, "mean_inference_ms": 6.636994391027189, "mean_action_processing_ms": 0.20446906326472658, "mean_env_wait_ms": 224.0435772381061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06378863168799359, "StateBufferConnector_ms": 0.006452850673509681, "ViewRequirementAgentConnector_ms": 0.24541357289189877}}, "episode_reward_max": 57773.59338378906, "episode_reward_min": 42317.773347854614, "episode_reward_mean": 51160.42069371887, "episode_len_mean": 135.52173913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42317.773347854614}, "policy_reward_max": {"agent_0": 57773.59338378906}, "policy_reward_mean": {"agent_0": 51160.42069371887}, "hist_stats": {"episode_reward": [52048.34692764282, 47985.313426971436, 43946.59352302551, 52055.553300857544, 53053.693450927734, 46262.60012435913, 47498.38687992096, 52637.28677368164, 54158.28024864197, 55586.4401550293, 54327.56673049927, 51584.899935781956, 51061.02670669556, 52839.58672332764, 52450.76658630371, 49385.56676483154, 52870.820083618164, 52876.63341522217, 49164.30006980896, 44007.40002822876, 52182.24036026001, 46214.45337867737, 55586.800117492676, 51820.826778411865, 53420.24673461914, 51970.26693916321, 51115.41995239258, 52058.193603515625, 52824.80683898926, 49639.213497161865, 52847.79369354248, 51555.79361438751, 51095.37315368652, 52986.00001144409, 51185.7534828186, 54783.33362579346, 46872.453313827515, 49664.406620025635, 53451.55358695984, 50916.113428115845, 50647.2399597168, 51661.346771240234, 51912.180210113525, 51720.27346801758, 51373.173374176025, 51779.80673599243, 51024.08019924164, 53126.07350540161, 48686.59355258942, 52116.02695465088, 47111.9465675354, 50433.14007616043, 54169.940311431885, 57773.59338378906, 50875.42011260986, 50573.406958043575, 53570.88004589081, 48290.90682029724, 51714.580125808716, 50837.76014304161, 51529.333335876465, 53106.20667266846, 49679.61339187622, 54205.27320098877, 45928.14009094238, 48320.40676212311, 53037.0066947937, 52331.026958465576, 53534.866916656494, 54403.60674571991, 44399.773599624634, 54752.653369903564, 48374.20693588257, 54690.45371246338, 50669.67346572876, 46110.886672496796, 52740.460121154785, 50329.57999801636, 42317.773347854614, 50729.76676940918, 53331.153277397156, 50702.57370185852, 53769.96014213562, 53364.80006027222, 52890.893478393555, 49043.32692527771, 49111.793478012085, 52237.80675125122, 52718.95990109444, 48316.28666639328, 49632.24661254883, 53057.720202445984], "episode_lengths": [136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 137, 136, 135, 135, 136, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 137, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135], "policy_agent_0_reward": [52048.34692764282, 47985.313426971436, 43946.59352302551, 52055.553300857544, 53053.693450927734, 46262.60012435913, 47498.38687992096, 52637.28677368164, 54158.28024864197, 55586.4401550293, 54327.56673049927, 51584.899935781956, 51061.02670669556, 52839.58672332764, 52450.76658630371, 49385.56676483154, 52870.820083618164, 52876.63341522217, 49164.30006980896, 44007.40002822876, 52182.24036026001, 46214.45337867737, 55586.800117492676, 51820.826778411865, 53420.24673461914, 51970.26693916321, 51115.41995239258, 52058.193603515625, 52824.80683898926, 49639.213497161865, 52847.79369354248, 51555.79361438751, 51095.37315368652, 52986.00001144409, 51185.7534828186, 54783.33362579346, 46872.453313827515, 49664.406620025635, 53451.55358695984, 50916.113428115845, 50647.2399597168, 51661.346771240234, 51912.180210113525, 51720.27346801758, 51373.173374176025, 51779.80673599243, 51024.08019924164, 53126.07350540161, 48686.59355258942, 52116.02695465088, 47111.9465675354, 50433.14007616043, 54169.940311431885, 57773.59338378906, 50875.42011260986, 50573.406958043575, 53570.88004589081, 48290.90682029724, 51714.580125808716, 50837.76014304161, 51529.333335876465, 53106.20667266846, 49679.61339187622, 54205.27320098877, 45928.14009094238, 48320.40676212311, 53037.0066947937, 52331.026958465576, 53534.866916656494, 54403.60674571991, 44399.773599624634, 54752.653369903564, 48374.20693588257, 54690.45371246338, 50669.67346572876, 46110.886672496796, 52740.460121154785, 50329.57999801636, 42317.773347854614, 50729.76676940918, 53331.153277397156, 50702.57370185852, 53769.96014213562, 53364.80006027222, 52890.893478393555, 49043.32692527771, 49111.793478012085, 52237.80675125122, 52718.95990109444, 48316.28666639328, 49632.24661254883, 53057.720202445984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.79798496480322, "mean_inference_ms": 6.636994391027189, "mean_action_processing_ms": 0.20446906326472658, "mean_env_wait_ms": 224.0435772381061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06378863168799359, "StateBufferConnector_ms": 0.006452850673509681, "ViewRequirementAgentConnector_ms": 0.24541357289189877}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.08537907162324, "num_env_steps_trained_throughput_per_sec": 208.08537907162324, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15927.202, "sample_time_ms": 11828.435, "learn_time_ms": 3931.518, "learn_throughput": 1017.419, "synch_weights_time_ms": 166.328}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 1612, "training_iteration": 56, "trial_id": "185f8_00000", "date": "2025-03-21_11-59-20", "timestamp": 1742558360, "time_this_iter_s": 19.30385112762451, "time_total_s": 890.2022409439087, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a21870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 890.2022409439087, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 94.27407407407406, "ram_util_percent": 13.629629629629632}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988317489624023, "policy_loss": -0.01301922369748354, "vf_loss": 10.0, "vf_explained_var": -1.441066501683963e-07, "kl": 0.0066804904490709305, "entropy": 0.42595329880714417, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 53057.720202445984, "episode_reward_min": 53057.720202445984, "episode_reward_mean": 53057.720202445984, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53057.720202445984}, "policy_reward_max": {"agent_0": 53057.720202445984}, "policy_reward_mean": {"agent_0": 53057.720202445984}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53057.720202445984], "episode_lengths": [135], "policy_agent_0_reward": [53057.720202445984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.812140565309456, "mean_inference_ms": 6.325772934896083, "mean_action_processing_ms": 0.20654402295105695, "mean_env_wait_ms": 226.4699599494232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0362396240234375, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1594066619873047}}, "episode_reward_max": 53057.720202445984, "episode_reward_min": 53057.720202445984, "episode_reward_mean": 53057.720202445984, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53057.720202445984}, "policy_reward_max": {"agent_0": 53057.720202445984}, "policy_reward_mean": {"agent_0": 53057.720202445984}, "hist_stats": {"episode_reward": [53057.720202445984], "episode_lengths": [135], "policy_agent_0_reward": [53057.720202445984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.812140565309456, "mean_inference_ms": 6.325772934896083, "mean_action_processing_ms": 0.20654402295105695, "mean_env_wait_ms": 226.4699599494232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0362396240234375, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1594066619873047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.4502323412756, "num_env_steps_trained_throughput_per_sec": 270.4502323412756, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 15998.54, "sample_time_ms": 11817.242, "learn_time_ms": 4006.786, "learn_throughput": 998.306, "synch_weights_time_ms": 173.578}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 1612, "training_iteration": 57, "trial_id": "185f8_00000", "date": "2025-03-21_11-59-35", "timestamp": 1742558375, "time_this_iter_s": 14.852437257766724, "time_total_s": 905.0546782016754, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 905.0546782016754, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.5809523809524, "ram_util_percent": 13.604761904761906}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.934346199035645, "policy_loss": -0.012297910638153553, "vf_loss": 9.9453125, "vf_explained_var": 2.4102627094180207e-07, "kl": 0.006657227873802185, "entropy": 0.4265292286872864, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 57273.45343399048, "episode_reward_min": 43843.72671127319, "episode_reward_mean": 51959.34011676095, "episode_len_mean": 135.36363636363637, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 43843.72671127319}, "policy_reward_max": {"agent_0": 57273.45343399048}, "policy_reward_mean": {"agent_0": 51959.34011676095}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53487.433446884155, 55524.4069442749, 51679.900064468384, 55199.68659591675, 55814.51330947876, 48551.44694900513, 48995.15342712402, 53019.240254879, 51725.280126571655, 53148.28022003174, 43843.72671127319, 57273.45343399048, 53404.10669898987, 50588.793535232544, 52169.4531993866, 52815.86685752869, 53311.08677101135, 45485.78010368347, 54987.17337799072, 54162.76034164429, 45208.91985416412, 52709.02034521103], "episode_lengths": [135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 137, 136], "policy_agent_0_reward": [53487.433446884155, 55524.4069442749, 51679.900064468384, 55199.68659591675, 55814.51330947876, 48551.44694900513, 48995.15342712402, 53019.240254879, 51725.280126571655, 53148.28022003174, 43843.72671127319, 57273.45343399048, 53404.10669898987, 50588.793535232544, 52169.4531993866, 52815.86685752869, 53311.08677101135, 45485.78010368347, 54987.17337799072, 54162.76034164429, 45208.91985416412, 52709.02034521103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.763888438297457, "mean_inference_ms": 6.3601276412192425, "mean_action_processing_ms": 0.2045677983220388, "mean_env_wait_ms": 208.41281618892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039521130648526276, "StateBufferConnector_ms": 0.006260655143044211, "ViewRequirementAgentConnector_ms": 0.1841317523609508}}, "episode_reward_max": 57273.45343399048, "episode_reward_min": 43843.72671127319, "episode_reward_mean": 51959.34011676095, "episode_len_mean": 135.36363636363637, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 43843.72671127319}, "policy_reward_max": {"agent_0": 57273.45343399048}, "policy_reward_mean": {"agent_0": 51959.34011676095}, "hist_stats": {"episode_reward": [53487.433446884155, 55524.4069442749, 51679.900064468384, 55199.68659591675, 55814.51330947876, 48551.44694900513, 48995.15342712402, 53019.240254879, 51725.280126571655, 53148.28022003174, 43843.72671127319, 57273.45343399048, 53404.10669898987, 50588.793535232544, 52169.4531993866, 52815.86685752869, 53311.08677101135, 45485.78010368347, 54987.17337799072, 54162.76034164429, 45208.91985416412, 52709.02034521103], "episode_lengths": [135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 137, 136], "policy_agent_0_reward": [53487.433446884155, 55524.4069442749, 51679.900064468384, 55199.68659591675, 55814.51330947876, 48551.44694900513, 48995.15342712402, 53019.240254879, 51725.280126571655, 53148.28022003174, 43843.72671127319, 57273.45343399048, 53404.10669898987, 50588.793535232544, 52169.4531993866, 52815.86685752869, 53311.08677101135, 45485.78010368347, 54987.17337799072, 54162.76034164429, 45208.91985416412, 52709.02034521103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.763888438297457, "mean_inference_ms": 6.3601276412192425, "mean_action_processing_ms": 0.2045677983220388, "mean_env_wait_ms": 208.41281618892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039521130648526276, "StateBufferConnector_ms": 0.006260655143044211, "ViewRequirementAgentConnector_ms": 0.1841317523609508}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.31881483958205, "num_env_steps_trained_throughput_per_sec": 273.31881483958205, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 15577.17, "sample_time_ms": 11383.361, "learn_time_ms": 4016.584, "learn_throughput": 995.871, "synch_weights_time_ms": 176.32}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 1634, "training_iteration": 58, "trial_id": "185f8_00000", "date": "2025-03-21_11-59-50", "timestamp": 1742558390, "time_this_iter_s": 14.69147276878357, "time_total_s": 919.746150970459, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090ab90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 919.746150970459, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 98.92857142857143, "ram_util_percent": 13.62857142857143}}
{"custom_metrics": {"num_batches_mean": 5.8, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.963598251342773, "policy_loss": -0.012788490392267704, "vf_loss": 9.97509765625, "vf_explained_var": 1.1411805900252148e-07, "kl": 0.0064480360597372055, "entropy": 0.4290507137775421, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 54818.333587646484, "episode_reward_min": 43932.66023540497, "episode_reward_mean": 51994.54283390045, "episode_len_mean": 135.7, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 43932.66023540497}, "policy_reward_max": {"agent_0": 54818.333587646484}, "policy_reward_mean": {"agent_0": 51994.54283390045}, "custom_metrics": {"num_batches_mean": 5.8, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51662.82015609741, 53322.15336036682, 49030.20677947998, 54818.333587646484, 54419.60694980621, 43932.66023540497, 53254.57995605469, 53514.49355697632, 54372.62012863159, 51617.95362854004], "episode_lengths": [136, 135, 136, 135, 135, 137, 135, 137, 136, 135], "policy_agent_0_reward": [51662.82015609741, 53322.15336036682, 49030.20677947998, 54818.333587646484, 54419.60694980621, 43932.66023540497, 53254.57995605469, 53514.49355697632, 54372.62012863159, 51617.95362854004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.06845819338146, "mean_inference_ms": 6.336395414947729, "mean_action_processing_ms": 0.20403797132033827, "mean_env_wait_ms": 208.49976161422177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044264793395996094, "StateBufferConnector_ms": 0.011603832244873047, "ViewRequirementAgentConnector_ms": 0.3240823745727539}}, "episode_reward_max": 54818.333587646484, "episode_reward_min": 43932.66023540497, "episode_reward_mean": 51994.54283390045, "episode_len_mean": 135.7, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 43932.66023540497}, "policy_reward_max": {"agent_0": 54818.333587646484}, "policy_reward_mean": {"agent_0": 51994.54283390045}, "hist_stats": {"episode_reward": [51662.82015609741, 53322.15336036682, 49030.20677947998, 54818.333587646484, 54419.60694980621, 43932.66023540497, 53254.57995605469, 53514.49355697632, 54372.62012863159, 51617.95362854004], "episode_lengths": [136, 135, 136, 135, 135, 137, 135, 137, 136, 135], "policy_agent_0_reward": [51662.82015609741, 53322.15336036682, 49030.20677947998, 54818.333587646484, 54419.60694980621, 43932.66023540497, 53254.57995605469, 53514.49355697632, 54372.62012863159, 51617.95362854004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.06845819338146, "mean_inference_ms": 6.336395414947729, "mean_action_processing_ms": 0.20403797132033827, "mean_env_wait_ms": 208.49976161422177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044264793395996094, "StateBufferConnector_ms": 0.011603832244873047, "ViewRequirementAgentConnector_ms": 0.3240823745727539}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.23099694659604, "num_env_steps_trained_throughput_per_sec": 253.23099694659604, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 15736.829, "sample_time_ms": 11528.94, "learn_time_ms": 4022.577, "learn_throughput": 994.388, "synch_weights_time_ms": 184.425}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 1644, "training_iteration": 59, "trial_id": "185f8_00000", "date": "2025-03-21_12-00-06", "timestamp": 1742558406, "time_this_iter_s": 15.864359855651855, "time_total_s": 935.6105108261108, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2743d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 935.6105108261108, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 99.35454545454546, "ram_util_percent": 13.686363636363632}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.760846138000488, "policy_loss": -0.010649905540049076, "vf_loss": 9.770020484924316, "vf_explained_var": 1.3255824171665154e-07, "kl": 0.00737467547878623, "entropy": 0.42824798822402954, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 57588.94022369385, "episode_reward_min": 41839.72004318237, "episode_reward_mean": 51801.82950718377, "episode_len_mean": 135.34782608695653, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41839.72004318237}, "policy_reward_max": {"agent_0": 57588.94022369385}, "policy_reward_mean": {"agent_0": 51801.82950718377}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51919.21370220184, 52913.18005371094, 49536.273431777954, 50990.86679363251, 48322.67343521118, 52248.333545684814, 49963.94013977051, 53971.62673187256, 53803.946784973145, 53041.98011016846, 48677.21343278885, 49093.280237197876, 54959.25354766846, 51438.760080337524, 51894.15333175659, 51600.29351234436, 52129.52016067505, 51257.746658325195, 53811.320293426514, 50690.226751327515, 50411.2134809494, 47803.273456573486, 54839.27346801758, 55220.833419799805, 51183.033460617065, 53844.52656555176, 54547.66027832031, 52986.40009689331, 53476.073320388794, 50427.84021759033, 54340.77378463745, 54438.83366584778, 47451.50679206848, 47306.44008255005, 51649.52007293701, 54678.57350921631, 51757.65993499756, 56027.30680847168, 51324.5733795166, 51261.466802597046, 46737.53333091736, 54883.52670478821, 51627.9269425869, 57588.94022369385, 51071.779925346375, 49481.766832351685, 47570.206758499146, 54758.94687652588, 55341.867062568665, 50803.01359176636, 50319.62022399902, 50191.96681213379, 53458.48697280884, 53597.426918029785, 46381.31342124939, 49988.23356962204, 50476.58006286621, 52867.320137023926, 54283.45348358154, 51074.18670654297, 52971.86696147919, 52501.56029510498, 49710.466621398926, 51802.09348297119, 55073.34009933472, 51559.853576660156, 52725.32668685913, 41839.72004318237, 53039.16679286957, 53253.40679550171, 52188.127002716064, 48877.73363494873, 52788.72695159912, 45763.36004066467, 55770.65351104736, 53861.68025588989, 47885.86692619324, 51807.220428586006, 54535.0601272583, 50818.36682891846, 50877.94023704529, 55053.3133392334, 55176.52688598633, 51340.87350463867, 51017.840156555176, 52126.533566474915, 52613.96016693115, 56577.34703063965, 50301.92027282715, 48643.67353630066, 51118.546573638916, 52401.56043815613], "episode_lengths": [136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 136, 136, 136, 135, 135, 137, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136], "policy_agent_0_reward": [51919.21370220184, 52913.18005371094, 49536.273431777954, 50990.86679363251, 48322.67343521118, 52248.333545684814, 49963.94013977051, 53971.62673187256, 53803.946784973145, 53041.98011016846, 48677.21343278885, 49093.280237197876, 54959.25354766846, 51438.760080337524, 51894.15333175659, 51600.29351234436, 52129.52016067505, 51257.746658325195, 53811.320293426514, 50690.226751327515, 50411.2134809494, 47803.273456573486, 54839.27346801758, 55220.833419799805, 51183.033460617065, 53844.52656555176, 54547.66027832031, 52986.40009689331, 53476.073320388794, 50427.84021759033, 54340.77378463745, 54438.83366584778, 47451.50679206848, 47306.44008255005, 51649.52007293701, 54678.57350921631, 51757.65993499756, 56027.30680847168, 51324.5733795166, 51261.466802597046, 46737.53333091736, 54883.52670478821, 51627.9269425869, 57588.94022369385, 51071.779925346375, 49481.766832351685, 47570.206758499146, 54758.94687652588, 55341.867062568665, 50803.01359176636, 50319.62022399902, 50191.96681213379, 53458.48697280884, 53597.426918029785, 46381.31342124939, 49988.23356962204, 50476.58006286621, 52867.320137023926, 54283.45348358154, 51074.18670654297, 52971.86696147919, 52501.56029510498, 49710.466621398926, 51802.09348297119, 55073.34009933472, 51559.853576660156, 52725.32668685913, 41839.72004318237, 53039.16679286957, 53253.40679550171, 52188.127002716064, 48877.73363494873, 52788.72695159912, 45763.36004066467, 55770.65351104736, 53861.68025588989, 47885.86692619324, 51807.220428586006, 54535.0601272583, 50818.36682891846, 50877.94023704529, 55053.3133392334, 55176.52688598633, 51340.87350463867, 51017.840156555176, 52126.533566474915, 52613.96016693115, 56577.34703063965, 50301.92027282715, 48643.67353630066, 51118.546573638916, 52401.56043815613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.662985832152714, "mean_inference_ms": 6.658275210295923, "mean_action_processing_ms": 0.2039704859085416, "mean_env_wait_ms": 224.2693406733197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267236543738324, "StateBufferConnector_ms": 0.006173486294953719, "ViewRequirementAgentConnector_ms": 0.2171560474064039}}, "episode_reward_max": 57588.94022369385, "episode_reward_min": 41839.72004318237, "episode_reward_mean": 51801.82950718377, "episode_len_mean": 135.34782608695653, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41839.72004318237}, "policy_reward_max": {"agent_0": 57588.94022369385}, "policy_reward_mean": {"agent_0": 51801.82950718377}, "hist_stats": {"episode_reward": [51919.21370220184, 52913.18005371094, 49536.273431777954, 50990.86679363251, 48322.67343521118, 52248.333545684814, 49963.94013977051, 53971.62673187256, 53803.946784973145, 53041.98011016846, 48677.21343278885, 49093.280237197876, 54959.25354766846, 51438.760080337524, 51894.15333175659, 51600.29351234436, 52129.52016067505, 51257.746658325195, 53811.320293426514, 50690.226751327515, 50411.2134809494, 47803.273456573486, 54839.27346801758, 55220.833419799805, 51183.033460617065, 53844.52656555176, 54547.66027832031, 52986.40009689331, 53476.073320388794, 50427.84021759033, 54340.77378463745, 54438.83366584778, 47451.50679206848, 47306.44008255005, 51649.52007293701, 54678.57350921631, 51757.65993499756, 56027.30680847168, 51324.5733795166, 51261.466802597046, 46737.53333091736, 54883.52670478821, 51627.9269425869, 57588.94022369385, 51071.779925346375, 49481.766832351685, 47570.206758499146, 54758.94687652588, 55341.867062568665, 50803.01359176636, 50319.62022399902, 50191.96681213379, 53458.48697280884, 53597.426918029785, 46381.31342124939, 49988.23356962204, 50476.58006286621, 52867.320137023926, 54283.45348358154, 51074.18670654297, 52971.86696147919, 52501.56029510498, 49710.466621398926, 51802.09348297119, 55073.34009933472, 51559.853576660156, 52725.32668685913, 41839.72004318237, 53039.16679286957, 53253.40679550171, 52188.127002716064, 48877.73363494873, 52788.72695159912, 45763.36004066467, 55770.65351104736, 53861.68025588989, 47885.86692619324, 51807.220428586006, 54535.0601272583, 50818.36682891846, 50877.94023704529, 55053.3133392334, 55176.52688598633, 51340.87350463867, 51017.840156555176, 52126.533566474915, 52613.96016693115, 56577.34703063965, 50301.92027282715, 48643.67353630066, 51118.546573638916, 52401.56043815613], "episode_lengths": [136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 136, 136, 136, 135, 135, 137, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136], "policy_agent_0_reward": [51919.21370220184, 52913.18005371094, 49536.273431777954, 50990.86679363251, 48322.67343521118, 52248.333545684814, 49963.94013977051, 53971.62673187256, 53803.946784973145, 53041.98011016846, 48677.21343278885, 49093.280237197876, 54959.25354766846, 51438.760080337524, 51894.15333175659, 51600.29351234436, 52129.52016067505, 51257.746658325195, 53811.320293426514, 50690.226751327515, 50411.2134809494, 47803.273456573486, 54839.27346801758, 55220.833419799805, 51183.033460617065, 53844.52656555176, 54547.66027832031, 52986.40009689331, 53476.073320388794, 50427.84021759033, 54340.77378463745, 54438.83366584778, 47451.50679206848, 47306.44008255005, 51649.52007293701, 54678.57350921631, 51757.65993499756, 56027.30680847168, 51324.5733795166, 51261.466802597046, 46737.53333091736, 54883.52670478821, 51627.9269425869, 57588.94022369385, 51071.779925346375, 49481.766832351685, 47570.206758499146, 54758.94687652588, 55341.867062568665, 50803.01359176636, 50319.62022399902, 50191.96681213379, 53458.48697280884, 53597.426918029785, 46381.31342124939, 49988.23356962204, 50476.58006286621, 52867.320137023926, 54283.45348358154, 51074.18670654297, 52971.86696147919, 52501.56029510498, 49710.466621398926, 51802.09348297119, 55073.34009933472, 51559.853576660156, 52725.32668685913, 41839.72004318237, 53039.16679286957, 53253.40679550171, 52188.127002716064, 48877.73363494873, 52788.72695159912, 45763.36004066467, 55770.65351104736, 53861.68025588989, 47885.86692619324, 51807.220428586006, 54535.0601272583, 50818.36682891846, 50877.94023704529, 55053.3133392334, 55176.52688598633, 51340.87350463867, 51017.840156555176, 52126.533566474915, 52613.96016693115, 56577.34703063965, 50301.92027282715, 48643.67353630066, 51118.546573638916, 52401.56043815613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.662985832152714, "mean_inference_ms": 6.658275210295923, "mean_action_processing_ms": 0.2039704859085416, "mean_env_wait_ms": 224.2693406733197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267236543738324, "StateBufferConnector_ms": 0.006173486294953719, "ViewRequirementAgentConnector_ms": 0.2171560474064039}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.5566988215511, "num_env_steps_trained_throughput_per_sec": 208.5566988215511, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 16038.734, "sample_time_ms": 11805.376, "learn_time_ms": 4055.358, "learn_throughput": 986.349, "synch_weights_time_ms": 177.091}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 1736, "training_iteration": 60, "trial_id": "185f8_00000", "date": "2025-03-21_12-00-25", "timestamp": 1742558425, "time_this_iter_s": 19.266067504882812, "time_total_s": 954.8765783309937, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090aef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 954.8765783309937, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 95.1, "ram_util_percent": 13.666666666666664}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989593505859375, "policy_loss": -0.01179830078035593, "vf_loss": 10.0, "vf_explained_var": 2.662340818915254e-07, "kl": 0.006955957505851984, "entropy": 0.43778011202812195, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 52401.56043815613, "episode_reward_min": 52401.56043815613, "episode_reward_mean": 52401.56043815613, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52401.56043815613}, "policy_reward_max": {"agent_0": 52401.56043815613}, "policy_reward_mean": {"agent_0": 52401.56043815613}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52401.56043815613], "episode_lengths": [136], "policy_agent_0_reward": [52401.56043815613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.060224532088164, "mean_inference_ms": 6.287804374714682, "mean_action_processing_ms": 0.20709328202143862, "mean_env_wait_ms": 228.00239332636963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03666877746582031, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1615285873413086}}, "episode_reward_max": 52401.56043815613, "episode_reward_min": 52401.56043815613, "episode_reward_mean": 52401.56043815613, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52401.56043815613}, "policy_reward_max": {"agent_0": 52401.56043815613}, "policy_reward_mean": {"agent_0": 52401.56043815613}, "hist_stats": {"episode_reward": [52401.56043815613], "episode_lengths": [136], "policy_agent_0_reward": [52401.56043815613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.060224532088164, "mean_inference_ms": 6.287804374714682, "mean_action_processing_ms": 0.20709328202143862, "mean_env_wait_ms": 228.00239332636963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03666877746582031, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1615285873413086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.7157502930648, "num_env_steps_trained_throughput_per_sec": 285.7157502930648, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 16104.452, "sample_time_ms": 11811.772, "learn_time_ms": 4109.243, "learn_throughput": 973.415, "synch_weights_time_ms": 182.504}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 1736, "training_iteration": 61, "trial_id": "185f8_00000", "date": "2025-03-21_12-00-39", "timestamp": 1742558439, "time_this_iter_s": 14.054371118545532, "time_total_s": 968.9309494495392, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2743640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 968.9309494495392, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.5, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.973715782165527, "policy_loss": -0.012829107232391834, "vf_loss": 9.985107421875, "vf_explained_var": -3.899137084317772e-07, "kl": 0.007185675669461489, "entropy": 0.4129179120063782, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 55339.80702209473, "episode_reward_min": 48531.16013908386, "episode_reward_mean": 51363.04354596138, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 48531.16013908386}, "policy_reward_max": {"agent_0": 55339.80702209473}, "policy_reward_mean": {"agent_0": 51363.04354596138}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50055.66026306152, 55339.80702209473, 50882.473485946655, 49313.66019439697, 54055.50017118454, 48531.16013908386], "episode_lengths": [135, 134, 135, 135, 135, 136], "policy_agent_0_reward": [50055.66026306152, 55339.80702209473, 50882.473485946655, 49313.66019439697, 54055.50017118454, 48531.16013908386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.777571196122036, "mean_inference_ms": 6.418791331291353, "mean_action_processing_ms": 0.20475966828282113, "mean_env_wait_ms": 209.04595949734835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03691911697387695, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.23171106974283853}}, "episode_reward_max": 55339.80702209473, "episode_reward_min": 48531.16013908386, "episode_reward_mean": 51363.04354596138, "episode_len_mean": 135.0, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 48531.16013908386}, "policy_reward_max": {"agent_0": 55339.80702209473}, "policy_reward_mean": {"agent_0": 51363.04354596138}, "hist_stats": {"episode_reward": [50055.66026306152, 55339.80702209473, 50882.473485946655, 49313.66019439697, 54055.50017118454, 48531.16013908386], "episode_lengths": [135, 134, 135, 135, 135, 136], "policy_agent_0_reward": [50055.66026306152, 55339.80702209473, 50882.473485946655, 49313.66019439697, 54055.50017118454, 48531.16013908386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.777571196122036, "mean_inference_ms": 6.418791331291353, "mean_action_processing_ms": 0.20475966828282113, "mean_env_wait_ms": 209.04595949734835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03691911697387695, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.23171106974283853}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.92222359340496, "num_env_steps_trained_throughput_per_sec": 288.92222359340496, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 15605.422, "sample_time_ms": 11298.485, "learn_time_ms": 4123.438, "learn_throughput": 970.064, "synch_weights_time_ms": 182.531}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 1742, "training_iteration": 62, "trial_id": "185f8_00000", "date": "2025-03-21_12-00-53", "timestamp": 1742558453, "time_this_iter_s": 13.895127296447754, "time_total_s": 982.8260767459869, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090af80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 982.8260767459869, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 98.725, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.461538461538462, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.924711227416992, "policy_loss": -0.010929612442851067, "vf_loss": 9.934326171875, "vf_explained_var": -1.1548399925231934e-07, "kl": 0.006572157144546509, "entropy": 0.3983014225959778, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 56493.92005157471, "episode_reward_min": 44488.9133682251, "episode_reward_mean": 52407.90064525604, "episode_len_mean": 135.3846153846154, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 44488.9133682251}, "policy_reward_max": {"agent_0": 56493.92005157471}, "policy_reward_mean": {"agent_0": 52407.90064525604}, "custom_metrics": {"num_batches_mean": 5.461538461538462, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49467.946687698364, 52482.806606292725, 49912.47353363037, 53939.90686035156, 54933.86039733887, 50930.30687904358, 54468.09355163574, 52868.72660827637, 54872.78704071045, 56493.92005157471, 53656.04662132263, 51084.080041885376, 51347.81353855133, 53777.86011123657, 51655.7200088501, 49604.76685333252, 50323.01328086853, 54694.66696166992, 50843.96654129028, 54196.27337360382, 52176.60032272339, 53682.16024017334, 44488.9133682251, 53752.893352508545, 54632.83367919922, 52316.980264663696], "episode_lengths": [136, 136, 136, 135, 134, 136, 134, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [49467.946687698364, 52482.806606292725, 49912.47353363037, 53939.90686035156, 54933.86039733887, 50930.30687904358, 54468.09355163574, 52868.72660827637, 54872.78704071045, 56493.92005157471, 53656.04662132263, 51084.080041885376, 51347.81353855133, 53777.86011123657, 51655.7200088501, 49604.76685333252, 50323.01328086853, 54694.66696166992, 50843.96654129028, 54196.27337360382, 52176.60032272339, 53682.16024017334, 44488.9133682251, 53752.893352508545, 54632.83367919922, 52316.980264663696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.87474070568762, "mean_inference_ms": 6.351196444069846, "mean_action_processing_ms": 0.20400852670330977, "mean_env_wait_ms": 209.25708363306592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041837875659649186, "StateBufferConnector_ms": 0.007245173821082482, "ViewRequirementAgentConnector_ms": 0.2696046462425819}}, "episode_reward_max": 56493.92005157471, "episode_reward_min": 44488.9133682251, "episode_reward_mean": 52407.90064525604, "episode_len_mean": 135.3846153846154, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 44488.9133682251}, "policy_reward_max": {"agent_0": 56493.92005157471}, "policy_reward_mean": {"agent_0": 52407.90064525604}, "hist_stats": {"episode_reward": [49467.946687698364, 52482.806606292725, 49912.47353363037, 53939.90686035156, 54933.86039733887, 50930.30687904358, 54468.09355163574, 52868.72660827637, 54872.78704071045, 56493.92005157471, 53656.04662132263, 51084.080041885376, 51347.81353855133, 53777.86011123657, 51655.7200088501, 49604.76685333252, 50323.01328086853, 54694.66696166992, 50843.96654129028, 54196.27337360382, 52176.60032272339, 53682.16024017334, 44488.9133682251, 53752.893352508545, 54632.83367919922, 52316.980264663696], "episode_lengths": [136, 136, 136, 135, 134, 136, 134, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [49467.946687698364, 52482.806606292725, 49912.47353363037, 53939.90686035156, 54933.86039733887, 50930.30687904358, 54468.09355163574, 52868.72660827637, 54872.78704071045, 56493.92005157471, 53656.04662132263, 51084.080041885376, 51347.81353855133, 53777.86011123657, 51655.7200088501, 49604.76685333252, 50323.01328086853, 54694.66696166992, 50843.96654129028, 54196.27337360382, 52176.60032272339, 53682.16024017334, 44488.9133682251, 53752.893352508545, 54632.83367919922, 52316.980264663696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.87474070568762, "mean_inference_ms": 6.351196444069846, "mean_action_processing_ms": 0.20400852670330977, "mean_env_wait_ms": 209.25708363306592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041837875659649186, "StateBufferConnector_ms": 0.007245173821082482, "ViewRequirementAgentConnector_ms": 0.2696046462425819}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.9403524241821, "num_env_steps_trained_throughput_per_sec": 224.9403524241821, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 15935.24, "sample_time_ms": 11602.274, "learn_time_ms": 4159.139, "learn_throughput": 961.737, "synch_weights_time_ms": 172.828}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 1768, "training_iteration": 63, "trial_id": "185f8_00000", "date": "2025-03-21_12-01-11", "timestamp": 1742558471, "time_this_iter_s": 17.859235763549805, "time_total_s": 1000.6853125095367, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090b5b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1000.6853125095367, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 99.31666666666668, "ram_util_percent": 13.679166666666665}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.8292236328125, "policy_loss": -0.010374524630606174, "vf_loss": 9.838379859924316, "vf_explained_var": 6.196399482405468e-08, "kl": 0.0060884892009198666, "entropy": 0.39845702052116394, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 56790.35368156433, "episode_reward_min": 44823.946714401245, "episode_reward_mean": 52109.24610177599, "episode_len_mean": 135.26153846153846, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {"agent_0": 44823.946714401245}, "policy_reward_max": {"agent_0": 56790.35368156433}, "policy_reward_mean": {"agent_0": 52109.24610177599}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54001.060066223145, 48813.020061045885, 53010.62015533447, 56032.56020927429, 54414.100299835205, 52858.94689178467, 52348.76680755615, 51863.54699707031, 51035.313581466675, 52879.26010513306, 48574.479947566986, 55522.386810302734, 50514.519958496094, 55621.15358734131, 53036.020221710205, 54105.68684768677, 51639.95359611511, 55548.1866607666, 51124.76034927368, 54200.83367919922, 54732.900314331055, 51903.820209503174, 54443.35321807861, 52329.186752319336, 53216.88029384613, 56657.18682861328, 51243.68678188324, 51324.146797180176, 53028.353523254395, 52839.393434524536, 50770.87343597412, 52949.38706588745, 55021.13339281082, 51065.91354560852, 52784.16661834717, 52814.30686187744, 49929.266788482666, 52735.16670227051, 51256.95992851257, 51233.66004943848, 51132.30013656616, 55368.380126953125, 44823.946714401245, 48188.686809539795, 56790.35368156433, 56595.180252075195, 54604.080176353455, 49045.19364929199, 49053.58679008484, 45895.74021458626, 51566.40684890747, 51781.31343269348, 52837.52669715881, 47002.94660758972, 46538.25345134735, 53709.933364868164, 52330.68675994873, 51982.8804101944, 46563.993534088135, 51844.793474435806, 54158.37364196777, 56274.15347290039, 46010.566643714905, 51499.820081710815, 52076.980266571045], "episode_lengths": [135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 135, 136, 134, 135, 135, 135, 135, 135, 134, 136, 135, 134, 134, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54001.060066223145, 48813.020061045885, 53010.62015533447, 56032.56020927429, 54414.100299835205, 52858.94689178467, 52348.76680755615, 51863.54699707031, 51035.313581466675, 52879.26010513306, 48574.479947566986, 55522.386810302734, 50514.519958496094, 55621.15358734131, 53036.020221710205, 54105.68684768677, 51639.95359611511, 55548.1866607666, 51124.76034927368, 54200.83367919922, 54732.900314331055, 51903.820209503174, 54443.35321807861, 52329.186752319336, 53216.88029384613, 56657.18682861328, 51243.68678188324, 51324.146797180176, 53028.353523254395, 52839.393434524536, 50770.87343597412, 52949.38706588745, 55021.13339281082, 51065.91354560852, 52784.16661834717, 52814.30686187744, 49929.266788482666, 52735.16670227051, 51256.95992851257, 51233.66004943848, 51132.30013656616, 55368.380126953125, 44823.946714401245, 48188.686809539795, 56790.35368156433, 56595.180252075195, 54604.080176353455, 49045.19364929199, 49053.58679008484, 45895.74021458626, 51566.40684890747, 51781.31343269348, 52837.52669715881, 47002.94660758972, 46538.25345134735, 53709.933364868164, 52330.68675994873, 51982.8804101944, 46563.993534088135, 51844.793474435806, 54158.37364196777, 56274.15347290039, 46010.566643714905, 51499.820081710815, 52076.980266571045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.120001342618195, "mean_inference_ms": 6.675479637366826, "mean_action_processing_ms": 0.20413184643024465, "mean_env_wait_ms": 225.1303865677128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0526890387901893, "StateBufferConnector_ms": 0.006129925067608173, "ViewRequirementAgentConnector_ms": 0.2121870334331806}}, "episode_reward_max": 56790.35368156433, "episode_reward_min": 44823.946714401245, "episode_reward_mean": 52109.24610177599, "episode_len_mean": 135.26153846153846, "episodes_this_iter": 65, "policy_reward_min": {"agent_0": 44823.946714401245}, "policy_reward_max": {"agent_0": 56790.35368156433}, "policy_reward_mean": {"agent_0": 52109.24610177599}, "hist_stats": {"episode_reward": [54001.060066223145, 48813.020061045885, 53010.62015533447, 56032.56020927429, 54414.100299835205, 52858.94689178467, 52348.76680755615, 51863.54699707031, 51035.313581466675, 52879.26010513306, 48574.479947566986, 55522.386810302734, 50514.519958496094, 55621.15358734131, 53036.020221710205, 54105.68684768677, 51639.95359611511, 55548.1866607666, 51124.76034927368, 54200.83367919922, 54732.900314331055, 51903.820209503174, 54443.35321807861, 52329.186752319336, 53216.88029384613, 56657.18682861328, 51243.68678188324, 51324.146797180176, 53028.353523254395, 52839.393434524536, 50770.87343597412, 52949.38706588745, 55021.13339281082, 51065.91354560852, 52784.16661834717, 52814.30686187744, 49929.266788482666, 52735.16670227051, 51256.95992851257, 51233.66004943848, 51132.30013656616, 55368.380126953125, 44823.946714401245, 48188.686809539795, 56790.35368156433, 56595.180252075195, 54604.080176353455, 49045.19364929199, 49053.58679008484, 45895.74021458626, 51566.40684890747, 51781.31343269348, 52837.52669715881, 47002.94660758972, 46538.25345134735, 53709.933364868164, 52330.68675994873, 51982.8804101944, 46563.993534088135, 51844.793474435806, 54158.37364196777, 56274.15347290039, 46010.566643714905, 51499.820081710815, 52076.980266571045], "episode_lengths": [135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 135, 136, 134, 135, 135, 135, 135, 135, 134, 136, 135, 134, 134, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54001.060066223145, 48813.020061045885, 53010.62015533447, 56032.56020927429, 54414.100299835205, 52858.94689178467, 52348.76680755615, 51863.54699707031, 51035.313581466675, 52879.26010513306, 48574.479947566986, 55522.386810302734, 50514.519958496094, 55621.15358734131, 53036.020221710205, 54105.68684768677, 51639.95359611511, 55548.1866607666, 51124.76034927368, 54200.83367919922, 54732.900314331055, 51903.820209503174, 54443.35321807861, 52329.186752319336, 53216.88029384613, 56657.18682861328, 51243.68678188324, 51324.146797180176, 53028.353523254395, 52839.393434524536, 50770.87343597412, 52949.38706588745, 55021.13339281082, 51065.91354560852, 52784.16661834717, 52814.30686187744, 49929.266788482666, 52735.16670227051, 51256.95992851257, 51233.66004943848, 51132.30013656616, 55368.380126953125, 44823.946714401245, 48188.686809539795, 56790.35368156433, 56595.180252075195, 54604.080176353455, 49045.19364929199, 49053.58679008484, 45895.74021458626, 51566.40684890747, 51781.31343269348, 52837.52669715881, 47002.94660758972, 46538.25345134735, 53709.933364868164, 52330.68675994873, 51982.8804101944, 46563.993534088135, 51844.793474435806, 54158.37364196777, 56274.15347290039, 46010.566643714905, 51499.820081710815, 52076.980266571045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.120001342618195, "mean_inference_ms": 6.675479637366826, "mean_action_processing_ms": 0.20413184643024465, "mean_env_wait_ms": 225.1303865677128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0526890387901893, "StateBufferConnector_ms": 0.006129925067608173, "ViewRequirementAgentConnector_ms": 0.2121870334331806}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.2441895331528, "num_env_steps_trained_throughput_per_sec": 257.2441895331528, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15954.764, "sample_time_ms": 11631.582, "learn_time_ms": 4152.266, "learn_throughput": 963.329, "synch_weights_time_ms": 169.92}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 1833, "training_iteration": 64, "trial_id": "185f8_00000", "date": "2025-03-21_12-01-27", "timestamp": 1742558487, "time_this_iter_s": 15.600763320922852, "time_total_s": 1016.2860758304596, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1016.2860758304596, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 94.41363636363639, "ram_util_percent": 13.672727272727268}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.922772407531738, "policy_loss": -0.010441726073622704, "vf_loss": 9.931884765625, "vf_explained_var": 1.1175870895385742e-07, "kl": 0.006646215450018644, "entropy": 0.40366873145103455, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 57563.973571777344, "episode_reward_min": 46699.33999633789, "episode_reward_mean": 51923.50706292523, "episode_len_mean": 135.4814814814815, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {"agent_0": 46699.33999633789}, "policy_reward_max": {"agent_0": 57563.973571777344}, "policy_reward_mean": {"agent_0": 51923.50706292523}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51313.960136413574, 51413.70002555847, 53359.426862716675, 51364.00014877319, 56366.806869506836, 49278.926595687866, 54619.22715759277, 52346.993518829346, 53301.11996650696, 48614.62008666992, 53308.320404052734, 54136.6668510437, 48576.1933555603, 54659.8268661499, 57563.973571777344, 52824.320152282715, 54390.85345840454, 51600.786856651306, 51827.5134652853, 50840.35347747803, 52413.860218048096, 48119.56679916382, 52222.9401550293, 51420.513511657715, 46699.33999633789, 49687.353494644165, 49663.52669715881], "episode_lengths": [135, 136, 135, 136, 136, 136, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [51313.960136413574, 51413.70002555847, 53359.426862716675, 51364.00014877319, 56366.806869506836, 49278.926595687866, 54619.22715759277, 52346.993518829346, 53301.11996650696, 48614.62008666992, 53308.320404052734, 54136.6668510437, 48576.1933555603, 54659.8268661499, 57563.973571777344, 52824.320152282715, 54390.85345840454, 51600.786856651306, 51827.5134652853, 50840.35347747803, 52413.860218048096, 48119.56679916382, 52222.9401550293, 51420.513511657715, 46699.33999633789, 49687.353494644165, 49663.52669715881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.7261048661393, "mean_inference_ms": 6.679804468060706, "mean_action_processing_ms": 0.20255363891130113, "mean_env_wait_ms": 224.72722361014686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041804490266022856, "StateBufferConnector_ms": 0.006415225841380932, "ViewRequirementAgentConnector_ms": 0.19871658749050564}}, "episode_reward_max": 57563.973571777344, "episode_reward_min": 46699.33999633789, "episode_reward_mean": 51923.50706292523, "episode_len_mean": 135.4814814814815, "episodes_this_iter": 27, "policy_reward_min": {"agent_0": 46699.33999633789}, "policy_reward_max": {"agent_0": 57563.973571777344}, "policy_reward_mean": {"agent_0": 51923.50706292523}, "hist_stats": {"episode_reward": [51313.960136413574, 51413.70002555847, 53359.426862716675, 51364.00014877319, 56366.806869506836, 49278.926595687866, 54619.22715759277, 52346.993518829346, 53301.11996650696, 48614.62008666992, 53308.320404052734, 54136.6668510437, 48576.1933555603, 54659.8268661499, 57563.973571777344, 52824.320152282715, 54390.85345840454, 51600.786856651306, 51827.5134652853, 50840.35347747803, 52413.860218048096, 48119.56679916382, 52222.9401550293, 51420.513511657715, 46699.33999633789, 49687.353494644165, 49663.52669715881], "episode_lengths": [135, 136, 135, 136, 136, 136, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [51313.960136413574, 51413.70002555847, 53359.426862716675, 51364.00014877319, 56366.806869506836, 49278.926595687866, 54619.22715759277, 52346.993518829346, 53301.11996650696, 48614.62008666992, 53308.320404052734, 54136.6668510437, 48576.1933555603, 54659.8268661499, 57563.973571777344, 52824.320152282715, 54390.85345840454, 51600.786856651306, 51827.5134652853, 50840.35347747803, 52413.860218048096, 48119.56679916382, 52222.9401550293, 51420.513511657715, 46699.33999633789, 49687.353494644165, 49663.52669715881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.7261048661393, "mean_inference_ms": 6.679804468060706, "mean_action_processing_ms": 0.20255363891130113, "mean_env_wait_ms": 224.72722361014686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041804490266022856, "StateBufferConnector_ms": 0.006415225841380932, "ViewRequirementAgentConnector_ms": 0.19871658749050564}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.72765580555128, "num_env_steps_trained_throughput_per_sec": 226.72765580555128, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 16244.124, "sample_time_ms": 11941.854, "learn_time_ms": 4136.002, "learn_throughput": 967.117, "synch_weights_time_ms": 165.272}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 1860, "training_iteration": 65, "trial_id": "185f8_00000", "date": "2025-03-21_12-01-45", "timestamp": 1742558505, "time_this_iter_s": 17.69831943511963, "time_total_s": 1033.9843952655792, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26244c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1033.9843952655792, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.18333333333334, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99201488494873, "policy_loss": -0.009133251383900642, "vf_loss": 10.0, "vf_explained_var": 2.882753733501886e-07, "kl": 0.005738487467169762, "entropy": 0.3902888000011444, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 49663.52669715881, "episode_reward_min": 49663.52669715881, "episode_reward_mean": 49663.52669715881, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49663.52669715881}, "policy_reward_max": {"agent_0": 49663.52669715881}, "policy_reward_mean": {"agent_0": 49663.52669715881}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49663.52669715881], "episode_lengths": [136], "policy_agent_0_reward": [49663.52669715881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.17108707528799, "mean_inference_ms": 6.019917088938928, "mean_action_processing_ms": 0.1936294550164739, "mean_env_wait_ms": 228.8220744474412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026273727416992188, "StateBufferConnector_ms": 0.0047206878662109375, "ViewRequirementAgentConnector_ms": 0.11925697326660156}}, "episode_reward_max": 49663.52669715881, "episode_reward_min": 49663.52669715881, "episode_reward_mean": 49663.52669715881, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49663.52669715881}, "policy_reward_max": {"agent_0": 49663.52669715881}, "policy_reward_mean": {"agent_0": 49663.52669715881}, "hist_stats": {"episode_reward": [49663.52669715881], "episode_lengths": [136], "policy_agent_0_reward": [49663.52669715881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.17108707528799, "mean_inference_ms": 6.019917088938928, "mean_action_processing_ms": 0.1936294550164739, "mean_env_wait_ms": 228.8220744474412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026273727416992188, "StateBufferConnector_ms": 0.0047206878662109375, "ViewRequirementAgentConnector_ms": 0.11925697326660156}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.81905652152176, "num_env_steps_trained_throughput_per_sec": 281.81905652152176, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 15741.188, "sample_time_ms": 11486.708, "learn_time_ms": 4097.554, "learn_throughput": 976.192, "synch_weights_time_ms": 155.901}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 1860, "training_iteration": 66, "trial_id": "185f8_00000", "date": "2025-03-21_12-01-59", "timestamp": 1742558519, "time_this_iter_s": 14.242666959762573, "time_total_s": 1048.2270622253418, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1048.2270622253418, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.07500000000002, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0625, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910371780395508, "policy_loss": -0.012321192771196365, "vf_loss": 9.921142578125, "vf_explained_var": -2.7703742944140686e-07, "kl": 0.00775128835812211, "entropy": 0.3956320583820343, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 59448.76010131836, "episode_reward_min": 47645.02669429779, "episode_reward_mean": 53092.885936662555, "episode_len_mean": 135.0625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47645.02669429779}, "policy_reward_max": {"agent_0": 59448.76010131836}, "policy_reward_mean": {"agent_0": 53092.885936662555}, "custom_metrics": {"num_batches_mean": 5.0625, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48439.48002243042, 52215.08656311035, 54470.773491859436, 50857.386768341064, 56470.17330932617, 49623.77336883545, 54564.90690994263, 50537.933210372925, 54607.993644714355, 55971.680099487305, 53315.14018249512, 54736.62008857727, 53850.20642852783, 53005.15348815918, 59448.76010131836, 51946.44011926651, 51363.66666126251, 48884.24014091492, 50855.16675949097, 53114.5470123291, 53772.99341583252, 55638.04039001465, 52929.1667098999, 54412.18025588989, 56414.76689147949, 56754.42695617676, 47645.02669429779, 52294.126724243164, 50420.88652038574, 53349.22019195557, 52503.89340591431, 54558.4934463501], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 134, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [48439.48002243042, 52215.08656311035, 54470.773491859436, 50857.386768341064, 56470.17330932617, 49623.77336883545, 54564.90690994263, 50537.933210372925, 54607.993644714355, 55971.680099487305, 53315.14018249512, 54736.62008857727, 53850.20642852783, 53005.15348815918, 59448.76010131836, 51946.44011926651, 51363.66666126251, 48884.24014091492, 50855.16675949097, 53114.5470123291, 53772.99341583252, 55638.04039001465, 52929.1667098999, 54412.18025588989, 56414.76689147949, 56754.42695617676, 47645.02669429779, 52294.126724243164, 50420.88652038574, 53349.22019195557, 52503.89340591431, 54558.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.02673102683551, "mean_inference_ms": 6.402588855293303, "mean_action_processing_ms": 0.20353010709096037, "mean_env_wait_ms": 210.52921074316257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061708688735961914, "StateBufferConnector_ms": 0.0066436827182769775, "ViewRequirementAgentConnector_ms": 0.2264469861984253}}, "episode_reward_max": 59448.76010131836, "episode_reward_min": 47645.02669429779, "episode_reward_mean": 53092.885936662555, "episode_len_mean": 135.0625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47645.02669429779}, "policy_reward_max": {"agent_0": 59448.76010131836}, "policy_reward_mean": {"agent_0": 53092.885936662555}, "hist_stats": {"episode_reward": [48439.48002243042, 52215.08656311035, 54470.773491859436, 50857.386768341064, 56470.17330932617, 49623.77336883545, 54564.90690994263, 50537.933210372925, 54607.993644714355, 55971.680099487305, 53315.14018249512, 54736.62008857727, 53850.20642852783, 53005.15348815918, 59448.76010131836, 51946.44011926651, 51363.66666126251, 48884.24014091492, 50855.16675949097, 53114.5470123291, 53772.99341583252, 55638.04039001465, 52929.1667098999, 54412.18025588989, 56414.76689147949, 56754.42695617676, 47645.02669429779, 52294.126724243164, 50420.88652038574, 53349.22019195557, 52503.89340591431, 54558.4934463501], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 134, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [48439.48002243042, 52215.08656311035, 54470.773491859436, 50857.386768341064, 56470.17330932617, 49623.77336883545, 54564.90690994263, 50537.933210372925, 54607.993644714355, 55971.680099487305, 53315.14018249512, 54736.62008857727, 53850.20642852783, 53005.15348815918, 59448.76010131836, 51946.44011926651, 51363.66666126251, 48884.24014091492, 50855.16675949097, 53114.5470123291, 53772.99341583252, 55638.04039001465, 52929.1667098999, 54412.18025588989, 56414.76689147949, 56754.42695617676, 47645.02669429779, 52294.126724243164, 50420.88652038574, 53349.22019195557, 52503.89340591431, 54558.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.02673102683551, "mean_inference_ms": 6.402588855293303, "mean_action_processing_ms": 0.20353010709096037, "mean_env_wait_ms": 210.52921074316257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061708688735961914, "StateBufferConnector_ms": 0.0066436827182769775, "ViewRequirementAgentConnector_ms": 0.2264469861984253}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.7175424761921, "num_env_steps_trained_throughput_per_sec": 211.7175424761921, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 16151.493, "sample_time_ms": 11893.581, "learn_time_ms": 4100.089, "learn_throughput": 975.589, "synch_weights_time_ms": 156.793}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 1892, "training_iteration": 67, "trial_id": "185f8_00000", "date": "2025-03-21_12-02-18", "timestamp": 1742558538, "time_this_iter_s": 18.939870595932007, "time_total_s": 1067.1669328212738, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26265f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1067.1669328212738, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.19166666666668, "ram_util_percent": 13.679166666666665}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988187789916992, "policy_loss": -0.0132216215133667, "vf_loss": 10.0, "vf_explained_var": 2.6157746901844803e-07, "kl": 0.007046845741569996, "entropy": 0.39907005429267883, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 54558.4934463501, "episode_reward_min": 54558.4934463501, "episode_reward_mean": 54558.4934463501, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54558.4934463501}, "policy_reward_max": {"agent_0": 54558.4934463501}, "policy_reward_mean": {"agent_0": 54558.4934463501}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54558.4934463501], "episode_lengths": [135], "policy_agent_0_reward": [54558.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.93074115059906, "mean_inference_ms": 6.339695419152865, "mean_action_processing_ms": 0.1932184260749472, "mean_env_wait_ms": 209.9273572347479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05314350128173828, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.15571117401123047}}, "episode_reward_max": 54558.4934463501, "episode_reward_min": 54558.4934463501, "episode_reward_mean": 54558.4934463501, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54558.4934463501}, "policy_reward_max": {"agent_0": 54558.4934463501}, "policy_reward_mean": {"agent_0": 54558.4934463501}, "hist_stats": {"episode_reward": [54558.4934463501], "episode_lengths": [135], "policy_agent_0_reward": [54558.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.93074115059906, "mean_inference_ms": 6.339695419152865, "mean_action_processing_ms": 0.1932184260749472, "mean_env_wait_ms": 209.9273572347479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05314350128173828, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.15571117401123047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5633562853953, "num_env_steps_trained_throughput_per_sec": 296.5633562853953, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 16036.792, "sample_time_ms": 11767.25, "learn_time_ms": 4118.414, "learn_throughput": 971.248, "synch_weights_time_ms": 150.187}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 1892, "training_iteration": 68, "trial_id": "185f8_00000", "date": "2025-03-21_12-02-32", "timestamp": 1742558552, "time_this_iter_s": 13.534640312194824, "time_total_s": 1080.7015731334686, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2626cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1080.7015731334686, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 99.43157894736841, "ram_util_percent": 13.668421052631578}}
{"custom_metrics": {"num_batches_mean": 5.532608695652174, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.761577606201172, "policy_loss": -0.012210728600621223, "vf_loss": 9.7724609375, "vf_explained_var": -1.4056762154268654e-07, "kl": 0.006633658427745104, "entropy": 0.3891443908214569, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 58026.36025238037, "episode_reward_min": 46509.626896858215, "episode_reward_mean": 52719.19917087808, "episode_len_mean": 135.2608695652174, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46509.626896858215}, "policy_reward_max": {"agent_0": 58026.36025238037}, "policy_reward_mean": {"agent_0": 52719.19917087808}, "custom_metrics": {"num_batches_mean": 5.532608695652174, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49487.92022705078, 52345.92688751221, 52116.18679237366, 55701.366802215576, 48553.260204315186, 55760.16011047363, 50833.85343551636, 54779.24690628052, 51791.76700592041, 52842.71340560913, 52480.13355064392, 50485.7532967329, 53903.57322692871, 53244.046714782715, 53158.626874923706, 50743.60661506653, 51809.973249435425, 49867.8334941864, 52195.52701282501, 54609.39366149902, 51428.780099868774, 54805.82684326172, 55835.37364196777, 54751.40655517578, 53830.82702255249, 49243.87368965149, 51387.100105285645, 52063.28679561615, 53636.846939086914, 54215.32657241821, 57471.34033203125, 53164.92020225525, 49215.786542892456, 50624.89997768402, 52127.246448516846, 52720.413385391235, 52724.43998718262, 50618.966651916504, 52252.52013397217, 48855.40683174133, 55062.080139160156, 53063.64000701904, 51487.826805114746, 51215.67345428467, 47843.12671852112, 54410.64016723633, 51068.69998931885, 53535.26014328003, 55634.600105285645, 50425.786801695824, 54225.466735839844, 54839.12013244629, 52193.31994628906, 53755.01365661621, 54749.56678771973, 51332.04000854492, 55329.42696380615, 53827.38683128357, 50969.40658760071, 50750.920471191406, 52934.25352525711, 52875.12683677673, 53557.200077056885, 47525.047068595886, 53556.706703186035, 55081.50710296631, 50339.16672897339, 51548.899951934814, 46509.626896858215, 53703.606884002686, 53031.26024246216, 51753.53345108032, 56532.55337524414, 50897.40693664551, 54729.84011077881, 52996.273208618164, 56031.879974365234, 54843.31343841553, 54386.060161590576, 51365.33994293213, 54281.46008968353, 57240.54650878906, 55091.653564453125, 53126.14656448364, 50536.80012702942, 48491.68662929535, 55333.400113105774, 52085.61991119385, 49315.15320119262, 54017.439865112305, 55016.993591308594, 58026.36025238037], "episode_lengths": [135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 136, 136, 137, 135, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 136, 135], "policy_agent_0_reward": [49487.92022705078, 52345.92688751221, 52116.18679237366, 55701.366802215576, 48553.260204315186, 55760.16011047363, 50833.85343551636, 54779.24690628052, 51791.76700592041, 52842.71340560913, 52480.13355064392, 50485.7532967329, 53903.57322692871, 53244.046714782715, 53158.626874923706, 50743.60661506653, 51809.973249435425, 49867.8334941864, 52195.52701282501, 54609.39366149902, 51428.780099868774, 54805.82684326172, 55835.37364196777, 54751.40655517578, 53830.82702255249, 49243.87368965149, 51387.100105285645, 52063.28679561615, 53636.846939086914, 54215.32657241821, 57471.34033203125, 53164.92020225525, 49215.786542892456, 50624.89997768402, 52127.246448516846, 52720.413385391235, 52724.43998718262, 50618.966651916504, 52252.52013397217, 48855.40683174133, 55062.080139160156, 53063.64000701904, 51487.826805114746, 51215.67345428467, 47843.12671852112, 54410.64016723633, 51068.69998931885, 53535.26014328003, 55634.600105285645, 50425.786801695824, 54225.466735839844, 54839.12013244629, 52193.31994628906, 53755.01365661621, 54749.56678771973, 51332.04000854492, 55329.42696380615, 53827.38683128357, 50969.40658760071, 50750.920471191406, 52934.25352525711, 52875.12683677673, 53557.200077056885, 47525.047068595886, 53556.706703186035, 55081.50710296631, 50339.16672897339, 51548.899951934814, 46509.626896858215, 53703.606884002686, 53031.26024246216, 51753.53345108032, 56532.55337524414, 50897.40693664551, 54729.84011077881, 52996.273208618164, 56031.879974365234, 54843.31343841553, 54386.060161590576, 51365.33994293213, 54281.46008968353, 57240.54650878906, 55091.653564453125, 53126.14656448364, 50536.80012702942, 48491.68662929535, 55333.400113105774, 52085.61991119385, 49315.15320119262, 54017.439865112305, 55016.993591308594, 58026.36025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.98669002706849, "mean_inference_ms": 6.693887336803108, "mean_action_processing_ms": 0.20326169086600232, "mean_env_wait_ms": 226.36497973677777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05739046179729959, "StateBufferConnector_ms": 0.0062921772832455845, "ViewRequirementAgentConnector_ms": 0.22325178851252017}}, "episode_reward_max": 58026.36025238037, "episode_reward_min": 46509.626896858215, "episode_reward_mean": 52719.19917087808, "episode_len_mean": 135.2608695652174, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46509.626896858215}, "policy_reward_max": {"agent_0": 58026.36025238037}, "policy_reward_mean": {"agent_0": 52719.19917087808}, "hist_stats": {"episode_reward": [49487.92022705078, 52345.92688751221, 52116.18679237366, 55701.366802215576, 48553.260204315186, 55760.16011047363, 50833.85343551636, 54779.24690628052, 51791.76700592041, 52842.71340560913, 52480.13355064392, 50485.7532967329, 53903.57322692871, 53244.046714782715, 53158.626874923706, 50743.60661506653, 51809.973249435425, 49867.8334941864, 52195.52701282501, 54609.39366149902, 51428.780099868774, 54805.82684326172, 55835.37364196777, 54751.40655517578, 53830.82702255249, 49243.87368965149, 51387.100105285645, 52063.28679561615, 53636.846939086914, 54215.32657241821, 57471.34033203125, 53164.92020225525, 49215.786542892456, 50624.89997768402, 52127.246448516846, 52720.413385391235, 52724.43998718262, 50618.966651916504, 52252.52013397217, 48855.40683174133, 55062.080139160156, 53063.64000701904, 51487.826805114746, 51215.67345428467, 47843.12671852112, 54410.64016723633, 51068.69998931885, 53535.26014328003, 55634.600105285645, 50425.786801695824, 54225.466735839844, 54839.12013244629, 52193.31994628906, 53755.01365661621, 54749.56678771973, 51332.04000854492, 55329.42696380615, 53827.38683128357, 50969.40658760071, 50750.920471191406, 52934.25352525711, 52875.12683677673, 53557.200077056885, 47525.047068595886, 53556.706703186035, 55081.50710296631, 50339.16672897339, 51548.899951934814, 46509.626896858215, 53703.606884002686, 53031.26024246216, 51753.53345108032, 56532.55337524414, 50897.40693664551, 54729.84011077881, 52996.273208618164, 56031.879974365234, 54843.31343841553, 54386.060161590576, 51365.33994293213, 54281.46008968353, 57240.54650878906, 55091.653564453125, 53126.14656448364, 50536.80012702942, 48491.68662929535, 55333.400113105774, 52085.61991119385, 49315.15320119262, 54017.439865112305, 55016.993591308594, 58026.36025238037], "episode_lengths": [135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 136, 136, 137, 135, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 136, 135], "policy_agent_0_reward": [49487.92022705078, 52345.92688751221, 52116.18679237366, 55701.366802215576, 48553.260204315186, 55760.16011047363, 50833.85343551636, 54779.24690628052, 51791.76700592041, 52842.71340560913, 52480.13355064392, 50485.7532967329, 53903.57322692871, 53244.046714782715, 53158.626874923706, 50743.60661506653, 51809.973249435425, 49867.8334941864, 52195.52701282501, 54609.39366149902, 51428.780099868774, 54805.82684326172, 55835.37364196777, 54751.40655517578, 53830.82702255249, 49243.87368965149, 51387.100105285645, 52063.28679561615, 53636.846939086914, 54215.32657241821, 57471.34033203125, 53164.92020225525, 49215.786542892456, 50624.89997768402, 52127.246448516846, 52720.413385391235, 52724.43998718262, 50618.966651916504, 52252.52013397217, 48855.40683174133, 55062.080139160156, 53063.64000701904, 51487.826805114746, 51215.67345428467, 47843.12671852112, 54410.64016723633, 51068.69998931885, 53535.26014328003, 55634.600105285645, 50425.786801695824, 54225.466735839844, 54839.12013244629, 52193.31994628906, 53755.01365661621, 54749.56678771973, 51332.04000854492, 55329.42696380615, 53827.38683128357, 50969.40658760071, 50750.920471191406, 52934.25352525711, 52875.12683677673, 53557.200077056885, 47525.047068595886, 53556.706703186035, 55081.50710296631, 50339.16672897339, 51548.899951934814, 46509.626896858215, 53703.606884002686, 53031.26024246216, 51753.53345108032, 56532.55337524414, 50897.40693664551, 54729.84011077881, 52996.273208618164, 56031.879974365234, 54843.31343841553, 54386.060161590576, 51365.33994293213, 54281.46008968353, 57240.54650878906, 55091.653564453125, 53126.14656448364, 50536.80012702942, 48491.68662929535, 55333.400113105774, 52085.61991119385, 49315.15320119262, 54017.439865112305, 55016.993591308594, 58026.36025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.98669002706849, "mean_inference_ms": 6.693887336803108, "mean_action_processing_ms": 0.20326169086600232, "mean_env_wait_ms": 226.36497973677777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05739046179729959, "StateBufferConnector_ms": 0.0062921772832455845, "ViewRequirementAgentConnector_ms": 0.22325178851252017}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.93345392831358, "num_env_steps_trained_throughput_per_sec": 195.93345392831358, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 16498.707, "sample_time_ms": 12203.424, "learn_time_ms": 4149.59, "learn_throughput": 963.951, "synch_weights_time_ms": 144.741}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1984, "training_iteration": 69, "trial_id": "185f8_00000", "date": "2025-03-21_12-02-52", "timestamp": 1742558572, "time_this_iter_s": 20.481793880462646, "time_total_s": 1101.1833670139313, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1101.1833670139313, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 94.38571428571429, "ram_util_percent": 13.667857142857141}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986554145812988, "policy_loss": -0.0151783786714077, "vf_loss": 10.0, "vf_explained_var": 2.607703164514419e-09, "kl": 0.008664033375680447, "entropy": 0.3877585828304291, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 58026.36025238037, "episode_reward_min": 58026.36025238037, "episode_reward_mean": 58026.36025238037, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58026.36025238037}, "policy_reward_max": {"agent_0": 58026.36025238037}, "policy_reward_mean": {"agent_0": 58026.36025238037}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58026.36025238037], "episode_lengths": [135], "policy_agent_0_reward": [58026.36025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.360847562942745, "mean_inference_ms": 6.297773988930118, "mean_action_processing_ms": 0.2047633520344794, "mean_env_wait_ms": 229.35599026608756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039768218994140625, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1634359359741211}}, "episode_reward_max": 58026.36025238037, "episode_reward_min": 58026.36025238037, "episode_reward_mean": 58026.36025238037, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58026.36025238037}, "policy_reward_max": {"agent_0": 58026.36025238037}, "policy_reward_mean": {"agent_0": 58026.36025238037}, "hist_stats": {"episode_reward": [58026.36025238037], "episode_lengths": [135], "policy_agent_0_reward": [58026.36025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.360847562942745, "mean_inference_ms": 6.297773988930118, "mean_action_processing_ms": 0.2047633520344794, "mean_env_wait_ms": 229.35599026608756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039768218994140625, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1634359359741211}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.4874151476175, "num_env_steps_trained_throughput_per_sec": 277.4874151476175, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 16022.27, "sample_time_ms": 11734.125, "learn_time_ms": 4135.847, "learn_throughput": 967.154, "synch_weights_time_ms": 151.328}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 1984, "training_iteration": 70, "trial_id": "185f8_00000", "date": "2025-03-21_12-03-07", "timestamp": 1742558587, "time_this_iter_s": 14.478984832763672, "time_total_s": 1115.662351846695, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1115.662351846695, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.45714285714286, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910587310791016, "policy_loss": -0.011355658993124962, "vf_loss": 9.92041015625, "vf_explained_var": -1.5149513643564205e-08, "kl": 0.007660932373255491, "entropy": 0.43879613280296326, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 58516.38008117676, "episode_reward_min": 46755.600118637085, "episode_reward_mean": 52278.811807602644, "episode_len_mean": 135.25, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46755.600118637085}, "policy_reward_max": {"agent_0": 58516.38008117676}, "policy_reward_mean": {"agent_0": 52278.811807602644}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53832.48017549515, 51442.23358154297, 52861.82692527771, 52273.94659233093, 49674.19349861145, 54302.80000305176, 52999.573596954346, 54438.013690948486, 55109.36681365967, 49963.95334815979, 53166.21983909607, 52948.68019104004, 48490.619901657104, 53738.41343688965, 51699.37339115143, 46755.600118637085, 49084.7466135025, 54329.97350692749, 48794.01341056824, 49126.76009607315, 54825.533740997314, 53844.10681152344, 54062.16016960144, 51229.7269077301, 50685.99347496033, 58516.38008117676, 49079.5402469635, 52013.38015174866, 55721.62707519531, 52985.61338806152, 56434.23361968994, 48490.89344406128], "episode_lengths": [135, 135, 134, 136, 135, 135, 136, 135, 135, 136, 136, 135, 135, 134, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 134, 134, 135, 135], "policy_agent_0_reward": [53832.48017549515, 51442.23358154297, 52861.82692527771, 52273.94659233093, 49674.19349861145, 54302.80000305176, 52999.573596954346, 54438.013690948486, 55109.36681365967, 49963.95334815979, 53166.21983909607, 52948.68019104004, 48490.619901657104, 53738.41343688965, 51699.37339115143, 46755.600118637085, 49084.7466135025, 54329.97350692749, 48794.01341056824, 49126.76009607315, 54825.533740997314, 53844.10681152344, 54062.16016960144, 51229.7269077301, 50685.99347496033, 58516.38008117676, 49079.5402469635, 52013.38015174866, 55721.62707519531, 52985.61338806152, 56434.23361968994, 48490.89344406128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.18469766718129, "mean_inference_ms": 6.404146033978097, "mean_action_processing_ms": 0.20290668990221447, "mean_env_wait_ms": 209.69685454099556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0707186758518219, "StateBufferConnector_ms": 0.04409775137901306, "ViewRequirementAgentConnector_ms": 0.24673864245414734}}, "episode_reward_max": 58516.38008117676, "episode_reward_min": 46755.600118637085, "episode_reward_mean": 52278.811807602644, "episode_len_mean": 135.25, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46755.600118637085}, "policy_reward_max": {"agent_0": 58516.38008117676}, "policy_reward_mean": {"agent_0": 52278.811807602644}, "hist_stats": {"episode_reward": [53832.48017549515, 51442.23358154297, 52861.82692527771, 52273.94659233093, 49674.19349861145, 54302.80000305176, 52999.573596954346, 54438.013690948486, 55109.36681365967, 49963.95334815979, 53166.21983909607, 52948.68019104004, 48490.619901657104, 53738.41343688965, 51699.37339115143, 46755.600118637085, 49084.7466135025, 54329.97350692749, 48794.01341056824, 49126.76009607315, 54825.533740997314, 53844.10681152344, 54062.16016960144, 51229.7269077301, 50685.99347496033, 58516.38008117676, 49079.5402469635, 52013.38015174866, 55721.62707519531, 52985.61338806152, 56434.23361968994, 48490.89344406128], "episode_lengths": [135, 135, 134, 136, 135, 135, 136, 135, 135, 136, 136, 135, 135, 134, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 134, 134, 135, 135], "policy_agent_0_reward": [53832.48017549515, 51442.23358154297, 52861.82692527771, 52273.94659233093, 49674.19349861145, 54302.80000305176, 52999.573596954346, 54438.013690948486, 55109.36681365967, 49963.95334815979, 53166.21983909607, 52948.68019104004, 48490.619901657104, 53738.41343688965, 51699.37339115143, 46755.600118637085, 49084.7466135025, 54329.97350692749, 48794.01341056824, 49126.76009607315, 54825.533740997314, 53844.10681152344, 54062.16016960144, 51229.7269077301, 50685.99347496033, 58516.38008117676, 49079.5402469635, 52013.38015174866, 55721.62707519531, 52985.61338806152, 56434.23361968994, 48490.89344406128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.18469766718129, "mean_inference_ms": 6.404146033978097, "mean_action_processing_ms": 0.20290668990221447, "mean_env_wait_ms": 209.69685454099556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0707186758518219, "StateBufferConnector_ms": 0.04409775137901306, "ViewRequirementAgentConnector_ms": 0.24673864245414734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.91450848215055, "num_env_steps_trained_throughput_per_sec": 216.91450848215055, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 16466.323, "sample_time_ms": 12251.884, "learn_time_ms": 4062.035, "learn_throughput": 984.728, "synch_weights_time_ms": 151.489}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 2016, "training_iteration": 71, "trial_id": "185f8_00000", "date": "2025-03-21_12-03-25", "timestamp": 1742558605, "time_this_iter_s": 18.508432149887085, "time_total_s": 1134.170783996582, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1134.170783996582, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.28846153846153, "ram_util_percent": 13.676923076923076}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986346244812012, "policy_loss": -0.015314072370529175, "vf_loss": 10.0, "vf_explained_var": -1.7310182442997757e-07, "kl": 0.008303294889628887, "entropy": 0.42689940333366394, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 48490.89344406128, "episode_reward_min": 48490.89344406128, "episode_reward_mean": 48490.89344406128, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48490.89344406128}, "policy_reward_max": {"agent_0": 48490.89344406128}, "policy_reward_mean": {"agent_0": 48490.89344406128}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48490.89344406128], "episode_lengths": [135], "policy_agent_0_reward": [48490.89344406128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.79944353380301, "mean_inference_ms": 6.3372002119904085, "mean_action_processing_ms": 0.1931227107910573, "mean_env_wait_ms": 209.13293286395154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03943443298339844, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16846656799316406}}, "episode_reward_max": 48490.89344406128, "episode_reward_min": 48490.89344406128, "episode_reward_mean": 48490.89344406128, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48490.89344406128}, "policy_reward_max": {"agent_0": 48490.89344406128}, "policy_reward_mean": {"agent_0": 48490.89344406128}, "hist_stats": {"episode_reward": [48490.89344406128], "episode_lengths": [135], "policy_agent_0_reward": [48490.89344406128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.79944353380301, "mean_inference_ms": 6.3372002119904085, "mean_action_processing_ms": 0.1931227107910573, "mean_env_wait_ms": 209.13293286395154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03943443298339844, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16846656799316406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.7828836205239, "num_env_steps_trained_throughput_per_sec": 290.7828836205239, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 16457.465, "sample_time_ms": 12178.029, "learn_time_ms": 4133.263, "learn_throughput": 967.758, "synch_weights_time_ms": 145.297}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 2016, "training_iteration": 72, "trial_id": "185f8_00000", "date": "2025-03-21_12-03-39", "timestamp": 1742558619, "time_this_iter_s": 13.808044910430908, "time_total_s": 1147.978828907013, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a216c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1147.978828907013, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 99.5421052631579, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.756795883178711, "policy_loss": -0.013290624134242535, "vf_loss": 9.7685546875, "vf_explained_var": 2.359350581571107e-08, "kl": 0.00765697006136179, "entropy": 0.41435015201568604, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 58609.58020019531, "episode_reward_min": 44715.273316025734, "episode_reward_mean": 51829.18142432363, "episode_len_mean": 135.2173913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44715.273316025734}, "policy_reward_max": {"agent_0": 58609.58020019531}, "policy_reward_mean": {"agent_0": 51829.18142432363}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47672.446641922, 49387.93358230591, 48059.52026414871, 49359.31341505051, 51833.33348655701, 53620.3135433197, 51628.020011901855, 44787.58683156967, 51504.086809158325, 49808.88684844971, 46723.15321016312, 48438.17350959778, 56544.006660461426, 51537.26700592041, 52200.01335847378, 53930.860092163086, 50555.30683135986, 54086.406677246094, 52498.5002117157, 57033.520389556885, 50872.94669342041, 51097.25342178345, 53413.706760406494, 52017.97347640991, 53373.98688316345, 56000.2600402832, 51501.706871032715, 49156.766845703125, 49040.0331287384, 49311.32664489746, 55201.89350128174, 52122.16675186157, 49114.17343330383, 53978.8533782959, 51523.426637649536, 55770.49328613281, 45973.680090904236, 56802.53352355957, 44987.239980220795, 52990.639949798584, 53549.85340118408, 52729.37361907959, 50534.35367393494, 51149.24687576294, 53402.25996208191, 53034.259855270386, 49745.00019311905, 53881.160329818726, 56807.50679016113, 56358.780265808105, 53621.30015563965, 52968.47345352173, 54430.97360610962, 52350.96007061005, 49928.92009353638, 53344.34677314758, 53793.340339660645, 47812.9600520134, 51626.15359687805, 51216.47997665405, 53850.37365722656, 54826.20677947998, 48090.39342498779, 47217.02000808716, 51918.393441438675, 47185.35347175598, 56059.27360153198, 53332.100049972534, 48816.24678039551, 51028.69339752197, 53371.69342803955, 49516.98028755188, 46382.42672610283, 55759.44700241089, 50879.686640024185, 51606.2268371582, 52095.89344406128, 51227.68009853363, 50197.74000263214, 54568.013359069824, 48809.76025772095, 50351.06670176983, 51420.92019081116, 54004.6800403595, 55367.62007141113, 58609.58020019531, 48876.18015289307, 54395.320167541504, 44715.273316025734, 55553.766777038574, 55369.78674316406, 55135.48021697998], "episode_lengths": [135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 135, 134, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [47672.446641922, 49387.93358230591, 48059.52026414871, 49359.31341505051, 51833.33348655701, 53620.3135433197, 51628.020011901855, 44787.58683156967, 51504.086809158325, 49808.88684844971, 46723.15321016312, 48438.17350959778, 56544.006660461426, 51537.26700592041, 52200.01335847378, 53930.860092163086, 50555.30683135986, 54086.406677246094, 52498.5002117157, 57033.520389556885, 50872.94669342041, 51097.25342178345, 53413.706760406494, 52017.97347640991, 53373.98688316345, 56000.2600402832, 51501.706871032715, 49156.766845703125, 49040.0331287384, 49311.32664489746, 55201.89350128174, 52122.16675186157, 49114.17343330383, 53978.8533782959, 51523.426637649536, 55770.49328613281, 45973.680090904236, 56802.53352355957, 44987.239980220795, 52990.639949798584, 53549.85340118408, 52729.37361907959, 50534.35367393494, 51149.24687576294, 53402.25996208191, 53034.259855270386, 49745.00019311905, 53881.160329818726, 56807.50679016113, 56358.780265808105, 53621.30015563965, 52968.47345352173, 54430.97360610962, 52350.96007061005, 49928.92009353638, 53344.34677314758, 53793.340339660645, 47812.9600520134, 51626.15359687805, 51216.47997665405, 53850.37365722656, 54826.20677947998, 48090.39342498779, 47217.02000808716, 51918.393441438675, 47185.35347175598, 56059.27360153198, 53332.100049972534, 48816.24678039551, 51028.69339752197, 53371.69342803955, 49516.98028755188, 46382.42672610283, 55759.44700241089, 50879.686640024185, 51606.2268371582, 52095.89344406128, 51227.68009853363, 50197.74000263214, 54568.013359069824, 48809.76025772095, 50351.06670176983, 51420.92019081116, 54004.6800403595, 55367.62007141113, 58609.58020019531, 48876.18015289307, 54395.320167541504, 44715.273316025734, 55553.766777038574, 55369.78674316406, 55135.48021697998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.304355412518156, "mean_inference_ms": 6.699069170918044, "mean_action_processing_ms": 0.20293720852898228, "mean_env_wait_ms": 226.87440760973845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05936829940132473, "StateBufferConnector_ms": 0.006295805392058, "ViewRequirementAgentConnector_ms": 0.309995464656664}}, "episode_reward_max": 58609.58020019531, "episode_reward_min": 44715.273316025734, "episode_reward_mean": 51829.18142432363, "episode_len_mean": 135.2173913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44715.273316025734}, "policy_reward_max": {"agent_0": 58609.58020019531}, "policy_reward_mean": {"agent_0": 51829.18142432363}, "hist_stats": {"episode_reward": [47672.446641922, 49387.93358230591, 48059.52026414871, 49359.31341505051, 51833.33348655701, 53620.3135433197, 51628.020011901855, 44787.58683156967, 51504.086809158325, 49808.88684844971, 46723.15321016312, 48438.17350959778, 56544.006660461426, 51537.26700592041, 52200.01335847378, 53930.860092163086, 50555.30683135986, 54086.406677246094, 52498.5002117157, 57033.520389556885, 50872.94669342041, 51097.25342178345, 53413.706760406494, 52017.97347640991, 53373.98688316345, 56000.2600402832, 51501.706871032715, 49156.766845703125, 49040.0331287384, 49311.32664489746, 55201.89350128174, 52122.16675186157, 49114.17343330383, 53978.8533782959, 51523.426637649536, 55770.49328613281, 45973.680090904236, 56802.53352355957, 44987.239980220795, 52990.639949798584, 53549.85340118408, 52729.37361907959, 50534.35367393494, 51149.24687576294, 53402.25996208191, 53034.259855270386, 49745.00019311905, 53881.160329818726, 56807.50679016113, 56358.780265808105, 53621.30015563965, 52968.47345352173, 54430.97360610962, 52350.96007061005, 49928.92009353638, 53344.34677314758, 53793.340339660645, 47812.9600520134, 51626.15359687805, 51216.47997665405, 53850.37365722656, 54826.20677947998, 48090.39342498779, 47217.02000808716, 51918.393441438675, 47185.35347175598, 56059.27360153198, 53332.100049972534, 48816.24678039551, 51028.69339752197, 53371.69342803955, 49516.98028755188, 46382.42672610283, 55759.44700241089, 50879.686640024185, 51606.2268371582, 52095.89344406128, 51227.68009853363, 50197.74000263214, 54568.013359069824, 48809.76025772095, 50351.06670176983, 51420.92019081116, 54004.6800403595, 55367.62007141113, 58609.58020019531, 48876.18015289307, 54395.320167541504, 44715.273316025734, 55553.766777038574, 55369.78674316406, 55135.48021697998], "episode_lengths": [135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 135, 134, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [47672.446641922, 49387.93358230591, 48059.52026414871, 49359.31341505051, 51833.33348655701, 53620.3135433197, 51628.020011901855, 44787.58683156967, 51504.086809158325, 49808.88684844971, 46723.15321016312, 48438.17350959778, 56544.006660461426, 51537.26700592041, 52200.01335847378, 53930.860092163086, 50555.30683135986, 54086.406677246094, 52498.5002117157, 57033.520389556885, 50872.94669342041, 51097.25342178345, 53413.706760406494, 52017.97347640991, 53373.98688316345, 56000.2600402832, 51501.706871032715, 49156.766845703125, 49040.0331287384, 49311.32664489746, 55201.89350128174, 52122.16675186157, 49114.17343330383, 53978.8533782959, 51523.426637649536, 55770.49328613281, 45973.680090904236, 56802.53352355957, 44987.239980220795, 52990.639949798584, 53549.85340118408, 52729.37361907959, 50534.35367393494, 51149.24687576294, 53402.25996208191, 53034.259855270386, 49745.00019311905, 53881.160329818726, 56807.50679016113, 56358.780265808105, 53621.30015563965, 52968.47345352173, 54430.97360610962, 52350.96007061005, 49928.92009353638, 53344.34677314758, 53793.340339660645, 47812.9600520134, 51626.15359687805, 51216.47997665405, 53850.37365722656, 54826.20677947998, 48090.39342498779, 47217.02000808716, 51918.393441438675, 47185.35347175598, 56059.27360153198, 53332.100049972534, 48816.24678039551, 51028.69339752197, 53371.69342803955, 49516.98028755188, 46382.42672610283, 55759.44700241089, 50879.686640024185, 51606.2268371582, 52095.89344406128, 51227.68009853363, 50197.74000263214, 54568.013359069824, 48809.76025772095, 50351.06670176983, 51420.92019081116, 54004.6800403595, 55367.62007141113, 58609.58020019531, 48876.18015289307, 54395.320167541504, 44715.273316025734, 55553.766777038574, 55369.78674316406, 55135.48021697998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.304355412518156, "mean_inference_ms": 6.699069170918044, "mean_action_processing_ms": 0.20293720852898228, "mean_env_wait_ms": 226.87440760973845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05936829940132473, "StateBufferConnector_ms": 0.006295805392058, "ViewRequirementAgentConnector_ms": 0.309995464656664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.03504698998017, "num_env_steps_trained_throughput_per_sec": 209.03504698998017, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 16592.773, "sample_time_ms": 12356.232, "learn_time_ms": 4083.106, "learn_throughput": 979.646, "synch_weights_time_ms": 152.59}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 2108, "training_iteration": 73, "trial_id": "185f8_00000", "date": "2025-03-21_12-03-58", "timestamp": 1742558638, "time_this_iter_s": 19.19161343574524, "time_total_s": 1167.1704423427582, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2626cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1167.1704423427582, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 93.80740740740741, "ram_util_percent": 13.65185185185185}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986454963684082, "policy_loss": -0.015106537379324436, "vf_loss": 10.0, "vf_explained_var": -2.481043281932216e-07, "kl": 0.007806228473782539, "entropy": 0.424953430891037, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 55135.48021697998, "episode_reward_min": 55135.48021697998, "episode_reward_mean": 55135.48021697998, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55135.48021697998}, "policy_reward_max": {"agent_0": 55135.48021697998}, "policy_reward_mean": {"agent_0": 55135.48021697998}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55135.48021697998], "episode_lengths": [135], "policy_agent_0_reward": [55135.48021697998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.884985074560305, "mean_inference_ms": 6.2662900182799905, "mean_action_processing_ms": 0.20666177526824128, "mean_env_wait_ms": 229.82901898417964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03750324249267578, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16617774963378906}}, "episode_reward_max": 55135.48021697998, "episode_reward_min": 55135.48021697998, "episode_reward_mean": 55135.48021697998, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55135.48021697998}, "policy_reward_max": {"agent_0": 55135.48021697998}, "policy_reward_mean": {"agent_0": 55135.48021697998}, "hist_stats": {"episode_reward": [55135.48021697998], "episode_lengths": [135], "policy_agent_0_reward": [55135.48021697998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.884985074560305, "mean_inference_ms": 6.2662900182799905, "mean_action_processing_ms": 0.20666177526824128, "mean_env_wait_ms": 229.82901898417964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03750324249267578, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16617774963378906}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.83349174101346, "num_env_steps_trained_throughput_per_sec": 274.83349174101346, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 16493.257, "sample_time_ms": 12155.068, "learn_time_ms": 4185.848, "learn_throughput": 955.601, "synch_weights_time_ms": 151.507}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 2108, "training_iteration": 74, "trial_id": "185f8_00000", "date": "2025-03-21_12-04-13", "timestamp": 1742558653, "time_this_iter_s": 14.621237516403198, "time_total_s": 1181.7916798591614, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1181.7916798591614, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.51904761904764, "ram_util_percent": 13.623809523809525}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91022777557373, "policy_loss": -0.00980724859982729, "vf_loss": 9.918701171875, "vf_explained_var": -3.458311326198782e-08, "kl": 0.00666216341778636, "entropy": 0.4264792203903198, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 57408.333671569824, "episode_reward_min": 47134.493472099304, "episode_reward_mean": 52151.115965113044, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47134.493472099304}, "policy_reward_max": {"agent_0": 57408.333671569824}, "policy_reward_mean": {"agent_0": 52151.115965113044}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52139.78681182861, 51696.35995674133, 52478.08023071289, 53250.62016296387, 50173.10665893555, 47134.493472099304, 54636.53997039795, 49990.12677133083, 52849.54694747925, 48475.22679901123, 55210.96678543091, 52885.566944122314, 53528.22663116455, 48495.17333328724, 50844.82670402527, 57408.333671569824, 51824.726883888245, 52185.72029495239, 48158.046840667725, 48891.08668041229, 55048.04682159424, 54449.27336502075, 54842.84023284912, 52799.600036621094, 54268.907011032104, 52238.606649398804, 52516.9866104126, 49384.500133514404, 55237.09381866455, 52474.613344192505, 50937.81341934204, 52380.86688995361], "episode_lengths": [134, 136, 135, 135, 136, 136, 135, 136, 136, 136, 136, 135, 136, 135, 136, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 137, 135], "policy_agent_0_reward": [52139.78681182861, 51696.35995674133, 52478.08023071289, 53250.62016296387, 50173.10665893555, 47134.493472099304, 54636.53997039795, 49990.12677133083, 52849.54694747925, 48475.22679901123, 55210.96678543091, 52885.566944122314, 53528.22663116455, 48495.17333328724, 50844.82670402527, 57408.333671569824, 51824.726883888245, 52185.72029495239, 48158.046840667725, 48891.08668041229, 55048.04682159424, 54449.27336502075, 54842.84023284912, 52799.600036621094, 54268.907011032104, 52238.606649398804, 52516.9866104126, 49384.500133514404, 55237.09381866455, 52474.613344192505, 50937.81341934204, 52380.86688995361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.6246299399409, "mean_inference_ms": 6.388326748748202, "mean_action_processing_ms": 0.2022712146908478, "mean_env_wait_ms": 209.1242815270081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06785616278648376, "StateBufferConnector_ms": 0.007101893424987793, "ViewRequirementAgentConnector_ms": 0.343235582113266}}, "episode_reward_max": 57408.333671569824, "episode_reward_min": 47134.493472099304, "episode_reward_mean": 52151.115965113044, "episode_len_mean": 135.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47134.493472099304}, "policy_reward_max": {"agent_0": 57408.333671569824}, "policy_reward_mean": {"agent_0": 52151.115965113044}, "hist_stats": {"episode_reward": [52139.78681182861, 51696.35995674133, 52478.08023071289, 53250.62016296387, 50173.10665893555, 47134.493472099304, 54636.53997039795, 49990.12677133083, 52849.54694747925, 48475.22679901123, 55210.96678543091, 52885.566944122314, 53528.22663116455, 48495.17333328724, 50844.82670402527, 57408.333671569824, 51824.726883888245, 52185.72029495239, 48158.046840667725, 48891.08668041229, 55048.04682159424, 54449.27336502075, 54842.84023284912, 52799.600036621094, 54268.907011032104, 52238.606649398804, 52516.9866104126, 49384.500133514404, 55237.09381866455, 52474.613344192505, 50937.81341934204, 52380.86688995361], "episode_lengths": [134, 136, 135, 135, 136, 136, 135, 136, 136, 136, 136, 135, 136, 135, 136, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 137, 135], "policy_agent_0_reward": [52139.78681182861, 51696.35995674133, 52478.08023071289, 53250.62016296387, 50173.10665893555, 47134.493472099304, 54636.53997039795, 49990.12677133083, 52849.54694747925, 48475.22679901123, 55210.96678543091, 52885.566944122314, 53528.22663116455, 48495.17333328724, 50844.82670402527, 57408.333671569824, 51824.726883888245, 52185.72029495239, 48158.046840667725, 48891.08668041229, 55048.04682159424, 54449.27336502075, 54842.84023284912, 52799.600036621094, 54268.907011032104, 52238.606649398804, 52516.9866104126, 49384.500133514404, 55237.09381866455, 52474.613344192505, 50937.81341934204, 52380.86688995361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.6246299399409, "mean_inference_ms": 6.388326748748202, "mean_action_processing_ms": 0.2022712146908478, "mean_env_wait_ms": 209.1242815270081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06785616278648376, "StateBufferConnector_ms": 0.007101893424987793, "ViewRequirementAgentConnector_ms": 0.343235582113266}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 225.5324534629379, "num_env_steps_trained_throughput_per_sec": 225.5324534629379, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 16502.593, "sample_time_ms": 12128.119, "learn_time_ms": 4225.148, "learn_throughput": 946.712, "synch_weights_time_ms": 148.46}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 2140, "training_iteration": 75, "trial_id": "185f8_00000", "date": "2025-03-21_12-04-31", "timestamp": 1742558671, "time_this_iter_s": 17.798076152801514, "time_total_s": 1199.589756011963, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1199.589756011963, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.34782608695654, "ram_util_percent": 13.678260869565213}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.992390632629395, "policy_loss": -0.00903343502432108, "vf_loss": 10.0, "vf_explained_var": 4.7745803755105953e-08, "kl": 0.007123569026589394, "entropy": 0.3722084164619446, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 52380.86688995361, "episode_reward_min": 52380.86688995361, "episode_reward_mean": 52380.86688995361, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52380.86688995361}, "policy_reward_max": {"agent_0": 52380.86688995361}, "policy_reward_mean": {"agent_0": 52380.86688995361}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52380.86688995361], "episode_lengths": [135], "policy_agent_0_reward": [52380.86688995361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.07539275620788, "mean_inference_ms": 6.331258424842107, "mean_action_processing_ms": 0.19273407432297318, "mean_env_wait_ms": 209.5300118064264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048089027404785156, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.16248226165771484}}, "episode_reward_max": 52380.86688995361, "episode_reward_min": 52380.86688995361, "episode_reward_mean": 52380.86688995361, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52380.86688995361}, "policy_reward_max": {"agent_0": 52380.86688995361}, "policy_reward_mean": {"agent_0": 52380.86688995361}, "hist_stats": {"episode_reward": [52380.86688995361], "episode_lengths": [135], "policy_agent_0_reward": [52380.86688995361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.07539275620788, "mean_inference_ms": 6.331258424842107, "mean_action_processing_ms": 0.19273407432297318, "mean_env_wait_ms": 209.5300118064264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048089027404785156, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.16248226165771484}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.7972524186841, "num_env_steps_trained_throughput_per_sec": 279.7972524186841, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 16512.848, "sample_time_ms": 12099.582, "learn_time_ms": 4262.071, "learn_throughput": 938.511, "synch_weights_time_ms": 150.371}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 2140, "training_iteration": 76, "trial_id": "185f8_00000", "date": "2025-03-21_12-04-45", "timestamp": 1742558685, "time_this_iter_s": 14.35753607749939, "time_total_s": 1213.9472920894623, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1213.9472920894623, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 99.51, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.757627487182617, "policy_loss": -0.01460239663720131, "vf_loss": 9.770263671875, "vf_explained_var": -3.743916821008497e-08, "kl": 0.009828831069171429, "entropy": 0.42643627524375916, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 57986.57356262207, "episode_reward_min": 40339.07346916199, "episode_reward_mean": 52594.623746267804, "episode_len_mean": 135.17391304347825, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 40339.07346916199}, "policy_reward_max": {"agent_0": 57986.57356262207}, "policy_reward_mean": {"agent_0": 52594.623746267804}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51952.726742744446, 54943.53342819214, 57110.753702163696, 50417.693432986736, 54743.13320732117, 48431.38669204712, 50279.513414382935, 52641.433418273926, 50611.52678108215, 50455.453528404236, 54900.45359802246, 40339.07346916199, 53300.366934776306, 50173.100145339966, 52004.06021595001, 53407.08696746826, 53166.48661804199, 54207.78006744385, 54050.340270996094, 54021.14027786255, 52113.666648864746, 50241.32012939453, 56075.15350341797, 56664.486724853516, 54423.05995178223, 54457.013483047485, 53104.87351036072, 54545.34673213959, 54076.72673034668, 55157.2201499939, 48644.973368644714, 51590.626954078674, 54576.02024078369, 43954.18008995056, 46239.22675767541, 55391.14697265625, 55240.57326507568, 51085.239866256714, 50564.70679092407, 53082.73335266113, 55565.973320007324, 51129.933670043945, 52302.21979522705, 49029.513504981995, 50184.00690698624, 52647.14682388306, 53714.45976638794, 50422.16012573242, 48703.56004905701, 55480.78673553467, 53904.72029876709, 54180.02682495117, 56143.50016784668, 55340.2200012207, 49961.32028758526, 57986.57356262207, 53468.52018356323, 55341.16018676758, 54932.273418426514, 53321.08003616333, 55393.020334243774, 53096.72020339966, 53921.42014503479, 53382.94007587433, 51406.32668685913, 51256.18000125885, 51478.586654663086, 48348.64023399353, 53995.02013206482, 50279.666831970215, 53647.60029602051, 53076.200019836426, 51532.42670440674, 52780.47353363037, 53122.226791381836, 52655.5336356163, 49942.40702056885, 49179.486669540405, 54502.22684288025, 52625.43348121643, 50375.560092926025, 56005.15353393555, 50810.44680786133, 52521.82013130188, 53305.38677215576, 50509.00038719177, 57433.040100097656, 54360.38659286499, 52122.00654220581, 54693.393478393555, 51010.066608428955, 53792.09351348877], "episode_lengths": [135, 135, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 135, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 136, 134, 134, 136, 135, 135, 135, 134], "policy_agent_0_reward": [51952.726742744446, 54943.53342819214, 57110.753702163696, 50417.693432986736, 54743.13320732117, 48431.38669204712, 50279.513414382935, 52641.433418273926, 50611.52678108215, 50455.453528404236, 54900.45359802246, 40339.07346916199, 53300.366934776306, 50173.100145339966, 52004.06021595001, 53407.08696746826, 53166.48661804199, 54207.78006744385, 54050.340270996094, 54021.14027786255, 52113.666648864746, 50241.32012939453, 56075.15350341797, 56664.486724853516, 54423.05995178223, 54457.013483047485, 53104.87351036072, 54545.34673213959, 54076.72673034668, 55157.2201499939, 48644.973368644714, 51590.626954078674, 54576.02024078369, 43954.18008995056, 46239.22675767541, 55391.14697265625, 55240.57326507568, 51085.239866256714, 50564.70679092407, 53082.73335266113, 55565.973320007324, 51129.933670043945, 52302.21979522705, 49029.513504981995, 50184.00690698624, 52647.14682388306, 53714.45976638794, 50422.16012573242, 48703.56004905701, 55480.78673553467, 53904.72029876709, 54180.02682495117, 56143.50016784668, 55340.2200012207, 49961.32028758526, 57986.57356262207, 53468.52018356323, 55341.16018676758, 54932.273418426514, 53321.08003616333, 55393.020334243774, 53096.72020339966, 53921.42014503479, 53382.94007587433, 51406.32668685913, 51256.18000125885, 51478.586654663086, 48348.64023399353, 53995.02013206482, 50279.666831970215, 53647.60029602051, 53076.200019836426, 51532.42670440674, 52780.47353363037, 53122.226791381836, 52655.5336356163, 49942.40702056885, 49179.486669540405, 54502.22684288025, 52625.43348121643, 50375.560092926025, 56005.15353393555, 50810.44680786133, 52521.82013130188, 53305.38677215576, 50509.00038719177, 57433.040100097656, 54360.38659286499, 52122.00654220581, 54693.393478393555, 51010.066608428955, 53792.09351348877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.210348647615774, "mean_inference_ms": 6.7062535407061885, "mean_action_processing_ms": 0.20285472004425592, "mean_env_wait_ms": 227.07350154393606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667268815247909, "StateBufferConnector_ms": 0.009681608365929645, "ViewRequirementAgentConnector_ms": 0.24719575177068295}}, "episode_reward_max": 57986.57356262207, "episode_reward_min": 40339.07346916199, "episode_reward_mean": 52594.623746267804, "episode_len_mean": 135.17391304347825, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 40339.07346916199}, "policy_reward_max": {"agent_0": 57986.57356262207}, "policy_reward_mean": {"agent_0": 52594.623746267804}, "hist_stats": {"episode_reward": [51952.726742744446, 54943.53342819214, 57110.753702163696, 50417.693432986736, 54743.13320732117, 48431.38669204712, 50279.513414382935, 52641.433418273926, 50611.52678108215, 50455.453528404236, 54900.45359802246, 40339.07346916199, 53300.366934776306, 50173.100145339966, 52004.06021595001, 53407.08696746826, 53166.48661804199, 54207.78006744385, 54050.340270996094, 54021.14027786255, 52113.666648864746, 50241.32012939453, 56075.15350341797, 56664.486724853516, 54423.05995178223, 54457.013483047485, 53104.87351036072, 54545.34673213959, 54076.72673034668, 55157.2201499939, 48644.973368644714, 51590.626954078674, 54576.02024078369, 43954.18008995056, 46239.22675767541, 55391.14697265625, 55240.57326507568, 51085.239866256714, 50564.70679092407, 53082.73335266113, 55565.973320007324, 51129.933670043945, 52302.21979522705, 49029.513504981995, 50184.00690698624, 52647.14682388306, 53714.45976638794, 50422.16012573242, 48703.56004905701, 55480.78673553467, 53904.72029876709, 54180.02682495117, 56143.50016784668, 55340.2200012207, 49961.32028758526, 57986.57356262207, 53468.52018356323, 55341.16018676758, 54932.273418426514, 53321.08003616333, 55393.020334243774, 53096.72020339966, 53921.42014503479, 53382.94007587433, 51406.32668685913, 51256.18000125885, 51478.586654663086, 48348.64023399353, 53995.02013206482, 50279.666831970215, 53647.60029602051, 53076.200019836426, 51532.42670440674, 52780.47353363037, 53122.226791381836, 52655.5336356163, 49942.40702056885, 49179.486669540405, 54502.22684288025, 52625.43348121643, 50375.560092926025, 56005.15353393555, 50810.44680786133, 52521.82013130188, 53305.38677215576, 50509.00038719177, 57433.040100097656, 54360.38659286499, 52122.00654220581, 54693.393478393555, 51010.066608428955, 53792.09351348877], "episode_lengths": [135, 135, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 135, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 136, 134, 134, 136, 135, 135, 135, 134], "policy_agent_0_reward": [51952.726742744446, 54943.53342819214, 57110.753702163696, 50417.693432986736, 54743.13320732117, 48431.38669204712, 50279.513414382935, 52641.433418273926, 50611.52678108215, 50455.453528404236, 54900.45359802246, 40339.07346916199, 53300.366934776306, 50173.100145339966, 52004.06021595001, 53407.08696746826, 53166.48661804199, 54207.78006744385, 54050.340270996094, 54021.14027786255, 52113.666648864746, 50241.32012939453, 56075.15350341797, 56664.486724853516, 54423.05995178223, 54457.013483047485, 53104.87351036072, 54545.34673213959, 54076.72673034668, 55157.2201499939, 48644.973368644714, 51590.626954078674, 54576.02024078369, 43954.18008995056, 46239.22675767541, 55391.14697265625, 55240.57326507568, 51085.239866256714, 50564.70679092407, 53082.73335266113, 55565.973320007324, 51129.933670043945, 52302.21979522705, 49029.513504981995, 50184.00690698624, 52647.14682388306, 53714.45976638794, 50422.16012573242, 48703.56004905701, 55480.78673553467, 53904.72029876709, 54180.02682495117, 56143.50016784668, 55340.2200012207, 49961.32028758526, 57986.57356262207, 53468.52018356323, 55341.16018676758, 54932.273418426514, 53321.08003616333, 55393.020334243774, 53096.72020339966, 53921.42014503479, 53382.94007587433, 51406.32668685913, 51256.18000125885, 51478.586654663086, 48348.64023399353, 53995.02013206482, 50279.666831970215, 53647.60029602051, 53076.200019836426, 51532.42670440674, 52780.47353363037, 53122.226791381836, 52655.5336356163, 49942.40702056885, 49179.486669540405, 54502.22684288025, 52625.43348121643, 50375.560092926025, 56005.15353393555, 50810.44680786133, 52521.82013130188, 53305.38677215576, 50509.00038719177, 57433.040100097656, 54360.38659286499, 52122.00654220581, 54693.393478393555, 51010.066608428955, 53792.09351348877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.210348647615774, "mean_inference_ms": 6.7062535407061885, "mean_action_processing_ms": 0.20285472004425592, "mean_env_wait_ms": 227.07350154393606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667268815247909, "StateBufferConnector_ms": 0.009681608365929645, "ViewRequirementAgentConnector_ms": 0.24719575177068295}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.86794725403948, "num_env_steps_trained_throughput_per_sec": 212.86794725403948, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 16502.638, "sample_time_ms": 12114.693, "learn_time_ms": 4236.444, "learn_throughput": 944.188, "synch_weights_time_ms": 150.611}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 2232, "training_iteration": 77, "trial_id": "185f8_00000", "date": "2025-03-21_12-05-04", "timestamp": 1742558704, "time_this_iter_s": 18.842388153076172, "time_total_s": 1232.7896802425385, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2627520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1232.7896802425385, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 95.15925925925929, "ram_util_percent": 13.677777777777775}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98729133605957, "policy_loss": -0.014472919516265392, "vf_loss": 10.0, "vf_explained_var": 2.8870999813079834e-08, "kl": 0.008822510950267315, "entropy": 0.45201376080513, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 53792.09351348877, "episode_reward_min": 53792.09351348877, "episode_reward_mean": 53792.09351348877, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53792.09351348877}, "policy_reward_max": {"agent_0": 53792.09351348877}, "policy_reward_mean": {"agent_0": 53792.09351348877}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53792.09351348877], "episode_lengths": [134], "policy_agent_0_reward": [53792.09351348877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.57376270797141, "mean_inference_ms": 6.239326391935832, "mean_action_processing_ms": 0.206180421624174, "mean_env_wait_ms": 231.07320270963905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.006103515625, "ViewRequirementAgentConnector_ms": 0.1709461212158203}}, "episode_reward_max": 53792.09351348877, "episode_reward_min": 53792.09351348877, "episode_reward_mean": 53792.09351348877, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53792.09351348877}, "policy_reward_max": {"agent_0": 53792.09351348877}, "policy_reward_mean": {"agent_0": 53792.09351348877}, "hist_stats": {"episode_reward": [53792.09351348877], "episode_lengths": [134], "policy_agent_0_reward": [53792.09351348877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.57376270797141, "mean_inference_ms": 6.239326391935832, "mean_action_processing_ms": 0.206180421624174, "mean_env_wait_ms": 231.07320270963905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.006103515625, "ViewRequirementAgentConnector_ms": 0.1709461212158203}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.2058140461684, "num_env_steps_trained_throughput_per_sec": 275.2058140461684, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 16607.309, "sample_time_ms": 12159.398, "learn_time_ms": 4293.532, "learn_throughput": 931.634, "synch_weights_time_ms": 153.373}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 2232, "training_iteration": 78, "trial_id": "185f8_00000", "date": "2025-03-21_12-05-19", "timestamp": 1742558719, "time_this_iter_s": 14.584527492523193, "time_total_s": 1247.3742077350616, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1247.3742077350616, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.42380952380952, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.90954875946045, "policy_loss": -0.013001958839595318, "vf_loss": 9.9208984375, "vf_explained_var": -1.0617077350616455e-07, "kl": 0.00826453696936369, "entropy": 0.483834832906723, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 57117.97333526611, "episode_reward_min": 45935.63331413269, "episode_reward_mean": 51790.676770821214, "episode_len_mean": 135.25, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45935.63331413269}, "policy_reward_max": {"agent_0": 57117.97333526611}, "policy_reward_mean": {"agent_0": 51790.676770821214}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53090.799964904785, 49225.79329299927, 46174.9467356205, 57117.97333526611, 53163.21998977661, 49462.22011470795, 52822.69367027283, 52297.13345146179, 55143.66015434265, 53311.98673248291, 45935.63331413269, 50927.600069999695, 47371.51343917847, 52825.787075042725, 49755.580079078674, 48974.54669690132, 50758.580169677734, 53934.97989654541, 53542.96007537842, 54144.79345703125, 54147.107051849365, 55172.12007522583, 49225.8868970871, 52613.96691131592, 52931.28002166748, 55734.96664428711, 48292.73994636536, 51394.71363258362, 51425.17989253998, 49832.14032173157, 54343.88682556152, 52205.26673126221], "episode_lengths": [136, 135, 136, 134, 136, 136, 134, 135, 135, 135, 136, 135, 136, 135, 137, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 134, 135], "policy_agent_0_reward": [53090.799964904785, 49225.79329299927, 46174.9467356205, 57117.97333526611, 53163.21998977661, 49462.22011470795, 52822.69367027283, 52297.13345146179, 55143.66015434265, 53311.98673248291, 45935.63331413269, 50927.600069999695, 47371.51343917847, 52825.787075042725, 49755.580079078674, 48974.54669690132, 50758.580169677734, 53934.97989654541, 53542.96007537842, 54144.79345703125, 54147.107051849365, 55172.12007522583, 49225.8868970871, 52613.96691131592, 52931.28002166748, 55734.96664428711, 48292.73994636536, 51394.71363258362, 51425.17989253998, 49832.14032173157, 54343.88682556152, 52205.26673126221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.227415901088825, "mean_inference_ms": 6.388754292499799, "mean_action_processing_ms": 0.20241083154466255, "mean_env_wait_ms": 208.95998587580453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09420886635780334, "StateBufferConnector_ms": 0.006746500730514526, "ViewRequirementAgentConnector_ms": 0.34617483615875244}}, "episode_reward_max": 57117.97333526611, "episode_reward_min": 45935.63331413269, "episode_reward_mean": 51790.676770821214, "episode_len_mean": 135.25, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45935.63331413269}, "policy_reward_max": {"agent_0": 57117.97333526611}, "policy_reward_mean": {"agent_0": 51790.676770821214}, "hist_stats": {"episode_reward": [53090.799964904785, 49225.79329299927, 46174.9467356205, 57117.97333526611, 53163.21998977661, 49462.22011470795, 52822.69367027283, 52297.13345146179, 55143.66015434265, 53311.98673248291, 45935.63331413269, 50927.600069999695, 47371.51343917847, 52825.787075042725, 49755.580079078674, 48974.54669690132, 50758.580169677734, 53934.97989654541, 53542.96007537842, 54144.79345703125, 54147.107051849365, 55172.12007522583, 49225.8868970871, 52613.96691131592, 52931.28002166748, 55734.96664428711, 48292.73994636536, 51394.71363258362, 51425.17989253998, 49832.14032173157, 54343.88682556152, 52205.26673126221], "episode_lengths": [136, 135, 136, 134, 136, 136, 134, 135, 135, 135, 136, 135, 136, 135, 137, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 134, 135], "policy_agent_0_reward": [53090.799964904785, 49225.79329299927, 46174.9467356205, 57117.97333526611, 53163.21998977661, 49462.22011470795, 52822.69367027283, 52297.13345146179, 55143.66015434265, 53311.98673248291, 45935.63331413269, 50927.600069999695, 47371.51343917847, 52825.787075042725, 49755.580079078674, 48974.54669690132, 50758.580169677734, 53934.97989654541, 53542.96007537842, 54144.79345703125, 54147.107051849365, 55172.12007522583, 49225.8868970871, 52613.96691131592, 52931.28002166748, 55734.96664428711, 48292.73994636536, 51394.71363258362, 51425.17989253998, 49832.14032173157, 54343.88682556152, 52205.26673126221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.227415901088825, "mean_inference_ms": 6.388754292499799, "mean_action_processing_ms": 0.20241083154466255, "mean_env_wait_ms": 208.95998587580453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09420886635780334, "StateBufferConnector_ms": 0.006746500730514526, "ViewRequirementAgentConnector_ms": 0.34617483615875244}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.34729101553947, "num_env_steps_trained_throughput_per_sec": 238.34729101553947, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 16244.031, "sample_time_ms": 11823.148, "learn_time_ms": 4260.77, "learn_throughput": 938.797, "synch_weights_time_ms": 159.076}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 2264, "training_iteration": 79, "trial_id": "185f8_00000", "date": "2025-03-21_12-05-36", "timestamp": 1742558736, "time_this_iter_s": 16.839970111846924, "time_total_s": 1264.2141778469086, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a216c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1264.2141778469086, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.3695652173913, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987162590026855, "policy_loss": -0.014599504880607128, "vf_loss": 10.0, "vf_explained_var": 1.6950071568544445e-08, "kl": 0.008810633793473244, "entropy": 0.4892555773258209, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 52205.26673126221, "episode_reward_min": 52205.26673126221, "episode_reward_mean": 52205.26673126221, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52205.26673126221}, "policy_reward_max": {"agent_0": 52205.26673126221}, "policy_reward_mean": {"agent_0": 52205.26673126221}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52205.26673126221], "episode_lengths": [135], "policy_agent_0_reward": [52205.26673126221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.01048543921278, "mean_inference_ms": 6.322591491272113, "mean_action_processing_ms": 0.19324575465149674, "mean_env_wait_ms": 210.32987105334465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898143768310547, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.16617774963378906}}, "episode_reward_max": 52205.26673126221, "episode_reward_min": 52205.26673126221, "episode_reward_mean": 52205.26673126221, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52205.26673126221}, "policy_reward_max": {"agent_0": 52205.26673126221}, "policy_reward_mean": {"agent_0": 52205.26673126221}, "hist_stats": {"episode_reward": [52205.26673126221], "episode_lengths": [135], "policy_agent_0_reward": [52205.26673126221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.01048543921278, "mean_inference_ms": 6.322591491272113, "mean_action_processing_ms": 0.19324575465149674, "mean_env_wait_ms": 210.32987105334465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03898143768310547, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.16617774963378906}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.23623860524896, "num_env_steps_trained_throughput_per_sec": 291.23623860524896, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 16175.975, "sample_time_ms": 11739.106, "learn_time_ms": 4276.004, "learn_throughput": 935.453, "synch_weights_time_ms": 159.839}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 2264, "training_iteration": 80, "trial_id": "185f8_00000", "date": "2025-03-21_12-05-50", "timestamp": 1742558750, "time_this_iter_s": 13.775965213775635, "time_total_s": 1277.9901430606842, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26265f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1277.9901430606842, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.53157894736842, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.761025428771973, "policy_loss": -0.014747360721230507, "vf_loss": 9.774169921875, "vf_explained_var": -2.135833021554845e-08, "kl": 0.008004467003047466, "entropy": 0.4220798909664154, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 57063.680671691895, "episode_reward_min": 46721.44676780701, "episode_reward_mean": 51901.018336100526, "episode_len_mean": 135.51685393258427, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 46721.44676780701}, "policy_reward_max": {"agent_0": 57063.680671691895}, "policy_reward_mean": {"agent_0": 51901.018336100526}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54113.31354522705, 53767.29348373413, 49689.95986175537, 52454.766704559326, 48149.70010852814, 52255.67339515686, 51305.65351295471, 47396.806785583496, 48126.70689892769, 54477.313819885254, 53552.3335609436, 52192.38026237488, 48943.133487701416, 53085.513553619385, 55457.440338134766, 52439.93991470337, 52840.466857910156, 53537.380237579346, 47224.24669837952, 51905.31344985962, 56778.086559295654, 50131.33999347687, 53862.326709747314, 50298.88011741638, 56086.8602104187, 49241.72010421753, 52432.806800842285, 52529.10665130615, 54714.16028833389, 49453.873388290405, 51784.89348220825, 52684.953285217285, 47045.046654224396, 55143.193588256836, 52347.073387145996, 52436.33347320557, 52039.78004360199, 47665.2866230011, 52369.193490982056, 52367.96689224243, 53829.8865814209, 49995.793226242065, 54301.933532714844, 53070.926834106445, 55609.406883239746, 48070.90029120445, 52188.846519470215, 51684.01345062256, 46721.44676780701, 51991.406982421875, 55525.32696914673, 52226.62668609619, 52938.34016799927, 50366.37338638306, 53340.2201423645, 49357.353258132935, 56167.23338317871, 54120.30687713623, 49390.55336380005, 49515.4469397068, 48739.82010269165, 51166.526891708374, 54416.22026824951, 52521.55347061157, 55329.10023498535, 49849.686655044556, 53038.3203830719, 53434.600028038025, 50454.566774368286, 54396.000244140625, 54571.57349586487, 51985.5869102478, 50270.846797943115, 50179.1134223938, 47006.880291461945, 49380.10015296936, 52434.766830444336, 48926.66682243347, 49736.20008850098, 48969.92679595947, 52997.1067199707, 52206.86666107178, 55314.61340332031, 53158.400146484375, 52705.32025241852, 57063.680671691895, 46883.30010128021, 53340.89978790283, 53971.827043533325], "episode_lengths": [135, 136, 136, 137, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 137, 136, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 136, 136, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 136, 134, 135, 136, 135, 135, 136, 136, 136, 136, 137, 136, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135], "policy_agent_0_reward": [54113.31354522705, 53767.29348373413, 49689.95986175537, 52454.766704559326, 48149.70010852814, 52255.67339515686, 51305.65351295471, 47396.806785583496, 48126.70689892769, 54477.313819885254, 53552.3335609436, 52192.38026237488, 48943.133487701416, 53085.513553619385, 55457.440338134766, 52439.93991470337, 52840.466857910156, 53537.380237579346, 47224.24669837952, 51905.31344985962, 56778.086559295654, 50131.33999347687, 53862.326709747314, 50298.88011741638, 56086.8602104187, 49241.72010421753, 52432.806800842285, 52529.10665130615, 54714.16028833389, 49453.873388290405, 51784.89348220825, 52684.953285217285, 47045.046654224396, 55143.193588256836, 52347.073387145996, 52436.33347320557, 52039.78004360199, 47665.2866230011, 52369.193490982056, 52367.96689224243, 53829.8865814209, 49995.793226242065, 54301.933532714844, 53070.926834106445, 55609.406883239746, 48070.90029120445, 52188.846519470215, 51684.01345062256, 46721.44676780701, 51991.406982421875, 55525.32696914673, 52226.62668609619, 52938.34016799927, 50366.37338638306, 53340.2201423645, 49357.353258132935, 56167.23338317871, 54120.30687713623, 49390.55336380005, 49515.4469397068, 48739.82010269165, 51166.526891708374, 54416.22026824951, 52521.55347061157, 55329.10023498535, 49849.686655044556, 53038.3203830719, 53434.600028038025, 50454.566774368286, 54396.000244140625, 54571.57349586487, 51985.5869102478, 50270.846797943115, 50179.1134223938, 47006.880291461945, 49380.10015296936, 52434.766830444336, 48926.66682243347, 49736.20008850098, 48969.92679595947, 52997.1067199707, 52206.86666107178, 55314.61340332031, 53158.400146484375, 52705.32025241852, 57063.680671691895, 46883.30010128021, 53340.89978790283, 53971.827043533325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.73674867416993, "mean_inference_ms": 6.705380211535507, "mean_action_processing_ms": 0.20280982619503415, "mean_env_wait_ms": 227.18573049967793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0740153066227945, "StateBufferConnector_ms": 0.005948945377649886, "ViewRequirementAgentConnector_ms": 0.19505372208155944}}, "episode_reward_max": 57063.680671691895, "episode_reward_min": 46721.44676780701, "episode_reward_mean": 51901.018336100526, "episode_len_mean": 135.51685393258427, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 46721.44676780701}, "policy_reward_max": {"agent_0": 57063.680671691895}, "policy_reward_mean": {"agent_0": 51901.018336100526}, "hist_stats": {"episode_reward": [54113.31354522705, 53767.29348373413, 49689.95986175537, 52454.766704559326, 48149.70010852814, 52255.67339515686, 51305.65351295471, 47396.806785583496, 48126.70689892769, 54477.313819885254, 53552.3335609436, 52192.38026237488, 48943.133487701416, 53085.513553619385, 55457.440338134766, 52439.93991470337, 52840.466857910156, 53537.380237579346, 47224.24669837952, 51905.31344985962, 56778.086559295654, 50131.33999347687, 53862.326709747314, 50298.88011741638, 56086.8602104187, 49241.72010421753, 52432.806800842285, 52529.10665130615, 54714.16028833389, 49453.873388290405, 51784.89348220825, 52684.953285217285, 47045.046654224396, 55143.193588256836, 52347.073387145996, 52436.33347320557, 52039.78004360199, 47665.2866230011, 52369.193490982056, 52367.96689224243, 53829.8865814209, 49995.793226242065, 54301.933532714844, 53070.926834106445, 55609.406883239746, 48070.90029120445, 52188.846519470215, 51684.01345062256, 46721.44676780701, 51991.406982421875, 55525.32696914673, 52226.62668609619, 52938.34016799927, 50366.37338638306, 53340.2201423645, 49357.353258132935, 56167.23338317871, 54120.30687713623, 49390.55336380005, 49515.4469397068, 48739.82010269165, 51166.526891708374, 54416.22026824951, 52521.55347061157, 55329.10023498535, 49849.686655044556, 53038.3203830719, 53434.600028038025, 50454.566774368286, 54396.000244140625, 54571.57349586487, 51985.5869102478, 50270.846797943115, 50179.1134223938, 47006.880291461945, 49380.10015296936, 52434.766830444336, 48926.66682243347, 49736.20008850098, 48969.92679595947, 52997.1067199707, 52206.86666107178, 55314.61340332031, 53158.400146484375, 52705.32025241852, 57063.680671691895, 46883.30010128021, 53340.89978790283, 53971.827043533325], "episode_lengths": [135, 136, 136, 137, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 137, 136, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 136, 136, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 136, 134, 135, 136, 135, 135, 136, 136, 136, 136, 137, 136, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135], "policy_agent_0_reward": [54113.31354522705, 53767.29348373413, 49689.95986175537, 52454.766704559326, 48149.70010852814, 52255.67339515686, 51305.65351295471, 47396.806785583496, 48126.70689892769, 54477.313819885254, 53552.3335609436, 52192.38026237488, 48943.133487701416, 53085.513553619385, 55457.440338134766, 52439.93991470337, 52840.466857910156, 53537.380237579346, 47224.24669837952, 51905.31344985962, 56778.086559295654, 50131.33999347687, 53862.326709747314, 50298.88011741638, 56086.8602104187, 49241.72010421753, 52432.806800842285, 52529.10665130615, 54714.16028833389, 49453.873388290405, 51784.89348220825, 52684.953285217285, 47045.046654224396, 55143.193588256836, 52347.073387145996, 52436.33347320557, 52039.78004360199, 47665.2866230011, 52369.193490982056, 52367.96689224243, 53829.8865814209, 49995.793226242065, 54301.933532714844, 53070.926834106445, 55609.406883239746, 48070.90029120445, 52188.846519470215, 51684.01345062256, 46721.44676780701, 51991.406982421875, 55525.32696914673, 52226.62668609619, 52938.34016799927, 50366.37338638306, 53340.2201423645, 49357.353258132935, 56167.23338317871, 54120.30687713623, 49390.55336380005, 49515.4469397068, 48739.82010269165, 51166.526891708374, 54416.22026824951, 52521.55347061157, 55329.10023498535, 49849.686655044556, 53038.3203830719, 53434.600028038025, 50454.566774368286, 54396.000244140625, 54571.57349586487, 51985.5869102478, 50270.846797943115, 50179.1134223938, 47006.880291461945, 49380.10015296936, 52434.766830444336, 48926.66682243347, 49736.20008850098, 48969.92679595947, 52997.1067199707, 52206.86666107178, 55314.61340332031, 53158.400146484375, 52705.32025241852, 57063.680671691895, 46883.30010128021, 53340.89978790283, 53971.827043533325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.73674867416993, "mean_inference_ms": 6.705380211535507, "mean_action_processing_ms": 0.20280982619503415, "mean_env_wait_ms": 227.18573049967793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0740153066227945, "StateBufferConnector_ms": 0.005948945377649886, "ViewRequirementAgentConnector_ms": 0.19505372208155944}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.72918534099415, "num_env_steps_trained_throughput_per_sec": 217.72918534099415, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 16169.076, "sample_time_ms": 11689.629, "learn_time_ms": 4317.429, "learn_throughput": 926.477, "synch_weights_time_ms": 160.973}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 2353, "training_iteration": 81, "trial_id": "185f8_00000", "date": "2025-03-21_12-06-08", "timestamp": 1742558768, "time_this_iter_s": 18.426329851150513, "time_total_s": 1296.4164729118347, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1296.4164729118347, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 94.50000000000001, "ram_util_percent": 13.688461538461537}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983044624328613, "policy_loss": -0.010557363741099834, "vf_loss": 9.9921875, "vf_explained_var": -1.434857637150344e-07, "kl": 0.007074011955410242, "entropy": 0.4499928653240204, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 53384.580112457275, "episode_reward_min": 48730.3734036684, "episode_reward_mean": 51588.73119930426, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 48730.3734036684}, "policy_reward_max": {"agent_0": 53384.580112457275}, "policy_reward_mean": {"agent_0": 51588.73119930426}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48730.3734036684, 53384.580112457275, 52651.24008178711], "episode_lengths": [136, 137, 135], "policy_agent_0_reward": [48730.3734036684, 53384.580112457275, 52651.24008178711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.085063873775425, "mean_inference_ms": 6.831959890940833, "mean_action_processing_ms": 0.2005325196281312, "mean_env_wait_ms": 226.46576312231636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04511674245198568, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.4110495249430339}}, "episode_reward_max": 53384.580112457275, "episode_reward_min": 48730.3734036684, "episode_reward_mean": 51588.73119930426, "episode_len_mean": 136.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 48730.3734036684}, "policy_reward_max": {"agent_0": 53384.580112457275}, "policy_reward_mean": {"agent_0": 51588.73119930426}, "hist_stats": {"episode_reward": [48730.3734036684, 53384.580112457275, 52651.24008178711], "episode_lengths": [136, 137, 135], "policy_agent_0_reward": [48730.3734036684, 53384.580112457275, 52651.24008178711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.085063873775425, "mean_inference_ms": 6.831959890940833, "mean_action_processing_ms": 0.2005325196281312, "mean_env_wait_ms": 226.46576312231636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04511674245198568, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.4110495249430339}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.760580852472, "num_env_steps_trained_throughput_per_sec": 274.760580852472, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 16249.289, "sample_time_ms": 11775.654, "learn_time_ms": 4309.254, "learn_throughput": 928.235, "synch_weights_time_ms": 163.278}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 2356, "training_iteration": 82, "trial_id": "185f8_00000", "date": "2025-03-21_12-06-23", "timestamp": 1742558783, "time_this_iter_s": 14.613011598587036, "time_total_s": 1311.0294845104218, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1311.0294845104218, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.41428571428573, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.911547660827637, "policy_loss": -0.00902299303561449, "vf_loss": 9.919189453125, "vf_explained_var": 6.314367340110039e-08, "kl": 0.006910169962793589, "entropy": 0.4190951883792877, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 55558.713483810425, "episode_reward_min": 44636.99324417114, "episode_reward_mean": 51440.108261078596, "episode_len_mean": 135.4375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44636.99324417114}, "policy_reward_max": {"agent_0": 55558.713483810425}, "policy_reward_mean": {"agent_0": 51440.108261078596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52578.42003250122, 50613.039920806885, 51222.64666748047, 48501.71351623535, 44636.99324417114, 53852.74687194824, 53114.22027206421, 50477.90678405762, 54629.91358566284, 55227.56716918945, 49989.020109176636, 50671.020069122314, 51719.86675643921, 48975.30689620972, 50720.20701408386, 52063.57374572754, 49696.8867726326, 55386.33350944519, 54682.39335727692, 53637.366901397705, 48414.24680137634, 48490.68007659912, 54146.759925842285, 51681.20008945465, 53132.586654663086, 51510.58673095703, 49336.473445892334, 55558.713483810425, 50542.62704086304, 50420.619998931885, 48107.69341516495, 52344.13349533081], "episode_lengths": [135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136], "policy_agent_0_reward": [52578.42003250122, 50613.039920806885, 51222.64666748047, 48501.71351623535, 44636.99324417114, 53852.74687194824, 53114.22027206421, 50477.90678405762, 54629.91358566284, 55227.56716918945, 49989.020109176636, 50671.020069122314, 51719.86675643921, 48975.30689620972, 50720.20701408386, 52063.57374572754, 49696.8867726326, 55386.33350944519, 54682.39335727692, 53637.366901397705, 48414.24680137634, 48490.68007659912, 54146.759925842285, 51681.20008945465, 53132.586654663086, 51510.58673095703, 49336.473445892334, 55558.713483810425, 50542.62704086304, 50420.619998931885, 48107.69341516495, 52344.13349533081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.17164912765479, "mean_inference_ms": 6.419521295567499, "mean_action_processing_ms": 0.2023179655092476, "mean_env_wait_ms": 209.0355094766965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0906825065612793, "StateBufferConnector_ms": 0.0063478946685791016, "ViewRequirementAgentConnector_ms": 0.3542996942996979}}, "episode_reward_max": 55558.713483810425, "episode_reward_min": 44636.99324417114, "episode_reward_mean": 51440.108261078596, "episode_len_mean": 135.4375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44636.99324417114}, "policy_reward_max": {"agent_0": 55558.713483810425}, "policy_reward_mean": {"agent_0": 51440.108261078596}, "hist_stats": {"episode_reward": [52578.42003250122, 50613.039920806885, 51222.64666748047, 48501.71351623535, 44636.99324417114, 53852.74687194824, 53114.22027206421, 50477.90678405762, 54629.91358566284, 55227.56716918945, 49989.020109176636, 50671.020069122314, 51719.86675643921, 48975.30689620972, 50720.20701408386, 52063.57374572754, 49696.8867726326, 55386.33350944519, 54682.39335727692, 53637.366901397705, 48414.24680137634, 48490.68007659912, 54146.759925842285, 51681.20008945465, 53132.586654663086, 51510.58673095703, 49336.473445892334, 55558.713483810425, 50542.62704086304, 50420.619998931885, 48107.69341516495, 52344.13349533081], "episode_lengths": [135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136], "policy_agent_0_reward": [52578.42003250122, 50613.039920806885, 51222.64666748047, 48501.71351623535, 44636.99324417114, 53852.74687194824, 53114.22027206421, 50477.90678405762, 54629.91358566284, 55227.56716918945, 49989.020109176636, 50671.020069122314, 51719.86675643921, 48975.30689620972, 50720.20701408386, 52063.57374572754, 49696.8867726326, 55386.33350944519, 54682.39335727692, 53637.366901397705, 48414.24680137634, 48490.68007659912, 54146.759925842285, 51681.20008945465, 53132.586654663086, 51510.58673095703, 49336.473445892334, 55558.713483810425, 50542.62704086304, 50420.619998931885, 48107.69341516495, 52344.13349533081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.17164912765479, "mean_inference_ms": 6.419521295567499, "mean_action_processing_ms": 0.2023179655092476, "mean_env_wait_ms": 209.0355094766965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0906825065612793, "StateBufferConnector_ms": 0.0063478946685791016, "ViewRequirementAgentConnector_ms": 0.3542996942996979}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.84755933758245, "num_env_steps_trained_throughput_per_sec": 236.84755933758245, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 16024.568, "sample_time_ms": 11548.655, "learn_time_ms": 4313.424, "learn_throughput": 927.338, "synch_weights_time_ms": 161.326}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 2388, "training_iteration": 83, "trial_id": "185f8_00000", "date": "2025-03-21_12-06-40", "timestamp": 1742558800, "time_this_iter_s": 16.956273555755615, "time_total_s": 1327.9857580661774, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a216c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1327.9857580661774, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.35652173913044, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988459587097168, "policy_loss": -0.012965768575668335, "vf_loss": 10.0, "vf_explained_var": 9.809931533766303e-09, "kl": 0.007125362753868103, "entropy": 0.40879547595977783, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 52344.13349533081, "episode_reward_min": 52344.13349533081, "episode_reward_mean": 52344.13349533081, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52344.13349533081}, "policy_reward_max": {"agent_0": 52344.13349533081}, "policy_reward_mean": {"agent_0": 52344.13349533081}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52344.13349533081], "episode_lengths": [136], "policy_agent_0_reward": [52344.13349533081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.76460614517657, "mean_inference_ms": 6.39801042793441, "mean_action_processing_ms": 0.19459811440349495, "mean_env_wait_ms": 209.93219857668353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034332275390625, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.14832019805908203}}, "episode_reward_max": 52344.13349533081, "episode_reward_min": 52344.13349533081, "episode_reward_mean": 52344.13349533081, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52344.13349533081}, "policy_reward_max": {"agent_0": 52344.13349533081}, "policy_reward_mean": {"agent_0": 52344.13349533081}, "hist_stats": {"episode_reward": [52344.13349533081], "episode_lengths": [136], "policy_agent_0_reward": [52344.13349533081]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.76460614517657, "mean_inference_ms": 6.39801042793441, "mean_action_processing_ms": 0.19459811440349495, "mean_env_wait_ms": 209.93219857668353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034332275390625, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.14832019805908203}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.1284850743608, "num_env_steps_trained_throughput_per_sec": 265.1284850743608, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 16077.844, "sample_time_ms": 11574.043, "learn_time_ms": 4336.487, "learn_throughput": 922.406, "synch_weights_time_ms": 166.166}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 2388, "training_iteration": 84, "trial_id": "185f8_00000", "date": "2025-03-21_12-06-55", "timestamp": 1742558815, "time_this_iter_s": 15.164928197860718, "time_total_s": 1343.150686264038, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2626710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1343.150686264038, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.53636363636362, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.960783004760742, "policy_loss": -0.014141569845378399, "vf_loss": 9.973097801208496, "vf_explained_var": -2.877755650843028e-05, "kl": 0.009129511192440987, "entropy": 0.4481130540370941, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 54814.20039796829, "episode_reward_min": 48974.68688964844, "episode_reward_mean": 52476.512846755984, "episode_len_mean": 135.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 48974.68688964844}, "policy_reward_max": {"agent_0": 54814.20039796829}, "policy_reward_mean": {"agent_0": 52476.512846755984}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53520.17335128784, 53631.313594818115, 48974.68688964844, 52473.88716506958, 51870.61329269409, 53404.80675506592, 53922.90003108978, 49102.18006181717, 54814.20039796829, 53050.366928100586], "episode_lengths": [136, 136, 136, 134, 136, 136, 134, 136, 135, 134], "policy_agent_0_reward": [53520.17335128784, 53631.313594818115, 48974.68688964844, 52473.88716506958, 51870.61329269409, 53404.80675506592, 53922.90003108978, 49102.18006181717, 54814.20039796829, 53050.366928100586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.87656517056847, "mean_inference_ms": 6.677293111541085, "mean_action_processing_ms": 0.20610894494440482, "mean_env_wait_ms": 227.53176523542984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12006521224975586, "StateBufferConnector_ms": 0.0063323974609375, "ViewRequirementAgentConnector_ms": 0.5504035949707031}}, "episode_reward_max": 54814.20039796829, "episode_reward_min": 48974.68688964844, "episode_reward_mean": 52476.512846755984, "episode_len_mean": 135.3, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 48974.68688964844}, "policy_reward_max": {"agent_0": 54814.20039796829}, "policy_reward_mean": {"agent_0": 52476.512846755984}, "hist_stats": {"episode_reward": [53520.17335128784, 53631.313594818115, 48974.68688964844, 52473.88716506958, 51870.61329269409, 53404.80675506592, 53922.90003108978, 49102.18006181717, 54814.20039796829, 53050.366928100586], "episode_lengths": [136, 136, 136, 134, 136, 136, 134, 136, 135, 134], "policy_agent_0_reward": [53520.17335128784, 53631.313594818115, 48974.68688964844, 52473.88716506958, 51870.61329269409, 53404.80675506592, 53922.90003108978, 49102.18006181717, 54814.20039796829, 53050.366928100586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.87656517056847, "mean_inference_ms": 6.677293111541085, "mean_action_processing_ms": 0.20610894494440482, "mean_env_wait_ms": 227.53176523542984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12006521224975586, "StateBufferConnector_ms": 0.0063323974609375, "ViewRequirementAgentConnector_ms": 0.5504035949707031}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.03309175253474, "num_env_steps_trained_throughput_per_sec": 289.03309175253474, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 15688.2, "sample_time_ms": 11241.07, "learn_time_ms": 4277.109, "learn_throughput": 935.211, "synch_weights_time_ms": 168.897}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 2398, "training_iteration": 85, "trial_id": "185f8_00000", "date": "2025-03-21_12-07-09", "timestamp": 1742558829, "time_this_iter_s": 13.887317657470703, "time_total_s": 1357.0380039215088, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c0a23400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1357.0380039215088, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 98.53, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.914634146341464, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.781054496765137, "policy_loss": -0.01574297808110714, "vf_loss": 9.795083045959473, "vf_explained_var": 2.5990730136982165e-06, "kl": 0.008574516512453556, "entropy": 0.4891473948955536, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 57184.8801651001, "episode_reward_min": 44797.94680976868, "episode_reward_mean": 51861.65022611182, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 44797.94680976868}, "policy_reward_max": {"agent_0": 57184.8801651001}, "policy_reward_mean": {"agent_0": 51861.65022611182}, "custom_metrics": {"num_batches_mean": 5.914634146341464, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55691.947006225586, 46271.4532661438, 51262.260314941406, 54612.79363822937, 55252.30025291443, 48350.15351486206, 52479.500343322754, 44797.94680976868, 54497.040254592896, 53648.98674964905, 54585.74019241333, 51733.09996795654, 53588.753356933594, 50667.76671791077, 56869.03350067139, 52029.146589279175, 53631.366970062256, 52545.87369346619, 48530.140040397644, 50890.91353607178, 54830.26676940918, 53597.240184783936, 48800.92683792114, 46263.09993171692, 48040.09354877472, 51611.313331604004, 49575.03359222412, 51986.18683433533, 51181.59999847412, 53411.36032867432, 52746.507009506226, 55024.85363006592, 48787.65993118286, 53591.18671798706, 51915.10672187805, 45618.27334022522, 55884.4934387207, 53044.85365009308, 56227.960021972656, 50754.280183792114, 53513.53339767456, 48453.760066986084, 48503.09344100952, 53605.86689949036, 51223.98670196533, 51830.26688194275, 50022.90687561035, 46107.6468167305, 52268.380155563354, 55070.520404815674, 48552.559928417206, 54513.14011383057, 46398.440136909485, 52321.57345581055, 53622.826793670654, 54390.29348182678, 50947.740184783936, 48202.799991607666, 50195.70680618286, 55132.0135345459, 52790.49344921112, 54361.95358276367, 54362.16014003754, 50000.74025726318, 53853.160148620605, 57184.8801651001, 49953.19341468811, 54394.70651245117, 54260.25323867798, 46560.32683944702, 53181.63354301453, 53380.46025085449, 55558.059925079346, 52627.306842803955, 45725.66665101051, 54572.086933135986, 54748.16040420532, 53188.48690032959, 50089.32013130188, 55353.567028045654, 50800.33342206478, 46002.79997253418], "episode_lengths": [135, 135, 135, 135, 135, 136, 135, 137, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 134, 136, 135, 136, 136, 135, 136, 136, 137, 135, 136, 136, 136, 136, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 137, 136, 135, 135, 136, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136], "policy_agent_0_reward": [55691.947006225586, 46271.4532661438, 51262.260314941406, 54612.79363822937, 55252.30025291443, 48350.15351486206, 52479.500343322754, 44797.94680976868, 54497.040254592896, 53648.98674964905, 54585.74019241333, 51733.09996795654, 53588.753356933594, 50667.76671791077, 56869.03350067139, 52029.146589279175, 53631.366970062256, 52545.87369346619, 48530.140040397644, 50890.91353607178, 54830.26676940918, 53597.240184783936, 48800.92683792114, 46263.09993171692, 48040.09354877472, 51611.313331604004, 49575.03359222412, 51986.18683433533, 51181.59999847412, 53411.36032867432, 52746.507009506226, 55024.85363006592, 48787.65993118286, 53591.18671798706, 51915.10672187805, 45618.27334022522, 55884.4934387207, 53044.85365009308, 56227.960021972656, 50754.280183792114, 53513.53339767456, 48453.760066986084, 48503.09344100952, 53605.86689949036, 51223.98670196533, 51830.26688194275, 50022.90687561035, 46107.6468167305, 52268.380155563354, 55070.520404815674, 48552.559928417206, 54513.14011383057, 46398.440136909485, 52321.57345581055, 53622.826793670654, 54390.29348182678, 50947.740184783936, 48202.799991607666, 50195.70680618286, 55132.0135345459, 52790.49344921112, 54361.95358276367, 54362.16014003754, 50000.74025726318, 53853.160148620605, 57184.8801651001, 49953.19341468811, 54394.70651245117, 54260.25323867798, 46560.32683944702, 53181.63354301453, 53380.46025085449, 55558.059925079346, 52627.306842803955, 45725.66665101051, 54572.086933135986, 54748.16040420532, 53188.48690032959, 50089.32013130188, 55353.567028045654, 50800.33342206478, 46002.79997253418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.36511712979473, "mean_inference_ms": 6.711467076227452, "mean_action_processing_ms": 0.2019956066219496, "mean_env_wait_ms": 226.7674699530123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05479760286284656, "StateBufferConnector_ms": 0.006510862490025963, "ViewRequirementAgentConnector_ms": 0.23309835573522056}}, "episode_reward_max": 57184.8801651001, "episode_reward_min": 44797.94680976868, "episode_reward_mean": 51861.65022611182, "episode_len_mean": 135.5, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 44797.94680976868}, "policy_reward_max": {"agent_0": 57184.8801651001}, "policy_reward_mean": {"agent_0": 51861.65022611182}, "hist_stats": {"episode_reward": [55691.947006225586, 46271.4532661438, 51262.260314941406, 54612.79363822937, 55252.30025291443, 48350.15351486206, 52479.500343322754, 44797.94680976868, 54497.040254592896, 53648.98674964905, 54585.74019241333, 51733.09996795654, 53588.753356933594, 50667.76671791077, 56869.03350067139, 52029.146589279175, 53631.366970062256, 52545.87369346619, 48530.140040397644, 50890.91353607178, 54830.26676940918, 53597.240184783936, 48800.92683792114, 46263.09993171692, 48040.09354877472, 51611.313331604004, 49575.03359222412, 51986.18683433533, 51181.59999847412, 53411.36032867432, 52746.507009506226, 55024.85363006592, 48787.65993118286, 53591.18671798706, 51915.10672187805, 45618.27334022522, 55884.4934387207, 53044.85365009308, 56227.960021972656, 50754.280183792114, 53513.53339767456, 48453.760066986084, 48503.09344100952, 53605.86689949036, 51223.98670196533, 51830.26688194275, 50022.90687561035, 46107.6468167305, 52268.380155563354, 55070.520404815674, 48552.559928417206, 54513.14011383057, 46398.440136909485, 52321.57345581055, 53622.826793670654, 54390.29348182678, 50947.740184783936, 48202.799991607666, 50195.70680618286, 55132.0135345459, 52790.49344921112, 54361.95358276367, 54362.16014003754, 50000.74025726318, 53853.160148620605, 57184.8801651001, 49953.19341468811, 54394.70651245117, 54260.25323867798, 46560.32683944702, 53181.63354301453, 53380.46025085449, 55558.059925079346, 52627.306842803955, 45725.66665101051, 54572.086933135986, 54748.16040420532, 53188.48690032959, 50089.32013130188, 55353.567028045654, 50800.33342206478, 46002.79997253418], "episode_lengths": [135, 135, 135, 135, 135, 136, 135, 137, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 134, 136, 135, 136, 136, 135, 136, 136, 137, 135, 136, 136, 136, 136, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 137, 136, 135, 135, 136, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136], "policy_agent_0_reward": [55691.947006225586, 46271.4532661438, 51262.260314941406, 54612.79363822937, 55252.30025291443, 48350.15351486206, 52479.500343322754, 44797.94680976868, 54497.040254592896, 53648.98674964905, 54585.74019241333, 51733.09996795654, 53588.753356933594, 50667.76671791077, 56869.03350067139, 52029.146589279175, 53631.366970062256, 52545.87369346619, 48530.140040397644, 50890.91353607178, 54830.26676940918, 53597.240184783936, 48800.92683792114, 46263.09993171692, 48040.09354877472, 51611.313331604004, 49575.03359222412, 51986.18683433533, 51181.59999847412, 53411.36032867432, 52746.507009506226, 55024.85363006592, 48787.65993118286, 53591.18671798706, 51915.10672187805, 45618.27334022522, 55884.4934387207, 53044.85365009308, 56227.960021972656, 50754.280183792114, 53513.53339767456, 48453.760066986084, 48503.09344100952, 53605.86689949036, 51223.98670196533, 51830.26688194275, 50022.90687561035, 46107.6468167305, 52268.380155563354, 55070.520404815674, 48552.559928417206, 54513.14011383057, 46398.440136909485, 52321.57345581055, 53622.826793670654, 54390.29348182678, 50947.740184783936, 48202.799991607666, 50195.70680618286, 55132.0135345459, 52790.49344921112, 54361.95358276367, 54362.16014003754, 50000.74025726318, 53853.160148620605, 57184.8801651001, 49953.19341468811, 54394.70651245117, 54260.25323867798, 46560.32683944702, 53181.63354301453, 53380.46025085449, 55558.059925079346, 52627.306842803955, 45725.66665101051, 54572.086933135986, 54748.16040420532, 53188.48690032959, 50089.32013130188, 55353.567028045654, 50800.33342206478, 46002.79997253418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.36511712979473, "mean_inference_ms": 6.711467076227452, "mean_action_processing_ms": 0.2019956066219496, "mean_env_wait_ms": 226.7674699530123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05479760286284656, "StateBufferConnector_ms": 0.006510862490025963, "ViewRequirementAgentConnector_ms": 0.23309835573522056}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.94246238970868, "num_env_steps_trained_throughput_per_sec": 201.94246238970868, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 16239.352, "sample_time_ms": 11802.148, "learn_time_ms": 4264.652, "learn_throughput": 937.943, "synch_weights_time_ms": 171.387}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 2480, "training_iteration": 86, "trial_id": "185f8_00000", "date": "2025-03-21_12-07-29", "timestamp": 1742558849, "time_this_iter_s": 19.877795934677124, "time_total_s": 1376.915799856186, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26265f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1376.915799856186, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 96.85555555555555, "ram_util_percent": 13.681481481481478}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908466339111328, "policy_loss": -0.013247690163552761, "vf_loss": 9.920167922973633, "vf_explained_var": 1.3521562323148828e-06, "kl": 0.007729075383394957, "entropy": 0.42906278371810913, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 57400.267333984375, "episode_reward_min": 47060.60000228882, "episode_reward_mean": 51762.40495636873, "episode_len_mean": 135.15625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47060.60000228882}, "policy_reward_max": {"agent_0": 57400.267333984375}, "policy_reward_mean": {"agent_0": 51762.40495636873}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53979.40033531189, 48479.23343658447, 51677.9335899353, 51996.62018299103, 51547.42657279968, 55304.13349151611, 53290.78026199341, 51819.18667984009, 53618.35347557068, 57400.267333984375, 51899.24659919739, 51910.02679824829, 48930.766971588135, 53300.20684814453, 48545.4068813324, 51540.27336883545, 47749.579999923706, 49076.48022079468, 53348.40026092529, 49811.24007034302, 53306.50690460205, 51569.820063352585, 55462.326599121094, 48313.660215616226, 52638.0202331543, 52477.693435668945, 51616.51372528076, 47060.60000228882, 50466.36018562317, 52182.026743888855, 56431.11361026764, 49647.35350507498], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135, 134, 136], "policy_agent_0_reward": [53979.40033531189, 48479.23343658447, 51677.9335899353, 51996.62018299103, 51547.42657279968, 55304.13349151611, 53290.78026199341, 51819.18667984009, 53618.35347557068, 57400.267333984375, 51899.24659919739, 51910.02679824829, 48930.766971588135, 53300.20684814453, 48545.4068813324, 51540.27336883545, 47749.579999923706, 49076.48022079468, 53348.40026092529, 49811.24007034302, 53306.50690460205, 51569.820063352585, 55462.326599121094, 48313.660215616226, 52638.0202331543, 52477.693435668945, 51616.51372528076, 47060.60000228882, 50466.36018562317, 52182.026743888855, 56431.11361026764, 49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.87048256258198, "mean_inference_ms": 6.385857275684564, "mean_action_processing_ms": 0.20247458643733957, "mean_env_wait_ms": 208.6391018387086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0843726098537445, "StateBufferConnector_ms": 0.013413280248641968, "ViewRequirementAgentConnector_ms": 0.25830939412117004}}, "episode_reward_max": 57400.267333984375, "episode_reward_min": 47060.60000228882, "episode_reward_mean": 51762.40495636873, "episode_len_mean": 135.15625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47060.60000228882}, "policy_reward_max": {"agent_0": 57400.267333984375}, "policy_reward_mean": {"agent_0": 51762.40495636873}, "hist_stats": {"episode_reward": [53979.40033531189, 48479.23343658447, 51677.9335899353, 51996.62018299103, 51547.42657279968, 55304.13349151611, 53290.78026199341, 51819.18667984009, 53618.35347557068, 57400.267333984375, 51899.24659919739, 51910.02679824829, 48930.766971588135, 53300.20684814453, 48545.4068813324, 51540.27336883545, 47749.579999923706, 49076.48022079468, 53348.40026092529, 49811.24007034302, 53306.50690460205, 51569.820063352585, 55462.326599121094, 48313.660215616226, 52638.0202331543, 52477.693435668945, 51616.51372528076, 47060.60000228882, 50466.36018562317, 52182.026743888855, 56431.11361026764, 49647.35350507498], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135, 134, 136], "policy_agent_0_reward": [53979.40033531189, 48479.23343658447, 51677.9335899353, 51996.62018299103, 51547.42657279968, 55304.13349151611, 53290.78026199341, 51819.18667984009, 53618.35347557068, 57400.267333984375, 51899.24659919739, 51910.02679824829, 48930.766971588135, 53300.20684814453, 48545.4068813324, 51540.27336883545, 47749.579999923706, 49076.48022079468, 53348.40026092529, 49811.24007034302, 53306.50690460205, 51569.820063352585, 55462.326599121094, 48313.660215616226, 52638.0202331543, 52477.693435668945, 51616.51372528076, 47060.60000228882, 50466.36018562317, 52182.026743888855, 56431.11361026764, 49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.87048256258198, "mean_inference_ms": 6.385857275684564, "mean_action_processing_ms": 0.20247458643733957, "mean_env_wait_ms": 208.6391018387086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0843726098537445, "StateBufferConnector_ms": 0.013413280248641968, "ViewRequirementAgentConnector_ms": 0.25830939412117004}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.97234659245402, "num_env_steps_trained_throughput_per_sec": 240.97234659245402, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 16020.191, "sample_time_ms": 11581.701, "learn_time_ms": 4266.585, "learn_throughput": 937.518, "synch_weights_time_ms": 170.788}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 2512, "training_iteration": 87, "trial_id": "185f8_00000", "date": "2025-03-21_12-07-46", "timestamp": 1742558866, "time_this_iter_s": 16.65820860862732, "time_total_s": 1393.5740084648132, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a26275b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1393.5740084648132, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.33333333333333, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986299514770508, "policy_loss": -0.015459769405424595, "vf_loss": 10.0, "vf_explained_var": -2.578521787199861e-07, "kl": 0.008795883506536484, "entropy": 0.4750836491584778, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 49647.35350507498, "episode_reward_min": 49647.35350507498, "episode_reward_mean": 49647.35350507498, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49647.35350507498}, "policy_reward_max": {"agent_0": 49647.35350507498}, "policy_reward_mean": {"agent_0": 49647.35350507498}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49647.35350507498], "episode_lengths": [136], "policy_agent_0_reward": [49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.63587747443685, "mean_inference_ms": 6.348108182710526, "mean_action_processing_ms": 0.19427943030439712, "mean_env_wait_ms": 209.80547048919382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037980079650878906, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1642465591430664}}, "episode_reward_max": 49647.35350507498, "episode_reward_min": 49647.35350507498, "episode_reward_mean": 49647.35350507498, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49647.35350507498}, "policy_reward_max": {"agent_0": 49647.35350507498}, "policy_reward_mean": {"agent_0": 49647.35350507498}, "hist_stats": {"episode_reward": [49647.35350507498], "episode_lengths": [136], "policy_agent_0_reward": [49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.63587747443685, "mean_inference_ms": 6.348108182710526, "mean_action_processing_ms": 0.19427943030439712, "mean_env_wait_ms": 209.80547048919382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037980079650878906, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1642465591430664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3211224930829, "num_env_steps_trained_throughput_per_sec": 292.3211224930829, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15935.093, "sample_time_ms": 11571.214, "learn_time_ms": 4189.061, "learn_throughput": 954.868, "synch_weights_time_ms": 173.811}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 2512, "training_iteration": 88, "trial_id": "185f8_00000", "date": "2025-03-21_12-08-00", "timestamp": 1742558880, "time_this_iter_s": 13.745495796203613, "time_total_s": 1407.3195042610168, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2626710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1407.3195042610168, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.5, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.990763664245605, "policy_loss": -0.010651690885424614, "vf_loss": 10.0, "vf_explained_var": -2.4388234010075394e-07, "kl": 0.007073233835399151, "entropy": 0.42784979939460754, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 49647.35350507498, "episode_reward_min": 49647.35350507498, "episode_reward_mean": 49647.35350507498, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49647.35350507498}, "policy_reward_max": {"agent_0": 49647.35350507498}, "policy_reward_mean": {"agent_0": 49647.35350507498}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49647.35350507498], "episode_lengths": [136], "policy_agent_0_reward": [49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.63587747443685, "mean_inference_ms": 6.348108182710526, "mean_action_processing_ms": 0.19427943030439712, "mean_env_wait_ms": 209.80547048919382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037980079650878906, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1642465591430664}}, "episode_reward_max": 49647.35350507498, "episode_reward_min": 49647.35350507498, "episode_reward_mean": 49647.35350507498, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49647.35350507498}, "policy_reward_max": {"agent_0": 49647.35350507498}, "policy_reward_mean": {"agent_0": 49647.35350507498}, "hist_stats": {"episode_reward": [49647.35350507498], "episode_lengths": [136], "policy_agent_0_reward": [49647.35350507498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.63587747443685, "mean_inference_ms": 6.348108182710526, "mean_action_processing_ms": 0.19427943030439712, "mean_env_wait_ms": 209.80547048919382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037980079650878906, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1642465591430664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.2524888653845, "num_env_steps_trained_throughput_per_sec": 283.2524888653845, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 15669.033, "sample_time_ms": 11317.84, "learn_time_ms": 4180.919, "learn_throughput": 956.728, "synch_weights_time_ms": 169.278}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 2512, "training_iteration": 89, "trial_id": "185f8_00000", "date": "2025-03-21_12-08-14", "timestamp": 1742558894, "time_this_iter_s": 14.18731951713562, "time_total_s": 1421.5068237781525, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25fe7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1421.5068237781525, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 99.55714285714286, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.761442184448242, "policy_loss": -0.012043619528412819, "vf_loss": 9.77197265625, "vf_explained_var": -2.0352503327103477e-07, "kl": 0.007559267804026604, "entropy": 0.4355469346046448, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 56337.82667541504, "episode_reward_min": 44562.7801220417, "episode_reward_mean": 51484.58601684156, "episode_len_mean": 135.4673913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44562.7801220417}, "policy_reward_max": {"agent_0": 56337.82667541504}, "policy_reward_mean": {"agent_0": 51484.58601684156}, "custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54567.98007965088, 53235.12690830231, 49402.7800116539, 54739.2265958786, 49960.88693809509, 52603.6536655426, 54884.59355926514, 53976.93328857422, 53260.54692077637, 47938.3067779541, 53922.726707458496, 50170.79346656799, 53710.92700386047, 54837.41354370117, 52224.0534362793, 51742.37357711792, 50196.35355806351, 53441.56017303467, 49352.246906757355, 47222.50676727295, 49862.35354042053, 50170.73334312439, 50007.89355278015, 51977.76043319702, 48432.21348667145, 50240.50689506531, 46871.20690727234, 49572.11351776123, 49881.60675048828, 53763.900035858154, 50059.7600402832, 54261.73342895508, 56337.82667541504, 50855.87333679199, 45700.240131378174, 55865.90690612793, 48856.17998123169, 53564.226707458496, 52645.52020263672, 52624.18683052063, 53503.25328159332, 47657.21352672577, 46276.37371444702, 54267.94007110596, 47442.38665390015, 47713.11330413818, 55583.88687705994, 48155.54683113098, 54644.82020378113, 44562.7801220417, 47765.160086631775, 52544.62697792053, 53229.28677368164, 48899.373136520386, 46132.46009540558, 49743.833360672, 53441.7935667038, 54562.960178375244, 54949.186891555786, 50296.96674156189, 54656.01998901367, 52958.433440208435, 52605.066692352295, 52891.4537563324, 53298.22706604004, 54994.026779174805, 52396.84020614624, 53870.75354766846, 52955.85340118408, 54044.8000164032, 48139.466804504395, 53361.07331085205, 51435.6600151062, 52331.17353439331, 49997.42701673508, 51450.34680175781, 53296.58675003052, 47962.64025878906, 53803.973417282104, 52391.50003051758, 50496.960275650024, 51868.34021639824, 55433.85344696045, 51856.8403339386, 46801.247071266174, 51905.92003631592, 50296.68694782257, 46380.80021190643, 53589.59338378906, 53903.17353820801, 51813.84691619873, 49077.63335227966], "episode_lengths": [136, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 136, 136, 137, 135, 135, 136, 137], "policy_agent_0_reward": [54567.98007965088, 53235.12690830231, 49402.7800116539, 54739.2265958786, 49960.88693809509, 52603.6536655426, 54884.59355926514, 53976.93328857422, 53260.54692077637, 47938.3067779541, 53922.726707458496, 50170.79346656799, 53710.92700386047, 54837.41354370117, 52224.0534362793, 51742.37357711792, 50196.35355806351, 53441.56017303467, 49352.246906757355, 47222.50676727295, 49862.35354042053, 50170.73334312439, 50007.89355278015, 51977.76043319702, 48432.21348667145, 50240.50689506531, 46871.20690727234, 49572.11351776123, 49881.60675048828, 53763.900035858154, 50059.7600402832, 54261.73342895508, 56337.82667541504, 50855.87333679199, 45700.240131378174, 55865.90690612793, 48856.17998123169, 53564.226707458496, 52645.52020263672, 52624.18683052063, 53503.25328159332, 47657.21352672577, 46276.37371444702, 54267.94007110596, 47442.38665390015, 47713.11330413818, 55583.88687705994, 48155.54683113098, 54644.82020378113, 44562.7801220417, 47765.160086631775, 52544.62697792053, 53229.28677368164, 48899.373136520386, 46132.46009540558, 49743.833360672, 53441.7935667038, 54562.960178375244, 54949.186891555786, 50296.96674156189, 54656.01998901367, 52958.433440208435, 52605.066692352295, 52891.4537563324, 53298.22706604004, 54994.026779174805, 52396.84020614624, 53870.75354766846, 52955.85340118408, 54044.8000164032, 48139.466804504395, 53361.07331085205, 51435.6600151062, 52331.17353439331, 49997.42701673508, 51450.34680175781, 53296.58675003052, 47962.64025878906, 53803.973417282104, 52391.50003051758, 50496.960275650024, 51868.34021639824, 55433.85344696045, 51856.8403339386, 46801.247071266174, 51905.92003631592, 50296.68694782257, 46380.80021190643, 53589.59338378906, 53903.17353820801, 51813.84691619873, 49077.63335227966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.76227579442374, "mean_inference_ms": 6.711735119020942, "mean_action_processing_ms": 0.20231811743696645, "mean_env_wait_ms": 226.06315016665565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10297972223033076, "StateBufferConnector_ms": 0.006387285564256751, "ViewRequirementAgentConnector_ms": 0.2871541873268459}}, "episode_reward_max": 56337.82667541504, "episode_reward_min": 44562.7801220417, "episode_reward_mean": 51484.58601684156, "episode_len_mean": 135.4673913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44562.7801220417}, "policy_reward_max": {"agent_0": 56337.82667541504}, "policy_reward_mean": {"agent_0": 51484.58601684156}, "hist_stats": {"episode_reward": [54567.98007965088, 53235.12690830231, 49402.7800116539, 54739.2265958786, 49960.88693809509, 52603.6536655426, 54884.59355926514, 53976.93328857422, 53260.54692077637, 47938.3067779541, 53922.726707458496, 50170.79346656799, 53710.92700386047, 54837.41354370117, 52224.0534362793, 51742.37357711792, 50196.35355806351, 53441.56017303467, 49352.246906757355, 47222.50676727295, 49862.35354042053, 50170.73334312439, 50007.89355278015, 51977.76043319702, 48432.21348667145, 50240.50689506531, 46871.20690727234, 49572.11351776123, 49881.60675048828, 53763.900035858154, 50059.7600402832, 54261.73342895508, 56337.82667541504, 50855.87333679199, 45700.240131378174, 55865.90690612793, 48856.17998123169, 53564.226707458496, 52645.52020263672, 52624.18683052063, 53503.25328159332, 47657.21352672577, 46276.37371444702, 54267.94007110596, 47442.38665390015, 47713.11330413818, 55583.88687705994, 48155.54683113098, 54644.82020378113, 44562.7801220417, 47765.160086631775, 52544.62697792053, 53229.28677368164, 48899.373136520386, 46132.46009540558, 49743.833360672, 53441.7935667038, 54562.960178375244, 54949.186891555786, 50296.96674156189, 54656.01998901367, 52958.433440208435, 52605.066692352295, 52891.4537563324, 53298.22706604004, 54994.026779174805, 52396.84020614624, 53870.75354766846, 52955.85340118408, 54044.8000164032, 48139.466804504395, 53361.07331085205, 51435.6600151062, 52331.17353439331, 49997.42701673508, 51450.34680175781, 53296.58675003052, 47962.64025878906, 53803.973417282104, 52391.50003051758, 50496.960275650024, 51868.34021639824, 55433.85344696045, 51856.8403339386, 46801.247071266174, 51905.92003631592, 50296.68694782257, 46380.80021190643, 53589.59338378906, 53903.17353820801, 51813.84691619873, 49077.63335227966], "episode_lengths": [136, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 136, 136, 137, 135, 135, 136, 137], "policy_agent_0_reward": [54567.98007965088, 53235.12690830231, 49402.7800116539, 54739.2265958786, 49960.88693809509, 52603.6536655426, 54884.59355926514, 53976.93328857422, 53260.54692077637, 47938.3067779541, 53922.726707458496, 50170.79346656799, 53710.92700386047, 54837.41354370117, 52224.0534362793, 51742.37357711792, 50196.35355806351, 53441.56017303467, 49352.246906757355, 47222.50676727295, 49862.35354042053, 50170.73334312439, 50007.89355278015, 51977.76043319702, 48432.21348667145, 50240.50689506531, 46871.20690727234, 49572.11351776123, 49881.60675048828, 53763.900035858154, 50059.7600402832, 54261.73342895508, 56337.82667541504, 50855.87333679199, 45700.240131378174, 55865.90690612793, 48856.17998123169, 53564.226707458496, 52645.52020263672, 52624.18683052063, 53503.25328159332, 47657.21352672577, 46276.37371444702, 54267.94007110596, 47442.38665390015, 47713.11330413818, 55583.88687705994, 48155.54683113098, 54644.82020378113, 44562.7801220417, 47765.160086631775, 52544.62697792053, 53229.28677368164, 48899.373136520386, 46132.46009540558, 49743.833360672, 53441.7935667038, 54562.960178375244, 54949.186891555786, 50296.96674156189, 54656.01998901367, 52958.433440208435, 52605.066692352295, 52891.4537563324, 53298.22706604004, 54994.026779174805, 52396.84020614624, 53870.75354766846, 52955.85340118408, 54044.8000164032, 48139.466804504395, 53361.07331085205, 51435.6600151062, 52331.17353439331, 49997.42701673508, 51450.34680175781, 53296.58675003052, 47962.64025878906, 53803.973417282104, 52391.50003051758, 50496.960275650024, 51868.34021639824, 55433.85344696045, 51856.8403339386, 46801.247071266174, 51905.92003631592, 50296.68694782257, 46380.80021190643, 53589.59338378906, 53903.17353820801, 51813.84691619873, 49077.63335227966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.76227579442374, "mean_inference_ms": 6.711735119020942, "mean_action_processing_ms": 0.20231811743696645, "mean_env_wait_ms": 226.06315016665565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10297972223033076, "StateBufferConnector_ms": 0.006387285564256751, "ViewRequirementAgentConnector_ms": 0.2871541873268459}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.25401713052028, "num_env_steps_trained_throughput_per_sec": 213.25401713052028, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 16171.279, "sample_time_ms": 11851.863, "learn_time_ms": 4148.217, "learn_throughput": 964.27, "synch_weights_time_ms": 170.174}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 2604, "training_iteration": 90, "trial_id": "185f8_00000", "date": "2025-03-21_12-08-33", "timestamp": 1742558913, "time_this_iter_s": 18.826582670211792, "time_total_s": 1440.3334064483643, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090add0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1440.3334064483643, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 94.50384615384615, "ram_util_percent": 13.676923076923076}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908308982849121, "policy_loss": -0.015577691607177258, "vf_loss": 9.922119140625, "vf_explained_var": 7.30777784951897e-08, "kl": 0.008830374106764793, "entropy": 0.44345301389694214, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 58134.58721923828, "episode_reward_min": 46864.52025461197, "episode_reward_mean": 51907.86055720237, "episode_len_mean": 135.4516129032258, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 46864.52025461197}, "policy_reward_max": {"agent_0": 58134.58721923828}, "policy_reward_mean": {"agent_0": 51907.86055720237}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51732.17324447632, 47021.253361701965, 56278.787033081055, 51744.41347503662, 48223.51334762573, 54398.31347846985, 51422.82028579712, 54475.77358055115, 55074.40015792847, 53083.440061569214, 50099.500202178955, 46864.52025461197, 55918.82660675049, 51218.36644363403, 52254.30666351318, 53084.573417663574, 52166.72688674927, 53116.83340072632, 47442.18666744232, 50250.940088272095, 52109.14001750946, 48945.10019779205, 51120.333545684814, 50044.79996109009, 52506.8803858757, 58134.58721923828, 53183.080070495605, 54125.14684534073, 52096.593605041504, 52393.59343338013, 48612.75333404541], "episode_lengths": [135, 137, 134, 136, 137, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 134, 135, 135, 136, 136, 135], "policy_agent_0_reward": [51732.17324447632, 47021.253361701965, 56278.787033081055, 51744.41347503662, 48223.51334762573, 54398.31347846985, 51422.82028579712, 54475.77358055115, 55074.40015792847, 53083.440061569214, 50099.500202178955, 46864.52025461197, 55918.82660675049, 51218.36644363403, 52254.30666351318, 53084.573417663574, 52166.72688674927, 53116.83340072632, 47442.18666744232, 50250.940088272095, 52109.14001750946, 48945.10019779205, 51120.333545684814, 50044.79996109009, 52506.8803858757, 58134.58721923828, 53183.080070495605, 54125.14684534073, 52096.593605041504, 52393.59343338013, 48612.75333404541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.77343131387712, "mean_inference_ms": 6.389750155646401, "mean_action_processing_ms": 0.20212632193146932, "mean_env_wait_ms": 208.13933540868325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055935305933798515, "StateBufferConnector_ms": 0.006207343070737777, "ViewRequirementAgentConnector_ms": 0.22872417203841672}}, "episode_reward_max": 58134.58721923828, "episode_reward_min": 46864.52025461197, "episode_reward_mean": 51907.86055720237, "episode_len_mean": 135.4516129032258, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 46864.52025461197}, "policy_reward_max": {"agent_0": 58134.58721923828}, "policy_reward_mean": {"agent_0": 51907.86055720237}, "hist_stats": {"episode_reward": [51732.17324447632, 47021.253361701965, 56278.787033081055, 51744.41347503662, 48223.51334762573, 54398.31347846985, 51422.82028579712, 54475.77358055115, 55074.40015792847, 53083.440061569214, 50099.500202178955, 46864.52025461197, 55918.82660675049, 51218.36644363403, 52254.30666351318, 53084.573417663574, 52166.72688674927, 53116.83340072632, 47442.18666744232, 50250.940088272095, 52109.14001750946, 48945.10019779205, 51120.333545684814, 50044.79996109009, 52506.8803858757, 58134.58721923828, 53183.080070495605, 54125.14684534073, 52096.593605041504, 52393.59343338013, 48612.75333404541], "episode_lengths": [135, 137, 134, 136, 137, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 134, 135, 135, 136, 136, 135], "policy_agent_0_reward": [51732.17324447632, 47021.253361701965, 56278.787033081055, 51744.41347503662, 48223.51334762573, 54398.31347846985, 51422.82028579712, 54475.77358055115, 55074.40015792847, 53083.440061569214, 50099.500202178955, 46864.52025461197, 55918.82660675049, 51218.36644363403, 52254.30666351318, 53084.573417663574, 52166.72688674927, 53116.83340072632, 47442.18666744232, 50250.940088272095, 52109.14001750946, 48945.10019779205, 51120.333545684814, 50044.79996109009, 52506.8803858757, 58134.58721923828, 53183.080070495605, 54125.14684534073, 52096.593605041504, 52393.59343338013, 48612.75333404541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.77343131387712, "mean_inference_ms": 6.389750155646401, "mean_action_processing_ms": 0.20212632193146932, "mean_env_wait_ms": 208.13933540868325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055935305933798515, "StateBufferConnector_ms": 0.006207343070737777, "ViewRequirementAgentConnector_ms": 0.22872417203841672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.75102381884813, "num_env_steps_trained_throughput_per_sec": 243.75102381884813, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 15975.153, "sample_time_ms": 11673.017, "learn_time_ms": 4133.017, "learn_throughput": 967.816, "synch_weights_time_ms": 168.086}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 2635, "training_iteration": 91, "trial_id": "185f8_00000", "date": "2025-03-21_12-08-49", "timestamp": 1742558929, "time_this_iter_s": 16.46499991416931, "time_total_s": 1456.7984063625336, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25ff1c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1456.7984063625336, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.14545454545454, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985983848571777, "policy_loss": -0.013015915639698505, "vf_loss": 9.99755859375, "vf_explained_var": -3.5092233474642853e-07, "kl": 0.007208353374153376, "entropy": 0.38710758090019226, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 47495.660121917725, "episode_reward_min": 47495.660121917725, "episode_reward_mean": 47495.660121917725, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 47495.660121917725}, "policy_reward_max": {"agent_0": 47495.660121917725}, "policy_reward_mean": {"agent_0": 47495.660121917725}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [47495.660121917725], "episode_lengths": [136], "policy_agent_0_reward": [47495.660121917725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.621214626413998, "mean_inference_ms": 6.693194718748714, "mean_action_processing_ms": 0.20948475350036722, "mean_env_wait_ms": 213.42260962377304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038695335388183594, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.17452239990234375}}, "episode_reward_max": 47495.660121917725, "episode_reward_min": 47495.660121917725, "episode_reward_mean": 47495.660121917725, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 47495.660121917725}, "policy_reward_max": {"agent_0": 47495.660121917725}, "policy_reward_mean": {"agent_0": 47495.660121917725}, "hist_stats": {"episode_reward": [47495.660121917725], "episode_lengths": [136], "policy_agent_0_reward": [47495.660121917725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.621214626413998, "mean_inference_ms": 6.693194718748714, "mean_action_processing_ms": 0.20948475350036722, "mean_env_wait_ms": 213.42260962377304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038695335388183594, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.17452239990234375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.55455736795733, "num_env_steps_trained_throughput_per_sec": 279.55455736795733, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15950.191, "sample_time_ms": 11695.155, "learn_time_ms": 4081.103, "learn_throughput": 980.127, "synch_weights_time_ms": 172.912}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 2636, "training_iteration": 92, "trial_id": "185f8_00000", "date": "2025-03-21_12-09-04", "timestamp": 1742558944, "time_this_iter_s": 14.363216400146484, "time_total_s": 1471.16162276268, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1471.16162276268, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99112606048584, "policy_loss": -0.010124629363417625, "vf_loss": 10.0, "vf_explained_var": -2.823149145569914e-07, "kl": 0.0062560755759477615, "entropy": 0.3661056458950043, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47495.660121917725, "episode_reward_min": 47495.660121917725, "episode_reward_mean": 47495.660121917725, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47495.660121917725}, "policy_reward_max": {"agent_0": 47495.660121917725}, "policy_reward_mean": {"agent_0": 47495.660121917725}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [47495.660121917725], "episode_lengths": [136], "policy_agent_0_reward": [47495.660121917725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.621214626413998, "mean_inference_ms": 6.693194718748714, "mean_action_processing_ms": 0.20948475350036722, "mean_env_wait_ms": 213.42260962377304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038695335388183594, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.17452239990234375}}, "episode_reward_max": 47495.660121917725, "episode_reward_min": 47495.660121917725, "episode_reward_mean": 47495.660121917725, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47495.660121917725}, "policy_reward_max": {"agent_0": 47495.660121917725}, "policy_reward_mean": {"agent_0": 47495.660121917725}, "hist_stats": {"episode_reward": [47495.660121917725], "episode_lengths": [136], "policy_agent_0_reward": [47495.660121917725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.621214626413998, "mean_inference_ms": 6.693194718748714, "mean_action_processing_ms": 0.20948475350036722, "mean_env_wait_ms": 213.42260962377304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038695335388183594, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.17452239990234375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.36272865537535, "num_env_steps_trained_throughput_per_sec": 301.36272865537535, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 15588.657, "sample_time_ms": 11344.53, "learn_time_ms": 4076.293, "learn_throughput": 981.284, "synch_weights_time_ms": 166.866}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 2636, "training_iteration": 93, "trial_id": "185f8_00000", "date": "2025-03-21_12-09-17", "timestamp": 1742558957, "time_this_iter_s": 13.331467628479004, "time_total_s": 1484.493090391159, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1484.493090391159, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 99.55789473684212, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.755171775817871, "policy_loss": -0.011265410110354424, "vf_loss": 9.765010833740234, "vf_explained_var": -1.819990529838833e-06, "kl": 0.007130375597625971, "entropy": 0.38106414675712585, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 57600.70003128052, "episode_reward_min": 45529.126856803894, "episode_reward_mean": 52496.39493304426, "episode_len_mean": 135.2391304347826, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45529.126856803894}, "policy_reward_max": {"agent_0": 57600.70003128052}, "policy_reward_mean": {"agent_0": 52496.39493304426}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51239.46025466919, 52379.886629104614, 50952.89342033863, 47992.32024478912, 53501.02018928528, 52816.84033203125, 55727.02050971985, 55691.05341339111, 49488.54655921459, 53634.97370529175, 54440.24697685242, 48185.68660354614, 57600.70003128052, 49782.28010559082, 53349.620346069336, 54187.59345245361, 52211.72687911987, 49192.713371276855, 50626.49347835779, 53688.04686355591, 53470.70002365112, 46748.273361206055, 54067.51363277435, 49226.72004199028, 55109.673412323, 56049.62014770508, 45529.126856803894, 51640.50675392151, 48483.060198783875, 50532.553674697876, 55270.61360168457, 53875.59350204468, 54581.14016723633, 52545.740089416504, 49636.286794662476, 50017.079881191254, 53297.47996520996, 53283.02670288086, 52677.63370704651, 51259.30666923523, 53148.11338806152, 48491.18006134033, 55356.086837768555, 53065.09336853027, 53774.180114746094, 52647.84684562683, 55983.67346191406, 53688.44688415527, 55889.95994567871, 54425.81350708008, 51545.47356891632, 54247.27334022522, 54165.393409729004, 46573.6602563858, 55801.07346725464, 53746.593338012695, 49449.406792640686, 52576.49372673035, 55596.26006317139, 48984.586709976196, 52537.393535614014, 53264.14035797119, 53244.28662109375, 55166.63374996185, 50040.440108299255, 50998.68019866943, 56025.69338989258, 52660.06011199951, 53723.013359069824, 53666.44689941406, 51785.28015267849, 52320.67343902588, 49003.02007770538, 51945.92687225342, 50654.73997735977, 57455.56021499634, 51865.05350494385, 50661.06662940979, 54011.87363433838, 50838.02674484253, 54191.187004089355, 50966.166798591614, 52314.55366706848, 52524.18676376343, 52718.86682128906, 53469.533893585205, 49043.09365653992, 53640.6534614563, 52776.72031402588, 55753.506607055664, 53581.460287094116, 53673.01334762573], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 134, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 134, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 134, 136, 136, 135, 135, 135, 134, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 134, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [51239.46025466919, 52379.886629104614, 50952.89342033863, 47992.32024478912, 53501.02018928528, 52816.84033203125, 55727.02050971985, 55691.05341339111, 49488.54655921459, 53634.97370529175, 54440.24697685242, 48185.68660354614, 57600.70003128052, 49782.28010559082, 53349.620346069336, 54187.59345245361, 52211.72687911987, 49192.713371276855, 50626.49347835779, 53688.04686355591, 53470.70002365112, 46748.273361206055, 54067.51363277435, 49226.72004199028, 55109.673412323, 56049.62014770508, 45529.126856803894, 51640.50675392151, 48483.060198783875, 50532.553674697876, 55270.61360168457, 53875.59350204468, 54581.14016723633, 52545.740089416504, 49636.286794662476, 50017.079881191254, 53297.47996520996, 53283.02670288086, 52677.63370704651, 51259.30666923523, 53148.11338806152, 48491.18006134033, 55356.086837768555, 53065.09336853027, 53774.180114746094, 52647.84684562683, 55983.67346191406, 53688.44688415527, 55889.95994567871, 54425.81350708008, 51545.47356891632, 54247.27334022522, 54165.393409729004, 46573.6602563858, 55801.07346725464, 53746.593338012695, 49449.406792640686, 52576.49372673035, 55596.26006317139, 48984.586709976196, 52537.393535614014, 53264.14035797119, 53244.28662109375, 55166.63374996185, 50040.440108299255, 50998.68019866943, 56025.69338989258, 52660.06011199951, 53723.013359069824, 53666.44689941406, 51785.28015267849, 52320.67343902588, 49003.02007770538, 51945.92687225342, 50654.73997735977, 57455.56021499634, 51865.05350494385, 50661.06662940979, 54011.87363433838, 50838.02674484253, 54191.187004089355, 50966.166798591614, 52314.55366706848, 52524.18676376343, 52718.86682128906, 53469.533893585205, 49043.09365653992, 53640.6534614563, 52776.72031402588, 55753.506607055664, 53581.460287094116, 53673.01334762573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.77993745021265, "mean_inference_ms": 6.708927211521427, "mean_action_processing_ms": 0.2022660775752162, "mean_env_wait_ms": 226.12159215856377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0874166903288468, "StateBufferConnector_ms": 0.01060833101687224, "ViewRequirementAgentConnector_ms": 0.2290046733358632}}, "episode_reward_max": 57600.70003128052, "episode_reward_min": 45529.126856803894, "episode_reward_mean": 52496.39493304426, "episode_len_mean": 135.2391304347826, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45529.126856803894}, "policy_reward_max": {"agent_0": 57600.70003128052}, "policy_reward_mean": {"agent_0": 52496.39493304426}, "hist_stats": {"episode_reward": [51239.46025466919, 52379.886629104614, 50952.89342033863, 47992.32024478912, 53501.02018928528, 52816.84033203125, 55727.02050971985, 55691.05341339111, 49488.54655921459, 53634.97370529175, 54440.24697685242, 48185.68660354614, 57600.70003128052, 49782.28010559082, 53349.620346069336, 54187.59345245361, 52211.72687911987, 49192.713371276855, 50626.49347835779, 53688.04686355591, 53470.70002365112, 46748.273361206055, 54067.51363277435, 49226.72004199028, 55109.673412323, 56049.62014770508, 45529.126856803894, 51640.50675392151, 48483.060198783875, 50532.553674697876, 55270.61360168457, 53875.59350204468, 54581.14016723633, 52545.740089416504, 49636.286794662476, 50017.079881191254, 53297.47996520996, 53283.02670288086, 52677.63370704651, 51259.30666923523, 53148.11338806152, 48491.18006134033, 55356.086837768555, 53065.09336853027, 53774.180114746094, 52647.84684562683, 55983.67346191406, 53688.44688415527, 55889.95994567871, 54425.81350708008, 51545.47356891632, 54247.27334022522, 54165.393409729004, 46573.6602563858, 55801.07346725464, 53746.593338012695, 49449.406792640686, 52576.49372673035, 55596.26006317139, 48984.586709976196, 52537.393535614014, 53264.14035797119, 53244.28662109375, 55166.63374996185, 50040.440108299255, 50998.68019866943, 56025.69338989258, 52660.06011199951, 53723.013359069824, 53666.44689941406, 51785.28015267849, 52320.67343902588, 49003.02007770538, 51945.92687225342, 50654.73997735977, 57455.56021499634, 51865.05350494385, 50661.06662940979, 54011.87363433838, 50838.02674484253, 54191.187004089355, 50966.166798591614, 52314.55366706848, 52524.18676376343, 52718.86682128906, 53469.533893585205, 49043.09365653992, 53640.6534614563, 52776.72031402588, 55753.506607055664, 53581.460287094116, 53673.01334762573], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 134, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 134, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 134, 136, 136, 135, 135, 135, 134, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 134, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [51239.46025466919, 52379.886629104614, 50952.89342033863, 47992.32024478912, 53501.02018928528, 52816.84033203125, 55727.02050971985, 55691.05341339111, 49488.54655921459, 53634.97370529175, 54440.24697685242, 48185.68660354614, 57600.70003128052, 49782.28010559082, 53349.620346069336, 54187.59345245361, 52211.72687911987, 49192.713371276855, 50626.49347835779, 53688.04686355591, 53470.70002365112, 46748.273361206055, 54067.51363277435, 49226.72004199028, 55109.673412323, 56049.62014770508, 45529.126856803894, 51640.50675392151, 48483.060198783875, 50532.553674697876, 55270.61360168457, 53875.59350204468, 54581.14016723633, 52545.740089416504, 49636.286794662476, 50017.079881191254, 53297.47996520996, 53283.02670288086, 52677.63370704651, 51259.30666923523, 53148.11338806152, 48491.18006134033, 55356.086837768555, 53065.09336853027, 53774.180114746094, 52647.84684562683, 55983.67346191406, 53688.44688415527, 55889.95994567871, 54425.81350708008, 51545.47356891632, 54247.27334022522, 54165.393409729004, 46573.6602563858, 55801.07346725464, 53746.593338012695, 49449.406792640686, 52576.49372673035, 55596.26006317139, 48984.586709976196, 52537.393535614014, 53264.14035797119, 53244.28662109375, 55166.63374996185, 50040.440108299255, 50998.68019866943, 56025.69338989258, 52660.06011199951, 53723.013359069824, 53666.44689941406, 51785.28015267849, 52320.67343902588, 49003.02007770538, 51945.92687225342, 50654.73997735977, 57455.56021499634, 51865.05350494385, 50661.06662940979, 54011.87363433838, 50838.02674484253, 54191.187004089355, 50966.166798591614, 52314.55366706848, 52524.18676376343, 52718.86682128906, 53469.533893585205, 49043.09365653992, 53640.6534614563, 52776.72031402588, 55753.506607055664, 53581.460287094116, 53673.01334762573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.77993745021265, "mean_inference_ms": 6.708927211521427, "mean_action_processing_ms": 0.2022660775752162, "mean_env_wait_ms": 226.12159215856377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0874166903288468, "StateBufferConnector_ms": 0.01060833101687224, "ViewRequirementAgentConnector_ms": 0.2290046733358632}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.70865814550345, "num_env_steps_trained_throughput_per_sec": 208.70865814550345, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 15996.502, "sample_time_ms": 11853.507, "learn_time_ms": 3976.271, "learn_throughput": 1005.968, "synch_weights_time_ms": 165.732}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 2728, "training_iteration": 94, "trial_id": "185f8_00000", "date": "2025-03-21_12-09-36", "timestamp": 1742558976, "time_this_iter_s": 19.224647998809814, "time_total_s": 1503.7177383899689, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25284c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1503.7177383899689, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 94.9, "ram_util_percent": 13.688461538461537}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.913966178894043, "policy_loss": -0.012113602831959724, "vf_loss": 9.924564361572266, "vf_explained_var": 1.2568508509502863e-06, "kl": 0.0075699700973927975, "entropy": 0.3878660500049591, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 57810.3602142334, "episode_reward_min": 48046.753412246704, "episode_reward_mean": 53686.40992348989, "episode_len_mean": 135.36666666666667, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 48046.753412246704}, "policy_reward_max": {"agent_0": 57810.3602142334}, "policy_reward_mean": {"agent_0": 53686.40992348989}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55006.76689910889, 53098.539960861206, 54233.30672454834, 57279.4803314209, 54952.88010406494, 54851.06004333496, 48187.00664329529, 51130.4801902771, 56299.18672180176, 48493.366888046265, 51837.15351104736, 57810.3602142334, 54683.540283203125, 54448.486702919006, 53137.24698352814, 52516.8201751709, 53736.44680786133, 54980.8535118103, 51595.82671546936, 54384.79330062866, 51673.473452568054, 57356.040214538574, 53601.90028381348, 56921.91354370117, 48046.753412246704, 56927.38673400879, 53724.84019947052, 48856.36001729965, 54886.52008008957, 55933.50705432892], "episode_lengths": [135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 136, 135, 135, 134, 135, 134, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136], "policy_agent_0_reward": [55006.76689910889, 53098.539960861206, 54233.30672454834, 57279.4803314209, 54952.88010406494, 54851.06004333496, 48187.00664329529, 51130.4801902771, 56299.18672180176, 48493.366888046265, 51837.15351104736, 57810.3602142334, 54683.540283203125, 54448.486702919006, 53137.24698352814, 52516.8201751709, 53736.44680786133, 54980.8535118103, 51595.82671546936, 54384.79330062866, 51673.473452568054, 57356.040214538574, 53601.90028381348, 56921.91354370117, 48046.753412246704, 56927.38673400879, 53724.84019947052, 48856.36001729965, 54886.52008008957, 55933.50705432892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.781411971770176, "mean_inference_ms": 6.397337347370428, "mean_action_processing_ms": 0.20230397277948808, "mean_env_wait_ms": 208.19950628594881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07078409194946289, "StateBufferConnector_ms": 0.006319681803385417, "ViewRequirementAgentConnector_ms": 0.1914199193318685}}, "episode_reward_max": 57810.3602142334, "episode_reward_min": 48046.753412246704, "episode_reward_mean": 53686.40992348989, "episode_len_mean": 135.36666666666667, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 48046.753412246704}, "policy_reward_max": {"agent_0": 57810.3602142334}, "policy_reward_mean": {"agent_0": 53686.40992348989}, "hist_stats": {"episode_reward": [55006.76689910889, 53098.539960861206, 54233.30672454834, 57279.4803314209, 54952.88010406494, 54851.06004333496, 48187.00664329529, 51130.4801902771, 56299.18672180176, 48493.366888046265, 51837.15351104736, 57810.3602142334, 54683.540283203125, 54448.486702919006, 53137.24698352814, 52516.8201751709, 53736.44680786133, 54980.8535118103, 51595.82671546936, 54384.79330062866, 51673.473452568054, 57356.040214538574, 53601.90028381348, 56921.91354370117, 48046.753412246704, 56927.38673400879, 53724.84019947052, 48856.36001729965, 54886.52008008957, 55933.50705432892], "episode_lengths": [135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 136, 135, 135, 134, 135, 134, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136], "policy_agent_0_reward": [55006.76689910889, 53098.539960861206, 54233.30672454834, 57279.4803314209, 54952.88010406494, 54851.06004333496, 48187.00664329529, 51130.4801902771, 56299.18672180176, 48493.366888046265, 51837.15351104736, 57810.3602142334, 54683.540283203125, 54448.486702919006, 53137.24698352814, 52516.8201751709, 53736.44680786133, 54980.8535118103, 51595.82671546936, 54384.79330062866, 51673.473452568054, 57356.040214538574, 53601.90028381348, 56921.91354370117, 48046.753412246704, 56927.38673400879, 53724.84019947052, 48856.36001729965, 54886.52008008957, 55933.50705432892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.781411971770176, "mean_inference_ms": 6.397337347370428, "mean_action_processing_ms": 0.20230397277948808, "mean_env_wait_ms": 208.19950628594881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07078409194946289, "StateBufferConnector_ms": 0.006319681803385417, "ViewRequirementAgentConnector_ms": 0.1914199193318685}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.39123218800603, "num_env_steps_trained_throughput_per_sec": 271.39123218800603, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 16086.466, "sample_time_ms": 11910.092, "learn_time_ms": 4007.695, "learn_throughput": 998.08, "synch_weights_time_ms": 167.664}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 2758, "training_iteration": 95, "trial_id": "185f8_00000", "date": "2025-03-21_12-09-51", "timestamp": 1742558991, "time_this_iter_s": 14.788232803344727, "time_total_s": 1518.5059711933136, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1518.5059711933136, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.47142857142858, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984843254089355, "policy_loss": -0.008462224155664444, "vf_loss": 9.9921875, "vf_explained_var": 3.891686617407686e-07, "kl": 0.005589151289314032, "entropy": 0.34015142917633057, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 55506.15997123718, "episode_reward_min": 52581.08006095886, "episode_reward_mean": 54043.62001609802, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 52581.08006095886}, "policy_reward_max": {"agent_0": 55506.15997123718}, "policy_reward_mean": {"agent_0": 54043.62001609802}, "custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55506.15997123718, 52581.08006095886], "episode_lengths": [134, 136], "policy_agent_0_reward": [55506.15997123718, 52581.08006095886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.81655033968646, "mean_inference_ms": 6.6076178549215525, "mean_action_processing_ms": 0.20452085900058428, "mean_env_wait_ms": 210.69367336677655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0401616096496582, "StateBufferConnector_ms": 0.005733966827392578, "ViewRequirementAgentConnector_ms": 0.16669034957885742}}, "episode_reward_max": 55506.15997123718, "episode_reward_min": 52581.08006095886, "episode_reward_mean": 54043.62001609802, "episode_len_mean": 135.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 52581.08006095886}, "policy_reward_max": {"agent_0": 55506.15997123718}, "policy_reward_mean": {"agent_0": 54043.62001609802}, "hist_stats": {"episode_reward": [55506.15997123718, 52581.08006095886], "episode_lengths": [134, 136], "policy_agent_0_reward": [55506.15997123718, 52581.08006095886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.81655033968646, "mean_inference_ms": 6.6076178549215525, "mean_action_processing_ms": 0.20452085900058428, "mean_env_wait_ms": 210.69367336677655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0401616096496582, "StateBufferConnector_ms": 0.005733966827392578, "ViewRequirementAgentConnector_ms": 0.16669034957885742}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.58818390654955, "num_env_steps_trained_throughput_per_sec": 285.58818390654955, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15506.321, "sample_time_ms": 11360.423, "learn_time_ms": 3981.568, "learn_throughput": 1004.629, "synch_weights_time_ms": 163.296}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 2760, "training_iteration": 96, "trial_id": "185f8_00000", "date": "2025-03-21_12-10-05", "timestamp": 1742559005, "time_this_iter_s": 14.052474975585938, "time_total_s": 1532.5584461688995, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1532.5584461688995, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.45500000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988852500915527, "policy_loss": -0.01279023289680481, "vf_loss": 10.0, "vf_explained_var": 1.3563161473939545e-06, "kl": 0.00821591541171074, "entropy": 0.39127227663993835, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 52581.08006095886, "episode_reward_min": 52581.08006095886, "episode_reward_mean": 52581.08006095886, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52581.08006095886}, "policy_reward_max": {"agent_0": 52581.08006095886}, "policy_reward_mean": {"agent_0": 52581.08006095886}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52581.08006095886], "episode_lengths": [136], "policy_agent_0_reward": [52581.08006095886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.644249242275215, "mean_inference_ms": 6.518133358460339, "mean_action_processing_ms": 0.20047571802786301, "mean_env_wait_ms": 207.65112491389786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042366981506347656, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.17609596252441406}}, "episode_reward_max": 52581.08006095886, "episode_reward_min": 52581.08006095886, "episode_reward_mean": 52581.08006095886, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52581.08006095886}, "policy_reward_max": {"agent_0": 52581.08006095886}, "policy_reward_mean": {"agent_0": 52581.08006095886}, "hist_stats": {"episode_reward": [52581.08006095886], "episode_lengths": [136], "policy_agent_0_reward": [52581.08006095886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.644249242275215, "mean_inference_ms": 6.518133358460339, "mean_action_processing_ms": 0.20047571802786301, "mean_env_wait_ms": 207.65112491389786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042366981506347656, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.17609596252441406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.6865896799661, "num_env_steps_trained_throughput_per_sec": 279.6865896799661, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 15276.557, "sample_time_ms": 11131.978, "learn_time_ms": 3982.254, "learn_throughput": 1004.456, "synch_weights_time_ms": 161.315}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 2760, "training_iteration": 97, "trial_id": "185f8_00000", "date": "2025-03-21_12-10-20", "timestamp": 1742559020, "time_this_iter_s": 14.354326963424683, "time_total_s": 1546.9127731323242, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252a170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1546.9127731323242, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.53809523809525, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.756375312805176, "policy_loss": -0.015994343906641006, "vf_loss": 9.770508766174316, "vf_explained_var": -3.8904448729226715e-07, "kl": 0.009304116480052471, "entropy": 0.40395987033843994, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 58019.00032043457, "episode_reward_min": 47028.73322105408, "episode_reward_mean": 53464.47839089062, "episode_len_mean": 135.15217391304347, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47028.73322105408}, "policy_reward_max": {"agent_0": 58019.00032043457}, "policy_reward_mean": {"agent_0": 53464.47839089062}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53542.606788635254, 56124.52020263672, 53082.37331008911, 55913.06684112549, 52388.400217056274, 48986.67348861694, 53535.200187683105, 50187.4201335907, 48248.813393116, 50661.36671257019, 52218.34003448486, 52830.973744392395, 56459.16678619385, 54659.36669921875, 52328.533376693726, 57992.60676574707, 52583.04016304016, 54106.44682717323, 52746.92687225342, 52423.34025096893, 56421.21332168579, 55015.13332462311, 55707.986740112305, 54296.633655548096, 54885.960165023804, 51438.96685409546, 54729.24033546448, 52491.88670730591, 47898.206711769104, 54737.79994010925, 52812.27342224121, 55276.72694396973, 56358.980209350586, 50835.57386112213, 53855.74671173096, 57387.99337768555, 54147.52687191963, 54895.553382873535, 55687.4001159668, 53988.346698760986, 51273.78007888794, 53632.27351760864, 53576.89381432533, 50943.20683193207, 55693.00026702881, 52651.26016998291, 51682.0533747673, 49538.52005195618, 52181.51343727112, 54500.51366043091, 54724.79309463501, 53590.519927978516, 53683.353439331055, 54537.11351776123, 53876.70014190674, 56006.56684112549, 55275.0800743103, 54415.120080947876, 58019.00032043457, 48930.00019264221, 54000.18671798706, 54149.52004241943, 55249.753509521484, 56273.46676635742, 51984.56023788452, 56973.86685180664, 54386.70001220703, 56467.339836120605, 47317.52003121376, 54760.54016113281, 53577.8866853714, 56192.066833496094, 48470.946813583374, 47028.73322105408, 50903.70002746582, 49612.206718444824, 54454.266986846924, 56201.120151519775, 51863.540197849274, 56173.00019836426, 55750.76700973511, 47828.83325433731, 54090.7932434082, 53293.13346576691, 53246.060205459595, 50286.113344192505, 54644.16028594971, 55541.74698638916, 53774.486724853516, 56025.68682861328, 51772.5269241333, 53817.18670654297], "episode_lengths": [136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 137, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 135, 134, 134, 135, 135, 136, 135, 136, 134, 135, 135, 135, 137, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [53542.606788635254, 56124.52020263672, 53082.37331008911, 55913.06684112549, 52388.400217056274, 48986.67348861694, 53535.200187683105, 50187.4201335907, 48248.813393116, 50661.36671257019, 52218.34003448486, 52830.973744392395, 56459.16678619385, 54659.36669921875, 52328.533376693726, 57992.60676574707, 52583.04016304016, 54106.44682717323, 52746.92687225342, 52423.34025096893, 56421.21332168579, 55015.13332462311, 55707.986740112305, 54296.633655548096, 54885.960165023804, 51438.96685409546, 54729.24033546448, 52491.88670730591, 47898.206711769104, 54737.79994010925, 52812.27342224121, 55276.72694396973, 56358.980209350586, 50835.57386112213, 53855.74671173096, 57387.99337768555, 54147.52687191963, 54895.553382873535, 55687.4001159668, 53988.346698760986, 51273.78007888794, 53632.27351760864, 53576.89381432533, 50943.20683193207, 55693.00026702881, 52651.26016998291, 51682.0533747673, 49538.52005195618, 52181.51343727112, 54500.51366043091, 54724.79309463501, 53590.519927978516, 53683.353439331055, 54537.11351776123, 53876.70014190674, 56006.56684112549, 55275.0800743103, 54415.120080947876, 58019.00032043457, 48930.00019264221, 54000.18671798706, 54149.52004241943, 55249.753509521484, 56273.46676635742, 51984.56023788452, 56973.86685180664, 54386.70001220703, 56467.339836120605, 47317.52003121376, 54760.54016113281, 53577.8866853714, 56192.066833496094, 48470.946813583374, 47028.73322105408, 50903.70002746582, 49612.206718444824, 54454.266986846924, 56201.120151519775, 51863.540197849274, 56173.00019836426, 55750.76700973511, 47828.83325433731, 54090.7932434082, 53293.13346576691, 53246.060205459595, 50286.113344192505, 54644.16028594971, 55541.74698638916, 53774.486724853516, 56025.68682861328, 51772.5269241333, 53817.18670654297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.666716683757016, "mean_inference_ms": 6.728678171379339, "mean_action_processing_ms": 0.20226133556878553, "mean_env_wait_ms": 225.74174190594914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08784610292185908, "StateBufferConnector_ms": 0.005835813024769659, "ViewRequirementAgentConnector_ms": 0.23738534554191257}}, "episode_reward_max": 58019.00032043457, "episode_reward_min": 47028.73322105408, "episode_reward_mean": 53464.47839089062, "episode_len_mean": 135.15217391304347, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47028.73322105408}, "policy_reward_max": {"agent_0": 58019.00032043457}, "policy_reward_mean": {"agent_0": 53464.47839089062}, "hist_stats": {"episode_reward": [53542.606788635254, 56124.52020263672, 53082.37331008911, 55913.06684112549, 52388.400217056274, 48986.67348861694, 53535.200187683105, 50187.4201335907, 48248.813393116, 50661.36671257019, 52218.34003448486, 52830.973744392395, 56459.16678619385, 54659.36669921875, 52328.533376693726, 57992.60676574707, 52583.04016304016, 54106.44682717323, 52746.92687225342, 52423.34025096893, 56421.21332168579, 55015.13332462311, 55707.986740112305, 54296.633655548096, 54885.960165023804, 51438.96685409546, 54729.24033546448, 52491.88670730591, 47898.206711769104, 54737.79994010925, 52812.27342224121, 55276.72694396973, 56358.980209350586, 50835.57386112213, 53855.74671173096, 57387.99337768555, 54147.52687191963, 54895.553382873535, 55687.4001159668, 53988.346698760986, 51273.78007888794, 53632.27351760864, 53576.89381432533, 50943.20683193207, 55693.00026702881, 52651.26016998291, 51682.0533747673, 49538.52005195618, 52181.51343727112, 54500.51366043091, 54724.79309463501, 53590.519927978516, 53683.353439331055, 54537.11351776123, 53876.70014190674, 56006.56684112549, 55275.0800743103, 54415.120080947876, 58019.00032043457, 48930.00019264221, 54000.18671798706, 54149.52004241943, 55249.753509521484, 56273.46676635742, 51984.56023788452, 56973.86685180664, 54386.70001220703, 56467.339836120605, 47317.52003121376, 54760.54016113281, 53577.8866853714, 56192.066833496094, 48470.946813583374, 47028.73322105408, 50903.70002746582, 49612.206718444824, 54454.266986846924, 56201.120151519775, 51863.540197849274, 56173.00019836426, 55750.76700973511, 47828.83325433731, 54090.7932434082, 53293.13346576691, 53246.060205459595, 50286.113344192505, 54644.16028594971, 55541.74698638916, 53774.486724853516, 56025.68682861328, 51772.5269241333, 53817.18670654297], "episode_lengths": [136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 137, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 135, 134, 134, 135, 135, 136, 135, 136, 134, 135, 135, 135, 137, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [53542.606788635254, 56124.52020263672, 53082.37331008911, 55913.06684112549, 52388.400217056274, 48986.67348861694, 53535.200187683105, 50187.4201335907, 48248.813393116, 50661.36671257019, 52218.34003448486, 52830.973744392395, 56459.16678619385, 54659.36669921875, 52328.533376693726, 57992.60676574707, 52583.04016304016, 54106.44682717323, 52746.92687225342, 52423.34025096893, 56421.21332168579, 55015.13332462311, 55707.986740112305, 54296.633655548096, 54885.960165023804, 51438.96685409546, 54729.24033546448, 52491.88670730591, 47898.206711769104, 54737.79994010925, 52812.27342224121, 55276.72694396973, 56358.980209350586, 50835.57386112213, 53855.74671173096, 57387.99337768555, 54147.52687191963, 54895.553382873535, 55687.4001159668, 53988.346698760986, 51273.78007888794, 53632.27351760864, 53576.89381432533, 50943.20683193207, 55693.00026702881, 52651.26016998291, 51682.0533747673, 49538.52005195618, 52181.51343727112, 54500.51366043091, 54724.79309463501, 53590.519927978516, 53683.353439331055, 54537.11351776123, 53876.70014190674, 56006.56684112549, 55275.0800743103, 54415.120080947876, 58019.00032043457, 48930.00019264221, 54000.18671798706, 54149.52004241943, 55249.753509521484, 56273.46676635742, 51984.56023788452, 56973.86685180664, 54386.70001220703, 56467.339836120605, 47317.52003121376, 54760.54016113281, 53577.8866853714, 56192.066833496094, 48470.946813583374, 47028.73322105408, 50903.70002746582, 49612.206718444824, 54454.266986846924, 56201.120151519775, 51863.540197849274, 56173.00019836426, 55750.76700973511, 47828.83325433731, 54090.7932434082, 53293.13346576691, 53246.060205459595, 50286.113344192505, 54644.16028594971, 55541.74698638916, 53774.486724853516, 56025.68682861328, 51772.5269241333, 53817.18670654297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.666716683757016, "mean_inference_ms": 6.728678171379339, "mean_action_processing_ms": 0.20226133556878553, "mean_env_wait_ms": 225.74174190594914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08784610292185908, "StateBufferConnector_ms": 0.005835813024769659, "ViewRequirementAgentConnector_ms": 0.23738534554191257}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.1957423722747, "num_env_steps_trained_throughput_per_sec": 224.1957423722747, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 15692.355, "sample_time_ms": 11589.792, "learn_time_ms": 3945.376, "learn_throughput": 1013.845, "synch_weights_time_ms": 156.187}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 2852, "training_iteration": 98, "trial_id": "185f8_00000", "date": "2025-03-21_12-10-38", "timestamp": 1742559038, "time_this_iter_s": 17.895559310913086, "time_total_s": 1564.8083324432373, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1564.8083324432373, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 94.63600000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.936633110046387, "policy_loss": -0.009951600804924965, "vf_loss": 9.9453125, "vf_explained_var": 4.729255920210562e-07, "kl": 0.006357036530971527, "entropy": 0.42374786734580994, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 58587.733489990234, "episode_reward_min": 50602.29353904724, "episode_reward_mean": 53572.123771927574, "episode_len_mean": 135.13636363636363, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 50602.29353904724}, "policy_reward_max": {"agent_0": 58587.733489990234}, "policy_reward_mean": {"agent_0": 53572.123771927574}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54991.9201965332, 54066.573276519775, 52116.82017326355, 54563.953426361084, 55570.08006954193, 54291.03984260559, 51252.6867351532, 53567.77366065979, 52199.86684799194, 55470.00715637207, 58587.733489990234, 54633.73361206055, 51099.09356594086, 52863.746965408325, 52566.24020385742, 50602.29353904724, 53156.99995613098, 50776.24664115906, 52404.69341278076, 54942.24002456665, 53242.89345550537, 55620.08673095703], "episode_lengths": [136, 135, 137, 135, 136, 136, 135, 136, 135, 135, 134, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 134], "policy_agent_0_reward": [54991.9201965332, 54066.573276519775, 52116.82017326355, 54563.953426361084, 55570.08006954193, 54291.03984260559, 51252.6867351532, 53567.77366065979, 52199.86684799194, 55470.00715637207, 58587.733489990234, 54633.73361206055, 51099.09356594086, 52863.746965408325, 52566.24020385742, 50602.29353904724, 53156.99995613098, 50776.24664115906, 52404.69341278076, 54942.24002456665, 53242.89345550537, 55620.08673095703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.523185159866383, "mean_inference_ms": 6.421774711998336, "mean_action_processing_ms": 0.20162694059172237, "mean_env_wait_ms": 208.760832303011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1664790240201083, "StateBufferConnector_ms": 0.006271492351185192, "ViewRequirementAgentConnector_ms": 0.24143132296475497}}, "episode_reward_max": 58587.733489990234, "episode_reward_min": 50602.29353904724, "episode_reward_mean": 53572.123771927574, "episode_len_mean": 135.13636363636363, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 50602.29353904724}, "policy_reward_max": {"agent_0": 58587.733489990234}, "policy_reward_mean": {"agent_0": 53572.123771927574}, "hist_stats": {"episode_reward": [54991.9201965332, 54066.573276519775, 52116.82017326355, 54563.953426361084, 55570.08006954193, 54291.03984260559, 51252.6867351532, 53567.77366065979, 52199.86684799194, 55470.00715637207, 58587.733489990234, 54633.73361206055, 51099.09356594086, 52863.746965408325, 52566.24020385742, 50602.29353904724, 53156.99995613098, 50776.24664115906, 52404.69341278076, 54942.24002456665, 53242.89345550537, 55620.08673095703], "episode_lengths": [136, 135, 137, 135, 136, 136, 135, 136, 135, 135, 134, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 134], "policy_agent_0_reward": [54991.9201965332, 54066.573276519775, 52116.82017326355, 54563.953426361084, 55570.08006954193, 54291.03984260559, 51252.6867351532, 53567.77366065979, 52199.86684799194, 55470.00715637207, 58587.733489990234, 54633.73361206055, 51099.09356594086, 52863.746965408325, 52566.24020385742, 50602.29353904724, 53156.99995613098, 50776.24664115906, 52404.69341278076, 54942.24002456665, 53242.89345550537, 55620.08673095703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.523185159866383, "mean_inference_ms": 6.421774711998336, "mean_action_processing_ms": 0.20162694059172237, "mean_env_wait_ms": 208.760832303011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1664790240201083, "StateBufferConnector_ms": 0.006271492351185192, "ViewRequirementAgentConnector_ms": 0.24143132296475497}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.93812060164504, "num_env_steps_trained_throughput_per_sec": 289.93812060164504, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 15659.796, "sample_time_ms": 11615.636, "learn_time_ms": 3891.072, "learn_throughput": 1027.994, "synch_weights_time_ms": 152.088}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 2874, "training_iteration": 99, "trial_id": "185f8_00000", "date": "2025-03-21_12-10-52", "timestamp": 1742559052, "time_this_iter_s": 13.846606731414795, "time_total_s": 1578.654939174652, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1578.654939174652, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.13157894736844, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.966544151306152, "policy_loss": -0.009984582662582397, "vf_loss": 9.975341796875, "vf_explained_var": 4.362935897006537e-07, "kl": 0.005939210765063763, "entropy": 0.4014042019844055, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 56745.700271606445, "episode_reward_min": 50989.48691558838, "episode_reward_mean": 53429.76683158874, "episode_len_mean": 135.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 50989.48691558838}, "policy_reward_max": {"agent_0": 56745.700271606445}, "policy_reward_mean": {"agent_0": 53429.76683158874}, "custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51925.273419857025, 56558.69362258911, 56745.700271606445, 51237.79347991943, 52665.84669923782, 53024.18659591675, 54904.60018157959, 54899.86698913574, 51346.22014045715, 50989.48691558838], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 135, 136, 135], "policy_agent_0_reward": [51925.273419857025, 56558.69362258911, 56745.700271606445, 51237.79347991943, 52665.84669923782, 53024.18659591675, 54904.60018157959, 54899.86698913574, 51346.22014045715, 50989.48691558838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.386855499847705, "mean_inference_ms": 6.4690108589604565, "mean_action_processing_ms": 0.2043189441966346, "mean_env_wait_ms": 207.22292978378613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042204856872558594, "StateBufferConnector_ms": 0.006453990936279297, "ViewRequirementAgentConnector_ms": 0.32718420028686523}}, "episode_reward_max": 56745.700271606445, "episode_reward_min": 50989.48691558838, "episode_reward_mean": 53429.76683158874, "episode_len_mean": 135.2, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 50989.48691558838}, "policy_reward_max": {"agent_0": 56745.700271606445}, "policy_reward_mean": {"agent_0": 53429.76683158874}, "hist_stats": {"episode_reward": [51925.273419857025, 56558.69362258911, 56745.700271606445, 51237.79347991943, 52665.84669923782, 53024.18659591675, 54904.60018157959, 54899.86698913574, 51346.22014045715, 50989.48691558838], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 135, 136, 135], "policy_agent_0_reward": [51925.273419857025, 56558.69362258911, 56745.700271606445, 51237.79347991943, 52665.84669923782, 53024.18659591675, 54904.60018157959, 54899.86698913574, 51346.22014045715, 50989.48691558838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.386855499847705, "mean_inference_ms": 6.4690108589604565, "mean_action_processing_ms": 0.2043189441966346, "mean_env_wait_ms": 207.22292978378613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042204856872558594, "StateBufferConnector_ms": 0.006453990936279297, "ViewRequirementAgentConnector_ms": 0.32718420028686523}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.96859232358906, "num_env_steps_trained_throughput_per_sec": 256.96859232358906, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15340.708, "sample_time_ms": 11287.89, "learn_time_ms": 3901.929, "learn_throughput": 1025.134, "synch_weights_time_ms": 149.912}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 2884, "training_iteration": 100, "trial_id": "185f8_00000", "date": "2025-03-21_12-11-07", "timestamp": 1742559067, "time_this_iter_s": 15.647040843963623, "time_total_s": 1594.3019800186157, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1594.3019800186157, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.36666666666667, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987799644470215, "policy_loss": -0.013701933436095715, "vf_loss": 10.0, "vf_explained_var": -7.7237686468834e-08, "kl": 0.007510816212743521, "entropy": 0.3884443938732147, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 50989.48691558838, "episode_reward_min": 50989.48691558838, "episode_reward_mean": 50989.48691558838, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50989.48691558838}, "policy_reward_max": {"agent_0": 50989.48691558838}, "policy_reward_mean": {"agent_0": 50989.48691558838}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50989.48691558838], "episode_lengths": [135], "policy_agent_0_reward": [50989.48691558838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.33713689871681, "mean_inference_ms": 6.346322521589916, "mean_action_processing_ms": 0.19589340062041746, "mean_env_wait_ms": 206.68228110989742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03914833068847656, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.165557861328125}}, "episode_reward_max": 50989.48691558838, "episode_reward_min": 50989.48691558838, "episode_reward_mean": 50989.48691558838, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50989.48691558838}, "policy_reward_max": {"agent_0": 50989.48691558838}, "policy_reward_mean": {"agent_0": 50989.48691558838}, "hist_stats": {"episode_reward": [50989.48691558838], "episode_lengths": [135], "policy_agent_0_reward": [50989.48691558838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.33713689871681, "mean_inference_ms": 6.346322521589916, "mean_action_processing_ms": 0.19589340062041746, "mean_env_wait_ms": 206.68228110989742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03914833068847656, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.165557861328125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.0864176080386, "num_env_steps_trained_throughput_per_sec": 292.0864176080386, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 15069.143, "sample_time_ms": 10962.785, "learn_time_ms": 3959.61, "learn_throughput": 1010.201, "synch_weights_time_ms": 145.765}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 2884, "training_iteration": 101, "trial_id": "185f8_00000", "date": "2025-03-21_12-11-21", "timestamp": 1742559081, "time_this_iter_s": 13.75061845779419, "time_total_s": 1608.05259847641, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79c090af80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1608.05259847641, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.58947368421052, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.891778945922852, "policy_loss": -0.008683153428137302, "vf_loss": 9.899170875549316, "vf_explained_var": -2.504636711364583e-07, "kl": 0.00645447289571166, "entropy": 0.37432464957237244, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 57558.35340881348, "episode_reward_min": 49736.42668533325, "episode_reward_mean": 53638.77982198298, "episode_len_mean": 135.3, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 49736.42668533325}, "policy_reward_max": {"agent_0": 57558.35340881348}, "policy_reward_mean": {"agent_0": 53638.77982198298}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52037.44681107998, 56819.753490448, 55539.160095214844, 55710.4002532959, 53815.11341381073, 54064.266746520996, 54580.14691543579, 52114.34009552002, 54127.26032829285, 54075.973443984985, 52390.51347351074, 49973.81345939636, 52803.91352272034, 53122.7335395813, 56500.453605651855, 51238.13354110718, 54564.59316825867, 56130.840087890625, 53669.52018737793, 52890.72010803223, 55953.31343078613, 51846.42021179199, 50105.293380737305, 53342.07334136963, 54709.840210437775, 50329.52691197395, 53185.28674507141, 57558.35340881348, 51454.26021385193, 55134.91382598877, 53787.393562316895, 55808.84689903259, 49736.42668533325, 51929.040100097656, 53486.08014678955, 51476.65347480774, 57398.58669281006, 54499.61347770691, 52654.22021484375, 54985.953657627106], "episode_lengths": [135, 135, 135, 135, 136, 135, 135, 135, 135, 137, 135, 137, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135], "policy_agent_0_reward": [52037.44681107998, 56819.753490448, 55539.160095214844, 55710.4002532959, 53815.11341381073, 54064.266746520996, 54580.14691543579, 52114.34009552002, 54127.26032829285, 54075.973443984985, 52390.51347351074, 49973.81345939636, 52803.91352272034, 53122.7335395813, 56500.453605651855, 51238.13354110718, 54564.59316825867, 56130.840087890625, 53669.52018737793, 52890.72010803223, 55953.31343078613, 51846.42021179199, 50105.293380737305, 53342.07334136963, 54709.840210437775, 50329.52691197395, 53185.28674507141, 57558.35340881348, 51454.26021385193, 55134.91382598877, 53787.393562316895, 55808.84689903259, 49736.42668533325, 51929.040100097656, 53486.08014678955, 51476.65347480774, 57398.58669281006, 54499.61347770691, 52654.22021484375, 54985.953657627106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.42745396481173, "mean_inference_ms": 6.689603096858283, "mean_action_processing_ms": 0.20279910626491762, "mean_env_wait_ms": 226.73757561133067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07110774517059326, "StateBufferConnector_ms": 0.006143450736999512, "ViewRequirementAgentConnector_ms": 0.22706687450408936}}, "episode_reward_max": 57558.35340881348, "episode_reward_min": 49736.42668533325, "episode_reward_mean": 53638.77982198298, "episode_len_mean": 135.3, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 49736.42668533325}, "policy_reward_max": {"agent_0": 57558.35340881348}, "policy_reward_mean": {"agent_0": 53638.77982198298}, "hist_stats": {"episode_reward": [52037.44681107998, 56819.753490448, 55539.160095214844, 55710.4002532959, 53815.11341381073, 54064.266746520996, 54580.14691543579, 52114.34009552002, 54127.26032829285, 54075.973443984985, 52390.51347351074, 49973.81345939636, 52803.91352272034, 53122.7335395813, 56500.453605651855, 51238.13354110718, 54564.59316825867, 56130.840087890625, 53669.52018737793, 52890.72010803223, 55953.31343078613, 51846.42021179199, 50105.293380737305, 53342.07334136963, 54709.840210437775, 50329.52691197395, 53185.28674507141, 57558.35340881348, 51454.26021385193, 55134.91382598877, 53787.393562316895, 55808.84689903259, 49736.42668533325, 51929.040100097656, 53486.08014678955, 51476.65347480774, 57398.58669281006, 54499.61347770691, 52654.22021484375, 54985.953657627106], "episode_lengths": [135, 135, 135, 135, 136, 135, 135, 135, 135, 137, 135, 137, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135], "policy_agent_0_reward": [52037.44681107998, 56819.753490448, 55539.160095214844, 55710.4002532959, 53815.11341381073, 54064.266746520996, 54580.14691543579, 52114.34009552002, 54127.26032829285, 54075.973443984985, 52390.51347351074, 49973.81345939636, 52803.91352272034, 53122.7335395813, 56500.453605651855, 51238.13354110718, 54564.59316825867, 56130.840087890625, 53669.52018737793, 52890.72010803223, 55953.31343078613, 51846.42021179199, 50105.293380737305, 53342.07334136963, 54709.840210437775, 50329.52691197395, 53185.28674507141, 57558.35340881348, 51454.26021385193, 55134.91382598877, 53787.393562316895, 55808.84689903259, 49736.42668533325, 51929.040100097656, 53486.08014678955, 51476.65347480774, 57398.58669281006, 54499.61347770691, 52654.22021484375, 54985.953657627106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.42745396481173, "mean_inference_ms": 6.689603096858283, "mean_action_processing_ms": 0.20279910626491762, "mean_env_wait_ms": 226.73757561133067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07110774517059326, "StateBufferConnector_ms": 0.006143450736999512, "ViewRequirementAgentConnector_ms": 0.22706687450408936}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.75308485876207, "num_env_steps_trained_throughput_per_sec": 287.75308485876207, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 15028.376, "sample_time_ms": 10993.244, "learn_time_ms": 3894.835, "learn_throughput": 1027.001, "synch_weights_time_ms": 139.341}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 2924, "training_iteration": 102, "trial_id": "185f8_00000", "date": "2025-03-21_12-11-35", "timestamp": 1742559095, "time_this_iter_s": 13.947278261184692, "time_total_s": 1621.9998767375946, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25284c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1621.9998767375946, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 96.965, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.864406779661017, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.843595504760742, "policy_loss": -0.009669511578977108, "vf_loss": 9.851808547973633, "vf_explained_var": -9.950871344699408e-07, "kl": 0.00728205032646656, "entropy": 0.3944772183895111, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 58180.72681427002, "episode_reward_min": 46996.97344326973, "episode_reward_mean": 52948.88499174684, "episode_len_mean": 135.28813559322035, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {"agent_0": 46996.97344326973}, "policy_reward_max": {"agent_0": 58180.72681427002}, "policy_reward_mean": {"agent_0": 52948.88499174684}, "custom_metrics": {"num_batches_mean": 5.864406779661017, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52665.69341659546, 52619.440172195435, 51173.460079193115, 52067.766830444336, 54935.01354217529, 51483.92652797699, 53618.16698074341, 52154.92671203613, 52799.406953811646, 54976.466796875, 52543.48674201965, 53028.37342643738, 52384.10704994202, 50799.03353881836, 51362.37340545654, 51081.95347595215, 52454.88675689697, 52424.07334136963, 52553.960134506226, 51079.96678733826, 54905.75337982178, 54200.753410339355, 53107.686950683594, 55837.47357940674, 55301.45347595215, 51609.326665878296, 54345.96688461304, 53001.02027130127, 54527.90672302246, 51941.68679237366, 55714.74703216553, 53533.3334312439, 55193.82014083862, 55979.953453063965, 49270.4934463501, 52466.37994480133, 51153.79344558716, 51417.40006065369, 53572.41340351105, 47347.50683403015, 55756.4469203949, 51904.793612957, 56120.26680755615, 54473.72691345215, 55550.52668380737, 47668.91339111328, 52933.39999580383, 58180.72681427002, 56142.2399520874, 51543.7333984375, 46996.97344326973, 54452.78660964966, 52989.26661682129, 51554.600326538086, 47865.826608181, 55271.50690460205, 53116.560218811035, 54107.95337677002, 54718.61392211914], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 136, 135, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52665.69341659546, 52619.440172195435, 51173.460079193115, 52067.766830444336, 54935.01354217529, 51483.92652797699, 53618.16698074341, 52154.92671203613, 52799.406953811646, 54976.466796875, 52543.48674201965, 53028.37342643738, 52384.10704994202, 50799.03353881836, 51362.37340545654, 51081.95347595215, 52454.88675689697, 52424.07334136963, 52553.960134506226, 51079.96678733826, 54905.75337982178, 54200.753410339355, 53107.686950683594, 55837.47357940674, 55301.45347595215, 51609.326665878296, 54345.96688461304, 53001.02027130127, 54527.90672302246, 51941.68679237366, 55714.74703216553, 53533.3334312439, 55193.82014083862, 55979.953453063965, 49270.4934463501, 52466.37994480133, 51153.79344558716, 51417.40006065369, 53572.41340351105, 47347.50683403015, 55756.4469203949, 51904.793612957, 56120.26680755615, 54473.72691345215, 55550.52668380737, 47668.91339111328, 52933.39999580383, 58180.72681427002, 56142.2399520874, 51543.7333984375, 46996.97344326973, 54452.78660964966, 52989.26661682129, 51554.600326538086, 47865.826608181, 55271.50690460205, 53116.560218811035, 54107.95337677002, 54718.61392211914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.814392739432364, "mean_inference_ms": 6.731409125182282, "mean_action_processing_ms": 0.20159849812065178, "mean_env_wait_ms": 223.46546879862538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627980183746855, "StateBufferConnector_ms": 0.006332639920509467, "ViewRequirementAgentConnector_ms": 0.25823803271277473}}, "episode_reward_max": 58180.72681427002, "episode_reward_min": 46996.97344326973, "episode_reward_mean": 52948.88499174684, "episode_len_mean": 135.28813559322035, "episodes_this_iter": 59, "policy_reward_min": {"agent_0": 46996.97344326973}, "policy_reward_max": {"agent_0": 58180.72681427002}, "policy_reward_mean": {"agent_0": 52948.88499174684}, "hist_stats": {"episode_reward": [52665.69341659546, 52619.440172195435, 51173.460079193115, 52067.766830444336, 54935.01354217529, 51483.92652797699, 53618.16698074341, 52154.92671203613, 52799.406953811646, 54976.466796875, 52543.48674201965, 53028.37342643738, 52384.10704994202, 50799.03353881836, 51362.37340545654, 51081.95347595215, 52454.88675689697, 52424.07334136963, 52553.960134506226, 51079.96678733826, 54905.75337982178, 54200.753410339355, 53107.686950683594, 55837.47357940674, 55301.45347595215, 51609.326665878296, 54345.96688461304, 53001.02027130127, 54527.90672302246, 51941.68679237366, 55714.74703216553, 53533.3334312439, 55193.82014083862, 55979.953453063965, 49270.4934463501, 52466.37994480133, 51153.79344558716, 51417.40006065369, 53572.41340351105, 47347.50683403015, 55756.4469203949, 51904.793612957, 56120.26680755615, 54473.72691345215, 55550.52668380737, 47668.91339111328, 52933.39999580383, 58180.72681427002, 56142.2399520874, 51543.7333984375, 46996.97344326973, 54452.78660964966, 52989.26661682129, 51554.600326538086, 47865.826608181, 55271.50690460205, 53116.560218811035, 54107.95337677002, 54718.61392211914], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 136, 135, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52665.69341659546, 52619.440172195435, 51173.460079193115, 52067.766830444336, 54935.01354217529, 51483.92652797699, 53618.16698074341, 52154.92671203613, 52799.406953811646, 54976.466796875, 52543.48674201965, 53028.37342643738, 52384.10704994202, 50799.03353881836, 51362.37340545654, 51081.95347595215, 52454.88675689697, 52424.07334136963, 52553.960134506226, 51079.96678733826, 54905.75337982178, 54200.753410339355, 53107.686950683594, 55837.47357940674, 55301.45347595215, 51609.326665878296, 54345.96688461304, 53001.02027130127, 54527.90672302246, 51941.68679237366, 55714.74703216553, 53533.3334312439, 55193.82014083862, 55979.953453063965, 49270.4934463501, 52466.37994480133, 51153.79344558716, 51417.40006065369, 53572.41340351105, 47347.50683403015, 55756.4469203949, 51904.793612957, 56120.26680755615, 54473.72691345215, 55550.52668380737, 47668.91339111328, 52933.39999580383, 58180.72681427002, 56142.2399520874, 51543.7333984375, 46996.97344326973, 54452.78660964966, 52989.26661682129, 51554.600326538086, 47865.826608181, 55271.50690460205, 53116.560218811035, 54107.95337677002, 54718.61392211914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.814392739432364, "mean_inference_ms": 6.731409125182282, "mean_action_processing_ms": 0.20159849812065178, "mean_env_wait_ms": 223.46546879862538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07627980183746855, "StateBufferConnector_ms": 0.006332639920509467, "ViewRequirementAgentConnector_ms": 0.25823803271277473}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.43099191765862, "num_env_steps_trained_throughput_per_sec": 193.43099191765862, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 15768.997, "sample_time_ms": 11719.979, "learn_time_ms": 3904.004, "learn_throughput": 1024.589, "synch_weights_time_ms": 144.027}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 2983, "training_iteration": 103, "trial_id": "185f8_00000", "date": "2025-03-21_12-11-56", "timestamp": 1742559116, "time_this_iter_s": 20.728074550628662, "time_total_s": 1642.7279512882233, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25ff6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1642.7279512882233, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 98.18148148148147, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.44, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.926294326782227, "policy_loss": -0.012526399455964565, "vf_loss": 9.937255859375, "vf_explained_var": 1.548416889818327e-06, "kl": 0.007820089347660542, "entropy": 0.39579448103904724, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 56944.84001159668, "episode_reward_min": 48708.220123291016, "episode_reward_mean": 53217.390821914676, "episode_len_mean": 135.52, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {"agent_0": 48708.220123291016}, "policy_reward_max": {"agent_0": 56944.84001159668}, "policy_reward_mean": {"agent_0": 53217.390821914676}, "custom_metrics": {"num_batches_mean": 5.44, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51905.51374053955, 55698.56004333496, 56944.84001159668, 52702.653705596924, 53528.91339111328, 52160.98013687134, 48708.220123291016, 49577.793254852295, 53611.513191223145, 51855.39345741272, 52802.07353591919, 53491.100200653076, 54781.56019592285, 55646.47343444824, 53734.53338623047, 50134.33351898193, 56591.60012817383, 54790.947105407715, 54684.07346153259, 52632.053453445435, 54106.28679084778, 52876.58700942993, 51968.14685821533, 51823.78038597107, 53676.84002685547], "episode_lengths": [136, 135, 135, 136, 136, 135, 136, 135, 136, 137, 137, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135], "policy_agent_0_reward": [51905.51374053955, 55698.56004333496, 56944.84001159668, 52702.653705596924, 53528.91339111328, 52160.98013687134, 48708.220123291016, 49577.793254852295, 53611.513191223145, 51855.39345741272, 52802.07353591919, 53491.100200653076, 54781.56019592285, 55646.47343444824, 53734.53338623047, 50134.33351898193, 56591.60012817383, 54790.947105407715, 54684.07346153259, 52632.053453445435, 54106.28679084778, 52876.58700942993, 51968.14685821533, 51823.78038597107, 53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.45453445896823, "mean_inference_ms": 6.402345060642419, "mean_action_processing_ms": 0.20210775035899267, "mean_env_wait_ms": 208.92236344570532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06946468353271484, "StateBufferConnector_ms": 0.007216453552246094, "ViewRequirementAgentConnector_ms": 0.27532196044921875}}, "episode_reward_max": 56944.84001159668, "episode_reward_min": 48708.220123291016, "episode_reward_mean": 53217.390821914676, "episode_len_mean": 135.52, "episodes_this_iter": 25, "policy_reward_min": {"agent_0": 48708.220123291016}, "policy_reward_max": {"agent_0": 56944.84001159668}, "policy_reward_mean": {"agent_0": 53217.390821914676}, "hist_stats": {"episode_reward": [51905.51374053955, 55698.56004333496, 56944.84001159668, 52702.653705596924, 53528.91339111328, 52160.98013687134, 48708.220123291016, 49577.793254852295, 53611.513191223145, 51855.39345741272, 52802.07353591919, 53491.100200653076, 54781.56019592285, 55646.47343444824, 53734.53338623047, 50134.33351898193, 56591.60012817383, 54790.947105407715, 54684.07346153259, 52632.053453445435, 54106.28679084778, 52876.58700942993, 51968.14685821533, 51823.78038597107, 53676.84002685547], "episode_lengths": [136, 135, 135, 136, 136, 135, 136, 135, 136, 137, 137, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135], "policy_agent_0_reward": [51905.51374053955, 55698.56004333496, 56944.84001159668, 52702.653705596924, 53528.91339111328, 52160.98013687134, 48708.220123291016, 49577.793254852295, 53611.513191223145, 51855.39345741272, 52802.07353591919, 53491.100200653076, 54781.56019592285, 55646.47343444824, 53734.53338623047, 50134.33351898193, 56591.60012817383, 54790.947105407715, 54684.07346153259, 52632.053453445435, 54106.28679084778, 52876.58700942993, 51968.14685821533, 51823.78038597107, 53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.45453445896823, "mean_inference_ms": 6.402345060642419, "mean_action_processing_ms": 0.20210775035899267, "mean_env_wait_ms": 208.92236344570532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06946468353271484, "StateBufferConnector_ms": 0.007216453552246094, "ViewRequirementAgentConnector_ms": 0.27532196044921875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.4184025412301, "num_env_steps_trained_throughput_per_sec": 226.4184025412301, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 15619.087, "sample_time_ms": 11570.908, "learn_time_ms": 3904.538, "learn_throughput": 1024.449, "synch_weights_time_ms": 142.666}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 3008, "training_iteration": 104, "trial_id": "185f8_00000", "date": "2025-03-21_12-12-14", "timestamp": 1742559134, "time_this_iter_s": 17.715752840042114, "time_total_s": 1660.4437041282654, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1660.4437041282654, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.336, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988110542297363, "policy_loss": -0.013417830690741539, "vf_loss": 10.0, "vf_explained_var": 5.111098175802908e-07, "kl": 0.007640416268259287, "entropy": 0.44888195395469666, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 53676.84002685547, "episode_reward_min": 53676.84002685547, "episode_reward_mean": 53676.84002685547, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53676.84002685547}, "policy_reward_max": {"agent_0": 53676.84002685547}, "policy_reward_mean": {"agent_0": 53676.84002685547}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53676.84002685547], "episode_lengths": [135], "policy_agent_0_reward": [53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.745267060210672, "mean_inference_ms": 6.316196734447574, "mean_action_processing_ms": 0.19551080480942806, "mean_env_wait_ms": 207.7468358286261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044465065002441406, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.19054412841796875}}, "episode_reward_max": 53676.84002685547, "episode_reward_min": 53676.84002685547, "episode_reward_mean": 53676.84002685547, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53676.84002685547}, "policy_reward_max": {"agent_0": 53676.84002685547}, "policy_reward_mean": {"agent_0": 53676.84002685547}, "hist_stats": {"episode_reward": [53676.84002685547], "episode_lengths": [135], "policy_agent_0_reward": [53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.745267060210672, "mean_inference_ms": 6.316196734447574, "mean_action_processing_ms": 0.19551080480942806, "mean_env_wait_ms": 207.7468358286261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044465065002441406, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.19054412841796875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6127620935095, "num_env_steps_trained_throughput_per_sec": 288.6127620935095, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 15531.14, "sample_time_ms": 11440.596, "learn_time_ms": 3936.45, "learn_throughput": 1016.144, "synch_weights_time_ms": 153.13}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 3008, "training_iteration": 105, "trial_id": "185f8_00000", "date": "2025-03-21_12-12-28", "timestamp": 1742559148, "time_this_iter_s": 13.920403718948364, "time_total_s": 1674.3641078472137, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25fd000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1674.3641078472137, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.575, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989574432373047, "policy_loss": -0.012000007554888725, "vf_loss": 10.0, "vf_explained_var": -2.3891527689556824e-07, "kl": 0.007872495800256729, "entropy": 0.37159597873687744, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 53676.84002685547, "episode_reward_min": 53676.84002685547, "episode_reward_mean": 53676.84002685547, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53676.84002685547}, "policy_reward_max": {"agent_0": 53676.84002685547}, "policy_reward_mean": {"agent_0": 53676.84002685547}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53676.84002685547], "episode_lengths": [135], "policy_agent_0_reward": [53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.745267060210672, "mean_inference_ms": 6.316196734447574, "mean_action_processing_ms": 0.19551080480942806, "mean_env_wait_ms": 207.7468358286261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044465065002441406, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.19054412841796875}}, "episode_reward_max": 53676.84002685547, "episode_reward_min": 53676.84002685547, "episode_reward_mean": 53676.84002685547, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53676.84002685547}, "policy_reward_max": {"agent_0": 53676.84002685547}, "policy_reward_mean": {"agent_0": 53676.84002685547}, "hist_stats": {"episode_reward": [53676.84002685547], "episode_lengths": [135], "policy_agent_0_reward": [53676.84002685547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.745267060210672, "mean_inference_ms": 6.316196734447574, "mean_action_processing_ms": 0.19551080480942806, "mean_env_wait_ms": 207.7468358286261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044465065002441406, "StateBufferConnector_ms": 0.006365776062011719, "ViewRequirementAgentConnector_ms": 0.19054412841796875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.12561476210453, "num_env_steps_trained_throughput_per_sec": 288.12561476210453, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 15518.808, "sample_time_ms": 11434.129, "learn_time_ms": 3928.498, "learn_throughput": 1018.201, "synch_weights_time_ms": 155.262}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 3008, "training_iteration": 106, "trial_id": "185f8_00000", "date": "2025-03-21_12-12-42", "timestamp": 1742559162, "time_this_iter_s": 13.926667928695679, "time_total_s": 1688.2907757759094, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1688.2907757759094, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 99.58947368421053, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.293478260869565, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.763097763061523, "policy_loss": -0.0088535500690341, "vf_loss": 9.770751953125, "vf_explained_var": 1.1064112470648979e-07, "kl": 0.005995673127472401, "entropy": 0.3839259445667267, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 57349.30014038086, "episode_reward_min": 47396.00663948059, "episode_reward_mean": 53262.27695133958, "episode_len_mean": 135.17391304347825, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47396.00663948059}, "policy_reward_max": {"agent_0": 57349.30014038086}, "policy_reward_mean": {"agent_0": 53262.27695133958}, "custom_metrics": {"num_batches_mean": 5.293478260869565, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54583.486907958984, 55537.84044456482, 54345.573718070984, 51777.03348350525, 55408.78678894043, 49136.12022590637, 55447.440116882324, 52867.38681411743, 51601.48690414429, 53437.646900177, 52409.12017059326, 53582.66668701172, 54742.56010055542, 52266.126564741135, 56930.89358520508, 54240.31340789795, 54233.84017944336, 55688.726638793945, 57075.06664085388, 54542.05351257324, 54979.573654174805, 51700.44681596756, 55795.74035835266, 51667.58012485504, 54577.77329158783, 53615.720083236694, 51465.05342102051, 50073.94009590149, 53988.740074157715, 50624.44005012512, 50851.02681350708, 55558.03325366974, 48869.86030960083, 53276.74018096924, 51793.06692028046, 52753.48667907715, 57196.50695800781, 53880.653557777405, 51404.89994716644, 53180.500005722046, 55418.46701812744, 50808.5931968689, 54736.78684234619, 49430.29999542236, 55698.34699630737, 54836.06019592285, 51420.613285541534, 47512.40678548813, 52729.553720235825, 55809.28666687012, 55702.353569984436, 50580.020122528076, 57349.30014038086, 50699.85329437256, 55718.600341796875, 54775.687131881714, 56017.066650390625, 54905.206855773926, 51964.60007476807, 52907.66010761261, 56522.680435180664, 54221.21319961548, 54956.70700073242, 53068.10021972656, 51822.846714019775, 52241.71347332001, 53667.433364868164, 49736.50673675537, 54852.97353553772, 52084.48679667711, 49725.9135055542, 54972.993156433105, 55046.266761779785, 50760.54674530029, 54037.50019836426, 54179.227078437805, 53089.33352661133, 51958.740171432495, 53585.246702194214, 52490.71991729736, 53804.22694396973, 49723.43347740173, 51672.94017791748, 47396.00663948059, 52319.480140686035, 52006.9600982666, 53739.639907836914, 53652.83364868164, 52247.980187654495, 54323.980419158936, 55007.333320617676, 55084.7999420166], "episode_lengths": [134, 135, 134, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 137, 136, 135, 136, 135, 135, 136, 135, 135, 136, 134, 136, 136, 135, 135, 135, 135, 137, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 134, 135, 135, 134, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 134, 135], "policy_agent_0_reward": [54583.486907958984, 55537.84044456482, 54345.573718070984, 51777.03348350525, 55408.78678894043, 49136.12022590637, 55447.440116882324, 52867.38681411743, 51601.48690414429, 53437.646900177, 52409.12017059326, 53582.66668701172, 54742.56010055542, 52266.126564741135, 56930.89358520508, 54240.31340789795, 54233.84017944336, 55688.726638793945, 57075.06664085388, 54542.05351257324, 54979.573654174805, 51700.44681596756, 55795.74035835266, 51667.58012485504, 54577.77329158783, 53615.720083236694, 51465.05342102051, 50073.94009590149, 53988.740074157715, 50624.44005012512, 50851.02681350708, 55558.03325366974, 48869.86030960083, 53276.74018096924, 51793.06692028046, 52753.48667907715, 57196.50695800781, 53880.653557777405, 51404.89994716644, 53180.500005722046, 55418.46701812744, 50808.5931968689, 54736.78684234619, 49430.29999542236, 55698.34699630737, 54836.06019592285, 51420.613285541534, 47512.40678548813, 52729.553720235825, 55809.28666687012, 55702.353569984436, 50580.020122528076, 57349.30014038086, 50699.85329437256, 55718.600341796875, 54775.687131881714, 56017.066650390625, 54905.206855773926, 51964.60007476807, 52907.66010761261, 56522.680435180664, 54221.21319961548, 54956.70700073242, 53068.10021972656, 51822.846714019775, 52241.71347332001, 53667.433364868164, 49736.50673675537, 54852.97353553772, 52084.48679667711, 49725.9135055542, 54972.993156433105, 55046.266761779785, 50760.54674530029, 54037.50019836426, 54179.227078437805, 53089.33352661133, 51958.740171432495, 53585.246702194214, 52490.71991729736, 53804.22694396973, 49723.43347740173, 51672.94017791748, 47396.00663948059, 52319.480140686035, 52006.9600982666, 53739.639907836914, 53652.83364868164, 52247.980187654495, 54323.980419158936, 55007.333320617676, 55084.7999420166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.490928628110986, "mean_inference_ms": 6.724269381783115, "mean_action_processing_ms": 0.20169939475754106, "mean_env_wait_ms": 226.2813742499017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0702238601187001, "StateBufferConnector_ms": 0.016766786575317383, "ViewRequirementAgentConnector_ms": 0.21182635556096616}}, "episode_reward_max": 57349.30014038086, "episode_reward_min": 47396.00663948059, "episode_reward_mean": 53262.27695133958, "episode_len_mean": 135.17391304347825, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47396.00663948059}, "policy_reward_max": {"agent_0": 57349.30014038086}, "policy_reward_mean": {"agent_0": 53262.27695133958}, "hist_stats": {"episode_reward": [54583.486907958984, 55537.84044456482, 54345.573718070984, 51777.03348350525, 55408.78678894043, 49136.12022590637, 55447.440116882324, 52867.38681411743, 51601.48690414429, 53437.646900177, 52409.12017059326, 53582.66668701172, 54742.56010055542, 52266.126564741135, 56930.89358520508, 54240.31340789795, 54233.84017944336, 55688.726638793945, 57075.06664085388, 54542.05351257324, 54979.573654174805, 51700.44681596756, 55795.74035835266, 51667.58012485504, 54577.77329158783, 53615.720083236694, 51465.05342102051, 50073.94009590149, 53988.740074157715, 50624.44005012512, 50851.02681350708, 55558.03325366974, 48869.86030960083, 53276.74018096924, 51793.06692028046, 52753.48667907715, 57196.50695800781, 53880.653557777405, 51404.89994716644, 53180.500005722046, 55418.46701812744, 50808.5931968689, 54736.78684234619, 49430.29999542236, 55698.34699630737, 54836.06019592285, 51420.613285541534, 47512.40678548813, 52729.553720235825, 55809.28666687012, 55702.353569984436, 50580.020122528076, 57349.30014038086, 50699.85329437256, 55718.600341796875, 54775.687131881714, 56017.066650390625, 54905.206855773926, 51964.60007476807, 52907.66010761261, 56522.680435180664, 54221.21319961548, 54956.70700073242, 53068.10021972656, 51822.846714019775, 52241.71347332001, 53667.433364868164, 49736.50673675537, 54852.97353553772, 52084.48679667711, 49725.9135055542, 54972.993156433105, 55046.266761779785, 50760.54674530029, 54037.50019836426, 54179.227078437805, 53089.33352661133, 51958.740171432495, 53585.246702194214, 52490.71991729736, 53804.22694396973, 49723.43347740173, 51672.94017791748, 47396.00663948059, 52319.480140686035, 52006.9600982666, 53739.639907836914, 53652.83364868164, 52247.980187654495, 54323.980419158936, 55007.333320617676, 55084.7999420166], "episode_lengths": [134, 135, 134, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 137, 136, 135, 136, 135, 135, 136, 135, 135, 136, 134, 136, 136, 135, 135, 135, 135, 137, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 134, 135, 135, 134, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 134, 135], "policy_agent_0_reward": [54583.486907958984, 55537.84044456482, 54345.573718070984, 51777.03348350525, 55408.78678894043, 49136.12022590637, 55447.440116882324, 52867.38681411743, 51601.48690414429, 53437.646900177, 52409.12017059326, 53582.66668701172, 54742.56010055542, 52266.126564741135, 56930.89358520508, 54240.31340789795, 54233.84017944336, 55688.726638793945, 57075.06664085388, 54542.05351257324, 54979.573654174805, 51700.44681596756, 55795.74035835266, 51667.58012485504, 54577.77329158783, 53615.720083236694, 51465.05342102051, 50073.94009590149, 53988.740074157715, 50624.44005012512, 50851.02681350708, 55558.03325366974, 48869.86030960083, 53276.74018096924, 51793.06692028046, 52753.48667907715, 57196.50695800781, 53880.653557777405, 51404.89994716644, 53180.500005722046, 55418.46701812744, 50808.5931968689, 54736.78684234619, 49430.29999542236, 55698.34699630737, 54836.06019592285, 51420.613285541534, 47512.40678548813, 52729.553720235825, 55809.28666687012, 55702.353569984436, 50580.020122528076, 57349.30014038086, 50699.85329437256, 55718.600341796875, 54775.687131881714, 56017.066650390625, 54905.206855773926, 51964.60007476807, 52907.66010761261, 56522.680435180664, 54221.21319961548, 54956.70700073242, 53068.10021972656, 51822.846714019775, 52241.71347332001, 53667.433364868164, 49736.50673675537, 54852.97353553772, 52084.48679667711, 49725.9135055542, 54972.993156433105, 55046.266761779785, 50760.54674530029, 54037.50019836426, 54179.227078437805, 53089.33352661133, 51958.740171432495, 53585.246702194214, 52490.71991729736, 53804.22694396973, 49723.43347740173, 51672.94017791748, 47396.00663948059, 52319.480140686035, 52006.9600982666, 53739.639907836914, 53652.83364868164, 52247.980187654495, 54323.980419158936, 55007.333320617676, 55084.7999420166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.490928628110986, "mean_inference_ms": 6.724269381783115, "mean_action_processing_ms": 0.20169939475754106, "mean_env_wait_ms": 226.2813742499017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0702238601187001, "StateBufferConnector_ms": 0.016766786575317383, "ViewRequirementAgentConnector_ms": 0.21182635556096616}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.69090797944983, "num_env_steps_trained_throughput_per_sec": 212.69090797944983, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 15969.298, "sample_time_ms": 11930.511, "learn_time_ms": 3885.618, "learn_throughput": 1029.437, "synch_weights_time_ms": 152.29}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 3100, "training_iteration": 107, "trial_id": "185f8_00000", "date": "2025-03-21_12-13-01", "timestamp": 1742559181, "time_this_iter_s": 18.856189489364624, "time_total_s": 1707.146965265274, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25ff6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1707.146965265274, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 94.41111111111111, "ram_util_percent": 13.688888888888888}}
{"custom_metrics": {"num_batches_mean": 5.125, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909387588500977, "policy_loss": -0.011898352764546871, "vf_loss": 9.919921875, "vf_explained_var": 1.0193635944233392e-06, "kl": 0.0068151261657476425, "entropy": 0.3912722170352936, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 57454.15340805054, "episode_reward_min": 46418.66677951813, "episode_reward_mean": 51689.89216039516, "episode_len_mean": 135.40625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46418.66677951813}, "policy_reward_max": {"agent_0": 57454.15340805054}, "policy_reward_mean": {"agent_0": 51689.89216039516}, "custom_metrics": {"num_batches_mean": 5.125, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54737.293323516846, 47740.55331516266, 53838.17344665527, 55704.513275146484, 49176.78014755249, 55404.04010391235, 48863.45318508148, 55446.51355552673, 51075.533334732056, 52225.76670074463, 46418.66677951813, 48735.83333969116, 54766.19354248047, 56300.22730255127, 50466.43340873718, 57454.15340805054, 47181.9666390419, 47336.85332584381, 54454.26662445068, 54919.380153656006, 50361.52664899826, 50543.70020657778, 48545.92007064819, 52018.50680923462, 46859.800028800964, 51349.73361778259, 55004.74669456482, 51956.326652526855, 52415.760091781616, 47796.660103321075, 53888.26002883911, 51089.01326751709], "episode_lengths": [135, 136, 136, 136, 136, 136, 135, 135, 137, 135, 136, 136, 135, 134, 135, 134, 136, 136, 134, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 136, 135, 135], "policy_agent_0_reward": [54737.293323516846, 47740.55331516266, 53838.17344665527, 55704.513275146484, 49176.78014755249, 55404.04010391235, 48863.45318508148, 55446.51355552673, 51075.533334732056, 52225.76670074463, 46418.66677951813, 48735.83333969116, 54766.19354248047, 56300.22730255127, 50466.43340873718, 57454.15340805054, 47181.9666390419, 47336.85332584381, 54454.26662445068, 54919.380153656006, 50361.52664899826, 50543.70020657778, 48545.92007064819, 52018.50680923462, 46859.800028800964, 51349.73361778259, 55004.74669456482, 51956.326652526855, 52415.760091781616, 47796.660103321075, 53888.26002883911, 51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.967438460650317, "mean_inference_ms": 6.384451417735717, "mean_action_processing_ms": 0.20169969778743063, "mean_env_wait_ms": 208.71315790342916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05514472723007202, "StateBufferConnector_ms": 0.006297975778579712, "ViewRequirementAgentConnector_ms": 0.23840218782424927}}, "episode_reward_max": 57454.15340805054, "episode_reward_min": 46418.66677951813, "episode_reward_mean": 51689.89216039516, "episode_len_mean": 135.40625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46418.66677951813}, "policy_reward_max": {"agent_0": 57454.15340805054}, "policy_reward_mean": {"agent_0": 51689.89216039516}, "hist_stats": {"episode_reward": [54737.293323516846, 47740.55331516266, 53838.17344665527, 55704.513275146484, 49176.78014755249, 55404.04010391235, 48863.45318508148, 55446.51355552673, 51075.533334732056, 52225.76670074463, 46418.66677951813, 48735.83333969116, 54766.19354248047, 56300.22730255127, 50466.43340873718, 57454.15340805054, 47181.9666390419, 47336.85332584381, 54454.26662445068, 54919.380153656006, 50361.52664899826, 50543.70020657778, 48545.92007064819, 52018.50680923462, 46859.800028800964, 51349.73361778259, 55004.74669456482, 51956.326652526855, 52415.760091781616, 47796.660103321075, 53888.26002883911, 51089.01326751709], "episode_lengths": [135, 136, 136, 136, 136, 136, 135, 135, 137, 135, 136, 136, 135, 134, 135, 134, 136, 136, 134, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 136, 135, 135], "policy_agent_0_reward": [54737.293323516846, 47740.55331516266, 53838.17344665527, 55704.513275146484, 49176.78014755249, 55404.04010391235, 48863.45318508148, 55446.51355552673, 51075.533334732056, 52225.76670074463, 46418.66677951813, 48735.83333969116, 54766.19354248047, 56300.22730255127, 50466.43340873718, 57454.15340805054, 47181.9666390419, 47336.85332584381, 54454.26662445068, 54919.380153656006, 50361.52664899826, 50543.70020657778, 48545.92007064819, 52018.50680923462, 46859.800028800964, 51349.73361778259, 55004.74669456482, 51956.326652526855, 52415.760091781616, 47796.660103321075, 53888.26002883911, 51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.967438460650317, "mean_inference_ms": 6.384451417735717, "mean_action_processing_ms": 0.20169969778743063, "mean_env_wait_ms": 208.71315790342916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05514472723007202, "StateBufferConnector_ms": 0.006297975778579712, "ViewRequirementAgentConnector_ms": 0.23840218782424927}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.5243297314912, "num_env_steps_trained_throughput_per_sec": 221.5243297314912, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 15990.813, "sample_time_ms": 11922.107, "learn_time_ms": 3911.146, "learn_throughput": 1022.718, "synch_weights_time_ms": 156.673}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 3132, "training_iteration": 108, "trial_id": "185f8_00000", "date": "2025-03-21_12-13-19", "timestamp": 1742559199, "time_this_iter_s": 18.112752199172974, "time_total_s": 1725.259717464447, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1725.259717464447, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.32608695652173, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989437103271484, "policy_loss": -0.011945643462240696, "vf_loss": 10.0, "vf_explained_var": -3.082677721977234e-07, "kl": 0.006909824442118406, "entropy": 0.38219043612480164, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 51089.01326751709, "episode_reward_min": 51089.01326751709, "episode_reward_mean": 51089.01326751709, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51089.01326751709}, "policy_reward_max": {"agent_0": 51089.01326751709}, "policy_reward_mean": {"agent_0": 51089.01326751709}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51089.01326751709], "episode_lengths": [135], "policy_agent_0_reward": [51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.20903294952521, "mean_inference_ms": 6.282407939852036, "mean_action_processing_ms": 0.19480376223528034, "mean_env_wait_ms": 208.01663137920107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1888275146484375}}, "episode_reward_max": 51089.01326751709, "episode_reward_min": 51089.01326751709, "episode_reward_mean": 51089.01326751709, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51089.01326751709}, "policy_reward_max": {"agent_0": 51089.01326751709}, "policy_reward_mean": {"agent_0": 51089.01326751709}, "hist_stats": {"episode_reward": [51089.01326751709], "episode_lengths": [135], "policy_agent_0_reward": [51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.20903294952521, "mean_inference_ms": 6.282407939852036, "mean_action_processing_ms": 0.19480376223528034, "mean_env_wait_ms": 208.01663137920107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1888275146484375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.05711832592937, "num_env_steps_trained_throughput_per_sec": 285.05711832592937, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 16014.438, "sample_time_ms": 11880.455, "learn_time_ms": 3977.882, "learn_throughput": 1005.56, "synch_weights_time_ms": 155.223}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 3132, "training_iteration": 109, "trial_id": "185f8_00000", "date": "2025-03-21_12-13-33", "timestamp": 1742559213, "time_this_iter_s": 14.092561483383179, "time_total_s": 1739.3522789478302, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1739.3522789478302, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.575, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98849105834961, "policy_loss": -0.012945439666509628, "vf_loss": 10.0, "vf_explained_var": 2.558032576871483e-07, "kl": 0.007178726606070995, "entropy": 0.3837282955646515, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 51089.01326751709, "episode_reward_min": 51089.01326751709, "episode_reward_mean": 51089.01326751709, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51089.01326751709}, "policy_reward_max": {"agent_0": 51089.01326751709}, "policy_reward_mean": {"agent_0": 51089.01326751709}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51089.01326751709], "episode_lengths": [135], "policy_agent_0_reward": [51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.20903294952521, "mean_inference_ms": 6.282407939852036, "mean_action_processing_ms": 0.19480376223528034, "mean_env_wait_ms": 208.01663137920107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1888275146484375}}, "episode_reward_max": 51089.01326751709, "episode_reward_min": 51089.01326751709, "episode_reward_mean": 51089.01326751709, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51089.01326751709}, "policy_reward_max": {"agent_0": 51089.01326751709}, "policy_reward_mean": {"agent_0": 51089.01326751709}, "hist_stats": {"episode_reward": [51089.01326751709], "episode_lengths": [135], "policy_agent_0_reward": [51089.01326751709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.20903294952521, "mean_inference_ms": 6.282407939852036, "mean_action_processing_ms": 0.19480376223528034, "mean_env_wait_ms": 208.01663137920107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1888275146484375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.22499202104916, "num_env_steps_trained_throughput_per_sec": 266.22499202104916, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 15960.317, "sample_time_ms": 11811.303, "learn_time_ms": 3987.471, "learn_throughput": 1003.142, "synch_weights_time_ms": 160.651}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 3132, "training_iteration": 110, "trial_id": "185f8_00000", "date": "2025-03-21_12-13-48", "timestamp": 1742559228, "time_this_iter_s": 15.07740592956543, "time_total_s": 1754.4296848773956, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1754.4296848773956, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 99.45909090909093, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.760379791259766, "policy_loss": -0.011506783775985241, "vf_loss": 9.770263671875, "vf_explained_var": 1.2882675264336285e-06, "kl": 0.00810948945581913, "entropy": 0.39401596784591675, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 58399.92672729492, "episode_reward_min": 47669.466650009155, "episode_reward_mean": 52872.063725547945, "episode_len_mean": 135.2391304347826, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47669.466650009155}, "policy_reward_max": {"agent_0": 58399.92672729492}, "policy_reward_mean": {"agent_0": 52872.063725547945}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55068.973556518555, 52631.22015762329, 52797.10683822632, 51831.90022468567, 50412.85330462456, 54882.39331817627, 55393.08020782471, 54479.466636657715, 50290.49338531494, 51659.59331512451, 50755.046825408936, 53778.82015609741, 52315.72691345215, 48096.45343208313, 51014.200160980225, 55379.74000287056, 50655.01345825195, 50551.27325081825, 52729.14698219299, 54443.366775512695, 51517.64042854309, 54031.886768341064, 53551.27365112305, 48169.00013542175, 50365.09348106384, 52788.40688419342, 55597.04016876221, 56116.466941833496, 53620.200454711914, 51732.69345664978, 53513.0666809082, 49978.99324798584, 54839.91366958618, 54888.32006072998, 54020.693756103516, 51675.613691329956, 51696.8733959198, 55041.4267578125, 54233.0534362793, 50129.46018028259, 47669.466650009155, 50634.10693359375, 50589.92691040039, 52310.53350639343, 51344.88700866699, 55250.11365509033, 58399.92672729492, 53441.780197143555, 52421.720138549805, 53720.44044685364, 49138.79348945618, 51232.11359500885, 56146.9201965332, 54590.106674194336, 54220.75370121002, 51793.8469543457, 50970.39339196682, 53683.533462524414, 53805.506744384766, 56053.71365356445, 50672.153507471085, 52238.53997898102, 53696.00012969971, 53476.8136548996, 55423.19342517853, 53547.24669837952, 53185.18006896973, 48057.64019489288, 51454.86027622223, 55811.76020812988, 56135.75991821289, 47786.27331829071, 53456.51365661621, 51496.58015346527, 53372.55339050293, 53903.67344665527, 54372.7071685791, 53412.52018737793, 54065.566833496094, 52190.76022720337, 49858.31378173828, 54280.61366271973, 55994.27346420288, 51278.38666820526, 54349.800048828125, 55345.553577423096, 54551.17388534546, 52150.84675216675, 55120.313720703125, 53189.99336862564, 55453.53366088867, 50809.19352912903], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 134, 135, 135, 135, 134, 136, 136, 136, 136, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55068.973556518555, 52631.22015762329, 52797.10683822632, 51831.90022468567, 50412.85330462456, 54882.39331817627, 55393.08020782471, 54479.466636657715, 50290.49338531494, 51659.59331512451, 50755.046825408936, 53778.82015609741, 52315.72691345215, 48096.45343208313, 51014.200160980225, 55379.74000287056, 50655.01345825195, 50551.27325081825, 52729.14698219299, 54443.366775512695, 51517.64042854309, 54031.886768341064, 53551.27365112305, 48169.00013542175, 50365.09348106384, 52788.40688419342, 55597.04016876221, 56116.466941833496, 53620.200454711914, 51732.69345664978, 53513.0666809082, 49978.99324798584, 54839.91366958618, 54888.32006072998, 54020.693756103516, 51675.613691329956, 51696.8733959198, 55041.4267578125, 54233.0534362793, 50129.46018028259, 47669.466650009155, 50634.10693359375, 50589.92691040039, 52310.53350639343, 51344.88700866699, 55250.11365509033, 58399.92672729492, 53441.780197143555, 52421.720138549805, 53720.44044685364, 49138.79348945618, 51232.11359500885, 56146.9201965332, 54590.106674194336, 54220.75370121002, 51793.8469543457, 50970.39339196682, 53683.533462524414, 53805.506744384766, 56053.71365356445, 50672.153507471085, 52238.53997898102, 53696.00012969971, 53476.8136548996, 55423.19342517853, 53547.24669837952, 53185.18006896973, 48057.64019489288, 51454.86027622223, 55811.76020812988, 56135.75991821289, 47786.27331829071, 53456.51365661621, 51496.58015346527, 53372.55339050293, 53903.67344665527, 54372.7071685791, 53412.52018737793, 54065.566833496094, 52190.76022720337, 49858.31378173828, 54280.61366271973, 55994.27346420288, 51278.38666820526, 54349.800048828125, 55345.553577423096, 54551.17388534546, 52150.84675216675, 55120.313720703125, 53189.99336862564, 55453.53366088867, 50809.19352912903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.586324045035184, "mean_inference_ms": 6.7188459794735085, "mean_action_processing_ms": 0.20144025543557956, "mean_env_wait_ms": 226.505975318516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07878541946411133, "StateBufferConnector_ms": 0.006354114283686099, "ViewRequirementAgentConnector_ms": 0.328588226567144}}, "episode_reward_max": 58399.92672729492, "episode_reward_min": 47669.466650009155, "episode_reward_mean": 52872.063725547945, "episode_len_mean": 135.2391304347826, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47669.466650009155}, "policy_reward_max": {"agent_0": 58399.92672729492}, "policy_reward_mean": {"agent_0": 52872.063725547945}, "hist_stats": {"episode_reward": [55068.973556518555, 52631.22015762329, 52797.10683822632, 51831.90022468567, 50412.85330462456, 54882.39331817627, 55393.08020782471, 54479.466636657715, 50290.49338531494, 51659.59331512451, 50755.046825408936, 53778.82015609741, 52315.72691345215, 48096.45343208313, 51014.200160980225, 55379.74000287056, 50655.01345825195, 50551.27325081825, 52729.14698219299, 54443.366775512695, 51517.64042854309, 54031.886768341064, 53551.27365112305, 48169.00013542175, 50365.09348106384, 52788.40688419342, 55597.04016876221, 56116.466941833496, 53620.200454711914, 51732.69345664978, 53513.0666809082, 49978.99324798584, 54839.91366958618, 54888.32006072998, 54020.693756103516, 51675.613691329956, 51696.8733959198, 55041.4267578125, 54233.0534362793, 50129.46018028259, 47669.466650009155, 50634.10693359375, 50589.92691040039, 52310.53350639343, 51344.88700866699, 55250.11365509033, 58399.92672729492, 53441.780197143555, 52421.720138549805, 53720.44044685364, 49138.79348945618, 51232.11359500885, 56146.9201965332, 54590.106674194336, 54220.75370121002, 51793.8469543457, 50970.39339196682, 53683.533462524414, 53805.506744384766, 56053.71365356445, 50672.153507471085, 52238.53997898102, 53696.00012969971, 53476.8136548996, 55423.19342517853, 53547.24669837952, 53185.18006896973, 48057.64019489288, 51454.86027622223, 55811.76020812988, 56135.75991821289, 47786.27331829071, 53456.51365661621, 51496.58015346527, 53372.55339050293, 53903.67344665527, 54372.7071685791, 53412.52018737793, 54065.566833496094, 52190.76022720337, 49858.31378173828, 54280.61366271973, 55994.27346420288, 51278.38666820526, 54349.800048828125, 55345.553577423096, 54551.17388534546, 52150.84675216675, 55120.313720703125, 53189.99336862564, 55453.53366088867, 50809.19352912903], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 134, 135, 135, 135, 134, 136, 136, 136, 136, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55068.973556518555, 52631.22015762329, 52797.10683822632, 51831.90022468567, 50412.85330462456, 54882.39331817627, 55393.08020782471, 54479.466636657715, 50290.49338531494, 51659.59331512451, 50755.046825408936, 53778.82015609741, 52315.72691345215, 48096.45343208313, 51014.200160980225, 55379.74000287056, 50655.01345825195, 50551.27325081825, 52729.14698219299, 54443.366775512695, 51517.64042854309, 54031.886768341064, 53551.27365112305, 48169.00013542175, 50365.09348106384, 52788.40688419342, 55597.04016876221, 56116.466941833496, 53620.200454711914, 51732.69345664978, 53513.0666809082, 49978.99324798584, 54839.91366958618, 54888.32006072998, 54020.693756103516, 51675.613691329956, 51696.8733959198, 55041.4267578125, 54233.0534362793, 50129.46018028259, 47669.466650009155, 50634.10693359375, 50589.92691040039, 52310.53350639343, 51344.88700866699, 55250.11365509033, 58399.92672729492, 53441.780197143555, 52421.720138549805, 53720.44044685364, 49138.79348945618, 51232.11359500885, 56146.9201965332, 54590.106674194336, 54220.75370121002, 51793.8469543457, 50970.39339196682, 53683.533462524414, 53805.506744384766, 56053.71365356445, 50672.153507471085, 52238.53997898102, 53696.00012969971, 53476.8136548996, 55423.19342517853, 53547.24669837952, 53185.18006896973, 48057.64019489288, 51454.86027622223, 55811.76020812988, 56135.75991821289, 47786.27331829071, 53456.51365661621, 51496.58015346527, 53372.55339050293, 53903.67344665527, 54372.7071685791, 53412.52018737793, 54065.566833496094, 52190.76022720337, 49858.31378173828, 54280.61366271973, 55994.27346420288, 51278.38666820526, 54349.800048828125, 55345.553577423096, 54551.17388534546, 52150.84675216675, 55120.313720703125, 53189.99336862564, 55453.53366088867, 50809.19352912903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.586324045035184, "mean_inference_ms": 6.7188459794735085, "mean_action_processing_ms": 0.20144025543557956, "mean_env_wait_ms": 226.505975318516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07878541946411133, "StateBufferConnector_ms": 0.006354114283686099, "ViewRequirementAgentConnector_ms": 0.328588226567144}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.48666753112258, "num_env_steps_trained_throughput_per_sec": 216.48666753112258, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 16438.55, "sample_time_ms": 12366.187, "learn_time_ms": 3905.617, "learn_throughput": 1024.166, "synch_weights_time_ms": 165.842}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 3224, "training_iteration": 111, "trial_id": "185f8_00000", "date": "2025-03-21_12-14-07", "timestamp": 1742559247, "time_this_iter_s": 18.52835178375244, "time_total_s": 1772.958036661148, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1772.958036661148, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 94.60384615384616, "ram_util_percent": 13.680769230769227}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910032272338867, "policy_loss": -0.012813298031687737, "vf_loss": 9.9208984375, "vf_explained_var": 1.0201086553252026e-07, "kl": 0.009735848754644394, "entropy": 0.41129428148269653, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 58015.6335144043, "episode_reward_min": 48211.74670267105, "episode_reward_mean": 52775.52203435078, "episode_len_mean": 135.21875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48211.74670267105}, "policy_reward_max": {"agent_0": 58015.6335144043}, "policy_reward_mean": {"agent_0": 52775.52203435078}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49609.860261917114, 54736.240058898926, 49688.953402519226, 57176.56016540527, 53666.21332550049, 53831.200147628784, 48211.74670267105, 52028.40699839592, 51235.08020019531, 54045.21356964111, 51363.260140419006, 58015.6335144043, 50757.69328260422, 51940.38014316559, 57388.49364566803, 51243.3136138916, 52834.42683792114, 50526.36034810543, 49537.64687347412, 52305.39357280731, 52085.02700424194, 53411.84693622589, 53600.61330699921, 50288.22007369995, 56011.12002944946, 52606.86719703674, 52592.0334444046, 53291.95339202881, 53725.11357879639, 51119.766715049744, 56401.460010528564, 53540.606605529785], "episode_lengths": [135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [49609.860261917114, 54736.240058898926, 49688.953402519226, 57176.56016540527, 53666.21332550049, 53831.200147628784, 48211.74670267105, 52028.40699839592, 51235.08020019531, 54045.21356964111, 51363.260140419006, 58015.6335144043, 50757.69328260422, 51940.38014316559, 57388.49364566803, 51243.3136138916, 52834.42683792114, 50526.36034810543, 49537.64687347412, 52305.39357280731, 52085.02700424194, 53411.84693622589, 53600.61330699921, 50288.22007369995, 56011.12002944946, 52606.86719703674, 52592.0334444046, 53291.95339202881, 53725.11357879639, 51119.766715049744, 56401.460010528564, 53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46440673949817, "mean_inference_ms": 6.391957654142368, "mean_action_processing_ms": 0.20147031155476097, "mean_env_wait_ms": 208.42332058793508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057731568813323975, "StateBufferConnector_ms": 0.006447732448577881, "ViewRequirementAgentConnector_ms": 0.20083412528038025}}, "episode_reward_max": 58015.6335144043, "episode_reward_min": 48211.74670267105, "episode_reward_mean": 52775.52203435078, "episode_len_mean": 135.21875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48211.74670267105}, "policy_reward_max": {"agent_0": 58015.6335144043}, "policy_reward_mean": {"agent_0": 52775.52203435078}, "hist_stats": {"episode_reward": [49609.860261917114, 54736.240058898926, 49688.953402519226, 57176.56016540527, 53666.21332550049, 53831.200147628784, 48211.74670267105, 52028.40699839592, 51235.08020019531, 54045.21356964111, 51363.260140419006, 58015.6335144043, 50757.69328260422, 51940.38014316559, 57388.49364566803, 51243.3136138916, 52834.42683792114, 50526.36034810543, 49537.64687347412, 52305.39357280731, 52085.02700424194, 53411.84693622589, 53600.61330699921, 50288.22007369995, 56011.12002944946, 52606.86719703674, 52592.0334444046, 53291.95339202881, 53725.11357879639, 51119.766715049744, 56401.460010528564, 53540.606605529785], "episode_lengths": [135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [49609.860261917114, 54736.240058898926, 49688.953402519226, 57176.56016540527, 53666.21332550049, 53831.200147628784, 48211.74670267105, 52028.40699839592, 51235.08020019531, 54045.21356964111, 51363.260140419006, 58015.6335144043, 50757.69328260422, 51940.38014316559, 57388.49364566803, 51243.3136138916, 52834.42683792114, 50526.36034810543, 49537.64687347412, 52305.39357280731, 52085.02700424194, 53411.84693622589, 53600.61330699921, 50288.22007369995, 56011.12002944946, 52606.86719703674, 52592.0334444046, 53291.95339202881, 53725.11357879639, 51119.766715049744, 56401.460010528564, 53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46440673949817, "mean_inference_ms": 6.391957654142368, "mean_action_processing_ms": 0.20147031155476097, "mean_env_wait_ms": 208.42332058793508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057731568813323975, "StateBufferConnector_ms": 0.006447732448577881, "ViewRequirementAgentConnector_ms": 0.20083412528038025}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.18519748999665, "num_env_steps_trained_throughput_per_sec": 212.18519748999665, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 16933.614, "sample_time_ms": 12745.387, "learn_time_ms": 3996.332, "learn_throughput": 1000.918, "synch_weights_time_ms": 190.997}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 3256, "training_iteration": 112, "trial_id": "185f8_00000", "date": "2025-03-21_12-14-26", "timestamp": 1742559266, "time_this_iter_s": 18.909283876419067, "time_total_s": 1791.8673205375671, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1791.8673205375671, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.25217391304349, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.990936279296875, "policy_loss": -0.010358467698097229, "vf_loss": 10.0, "vf_explained_var": 1.1672576505361576e-07, "kl": 0.006477327551692724, "entropy": 0.3486897051334381, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 53540.606605529785, "episode_reward_min": 53540.606605529785, "episode_reward_mean": 53540.606605529785, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53540.606605529785}, "policy_reward_max": {"agent_0": 53540.606605529785}, "policy_reward_mean": {"agent_0": 53540.606605529785}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53540.606605529785], "episode_lengths": [135], "policy_agent_0_reward": [53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.48340437984286, "mean_inference_ms": 6.265744022785215, "mean_action_processing_ms": 0.19457380869016477, "mean_env_wait_ms": 207.15719659747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19273757934570312, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1600027084350586}}, "episode_reward_max": 53540.606605529785, "episode_reward_min": 53540.606605529785, "episode_reward_mean": 53540.606605529785, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53540.606605529785}, "policy_reward_max": {"agent_0": 53540.606605529785}, "policy_reward_mean": {"agent_0": 53540.606605529785}, "hist_stats": {"episode_reward": [53540.606605529785], "episode_lengths": [135], "policy_agent_0_reward": [53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.48340437984286, "mean_inference_ms": 6.265744022785215, "mean_action_processing_ms": 0.19457380869016477, "mean_env_wait_ms": 207.15719659747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19273757934570312, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1600027084350586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.559246279462, "num_env_steps_trained_throughput_per_sec": 286.559246279462, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 16261.562, "sample_time_ms": 12068.392, "learn_time_ms": 4003.968, "learn_throughput": 999.009, "synch_weights_time_ms": 188.332}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 3256, "training_iteration": 113, "trial_id": "185f8_00000", "date": "2025-03-21_12-14-40", "timestamp": 1742559280, "time_this_iter_s": 14.006649017333984, "time_total_s": 1805.8739695549011, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24055a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1805.8739695549011, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.58500000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98680305480957, "policy_loss": -0.014719768427312374, "vf_loss": 10.0, "vf_explained_var": 3.9425987807817364e-08, "kl": 0.007615460082888603, "entropy": 0.37004223465919495, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 53540.606605529785, "episode_reward_min": 53540.606605529785, "episode_reward_mean": 53540.606605529785, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53540.606605529785}, "policy_reward_max": {"agent_0": 53540.606605529785}, "policy_reward_mean": {"agent_0": 53540.606605529785}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53540.606605529785], "episode_lengths": [135], "policy_agent_0_reward": [53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.48340437984286, "mean_inference_ms": 6.265744022785215, "mean_action_processing_ms": 0.19457380869016477, "mean_env_wait_ms": 207.15719659747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19273757934570312, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1600027084350586}}, "episode_reward_max": 53540.606605529785, "episode_reward_min": 53540.606605529785, "episode_reward_mean": 53540.606605529785, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53540.606605529785}, "policy_reward_max": {"agent_0": 53540.606605529785}, "policy_reward_mean": {"agent_0": 53540.606605529785}, "hist_stats": {"episode_reward": [53540.606605529785], "episode_lengths": [135], "policy_agent_0_reward": [53540.606605529785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.48340437984286, "mean_inference_ms": 6.265744022785215, "mean_action_processing_ms": 0.19457380869016477, "mean_env_wait_ms": 207.15719659747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19273757934570312, "StateBufferConnector_ms": 0.005602836608886719, "ViewRequirementAgentConnector_ms": 0.1600027084350586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.3955348167184, "num_env_steps_trained_throughput_per_sec": 281.3955348167184, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 15916.404, "sample_time_ms": 11672.445, "learn_time_ms": 4060.659, "learn_throughput": 985.062, "synch_weights_time_ms": 182.41}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 3256, "training_iteration": 114, "trial_id": "185f8_00000", "date": "2025-03-21_12-14-54", "timestamp": 1742559294, "time_this_iter_s": 14.258620500564575, "time_total_s": 1820.1325900554657, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25fd750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1820.1325900554657, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.68000000000002, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.758516311645508, "policy_loss": -0.013463697396218777, "vf_loss": 9.770263671875, "vf_explained_var": -4.7932068980571785e-08, "kl": 0.008583908900618553, "entropy": 0.37496647238731384, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 57501.87364196777, "episode_reward_min": 46879.573570251465, "episode_reward_mean": 52993.1618324949, "episode_len_mean": 135.2826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46879.573570251465}, "policy_reward_max": {"agent_0": 57501.87364196777}, "policy_reward_mean": {"agent_0": 52993.1618324949}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48105.160079956055, 53548.260288238525, 49147.16668319702, 53288.69352912903, 55626.12675476074, 52247.87333679199, 53609.80014038086, 50318.56009864807, 53651.687084198, 53748.046783447266, 49870.66703224182, 54956.65995025635, 51183.71353149414, 50976.48686122894, 56418.26679611206, 53721.97358703613, 52500.199966430664, 54680.220069885254, 52542.260051727295, 53098.66686248779, 51677.58029937744, 54462.480155944824, 55483.053606033325, 54253.31354522705, 56353.47361755371, 56754.120195388794, 54179.373348236084, 52364.086933135986, 52253.520080566406, 46879.573570251465, 52328.453411102295, 52615.14712524414, 51334.91366195679, 56935.873596191406, 53350.893590927124, 54386.34014892578, 53712.00682067871, 52771.006843566895, 51452.89337158203, 51206.273262023926, 55271.43382072449, 50309.006591796875, 55562.2470035553, 56981.8004989624, 54925.846839904785, 51927.680252075195, 50154.313613295555, 49689.4467420578, 54076.32010650635, 50879.60681724548, 50787.92009904981, 51583.32014846802, 57501.87364196777, 50592.38027381897, 48372.40020561218, 55631.80044937134, 50478.6601524353, 50182.83334350586, 51070.74034881592, 53026.30028152466, 54790.82681655884, 53151.506843566895, 52628.82046985626, 53451.58031845093, 54291.426849365234, 51580.31338310242, 56146.2998085022, 52183.286739349365, 56050.233489990234, 54966.52030706406, 55744.86686706543, 56164.83331298828, 53693.920097351074, 55055.413219451904, 53060.17362213135, 50458.65341949463, 53709.19337463379, 53602.54686546326, 53071.060119628906, 47927.33352088928, 50312.13342475891, 53816.60678100586, 51136.29336929321, 52936.73352432251, 55336.28676223755, 54655.1400680542, 55835.98021697998, 52049.90007400513, 54356.400230407715, 49022.6066532135, 55925.15353012085, 51258.04660797119], "episode_lengths": [136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 134, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 134, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 134, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [48105.160079956055, 53548.260288238525, 49147.16668319702, 53288.69352912903, 55626.12675476074, 52247.87333679199, 53609.80014038086, 50318.56009864807, 53651.687084198, 53748.046783447266, 49870.66703224182, 54956.65995025635, 51183.71353149414, 50976.48686122894, 56418.26679611206, 53721.97358703613, 52500.199966430664, 54680.220069885254, 52542.260051727295, 53098.66686248779, 51677.58029937744, 54462.480155944824, 55483.053606033325, 54253.31354522705, 56353.47361755371, 56754.120195388794, 54179.373348236084, 52364.086933135986, 52253.520080566406, 46879.573570251465, 52328.453411102295, 52615.14712524414, 51334.91366195679, 56935.873596191406, 53350.893590927124, 54386.34014892578, 53712.00682067871, 52771.006843566895, 51452.89337158203, 51206.273262023926, 55271.43382072449, 50309.006591796875, 55562.2470035553, 56981.8004989624, 54925.846839904785, 51927.680252075195, 50154.313613295555, 49689.4467420578, 54076.32010650635, 50879.60681724548, 50787.92009904981, 51583.32014846802, 57501.87364196777, 50592.38027381897, 48372.40020561218, 55631.80044937134, 50478.6601524353, 50182.83334350586, 51070.74034881592, 53026.30028152466, 54790.82681655884, 53151.506843566895, 52628.82046985626, 53451.58031845093, 54291.426849365234, 51580.31338310242, 56146.2998085022, 52183.286739349365, 56050.233489990234, 54966.52030706406, 55744.86686706543, 56164.83331298828, 53693.920097351074, 55055.413219451904, 53060.17362213135, 50458.65341949463, 53709.19337463379, 53602.54686546326, 53071.060119628906, 47927.33352088928, 50312.13342475891, 53816.60678100586, 51136.29336929321, 52936.73352432251, 55336.28676223755, 54655.1400680542, 55835.98021697998, 52049.90007400513, 54356.400230407715, 49022.6066532135, 55925.15353012085, 51258.04660797119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.56059451314023, "mean_inference_ms": 6.706880706184782, "mean_action_processing_ms": 0.20121113484050787, "mean_env_wait_ms": 226.68719677209657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04659839298414147, "StateBufferConnector_ms": 0.019117541935132897, "ViewRequirementAgentConnector_ms": 0.2058187256688657}}, "episode_reward_max": 57501.87364196777, "episode_reward_min": 46879.573570251465, "episode_reward_mean": 52993.1618324949, "episode_len_mean": 135.2826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46879.573570251465}, "policy_reward_max": {"agent_0": 57501.87364196777}, "policy_reward_mean": {"agent_0": 52993.1618324949}, "hist_stats": {"episode_reward": [48105.160079956055, 53548.260288238525, 49147.16668319702, 53288.69352912903, 55626.12675476074, 52247.87333679199, 53609.80014038086, 50318.56009864807, 53651.687084198, 53748.046783447266, 49870.66703224182, 54956.65995025635, 51183.71353149414, 50976.48686122894, 56418.26679611206, 53721.97358703613, 52500.199966430664, 54680.220069885254, 52542.260051727295, 53098.66686248779, 51677.58029937744, 54462.480155944824, 55483.053606033325, 54253.31354522705, 56353.47361755371, 56754.120195388794, 54179.373348236084, 52364.086933135986, 52253.520080566406, 46879.573570251465, 52328.453411102295, 52615.14712524414, 51334.91366195679, 56935.873596191406, 53350.893590927124, 54386.34014892578, 53712.00682067871, 52771.006843566895, 51452.89337158203, 51206.273262023926, 55271.43382072449, 50309.006591796875, 55562.2470035553, 56981.8004989624, 54925.846839904785, 51927.680252075195, 50154.313613295555, 49689.4467420578, 54076.32010650635, 50879.60681724548, 50787.92009904981, 51583.32014846802, 57501.87364196777, 50592.38027381897, 48372.40020561218, 55631.80044937134, 50478.6601524353, 50182.83334350586, 51070.74034881592, 53026.30028152466, 54790.82681655884, 53151.506843566895, 52628.82046985626, 53451.58031845093, 54291.426849365234, 51580.31338310242, 56146.2998085022, 52183.286739349365, 56050.233489990234, 54966.52030706406, 55744.86686706543, 56164.83331298828, 53693.920097351074, 55055.413219451904, 53060.17362213135, 50458.65341949463, 53709.19337463379, 53602.54686546326, 53071.060119628906, 47927.33352088928, 50312.13342475891, 53816.60678100586, 51136.29336929321, 52936.73352432251, 55336.28676223755, 54655.1400680542, 55835.98021697998, 52049.90007400513, 54356.400230407715, 49022.6066532135, 55925.15353012085, 51258.04660797119], "episode_lengths": [136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 134, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 134, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 134, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [48105.160079956055, 53548.260288238525, 49147.16668319702, 53288.69352912903, 55626.12675476074, 52247.87333679199, 53609.80014038086, 50318.56009864807, 53651.687084198, 53748.046783447266, 49870.66703224182, 54956.65995025635, 51183.71353149414, 50976.48686122894, 56418.26679611206, 53721.97358703613, 52500.199966430664, 54680.220069885254, 52542.260051727295, 53098.66686248779, 51677.58029937744, 54462.480155944824, 55483.053606033325, 54253.31354522705, 56353.47361755371, 56754.120195388794, 54179.373348236084, 52364.086933135986, 52253.520080566406, 46879.573570251465, 52328.453411102295, 52615.14712524414, 51334.91366195679, 56935.873596191406, 53350.893590927124, 54386.34014892578, 53712.00682067871, 52771.006843566895, 51452.89337158203, 51206.273262023926, 55271.43382072449, 50309.006591796875, 55562.2470035553, 56981.8004989624, 54925.846839904785, 51927.680252075195, 50154.313613295555, 49689.4467420578, 54076.32010650635, 50879.60681724548, 50787.92009904981, 51583.32014846802, 57501.87364196777, 50592.38027381897, 48372.40020561218, 55631.80044937134, 50478.6601524353, 50182.83334350586, 51070.74034881592, 53026.30028152466, 54790.82681655884, 53151.506843566895, 52628.82046985626, 53451.58031845093, 54291.426849365234, 51580.31338310242, 56146.2998085022, 52183.286739349365, 56050.233489990234, 54966.52030706406, 55744.86686706543, 56164.83331298828, 53693.920097351074, 55055.413219451904, 53060.17362213135, 50458.65341949463, 53709.19337463379, 53602.54686546326, 53071.060119628906, 47927.33352088928, 50312.13342475891, 53816.60678100586, 51136.29336929321, 52936.73352432251, 55336.28676223755, 54655.1400680542, 55835.98021697998, 52049.90007400513, 54356.400230407715, 49022.6066532135, 55925.15353012085, 51258.04660797119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.56059451314023, "mean_inference_ms": 6.706880706184782, "mean_action_processing_ms": 0.20121113484050787, "mean_env_wait_ms": 226.68719677209657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04659839298414147, "StateBufferConnector_ms": 0.019117541935132897, "ViewRequirementAgentConnector_ms": 0.2058187256688657}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.57455882066012, "num_env_steps_trained_throughput_per_sec": 207.57455882066012, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 16457.482, "sample_time_ms": 12195.75, "learn_time_ms": 4081.66, "learn_throughput": 979.993, "synch_weights_time_ms": 179.212}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 3348, "training_iteration": 115, "trial_id": "185f8_00000", "date": "2025-03-21_12-15-13", "timestamp": 1742559313, "time_this_iter_s": 19.344619512557983, "time_total_s": 1839.4772095680237, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a25fe7a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1839.4772095680237, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 95.9, "ram_util_percent": 13.69285714285714}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909513473510742, "policy_loss": -0.013212339021265507, "vf_loss": 9.921142578125, "vf_explained_var": 1.2125819637276436e-07, "kl": 0.00791356060653925, "entropy": 0.3631889224052429, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 56880.64011383057, "episode_reward_min": 47981.366819381714, "episode_reward_mean": 53066.154705926776, "episode_len_mean": 135.1875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47981.366819381714}, "policy_reward_max": {"agent_0": 56880.64011383057}, "policy_reward_mean": {"agent_0": 53066.154705926776}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53622.680042266846, 56560.747161865234, 53290.39354515076, 56158.86023712158, 55671.73356819153, 52315.3133354187, 53870.11981964111, 54405.12007904053, 53994.473541259766, 56880.64011383057, 52750.959815979004, 48303.34680080414, 54938.44667053223, 47981.366819381714, 52174.593605041504, 50521.72028541565, 54259.59351539612, 55330.66011810303, 55468.680099487305, 55548.18672180176, 50858.77361869812, 54225.97995567322, 48292.75355052948, 51840.766819000244, 55858.29341888428, 54013.953342437744, 51895.96033477783, 52807.88005065918, 51911.00670957565, 49191.286668777466, 52362.3935546875, 50810.26667022705], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 134, 136], "policy_agent_0_reward": [53622.680042266846, 56560.747161865234, 53290.39354515076, 56158.86023712158, 55671.73356819153, 52315.3133354187, 53870.11981964111, 54405.12007904053, 53994.473541259766, 56880.64011383057, 52750.959815979004, 48303.34680080414, 54938.44667053223, 47981.366819381714, 52174.593605041504, 50521.72028541565, 54259.59351539612, 55330.66011810303, 55468.680099487305, 55548.18672180176, 50858.77361869812, 54225.97995567322, 48292.75355052948, 51840.766819000244, 55858.29341888428, 54013.953342437744, 51895.96033477783, 52807.88005065918, 51911.00670957565, 49191.286668777466, 52362.3935546875, 50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.661920147282736, "mean_inference_ms": 6.3895967570818195, "mean_action_processing_ms": 0.20151180413411285, "mean_env_wait_ms": 208.54001857299477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04235878586769104, "StateBufferConnector_ms": 0.03146752715110779, "ViewRequirementAgentConnector_ms": 0.36676153540611267}}, "episode_reward_max": 56880.64011383057, "episode_reward_min": 47981.366819381714, "episode_reward_mean": 53066.154705926776, "episode_len_mean": 135.1875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47981.366819381714}, "policy_reward_max": {"agent_0": 56880.64011383057}, "policy_reward_mean": {"agent_0": 53066.154705926776}, "hist_stats": {"episode_reward": [53622.680042266846, 56560.747161865234, 53290.39354515076, 56158.86023712158, 55671.73356819153, 52315.3133354187, 53870.11981964111, 54405.12007904053, 53994.473541259766, 56880.64011383057, 52750.959815979004, 48303.34680080414, 54938.44667053223, 47981.366819381714, 52174.593605041504, 50521.72028541565, 54259.59351539612, 55330.66011810303, 55468.680099487305, 55548.18672180176, 50858.77361869812, 54225.97995567322, 48292.75355052948, 51840.766819000244, 55858.29341888428, 54013.953342437744, 51895.96033477783, 52807.88005065918, 51911.00670957565, 49191.286668777466, 52362.3935546875, 50810.26667022705], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 134, 136], "policy_agent_0_reward": [53622.680042266846, 56560.747161865234, 53290.39354515076, 56158.86023712158, 55671.73356819153, 52315.3133354187, 53870.11981964111, 54405.12007904053, 53994.473541259766, 56880.64011383057, 52750.959815979004, 48303.34680080414, 54938.44667053223, 47981.366819381714, 52174.593605041504, 50521.72028541565, 54259.59351539612, 55330.66011810303, 55468.680099487305, 55548.18672180176, 50858.77361869812, 54225.97995567322, 48292.75355052948, 51840.766819000244, 55858.29341888428, 54013.953342437744, 51895.96033477783, 52807.88005065918, 51911.00670957565, 49191.286668777466, 52362.3935546875, 50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.661920147282736, "mean_inference_ms": 6.3895967570818195, "mean_action_processing_ms": 0.20151180413411285, "mean_env_wait_ms": 208.54001857299477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04235878586769104, "StateBufferConnector_ms": 0.03146752715110779, "ViewRequirementAgentConnector_ms": 0.36676153540611267}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.49742183675752, "num_env_steps_trained_throughput_per_sec": 232.49742183675752, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 16789.65, "sample_time_ms": 12520.944, "learn_time_ms": 4085.554, "learn_throughput": 979.059, "synch_weights_time_ms": 182.277}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 3380, "training_iteration": 116, "trial_id": "185f8_00000", "date": "2025-03-21_12-15-31", "timestamp": 1742559331, "time_this_iter_s": 17.27346706390381, "time_total_s": 1856.7506766319275, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2405fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1856.7506766319275, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.33333333333333, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98787784576416, "policy_loss": -0.013509734533727169, "vf_loss": 10.0, "vf_explained_var": 1.6037374450661446e-07, "kl": 0.006936442572623491, "entropy": 0.3749118745326996, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 50810.26667022705, "episode_reward_min": 50810.26667022705, "episode_reward_mean": 50810.26667022705, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50810.26667022705}, "policy_reward_max": {"agent_0": 50810.26667022705}, "policy_reward_mean": {"agent_0": 50810.26667022705}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50810.26667022705], "episode_lengths": [136], "policy_agent_0_reward": [50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.94503629659044, "mean_inference_ms": 6.323706297377564, "mean_action_processing_ms": 0.19432782940031437, "mean_env_wait_ms": 207.3990826695169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719329833984375, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16410350799560547}}, "episode_reward_max": 50810.26667022705, "episode_reward_min": 50810.26667022705, "episode_reward_mean": 50810.26667022705, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50810.26667022705}, "policy_reward_max": {"agent_0": 50810.26667022705}, "policy_reward_mean": {"agent_0": 50810.26667022705}, "hist_stats": {"episode_reward": [50810.26667022705], "episode_lengths": [136], "policy_agent_0_reward": [50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.94503629659044, "mean_inference_ms": 6.323706297377564, "mean_action_processing_ms": 0.19432782940031437, "mean_env_wait_ms": 207.3990826695169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719329833984375, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16410350799560547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.22589433984285, "num_env_steps_trained_throughput_per_sec": 277.22589433984285, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 16351.85, "sample_time_ms": 12049.949, "learn_time_ms": 4111.327, "learn_throughput": 972.922, "synch_weights_time_ms": 189.689}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 3380, "training_iteration": 117, "trial_id": "185f8_00000", "date": "2025-03-21_12-15-45", "timestamp": 1742559345, "time_this_iter_s": 14.491098880767822, "time_total_s": 1871.2417755126953, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1871.2417755126953, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.57000000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9865140914917, "policy_loss": -0.01261097751557827, "vf_loss": 9.99755859375, "vf_explained_var": -8.729596601142475e-08, "kl": 0.007830948568880558, "entropy": 0.37634602189064026, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 50810.26667022705, "episode_reward_min": 50810.26667022705, "episode_reward_mean": 50810.26667022705, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50810.26667022705}, "policy_reward_max": {"agent_0": 50810.26667022705}, "policy_reward_mean": {"agent_0": 50810.26667022705}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50810.26667022705], "episode_lengths": [136], "policy_agent_0_reward": [50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.94503629659044, "mean_inference_ms": 6.323706297377564, "mean_action_processing_ms": 0.19432782940031437, "mean_env_wait_ms": 207.3990826695169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719329833984375, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16410350799560547}}, "episode_reward_max": 50810.26667022705, "episode_reward_min": 50810.26667022705, "episode_reward_mean": 50810.26667022705, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50810.26667022705}, "policy_reward_max": {"agent_0": 50810.26667022705}, "policy_reward_mean": {"agent_0": 50810.26667022705}, "hist_stats": {"episode_reward": [50810.26667022705], "episode_lengths": [136], "policy_agent_0_reward": [50810.26667022705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.94503629659044, "mean_inference_ms": 6.323706297377564, "mean_action_processing_ms": 0.19432782940031437, "mean_env_wait_ms": 207.3990826695169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719329833984375, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.16410350799560547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.4972896873937, "num_env_steps_trained_throughput_per_sec": 276.4972896873937, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 15992.847, "sample_time_ms": 11634.498, "learn_time_ms": 4166.646, "learn_throughput": 960.005, "synch_weights_time_ms": 190.798}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 3380, "training_iteration": 118, "trial_id": "185f8_00000", "date": "2025-03-21_12-16-00", "timestamp": 1742559360, "time_this_iter_s": 14.521504163742065, "time_total_s": 1885.7632796764374, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24056c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1885.7632796764374, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.51904761904764, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.810304641723633, "policy_loss": -0.013409614562988281, "vf_loss": 9.822021484375, "vf_explained_var": -1.7446775757434807e-07, "kl": 0.008460462093353271, "entropy": 0.40524420142173767, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 57030.66026306152, "episode_reward_min": 44621.62001991272, "episode_reward_mean": 52761.21516099655, "episode_len_mean": 135.23611111111111, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {"agent_0": 44621.62001991272}, "policy_reward_max": {"agent_0": 57030.66026306152}, "policy_reward_mean": {"agent_0": 52761.21516099655}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55874.36668777466, 54229.04672431946, 50057.22028708458, 54652.12679672241, 51060.04691028595, 53724.56016921997, 53669.27993774414, 52673.51350021362, 52745.89986419678, 46839.46030139923, 51828.6799621582, 54725.94029998779, 54825.31332778931, 55172.28665161133, 55380.22034072876, 44621.62001991272, 55843.693437576294, 51242.473388671875, 52070.70687675476, 56124.413440704346, 52896.61333656311, 54567.46022796631, 49371.053565979004, 54955.70673751831, 52343.993392944336, 57024.73352813721, 53504.040267944336, 54119.08699417114, 52935.32025909424, 51048.52688598633, 52201.60702705383, 54201.88680177927, 55254.42021179199, 52842.30040550232, 55707.83347320557, 56478.280349731445, 55691.68005371094, 46956.92678833008, 55231.04023742676, 52600.92669868469, 53109.99355125427, 57030.66026306152, 50870.21988296509, 50830.60036277771, 46158.60664558411, 55184.69357299805, 52577.84014129639, 56985.80704498291, 47625.56038093567, 50989.55358505249, 50996.1801776886, 47790.21339178085, 51757.15357589722, 54276.40016937256, 53640.8136138916, 51065.82001495361, 47848.59342765808, 55958.933601379395, 55456.18655395508, 52691.80031013489, 55246.37364578247, 51532.26026916504, 51725.63334941864, 54702.82024002075, 50951.70032310486, 51586.900195121765, 47893.52686023712, 52882.313119888306, 51234.74008560181, 53423.28676986694, 53486.840240478516, 54001.16005706787], "episode_lengths": [135, 134, 135, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 136, 137, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55874.36668777466, 54229.04672431946, 50057.22028708458, 54652.12679672241, 51060.04691028595, 53724.56016921997, 53669.27993774414, 52673.51350021362, 52745.89986419678, 46839.46030139923, 51828.6799621582, 54725.94029998779, 54825.31332778931, 55172.28665161133, 55380.22034072876, 44621.62001991272, 55843.693437576294, 51242.473388671875, 52070.70687675476, 56124.413440704346, 52896.61333656311, 54567.46022796631, 49371.053565979004, 54955.70673751831, 52343.993392944336, 57024.73352813721, 53504.040267944336, 54119.08699417114, 52935.32025909424, 51048.52688598633, 52201.60702705383, 54201.88680177927, 55254.42021179199, 52842.30040550232, 55707.83347320557, 56478.280349731445, 55691.68005371094, 46956.92678833008, 55231.04023742676, 52600.92669868469, 53109.99355125427, 57030.66026306152, 50870.21988296509, 50830.60036277771, 46158.60664558411, 55184.69357299805, 52577.84014129639, 56985.80704498291, 47625.56038093567, 50989.55358505249, 50996.1801776886, 47790.21339178085, 51757.15357589722, 54276.40016937256, 53640.8136138916, 51065.82001495361, 47848.59342765808, 55958.933601379395, 55456.18655395508, 52691.80031013489, 55246.37364578247, 51532.26026916504, 51725.63334941864, 54702.82024002075, 50951.70032310486, 51586.900195121765, 47893.52686023712, 52882.313119888306, 51234.74008560181, 53423.28676986694, 53486.840240478516, 54001.16005706787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.256075886402314, "mean_inference_ms": 6.69816035602047, "mean_action_processing_ms": 0.20113225902087672, "mean_env_wait_ms": 227.28385456206968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408348109987047, "StateBufferConnector_ms": 0.006746583514743381, "ViewRequirementAgentConnector_ms": 0.2837293677859836}}, "episode_reward_max": 57030.66026306152, "episode_reward_min": 44621.62001991272, "episode_reward_mean": 52761.21516099655, "episode_len_mean": 135.23611111111111, "episodes_this_iter": 72, "policy_reward_min": {"agent_0": 44621.62001991272}, "policy_reward_max": {"agent_0": 57030.66026306152}, "policy_reward_mean": {"agent_0": 52761.21516099655}, "hist_stats": {"episode_reward": [55874.36668777466, 54229.04672431946, 50057.22028708458, 54652.12679672241, 51060.04691028595, 53724.56016921997, 53669.27993774414, 52673.51350021362, 52745.89986419678, 46839.46030139923, 51828.6799621582, 54725.94029998779, 54825.31332778931, 55172.28665161133, 55380.22034072876, 44621.62001991272, 55843.693437576294, 51242.473388671875, 52070.70687675476, 56124.413440704346, 52896.61333656311, 54567.46022796631, 49371.053565979004, 54955.70673751831, 52343.993392944336, 57024.73352813721, 53504.040267944336, 54119.08699417114, 52935.32025909424, 51048.52688598633, 52201.60702705383, 54201.88680177927, 55254.42021179199, 52842.30040550232, 55707.83347320557, 56478.280349731445, 55691.68005371094, 46956.92678833008, 55231.04023742676, 52600.92669868469, 53109.99355125427, 57030.66026306152, 50870.21988296509, 50830.60036277771, 46158.60664558411, 55184.69357299805, 52577.84014129639, 56985.80704498291, 47625.56038093567, 50989.55358505249, 50996.1801776886, 47790.21339178085, 51757.15357589722, 54276.40016937256, 53640.8136138916, 51065.82001495361, 47848.59342765808, 55958.933601379395, 55456.18655395508, 52691.80031013489, 55246.37364578247, 51532.26026916504, 51725.63334941864, 54702.82024002075, 50951.70032310486, 51586.900195121765, 47893.52686023712, 52882.313119888306, 51234.74008560181, 53423.28676986694, 53486.840240478516, 54001.16005706787], "episode_lengths": [135, 134, 135, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 136, 137, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55874.36668777466, 54229.04672431946, 50057.22028708458, 54652.12679672241, 51060.04691028595, 53724.56016921997, 53669.27993774414, 52673.51350021362, 52745.89986419678, 46839.46030139923, 51828.6799621582, 54725.94029998779, 54825.31332778931, 55172.28665161133, 55380.22034072876, 44621.62001991272, 55843.693437576294, 51242.473388671875, 52070.70687675476, 56124.413440704346, 52896.61333656311, 54567.46022796631, 49371.053565979004, 54955.70673751831, 52343.993392944336, 57024.73352813721, 53504.040267944336, 54119.08699417114, 52935.32025909424, 51048.52688598633, 52201.60702705383, 54201.88680177927, 55254.42021179199, 52842.30040550232, 55707.83347320557, 56478.280349731445, 55691.68005371094, 46956.92678833008, 55231.04023742676, 52600.92669868469, 53109.99355125427, 57030.66026306152, 50870.21988296509, 50830.60036277771, 46158.60664558411, 55184.69357299805, 52577.84014129639, 56985.80704498291, 47625.56038093567, 50989.55358505249, 50996.1801776886, 47790.21339178085, 51757.15357589722, 54276.40016937256, 53640.8136138916, 51065.82001495361, 47848.59342765808, 55958.933601379395, 55456.18655395508, 52691.80031013489, 55246.37364578247, 51532.26026916504, 51725.63334941864, 54702.82024002075, 50951.70032310486, 51586.900195121765, 47893.52686023712, 52882.313119888306, 51234.74008560181, 53423.28676986694, 53486.840240478516, 54001.16005706787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.256075886402314, "mean_inference_ms": 6.69816035602047, "mean_action_processing_ms": 0.20113225902087672, "mean_env_wait_ms": 227.28385456206968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408348109987047, "StateBufferConnector_ms": 0.006746583514743381, "ViewRequirementAgentConnector_ms": 0.2837293677859836}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.76090397960388, "num_env_steps_trained_throughput_per_sec": 241.76090397960388, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 16244.145, "sample_time_ms": 11953.903, "learn_time_ms": 4098.065, "learn_throughput": 976.07, "synch_weights_time_ms": 191.297}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 3452, "training_iteration": 119, "trial_id": "185f8_00000", "date": "2025-03-21_12-16-16", "timestamp": 1742559376, "time_this_iter_s": 16.592400312423706, "time_total_s": 1902.355679988861, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1902.355679988861, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 94.13478260869564, "ram_util_percent": 13.695652173913041}}
{"custom_metrics": {"num_batches_mean": 5.384615384615385, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.855425834655762, "policy_loss": -0.011843184940516949, "vf_loss": 9.86572265625, "vf_explained_var": 6.140520270037086e-08, "kl": 0.0077292402274906635, "entropy": 0.37896081805229187, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 57598.099952697754, "episode_reward_min": 44595.76678133011, "episode_reward_mean": 52357.929231680355, "episode_len_mean": 135.19230769230768, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"agent_0": 44595.76678133011}, "policy_reward_max": {"agent_0": 57598.099952697754}, "policy_reward_mean": {"agent_0": 52357.929231680355}, "custom_metrics": {"num_batches_mean": 5.384615384615385, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [47813.60684013367, 55236.92008471489, 52744.36010551453, 55051.786933898926, 52364.833477020264, 48679.16694831848, 57581.10682678223, 53849.673513412476, 48797.91347980499, 52226.600133895874, 50812.54031777382, 48780.08017921448, 53529.09373474121, 52467.346771240234, 51245.0935382843, 54769.09335899353, 55162.780212402344, 54260.3870010376, 51316.75997161865, 54450.87342262268, 54483.41356754303, 44595.76678133011, 56035.86016082764, 47000.380272865295, 52678.313445568085, 51389.66025352478, 54301.94672203064, 54561.420013427734, 54783.31354522705, 54478.853424072266, 50972.42014312744, 53785.16690444946, 55350.8134765625, 54349.50660324097, 46802.98675823212, 50687.520038604736, 52462.12014770508, 50993.69325733185, 56679.406814575195, 48709.659996032715, 46475.21326160431, 50939.03338432312, 48160.88694000244, 57502.42677307129, 54301.753452301025, 48942.40022754669, 53893.333293914795, 54130.42682647705, 55692.24668121338, 52752.560119628906, 57598.099952697754, 45981.69995689392], "episode_lengths": [136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 134, 136, 136, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [47813.60684013367, 55236.92008471489, 52744.36010551453, 55051.786933898926, 52364.833477020264, 48679.16694831848, 57581.10682678223, 53849.673513412476, 48797.91347980499, 52226.600133895874, 50812.54031777382, 48780.08017921448, 53529.09373474121, 52467.346771240234, 51245.0935382843, 54769.09335899353, 55162.780212402344, 54260.3870010376, 51316.75997161865, 54450.87342262268, 54483.41356754303, 44595.76678133011, 56035.86016082764, 47000.380272865295, 52678.313445568085, 51389.66025352478, 54301.94672203064, 54561.420013427734, 54783.31354522705, 54478.853424072266, 50972.42014312744, 53785.16690444946, 55350.8134765625, 54349.50660324097, 46802.98675823212, 50687.520038604736, 52462.12014770508, 50993.69325733185, 56679.406814575195, 48709.659996032715, 46475.21326160431, 50939.03338432312, 48160.88694000244, 57502.42677307129, 54301.753452301025, 48942.40022754669, 53893.333293914795, 54130.42682647705, 55692.24668121338, 52752.560119628906, 57598.099952697754, 45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.514385103059695, "mean_inference_ms": 6.5522686963325025, "mean_action_processing_ms": 0.20120658885108694, "mean_env_wait_ms": 215.5902444458606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049529167322012096, "StateBufferConnector_ms": 0.006234187346238356, "ViewRequirementAgentConnector_ms": 0.2807438373565674}}, "episode_reward_max": 57598.099952697754, "episode_reward_min": 44595.76678133011, "episode_reward_mean": 52357.929231680355, "episode_len_mean": 135.19230769230768, "episodes_this_iter": 52, "policy_reward_min": {"agent_0": 44595.76678133011}, "policy_reward_max": {"agent_0": 57598.099952697754}, "policy_reward_mean": {"agent_0": 52357.929231680355}, "hist_stats": {"episode_reward": [47813.60684013367, 55236.92008471489, 52744.36010551453, 55051.786933898926, 52364.833477020264, 48679.16694831848, 57581.10682678223, 53849.673513412476, 48797.91347980499, 52226.600133895874, 50812.54031777382, 48780.08017921448, 53529.09373474121, 52467.346771240234, 51245.0935382843, 54769.09335899353, 55162.780212402344, 54260.3870010376, 51316.75997161865, 54450.87342262268, 54483.41356754303, 44595.76678133011, 56035.86016082764, 47000.380272865295, 52678.313445568085, 51389.66025352478, 54301.94672203064, 54561.420013427734, 54783.31354522705, 54478.853424072266, 50972.42014312744, 53785.16690444946, 55350.8134765625, 54349.50660324097, 46802.98675823212, 50687.520038604736, 52462.12014770508, 50993.69325733185, 56679.406814575195, 48709.659996032715, 46475.21326160431, 50939.03338432312, 48160.88694000244, 57502.42677307129, 54301.753452301025, 48942.40022754669, 53893.333293914795, 54130.42682647705, 55692.24668121338, 52752.560119628906, 57598.099952697754, 45981.69995689392], "episode_lengths": [136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 134, 136, 136, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [47813.60684013367, 55236.92008471489, 52744.36010551453, 55051.786933898926, 52364.833477020264, 48679.16694831848, 57581.10682678223, 53849.673513412476, 48797.91347980499, 52226.600133895874, 50812.54031777382, 48780.08017921448, 53529.09373474121, 52467.346771240234, 51245.0935382843, 54769.09335899353, 55162.780212402344, 54260.3870010376, 51316.75997161865, 54450.87342262268, 54483.41356754303, 44595.76678133011, 56035.86016082764, 47000.380272865295, 52678.313445568085, 51389.66025352478, 54301.94672203064, 54561.420013427734, 54783.31354522705, 54478.853424072266, 50972.42014312744, 53785.16690444946, 55350.8134765625, 54349.50660324097, 46802.98675823212, 50687.520038604736, 52462.12014770508, 50993.69325733185, 56679.406814575195, 48709.659996032715, 46475.21326160431, 50939.03338432312, 48160.88694000244, 57502.42677307129, 54301.753452301025, 48942.40022754669, 53893.333293914795, 54130.42682647705, 55692.24668121338, 52752.560119628906, 57598.099952697754, 45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.514385103059695, "mean_inference_ms": 6.5522686963325025, "mean_action_processing_ms": 0.20120658885108694, "mean_env_wait_ms": 215.5902444458606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049529167322012096, "StateBufferConnector_ms": 0.006234187346238356, "ViewRequirementAgentConnector_ms": 0.2807438373565674}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.4517685123887, "num_env_steps_trained_throughput_per_sec": 199.4517685123887, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 16747.148, "sample_time_ms": 12471.305, "learn_time_ms": 4083.886, "learn_throughput": 979.459, "synch_weights_time_ms": 191.112}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 3504, "training_iteration": 120, "trial_id": "185f8_00000", "date": "2025-03-21_12-16-37", "timestamp": 1742559397, "time_this_iter_s": 20.11700701713562, "time_total_s": 1922.4726870059967, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2404550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1922.4726870059967, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 98.94444444444444, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.991251945495605, "policy_loss": -0.010161063633859158, "vf_loss": 10.0, "vf_explained_var": -8.6923440667519e-10, "kl": 0.007065584417432547, "entropy": 0.3874076008796692, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 45981.69995689392, "episode_reward_min": 45981.69995689392, "episode_reward_mean": 45981.69995689392, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45981.69995689392}, "policy_reward_max": {"agent_0": 45981.69995689392}, "policy_reward_mean": {"agent_0": 45981.69995689392}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [45981.69995689392], "episode_lengths": [135], "policy_agent_0_reward": [45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.74160640868505, "mean_inference_ms": 6.5190601522678575, "mean_action_processing_ms": 0.1981159077122695, "mean_env_wait_ms": 220.8371990455125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1325368881225586, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.15692710876464844}}, "episode_reward_max": 45981.69995689392, "episode_reward_min": 45981.69995689392, "episode_reward_mean": 45981.69995689392, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45981.69995689392}, "policy_reward_max": {"agent_0": 45981.69995689392}, "policy_reward_mean": {"agent_0": 45981.69995689392}, "hist_stats": {"episode_reward": [45981.69995689392], "episode_lengths": [135], "policy_agent_0_reward": [45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.74160640868505, "mean_inference_ms": 6.5190601522678575, "mean_action_processing_ms": 0.1981159077122695, "mean_env_wait_ms": 220.8371990455125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1325368881225586, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.15692710876464844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.82779214447214, "num_env_steps_trained_throughput_per_sec": 274.82779214447214, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 16354.916, "sample_time_ms": 11974.155, "learn_time_ms": 4190.791, "learn_throughput": 954.474, "synch_weights_time_ms": 189.156}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 3504, "training_iteration": 121, "trial_id": "185f8_00000", "date": "2025-03-21_12-16-51", "timestamp": 1742559411, "time_this_iter_s": 14.60801911354065, "time_total_s": 1937.0807061195374, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2405fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1937.0807061195374, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.56190476190477, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984992027282715, "policy_loss": -0.01690719462931156, "vf_loss": 10.0, "vf_explained_var": 5.786617762737478e-08, "kl": 0.009500495158135891, "entropy": 0.44254544377326965, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 45981.69995689392, "episode_reward_min": 45981.69995689392, "episode_reward_mean": 45981.69995689392, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45981.69995689392}, "policy_reward_max": {"agent_0": 45981.69995689392}, "policy_reward_mean": {"agent_0": 45981.69995689392}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [45981.69995689392], "episode_lengths": [135], "policy_agent_0_reward": [45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.74160640868505, "mean_inference_ms": 6.5190601522678575, "mean_action_processing_ms": 0.1981159077122695, "mean_env_wait_ms": 220.8371990455125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1325368881225586, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.15692710876464844}}, "episode_reward_max": 45981.69995689392, "episode_reward_min": 45981.69995689392, "episode_reward_mean": 45981.69995689392, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 45981.69995689392}, "policy_reward_max": {"agent_0": 45981.69995689392}, "policy_reward_mean": {"agent_0": 45981.69995689392}, "hist_stats": {"episode_reward": [45981.69995689392], "episode_lengths": [135], "policy_agent_0_reward": [45981.69995689392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.74160640868505, "mean_inference_ms": 6.5190601522678575, "mean_action_processing_ms": 0.1981159077122695, "mean_env_wait_ms": 220.8371990455125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1325368881225586, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.15692710876464844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.4794780430558, "num_env_steps_trained_throughput_per_sec": 268.4794780430558, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 15959.643, "sample_time_ms": 11583.451, "learn_time_ms": 4210.387, "learn_throughput": 950.031, "synch_weights_time_ms": 164.963}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 3504, "training_iteration": 122, "trial_id": "185f8_00000", "date": "2025-03-21_12-17-06", "timestamp": 1742559426, "time_this_iter_s": 14.950160026550293, "time_total_s": 1952.0308661460876, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24057e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1952.0308661460876, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.4857142857143, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.978657722473145, "policy_loss": -0.012964075431227684, "vf_loss": 9.989990234375, "vf_explained_var": -2.582867963951685e-08, "kl": 0.008151978254318237, "entropy": 0.43232467770576477, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 54484.46021652222, "episode_reward_min": 51679.313415527344, "episode_reward_mean": 53560.805035591125, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 51679.313415527344}, "policy_reward_max": {"agent_0": 54484.46021652222}, "policy_reward_mean": {"agent_0": 53560.805035591125}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53685.566566467285, 54393.879943847656, 54484.46021652222, 51679.313415527344], "episode_lengths": [135, 135, 135, 135], "policy_agent_0_reward": [53685.566566467285, 54393.879943847656, 54484.46021652222, 51679.313415527344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.34994712480289, "mean_inference_ms": 6.544581533295871, "mean_action_processing_ms": 0.20249027087962773, "mean_env_wait_ms": 226.15556210347592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03892183303833008, "StateBufferConnector_ms": 0.006234645843505859, "ViewRequirementAgentConnector_ms": 0.16460418701171875}}, "episode_reward_max": 54484.46021652222, "episode_reward_min": 51679.313415527344, "episode_reward_mean": 53560.805035591125, "episode_len_mean": 135.0, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 51679.313415527344}, "policy_reward_max": {"agent_0": 54484.46021652222}, "policy_reward_mean": {"agent_0": 53560.805035591125}, "hist_stats": {"episode_reward": [53685.566566467285, 54393.879943847656, 54484.46021652222, 51679.313415527344], "episode_lengths": [135, 135, 135, 135], "policy_agent_0_reward": [53685.566566467285, 54393.879943847656, 54484.46021652222, 51679.313415527344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.34994712480289, "mean_inference_ms": 6.544581533295871, "mean_action_processing_ms": 0.20249027087962773, "mean_env_wait_ms": 226.15556210347592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03892183303833008, "StateBufferConnector_ms": 0.006234645843505859, "ViewRequirementAgentConnector_ms": 0.16460418701171875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.99435183461316, "num_env_steps_trained_throughput_per_sec": 277.99435183461316, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 16002.649, "sample_time_ms": 11660.569, "learn_time_ms": 4172.65, "learn_throughput": 958.623, "synch_weights_time_ms": 168.544}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 3508, "training_iteration": 123, "trial_id": "185f8_00000", "date": "2025-03-21_12-17-21", "timestamp": 1742559441, "time_this_iter_s": 14.432888507843018, "time_total_s": 1966.4637546539307, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252a170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1966.4637546539307, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 98.68095238095239, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.475, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.68195629119873, "policy_loss": -0.013385532423853874, "vf_loss": 9.693603515625, "vf_explained_var": 3.162771520237584e-07, "kl": 0.008691209368407726, "entropy": 0.40600156784057617, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 57324.98013305664, "episode_reward_min": 44632.93335151672, "episode_reward_mean": 52119.41485707636, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"agent_0": 44632.93335151672}, "policy_reward_max": {"agent_0": 57324.98013305664}, "policy_reward_mean": {"agent_0": 52119.41485707636}, "custom_metrics": {"num_batches_mean": 5.475, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49491.9001789093, 48588.04671815038, 50399.393434524536, 49026.73994445801, 53402.18681907654, 48994.993384718895, 47411.60679244995, 52371.1600151062, 53426.01358795166, 54323.880043029785, 53088.33348274231, 50828.61374664307, 52213.52043533325, 54697.993576049805, 51110.506618499756, 53304.47364807129, 54049.58023071289, 54861.06008911133, 50870.319999694824, 54299.41352844238, 50797.240060806274, 54550.673416137695, 57302.346839904785, 55439.08686828613, 52786.86011886597, 52678.40036010742, 51146.19358062744, 54554.38024139404, 52394.28698730469, 53803.4000287056, 50118.24676460028, 55181.47344207764, 57324.98013305664, 49911.46013736725, 53613.50698852539, 49945.86018753052, 51807.593457221985, 46724.733177900314, 53597.00685310364, 50073.11346435547, 54469.25350189209, 48598.12681865692, 45612.61994981766, 48999.82004213333, 52887.68704986572, 52330.88679122925, 52098.03351211548, 55771.39367675781, 45487.56673812866, 52388.7802066803, 52503.859996795654, 44632.93335151672, 55559.3067779541, 48539.95334148407, 53993.42007064819, 46373.74019622803, 50236.91996765137, 53728.95349121094, 52832.18003845215, 54548.06674575806, 51958.45336818695, 49979.953201293945, 45865.66675233841, 48827.95362377167, 52080.13355636597, 55326.68018722534, 53209.08026456833, 48244.48006820679, 56673.49361419678, 53954.48011779785, 47542.30660247803, 53269.80695724487, 51002.61338043213, 52061.453468322754, 52323.68681716919, 54646.32033538818, 54287.96033477783, 56006.553760528564, 54793.50690078735, 52497.46012210846, 54075.91998100281, 51441.67336463928, 53397.82004356384, 48218.28677225113, 52176.2467956543, 52606.60004234314, 47936.46642971039, 49914.866537094116, 53307.98698425293, 51815.353649139404, 52020.09372520447, 54892.72007751465, 49977.993352890015, 53131.373500823975, 55826.24683380127, 50492.65333175659, 52260.42686462402, 54784.473667144775, 53744.49334144592, 49229.306816101074, 54379.18669128418, 49233.28663635254, 51633.400217056274, 52299.96021652222, 56196.560192108154, 54755.11340332031, 53729.28683280945, 53286.293548583984, 55057.693450927734, 52807.140003204346, 47789.366760253906, 47118.72009849548, 54463.620270729065, 53854.99349975586, 50835.15999221802, 55353.23344230652, 55035.34016418457, 56373.73357772827, 49493.52004504204, 52727.046615600586], "episode_lengths": [136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 134, 135, 135, 135, 134, 136, 136, 136, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 137, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 137, 135, 136, 136, 135, 137, 137, 135, 136, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 134, 135, 136, 135, 135, 135, 136, 136], "policy_agent_0_reward": [49491.9001789093, 48588.04671815038, 50399.393434524536, 49026.73994445801, 53402.18681907654, 48994.993384718895, 47411.60679244995, 52371.1600151062, 53426.01358795166, 54323.880043029785, 53088.33348274231, 50828.61374664307, 52213.52043533325, 54697.993576049805, 51110.506618499756, 53304.47364807129, 54049.58023071289, 54861.06008911133, 50870.319999694824, 54299.41352844238, 50797.240060806274, 54550.673416137695, 57302.346839904785, 55439.08686828613, 52786.86011886597, 52678.40036010742, 51146.19358062744, 54554.38024139404, 52394.28698730469, 53803.4000287056, 50118.24676460028, 55181.47344207764, 57324.98013305664, 49911.46013736725, 53613.50698852539, 49945.86018753052, 51807.593457221985, 46724.733177900314, 53597.00685310364, 50073.11346435547, 54469.25350189209, 48598.12681865692, 45612.61994981766, 48999.82004213333, 52887.68704986572, 52330.88679122925, 52098.03351211548, 55771.39367675781, 45487.56673812866, 52388.7802066803, 52503.859996795654, 44632.93335151672, 55559.3067779541, 48539.95334148407, 53993.42007064819, 46373.74019622803, 50236.91996765137, 53728.95349121094, 52832.18003845215, 54548.06674575806, 51958.45336818695, 49979.953201293945, 45865.66675233841, 48827.95362377167, 52080.13355636597, 55326.68018722534, 53209.08026456833, 48244.48006820679, 56673.49361419678, 53954.48011779785, 47542.30660247803, 53269.80695724487, 51002.61338043213, 52061.453468322754, 52323.68681716919, 54646.32033538818, 54287.96033477783, 56006.553760528564, 54793.50690078735, 52497.46012210846, 54075.91998100281, 51441.67336463928, 53397.82004356384, 48218.28677225113, 52176.2467956543, 52606.60004234314, 47936.46642971039, 49914.866537094116, 53307.98698425293, 51815.353649139404, 52020.09372520447, 54892.72007751465, 49977.993352890015, 53131.373500823975, 55826.24683380127, 50492.65333175659, 52260.42686462402, 54784.473667144775, 53744.49334144592, 49229.306816101074, 54379.18669128418, 49233.28663635254, 51633.400217056274, 52299.96021652222, 56196.560192108154, 54755.11340332031, 53729.28683280945, 53286.293548583984, 55057.693450927734, 52807.140003204346, 47789.366760253906, 47118.72009849548, 54463.620270729065, 53854.99349975586, 50835.15999221802, 55353.23344230652, 55035.34016418457, 56373.73357772827, 49493.52004504204, 52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.29897253084429, "mean_inference_ms": 6.627748646196552, "mean_action_processing_ms": 0.20098593741321558, "mean_env_wait_ms": 222.47782382272945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09500086307525635, "StateBufferConnector_ms": 0.005949338277180989, "ViewRequirementAgentConnector_ms": 0.2450642983118693}}, "episode_reward_max": 57324.98013305664, "episode_reward_min": 44632.93335151672, "episode_reward_mean": 52119.41485707636, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 120, "policy_reward_min": {"agent_0": 44632.93335151672}, "policy_reward_max": {"agent_0": 57324.98013305664}, "policy_reward_mean": {"agent_0": 52119.41485707636}, "hist_stats": {"episode_reward": [49491.9001789093, 48588.04671815038, 50399.393434524536, 49026.73994445801, 53402.18681907654, 48994.993384718895, 47411.60679244995, 52371.1600151062, 53426.01358795166, 54323.880043029785, 53088.33348274231, 50828.61374664307, 52213.52043533325, 54697.993576049805, 51110.506618499756, 53304.47364807129, 54049.58023071289, 54861.06008911133, 50870.319999694824, 54299.41352844238, 50797.240060806274, 54550.673416137695, 57302.346839904785, 55439.08686828613, 52786.86011886597, 52678.40036010742, 51146.19358062744, 54554.38024139404, 52394.28698730469, 53803.4000287056, 50118.24676460028, 55181.47344207764, 57324.98013305664, 49911.46013736725, 53613.50698852539, 49945.86018753052, 51807.593457221985, 46724.733177900314, 53597.00685310364, 50073.11346435547, 54469.25350189209, 48598.12681865692, 45612.61994981766, 48999.82004213333, 52887.68704986572, 52330.88679122925, 52098.03351211548, 55771.39367675781, 45487.56673812866, 52388.7802066803, 52503.859996795654, 44632.93335151672, 55559.3067779541, 48539.95334148407, 53993.42007064819, 46373.74019622803, 50236.91996765137, 53728.95349121094, 52832.18003845215, 54548.06674575806, 51958.45336818695, 49979.953201293945, 45865.66675233841, 48827.95362377167, 52080.13355636597, 55326.68018722534, 53209.08026456833, 48244.48006820679, 56673.49361419678, 53954.48011779785, 47542.30660247803, 53269.80695724487, 51002.61338043213, 52061.453468322754, 52323.68681716919, 54646.32033538818, 54287.96033477783, 56006.553760528564, 54793.50690078735, 52497.46012210846, 54075.91998100281, 51441.67336463928, 53397.82004356384, 48218.28677225113, 52176.2467956543, 52606.60004234314, 47936.46642971039, 49914.866537094116, 53307.98698425293, 51815.353649139404, 52020.09372520447, 54892.72007751465, 49977.993352890015, 53131.373500823975, 55826.24683380127, 50492.65333175659, 52260.42686462402, 54784.473667144775, 53744.49334144592, 49229.306816101074, 54379.18669128418, 49233.28663635254, 51633.400217056274, 52299.96021652222, 56196.560192108154, 54755.11340332031, 53729.28683280945, 53286.293548583984, 55057.693450927734, 52807.140003204346, 47789.366760253906, 47118.72009849548, 54463.620270729065, 53854.99349975586, 50835.15999221802, 55353.23344230652, 55035.34016418457, 56373.73357772827, 49493.52004504204, 52727.046615600586], "episode_lengths": [136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 134, 135, 135, 135, 134, 136, 136, 136, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 137, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 137, 135, 136, 136, 135, 137, 137, 135, 136, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 134, 135, 136, 135, 135, 135, 136, 136], "policy_agent_0_reward": [49491.9001789093, 48588.04671815038, 50399.393434524536, 49026.73994445801, 53402.18681907654, 48994.993384718895, 47411.60679244995, 52371.1600151062, 53426.01358795166, 54323.880043029785, 53088.33348274231, 50828.61374664307, 52213.52043533325, 54697.993576049805, 51110.506618499756, 53304.47364807129, 54049.58023071289, 54861.06008911133, 50870.319999694824, 54299.41352844238, 50797.240060806274, 54550.673416137695, 57302.346839904785, 55439.08686828613, 52786.86011886597, 52678.40036010742, 51146.19358062744, 54554.38024139404, 52394.28698730469, 53803.4000287056, 50118.24676460028, 55181.47344207764, 57324.98013305664, 49911.46013736725, 53613.50698852539, 49945.86018753052, 51807.593457221985, 46724.733177900314, 53597.00685310364, 50073.11346435547, 54469.25350189209, 48598.12681865692, 45612.61994981766, 48999.82004213333, 52887.68704986572, 52330.88679122925, 52098.03351211548, 55771.39367675781, 45487.56673812866, 52388.7802066803, 52503.859996795654, 44632.93335151672, 55559.3067779541, 48539.95334148407, 53993.42007064819, 46373.74019622803, 50236.91996765137, 53728.95349121094, 52832.18003845215, 54548.06674575806, 51958.45336818695, 49979.953201293945, 45865.66675233841, 48827.95362377167, 52080.13355636597, 55326.68018722534, 53209.08026456833, 48244.48006820679, 56673.49361419678, 53954.48011779785, 47542.30660247803, 53269.80695724487, 51002.61338043213, 52061.453468322754, 52323.68681716919, 54646.32033538818, 54287.96033477783, 56006.553760528564, 54793.50690078735, 52497.46012210846, 54075.91998100281, 51441.67336463928, 53397.82004356384, 48218.28677225113, 52176.2467956543, 52606.60004234314, 47936.46642971039, 49914.866537094116, 53307.98698425293, 51815.353649139404, 52020.09372520447, 54892.72007751465, 49977.993352890015, 53131.373500823975, 55826.24683380127, 50492.65333175659, 52260.42686462402, 54784.473667144775, 53744.49334144592, 49229.306816101074, 54379.18669128418, 49233.28663635254, 51633.400217056274, 52299.96021652222, 56196.560192108154, 54755.11340332031, 53729.28683280945, 53286.293548583984, 55057.693450927734, 52807.140003204346, 47789.366760253906, 47118.72009849548, 54463.620270729065, 53854.99349975586, 50835.15999221802, 55353.23344230652, 55035.34016418457, 56373.73357772827, 49493.52004504204, 52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.29897253084429, "mean_inference_ms": 6.627748646196552, "mean_action_processing_ms": 0.20098593741321558, "mean_env_wait_ms": 222.47782382272945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09500086307525635, "StateBufferConnector_ms": 0.005949338277180989, "ViewRequirementAgentConnector_ms": 0.2450642983118693}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.12973156358686, "num_env_steps_trained_throughput_per_sec": 203.12973156358686, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 16550.353, "sample_time_ms": 12227.137, "learn_time_ms": 4150.894, "learn_throughput": 963.648, "synch_weights_time_ms": 171.454}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 3628, "training_iteration": 124, "trial_id": "185f8_00000", "date": "2025-03-21_12-17-41", "timestamp": 1742559461, "time_this_iter_s": 19.753557205200195, "time_total_s": 1986.2173118591309, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1986.2173118591309, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 91.9777777777778, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986929893493652, "policy_loss": -0.011988865211606026, "vf_loss": 9.997325897216797, "vf_explained_var": 1.0326505162083777e-06, "kl": 0.007961145602166653, "entropy": 0.39417439699172974, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}}, "episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.25378291499555, "num_env_steps_trained_throughput_per_sec": 274.25378291499555, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 16081.837, "sample_time_ms": 11780.578, "learn_time_ms": 4136.492, "learn_throughput": 967.003, "synch_weights_time_ms": 163.861}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 3628, "training_iteration": 125, "trial_id": "185f8_00000", "date": "2025-03-21_12-17-55", "timestamp": 1742559475, "time_this_iter_s": 14.636461019515991, "time_total_s": 2000.8537728786469, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24056c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2000.8537728786469, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.63, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98664379119873, "policy_loss": -0.015176280401647091, "vf_loss": 10.0, "vf_explained_var": 2.4382645733567188e-06, "kl": 0.009097845293581486, "entropy": 0.42069777846336365, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}}, "episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.84587525374144, "num_env_steps_trained_throughput_per_sec": 290.84587525374144, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 15736.687, "sample_time_ms": 11428.363, "learn_time_ms": 4151.067, "learn_throughput": 963.608, "synch_weights_time_ms": 156.351}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 3628, "training_iteration": 126, "trial_id": "185f8_00000", "date": "2025-03-21_12-18-09", "timestamp": 1742559489, "time_this_iter_s": 13.81033444404602, "time_total_s": 2014.6641073226929, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2014.6641073226929, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.495, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987552642822266, "policy_loss": -0.014165760949254036, "vf_loss": 10.0, "vf_explained_var": 1.2885158184872125e-06, "kl": 0.008592582307755947, "entropy": 0.40500831604003906, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}}, "episode_reward_max": 52727.046615600586, "episode_reward_min": 52727.046615600586, "episode_reward_mean": 52727.046615600586, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52727.046615600586}, "policy_reward_max": {"agent_0": 52727.046615600586}, "policy_reward_mean": {"agent_0": 52727.046615600586}, "hist_stats": {"episode_reward": [52727.046615600586], "episode_lengths": [136], "policy_agent_0_reward": [52727.046615600586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.69741959258272, "mean_inference_ms": 6.225082008686676, "mean_action_processing_ms": 0.20208554593463723, "mean_env_wait_ms": 231.2135268711389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037670135498046875, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1611471176147461}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.8627759796029, "num_env_steps_trained_throughput_per_sec": 285.8627759796029, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 15693.097, "sample_time_ms": 11337.437, "learn_time_ms": 4207.172, "learn_throughput": 950.757, "synch_weights_time_ms": 147.574}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 3628, "training_iteration": 127, "trial_id": "185f8_00000", "date": "2025-03-21_12-18-23", "timestamp": 1742559503, "time_this_iter_s": 14.042425394058228, "time_total_s": 2028.706532716751, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a228f0a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2028.706532716751, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 99.61000000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.016129032258065, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.680741310119629, "policy_loss": -0.010940645821392536, "vf_loss": 9.690054893493652, "vf_explained_var": -7.984538541450092e-08, "kl": 0.008132186718285084, "entropy": 0.40410441160202026, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 56719.94710159302, "episode_reward_min": 44589.47343337536, "episode_reward_mean": 51896.612513561406, "episode_len_mean": 135.31451612903226, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 44589.47343337536}, "policy_reward_max": {"agent_0": 56719.94710159302}, "policy_reward_mean": {"agent_0": 51896.612513561406}, "custom_metrics": {"num_batches_mean": 5.016129032258065, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55021.060280799866, 53329.91346740723, 53398.006774902344, 53097.173703193665, 54110.63345336914, 48039.57997572422, 52856.10709953308, 53490.853697896004, 49604.07336807251, 48788.72013115883, 54858.72674560547, 52143.68672180176, 51623.60001373291, 51425.62009239197, 53532.0203666687, 51873.3466758728, 55200.9734916687, 52286.873373031616, 45215.80686378479, 55052.506980895996, 52267.78025054932, 51480.22010612488, 55424.59329986572, 53462.840211868286, 52388.32681155205, 50858.00709295273, 54323.88009643555, 49158.07352358103, 52059.73359298706, 52087.606843948364, 53494.72040557861, 50508.70678091049, 52863.093401908875, 56338.07377243042, 51412.826860666275, 52465.06681060791, 52085.42663192749, 56199.0133972168, 54483.17331314087, 48379.79334163666, 46647.60004043579, 53159.30048370361, 51695.49352645874, 51218.55352020264, 52097.00022315979, 53885.00044250488, 50363.4467291832, 48310.320006370544, 55929.26036071777, 44589.47343337536, 54799.980224609375, 48155.55351066589, 44971.73333263397, 51096.720083236694, 54161.92020988464, 50561.78003025055, 49304.02007484436, 54430.58658218384, 51174.07999038696, 52941.68008804321, 52759.286781311035, 52327.54008305073, 52525.95354270935, 52801.28692626953, 54490.16035270691, 55110.52018737793, 56276.10034942627, 53637.18675994873, 51585.64681625366, 55268.486640930176, 51580.02702140808, 49202.946555137634, 55367.02684020996, 48954.88664007187, 52283.14677810669, 51901.42687988281, 46634.173634529114, 47709.406841278076, 50612.32033061981, 52884.5133972168, 52205.36007118225, 54714.026721954346, 53495.733489990234, 48548.679938316345, 48833.9000377655, 53285.767055511475, 53980.82014846802, 49518.68009567261, 53247.773466169834, 48998.85345649719, 55308.173278808594, 48483.59348106384, 54619.786878585815, 52957.25993347168, 53750.96022796631, 49521.400183200836, 51988.20018672943, 45677.50674152374, 52449.540046691895, 53554.533427357674, 49405.826652526855, 50649.29342460632, 53936.77991485596, 49498.91349065304, 53237.44016647339, 51255.173458099365, 50087.71337223053, 53298.72017669678, 53532.22682952881, 50180.98014354706, 47315.206885933876, 55997.87350845337, 52333.72677230835, 55467.91347503662, 46529.180070877075, 56719.94710159302, 47702.26000213623, 55093.20018577576, 49904.22008395195, 56423.30695724487, 50210.60007095337, 47098.78677177429, 51479.88024520874, 52584.446979522705], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 135, 137, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 134, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 134, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 137, 134, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 135, 134, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [55021.060280799866, 53329.91346740723, 53398.006774902344, 53097.173703193665, 54110.63345336914, 48039.57997572422, 52856.10709953308, 53490.853697896004, 49604.07336807251, 48788.72013115883, 54858.72674560547, 52143.68672180176, 51623.60001373291, 51425.62009239197, 53532.0203666687, 51873.3466758728, 55200.9734916687, 52286.873373031616, 45215.80686378479, 55052.506980895996, 52267.78025054932, 51480.22010612488, 55424.59329986572, 53462.840211868286, 52388.32681155205, 50858.00709295273, 54323.88009643555, 49158.07352358103, 52059.73359298706, 52087.606843948364, 53494.72040557861, 50508.70678091049, 52863.093401908875, 56338.07377243042, 51412.826860666275, 52465.06681060791, 52085.42663192749, 56199.0133972168, 54483.17331314087, 48379.79334163666, 46647.60004043579, 53159.30048370361, 51695.49352645874, 51218.55352020264, 52097.00022315979, 53885.00044250488, 50363.4467291832, 48310.320006370544, 55929.26036071777, 44589.47343337536, 54799.980224609375, 48155.55351066589, 44971.73333263397, 51096.720083236694, 54161.92020988464, 50561.78003025055, 49304.02007484436, 54430.58658218384, 51174.07999038696, 52941.68008804321, 52759.286781311035, 52327.54008305073, 52525.95354270935, 52801.28692626953, 54490.16035270691, 55110.52018737793, 56276.10034942627, 53637.18675994873, 51585.64681625366, 55268.486640930176, 51580.02702140808, 49202.946555137634, 55367.02684020996, 48954.88664007187, 52283.14677810669, 51901.42687988281, 46634.173634529114, 47709.406841278076, 50612.32033061981, 52884.5133972168, 52205.36007118225, 54714.026721954346, 53495.733489990234, 48548.679938316345, 48833.9000377655, 53285.767055511475, 53980.82014846802, 49518.68009567261, 53247.773466169834, 48998.85345649719, 55308.173278808594, 48483.59348106384, 54619.786878585815, 52957.25993347168, 53750.96022796631, 49521.400183200836, 51988.20018672943, 45677.50674152374, 52449.540046691895, 53554.533427357674, 49405.826652526855, 50649.29342460632, 53936.77991485596, 49498.91349065304, 53237.44016647339, 51255.173458099365, 50087.71337223053, 53298.72017669678, 53532.22682952881, 50180.98014354706, 47315.206885933876, 55997.87350845337, 52333.72677230835, 55467.91347503662, 46529.180070877075, 56719.94710159302, 47702.26000213623, 55093.20018577576, 49904.22008395195, 56423.30695724487, 50210.60007095337, 47098.78677177429, 51479.88024520874, 52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.59748871938971, "mean_inference_ms": 6.623567009629536, "mean_action_processing_ms": 0.2009277533287378, "mean_env_wait_ms": 222.41396558020318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08236189042368243, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.2052518629258679}}, "episode_reward_max": 56719.94710159302, "episode_reward_min": 44589.47343337536, "episode_reward_mean": 51896.612513561406, "episode_len_mean": 135.31451612903226, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 44589.47343337536}, "policy_reward_max": {"agent_0": 56719.94710159302}, "policy_reward_mean": {"agent_0": 51896.612513561406}, "hist_stats": {"episode_reward": [55021.060280799866, 53329.91346740723, 53398.006774902344, 53097.173703193665, 54110.63345336914, 48039.57997572422, 52856.10709953308, 53490.853697896004, 49604.07336807251, 48788.72013115883, 54858.72674560547, 52143.68672180176, 51623.60001373291, 51425.62009239197, 53532.0203666687, 51873.3466758728, 55200.9734916687, 52286.873373031616, 45215.80686378479, 55052.506980895996, 52267.78025054932, 51480.22010612488, 55424.59329986572, 53462.840211868286, 52388.32681155205, 50858.00709295273, 54323.88009643555, 49158.07352358103, 52059.73359298706, 52087.606843948364, 53494.72040557861, 50508.70678091049, 52863.093401908875, 56338.07377243042, 51412.826860666275, 52465.06681060791, 52085.42663192749, 56199.0133972168, 54483.17331314087, 48379.79334163666, 46647.60004043579, 53159.30048370361, 51695.49352645874, 51218.55352020264, 52097.00022315979, 53885.00044250488, 50363.4467291832, 48310.320006370544, 55929.26036071777, 44589.47343337536, 54799.980224609375, 48155.55351066589, 44971.73333263397, 51096.720083236694, 54161.92020988464, 50561.78003025055, 49304.02007484436, 54430.58658218384, 51174.07999038696, 52941.68008804321, 52759.286781311035, 52327.54008305073, 52525.95354270935, 52801.28692626953, 54490.16035270691, 55110.52018737793, 56276.10034942627, 53637.18675994873, 51585.64681625366, 55268.486640930176, 51580.02702140808, 49202.946555137634, 55367.02684020996, 48954.88664007187, 52283.14677810669, 51901.42687988281, 46634.173634529114, 47709.406841278076, 50612.32033061981, 52884.5133972168, 52205.36007118225, 54714.026721954346, 53495.733489990234, 48548.679938316345, 48833.9000377655, 53285.767055511475, 53980.82014846802, 49518.68009567261, 53247.773466169834, 48998.85345649719, 55308.173278808594, 48483.59348106384, 54619.786878585815, 52957.25993347168, 53750.96022796631, 49521.400183200836, 51988.20018672943, 45677.50674152374, 52449.540046691895, 53554.533427357674, 49405.826652526855, 50649.29342460632, 53936.77991485596, 49498.91349065304, 53237.44016647339, 51255.173458099365, 50087.71337223053, 53298.72017669678, 53532.22682952881, 50180.98014354706, 47315.206885933876, 55997.87350845337, 52333.72677230835, 55467.91347503662, 46529.180070877075, 56719.94710159302, 47702.26000213623, 55093.20018577576, 49904.22008395195, 56423.30695724487, 50210.60007095337, 47098.78677177429, 51479.88024520874, 52584.446979522705], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 135, 137, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 134, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 134, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 137, 134, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 136, 135, 135, 134, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [55021.060280799866, 53329.91346740723, 53398.006774902344, 53097.173703193665, 54110.63345336914, 48039.57997572422, 52856.10709953308, 53490.853697896004, 49604.07336807251, 48788.72013115883, 54858.72674560547, 52143.68672180176, 51623.60001373291, 51425.62009239197, 53532.0203666687, 51873.3466758728, 55200.9734916687, 52286.873373031616, 45215.80686378479, 55052.506980895996, 52267.78025054932, 51480.22010612488, 55424.59329986572, 53462.840211868286, 52388.32681155205, 50858.00709295273, 54323.88009643555, 49158.07352358103, 52059.73359298706, 52087.606843948364, 53494.72040557861, 50508.70678091049, 52863.093401908875, 56338.07377243042, 51412.826860666275, 52465.06681060791, 52085.42663192749, 56199.0133972168, 54483.17331314087, 48379.79334163666, 46647.60004043579, 53159.30048370361, 51695.49352645874, 51218.55352020264, 52097.00022315979, 53885.00044250488, 50363.4467291832, 48310.320006370544, 55929.26036071777, 44589.47343337536, 54799.980224609375, 48155.55351066589, 44971.73333263397, 51096.720083236694, 54161.92020988464, 50561.78003025055, 49304.02007484436, 54430.58658218384, 51174.07999038696, 52941.68008804321, 52759.286781311035, 52327.54008305073, 52525.95354270935, 52801.28692626953, 54490.16035270691, 55110.52018737793, 56276.10034942627, 53637.18675994873, 51585.64681625366, 55268.486640930176, 51580.02702140808, 49202.946555137634, 55367.02684020996, 48954.88664007187, 52283.14677810669, 51901.42687988281, 46634.173634529114, 47709.406841278076, 50612.32033061981, 52884.5133972168, 52205.36007118225, 54714.026721954346, 53495.733489990234, 48548.679938316345, 48833.9000377655, 53285.767055511475, 53980.82014846802, 49518.68009567261, 53247.773466169834, 48998.85345649719, 55308.173278808594, 48483.59348106384, 54619.786878585815, 52957.25993347168, 53750.96022796631, 49521.400183200836, 51988.20018672943, 45677.50674152374, 52449.540046691895, 53554.533427357674, 49405.826652526855, 50649.29342460632, 53936.77991485596, 49498.91349065304, 53237.44016647339, 51255.173458099365, 50087.71337223053, 53298.72017669678, 53532.22682952881, 50180.98014354706, 47315.206885933876, 55997.87350845337, 52333.72677230835, 55467.91347503662, 46529.180070877075, 56719.94710159302, 47702.26000213623, 55093.20018577576, 49904.22008395195, 56423.30695724487, 50210.60007095337, 47098.78677177429, 51479.88024520874, 52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.59748871938971, "mean_inference_ms": 6.623567009629536, "mean_action_processing_ms": 0.2009277533287378, "mean_env_wait_ms": 222.41396558020318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08236189042368243, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.2052518629258679}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.12650988130173, "num_env_steps_trained_throughput_per_sec": 189.12650988130173, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 16361.416, "sample_time_ms": 12027.477, "learn_time_ms": 4193.272, "learn_throughput": 953.909, "synch_weights_time_ms": 139.745}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 3752, "training_iteration": 128, "trial_id": "185f8_00000", "date": "2025-03-21_12-18-45", "timestamp": 1742559525, "time_this_iter_s": 21.205039978027344, "time_total_s": 2049.9115726947784, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24056c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2049.9115726947784, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 89.10333333333334, "ram_util_percent": 13.676666666666666}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988279342651367, "policy_loss": -0.013382403180003166, "vf_loss": 10.0, "vf_explained_var": -1.2665987014770508e-07, "kl": 0.008306141942739487, "entropy": 0.3972715437412262, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}}, "episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.003658269076, "num_env_steps_trained_throughput_per_sec": 264.003658269076, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 16222.019, "sample_time_ms": 11799.441, "learn_time_ms": 4271.75, "learn_throughput": 936.384, "synch_weights_time_ms": 149.908}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 3752, "training_iteration": 129, "trial_id": "185f8_00000", "date": "2025-03-21_12-19-00", "timestamp": 1742559540, "time_this_iter_s": 15.209667682647705, "time_total_s": 2065.121240377426, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2065.121240377426, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988252639770508, "policy_loss": -0.013214828446507454, "vf_loss": 10.0, "vf_explained_var": -1.9079695334767166e-07, "kl": 0.007340272422879934, "entropy": 0.3964161276817322, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}}, "episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.9377022327211, "num_env_steps_trained_throughput_per_sec": 270.9377022327211, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 15692.881, "sample_time_ms": 11248.139, "learn_time_ms": 4295.618, "learn_throughput": 931.182, "synch_weights_time_ms": 148.189}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 3752, "training_iteration": 130, "trial_id": "185f8_00000", "date": "2025-03-21_12-19-15", "timestamp": 1742559555, "time_this_iter_s": 14.81993317604065, "time_total_s": 2079.941173553467, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24079a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2079.941173553467, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.4952380952381, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988103866577148, "policy_loss": -0.013611658476293087, "vf_loss": 10.0, "vf_explained_var": -1.0710209608078003e-07, "kl": 0.008580489084124565, "entropy": 0.3710327446460724, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}}, "episode_reward_max": 52584.446979522705, "episode_reward_min": 52584.446979522705, "episode_reward_mean": 52584.446979522705, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52584.446979522705}, "policy_reward_max": {"agent_0": 52584.446979522705}, "policy_reward_mean": {"agent_0": 52584.446979522705}, "hist_stats": {"episode_reward": [52584.446979522705], "episode_lengths": [135], "policy_agent_0_reward": [52584.446979522705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.973344194385696, "mean_inference_ms": 6.23642958924338, "mean_action_processing_ms": 0.2016919922590081, "mean_env_wait_ms": 231.64981436316256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055098533630371094, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.15461444854736328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0282822899209, "num_env_steps_trained_throughput_per_sec": 307.0282822899209, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 15540.237, "sample_time_ms": 11203.579, "learn_time_ms": 4190.935, "learn_throughput": 954.441, "synch_weights_time_ms": 144.8}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 3752, "training_iteration": 131, "trial_id": "185f8_00000", "date": "2025-03-21_12-19-28", "timestamp": 1742559568, "time_this_iter_s": 13.06359577178955, "time_total_s": 2093.0047693252563, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2093.0047693252563, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.64736842105263, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.67813491821289, "policy_loss": -0.014346884563565254, "vf_loss": 9.690673828125, "vf_explained_var": 5.948046677417551e-08, "kl": 0.009037569165229797, "entropy": 0.40956801176071167, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 56955.44696235657, "episode_reward_min": 45843.54006576538, "episode_reward_mean": 52565.99059306727, "episode_len_mean": 135.260162601626, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 45843.54006576538}, "policy_reward_max": {"agent_0": 56955.44696235657}, "policy_reward_mean": {"agent_0": 52565.99059306727}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52575.360065460205, 55079.4602355957, 47023.773403167725, 49280.10685348511, 51143.06667327881, 53483.88705635071, 51413.51354980469, 52855.40684509277, 55553.826904296875, 50768.84008026123, 50249.64668083191, 47602.4200630188, 52732.16003990173, 53614.36694145203, 51497.80018615723, 51595.62678527832, 51232.88024520874, 52321.52701950073, 51997.87998199463, 51580.80694711208, 53846.88684272766, 52931.646621227264, 54574.92657470703, 54856.12693023682, 50914.1799697876, 52003.47334289551, 52473.52021026611, 52384.086853027344, 54181.44004821777, 52900.90005111694, 52437.75326538086, 50735.226848602295, 53440.85352516174, 55683.786710739136, 55734.58003997803, 50152.14017724991, 54208.3865814209, 51633.200229644775, 55267.48013305664, 51520.55354499817, 53339.96671676636, 53758.12686538696, 56955.44696235657, 53011.873680114746, 56004.366775512695, 48795.58008337021, 52332.207092285156, 52103.03983306885, 54306.280212402344, 47008.76684999466, 53425.73358154297, 53855.93355369568, 51709.18667316437, 54482.5202293396, 52057.7134141922, 54593.67344665527, 50917.453269958496, 53399.26013946533, 54092.21992492676, 53749.82646942139, 52643.96039390564, 53713.69346618652, 49172.77339744568, 55556.44677734375, 54970.380126953125, 53585.1136341095, 49164.233377456665, 50740.393505096436, 55394.086919784546, 56206.960220336914, 52332.83345031738, 49322.986642837524, 54237.726890563965, 56225.6669883728, 54062.13365936279, 54172.10668182373, 54492.413635253906, 48813.05343055725, 51583.44664001465, 50863.50671386719, 49393.806913375854, 52858.56670951843, 46449.56012177467, 56680.926849365234, 51912.28708076477, 49871.246728897095, 54345.28675079346, 49710.746822834015, 53800.340187072754, 52483.46657180786, 51015.1535859108, 49892.400146484375, 55826.8134765625, 50363.54676055908, 53759.22692871094, 53861.860345840454, 51593.906749129295, 50325.979919433594, 54013.233417510986, 53758.98686790466, 48640.57319641113, 52429.01344680786, 52225.173696517944, 50087.40009498596, 45843.54006576538, 51019.646799087524, 54003.793590545654, 52911.96013069153, 48234.68005207181, 56832.66008377075, 54590.8666305542, 53850.9534072876, 55727.21349334717, 55703.726875305176, 50888.986656188965, 55219.786766052246, 56425.366958618164, 49063.71334075928, 51196.98007583618, 54676.52681732178, 55803.80004501343, 52481.06039619446, 53205.48001098633], "episode_lengths": [135, 135, 136, 135, 136, 135, 136, 135, 134, 136, 135, 136, 135, 135, 136, 135, 135, 134, 134, 136, 135, 136, 135, 134, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 134, 135, 136, 135, 135, 135, 137, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [52575.360065460205, 55079.4602355957, 47023.773403167725, 49280.10685348511, 51143.06667327881, 53483.88705635071, 51413.51354980469, 52855.40684509277, 55553.826904296875, 50768.84008026123, 50249.64668083191, 47602.4200630188, 52732.16003990173, 53614.36694145203, 51497.80018615723, 51595.62678527832, 51232.88024520874, 52321.52701950073, 51997.87998199463, 51580.80694711208, 53846.88684272766, 52931.646621227264, 54574.92657470703, 54856.12693023682, 50914.1799697876, 52003.47334289551, 52473.52021026611, 52384.086853027344, 54181.44004821777, 52900.90005111694, 52437.75326538086, 50735.226848602295, 53440.85352516174, 55683.786710739136, 55734.58003997803, 50152.14017724991, 54208.3865814209, 51633.200229644775, 55267.48013305664, 51520.55354499817, 53339.96671676636, 53758.12686538696, 56955.44696235657, 53011.873680114746, 56004.366775512695, 48795.58008337021, 52332.207092285156, 52103.03983306885, 54306.280212402344, 47008.76684999466, 53425.73358154297, 53855.93355369568, 51709.18667316437, 54482.5202293396, 52057.7134141922, 54593.67344665527, 50917.453269958496, 53399.26013946533, 54092.21992492676, 53749.82646942139, 52643.96039390564, 53713.69346618652, 49172.77339744568, 55556.44677734375, 54970.380126953125, 53585.1136341095, 49164.233377456665, 50740.393505096436, 55394.086919784546, 56206.960220336914, 52332.83345031738, 49322.986642837524, 54237.726890563965, 56225.6669883728, 54062.13365936279, 54172.10668182373, 54492.413635253906, 48813.05343055725, 51583.44664001465, 50863.50671386719, 49393.806913375854, 52858.56670951843, 46449.56012177467, 56680.926849365234, 51912.28708076477, 49871.246728897095, 54345.28675079346, 49710.746822834015, 53800.340187072754, 52483.46657180786, 51015.1535859108, 49892.400146484375, 55826.8134765625, 50363.54676055908, 53759.22692871094, 53861.860345840454, 51593.906749129295, 50325.979919433594, 54013.233417510986, 53758.98686790466, 48640.57319641113, 52429.01344680786, 52225.173696517944, 50087.40009498596, 45843.54006576538, 51019.646799087524, 54003.793590545654, 52911.96013069153, 48234.68005207181, 56832.66008377075, 54590.8666305542, 53850.9534072876, 55727.21349334717, 55703.726875305176, 50888.986656188965, 55219.786766052246, 56425.366958618164, 49063.71334075928, 51196.98007583618, 54676.52681732178, 55803.80004501343, 52481.06039619446, 53205.48001098633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.900207941069304, "mean_inference_ms": 6.633308746606027, "mean_action_processing_ms": 0.2009073986772877, "mean_env_wait_ms": 222.30113165216056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061024107584139196, "StateBufferConnector_ms": 0.00592828766117251, "ViewRequirementAgentConnector_ms": 0.18398916818262115}}, "episode_reward_max": 56955.44696235657, "episode_reward_min": 45843.54006576538, "episode_reward_mean": 52565.99059306727, "episode_len_mean": 135.260162601626, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 45843.54006576538}, "policy_reward_max": {"agent_0": 56955.44696235657}, "policy_reward_mean": {"agent_0": 52565.99059306727}, "hist_stats": {"episode_reward": [52575.360065460205, 55079.4602355957, 47023.773403167725, 49280.10685348511, 51143.06667327881, 53483.88705635071, 51413.51354980469, 52855.40684509277, 55553.826904296875, 50768.84008026123, 50249.64668083191, 47602.4200630188, 52732.16003990173, 53614.36694145203, 51497.80018615723, 51595.62678527832, 51232.88024520874, 52321.52701950073, 51997.87998199463, 51580.80694711208, 53846.88684272766, 52931.646621227264, 54574.92657470703, 54856.12693023682, 50914.1799697876, 52003.47334289551, 52473.52021026611, 52384.086853027344, 54181.44004821777, 52900.90005111694, 52437.75326538086, 50735.226848602295, 53440.85352516174, 55683.786710739136, 55734.58003997803, 50152.14017724991, 54208.3865814209, 51633.200229644775, 55267.48013305664, 51520.55354499817, 53339.96671676636, 53758.12686538696, 56955.44696235657, 53011.873680114746, 56004.366775512695, 48795.58008337021, 52332.207092285156, 52103.03983306885, 54306.280212402344, 47008.76684999466, 53425.73358154297, 53855.93355369568, 51709.18667316437, 54482.5202293396, 52057.7134141922, 54593.67344665527, 50917.453269958496, 53399.26013946533, 54092.21992492676, 53749.82646942139, 52643.96039390564, 53713.69346618652, 49172.77339744568, 55556.44677734375, 54970.380126953125, 53585.1136341095, 49164.233377456665, 50740.393505096436, 55394.086919784546, 56206.960220336914, 52332.83345031738, 49322.986642837524, 54237.726890563965, 56225.6669883728, 54062.13365936279, 54172.10668182373, 54492.413635253906, 48813.05343055725, 51583.44664001465, 50863.50671386719, 49393.806913375854, 52858.56670951843, 46449.56012177467, 56680.926849365234, 51912.28708076477, 49871.246728897095, 54345.28675079346, 49710.746822834015, 53800.340187072754, 52483.46657180786, 51015.1535859108, 49892.400146484375, 55826.8134765625, 50363.54676055908, 53759.22692871094, 53861.860345840454, 51593.906749129295, 50325.979919433594, 54013.233417510986, 53758.98686790466, 48640.57319641113, 52429.01344680786, 52225.173696517944, 50087.40009498596, 45843.54006576538, 51019.646799087524, 54003.793590545654, 52911.96013069153, 48234.68005207181, 56832.66008377075, 54590.8666305542, 53850.9534072876, 55727.21349334717, 55703.726875305176, 50888.986656188965, 55219.786766052246, 56425.366958618164, 49063.71334075928, 51196.98007583618, 54676.52681732178, 55803.80004501343, 52481.06039619446, 53205.48001098633], "episode_lengths": [135, 135, 136, 135, 136, 135, 136, 135, 134, 136, 135, 136, 135, 135, 136, 135, 135, 134, 134, 136, 135, 136, 135, 134, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 134, 135, 136, 135, 135, 135, 137, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [52575.360065460205, 55079.4602355957, 47023.773403167725, 49280.10685348511, 51143.06667327881, 53483.88705635071, 51413.51354980469, 52855.40684509277, 55553.826904296875, 50768.84008026123, 50249.64668083191, 47602.4200630188, 52732.16003990173, 53614.36694145203, 51497.80018615723, 51595.62678527832, 51232.88024520874, 52321.52701950073, 51997.87998199463, 51580.80694711208, 53846.88684272766, 52931.646621227264, 54574.92657470703, 54856.12693023682, 50914.1799697876, 52003.47334289551, 52473.52021026611, 52384.086853027344, 54181.44004821777, 52900.90005111694, 52437.75326538086, 50735.226848602295, 53440.85352516174, 55683.786710739136, 55734.58003997803, 50152.14017724991, 54208.3865814209, 51633.200229644775, 55267.48013305664, 51520.55354499817, 53339.96671676636, 53758.12686538696, 56955.44696235657, 53011.873680114746, 56004.366775512695, 48795.58008337021, 52332.207092285156, 52103.03983306885, 54306.280212402344, 47008.76684999466, 53425.73358154297, 53855.93355369568, 51709.18667316437, 54482.5202293396, 52057.7134141922, 54593.67344665527, 50917.453269958496, 53399.26013946533, 54092.21992492676, 53749.82646942139, 52643.96039390564, 53713.69346618652, 49172.77339744568, 55556.44677734375, 54970.380126953125, 53585.1136341095, 49164.233377456665, 50740.393505096436, 55394.086919784546, 56206.960220336914, 52332.83345031738, 49322.986642837524, 54237.726890563965, 56225.6669883728, 54062.13365936279, 54172.10668182373, 54492.413635253906, 48813.05343055725, 51583.44664001465, 50863.50671386719, 49393.806913375854, 52858.56670951843, 46449.56012177467, 56680.926849365234, 51912.28708076477, 49871.246728897095, 54345.28675079346, 49710.746822834015, 53800.340187072754, 52483.46657180786, 51015.1535859108, 49892.400146484375, 55826.8134765625, 50363.54676055908, 53759.22692871094, 53861.860345840454, 51593.906749129295, 50325.979919433594, 54013.233417510986, 53758.98686790466, 48640.57319641113, 52429.01344680786, 52225.173696517944, 50087.40009498596, 45843.54006576538, 51019.646799087524, 54003.793590545654, 52911.96013069153, 48234.68005207181, 56832.66008377075, 54590.8666305542, 53850.9534072876, 55727.21349334717, 55703.726875305176, 50888.986656188965, 55219.786766052246, 56425.366958618164, 49063.71334075928, 51196.98007583618, 54676.52681732178, 55803.80004501343, 52481.06039619446, 53205.48001098633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.900207941069304, "mean_inference_ms": 6.633308746606027, "mean_action_processing_ms": 0.2009073986772877, "mean_env_wait_ms": 222.30113165216056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061024107584139196, "StateBufferConnector_ms": 0.00592828766117251, "ViewRequirementAgentConnector_ms": 0.18398916818262115}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.06385833274453, "num_env_steps_trained_throughput_per_sec": 198.06385833274453, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 16069.916, "sample_time_ms": 11764.984, "learn_time_ms": 4159.181, "learn_throughput": 961.728, "synch_weights_time_ms": 144.832}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 3875, "training_iteration": 132, "trial_id": "185f8_00000", "date": "2025-03-21_12-19-48", "timestamp": 1742559588, "time_this_iter_s": 20.24837899208069, "time_total_s": 2113.253148317337, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a252b6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2113.253148317337, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 88.88928571428573, "ram_util_percent": 13.674999999999999}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986472129821777, "policy_loss": -0.012350205332040787, "vf_loss": 9.997314453125, "vf_explained_var": 5.2837034303365726e-08, "kl": 0.007545327302068472, "entropy": 0.4169226884841919, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}}, "episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.96335098486617, "num_env_steps_trained_throughput_per_sec": 293.96335098486617, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 15991.756, "sample_time_ms": 11702.059, "learn_time_ms": 4150.092, "learn_throughput": 963.834, "synch_weights_time_ms": 138.752}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 3876, "training_iteration": 133, "trial_id": "185f8_00000", "date": "2025-03-21_12-20-02", "timestamp": 1742559602, "time_this_iter_s": 13.653136253356934, "time_total_s": 2126.906284570694, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2126.906284570694, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.525, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984563827514648, "policy_loss": -0.014871494844555855, "vf_loss": 9.997635841369629, "vf_explained_var": -1.0758637927210657e-06, "kl": 0.008997754193842411, "entropy": 0.4400307834148407, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}}, "episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.8020921974886, "num_env_steps_trained_throughput_per_sec": 286.8020921974886, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 15417.264, "sample_time_ms": 11138.303, "learn_time_ms": 4138.783, "learn_throughput": 966.468, "synch_weights_time_ms": 139.327}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 3876, "training_iteration": 134, "trial_id": "185f8_00000", "date": "2025-03-21_12-20-16", "timestamp": 1742559616, "time_this_iter_s": 14.004527568817139, "time_total_s": 2140.910812139511, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2140.910812139511, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.53, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989702224731445, "policy_loss": -0.011903522536158562, "vf_loss": 10.0, "vf_explained_var": 8.50247852213215e-06, "kl": 0.008029366843402386, "entropy": 0.3786139190196991, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}}, "episode_reward_max": 46927.5936756134, "episode_reward_min": 46927.5936756134, "episode_reward_mean": 46927.5936756134, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 46927.5936756134}, "policy_reward_max": {"agent_0": 46927.5936756134}, "policy_reward_mean": {"agent_0": 46927.5936756134}, "hist_stats": {"episode_reward": [46927.5936756134], "episode_lengths": [136], "policy_agent_0_reward": [46927.5936756134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.71813019641711, "mean_inference_ms": 6.540400183553848, "mean_action_processing_ms": 0.20319660595174802, "mean_env_wait_ms": 201.49799712969664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03528594970703125, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16040802001953125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6716330785593, "num_env_steps_trained_throughput_per_sec": 288.6716330785593, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 15344.416, "sample_time_ms": 11109.486, "learn_time_ms": 4093.748, "learn_throughput": 977.1, "synch_weights_time_ms": 140.356}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 3876, "training_iteration": 135, "trial_id": "185f8_00000", "date": "2025-03-21_12-20-30", "timestamp": 1742559630, "time_this_iter_s": 13.910749673843384, "time_total_s": 2154.8215618133545, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2154.8215618133545, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.46315789473685, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.69607162475586, "policy_loss": -0.010372208431363106, "vf_loss": 9.704931259155273, "vf_explained_var": 8.073945991782239e-07, "kl": 0.007556911092251539, "entropy": 0.4369220733642578, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 57977.4397277832, "episode_reward_min": 46722.893471717834, "episode_reward_mean": 52883.55610626811, "episode_len_mean": 135.30252100840337, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {"agent_0": 46722.893471717834}, "policy_reward_max": {"agent_0": 57977.4397277832}, "policy_reward_mean": {"agent_0": 52883.55610626811}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51140.173308849335, 53199.13998413086, 53482.866760253906, 54521.3533411026, 53177.72696876526, 55574.12672996521, 54601.10685348511, 53786.97341156006, 53665.573387145996, 55248.906762599945, 55359.32682800293, 51974.066864967346, 52973.36682128906, 56009.26681518555, 48856.920391082764, 55860.47348022461, 51387.83348655701, 53598.03343296051, 54157.16011810303, 53531.06680107117, 49086.90000629425, 54009.73355102539, 52189.106773376465, 56637.667083740234, 55410.92678451538, 51867.166873931885, 56328.340393066406, 53639.0135345459, 56822.36680603027, 54407.39334869385, 46722.893471717834, 55851.98683929443, 51612.580224990845, 54140.173412323, 53984.33372402191, 53521.26675796509, 53395.5200881958, 50165.01340484619, 51484.84669494629, 56167.32014465332, 51103.373430252075, 54153.91362762451, 56300.36697387695, 53659.30020785332, 50341.35996556282, 52008.62018203735, 53591.866970062256, 48140.4668340683, 52296.90669608116, 51104.1734046936, 49731.12019729614, 53112.086853027344, 55710.56676363945, 54028.29325866699, 53455.12032318115, 51147.93352496624, 49317.87356173992, 57977.4397277832, 51873.833461761475, 50464.639991760254, 54962.793785095215, 56357.7000579834, 51186.39342689514, 51441.486808776855, 52668.98012197018, 53466.16682434082, 53643.76000213623, 54311.28694152832, 48458.86002159119, 56514.08699798584, 52501.89349746704, 51654.860290527344, 51964.81345939636, 51512.58022236824, 52597.10673904419, 49788.50672531128, 49987.53333854675, 47238.213300704956, 51663.53372955322, 50957.92685699463, 55781.46674346924, 55261.58018493652, 53864.23350906372, 53278.77348327637, 51603.97345352173, 53314.46690940857, 54241.28652763367, 52462.17384958267, 52350.006827145815, 52737.16698074341, 51697.25997161865, 55313.140213012695, 47460.220163583755, 53380.60690116882, 54135.88006591797, 53537.54660987854, 53442.61351394653, 55447.83329772949, 52731.02686500549, 53238.78691864014, 55866.27353668213, 54218.82666015625, 49594.546783447266, 52324.033306121826, 52387.093547821045, 53591.28675317764, 52341.00659561157, 51746.19354248047, 54725.39326477051, 54328.353412628174, 52272.38685798645, 52433.8337020874, 55289.040100097656, 51360.19333934784, 49514.00688934326, 50841.2069644928, 49665.906524419785, 49444.546909332275, 53971.253396987915], "episode_lengths": [135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 134, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 136, 136, 136, 135, 135, 137, 136, 135, 135, 135, 136, 135, 135, 135, 135, 137, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 137, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 135, 134, 135, 136, 135, 134, 135, 135, 136, 137, 135, 135], "policy_agent_0_reward": [51140.173308849335, 53199.13998413086, 53482.866760253906, 54521.3533411026, 53177.72696876526, 55574.12672996521, 54601.10685348511, 53786.97341156006, 53665.573387145996, 55248.906762599945, 55359.32682800293, 51974.066864967346, 52973.36682128906, 56009.26681518555, 48856.920391082764, 55860.47348022461, 51387.83348655701, 53598.03343296051, 54157.16011810303, 53531.06680107117, 49086.90000629425, 54009.73355102539, 52189.106773376465, 56637.667083740234, 55410.92678451538, 51867.166873931885, 56328.340393066406, 53639.0135345459, 56822.36680603027, 54407.39334869385, 46722.893471717834, 55851.98683929443, 51612.580224990845, 54140.173412323, 53984.33372402191, 53521.26675796509, 53395.5200881958, 50165.01340484619, 51484.84669494629, 56167.32014465332, 51103.373430252075, 54153.91362762451, 56300.36697387695, 53659.30020785332, 50341.35996556282, 52008.62018203735, 53591.866970062256, 48140.4668340683, 52296.90669608116, 51104.1734046936, 49731.12019729614, 53112.086853027344, 55710.56676363945, 54028.29325866699, 53455.12032318115, 51147.93352496624, 49317.87356173992, 57977.4397277832, 51873.833461761475, 50464.639991760254, 54962.793785095215, 56357.7000579834, 51186.39342689514, 51441.486808776855, 52668.98012197018, 53466.16682434082, 53643.76000213623, 54311.28694152832, 48458.86002159119, 56514.08699798584, 52501.89349746704, 51654.860290527344, 51964.81345939636, 51512.58022236824, 52597.10673904419, 49788.50672531128, 49987.53333854675, 47238.213300704956, 51663.53372955322, 50957.92685699463, 55781.46674346924, 55261.58018493652, 53864.23350906372, 53278.77348327637, 51603.97345352173, 53314.46690940857, 54241.28652763367, 52462.17384958267, 52350.006827145815, 52737.16698074341, 51697.25997161865, 55313.140213012695, 47460.220163583755, 53380.60690116882, 54135.88006591797, 53537.54660987854, 53442.61351394653, 55447.83329772949, 52731.02686500549, 53238.78691864014, 55866.27353668213, 54218.82666015625, 49594.546783447266, 52324.033306121826, 52387.093547821045, 53591.28675317764, 52341.00659561157, 51746.19354248047, 54725.39326477051, 54328.353412628174, 52272.38685798645, 52433.8337020874, 55289.040100097656, 51360.19333934784, 49514.00688934326, 50841.2069644928, 49665.906524419785, 49444.546909332275, 53971.253396987915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.98609073616632, "mean_inference_ms": 6.643452418724938, "mean_action_processing_ms": 0.20089965837658647, "mean_env_wait_ms": 222.25836668913902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04859892260126707, "StateBufferConnector_ms": 0.0058204186062852875, "ViewRequirementAgentConnector_ms": 0.21334235407725102}}, "episode_reward_max": 57977.4397277832, "episode_reward_min": 46722.893471717834, "episode_reward_mean": 52883.55610626811, "episode_len_mean": 135.30252100840337, "episodes_this_iter": 119, "policy_reward_min": {"agent_0": 46722.893471717834}, "policy_reward_max": {"agent_0": 57977.4397277832}, "policy_reward_mean": {"agent_0": 52883.55610626811}, "hist_stats": {"episode_reward": [51140.173308849335, 53199.13998413086, 53482.866760253906, 54521.3533411026, 53177.72696876526, 55574.12672996521, 54601.10685348511, 53786.97341156006, 53665.573387145996, 55248.906762599945, 55359.32682800293, 51974.066864967346, 52973.36682128906, 56009.26681518555, 48856.920391082764, 55860.47348022461, 51387.83348655701, 53598.03343296051, 54157.16011810303, 53531.06680107117, 49086.90000629425, 54009.73355102539, 52189.106773376465, 56637.667083740234, 55410.92678451538, 51867.166873931885, 56328.340393066406, 53639.0135345459, 56822.36680603027, 54407.39334869385, 46722.893471717834, 55851.98683929443, 51612.580224990845, 54140.173412323, 53984.33372402191, 53521.26675796509, 53395.5200881958, 50165.01340484619, 51484.84669494629, 56167.32014465332, 51103.373430252075, 54153.91362762451, 56300.36697387695, 53659.30020785332, 50341.35996556282, 52008.62018203735, 53591.866970062256, 48140.4668340683, 52296.90669608116, 51104.1734046936, 49731.12019729614, 53112.086853027344, 55710.56676363945, 54028.29325866699, 53455.12032318115, 51147.93352496624, 49317.87356173992, 57977.4397277832, 51873.833461761475, 50464.639991760254, 54962.793785095215, 56357.7000579834, 51186.39342689514, 51441.486808776855, 52668.98012197018, 53466.16682434082, 53643.76000213623, 54311.28694152832, 48458.86002159119, 56514.08699798584, 52501.89349746704, 51654.860290527344, 51964.81345939636, 51512.58022236824, 52597.10673904419, 49788.50672531128, 49987.53333854675, 47238.213300704956, 51663.53372955322, 50957.92685699463, 55781.46674346924, 55261.58018493652, 53864.23350906372, 53278.77348327637, 51603.97345352173, 53314.46690940857, 54241.28652763367, 52462.17384958267, 52350.006827145815, 52737.16698074341, 51697.25997161865, 55313.140213012695, 47460.220163583755, 53380.60690116882, 54135.88006591797, 53537.54660987854, 53442.61351394653, 55447.83329772949, 52731.02686500549, 53238.78691864014, 55866.27353668213, 54218.82666015625, 49594.546783447266, 52324.033306121826, 52387.093547821045, 53591.28675317764, 52341.00659561157, 51746.19354248047, 54725.39326477051, 54328.353412628174, 52272.38685798645, 52433.8337020874, 55289.040100097656, 51360.19333934784, 49514.00688934326, 50841.2069644928, 49665.906524419785, 49444.546909332275, 53971.253396987915], "episode_lengths": [135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 134, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 136, 136, 136, 135, 135, 137, 136, 135, 135, 135, 136, 135, 135, 135, 135, 137, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 137, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 135, 134, 135, 136, 135, 134, 135, 135, 136, 137, 135, 135], "policy_agent_0_reward": [51140.173308849335, 53199.13998413086, 53482.866760253906, 54521.3533411026, 53177.72696876526, 55574.12672996521, 54601.10685348511, 53786.97341156006, 53665.573387145996, 55248.906762599945, 55359.32682800293, 51974.066864967346, 52973.36682128906, 56009.26681518555, 48856.920391082764, 55860.47348022461, 51387.83348655701, 53598.03343296051, 54157.16011810303, 53531.06680107117, 49086.90000629425, 54009.73355102539, 52189.106773376465, 56637.667083740234, 55410.92678451538, 51867.166873931885, 56328.340393066406, 53639.0135345459, 56822.36680603027, 54407.39334869385, 46722.893471717834, 55851.98683929443, 51612.580224990845, 54140.173412323, 53984.33372402191, 53521.26675796509, 53395.5200881958, 50165.01340484619, 51484.84669494629, 56167.32014465332, 51103.373430252075, 54153.91362762451, 56300.36697387695, 53659.30020785332, 50341.35996556282, 52008.62018203735, 53591.866970062256, 48140.4668340683, 52296.90669608116, 51104.1734046936, 49731.12019729614, 53112.086853027344, 55710.56676363945, 54028.29325866699, 53455.12032318115, 51147.93352496624, 49317.87356173992, 57977.4397277832, 51873.833461761475, 50464.639991760254, 54962.793785095215, 56357.7000579834, 51186.39342689514, 51441.486808776855, 52668.98012197018, 53466.16682434082, 53643.76000213623, 54311.28694152832, 48458.86002159119, 56514.08699798584, 52501.89349746704, 51654.860290527344, 51964.81345939636, 51512.58022236824, 52597.10673904419, 49788.50672531128, 49987.53333854675, 47238.213300704956, 51663.53372955322, 50957.92685699463, 55781.46674346924, 55261.58018493652, 53864.23350906372, 53278.77348327637, 51603.97345352173, 53314.46690940857, 54241.28652763367, 52462.17384958267, 52350.006827145815, 52737.16698074341, 51697.25997161865, 55313.140213012695, 47460.220163583755, 53380.60690116882, 54135.88006591797, 53537.54660987854, 53442.61351394653, 55447.83329772949, 52731.02686500549, 53238.78691864014, 55866.27353668213, 54218.82666015625, 49594.546783447266, 52324.033306121826, 52387.093547821045, 53591.28675317764, 52341.00659561157, 51746.19354248047, 54725.39326477051, 54328.353412628174, 52272.38685798645, 52433.8337020874, 55289.040100097656, 51360.19333934784, 49514.00688934326, 50841.2069644928, 49665.906524419785, 49444.546909332275, 53971.253396987915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.98609073616632, "mean_inference_ms": 6.643452418724938, "mean_action_processing_ms": 0.20089965837658647, "mean_env_wait_ms": 222.25836668913902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04859892260126707, "StateBufferConnector_ms": 0.0058204186062852875, "ViewRequirementAgentConnector_ms": 0.21334235407725102}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.01116582265047, "num_env_steps_trained_throughput_per_sec": 202.01116582265047, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15949.205, "sample_time_ms": 11731.001, "learn_time_ms": 4075.336, "learn_throughput": 981.514, "synch_weights_time_ms": 142.039}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 3995, "training_iteration": 136, "trial_id": "185f8_00000", "date": "2025-03-21_12-20-50", "timestamp": 1742559650, "time_this_iter_s": 19.85770344734192, "time_total_s": 2174.6792652606964, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2404430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2174.6792652606964, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 89.82307692307693, "ram_util_percent": 13.680769230769227}}
{"custom_metrics": {"num_batches_mean": 5.8, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.97504711151123, "policy_loss": -0.014326690696179867, "vf_loss": 9.987548828125, "vf_explained_var": -2.5406478698641877e-07, "kl": 0.009122156538069248, "entropy": 0.42735111713409424, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 54366.64002227783, "episode_reward_min": 44836.24690055847, "episode_reward_mean": 50485.94675550461, "episode_len_mean": 135.4, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"agent_0": 44836.24690055847}, "policy_reward_max": {"agent_0": 54366.64002227783}, "policy_reward_mean": {"agent_0": 50485.94675550461}, "custom_metrics": {"num_batches_mean": 5.8, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53843.1533946991, 44836.24690055847, 54366.64002227783, 47290.20684480667, 52093.48661518097], "episode_lengths": [135, 136, 135, 136, 135], "policy_agent_0_reward": [53843.1533946991, 44836.24690055847, 54366.64002227783, 47290.20684480667, 52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.174981122974245, "mean_inference_ms": 6.658387341591668, "mean_action_processing_ms": 0.20298765867461227, "mean_env_wait_ms": 214.53239285837086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03829479217529297, "StateBufferConnector_ms": 0.005574226379394531, "ViewRequirementAgentConnector_ms": 0.2651834487915039}}, "episode_reward_max": 54366.64002227783, "episode_reward_min": 44836.24690055847, "episode_reward_mean": 50485.94675550461, "episode_len_mean": 135.4, "episodes_this_iter": 5, "policy_reward_min": {"agent_0": 44836.24690055847}, "policy_reward_max": {"agent_0": 54366.64002227783}, "policy_reward_mean": {"agent_0": 50485.94675550461}, "hist_stats": {"episode_reward": [53843.1533946991, 44836.24690055847, 54366.64002227783, 47290.20684480667, 52093.48661518097], "episode_lengths": [135, 136, 135, 136, 135], "policy_agent_0_reward": [53843.1533946991, 44836.24690055847, 54366.64002227783, 47290.20684480667, 52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.174981122974245, "mean_inference_ms": 6.658387341591668, "mean_action_processing_ms": 0.20298765867461227, "mean_env_wait_ms": 214.53239285837086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03829479217529297, "StateBufferConnector_ms": 0.005574226379394531, "ViewRequirementAgentConnector_ms": 0.2651834487915039}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.47842078611404, "num_env_steps_trained_throughput_per_sec": 294.47842078611404, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 15908.267, "sample_time_ms": 11765.756, "learn_time_ms": 3999.142, "learn_throughput": 1000.215, "synch_weights_time_ms": 142.57}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 4000, "training_iteration": 137, "trial_id": "185f8_00000", "date": "2025-03-21_12-21-03", "timestamp": 1742559663, "time_this_iter_s": 13.62661600112915, "time_total_s": 2188.3058812618256, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2188.3058812618256, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.475, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986905097961426, "policy_loss": -0.014716574922204018, "vf_loss": 10.0, "vf_explained_var": 4.175429637598427e-07, "kl": 0.008107496425509453, "entropy": 0.3941280245780945, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 52093.48661518097, "episode_reward_min": 52093.48661518097, "episode_reward_mean": 52093.48661518097, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52093.48661518097}, "policy_reward_max": {"agent_0": 52093.48661518097}, "policy_reward_mean": {"agent_0": 52093.48661518097}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52093.48661518097], "episode_lengths": [135], "policy_agent_0_reward": [52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.09408846847552, "mean_inference_ms": 6.666304067439881, "mean_action_processing_ms": 0.19777672048849282, "mean_env_wait_ms": 224.46834945896197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039458274841308594, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.1611948013305664}}, "episode_reward_max": 52093.48661518097, "episode_reward_min": 52093.48661518097, "episode_reward_mean": 52093.48661518097, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52093.48661518097}, "policy_reward_max": {"agent_0": 52093.48661518097}, "policy_reward_mean": {"agent_0": 52093.48661518097}, "hist_stats": {"episode_reward": [52093.48661518097], "episode_lengths": [135], "policy_agent_0_reward": [52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.09408846847552, "mean_inference_ms": 6.666304067439881, "mean_action_processing_ms": 0.19777672048849282, "mean_env_wait_ms": 224.46834945896197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039458274841308594, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.1611948013305664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.61037355067424, "num_env_steps_trained_throughput_per_sec": 284.61037355067424, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 15198.704, "sample_time_ms": 11081.663, "learn_time_ms": 3972.572, "learn_throughput": 1006.904, "synch_weights_time_ms": 143.675}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 4000, "training_iteration": 138, "trial_id": "185f8_00000", "date": "2025-03-21_12-21-18", "timestamp": 1742559678, "time_this_iter_s": 14.107111692428589, "time_total_s": 2202.412992954254, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2202.412992954254, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.4, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988153457641602, "policy_loss": -0.013197009451687336, "vf_loss": 10.0, "vf_explained_var": 1.6105671818422707e-07, "kl": 0.006746746599674225, "entropy": 0.35613149404525757, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 52093.48661518097, "episode_reward_min": 52093.48661518097, "episode_reward_mean": 52093.48661518097, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52093.48661518097}, "policy_reward_max": {"agent_0": 52093.48661518097}, "policy_reward_mean": {"agent_0": 52093.48661518097}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52093.48661518097], "episode_lengths": [135], "policy_agent_0_reward": [52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.09408846847552, "mean_inference_ms": 6.666304067439881, "mean_action_processing_ms": 0.19777672048849282, "mean_env_wait_ms": 224.46834945896197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039458274841308594, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.1611948013305664}}, "episode_reward_max": 52093.48661518097, "episode_reward_min": 52093.48661518097, "episode_reward_mean": 52093.48661518097, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52093.48661518097}, "policy_reward_max": {"agent_0": 52093.48661518097}, "policy_reward_mean": {"agent_0": 52093.48661518097}, "hist_stats": {"episode_reward": [52093.48661518097], "episode_lengths": [135], "policy_agent_0_reward": [52093.48661518097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.09408846847552, "mean_inference_ms": 6.666304067439881, "mean_action_processing_ms": 0.19777672048849282, "mean_env_wait_ms": 224.46834945896197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039458274841308594, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.1611948013305664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.91454420275403, "num_env_steps_trained_throughput_per_sec": 296.91454420275403, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 15030.767, "sample_time_ms": 11006.245, "learn_time_ms": 3888.75, "learn_throughput": 1028.608, "synch_weights_time_ms": 134.959}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 4000, "training_iteration": 139, "trial_id": "185f8_00000", "date": "2025-03-21_12-21-31", "timestamp": 1742559691, "time_this_iter_s": 13.521085262298584, "time_total_s": 2215.9340782165527, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2215.9340782165527, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.46842105263158, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.876616477966309, "policy_loss": -0.014704948291182518, "vf_loss": 9.8896484375, "vf_explained_var": -2.6493023597140564e-07, "kl": 0.008362308144569397, "entropy": 0.39689451456069946, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 55822.42724609375, "episode_reward_min": 46340.14014148712, "episode_reward_mean": 52854.349810745036, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {"agent_0": 46340.14014148712}, "policy_reward_max": {"agent_0": 55822.42724609375}, "policy_reward_mean": {"agent_0": 52854.349810745036}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54390.006828308105, 52673.14011192322, 53269.706627845764, 53374.38038063049, 53536.76663208008, 51544.026618003845, 52532.113441467285, 52018.826679229736, 51375.12007558346, 53610.70028114319, 51981.14684295654, 49785.153327941895, 53184.393409729004, 53672.03347015381, 55595.46018218994, 55822.42724609375, 52559.42022037506, 52984.1268787384, 54051.4133605957, 53418.7134437561, 53644.526794433594, 46340.14014148712, 53693.61339187622, 55733.306900024414, 48850.58688545227, 52155.53340911865, 53263.70002365112, 47018.18661689758, 54256.10667800903, 53754.580001831055, 52972.30014038086, 52328.5136680603, 53838.8071308136, 51843.260076999664, 54116.47336387634, 54479.626876831055, 53344.04008293152, 51407.460171699524, 52633.960127830505, 55571.30001831055, 55409.91326713562, 51847.68022489548], "episode_lengths": [136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 136, 136, 135, 137, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134], "policy_agent_0_reward": [54390.006828308105, 52673.14011192322, 53269.706627845764, 53374.38038063049, 53536.76663208008, 51544.026618003845, 52532.113441467285, 52018.826679229736, 51375.12007558346, 53610.70028114319, 51981.14684295654, 49785.153327941895, 53184.393409729004, 53672.03347015381, 55595.46018218994, 55822.42724609375, 52559.42022037506, 52984.1268787384, 54051.4133605957, 53418.7134437561, 53644.526794433594, 46340.14014148712, 53693.61339187622, 55733.306900024414, 48850.58688545227, 52155.53340911865, 53263.70002365112, 47018.18661689758, 54256.10667800903, 53754.580001831055, 52972.30014038086, 52328.5136680603, 53838.8071308136, 51843.260076999664, 54116.47336387634, 54479.626876831055, 53344.04008293152, 51407.460171699524, 52633.960127830505, 55571.30001831055, 55409.91326713562, 51847.68022489548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.16547992376287, "mean_inference_ms": 6.523734025160782, "mean_action_processing_ms": 0.2017167306885076, "mean_env_wait_ms": 218.05450335559266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05165622347877139, "StateBufferConnector_ms": 0.005986009325299945, "ViewRequirementAgentConnector_ms": 0.26143505459740046}}, "episode_reward_max": 55822.42724609375, "episode_reward_min": 46340.14014148712, "episode_reward_mean": 52854.349810745036, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 42, "policy_reward_min": {"agent_0": 46340.14014148712}, "policy_reward_max": {"agent_0": 55822.42724609375}, "policy_reward_mean": {"agent_0": 52854.349810745036}, "hist_stats": {"episode_reward": [54390.006828308105, 52673.14011192322, 53269.706627845764, 53374.38038063049, 53536.76663208008, 51544.026618003845, 52532.113441467285, 52018.826679229736, 51375.12007558346, 53610.70028114319, 51981.14684295654, 49785.153327941895, 53184.393409729004, 53672.03347015381, 55595.46018218994, 55822.42724609375, 52559.42022037506, 52984.1268787384, 54051.4133605957, 53418.7134437561, 53644.526794433594, 46340.14014148712, 53693.61339187622, 55733.306900024414, 48850.58688545227, 52155.53340911865, 53263.70002365112, 47018.18661689758, 54256.10667800903, 53754.580001831055, 52972.30014038086, 52328.5136680603, 53838.8071308136, 51843.260076999664, 54116.47336387634, 54479.626876831055, 53344.04008293152, 51407.460171699524, 52633.960127830505, 55571.30001831055, 55409.91326713562, 51847.68022489548], "episode_lengths": [136, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 136, 136, 135, 137, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134], "policy_agent_0_reward": [54390.006828308105, 52673.14011192322, 53269.706627845764, 53374.38038063049, 53536.76663208008, 51544.026618003845, 52532.113441467285, 52018.826679229736, 51375.12007558346, 53610.70028114319, 51981.14684295654, 49785.153327941895, 53184.393409729004, 53672.03347015381, 55595.46018218994, 55822.42724609375, 52559.42022037506, 52984.1268787384, 54051.4133605957, 53418.7134437561, 53644.526794433594, 46340.14014148712, 53693.61339187622, 55733.306900024414, 48850.58688545227, 52155.53340911865, 53263.70002365112, 47018.18661689758, 54256.10667800903, 53754.580001831055, 52972.30014038086, 52328.5136680603, 53838.8071308136, 51843.260076999664, 54116.47336387634, 54479.626876831055, 53344.04008293152, 51407.460171699524, 52633.960127830505, 55571.30001831055, 55409.91326713562, 51847.68022489548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.16547992376287, "mean_inference_ms": 6.523734025160782, "mean_action_processing_ms": 0.2017167306885076, "mean_env_wait_ms": 218.05450335559266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05165622347877139, "StateBufferConnector_ms": 0.005986009325299945, "ViewRequirementAgentConnector_ms": 0.26143505459740046}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.88669080764646, "num_env_steps_trained_throughput_per_sec": 279.88669080764646, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 14983.563, "sample_time_ms": 11042.57, "learn_time_ms": 3814.942, "learn_throughput": 1048.509, "synch_weights_time_ms": 125.281}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 4042, "training_iteration": 140, "trial_id": "185f8_00000", "date": "2025-03-21_12-21-46", "timestamp": 1742559706, "time_this_iter_s": 14.329520225524902, "time_total_s": 2230.2635984420776, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2404ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2230.2635984420776, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 95.37142857142857, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.853658536585366, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.782638549804688, "policy_loss": -0.014221246354281902, "vf_loss": 9.795166015625, "vf_explained_var": -2.942979371312049e-08, "kl": 0.008466409519314766, "entropy": 0.39194154739379883, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 56601.01998901367, "episode_reward_min": 44463.74670672417, "episode_reward_mean": 52392.29850888325, "episode_len_mean": 135.2439024390244, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 44463.74670672417}, "policy_reward_max": {"agent_0": 56601.01998901367}, "policy_reward_mean": {"agent_0": 52392.29850888325}, "custom_metrics": {"num_batches_mean": 5.853658536585366, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [44463.74670672417, 49640.44005203247, 53670.7001914978, 49409.20013523102, 53917.54023742676, 53824.47360801697, 46666.533443689346, 47722.206745266914, 52852.01342582703, 55062.506954193115, 54073.49342727661, 52957.740058898926, 52798.23383510113, 55767.06686782837, 52084.98009109497, 52561.29356384277, 48762.79339981079, 54345.17362213135, 51659.486766815186, 52733.41324663162, 55714.86014175415, 54153.36009508371, 52629.32675552368, 53384.29350852966, 54626.60687828064, 53445.973556518555, 52235.34014606476, 56601.01998901367, 54951.426553726196, 49684.033517837524, 52602.72691345215, 51316.06006813049, 49340.36000728607, 56485.70039367676, 55226.86036682129, 51044.193435668945, 50550.15344619751, 51469.40011882782, 53327.840171813965, 52728.153398513794, 53514.886863708496, 54344.77348327637, 54624.0335483551, 54871.41345977783, 54396.76029777527, 44863.026646614075, 52138.440110206604, 56303.90701293945, 51531.39352416992, 53655.41339111328, 45780.26676940918, 51164.506653785706, 52113.24681854248, 50182.38667678833, 53507.82671928406, 54345.6866607666, 54513.013558387756, 50986.64012718201, 55022.246910095215, 53891.19364929199, 53217.520111083984, 54087.986877441406, 56085.186782836914, 52203.25996589661, 45226.339946746826, 50315.26018714905, 53373.30657577515, 47041.48034095764, 49208.18002319336, 55954.880252838135, 55655.053283691406, 48342.066762685776, 53561.900106430054, 51716.42025566101, 54297.43334197998, 51455.57350349426, 54263.13338470459, 53819.360159635544, 47175.36026716232, 54932.28663063049, 52678.72669219971, 53315.97355270386], "episode_lengths": [136, 136, 135, 135, 135, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 134, 135, 137, 135, 135, 136, 136, 134, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 134, 135, 134, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [44463.74670672417, 49640.44005203247, 53670.7001914978, 49409.20013523102, 53917.54023742676, 53824.47360801697, 46666.533443689346, 47722.206745266914, 52852.01342582703, 55062.506954193115, 54073.49342727661, 52957.740058898926, 52798.23383510113, 55767.06686782837, 52084.98009109497, 52561.29356384277, 48762.79339981079, 54345.17362213135, 51659.486766815186, 52733.41324663162, 55714.86014175415, 54153.36009508371, 52629.32675552368, 53384.29350852966, 54626.60687828064, 53445.973556518555, 52235.34014606476, 56601.01998901367, 54951.426553726196, 49684.033517837524, 52602.72691345215, 51316.06006813049, 49340.36000728607, 56485.70039367676, 55226.86036682129, 51044.193435668945, 50550.15344619751, 51469.40011882782, 53327.840171813965, 52728.153398513794, 53514.886863708496, 54344.77348327637, 54624.0335483551, 54871.41345977783, 54396.76029777527, 44863.026646614075, 52138.440110206604, 56303.90701293945, 51531.39352416992, 53655.41339111328, 45780.26676940918, 51164.506653785706, 52113.24681854248, 50182.38667678833, 53507.82671928406, 54345.6866607666, 54513.013558387756, 50986.64012718201, 55022.246910095215, 53891.19364929199, 53217.520111083984, 54087.986877441406, 56085.186782836914, 52203.25996589661, 45226.339946746826, 50315.26018714905, 53373.30657577515, 47041.48034095764, 49208.18002319336, 55954.880252838135, 55655.053283691406, 48342.066762685776, 53561.900106430054, 51716.42025566101, 54297.43334197998, 51455.57350349426, 54263.13338470459, 53819.360159635544, 47175.36026716232, 54932.28663063049, 52678.72669219971, 53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.06128956287583, "mean_inference_ms": 6.697547455771417, "mean_action_processing_ms": 0.20053267511466213, "mean_env_wait_ms": 223.45008136693787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060936590520347035, "StateBufferConnector_ms": 0.006494870999964272, "ViewRequirementAgentConnector_ms": 0.23718112852515244}}, "episode_reward_max": 56601.01998901367, "episode_reward_min": 44463.74670672417, "episode_reward_mean": 52392.29850888325, "episode_len_mean": 135.2439024390244, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 44463.74670672417}, "policy_reward_max": {"agent_0": 56601.01998901367}, "policy_reward_mean": {"agent_0": 52392.29850888325}, "hist_stats": {"episode_reward": [44463.74670672417, 49640.44005203247, 53670.7001914978, 49409.20013523102, 53917.54023742676, 53824.47360801697, 46666.533443689346, 47722.206745266914, 52852.01342582703, 55062.506954193115, 54073.49342727661, 52957.740058898926, 52798.23383510113, 55767.06686782837, 52084.98009109497, 52561.29356384277, 48762.79339981079, 54345.17362213135, 51659.486766815186, 52733.41324663162, 55714.86014175415, 54153.36009508371, 52629.32675552368, 53384.29350852966, 54626.60687828064, 53445.973556518555, 52235.34014606476, 56601.01998901367, 54951.426553726196, 49684.033517837524, 52602.72691345215, 51316.06006813049, 49340.36000728607, 56485.70039367676, 55226.86036682129, 51044.193435668945, 50550.15344619751, 51469.40011882782, 53327.840171813965, 52728.153398513794, 53514.886863708496, 54344.77348327637, 54624.0335483551, 54871.41345977783, 54396.76029777527, 44863.026646614075, 52138.440110206604, 56303.90701293945, 51531.39352416992, 53655.41339111328, 45780.26676940918, 51164.506653785706, 52113.24681854248, 50182.38667678833, 53507.82671928406, 54345.6866607666, 54513.013558387756, 50986.64012718201, 55022.246910095215, 53891.19364929199, 53217.520111083984, 54087.986877441406, 56085.186782836914, 52203.25996589661, 45226.339946746826, 50315.26018714905, 53373.30657577515, 47041.48034095764, 49208.18002319336, 55954.880252838135, 55655.053283691406, 48342.066762685776, 53561.900106430054, 51716.42025566101, 54297.43334197998, 51455.57350349426, 54263.13338470459, 53819.360159635544, 47175.36026716232, 54932.28663063049, 52678.72669219971, 53315.97355270386], "episode_lengths": [136, 136, 135, 135, 135, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 134, 135, 137, 135, 135, 136, 136, 134, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 135, 135, 134, 135, 134, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [44463.74670672417, 49640.44005203247, 53670.7001914978, 49409.20013523102, 53917.54023742676, 53824.47360801697, 46666.533443689346, 47722.206745266914, 52852.01342582703, 55062.506954193115, 54073.49342727661, 52957.740058898926, 52798.23383510113, 55767.06686782837, 52084.98009109497, 52561.29356384277, 48762.79339981079, 54345.17362213135, 51659.486766815186, 52733.41324663162, 55714.86014175415, 54153.36009508371, 52629.32675552368, 53384.29350852966, 54626.60687828064, 53445.973556518555, 52235.34014606476, 56601.01998901367, 54951.426553726196, 49684.033517837524, 52602.72691345215, 51316.06006813049, 49340.36000728607, 56485.70039367676, 55226.86036682129, 51044.193435668945, 50550.15344619751, 51469.40011882782, 53327.840171813965, 52728.153398513794, 53514.886863708496, 54344.77348327637, 54624.0335483551, 54871.41345977783, 54396.76029777527, 44863.026646614075, 52138.440110206604, 56303.90701293945, 51531.39352416992, 53655.41339111328, 45780.26676940918, 51164.506653785706, 52113.24681854248, 50182.38667678833, 53507.82671928406, 54345.6866607666, 54513.013558387756, 50986.64012718201, 55022.246910095215, 53891.19364929199, 53217.520111083984, 54087.986877441406, 56085.186782836914, 52203.25996589661, 45226.339946746826, 50315.26018714905, 53373.30657577515, 47041.48034095764, 49208.18002319336, 55954.880252838135, 55655.053283691406, 48342.066762685776, 53561.900106430054, 51716.42025566101, 54297.43334197998, 51455.57350349426, 54263.13338470459, 53819.360159635544, 47175.36026716232, 54932.28663063049, 52678.72669219971, 53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.06128956287583, "mean_inference_ms": 6.697547455771417, "mean_action_processing_ms": 0.20053267511466213, "mean_env_wait_ms": 223.45008136693787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060936590520347035, "StateBufferConnector_ms": 0.006494870999964272, "ViewRequirementAgentConnector_ms": 0.23718112852515244}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.85537552127164, "num_env_steps_trained_throughput_per_sec": 209.85537552127164, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 15586.825, "sample_time_ms": 11654.993, "learn_time_ms": 3799.806, "learn_throughput": 1052.685, "synch_weights_time_ms": 131.232}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 4124, "training_iteration": 141, "trial_id": "185f8_00000", "date": "2025-03-21_12-22-05", "timestamp": 1742559725, "time_this_iter_s": 19.114198207855225, "time_total_s": 2249.377796649933, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2249.377796649933, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 97.54999999999998, "ram_util_percent": 13.688461538461537}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987961769104004, "policy_loss": -0.013625086285173893, "vf_loss": 10.0, "vf_explained_var": 1.0995815102887718e-07, "kl": 0.007933332584798336, "entropy": 0.39844074845314026, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 53315.97355270386, "episode_reward_min": 53315.97355270386, "episode_reward_mean": 53315.97355270386, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53315.97355270386}, "policy_reward_max": {"agent_0": 53315.97355270386}, "policy_reward_mean": {"agent_0": 53315.97355270386}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53315.97355270386], "episode_lengths": [135], "policy_agent_0_reward": [53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.56174301800009, "mean_inference_ms": 6.687879139743622, "mean_action_processing_ms": 0.2047841257830298, "mean_env_wait_ms": 223.42765851636804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039505958557128906, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1722097396850586}}, "episode_reward_max": 53315.97355270386, "episode_reward_min": 53315.97355270386, "episode_reward_mean": 53315.97355270386, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53315.97355270386}, "policy_reward_max": {"agent_0": 53315.97355270386}, "policy_reward_mean": {"agent_0": 53315.97355270386}, "hist_stats": {"episode_reward": [53315.97355270386], "episode_lengths": [135], "policy_agent_0_reward": [53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.56174301800009, "mean_inference_ms": 6.687879139743622, "mean_action_processing_ms": 0.2047841257830298, "mean_env_wait_ms": 223.42765851636804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039505958557128906, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1722097396850586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.5869475638055, "num_env_steps_trained_throughput_per_sec": 287.5869475638055, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 14958.158, "sample_time_ms": 11013.338, "learn_time_ms": 3811.302, "learn_throughput": 1049.51, "synch_weights_time_ms": 132.757}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 4124, "training_iteration": 142, "trial_id": "185f8_00000", "date": "2025-03-21_12-22-19", "timestamp": 1742559739, "time_this_iter_s": 13.957684516906738, "time_total_s": 2263.3354811668396, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2404ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2263.3354811668396, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.47000000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986745834350586, "policy_loss": -0.0151813430711627, "vf_loss": 10.0, "vf_explained_var": -1.0964770780219624e-07, "kl": 0.009636412374675274, "entropy": 0.4262751638889313, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 53315.97355270386, "episode_reward_min": 53315.97355270386, "episode_reward_mean": 53315.97355270386, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53315.97355270386}, "policy_reward_max": {"agent_0": 53315.97355270386}, "policy_reward_mean": {"agent_0": 53315.97355270386}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53315.97355270386], "episode_lengths": [135], "policy_agent_0_reward": [53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.56174301800009, "mean_inference_ms": 6.687879139743622, "mean_action_processing_ms": 0.2047841257830298, "mean_env_wait_ms": 223.42765851636804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039505958557128906, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1722097396850586}}, "episode_reward_max": 53315.97355270386, "episode_reward_min": 53315.97355270386, "episode_reward_mean": 53315.97355270386, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53315.97355270386}, "policy_reward_max": {"agent_0": 53315.97355270386}, "policy_reward_mean": {"agent_0": 53315.97355270386}, "hist_stats": {"episode_reward": [53315.97355270386], "episode_lengths": [135], "policy_agent_0_reward": [53315.97355270386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.56174301800009, "mean_inference_ms": 6.687879139743622, "mean_action_processing_ms": 0.2047841257830298, "mean_env_wait_ms": 223.42765851636804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039505958557128906, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1722097396850586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9492116734663, "num_env_steps_trained_throughput_per_sec": 292.9492116734663, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 14962.865, "sample_time_ms": 10997.669, "learn_time_ms": 3823.759, "learn_throughput": 1046.091, "synch_weights_time_ms": 140.249}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 4124, "training_iteration": 143, "trial_id": "185f8_00000", "date": "2025-03-21_12-22-33", "timestamp": 1742559753, "time_this_iter_s": 13.710955619812012, "time_total_s": 2277.0464367866516, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2529fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2277.0464367866516, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.535, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.959385871887207, "policy_loss": -0.017864495515823364, "vf_loss": 9.975024223327637, "vf_explained_var": -5.93985123487073e-06, "kl": 0.011128278449177742, "entropy": 0.4431980848312378, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 55883.59376525879, "episode_reward_min": 50796.506732940674, "episode_reward_mean": 53901.70938837528, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 50796.506732940674}, "policy_reward_max": {"agent_0": 55883.59376525879}, "policy_reward_mean": {"agent_0": 53901.70938837528}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53233.5469417572, 50796.506732940674, 53841.90032196045, 55542.28695106506, 51830.33347415924, 54943.56679534912, 55883.59376525879, 55141.94012451172], "episode_lengths": [134, 135, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [53233.5469417572, 50796.506732940674, 53841.90032196045, 55542.28695106506, 51830.33347415924, 54943.56679534912, 55883.59376525879, 55141.94012451172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.161009155522642, "mean_inference_ms": 6.464986582442432, "mean_action_processing_ms": 0.2015920443307117, "mean_env_wait_ms": 210.64663052483658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09036064147949219, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.22394955158233643}}, "episode_reward_max": 55883.59376525879, "episode_reward_min": 50796.506732940674, "episode_reward_mean": 53901.70938837528, "episode_len_mean": 135.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 50796.506732940674}, "policy_reward_max": {"agent_0": 55883.59376525879}, "policy_reward_mean": {"agent_0": 53901.70938837528}, "hist_stats": {"episode_reward": [53233.5469417572, 50796.506732940674, 53841.90032196045, 55542.28695106506, 51830.33347415924, 54943.56679534912, 55883.59376525879, 55141.94012451172], "episode_lengths": [134, 135, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [53233.5469417572, 50796.506732940674, 53841.90032196045, 55542.28695106506, 51830.33347415924, 54943.56679534912, 55883.59376525879, 55141.94012451172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.161009155522642, "mean_inference_ms": 6.464986582442432, "mean_action_processing_ms": 0.2015920443307117, "mean_env_wait_ms": 210.64663052483658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09036064147949219, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.22394955158233643}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4867685833687, "num_env_steps_trained_throughput_per_sec": 294.4867685833687, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 14926.456, "sample_time_ms": 10988.442, "learn_time_ms": 3797.937, "learn_throughput": 1053.203, "synch_weights_time_ms": 138.872}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 4132, "training_iteration": 144, "trial_id": "185f8_00000", "date": "2025-03-21_12-22-46", "timestamp": 1742559766, "time_this_iter_s": 13.63094687461853, "time_total_s": 2290.67738366127, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2290.67738366127, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 98.74736842105263, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.206896551724138, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.696344375610352, "policy_loss": -0.015025557950139046, "vf_loss": 9.709741592407227, "vf_explained_var": 9.850908782027545e-07, "kl": 0.008137285709381104, "entropy": 0.39186951518058777, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 57952.72637176514, "episode_reward_min": 46353.360181331635, "episode_reward_mean": 52935.56704051433, "episode_len_mean": 135.3793103448276, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {"agent_0": 46353.360181331635}, "policy_reward_max": {"agent_0": 57952.72637176514}, "policy_reward_mean": {"agent_0": 52935.56704051433}, "custom_metrics": {"num_batches_mean": 5.206896551724138, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49164.179946899414, 51601.640063762665, 52881.406994342804, 49145.7668800354, 55845.03356170654, 54479.80008506775, 51794.340269088745, 53035.813386917114, 52765.81343078613, 56590.25352478027, 54653.76006317139, 55941.28688812256, 53098.96013832092, 50183.30014383793, 49188.813465595245, 50806.50005531311, 50545.286761283875, 56725.82010650635, 56834.386947631836, 54250.96686935425, 49868.29329872131, 57952.72637176514, 51587.72661399841, 55455.800201416016, 50985.346672058105, 51870.486642837524, 49554.27334213257, 54500.206802368164, 56658.826889038086, 53577.24658203125, 52125.09360122681, 55041.66018676758, 51703.04681777954, 55896.10662841797, 55126.800033569336, 56145.367126464844, 55784.19346618652, 51120.80022716522, 53764.086853027344, 55553.30677604675, 54122.92671966553, 55039.2333946228, 50327.1401386261, 55274.74703979492, 55134.953536987305, 53073.05995941162, 49997.206729888916, 54291.47344970703, 56557.12674713135, 51040.833461761475, 51147.20008087158, 57370.2935256958, 50287.74681472778, 57418.92026901245, 47683.83341503143, 53658.51352787018, 51479.64007949829, 54544.72668838501, 54677.54679107666, 55513.82685089111, 53165.27360534668, 52541.31358337402, 54858.99357509613, 50546.36695098877, 52402.086839199066, 48803.96010684967, 51413.426721572876, 55229.78019142151, 53377.673568725586, 54400.94662475586, 48826.40664219856, 48379.05360126495, 54408.513526916504, 50856.15339279175, 52826.34660720825, 46958.57354235649, 54522.380219459534, 52521.18019962311, 51559.90681838989, 52057.63366699219, 57425.180419921875, 52373.733699798584, 51926.50686836243, 54110.33350586891, 49910.666900634766, 54529.5067615509, 54214.306911468506, 51223.52029418945, 51908.09354019165, 57292.32709503174, 54658.12040519714, 51839.09340572357, 52723.57347488403, 49571.04689025879, 50955.25340008736, 51267.28689002991, 50920.84000778198, 53702.38681411743, 52428.153688430786, 53033.96661376953, 54276.60704040527, 50800.41341972351, 55251.653228759766, 46353.360181331635, 51437.50682258606, 53636.17346954346, 52317.01997947693, 55090.80019378662, 53167.08656311035, 49265.89996051788, 51201.240018844604, 54162.69369316101, 54788.453453063965, 54083.97342681885, 51906.953558921814, 54670.60018157959], "episode_lengths": [136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 136, 136, 135, 134, 135, 136, 134, 135, 135, 134, 135, 135, 134, 135, 135, 136, 135, 136, 135, 134, 136, 135, 136, 136, 134, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 134, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 136, 135, 134, 135, 135, 136, 136, 137, 136, 134, 135, 135, 136, 136, 135, 136, 137, 136, 135, 135], "policy_agent_0_reward": [49164.179946899414, 51601.640063762665, 52881.406994342804, 49145.7668800354, 55845.03356170654, 54479.80008506775, 51794.340269088745, 53035.813386917114, 52765.81343078613, 56590.25352478027, 54653.76006317139, 55941.28688812256, 53098.96013832092, 50183.30014383793, 49188.813465595245, 50806.50005531311, 50545.286761283875, 56725.82010650635, 56834.386947631836, 54250.96686935425, 49868.29329872131, 57952.72637176514, 51587.72661399841, 55455.800201416016, 50985.346672058105, 51870.486642837524, 49554.27334213257, 54500.206802368164, 56658.826889038086, 53577.24658203125, 52125.09360122681, 55041.66018676758, 51703.04681777954, 55896.10662841797, 55126.800033569336, 56145.367126464844, 55784.19346618652, 51120.80022716522, 53764.086853027344, 55553.30677604675, 54122.92671966553, 55039.2333946228, 50327.1401386261, 55274.74703979492, 55134.953536987305, 53073.05995941162, 49997.206729888916, 54291.47344970703, 56557.12674713135, 51040.833461761475, 51147.20008087158, 57370.2935256958, 50287.74681472778, 57418.92026901245, 47683.83341503143, 53658.51352787018, 51479.64007949829, 54544.72668838501, 54677.54679107666, 55513.82685089111, 53165.27360534668, 52541.31358337402, 54858.99357509613, 50546.36695098877, 52402.086839199066, 48803.96010684967, 51413.426721572876, 55229.78019142151, 53377.673568725586, 54400.94662475586, 48826.40664219856, 48379.05360126495, 54408.513526916504, 50856.15339279175, 52826.34660720825, 46958.57354235649, 54522.380219459534, 52521.18019962311, 51559.90681838989, 52057.63366699219, 57425.180419921875, 52373.733699798584, 51926.50686836243, 54110.33350586891, 49910.666900634766, 54529.5067615509, 54214.306911468506, 51223.52029418945, 51908.09354019165, 57292.32709503174, 54658.12040519714, 51839.09340572357, 52723.57347488403, 49571.04689025879, 50955.25340008736, 51267.28689002991, 50920.84000778198, 53702.38681411743, 52428.153688430786, 53033.96661376953, 54276.60704040527, 50800.41341972351, 55251.653228759766, 46353.360181331635, 51437.50682258606, 53636.17346954346, 52317.01997947693, 55090.80019378662, 53167.08656311035, 49265.89996051788, 51201.240018844604, 54162.69369316101, 54788.453453063965, 54083.97342681885, 51906.953558921814, 54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.539376698263716, "mean_inference_ms": 6.642899343027074, "mean_action_processing_ms": 0.20083797461770794, "mean_env_wait_ms": 222.05722507494215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08288519135836897, "StateBufferConnector_ms": 0.006177713131082469, "ViewRequirementAgentConnector_ms": 0.21294951438903809}}, "episode_reward_max": 57952.72637176514, "episode_reward_min": 46353.360181331635, "episode_reward_mean": 52935.56704051433, "episode_len_mean": 135.3793103448276, "episodes_this_iter": 116, "policy_reward_min": {"agent_0": 46353.360181331635}, "policy_reward_max": {"agent_0": 57952.72637176514}, "policy_reward_mean": {"agent_0": 52935.56704051433}, "hist_stats": {"episode_reward": [49164.179946899414, 51601.640063762665, 52881.406994342804, 49145.7668800354, 55845.03356170654, 54479.80008506775, 51794.340269088745, 53035.813386917114, 52765.81343078613, 56590.25352478027, 54653.76006317139, 55941.28688812256, 53098.96013832092, 50183.30014383793, 49188.813465595245, 50806.50005531311, 50545.286761283875, 56725.82010650635, 56834.386947631836, 54250.96686935425, 49868.29329872131, 57952.72637176514, 51587.72661399841, 55455.800201416016, 50985.346672058105, 51870.486642837524, 49554.27334213257, 54500.206802368164, 56658.826889038086, 53577.24658203125, 52125.09360122681, 55041.66018676758, 51703.04681777954, 55896.10662841797, 55126.800033569336, 56145.367126464844, 55784.19346618652, 51120.80022716522, 53764.086853027344, 55553.30677604675, 54122.92671966553, 55039.2333946228, 50327.1401386261, 55274.74703979492, 55134.953536987305, 53073.05995941162, 49997.206729888916, 54291.47344970703, 56557.12674713135, 51040.833461761475, 51147.20008087158, 57370.2935256958, 50287.74681472778, 57418.92026901245, 47683.83341503143, 53658.51352787018, 51479.64007949829, 54544.72668838501, 54677.54679107666, 55513.82685089111, 53165.27360534668, 52541.31358337402, 54858.99357509613, 50546.36695098877, 52402.086839199066, 48803.96010684967, 51413.426721572876, 55229.78019142151, 53377.673568725586, 54400.94662475586, 48826.40664219856, 48379.05360126495, 54408.513526916504, 50856.15339279175, 52826.34660720825, 46958.57354235649, 54522.380219459534, 52521.18019962311, 51559.90681838989, 52057.63366699219, 57425.180419921875, 52373.733699798584, 51926.50686836243, 54110.33350586891, 49910.666900634766, 54529.5067615509, 54214.306911468506, 51223.52029418945, 51908.09354019165, 57292.32709503174, 54658.12040519714, 51839.09340572357, 52723.57347488403, 49571.04689025879, 50955.25340008736, 51267.28689002991, 50920.84000778198, 53702.38681411743, 52428.153688430786, 53033.96661376953, 54276.60704040527, 50800.41341972351, 55251.653228759766, 46353.360181331635, 51437.50682258606, 53636.17346954346, 52317.01997947693, 55090.80019378662, 53167.08656311035, 49265.89996051788, 51201.240018844604, 54162.69369316101, 54788.453453063965, 54083.97342681885, 51906.953558921814, 54670.60018157959], "episode_lengths": [136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 136, 136, 135, 134, 135, 136, 134, 135, 135, 134, 135, 135, 134, 135, 135, 136, 135, 136, 135, 134, 136, 135, 136, 136, 134, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 134, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 136, 135, 134, 135, 135, 136, 136, 137, 136, 134, 135, 135, 136, 136, 135, 136, 137, 136, 135, 135], "policy_agent_0_reward": [49164.179946899414, 51601.640063762665, 52881.406994342804, 49145.7668800354, 55845.03356170654, 54479.80008506775, 51794.340269088745, 53035.813386917114, 52765.81343078613, 56590.25352478027, 54653.76006317139, 55941.28688812256, 53098.96013832092, 50183.30014383793, 49188.813465595245, 50806.50005531311, 50545.286761283875, 56725.82010650635, 56834.386947631836, 54250.96686935425, 49868.29329872131, 57952.72637176514, 51587.72661399841, 55455.800201416016, 50985.346672058105, 51870.486642837524, 49554.27334213257, 54500.206802368164, 56658.826889038086, 53577.24658203125, 52125.09360122681, 55041.66018676758, 51703.04681777954, 55896.10662841797, 55126.800033569336, 56145.367126464844, 55784.19346618652, 51120.80022716522, 53764.086853027344, 55553.30677604675, 54122.92671966553, 55039.2333946228, 50327.1401386261, 55274.74703979492, 55134.953536987305, 53073.05995941162, 49997.206729888916, 54291.47344970703, 56557.12674713135, 51040.833461761475, 51147.20008087158, 57370.2935256958, 50287.74681472778, 57418.92026901245, 47683.83341503143, 53658.51352787018, 51479.64007949829, 54544.72668838501, 54677.54679107666, 55513.82685089111, 53165.27360534668, 52541.31358337402, 54858.99357509613, 50546.36695098877, 52402.086839199066, 48803.96010684967, 51413.426721572876, 55229.78019142151, 53377.673568725586, 54400.94662475586, 48826.40664219856, 48379.05360126495, 54408.513526916504, 50856.15339279175, 52826.34660720825, 46958.57354235649, 54522.380219459534, 52521.18019962311, 51559.90681838989, 52057.63366699219, 57425.180419921875, 52373.733699798584, 51926.50686836243, 54110.33350586891, 49910.666900634766, 54529.5067615509, 54214.306911468506, 51223.52029418945, 51908.09354019165, 57292.32709503174, 54658.12040519714, 51839.09340572357, 52723.57347488403, 49571.04689025879, 50955.25340008736, 51267.28689002991, 50920.84000778198, 53702.38681411743, 52428.153688430786, 53033.96661376953, 54276.60704040527, 50800.41341972351, 55251.653228759766, 46353.360181331635, 51437.50682258606, 53636.17346954346, 52317.01997947693, 55090.80019378662, 53167.08656311035, 49265.89996051788, 51201.240018844604, 54162.69369316101, 54788.453453063965, 54083.97342681885, 51906.953558921814, 54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.539376698263716, "mean_inference_ms": 6.642899343027074, "mean_action_processing_ms": 0.20083797461770794, "mean_env_wait_ms": 222.05722507494215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08288519135836897, "StateBufferConnector_ms": 0.006177713131082469, "ViewRequirementAgentConnector_ms": 0.21294951438903809}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.89256653763923, "num_env_steps_trained_throughput_per_sec": 188.89256653763923, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 15658.407, "sample_time_ms": 11679.786, "learn_time_ms": 3836.419, "learn_throughput": 1042.639, "synch_weights_time_ms": 140.995}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 4248, "training_iteration": 145, "trial_id": "185f8_00000", "date": "2025-03-21_12-23-08", "timestamp": 1742559788, "time_this_iter_s": 21.247620105743408, "time_total_s": 2311.9250037670135, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a215bc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2311.9250037670135, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 91.48666666666666, "ram_util_percent": 13.696666666666662}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98859691619873, "policy_loss": -0.013276559300720692, "vf_loss": 10.0, "vf_explained_var": -9.567786918296406e-08, "kl": 0.009369401261210442, "entropy": 0.3838121294975281, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 54670.60018157959, "episode_reward_min": 54670.60018157959, "episode_reward_mean": 54670.60018157959, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54670.60018157959}, "policy_reward_max": {"agent_0": 54670.60018157959}, "policy_reward_mean": {"agent_0": 54670.60018157959}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54670.60018157959], "episode_lengths": [135], "policy_agent_0_reward": [54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.735531277400725, "mean_inference_ms": 6.284750065292888, "mean_action_processing_ms": 0.2014010252045342, "mean_env_wait_ms": 230.69100116917966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.2331256866455078}}, "episode_reward_max": 54670.60018157959, "episode_reward_min": 54670.60018157959, "episode_reward_mean": 54670.60018157959, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54670.60018157959}, "policy_reward_max": {"agent_0": 54670.60018157959}, "policy_reward_mean": {"agent_0": 54670.60018157959}, "hist_stats": {"episode_reward": [54670.60018157959], "episode_lengths": [135], "policy_agent_0_reward": [54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.735531277400725, "mean_inference_ms": 6.284750065292888, "mean_action_processing_ms": 0.2014010252045342, "mean_env_wait_ms": 230.69100116917966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.2331256866455078}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.48485729601214, "num_env_steps_trained_throughput_per_sec": 265.48485729601214, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 15184.996, "sample_time_ms": 11108.514, "learn_time_ms": 3932.195, "learn_throughput": 1017.243, "synch_weights_time_ms": 143.109}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 4248, "training_iteration": 146, "trial_id": "185f8_00000", "date": "2025-03-21_12-23-23", "timestamp": 1742559803, "time_this_iter_s": 15.123768329620361, "time_total_s": 2327.048772096634, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2327.048772096634, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.52727272727275, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983739852905273, "policy_loss": -0.018484031781554222, "vf_loss": 10.0, "vf_explained_var": 1.7341226055123116e-07, "kl": 0.011120850220322609, "entropy": 0.4216693937778473, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 54670.60018157959, "episode_reward_min": 54670.60018157959, "episode_reward_mean": 54670.60018157959, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54670.60018157959}, "policy_reward_max": {"agent_0": 54670.60018157959}, "policy_reward_mean": {"agent_0": 54670.60018157959}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54670.60018157959], "episode_lengths": [135], "policy_agent_0_reward": [54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.735531277400725, "mean_inference_ms": 6.284750065292888, "mean_action_processing_ms": 0.2014010252045342, "mean_env_wait_ms": 230.69100116917966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.2331256866455078}}, "episode_reward_max": 54670.60018157959, "episode_reward_min": 54670.60018157959, "episode_reward_mean": 54670.60018157959, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54670.60018157959}, "policy_reward_max": {"agent_0": 54670.60018157959}, "policy_reward_mean": {"agent_0": 54670.60018157959}, "hist_stats": {"episode_reward": [54670.60018157959], "episode_lengths": [135], "policy_agent_0_reward": [54670.60018157959]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.735531277400725, "mean_inference_ms": 6.284750065292888, "mean_action_processing_ms": 0.2014010252045342, "mean_env_wait_ms": 230.69100116917966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.2331256866455078}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.89917721224924, "num_env_steps_trained_throughput_per_sec": 280.89917721224924, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 15250.646, "sample_time_ms": 11118.41, "learn_time_ms": 3979.441, "learn_throughput": 1005.166, "synch_weights_time_ms": 151.582}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 4248, "training_iteration": 147, "trial_id": "185f8_00000", "date": "2025-03-21_12-23-37", "timestamp": 1742559817, "time_this_iter_s": 14.299589395523071, "time_total_s": 2341.348361492157, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a215bc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2341.348361492157, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.54, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985074996948242, "policy_loss": -0.011994141153991222, "vf_loss": 9.995359420776367, "vf_explained_var": 2.3034711205127678e-07, "kl": 0.008547077886760235, "entropy": 0.4389681816101074, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 54274.08680725098, "episode_reward_min": 54274.08680725098, "episode_reward_mean": 54274.08680725098, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54274.08680725098}, "policy_reward_max": {"agent_0": 54274.08680725098}, "policy_reward_mean": {"agent_0": 54274.08680725098}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54274.08680725098], "episode_lengths": [135], "policy_agent_0_reward": [54274.08680725098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.623553113049105, "mean_inference_ms": 6.235595808546521, "mean_action_processing_ms": 0.1941148431908755, "mean_env_wait_ms": 212.62211023602052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042366981506347656, "StateBufferConnector_ms": 0.005650520324707031, "ViewRequirementAgentConnector_ms": 0.17693042755126953}}, "episode_reward_max": 54274.08680725098, "episode_reward_min": 54274.08680725098, "episode_reward_mean": 54274.08680725098, "episode_len_mean": 135.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54274.08680725098}, "policy_reward_max": {"agent_0": 54274.08680725098}, "policy_reward_mean": {"agent_0": 54274.08680725098}, "hist_stats": {"episode_reward": [54274.08680725098], "episode_lengths": [135], "policy_agent_0_reward": [54274.08680725098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.623553113049105, "mean_inference_ms": 6.235595808546521, "mean_action_processing_ms": 0.1941148431908755, "mean_env_wait_ms": 212.62211023602052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042366981506347656, "StateBufferConnector_ms": 0.005650520324707031, "ViewRequirementAgentConnector_ms": 0.17693042755126953}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.3504733163315, "num_env_steps_trained_throughput_per_sec": 287.3504733163315, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15237.25, "sample_time_ms": 11106.908, "learn_time_ms": 3970.895, "learn_throughput": 1007.329, "synch_weights_time_ms": 158.227}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 4249, "training_iteration": 148, "trial_id": "185f8_00000", "date": "2025-03-21_12-23-51", "timestamp": 1742559831, "time_this_iter_s": 13.970708131790161, "time_total_s": 2355.319069623947, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f7d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2355.319069623947, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 99.00500000000002, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.040650406504065, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.679463386535645, "policy_loss": -0.015213345177471638, "vf_loss": 9.69279956817627, "vf_explained_var": -1.1660158349968697e-07, "kl": 0.009381280280649662, "entropy": 0.41578352451324463, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 58489.14028930664, "episode_reward_min": 43684.460176467896, "episode_reward_mean": 53011.39845437926, "episode_len_mean": 135.3170731707317, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 43684.460176467896}, "policy_reward_max": {"agent_0": 58489.14028930664}, "policy_reward_mean": {"agent_0": 53011.39845437926}, "custom_metrics": {"num_batches_mean": 5.040650406504065, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56224.34034729004, 57810.37365722656, 54810.97351074219, 56543.12673187256, 52885.86025238037, 53699.11333465576, 58489.14028930664, 50511.260108947754, 53823.58026123047, 53398.046966552734, 57346.353454589844, 53449.01345252991, 52572.90670776367, 53765.573526382446, 50918.55349159241, 49327.02676677704, 55287.26714324951, 55758.12008666992, 56143.38008117676, 56961.753829956055, 53273.8534412384, 55193.66023635864, 46799.94024658203, 54970.62003326416, 47380.806629657745, 54675.4603805542, 54480.48662567139, 52890.89337539673, 53552.6266708374, 48505.70017361641, 53805.67357635498, 50345.546880722046, 54703.35339355469, 49029.87335681915, 56016.66008758545, 53277.68667793274, 55511.2868347168, 53136.946659088135, 49234.52672576904, 49732.16670656204, 54607.32660102844, 53521.24685668945, 50384.000282764435, 50808.68004274368, 47725.50677537918, 54431.03341674805, 47403.68702316284, 49662.16006278992, 54061.473445892334, 50722.16683769226, 55349.20669174194, 52777.313400268555, 54650.30674743652, 55164.20018005371, 56324.12676239014, 54968.9133682251, 48777.20678329468, 47254.19341850281, 51585.12688064575, 50878.81336402893, 53321.546741485596, 51909.90662384033, 52665.5468082428, 53786.74659729004, 54694.29353713989, 55822.18684387207, 54014.20004653931, 54933.51377868652, 48034.993368148804, 57298.80000305176, 53460.226665496826, 48849.81353855133, 51079.293422698975, 55100.80027008057, 53736.100131988525, 53966.25341796875, 51341.806611061096, 55987.50012969971, 55165.619972229004, 55629.54658508301, 55705.033529281616, 53375.706729888916, 50880.73999786377, 55816.293785095215, 53931.84678649902, 54510.5336227417, 52555.98006057739, 53378.753509521484, 50149.94680595398, 54144.360176086426, 52326.3198890686, 50212.11358833313, 54100.93350982666, 54129.27996635437, 49229.666872024536, 53408.813552856445, 53259.72026634216, 52273.3401966095, 46838.14013671875, 53118.6672744751, 53329.30691719055, 55249.35350036621, 52115.26684761047, 53145.90673470497, 52423.71376037598, 55642.96000671387, 54846.97358894348, 52959.946798324585, 55111.386779785156, 51139.9270401001, 52823.62685775757, 52863.68006896973, 53952.49341583252, 43684.460176467896, 51786.66007232666, 56845.74674987793, 50683.34658432007, 57003.82704925537, 53594.619956970215, 49084.2334022522, 50686.406765937805, 54888.926818847656, 55094.13299179077], "episode_lengths": [135, 135, 135, 135, 135, 135, 134, 136, 135, 136, 134, 135, 136, 135, 135, 136, 135, 134, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 137, 134, 135, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 136, 135], "policy_agent_0_reward": [56224.34034729004, 57810.37365722656, 54810.97351074219, 56543.12673187256, 52885.86025238037, 53699.11333465576, 58489.14028930664, 50511.260108947754, 53823.58026123047, 53398.046966552734, 57346.353454589844, 53449.01345252991, 52572.90670776367, 53765.573526382446, 50918.55349159241, 49327.02676677704, 55287.26714324951, 55758.12008666992, 56143.38008117676, 56961.753829956055, 53273.8534412384, 55193.66023635864, 46799.94024658203, 54970.62003326416, 47380.806629657745, 54675.4603805542, 54480.48662567139, 52890.89337539673, 53552.6266708374, 48505.70017361641, 53805.67357635498, 50345.546880722046, 54703.35339355469, 49029.87335681915, 56016.66008758545, 53277.68667793274, 55511.2868347168, 53136.946659088135, 49234.52672576904, 49732.16670656204, 54607.32660102844, 53521.24685668945, 50384.000282764435, 50808.68004274368, 47725.50677537918, 54431.03341674805, 47403.68702316284, 49662.16006278992, 54061.473445892334, 50722.16683769226, 55349.20669174194, 52777.313400268555, 54650.30674743652, 55164.20018005371, 56324.12676239014, 54968.9133682251, 48777.20678329468, 47254.19341850281, 51585.12688064575, 50878.81336402893, 53321.546741485596, 51909.90662384033, 52665.5468082428, 53786.74659729004, 54694.29353713989, 55822.18684387207, 54014.20004653931, 54933.51377868652, 48034.993368148804, 57298.80000305176, 53460.226665496826, 48849.81353855133, 51079.293422698975, 55100.80027008057, 53736.100131988525, 53966.25341796875, 51341.806611061096, 55987.50012969971, 55165.619972229004, 55629.54658508301, 55705.033529281616, 53375.706729888916, 50880.73999786377, 55816.293785095215, 53931.84678649902, 54510.5336227417, 52555.98006057739, 53378.753509521484, 50149.94680595398, 54144.360176086426, 52326.3198890686, 50212.11358833313, 54100.93350982666, 54129.27996635437, 49229.666872024536, 53408.813552856445, 53259.72026634216, 52273.3401966095, 46838.14013671875, 53118.6672744751, 53329.30691719055, 55249.35350036621, 52115.26684761047, 53145.90673470497, 52423.71376037598, 55642.96000671387, 54846.97358894348, 52959.946798324585, 55111.386779785156, 51139.9270401001, 52823.62685775757, 52863.68006896973, 53952.49341583252, 43684.460176467896, 51786.66007232666, 56845.74674987793, 50683.34658432007, 57003.82704925537, 53594.619956970215, 49084.2334022522, 50686.406765937805, 54888.926818847656, 55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.32813859840905, "mean_inference_ms": 6.634534253904457, "mean_action_processing_ms": 0.20087846874697374, "mean_env_wait_ms": 221.32729794854077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04016403260269785, "StateBufferConnector_ms": 0.006040131173482756, "ViewRequirementAgentConnector_ms": 0.25429570577978117}}, "episode_reward_max": 58489.14028930664, "episode_reward_min": 43684.460176467896, "episode_reward_mean": 53011.39845437926, "episode_len_mean": 135.3170731707317, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 43684.460176467896}, "policy_reward_max": {"agent_0": 58489.14028930664}, "policy_reward_mean": {"agent_0": 53011.39845437926}, "hist_stats": {"episode_reward": [56224.34034729004, 57810.37365722656, 54810.97351074219, 56543.12673187256, 52885.86025238037, 53699.11333465576, 58489.14028930664, 50511.260108947754, 53823.58026123047, 53398.046966552734, 57346.353454589844, 53449.01345252991, 52572.90670776367, 53765.573526382446, 50918.55349159241, 49327.02676677704, 55287.26714324951, 55758.12008666992, 56143.38008117676, 56961.753829956055, 53273.8534412384, 55193.66023635864, 46799.94024658203, 54970.62003326416, 47380.806629657745, 54675.4603805542, 54480.48662567139, 52890.89337539673, 53552.6266708374, 48505.70017361641, 53805.67357635498, 50345.546880722046, 54703.35339355469, 49029.87335681915, 56016.66008758545, 53277.68667793274, 55511.2868347168, 53136.946659088135, 49234.52672576904, 49732.16670656204, 54607.32660102844, 53521.24685668945, 50384.000282764435, 50808.68004274368, 47725.50677537918, 54431.03341674805, 47403.68702316284, 49662.16006278992, 54061.473445892334, 50722.16683769226, 55349.20669174194, 52777.313400268555, 54650.30674743652, 55164.20018005371, 56324.12676239014, 54968.9133682251, 48777.20678329468, 47254.19341850281, 51585.12688064575, 50878.81336402893, 53321.546741485596, 51909.90662384033, 52665.5468082428, 53786.74659729004, 54694.29353713989, 55822.18684387207, 54014.20004653931, 54933.51377868652, 48034.993368148804, 57298.80000305176, 53460.226665496826, 48849.81353855133, 51079.293422698975, 55100.80027008057, 53736.100131988525, 53966.25341796875, 51341.806611061096, 55987.50012969971, 55165.619972229004, 55629.54658508301, 55705.033529281616, 53375.706729888916, 50880.73999786377, 55816.293785095215, 53931.84678649902, 54510.5336227417, 52555.98006057739, 53378.753509521484, 50149.94680595398, 54144.360176086426, 52326.3198890686, 50212.11358833313, 54100.93350982666, 54129.27996635437, 49229.666872024536, 53408.813552856445, 53259.72026634216, 52273.3401966095, 46838.14013671875, 53118.6672744751, 53329.30691719055, 55249.35350036621, 52115.26684761047, 53145.90673470497, 52423.71376037598, 55642.96000671387, 54846.97358894348, 52959.946798324585, 55111.386779785156, 51139.9270401001, 52823.62685775757, 52863.68006896973, 53952.49341583252, 43684.460176467896, 51786.66007232666, 56845.74674987793, 50683.34658432007, 57003.82704925537, 53594.619956970215, 49084.2334022522, 50686.406765937805, 54888.926818847656, 55094.13299179077], "episode_lengths": [135, 135, 135, 135, 135, 135, 134, 136, 135, 136, 134, 135, 136, 135, 135, 136, 135, 134, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 137, 134, 135, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 136, 135], "policy_agent_0_reward": [56224.34034729004, 57810.37365722656, 54810.97351074219, 56543.12673187256, 52885.86025238037, 53699.11333465576, 58489.14028930664, 50511.260108947754, 53823.58026123047, 53398.046966552734, 57346.353454589844, 53449.01345252991, 52572.90670776367, 53765.573526382446, 50918.55349159241, 49327.02676677704, 55287.26714324951, 55758.12008666992, 56143.38008117676, 56961.753829956055, 53273.8534412384, 55193.66023635864, 46799.94024658203, 54970.62003326416, 47380.806629657745, 54675.4603805542, 54480.48662567139, 52890.89337539673, 53552.6266708374, 48505.70017361641, 53805.67357635498, 50345.546880722046, 54703.35339355469, 49029.87335681915, 56016.66008758545, 53277.68667793274, 55511.2868347168, 53136.946659088135, 49234.52672576904, 49732.16670656204, 54607.32660102844, 53521.24685668945, 50384.000282764435, 50808.68004274368, 47725.50677537918, 54431.03341674805, 47403.68702316284, 49662.16006278992, 54061.473445892334, 50722.16683769226, 55349.20669174194, 52777.313400268555, 54650.30674743652, 55164.20018005371, 56324.12676239014, 54968.9133682251, 48777.20678329468, 47254.19341850281, 51585.12688064575, 50878.81336402893, 53321.546741485596, 51909.90662384033, 52665.5468082428, 53786.74659729004, 54694.29353713989, 55822.18684387207, 54014.20004653931, 54933.51377868652, 48034.993368148804, 57298.80000305176, 53460.226665496826, 48849.81353855133, 51079.293422698975, 55100.80027008057, 53736.100131988525, 53966.25341796875, 51341.806611061096, 55987.50012969971, 55165.619972229004, 55629.54658508301, 55705.033529281616, 53375.706729888916, 50880.73999786377, 55816.293785095215, 53931.84678649902, 54510.5336227417, 52555.98006057739, 53378.753509521484, 50149.94680595398, 54144.360176086426, 52326.3198890686, 50212.11358833313, 54100.93350982666, 54129.27996635437, 49229.666872024536, 53408.813552856445, 53259.72026634216, 52273.3401966095, 46838.14013671875, 53118.6672744751, 53329.30691719055, 55249.35350036621, 52115.26684761047, 53145.90673470497, 52423.71376037598, 55642.96000671387, 54846.97358894348, 52959.946798324585, 55111.386779785156, 51139.9270401001, 52823.62685775757, 52863.68006896973, 53952.49341583252, 43684.460176467896, 51786.66007232666, 56845.74674987793, 50683.34658432007, 57003.82704925537, 53594.619956970215, 49084.2334022522, 50686.406765937805, 54888.926818847656, 55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.32813859840905, "mean_inference_ms": 6.634534253904457, "mean_action_processing_ms": 0.20087846874697374, "mean_env_wait_ms": 221.32729794854077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04016403260269785, "StateBufferConnector_ms": 0.006040131173482756, "ViewRequirementAgentConnector_ms": 0.25429570577978117}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.75815473131178, "num_env_steps_trained_throughput_per_sec": 183.75815473131178, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 16066.834, "sample_time_ms": 11845.015, "learn_time_ms": 4056.706, "learn_throughput": 986.022, "synch_weights_time_ms": 163.912}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 4372, "training_iteration": 149, "trial_id": "185f8_00000", "date": "2025-03-21_12-24-13", "timestamp": 1742559853, "time_this_iter_s": 21.834933757781982, "time_total_s": 2377.154003381729, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2377.154003381729, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 92.12068965517243, "ram_util_percent": 13.686206896551722}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986539840698242, "policy_loss": -0.015285027213394642, "vf_loss": 10.0, "vf_explained_var": 2.3289273087812035e-07, "kl": 0.009125561453402042, "entropy": 0.41329580545425415, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 55094.13299179077, "episode_reward_min": 55094.13299179077, "episode_reward_mean": 55094.13299179077, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55094.13299179077}, "policy_reward_max": {"agent_0": 55094.13299179077}, "policy_reward_mean": {"agent_0": 55094.13299179077}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55094.13299179077], "episode_lengths": [135], "policy_agent_0_reward": [55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.606213761015894, "mean_inference_ms": 6.262027784872665, "mean_action_processing_ms": 0.2009649650684116, "mean_env_wait_ms": 230.34105827833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029420852661132812, "StateBufferConnector_ms": 0.004649162292480469, "ViewRequirementAgentConnector_ms": 0.1489877700805664}}, "episode_reward_max": 55094.13299179077, "episode_reward_min": 55094.13299179077, "episode_reward_mean": 55094.13299179077, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55094.13299179077}, "policy_reward_max": {"agent_0": 55094.13299179077}, "policy_reward_mean": {"agent_0": 55094.13299179077}, "hist_stats": {"episode_reward": [55094.13299179077], "episode_lengths": [135], "policy_agent_0_reward": [55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.606213761015894, "mean_inference_ms": 6.262027784872665, "mean_action_processing_ms": 0.2009649650684116, "mean_env_wait_ms": 230.34105827833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029420852661132812, "StateBufferConnector_ms": 0.004649162292480469, "ViewRequirementAgentConnector_ms": 0.1489877700805664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.41269547049455, "num_env_steps_trained_throughput_per_sec": 287.41269547049455, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 16029.41, "sample_time_ms": 11748.343, "learn_time_ms": 4109.799, "learn_throughput": 973.284, "synch_weights_time_ms": 170.067}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 4372, "training_iteration": 150, "trial_id": "185f8_00000", "date": "2025-03-21_12-24-27", "timestamp": 1742559867, "time_this_iter_s": 13.972041606903076, "time_total_s": 2391.126044988632, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2158af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2391.126044988632, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.47500000000001, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986703872680664, "policy_loss": -0.015266931615769863, "vf_loss": 10.0, "vf_explained_var": 1.956398278935012e-07, "kl": 0.009852577932178974, "entropy": 0.40713903307914734, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": 55094.13299179077, "episode_reward_min": 55094.13299179077, "episode_reward_mean": 55094.13299179077, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55094.13299179077}, "policy_reward_max": {"agent_0": 55094.13299179077}, "policy_reward_mean": {"agent_0": 55094.13299179077}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55094.13299179077], "episode_lengths": [135], "policy_agent_0_reward": [55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.606213761015894, "mean_inference_ms": 6.262027784872665, "mean_action_processing_ms": 0.2009649650684116, "mean_env_wait_ms": 230.34105827833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029420852661132812, "StateBufferConnector_ms": 0.004649162292480469, "ViewRequirementAgentConnector_ms": 0.1489877700805664}}, "episode_reward_max": 55094.13299179077, "episode_reward_min": 55094.13299179077, "episode_reward_mean": 55094.13299179077, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55094.13299179077}, "policy_reward_max": {"agent_0": 55094.13299179077}, "policy_reward_mean": {"agent_0": 55094.13299179077}, "hist_stats": {"episode_reward": [55094.13299179077], "episode_lengths": [135], "policy_agent_0_reward": [55094.13299179077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.606213761015894, "mean_inference_ms": 6.262027784872665, "mean_action_processing_ms": 0.2009649650684116, "mean_env_wait_ms": 230.34105827833878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029420852661132812, "StateBufferConnector_ms": 0.004649162292480469, "ViewRequirementAgentConnector_ms": 0.1489877700805664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.1972409670155, "num_env_steps_trained_throughput_per_sec": 279.1972409670155, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 15556.015, "sample_time_ms": 11191.071, "learn_time_ms": 4198.685, "learn_throughput": 952.679, "synch_weights_time_ms": 165.08}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 4372, "training_iteration": 151, "trial_id": "185f8_00000", "date": "2025-03-21_12-24-42", "timestamp": 1742559882, "time_this_iter_s": 14.370448350906372, "time_total_s": 2405.4964933395386, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2405.4964933395386, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.57500000000002, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983549118041992, "policy_loss": -0.015786223113536835, "vf_loss": 9.997314453125, "vf_explained_var": 1.8986563077305618e-07, "kl": 0.010105366818606853, "entropy": 0.36027398705482483, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": 54414.000217437744, "episode_reward_min": 54414.000217437744, "episode_reward_mean": 54414.000217437744, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54414.000217437744}, "policy_reward_max": {"agent_0": 54414.000217437744}, "policy_reward_mean": {"agent_0": 54414.000217437744}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54414.000217437744], "episode_lengths": [134], "policy_agent_0_reward": [54414.000217437744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.049054838685798, "mean_inference_ms": 6.2297387547955845, "mean_action_processing_ms": 0.1939420375021801, "mean_env_wait_ms": 212.441856699064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357959747314453, "StateBufferConnector_ms": 0.003814697265625, "ViewRequirementAgentConnector_ms": 0.10471343994140625}}, "episode_reward_max": 54414.000217437744, "episode_reward_min": 54414.000217437744, "episode_reward_mean": 54414.000217437744, "episode_len_mean": 134.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54414.000217437744}, "policy_reward_max": {"agent_0": 54414.000217437744}, "policy_reward_mean": {"agent_0": 54414.000217437744}, "hist_stats": {"episode_reward": [54414.000217437744], "episode_lengths": [134], "policy_agent_0_reward": [54414.000217437744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.049054838685798, "mean_inference_ms": 6.2297387547955845, "mean_action_processing_ms": 0.1939420375021801, "mean_env_wait_ms": 212.441856699064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357959747314453, "StateBufferConnector_ms": 0.003814697265625, "ViewRequirementAgentConnector_ms": 0.10471343994140625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.99338248589, "num_env_steps_trained_throughput_per_sec": 278.99338248589, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15598.858, "sample_time_ms": 11214.298, "learn_time_ms": 4216.876, "learn_throughput": 948.57, "synch_weights_time_ms": 166.507}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 4373, "training_iteration": 152, "trial_id": "185f8_00000", "date": "2025-03-21_12-24-56", "timestamp": 1742559896, "time_this_iter_s": 14.38796615600586, "time_total_s": 2419.8844594955444, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a21581f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2419.8844594955444, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.51428571428575, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.683700561523438, "policy_loss": -0.014699837192893028, "vf_loss": 9.696535110473633, "vf_explained_var": 7.211540946627792e-07, "kl": 0.00932427030056715, "entropy": 0.41315504908561707, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 57853.693603515625, "episode_reward_min": 45008.480021476746, "episode_reward_mean": 52663.65364427107, "episode_len_mean": 135.2622950819672, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {"agent_0": 45008.480021476746}, "policy_reward_max": {"agent_0": 57853.693603515625}, "policy_reward_mean": {"agent_0": 52663.65364427107}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54653.91351699829, 55760.540130615234, 53984.01999473572, 55845.21357727051, 56810.66667175293, 51243.11994934082, 54072.020389556885, 51806.29342651367, 52629.98720932007, 49181.26012611389, 55772.133712768555, 52996.433460235596, 48477.91347694397, 53827.180225372314, 50023.54675388336, 48535.62009847164, 52006.83338928223, 48012.38667488098, 53508.93338012695, 54326.660148620605, 54378.913650512695, 49580.02006149292, 56540.827072143555, 53955.346740722656, 49349.53993797302, 46916.27330541611, 51148.213512420654, 55574.90665817261, 56134.68022155762, 56946.52011489868, 56499.14694213867, 54361.89345359802, 52978.68693399429, 46211.20690202713, 54592.600118637085, 54923.30017089844, 54192.14038658142, 49071.0067653656, 54777.6137046814, 52251.04693984985, 54808.00657701492, 53329.846687316895, 46497.7667388916, 51976.3468170166, 51338.940200805664, 53500.78688812256, 51648.53349971771, 51608.28669643402, 55509.86668777466, 56926.10005187988, 56299.66677093506, 53515.80673599243, 52054.106716156006, 53283.726821899414, 49572.146686553955, 52535.586780548096, 49924.95328617096, 55871.66017913818, 50654.16003417969, 48242.47348976135, 54651.626932144165, 56150.34680175781, 55235.4471244812, 47042.38022327423, 49438.753527879715, 50225.166909217834, 47844.20674717426, 52721.6601524353, 53317.16010284424, 45008.480021476746, 54998.71990966797, 48505.20680999756, 51796.026847839355, 54566.31354522705, 50696.333231925964, 49657.306800842285, 53059.5268945694, 45507.993324279785, 56797.32684326172, 46196.14684486389, 53499.98664855957, 55472.62026977539, 53524.24701309204, 46880.526741981506, 53949.27354812622, 52019.220219135284, 52647.826561927795, 54034.52021026611, 51323.186725616455, 55923.7868347168, 55161.1135559082, 56567.693298339844, 52997.00006866455, 53895.35364151001, 51185.10673522949, 46003.24018931389, 49848.07335996628, 52099.686855793, 54722.32010650635, 54208.08692741394, 56945.979919433594, 57853.693603515625, 52930.22707557678, 56020.6402015686, 53638.12023162842, 54377.58015155792, 54732.68012237549, 51830.460191726685, 53306.95336151123, 51332.853521347046, 52347.99352025986, 55989.06006813049, 52250.84656524658, 53538.8736000061, 50621.140171051025, 48237.69367480278, 53535.107012331486, 55119.68023300171, 49942.84671974182, 57425.40684700012, 56066.04022026062, 54585.54022979736], "episode_lengths": [135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 135, 137, 136, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 136, 136, 135, 136, 135, 134, 134, 134, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 134, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 137, 136, 135, 136, 135, 136, 135, 135, 136, 136, 136, 136, 134, 137, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 136, 137, 135, 135, 135, 135, 136, 134, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 135, 134, 137, 135, 135, 135], "policy_agent_0_reward": [54653.91351699829, 55760.540130615234, 53984.01999473572, 55845.21357727051, 56810.66667175293, 51243.11994934082, 54072.020389556885, 51806.29342651367, 52629.98720932007, 49181.26012611389, 55772.133712768555, 52996.433460235596, 48477.91347694397, 53827.180225372314, 50023.54675388336, 48535.62009847164, 52006.83338928223, 48012.38667488098, 53508.93338012695, 54326.660148620605, 54378.913650512695, 49580.02006149292, 56540.827072143555, 53955.346740722656, 49349.53993797302, 46916.27330541611, 51148.213512420654, 55574.90665817261, 56134.68022155762, 56946.52011489868, 56499.14694213867, 54361.89345359802, 52978.68693399429, 46211.20690202713, 54592.600118637085, 54923.30017089844, 54192.14038658142, 49071.0067653656, 54777.6137046814, 52251.04693984985, 54808.00657701492, 53329.846687316895, 46497.7667388916, 51976.3468170166, 51338.940200805664, 53500.78688812256, 51648.53349971771, 51608.28669643402, 55509.86668777466, 56926.10005187988, 56299.66677093506, 53515.80673599243, 52054.106716156006, 53283.726821899414, 49572.146686553955, 52535.586780548096, 49924.95328617096, 55871.66017913818, 50654.16003417969, 48242.47348976135, 54651.626932144165, 56150.34680175781, 55235.4471244812, 47042.38022327423, 49438.753527879715, 50225.166909217834, 47844.20674717426, 52721.6601524353, 53317.16010284424, 45008.480021476746, 54998.71990966797, 48505.20680999756, 51796.026847839355, 54566.31354522705, 50696.333231925964, 49657.306800842285, 53059.5268945694, 45507.993324279785, 56797.32684326172, 46196.14684486389, 53499.98664855957, 55472.62026977539, 53524.24701309204, 46880.526741981506, 53949.27354812622, 52019.220219135284, 52647.826561927795, 54034.52021026611, 51323.186725616455, 55923.7868347168, 55161.1135559082, 56567.693298339844, 52997.00006866455, 53895.35364151001, 51185.10673522949, 46003.24018931389, 49848.07335996628, 52099.686855793, 54722.32010650635, 54208.08692741394, 56945.979919433594, 57853.693603515625, 52930.22707557678, 56020.6402015686, 53638.12023162842, 54377.58015155792, 54732.68012237549, 51830.460191726685, 53306.95336151123, 51332.853521347046, 52347.99352025986, 55989.06006813049, 52250.84656524658, 53538.8736000061, 50621.140171051025, 48237.69367480278, 53535.107012331486, 55119.68023300171, 49942.84671974182, 57425.40684700012, 56066.04022026062, 54585.54022979736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.490206033005926, "mean_inference_ms": 6.6394699831835755, "mean_action_processing_ms": 0.20075263212605243, "mean_env_wait_ms": 221.21677902211766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05334517994865042, "StateBufferConnector_ms": 0.00587819052524254, "ViewRequirementAgentConnector_ms": 0.1979890416880123}}, "episode_reward_max": 57853.693603515625, "episode_reward_min": 45008.480021476746, "episode_reward_mean": 52663.65364427107, "episode_len_mean": 135.2622950819672, "episodes_this_iter": 122, "policy_reward_min": {"agent_0": 45008.480021476746}, "policy_reward_max": {"agent_0": 57853.693603515625}, "policy_reward_mean": {"agent_0": 52663.65364427107}, "hist_stats": {"episode_reward": [54653.91351699829, 55760.540130615234, 53984.01999473572, 55845.21357727051, 56810.66667175293, 51243.11994934082, 54072.020389556885, 51806.29342651367, 52629.98720932007, 49181.26012611389, 55772.133712768555, 52996.433460235596, 48477.91347694397, 53827.180225372314, 50023.54675388336, 48535.62009847164, 52006.83338928223, 48012.38667488098, 53508.93338012695, 54326.660148620605, 54378.913650512695, 49580.02006149292, 56540.827072143555, 53955.346740722656, 49349.53993797302, 46916.27330541611, 51148.213512420654, 55574.90665817261, 56134.68022155762, 56946.52011489868, 56499.14694213867, 54361.89345359802, 52978.68693399429, 46211.20690202713, 54592.600118637085, 54923.30017089844, 54192.14038658142, 49071.0067653656, 54777.6137046814, 52251.04693984985, 54808.00657701492, 53329.846687316895, 46497.7667388916, 51976.3468170166, 51338.940200805664, 53500.78688812256, 51648.53349971771, 51608.28669643402, 55509.86668777466, 56926.10005187988, 56299.66677093506, 53515.80673599243, 52054.106716156006, 53283.726821899414, 49572.146686553955, 52535.586780548096, 49924.95328617096, 55871.66017913818, 50654.16003417969, 48242.47348976135, 54651.626932144165, 56150.34680175781, 55235.4471244812, 47042.38022327423, 49438.753527879715, 50225.166909217834, 47844.20674717426, 52721.6601524353, 53317.16010284424, 45008.480021476746, 54998.71990966797, 48505.20680999756, 51796.026847839355, 54566.31354522705, 50696.333231925964, 49657.306800842285, 53059.5268945694, 45507.993324279785, 56797.32684326172, 46196.14684486389, 53499.98664855957, 55472.62026977539, 53524.24701309204, 46880.526741981506, 53949.27354812622, 52019.220219135284, 52647.826561927795, 54034.52021026611, 51323.186725616455, 55923.7868347168, 55161.1135559082, 56567.693298339844, 52997.00006866455, 53895.35364151001, 51185.10673522949, 46003.24018931389, 49848.07335996628, 52099.686855793, 54722.32010650635, 54208.08692741394, 56945.979919433594, 57853.693603515625, 52930.22707557678, 56020.6402015686, 53638.12023162842, 54377.58015155792, 54732.68012237549, 51830.460191726685, 53306.95336151123, 51332.853521347046, 52347.99352025986, 55989.06006813049, 52250.84656524658, 53538.8736000061, 50621.140171051025, 48237.69367480278, 53535.107012331486, 55119.68023300171, 49942.84671974182, 57425.40684700012, 56066.04022026062, 54585.54022979736], "episode_lengths": [135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 135, 137, 136, 135, 136, 135, 136, 135, 135, 135, 137, 135, 135, 136, 136, 135, 136, 135, 134, 134, 134, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 134, 134, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 137, 136, 135, 136, 135, 136, 135, 135, 136, 136, 136, 136, 134, 137, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 136, 137, 135, 135, 135, 135, 136, 134, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 135, 134, 137, 135, 135, 135], "policy_agent_0_reward": [54653.91351699829, 55760.540130615234, 53984.01999473572, 55845.21357727051, 56810.66667175293, 51243.11994934082, 54072.020389556885, 51806.29342651367, 52629.98720932007, 49181.26012611389, 55772.133712768555, 52996.433460235596, 48477.91347694397, 53827.180225372314, 50023.54675388336, 48535.62009847164, 52006.83338928223, 48012.38667488098, 53508.93338012695, 54326.660148620605, 54378.913650512695, 49580.02006149292, 56540.827072143555, 53955.346740722656, 49349.53993797302, 46916.27330541611, 51148.213512420654, 55574.90665817261, 56134.68022155762, 56946.52011489868, 56499.14694213867, 54361.89345359802, 52978.68693399429, 46211.20690202713, 54592.600118637085, 54923.30017089844, 54192.14038658142, 49071.0067653656, 54777.6137046814, 52251.04693984985, 54808.00657701492, 53329.846687316895, 46497.7667388916, 51976.3468170166, 51338.940200805664, 53500.78688812256, 51648.53349971771, 51608.28669643402, 55509.86668777466, 56926.10005187988, 56299.66677093506, 53515.80673599243, 52054.106716156006, 53283.726821899414, 49572.146686553955, 52535.586780548096, 49924.95328617096, 55871.66017913818, 50654.16003417969, 48242.47348976135, 54651.626932144165, 56150.34680175781, 55235.4471244812, 47042.38022327423, 49438.753527879715, 50225.166909217834, 47844.20674717426, 52721.6601524353, 53317.16010284424, 45008.480021476746, 54998.71990966797, 48505.20680999756, 51796.026847839355, 54566.31354522705, 50696.333231925964, 49657.306800842285, 53059.5268945694, 45507.993324279785, 56797.32684326172, 46196.14684486389, 53499.98664855957, 55472.62026977539, 53524.24701309204, 46880.526741981506, 53949.27354812622, 52019.220219135284, 52647.826561927795, 54034.52021026611, 51323.186725616455, 55923.7868347168, 55161.1135559082, 56567.693298339844, 52997.00006866455, 53895.35364151001, 51185.10673522949, 46003.24018931389, 49848.07335996628, 52099.686855793, 54722.32010650635, 54208.08692741394, 56945.979919433594, 57853.693603515625, 52930.22707557678, 56020.6402015686, 53638.12023162842, 54377.58015155792, 54732.68012237549, 51830.460191726685, 53306.95336151123, 51332.853521347046, 52347.99352025986, 55989.06006813049, 52250.84656524658, 53538.8736000061, 50621.140171051025, 48237.69367480278, 53535.107012331486, 55119.68023300171, 49942.84671974182, 57425.40684700012, 56066.04022026062, 54585.54022979736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.490206033005926, "mean_inference_ms": 6.6394699831835755, "mean_action_processing_ms": 0.20075263212605243, "mean_env_wait_ms": 221.21677902211766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05334517994865042, "StateBufferConnector_ms": 0.00587819052524254, "ViewRequirementAgentConnector_ms": 0.1979890416880123}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.29292631734157, "num_env_steps_trained_throughput_per_sec": 187.29292631734157, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 16369.127, "sample_time_ms": 11961.982, "learn_time_ms": 4248.726, "learn_throughput": 941.459, "synch_weights_time_ms": 157.637}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 4495, "training_iteration": 153, "trial_id": "185f8_00000", "date": "2025-03-21_12-25-17", "timestamp": 1742559917, "time_this_iter_s": 21.42809224128723, "time_total_s": 2441.3125517368317, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f6050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2441.3125517368317, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 93.35172413793104, "ram_util_percent": 13.699999999999996}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983635902404785, "policy_loss": -0.013537122868001461, "vf_loss": 9.995160102844238, "vf_explained_var": -5.076018624095013e-06, "kl": 0.010058028623461723, "entropy": 0.40731504559516907, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}}, "episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.78221452192133, "num_env_steps_trained_throughput_per_sec": 288.78221452192133, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 16395.961, "sample_time_ms": 11950.525, "learn_time_ms": 4284.438, "learn_throughput": 933.611, "synch_weights_time_ms": 160.218}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 4496, "training_iteration": 154, "trial_id": "185f8_00000", "date": "2025-03-21_12-25-31", "timestamp": 1742559931, "time_this_iter_s": 13.900011777877808, "time_total_s": 2455.2125635147095, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f7f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2455.2125635147095, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.49500000000002, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986886024475098, "policy_loss": -0.01490981224924326, "vf_loss": 10.0, "vf_explained_var": 4.467740836844314e-06, "kl": 0.008976646699011326, "entropy": 0.3931938111782074, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}}, "episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.5310915792093, "num_env_steps_trained_throughput_per_sec": 293.5310915792093, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 15641.074, "sample_time_ms": 11236.356, "learn_time_ms": 4245.56, "learn_throughput": 942.161, "synch_weights_time_ms": 158.392}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 4496, "training_iteration": 155, "trial_id": "185f8_00000", "date": "2025-03-21_12-25-45", "timestamp": 1742559945, "time_this_iter_s": 13.67229413986206, "time_total_s": 2468.8848576545715, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a21581f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2468.8848576545715, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.55263157894738, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987099647521973, "policy_loss": -0.014698710292577744, "vf_loss": 10.0, "vf_explained_var": -9.849294656305574e-06, "kl": 0.00899079442024231, "entropy": 0.4394697844982147, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}}, "episode_reward_max": 52608.20657348633, "episode_reward_min": 52608.20657348633, "episode_reward_mean": 52608.20657348633, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52608.20657348633}, "policy_reward_max": {"agent_0": 52608.20657348633}, "policy_reward_mean": {"agent_0": 52608.20657348633}, "hist_stats": {"episode_reward": [52608.20657348633], "episode_lengths": [136], "policy_agent_0_reward": [52608.20657348633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.79848764140554, "mean_inference_ms": 6.947187265824488, "mean_action_processing_ms": 0.20819088585068618, "mean_env_wait_ms": 220.19796503027933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.17180442810058594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.98255531697407, "num_env_steps_trained_throughput_per_sec": 287.98255531697407, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15523.37, "sample_time_ms": 11207.26, "learn_time_ms": 4155.464, "learn_throughput": 962.588, "synch_weights_time_ms": 159.88}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 4496, "training_iteration": 156, "trial_id": "185f8_00000", "date": "2025-03-21_12-25-59", "timestamp": 1742559959, "time_this_iter_s": 13.944160223007202, "time_total_s": 2482.8290178775787, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2407880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2482.8290178775787, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.59, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.772561073303223, "policy_loss": -0.013175946660339832, "vf_loss": 9.784195899963379, "vf_explained_var": -1.0789682391987299e-06, "kl": 0.007698653265833855, "entropy": 0.4103637933731079, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": 58471.053283691406, "episode_reward_min": 44649.800129413605, "episode_reward_mean": 51838.13842132064, "episode_len_mean": 135.2906976744186, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 44649.800129413605}, "policy_reward_max": {"agent_0": 58471.053283691406}, "policy_reward_mean": {"agent_0": 51838.13842132064}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51364.65371775627, 58471.053283691406, 54021.36022949219, 54443.12022399902, 54386.45343017578, 54704.41333770752, 55686.06694030762, 44811.56679344177, 52295.686683654785, 51305.48031234741, 48972.38012886047, 56521.566818237305, 47510.95340633392, 51949.16667890549, 51148.860065460205, 49999.293407440186, 50667.480137348175, 56699.94046020508, 51711.90005111694, 49348.37338447571, 51982.14032793045, 53151.85336303711, 54347.18012428284, 54726.05367279053, 52937.4137134552, 50766.64670944214, 55274.88698577881, 54676.38658332825, 50313.486832380295, 50802.57353019714, 53177.226692676544, 51631.23345851898, 52184.34004974365, 51582.98040390015, 51737.0801448822, 52479.7935256958, 49812.7399597168, 54820.13345336914, 47244.32019805908, 53020.78012752533, 52410.06021118164, 45992.34670639038, 50035.16691207886, 52827.36023521423, 51010.193395614624, 54652.55349731445, 54352.28687286377, 51128.52680873871, 51412.320152282715, 52458.70026397705, 54472.76013946533, 50433.78678894043, 49970.46010971069, 45854.57357406616, 52195.38683509827, 56286.39331150055, 52255.06676673889, 50275.49325752258, 49354.56018638611, 48064.06664276123, 46227.840032577515, 51584.58684539795, 47973.3667640686, 49429.13344478607, 49017.15345096588, 53167.51328277588, 55067.42017364502, 53495.06005859375, 49526.606570243835, 51304.786482572556, 44649.800129413605, 53370.18012237549, 56702.326583862305, 52269.133383750916, 54027.093322753906, 52603.593463897705, 47728.313484191895, 55116.04667663574, 50139.48009300232, 52655.033625125885, 53652.607080459595, 51418.64684486389, 51264.25334966183, 55771.66020202637, 51198.23985290527, 50588.946897506714], "episode_lengths": [135, 135, 135, 136, 134, 135, 135, 136, 135, 135, 135, 134, 137, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 137, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 137, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 135, 136], "policy_agent_0_reward": [51364.65371775627, 58471.053283691406, 54021.36022949219, 54443.12022399902, 54386.45343017578, 54704.41333770752, 55686.06694030762, 44811.56679344177, 52295.686683654785, 51305.48031234741, 48972.38012886047, 56521.566818237305, 47510.95340633392, 51949.16667890549, 51148.860065460205, 49999.293407440186, 50667.480137348175, 56699.94046020508, 51711.90005111694, 49348.37338447571, 51982.14032793045, 53151.85336303711, 54347.18012428284, 54726.05367279053, 52937.4137134552, 50766.64670944214, 55274.88698577881, 54676.38658332825, 50313.486832380295, 50802.57353019714, 53177.226692676544, 51631.23345851898, 52184.34004974365, 51582.98040390015, 51737.0801448822, 52479.7935256958, 49812.7399597168, 54820.13345336914, 47244.32019805908, 53020.78012752533, 52410.06021118164, 45992.34670639038, 50035.16691207886, 52827.36023521423, 51010.193395614624, 54652.55349731445, 54352.28687286377, 51128.52680873871, 51412.320152282715, 52458.70026397705, 54472.76013946533, 50433.78678894043, 49970.46010971069, 45854.57357406616, 52195.38683509827, 56286.39331150055, 52255.06676673889, 50275.49325752258, 49354.56018638611, 48064.06664276123, 46227.840032577515, 51584.58684539795, 47973.3667640686, 49429.13344478607, 49017.15345096588, 53167.51328277588, 55067.42017364502, 53495.06005859375, 49526.606570243835, 51304.786482572556, 44649.800129413605, 53370.18012237549, 56702.326583862305, 52269.133383750916, 54027.093322753906, 52603.593463897705, 47728.313484191895, 55116.04667663574, 50139.48009300232, 52655.033625125885, 53652.607080459595, 51418.64684486389, 51264.25334966183, 55771.66020202637, 51198.23985290527, 50588.946897506714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.7567555041595, "mean_inference_ms": 6.615492975326071, "mean_action_processing_ms": 0.20146269171426542, "mean_env_wait_ms": 219.5249394641013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04768011181853538, "StateBufferConnector_ms": 0.005884780440219613, "ViewRequirementAgentConnector_ms": 0.33224488413611125}}, "episode_reward_max": 58471.053283691406, "episode_reward_min": 44649.800129413605, "episode_reward_mean": 51838.13842132064, "episode_len_mean": 135.2906976744186, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 44649.800129413605}, "policy_reward_max": {"agent_0": 58471.053283691406}, "policy_reward_mean": {"agent_0": 51838.13842132064}, "hist_stats": {"episode_reward": [51364.65371775627, 58471.053283691406, 54021.36022949219, 54443.12022399902, 54386.45343017578, 54704.41333770752, 55686.06694030762, 44811.56679344177, 52295.686683654785, 51305.48031234741, 48972.38012886047, 56521.566818237305, 47510.95340633392, 51949.16667890549, 51148.860065460205, 49999.293407440186, 50667.480137348175, 56699.94046020508, 51711.90005111694, 49348.37338447571, 51982.14032793045, 53151.85336303711, 54347.18012428284, 54726.05367279053, 52937.4137134552, 50766.64670944214, 55274.88698577881, 54676.38658332825, 50313.486832380295, 50802.57353019714, 53177.226692676544, 51631.23345851898, 52184.34004974365, 51582.98040390015, 51737.0801448822, 52479.7935256958, 49812.7399597168, 54820.13345336914, 47244.32019805908, 53020.78012752533, 52410.06021118164, 45992.34670639038, 50035.16691207886, 52827.36023521423, 51010.193395614624, 54652.55349731445, 54352.28687286377, 51128.52680873871, 51412.320152282715, 52458.70026397705, 54472.76013946533, 50433.78678894043, 49970.46010971069, 45854.57357406616, 52195.38683509827, 56286.39331150055, 52255.06676673889, 50275.49325752258, 49354.56018638611, 48064.06664276123, 46227.840032577515, 51584.58684539795, 47973.3667640686, 49429.13344478607, 49017.15345096588, 53167.51328277588, 55067.42017364502, 53495.06005859375, 49526.606570243835, 51304.786482572556, 44649.800129413605, 53370.18012237549, 56702.326583862305, 52269.133383750916, 54027.093322753906, 52603.593463897705, 47728.313484191895, 55116.04667663574, 50139.48009300232, 52655.033625125885, 53652.607080459595, 51418.64684486389, 51264.25334966183, 55771.66020202637, 51198.23985290527, 50588.946897506714], "episode_lengths": [135, 135, 135, 136, 134, 135, 135, 136, 135, 135, 135, 134, 137, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 137, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 137, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 135, 136], "policy_agent_0_reward": [51364.65371775627, 58471.053283691406, 54021.36022949219, 54443.12022399902, 54386.45343017578, 54704.41333770752, 55686.06694030762, 44811.56679344177, 52295.686683654785, 51305.48031234741, 48972.38012886047, 56521.566818237305, 47510.95340633392, 51949.16667890549, 51148.860065460205, 49999.293407440186, 50667.480137348175, 56699.94046020508, 51711.90005111694, 49348.37338447571, 51982.14032793045, 53151.85336303711, 54347.18012428284, 54726.05367279053, 52937.4137134552, 50766.64670944214, 55274.88698577881, 54676.38658332825, 50313.486832380295, 50802.57353019714, 53177.226692676544, 51631.23345851898, 52184.34004974365, 51582.98040390015, 51737.0801448822, 52479.7935256958, 49812.7399597168, 54820.13345336914, 47244.32019805908, 53020.78012752533, 52410.06021118164, 45992.34670639038, 50035.16691207886, 52827.36023521423, 51010.193395614624, 54652.55349731445, 54352.28687286377, 51128.52680873871, 51412.320152282715, 52458.70026397705, 54472.76013946533, 50433.78678894043, 49970.46010971069, 45854.57357406616, 52195.38683509827, 56286.39331150055, 52255.06676673889, 50275.49325752258, 49354.56018638611, 48064.06664276123, 46227.840032577515, 51584.58684539795, 47973.3667640686, 49429.13344478607, 49017.15345096588, 53167.51328277588, 55067.42017364502, 53495.06005859375, 49526.606570243835, 51304.786482572556, 44649.800129413605, 53370.18012237549, 56702.326583862305, 52269.133383750916, 54027.093322753906, 52603.593463897705, 47728.313484191895, 55116.04667663574, 50139.48009300232, 52655.033625125885, 53652.607080459595, 51418.64684486389, 51264.25334966183, 55771.66020202637, 51198.23985290527, 50588.946897506714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.7567555041595, "mean_inference_ms": 6.615492975326071, "mean_action_processing_ms": 0.20146269171426542, "mean_env_wait_ms": 219.5249394641013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04768011181853538, "StateBufferConnector_ms": 0.005884780440219613, "ViewRequirementAgentConnector_ms": 0.33224488413611125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.29291362302124, "num_env_steps_trained_throughput_per_sec": 218.29291362302124, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 15931.784, "sample_time_ms": 11698.663, "learn_time_ms": 4083.248, "learn_throughput": 979.612, "synch_weights_time_ms": 149.138}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 4582, "training_iteration": 157, "trial_id": "185f8_00000", "date": "2025-03-21_12-26-18", "timestamp": 1742559978, "time_this_iter_s": 18.366151332855225, "time_total_s": 2501.195169210434, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a21596c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2501.195169210434, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 95.32083333333334, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.947368421052632, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.896309852600098, "policy_loss": -0.01051993016153574, "vf_loss": 9.9052734375, "vf_explained_var": 6.647780423918448e-07, "kl": 0.007771714590489864, "entropy": 0.38866785168647766, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": 58606.16702270508, "episode_reward_min": 47692.03356361389, "episode_reward_mean": 52753.50157816787, "episode_len_mean": 135.31578947368422, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {"agent_0": 47692.03356361389}, "policy_reward_max": {"agent_0": 58606.16702270508}, "policy_reward_mean": {"agent_0": 52753.50157816787}, "custom_metrics": {"num_batches_mean": 5.947368421052632, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54139.68682861328, 48421.97352313995, 48341.22661590576, 52375.63342285156, 52101.46682357788, 55961.673568725586, 50714.15352392197, 50250.113609313965, 51537.946895599365, 54964.62683105469, 50599.20681190491, 54618.82684326172, 55928.36001586914, 55519.63365936279, 51230.22016119957, 52180.83334350586, 54032.6270904541, 47700.71335172653, 52775.81340789795, 50807.60684657097, 57536.486907958984, 52406.38029098511, 54013.89375305176, 56220.37352657318, 50428.68014907837, 50895.04659843445, 51606.047090530396, 53508.08676147461, 47692.03356361389, 58606.16702270508, 53835.01345062256, 53118.340156555176, 54813.34662628174, 53393.666664123535, 54945.42702102661, 53241.69363594055, 51732.280014038086, 52437.753562927246], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 134, 135, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 136, 135], "policy_agent_0_reward": [54139.68682861328, 48421.97352313995, 48341.22661590576, 52375.63342285156, 52101.46682357788, 55961.673568725586, 50714.15352392197, 50250.113609313965, 51537.946895599365, 54964.62683105469, 50599.20681190491, 54618.82684326172, 55928.36001586914, 55519.63365936279, 51230.22016119957, 52180.83334350586, 54032.6270904541, 47700.71335172653, 52775.81340789795, 50807.60684657097, 57536.486907958984, 52406.38029098511, 54013.89375305176, 56220.37352657318, 50428.68014907837, 50895.04659843445, 51606.047090530396, 53508.08676147461, 47692.03356361389, 58606.16702270508, 53835.01345062256, 53118.340156555176, 54813.34662628174, 53393.666664123535, 54945.42702102661, 53241.69363594055, 51732.280014038086, 52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.141863867929416, "mean_inference_ms": 6.706657900782996, "mean_action_processing_ms": 0.19892302398452955, "mean_env_wait_ms": 224.85283796095177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039251854545191714, "StateBufferConnector_ms": 0.005966111233359889, "ViewRequirementAgentConnector_ms": 0.25325950823332133}}, "episode_reward_max": 58606.16702270508, "episode_reward_min": 47692.03356361389, "episode_reward_mean": 52753.50157816787, "episode_len_mean": 135.31578947368422, "episodes_this_iter": 38, "policy_reward_min": {"agent_0": 47692.03356361389}, "policy_reward_max": {"agent_0": 58606.16702270508}, "policy_reward_mean": {"agent_0": 52753.50157816787}, "hist_stats": {"episode_reward": [54139.68682861328, 48421.97352313995, 48341.22661590576, 52375.63342285156, 52101.46682357788, 55961.673568725586, 50714.15352392197, 50250.113609313965, 51537.946895599365, 54964.62683105469, 50599.20681190491, 54618.82684326172, 55928.36001586914, 55519.63365936279, 51230.22016119957, 52180.83334350586, 54032.6270904541, 47700.71335172653, 52775.81340789795, 50807.60684657097, 57536.486907958984, 52406.38029098511, 54013.89375305176, 56220.37352657318, 50428.68014907837, 50895.04659843445, 51606.047090530396, 53508.08676147461, 47692.03356361389, 58606.16702270508, 53835.01345062256, 53118.340156555176, 54813.34662628174, 53393.666664123535, 54945.42702102661, 53241.69363594055, 51732.280014038086, 52437.753562927246], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 134, 135, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 136, 135], "policy_agent_0_reward": [54139.68682861328, 48421.97352313995, 48341.22661590576, 52375.63342285156, 52101.46682357788, 55961.673568725586, 50714.15352392197, 50250.113609313965, 51537.946895599365, 54964.62683105469, 50599.20681190491, 54618.82684326172, 55928.36001586914, 55519.63365936279, 51230.22016119957, 52180.83334350586, 54032.6270904541, 47700.71335172653, 52775.81340789795, 50807.60684657097, 57536.486907958984, 52406.38029098511, 54013.89375305176, 56220.37352657318, 50428.68014907837, 50895.04659843445, 51606.047090530396, 53508.08676147461, 47692.03356361389, 58606.16702270508, 53835.01345062256, 53118.340156555176, 54813.34662628174, 53393.666664123535, 54945.42702102661, 53241.69363594055, 51732.280014038086, 52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.141863867929416, "mean_inference_ms": 6.706657900782996, "mean_action_processing_ms": 0.19892302398452955, "mean_env_wait_ms": 224.85283796095177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039251854545191714, "StateBufferConnector_ms": 0.005966111233359889, "ViewRequirementAgentConnector_ms": 0.25325950823332133}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.35799355036679, "num_env_steps_trained_throughput_per_sec": 210.35799355036679, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 16441.277, "sample_time_ms": 12156.022, "learn_time_ms": 4138.005, "learn_throughput": 966.649, "synch_weights_time_ms": 146.554}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 4620, "training_iteration": 158, "trial_id": "185f8_00000", "date": "2025-03-21_12-26-37", "timestamp": 1742559997, "time_this_iter_s": 19.072402000427246, "time_total_s": 2520.267571210861, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f6050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2520.267571210861, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 98.86800000000001, "ram_util_percent": 13.708}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.978181838989258, "policy_loss": -0.016201330348849297, "vf_loss": 9.992431640625, "vf_explained_var": 2.033387573874279e-07, "kl": 0.009757676161825657, "entropy": 0.417892187833786, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 52437.753562927246, "episode_reward_min": 52437.753562927246, "episode_reward_mean": 52437.753562927246, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52437.753562927246}, "policy_reward_max": {"agent_0": 52437.753562927246}, "policy_reward_mean": {"agent_0": 52437.753562927246}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52437.753562927246], "episode_lengths": [135], "policy_agent_0_reward": [52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.01426076219561, "mean_inference_ms": 6.313642070348588, "mean_action_processing_ms": 0.19393354766284474, "mean_env_wait_ms": 223.4323854523731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1629352569580078}}, "episode_reward_max": 52437.753562927246, "episode_reward_min": 52437.753562927246, "episode_reward_mean": 52437.753562927246, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52437.753562927246}, "policy_reward_max": {"agent_0": 52437.753562927246}, "policy_reward_mean": {"agent_0": 52437.753562927246}, "hist_stats": {"episode_reward": [52437.753562927246], "episode_lengths": [135], "policy_agent_0_reward": [52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.01426076219561, "mean_inference_ms": 6.313642070348588, "mean_action_processing_ms": 0.19393354766284474, "mean_env_wait_ms": 223.4323854523731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1629352569580078}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.9593848676888, "num_env_steps_trained_throughput_per_sec": 275.9593848676888, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 15713.992, "sample_time_ms": 11444.507, "learn_time_ms": 4122.348, "learn_throughput": 970.321, "synch_weights_time_ms": 146.406}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 4620, "training_iteration": 159, "trial_id": "185f8_00000", "date": "2025-03-21_12-26-51", "timestamp": 1742560011, "time_this_iter_s": 14.544383764266968, "time_total_s": 2534.811954975128, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a215bc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2534.811954975128, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.52380952380955, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986849784851074, "policy_loss": -0.01494305394589901, "vf_loss": 10.0, "vf_explained_var": 1.0828177465782574e-07, "kl": 0.008967085741460323, "entropy": 0.4197368025779724, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": 52437.753562927246, "episode_reward_min": 52437.753562927246, "episode_reward_mean": 52437.753562927246, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52437.753562927246}, "policy_reward_max": {"agent_0": 52437.753562927246}, "policy_reward_mean": {"agent_0": 52437.753562927246}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52437.753562927246], "episode_lengths": [135], "policy_agent_0_reward": [52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.01426076219561, "mean_inference_ms": 6.313642070348588, "mean_action_processing_ms": 0.19393354766284474, "mean_env_wait_ms": 223.4323854523731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1629352569580078}}, "episode_reward_max": 52437.753562927246, "episode_reward_min": 52437.753562927246, "episode_reward_mean": 52437.753562927246, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52437.753562927246}, "policy_reward_max": {"agent_0": 52437.753562927246}, "policy_reward_mean": {"agent_0": 52437.753562927246}, "hist_stats": {"episode_reward": [52437.753562927246], "episode_lengths": [135], "policy_agent_0_reward": [52437.753562927246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 48.01426076219561, "mean_inference_ms": 6.313642070348588, "mean_action_processing_ms": 0.19393354766284474, "mean_env_wait_ms": 223.4323854523731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1629352569580078}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.0706191614695, "num_env_steps_trained_throughput_per_sec": 283.0706191614695, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15735.338, "sample_time_ms": 11488.899, "learn_time_ms": 4096.407, "learn_throughput": 976.465, "synch_weights_time_ms": 149.265}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 4620, "training_iteration": 160, "trial_id": "185f8_00000", "date": "2025-03-21_12-27-06", "timestamp": 1742560026, "time_this_iter_s": 14.179492712020874, "time_total_s": 2548.991447687149, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f7eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2548.991447687149, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.585, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.898693084716797, "policy_loss": -0.013043692335486412, "vf_loss": 9.909918785095215, "vf_explained_var": -2.6126081138500012e-06, "kl": 0.009084225632250309, "entropy": 0.4418374001979828, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": 57006.63357925415, "episode_reward_min": 44118.12658071518, "episode_reward_mean": 52956.416575054034, "episode_len_mean": 135.2058823529412, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {"agent_0": 44118.12658071518}, "policy_reward_max": {"agent_0": 57006.63357925415}, "policy_reward_mean": {"agent_0": 52956.416575054034}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56272.42004394531, 57006.63357925415, 53557.6132774353, 51083.27339553833, 51296.593443632126, 54591.60013580322, 55924.6868057251, 51749.64690876007, 54559.43337249756, 52963.46019935608, 50759.706687927246, 53840.2801361084, 56301.03353881836, 52793.80682468414, 52218.540004730225, 52157.819970846176, 53014.806953430176, 55369.13340759277, 51808.24683189392, 55720.21329498291, 54959.853496551514, 51771.90000152588, 46749.513350725174, 44431.940014362335, 49891.0133895874, 54247.37357330322, 54885.35336303711, 53617.67341041565, 56038.453631192446, 56149.89998626709, 54125.18689537048, 44118.12658071518, 51234.48688697815, 55308.440158843994], "episode_lengths": [135, 135, 135, 136, 136, 135, 134, 135, 135, 135, 135, 135, 134, 134, 136, 136, 135, 135, 135, 135, 135, 136, 136, 137, 135, 136, 135, 135, 135, 135, 135, 136, 136, 134], "policy_agent_0_reward": [56272.42004394531, 57006.63357925415, 53557.6132774353, 51083.27339553833, 51296.593443632126, 54591.60013580322, 55924.6868057251, 51749.64690876007, 54559.43337249756, 52963.46019935608, 50759.706687927246, 53840.2801361084, 56301.03353881836, 52793.80682468414, 52218.540004730225, 52157.819970846176, 53014.806953430176, 55369.13340759277, 51808.24683189392, 55720.21329498291, 54959.853496551514, 51771.90000152588, 46749.513350725174, 44431.940014362335, 49891.0133895874, 54247.37357330322, 54885.35336303711, 53617.67341041565, 56038.453631192446, 56149.89998626709, 54125.18689537048, 44118.12658071518, 51234.48688697815, 55308.440158843994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.15052229337156, "mean_inference_ms": 6.452612612053317, "mean_action_processing_ms": 0.20099118412099476, "mean_env_wait_ms": 210.9176799307454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715358509736903, "StateBufferConnector_ms": 0.0067935270421645225, "ViewRequirementAgentConnector_ms": 0.3832368289723116}}, "episode_reward_max": 57006.63357925415, "episode_reward_min": 44118.12658071518, "episode_reward_mean": 52956.416575054034, "episode_len_mean": 135.2058823529412, "episodes_this_iter": 34, "policy_reward_min": {"agent_0": 44118.12658071518}, "policy_reward_max": {"agent_0": 57006.63357925415}, "policy_reward_mean": {"agent_0": 52956.416575054034}, "hist_stats": {"episode_reward": [56272.42004394531, 57006.63357925415, 53557.6132774353, 51083.27339553833, 51296.593443632126, 54591.60013580322, 55924.6868057251, 51749.64690876007, 54559.43337249756, 52963.46019935608, 50759.706687927246, 53840.2801361084, 56301.03353881836, 52793.80682468414, 52218.540004730225, 52157.819970846176, 53014.806953430176, 55369.13340759277, 51808.24683189392, 55720.21329498291, 54959.853496551514, 51771.90000152588, 46749.513350725174, 44431.940014362335, 49891.0133895874, 54247.37357330322, 54885.35336303711, 53617.67341041565, 56038.453631192446, 56149.89998626709, 54125.18689537048, 44118.12658071518, 51234.48688697815, 55308.440158843994], "episode_lengths": [135, 135, 135, 136, 136, 135, 134, 135, 135, 135, 135, 135, 134, 134, 136, 136, 135, 135, 135, 135, 135, 136, 136, 137, 135, 136, 135, 135, 135, 135, 135, 136, 136, 134], "policy_agent_0_reward": [56272.42004394531, 57006.63357925415, 53557.6132774353, 51083.27339553833, 51296.593443632126, 54591.60013580322, 55924.6868057251, 51749.64690876007, 54559.43337249756, 52963.46019935608, 50759.706687927246, 53840.2801361084, 56301.03353881836, 52793.80682468414, 52218.540004730225, 52157.819970846176, 53014.806953430176, 55369.13340759277, 51808.24683189392, 55720.21329498291, 54959.853496551514, 51771.90000152588, 46749.513350725174, 44431.940014362335, 49891.0133895874, 54247.37357330322, 54885.35336303711, 53617.67341041565, 56038.453631192446, 56149.89998626709, 54125.18689537048, 44118.12658071518, 51234.48688697815, 55308.440158843994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.15052229337156, "mean_inference_ms": 6.452612612053317, "mean_action_processing_ms": 0.20099118412099476, "mean_env_wait_ms": 210.9176799307454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715358509736903, "StateBufferConnector_ms": 0.0067935270421645225, "ViewRequirementAgentConnector_ms": 0.3832368289723116}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.46373459650255, "num_env_steps_trained_throughput_per_sec": 227.46373459650255, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 16061.183, "sample_time_ms": 11885.292, "learn_time_ms": 4013.787, "learn_throughput": 996.565, "synch_weights_time_ms": 161.308}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 4654, "training_iteration": 161, "trial_id": "185f8_00000", "date": "2025-03-21_12-27-23", "timestamp": 1742560043, "time_this_iter_s": 17.648889780044556, "time_total_s": 2566.6403374671936, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a215bc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2566.6403374671936, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 99.12916666666668, "ram_util_percent": 13.762499999999998}}
{"custom_metrics": {"num_batches_mean": 5.411111111111111, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.759072303771973, "policy_loss": -0.011899284087121487, "vf_loss": 9.769289016723633, "vf_explained_var": -7.669131036891486e-07, "kl": 0.008409001864492893, "entropy": 0.4129675030708313, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 57347.80672454834, "episode_reward_min": 39837.81338310242, "episode_reward_mean": 51363.408588041864, "episode_len_mean": 135.38888888888889, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 39837.81338310242}, "policy_reward_max": {"agent_0": 57347.80672454834}, "policy_reward_mean": {"agent_0": 51363.408588041864}, "custom_metrics": {"num_batches_mean": 5.411111111111111, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49536.83354949951, 52341.8864440918, 44916.47993016243, 50937.14024734497, 48345.23336982727, 44292.126766204834, 50449.63335323334, 51997.920276641846, 52772.266788482666, 50570.75991535187, 54789.73356628418, 52400.586935043335, 47250.80672645569, 49111.726694107056, 44439.306829452515, 53884.94029521942, 54293.893409729004, 56172.98021697998, 39837.81338310242, 50166.8134727478, 49937.020263671875, 46245.21337735653, 51680.85987854004, 49131.36709690094, 51823.886808395386, 54661.32678604126, 54205.71378326416, 53441.74671173096, 56208.60016155243, 57347.80672454834, 49847.48004579544, 53430.4467086792, 52576.1402053833, 56556.993560791016, 54606.566875457764, 54510.41352844238, 56027.99346160889, 53561.033515930176, 51198.673515319824, 49196.820055007935, 53338.14707946777, 51635.50000810623, 46131.40006828308, 47740.12678050995, 55707.38677597046, 47742.66661930084, 50981.286794662476, 51883.53347492218, 48383.946641922, 55764.7467880249, 49280.45358657837, 53762.40663146973, 53785.753255844116, 49909.793374061584, 55553.506980895996, 53766.35354614258, 47686.08705186844, 53070.26681518555, 48786.906829833984, 52334.45346069336, 45323.300209760666, 54471.03356933594, 52220.72031211853, 55860.553627967834, 50791.53999829292, 54338.4935798645, 52502.373596191406, 52564.76670837402, 50806.38671684265, 48542.79327791929, 47754.17340159416, 49910.34049606323, 51603.69330215454, 48159.153366565704, 50796.32699966431, 55236.36697387695, 55500.86676502228, 53598.87364578247, 48409.060247421265, 49895.34673166275, 55146.64019012451, 52288.42003631592, 50292.113602638245, 41668.87362885475, 47179.36676979065, 51409.540243148804, 57070.87997817993, 51162.49346733093, 50451.63349723816, 55800.940185546875], "episode_lengths": [135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 137, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 137, 135, 135, 134, 136, 135, 135], "policy_agent_0_reward": [49536.83354949951, 52341.8864440918, 44916.47993016243, 50937.14024734497, 48345.23336982727, 44292.126766204834, 50449.63335323334, 51997.920276641846, 52772.266788482666, 50570.75991535187, 54789.73356628418, 52400.586935043335, 47250.80672645569, 49111.726694107056, 44439.306829452515, 53884.94029521942, 54293.893409729004, 56172.98021697998, 39837.81338310242, 50166.8134727478, 49937.020263671875, 46245.21337735653, 51680.85987854004, 49131.36709690094, 51823.886808395386, 54661.32678604126, 54205.71378326416, 53441.74671173096, 56208.60016155243, 57347.80672454834, 49847.48004579544, 53430.4467086792, 52576.1402053833, 56556.993560791016, 54606.566875457764, 54510.41352844238, 56027.99346160889, 53561.033515930176, 51198.673515319824, 49196.820055007935, 53338.14707946777, 51635.50000810623, 46131.40006828308, 47740.12678050995, 55707.38677597046, 47742.66661930084, 50981.286794662476, 51883.53347492218, 48383.946641922, 55764.7467880249, 49280.45358657837, 53762.40663146973, 53785.753255844116, 49909.793374061584, 55553.506980895996, 53766.35354614258, 47686.08705186844, 53070.26681518555, 48786.906829833984, 52334.45346069336, 45323.300209760666, 54471.03356933594, 52220.72031211853, 55860.553627967834, 50791.53999829292, 54338.4935798645, 52502.373596191406, 52564.76670837402, 50806.38671684265, 48542.79327791929, 47754.17340159416, 49910.34049606323, 51603.69330215454, 48159.153366565704, 50796.32699966431, 55236.36697387695, 55500.86676502228, 53598.87364578247, 48409.060247421265, 49895.34673166275, 55146.64019012451, 52288.42003631592, 50292.113602638245, 41668.87362885475, 47179.36676979065, 51409.540243148804, 57070.87997817993, 51162.49346733093, 50451.63349723816, 55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.39762795005952, "mean_inference_ms": 6.698665909096321, "mean_action_processing_ms": 0.20038812729906932, "mean_env_wait_ms": 225.53138991484337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044989585876464844, "StateBufferConnector_ms": 0.006277296278211806, "ViewRequirementAgentConnector_ms": 0.21985901726616752}}, "episode_reward_max": 57347.80672454834, "episode_reward_min": 39837.81338310242, "episode_reward_mean": 51363.408588041864, "episode_len_mean": 135.38888888888889, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 39837.81338310242}, "policy_reward_max": {"agent_0": 57347.80672454834}, "policy_reward_mean": {"agent_0": 51363.408588041864}, "hist_stats": {"episode_reward": [49536.83354949951, 52341.8864440918, 44916.47993016243, 50937.14024734497, 48345.23336982727, 44292.126766204834, 50449.63335323334, 51997.920276641846, 52772.266788482666, 50570.75991535187, 54789.73356628418, 52400.586935043335, 47250.80672645569, 49111.726694107056, 44439.306829452515, 53884.94029521942, 54293.893409729004, 56172.98021697998, 39837.81338310242, 50166.8134727478, 49937.020263671875, 46245.21337735653, 51680.85987854004, 49131.36709690094, 51823.886808395386, 54661.32678604126, 54205.71378326416, 53441.74671173096, 56208.60016155243, 57347.80672454834, 49847.48004579544, 53430.4467086792, 52576.1402053833, 56556.993560791016, 54606.566875457764, 54510.41352844238, 56027.99346160889, 53561.033515930176, 51198.673515319824, 49196.820055007935, 53338.14707946777, 51635.50000810623, 46131.40006828308, 47740.12678050995, 55707.38677597046, 47742.66661930084, 50981.286794662476, 51883.53347492218, 48383.946641922, 55764.7467880249, 49280.45358657837, 53762.40663146973, 53785.753255844116, 49909.793374061584, 55553.506980895996, 53766.35354614258, 47686.08705186844, 53070.26681518555, 48786.906829833984, 52334.45346069336, 45323.300209760666, 54471.03356933594, 52220.72031211853, 55860.553627967834, 50791.53999829292, 54338.4935798645, 52502.373596191406, 52564.76670837402, 50806.38671684265, 48542.79327791929, 47754.17340159416, 49910.34049606323, 51603.69330215454, 48159.153366565704, 50796.32699966431, 55236.36697387695, 55500.86676502228, 53598.87364578247, 48409.060247421265, 49895.34673166275, 55146.64019012451, 52288.42003631592, 50292.113602638245, 41668.87362885475, 47179.36676979065, 51409.540243148804, 57070.87997817993, 51162.49346733093, 50451.63349723816, 55800.940185546875], "episode_lengths": [135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 137, 135, 137, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 137, 135, 135, 134, 136, 135, 135], "policy_agent_0_reward": [49536.83354949951, 52341.8864440918, 44916.47993016243, 50937.14024734497, 48345.23336982727, 44292.126766204834, 50449.63335323334, 51997.920276641846, 52772.266788482666, 50570.75991535187, 54789.73356628418, 52400.586935043335, 47250.80672645569, 49111.726694107056, 44439.306829452515, 53884.94029521942, 54293.893409729004, 56172.98021697998, 39837.81338310242, 50166.8134727478, 49937.020263671875, 46245.21337735653, 51680.85987854004, 49131.36709690094, 51823.886808395386, 54661.32678604126, 54205.71378326416, 53441.74671173096, 56208.60016155243, 57347.80672454834, 49847.48004579544, 53430.4467086792, 52576.1402053833, 56556.993560791016, 54606.566875457764, 54510.41352844238, 56027.99346160889, 53561.033515930176, 51198.673515319824, 49196.820055007935, 53338.14707946777, 51635.50000810623, 46131.40006828308, 47740.12678050995, 55707.38677597046, 47742.66661930084, 50981.286794662476, 51883.53347492218, 48383.946641922, 55764.7467880249, 49280.45358657837, 53762.40663146973, 53785.753255844116, 49909.793374061584, 55553.506980895996, 53766.35354614258, 47686.08705186844, 53070.26681518555, 48786.906829833984, 52334.45346069336, 45323.300209760666, 54471.03356933594, 52220.72031211853, 55860.553627967834, 50791.53999829292, 54338.4935798645, 52502.373596191406, 52564.76670837402, 50806.38671684265, 48542.79327791929, 47754.17340159416, 49910.34049606323, 51603.69330215454, 48159.153366565704, 50796.32699966431, 55236.36697387695, 55500.86676502228, 53598.87364578247, 48409.060247421265, 49895.34673166275, 55146.64019012451, 52288.42003631592, 50292.113602638245, 41668.87362885475, 47179.36676979065, 51409.540243148804, 57070.87997817993, 51162.49346733093, 50451.63349723816, 55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.39762795005952, "mean_inference_ms": 6.698665909096321, "mean_action_processing_ms": 0.20038812729906932, "mean_env_wait_ms": 225.53138991484337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044989585876464844, "StateBufferConnector_ms": 0.006277296278211806, "ViewRequirementAgentConnector_ms": 0.21985901726616752}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.29277172620567, "num_env_steps_trained_throughput_per_sec": 210.29277172620567, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 16529.567, "sample_time_ms": 12392.431, "learn_time_ms": 3973.812, "learn_throughput": 1006.59, "synch_weights_time_ms": 162.499}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 4744, "training_iteration": 162, "trial_id": "185f8_00000", "date": "2025-03-21_12-27-42", "timestamp": 1742560062, "time_this_iter_s": 19.07610297203064, "time_total_s": 2585.7164404392242, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2406e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2585.7164404392242, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 95.39615384615384, "ram_util_percent": 13.77692307692308}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985054969787598, "policy_loss": -0.01695256493985653, "vf_loss": 10.0, "vf_explained_var": 4.1214127577404724e-07, "kl": 0.010035514831542969, "entropy": 0.4060960114002228, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": 55800.940185546875, "episode_reward_min": 55800.940185546875, "episode_reward_mean": 55800.940185546875, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55800.940185546875}, "policy_reward_max": {"agent_0": 55800.940185546875}, "policy_reward_mean": {"agent_0": 55800.940185546875}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55800.940185546875], "episode_lengths": [135], "policy_agent_0_reward": [55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.953013014540495, "mean_inference_ms": 6.294179537487122, "mean_action_processing_ms": 0.20033409648369224, "mean_env_wait_ms": 230.000929570359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027871131896972656, "StateBufferConnector_ms": 0.004744529724121094, "ViewRequirementAgentConnector_ms": 0.12392997741699217}}, "episode_reward_max": 55800.940185546875, "episode_reward_min": 55800.940185546875, "episode_reward_mean": 55800.940185546875, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55800.940185546875}, "policy_reward_max": {"agent_0": 55800.940185546875}, "policy_reward_mean": {"agent_0": 55800.940185546875}, "hist_stats": {"episode_reward": [55800.940185546875], "episode_lengths": [135], "policy_agent_0_reward": [55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.953013014540495, "mean_inference_ms": 6.294179537487122, "mean_action_processing_ms": 0.20033409648369224, "mean_env_wait_ms": 230.000929570359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027871131896972656, "StateBufferConnector_ms": 0.004744529724121094, "ViewRequirementAgentConnector_ms": 0.12392997741699217}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.0579310327717, "num_env_steps_trained_throughput_per_sec": 289.0579310327717, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 15777.677, "sample_time_ms": 11670.254, "learn_time_ms": 3939.929, "learn_throughput": 1015.247, "synch_weights_time_ms": 166.692}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 4744, "training_iteration": 163, "trial_id": "185f8_00000", "date": "2025-03-21_12-27-56", "timestamp": 1742560076, "time_this_iter_s": 13.894309282302856, "time_total_s": 2599.610749721527, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2407880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2599.610749721527, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.52, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986051559448242, "policy_loss": -0.015880601480603218, "vf_loss": 10.0, "vf_explained_var": -8.226682979284305e-08, "kl": 0.009662673808634281, "entropy": 0.40437600016593933, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": 55800.940185546875, "episode_reward_min": 55800.940185546875, "episode_reward_mean": 55800.940185546875, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55800.940185546875}, "policy_reward_max": {"agent_0": 55800.940185546875}, "policy_reward_mean": {"agent_0": 55800.940185546875}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55800.940185546875], "episode_lengths": [135], "policy_agent_0_reward": [55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.953013014540495, "mean_inference_ms": 6.294179537487122, "mean_action_processing_ms": 0.20033409648369224, "mean_env_wait_ms": 230.000929570359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027871131896972656, "StateBufferConnector_ms": 0.004744529724121094, "ViewRequirementAgentConnector_ms": 0.12392997741699217}}, "episode_reward_max": 55800.940185546875, "episode_reward_min": 55800.940185546875, "episode_reward_mean": 55800.940185546875, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55800.940185546875}, "policy_reward_max": {"agent_0": 55800.940185546875}, "policy_reward_mean": {"agent_0": 55800.940185546875}, "hist_stats": {"episode_reward": [55800.940185546875], "episode_lengths": [135], "policy_agent_0_reward": [55800.940185546875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.953013014540495, "mean_inference_ms": 6.294179537487122, "mean_action_processing_ms": 0.20033409648369224, "mean_env_wait_ms": 230.000929570359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027871131896972656, "StateBufferConnector_ms": 0.004744529724121094, "ViewRequirementAgentConnector_ms": 0.12392997741699217}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.5906528783097, "num_env_steps_trained_throughput_per_sec": 286.5906528783097, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 15788.281, "sample_time_ms": 11660.253, "learn_time_ms": 3961.637, "learn_throughput": 1009.684, "synch_weights_time_ms": 165.627}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 4744, "training_iteration": 164, "trial_id": "185f8_00000", "date": "2025-03-21_12-28-10", "timestamp": 1742560090, "time_this_iter_s": 14.017321825027466, "time_total_s": 2613.6280715465546, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a21596c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2613.6280715465546, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.48, "ram_util_percent": 13.775}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.905652046203613, "policy_loss": -0.017237253487110138, "vf_loss": 9.920654296875, "vf_explained_var": -2.4456531377836654e-07, "kl": 0.011171470396220684, "entropy": 0.4433247148990631, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 56843.91361999512, "episode_reward_min": 45891.45347118378, "episode_reward_mean": 52741.841835439205, "episode_len_mean": 135.40625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45891.45347118378}, "policy_reward_max": {"agent_0": 56843.91361999512}, "policy_reward_mean": {"agent_0": 52741.841835439205}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53976.72679901123, 52858.96019363403, 56582.793685913086, 50869.69345855713, 53391.60001182556, 49812.686832904816, 49858.85356712341, 52133.78671693802, 48327.67997550964, 51347.553495407104, 55128.01326751709, 54587.62692451477, 51967.49358558655, 49324.33998775482, 53904.78680038452, 51085.15329742432, 56234.48683166504, 56843.91361999512, 51331.026626586914, 53894.447008132935, 55949.22019195557, 48086.21361160278, 56243.70018005371, 52485.213848114014, 53787.88703918457, 52350.28036880493, 45891.45347118378, 52786.89334106445, 56021.200050354004, 53539.97373390198, 52334.286697387695, 54800.993514060974], "episode_lengths": [135, 135, 135, 136, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [53976.72679901123, 52858.96019363403, 56582.793685913086, 50869.69345855713, 53391.60001182556, 49812.686832904816, 49858.85356712341, 52133.78671693802, 48327.67997550964, 51347.553495407104, 55128.01326751709, 54587.62692451477, 51967.49358558655, 49324.33998775482, 53904.78680038452, 51085.15329742432, 56234.48683166504, 56843.91361999512, 51331.026626586914, 53894.447008132935, 55949.22019195557, 48086.21361160278, 56243.70018005371, 52485.213848114014, 53787.88703918457, 52350.28036880493, 45891.45347118378, 52786.89334106445, 56021.200050354004, 53539.97373390198, 52334.286697387695, 54800.993514060974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.141549911452614, "mean_inference_ms": 6.432015068481566, "mean_action_processing_ms": 0.20081827740567684, "mean_env_wait_ms": 209.81698684610512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2771317958831787, "StateBufferConnector_ms": 0.00639110803604126, "ViewRequirementAgentConnector_ms": 0.28769299387931824}}, "episode_reward_max": 56843.91361999512, "episode_reward_min": 45891.45347118378, "episode_reward_mean": 52741.841835439205, "episode_len_mean": 135.40625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45891.45347118378}, "policy_reward_max": {"agent_0": 56843.91361999512}, "policy_reward_mean": {"agent_0": 52741.841835439205}, "hist_stats": {"episode_reward": [53976.72679901123, 52858.96019363403, 56582.793685913086, 50869.69345855713, 53391.60001182556, 49812.686832904816, 49858.85356712341, 52133.78671693802, 48327.67997550964, 51347.553495407104, 55128.01326751709, 54587.62692451477, 51967.49358558655, 49324.33998775482, 53904.78680038452, 51085.15329742432, 56234.48683166504, 56843.91361999512, 51331.026626586914, 53894.447008132935, 55949.22019195557, 48086.21361160278, 56243.70018005371, 52485.213848114014, 53787.88703918457, 52350.28036880493, 45891.45347118378, 52786.89334106445, 56021.200050354004, 53539.97373390198, 52334.286697387695, 54800.993514060974], "episode_lengths": [135, 135, 135, 136, 136, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [53976.72679901123, 52858.96019363403, 56582.793685913086, 50869.69345855713, 53391.60001182556, 49812.686832904816, 49858.85356712341, 52133.78671693802, 48327.67997550964, 51347.553495407104, 55128.01326751709, 54587.62692451477, 51967.49358558655, 49324.33998775482, 53904.78680038452, 51085.15329742432, 56234.48683166504, 56843.91361999512, 51331.026626586914, 53894.447008132935, 55949.22019195557, 48086.21361160278, 56243.70018005371, 52485.213848114014, 53787.88703918457, 52350.28036880493, 45891.45347118378, 52786.89334106445, 56021.200050354004, 53539.97373390198, 52334.286697387695, 54800.993514060974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.141549911452614, "mean_inference_ms": 6.432015068481566, "mean_action_processing_ms": 0.20081827740567684, "mean_env_wait_ms": 209.81698684610512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2771317958831787, "StateBufferConnector_ms": 0.00639110803604126, "ViewRequirementAgentConnector_ms": 0.28769299387931824}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.39485562988122, "num_env_steps_trained_throughput_per_sec": 229.39485562988122, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 16169.281, "sample_time_ms": 12025.856, "learn_time_ms": 3984.411, "learn_throughput": 1003.913, "synch_weights_time_ms": 158.264}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 4776, "training_iteration": 165, "trial_id": "185f8_00000", "date": "2025-03-21_12-28-28", "timestamp": 1742560108, "time_this_iter_s": 17.530359506607056, "time_total_s": 2631.1584310531616, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20dfc70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2631.1584310531616, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.35652173913044, "ram_util_percent": 13.752173913043482}}
{"custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75100040435791, "policy_loss": -0.01680733449757099, "vf_loss": 9.766115188598633, "vf_explained_var": -3.5626192129711853e-07, "kl": 0.008462629280984402, "entropy": 0.44773152470588684, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": 58576.6930847168, "episode_reward_min": 42131.00667095184, "episode_reward_mean": 51712.89338461083, "episode_len_mean": 135.32608695652175, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42131.00667095184}, "policy_reward_max": {"agent_0": 58576.6930847168}, "policy_reward_mean": {"agent_0": 51712.89338461083}, "custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51372.8800201416, 53104.07358932495, 57587.30047607422, 50495.30683648586, 53495.620220184326, 48917.04664802551, 46162.27340602875, 48692.35328292847, 54807.12010192871, 50075.733642578125, 50755.23341679573, 52248.466400146484, 55824.700286865234, 54600.12685775757, 51668.933480262756, 53210.500061035156, 50678.60688459873, 55389.353454589844, 55208.36672973633, 49773.31332683563, 49870.03323364258, 49235.053606033325, 49869.97343850136, 53965.78701210022, 55194.26028442383, 54648.50006866455, 53870.96674346924, 47422.340311050415, 54734.573207855225, 54134.54640197754, 52595.886863708496, 47504.21367073059, 49075.70690536499, 53368.36022949219, 58576.6930847168, 51316.0002746582, 53024.01372528076, 53781.16687965393, 51154.32671928406, 50629.98017382622, 55236.1467666626, 53380.57349205017, 47343.71350288391, 49010.88710832596, 42131.00667095184, 54670.97331237793, 45928.020067214966, 55431.45374298096, 52641.59345817566, 50187.306862831116, 54279.62680053711, 52674.21993255615, 50671.560282707214, 48982.34713447094, 52323.426730155945, 54375.06691741943, 52981.360301971436, 50798.72011566162, 55077.48022556305, 51885.68006134033, 49054.89337491989, 42400.453332424164, 54441.13359260559, 53353.10672187805, 49777.613419532776, 50157.20012664795, 48395.966574668884, 51393.32690620422, 49398.959948539734, 50263.38008308411, 50715.86006641388, 49003.83338928223, 54157.23328208923, 54223.15336608887, 51387.86671924591, 52439.580258607864, 55465.933265686035, 50600.966796875, 56443.85997009277, 49931.23349571228, 53282.80017089844, 50691.47999763489, 54309.04033470154, 51299.84671115875, 54672.26012992859, 45870.486795425415, 54055.213470458984, 47563.08654689789, 54396.58673477173, 46995.23337554932, 51886.1734085083, 51507.57357406616], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 134, 136, 136, 134, 136, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 135, 138, 135, 136, 135, 136, 135, 135, 136, 136, 135, 136, 136, 136, 135, 134, 136, 135, 136, 134, 135, 136, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 134], "policy_agent_0_reward": [51372.8800201416, 53104.07358932495, 57587.30047607422, 50495.30683648586, 53495.620220184326, 48917.04664802551, 46162.27340602875, 48692.35328292847, 54807.12010192871, 50075.733642578125, 50755.23341679573, 52248.466400146484, 55824.700286865234, 54600.12685775757, 51668.933480262756, 53210.500061035156, 50678.60688459873, 55389.353454589844, 55208.36672973633, 49773.31332683563, 49870.03323364258, 49235.053606033325, 49869.97343850136, 53965.78701210022, 55194.26028442383, 54648.50006866455, 53870.96674346924, 47422.340311050415, 54734.573207855225, 54134.54640197754, 52595.886863708496, 47504.21367073059, 49075.70690536499, 53368.36022949219, 58576.6930847168, 51316.0002746582, 53024.01372528076, 53781.16687965393, 51154.32671928406, 50629.98017382622, 55236.1467666626, 53380.57349205017, 47343.71350288391, 49010.88710832596, 42131.00667095184, 54670.97331237793, 45928.020067214966, 55431.45374298096, 52641.59345817566, 50187.306862831116, 54279.62680053711, 52674.21993255615, 50671.560282707214, 48982.34713447094, 52323.426730155945, 54375.06691741943, 52981.360301971436, 50798.72011566162, 55077.48022556305, 51885.68006134033, 49054.89337491989, 42400.453332424164, 54441.13359260559, 53353.10672187805, 49777.613419532776, 50157.20012664795, 48395.966574668884, 51393.32690620422, 49398.959948539734, 50263.38008308411, 50715.86006641388, 49003.83338928223, 54157.23328208923, 54223.15336608887, 51387.86671924591, 52439.580258607864, 55465.933265686035, 50600.966796875, 56443.85997009277, 49931.23349571228, 53282.80017089844, 50691.47999763489, 54309.04033470154, 51299.84671115875, 54672.26012992859, 45870.486795425415, 54055.213470458984, 47563.08654689789, 54396.58673477173, 46995.23337554932, 51886.1734085083, 51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.29492273202621, "mean_inference_ms": 6.694455411803138, "mean_action_processing_ms": 0.20027180838086797, "mean_env_wait_ms": 225.48706208486306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06528133931367294, "StateBufferConnector_ms": 0.0330191591511602, "ViewRequirementAgentConnector_ms": 0.2232212087382441}}, "episode_reward_max": 58576.6930847168, "episode_reward_min": 42131.00667095184, "episode_reward_mean": 51712.89338461083, "episode_len_mean": 135.32608695652175, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42131.00667095184}, "policy_reward_max": {"agent_0": 58576.6930847168}, "policy_reward_mean": {"agent_0": 51712.89338461083}, "hist_stats": {"episode_reward": [51372.8800201416, 53104.07358932495, 57587.30047607422, 50495.30683648586, 53495.620220184326, 48917.04664802551, 46162.27340602875, 48692.35328292847, 54807.12010192871, 50075.733642578125, 50755.23341679573, 52248.466400146484, 55824.700286865234, 54600.12685775757, 51668.933480262756, 53210.500061035156, 50678.60688459873, 55389.353454589844, 55208.36672973633, 49773.31332683563, 49870.03323364258, 49235.053606033325, 49869.97343850136, 53965.78701210022, 55194.26028442383, 54648.50006866455, 53870.96674346924, 47422.340311050415, 54734.573207855225, 54134.54640197754, 52595.886863708496, 47504.21367073059, 49075.70690536499, 53368.36022949219, 58576.6930847168, 51316.0002746582, 53024.01372528076, 53781.16687965393, 51154.32671928406, 50629.98017382622, 55236.1467666626, 53380.57349205017, 47343.71350288391, 49010.88710832596, 42131.00667095184, 54670.97331237793, 45928.020067214966, 55431.45374298096, 52641.59345817566, 50187.306862831116, 54279.62680053711, 52674.21993255615, 50671.560282707214, 48982.34713447094, 52323.426730155945, 54375.06691741943, 52981.360301971436, 50798.72011566162, 55077.48022556305, 51885.68006134033, 49054.89337491989, 42400.453332424164, 54441.13359260559, 53353.10672187805, 49777.613419532776, 50157.20012664795, 48395.966574668884, 51393.32690620422, 49398.959948539734, 50263.38008308411, 50715.86006641388, 49003.83338928223, 54157.23328208923, 54223.15336608887, 51387.86671924591, 52439.580258607864, 55465.933265686035, 50600.966796875, 56443.85997009277, 49931.23349571228, 53282.80017089844, 50691.47999763489, 54309.04033470154, 51299.84671115875, 54672.26012992859, 45870.486795425415, 54055.213470458984, 47563.08654689789, 54396.58673477173, 46995.23337554932, 51886.1734085083, 51507.57357406616], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 134, 136, 136, 134, 136, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 135, 138, 135, 136, 135, 136, 135, 135, 136, 136, 135, 136, 136, 136, 135, 134, 136, 135, 136, 134, 135, 136, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 134], "policy_agent_0_reward": [51372.8800201416, 53104.07358932495, 57587.30047607422, 50495.30683648586, 53495.620220184326, 48917.04664802551, 46162.27340602875, 48692.35328292847, 54807.12010192871, 50075.733642578125, 50755.23341679573, 52248.466400146484, 55824.700286865234, 54600.12685775757, 51668.933480262756, 53210.500061035156, 50678.60688459873, 55389.353454589844, 55208.36672973633, 49773.31332683563, 49870.03323364258, 49235.053606033325, 49869.97343850136, 53965.78701210022, 55194.26028442383, 54648.50006866455, 53870.96674346924, 47422.340311050415, 54734.573207855225, 54134.54640197754, 52595.886863708496, 47504.21367073059, 49075.70690536499, 53368.36022949219, 58576.6930847168, 51316.0002746582, 53024.01372528076, 53781.16687965393, 51154.32671928406, 50629.98017382622, 55236.1467666626, 53380.57349205017, 47343.71350288391, 49010.88710832596, 42131.00667095184, 54670.97331237793, 45928.020067214966, 55431.45374298096, 52641.59345817566, 50187.306862831116, 54279.62680053711, 52674.21993255615, 50671.560282707214, 48982.34713447094, 52323.426730155945, 54375.06691741943, 52981.360301971436, 50798.72011566162, 55077.48022556305, 51885.68006134033, 49054.89337491989, 42400.453332424164, 54441.13359260559, 53353.10672187805, 49777.613419532776, 50157.20012664795, 48395.966574668884, 51393.32690620422, 49398.959948539734, 50263.38008308411, 50715.86006641388, 49003.83338928223, 54157.23328208923, 54223.15336608887, 51387.86671924591, 52439.580258607864, 55465.933265686035, 50600.966796875, 56443.85997009277, 49931.23349571228, 53282.80017089844, 50691.47999763489, 54309.04033470154, 51299.84671115875, 54672.26012992859, 45870.486795425415, 54055.213470458984, 47563.08654689789, 54396.58673477173, 46995.23337554932, 51886.1734085083, 51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.29492273202621, "mean_inference_ms": 6.694455411803138, "mean_action_processing_ms": 0.20027180838086797, "mean_env_wait_ms": 225.48706208486306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06528133931367294, "StateBufferConnector_ms": 0.0330191591511602, "ViewRequirementAgentConnector_ms": 0.2232212087382441}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.76070690539598, "num_env_steps_trained_throughput_per_sec": 208.76070690539598, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 16696.377, "sample_time_ms": 12544.82, "learn_time_ms": 3998.601, "learn_throughput": 1000.35, "synch_weights_time_ms": 152.211}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 4868, "training_iteration": 166, "trial_id": "185f8_00000", "date": "2025-03-21_12-28-47", "timestamp": 1742560127, "time_this_iter_s": 19.209059476852417, "time_total_s": 2650.367490530014, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20de0e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2650.367490530014, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 95.00769230769232, "ram_util_percent": 13.707692307692307}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984162330627441, "policy_loss": -0.015093179419636726, "vf_loss": 9.997589111328125, "vf_explained_var": -1.023213087592012e-07, "kl": 0.008332853205502033, "entropy": 0.42506784200668335, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": 51507.57357406616, "episode_reward_min": 51507.57357406616, "episode_reward_mean": 51507.57357406616, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51507.57357406616}, "policy_reward_max": {"agent_0": 51507.57357406616}, "policy_reward_mean": {"agent_0": 51507.57357406616}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51507.57357406616], "episode_lengths": [134], "policy_agent_0_reward": [51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.10431005239891, "mean_inference_ms": 6.301429476774773, "mean_action_processing_ms": 0.19992436703912242, "mean_env_wait_ms": 230.14099786852842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041365623474121094, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.17597675323486328}}, "episode_reward_max": 51507.57357406616, "episode_reward_min": 51507.57357406616, "episode_reward_mean": 51507.57357406616, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51507.57357406616}, "policy_reward_max": {"agent_0": 51507.57357406616}, "policy_reward_mean": {"agent_0": 51507.57357406616}, "hist_stats": {"episode_reward": [51507.57357406616], "episode_lengths": [134], "policy_agent_0_reward": [51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.10431005239891, "mean_inference_ms": 6.301429476774773, "mean_action_processing_ms": 0.19992436703912242, "mean_env_wait_ms": 230.14099786852842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041365623474121094, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.17597675323486328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.4711316961757, "num_env_steps_trained_throughput_per_sec": 281.4711316961757, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 16285.083, "sample_time_ms": 12077.297, "learn_time_ms": 4048.097, "learn_throughput": 988.119, "synch_weights_time_ms": 158.941}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 4868, "training_iteration": 167, "trial_id": "185f8_00000", "date": "2025-03-21_12-29-02", "timestamp": 1742560142, "time_this_iter_s": 14.274378299713135, "time_total_s": 2664.641868829727, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f6a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2664.641868829727, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.738095238095235}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981955528259277, "policy_loss": -0.01749463565647602, "vf_loss": 9.99755859375, "vf_explained_var": 1.7384687467369986e-08, "kl": 0.009457995183765888, "entropy": 0.4206627607345581, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 51507.57357406616, "episode_reward_min": 51507.57357406616, "episode_reward_mean": 51507.57357406616, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51507.57357406616}, "policy_reward_max": {"agent_0": 51507.57357406616}, "policy_reward_mean": {"agent_0": 51507.57357406616}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51507.57357406616], "episode_lengths": [134], "policy_agent_0_reward": [51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.10431005239891, "mean_inference_ms": 6.301429476774773, "mean_action_processing_ms": 0.19992436703912242, "mean_env_wait_ms": 230.14099786852842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041365623474121094, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.17597675323486328}}, "episode_reward_max": 51507.57357406616, "episode_reward_min": 51507.57357406616, "episode_reward_mean": 51507.57357406616, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51507.57357406616}, "policy_reward_max": {"agent_0": 51507.57357406616}, "policy_reward_mean": {"agent_0": 51507.57357406616}, "hist_stats": {"episode_reward": [51507.57357406616], "episode_lengths": [134], "policy_agent_0_reward": [51507.57357406616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.10431005239891, "mean_inference_ms": 6.301429476774773, "mean_action_processing_ms": 0.19992436703912242, "mean_env_wait_ms": 230.14099786852842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041365623474121094, "StateBufferConnector_ms": 0.006580352783203125, "ViewRequirementAgentConnector_ms": 0.17597675323486328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.01545220104117, "num_env_steps_trained_throughput_per_sec": 268.01545220104117, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15876.014, "sample_time_ms": 11701.279, "learn_time_ms": 4016.968, "learn_throughput": 995.776, "synch_weights_time_ms": 156.993}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 4868, "training_iteration": 168, "trial_id": "185f8_00000", "date": "2025-03-21_12-29-17", "timestamp": 1742560157, "time_this_iter_s": 14.979601621627808, "time_total_s": 2679.621470451355, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f6b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2679.621470451355, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.52857142857142, "ram_util_percent": 13.699999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.90417766571045, "policy_loss": -0.017959482967853546, "vf_loss": 9.919962882995605, "vf_explained_var": -2.603605480544502e-06, "kl": 0.010873261839151382, "entropy": 0.4391942024230957, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": 54784.000076293945, "episode_reward_min": 46596.113493442535, "episode_reward_mean": 51490.87719026208, "episode_len_mean": 135.34375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46596.113493442535}, "policy_reward_max": {"agent_0": 54784.000076293945}, "policy_reward_mean": {"agent_0": 51490.87719026208}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54160.9603767395, 54565.1336517334, 52712.30020713806, 53917.79345703125, 54426.62678909302, 51443.07345867157, 51405.18683719635, 49720.85996246338, 54784.000076293945, 51957.3733291626, 49482.18703556061, 53112.85330104828, 46596.113493442535, 49652.706802368164, 47680.433267593384, 51884.75330400467, 50363.780084609985, 53909.05350494385, 51829.94674682617, 51558.10669994354, 53987.253410339355, 51374.84688663483, 50524.20670223236, 49760.320137023926, 51406.12664985657, 49858.69323730469, 54058.286880493164, 50045.09350204468, 49826.09993839264, 49849.58670806885, 50436.82020378113, 51417.4934463501], "episode_lengths": [134, 134, 137, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 134, 135, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [54160.9603767395, 54565.1336517334, 52712.30020713806, 53917.79345703125, 54426.62678909302, 51443.07345867157, 51405.18683719635, 49720.85996246338, 54784.000076293945, 51957.3733291626, 49482.18703556061, 53112.85330104828, 46596.113493442535, 49652.706802368164, 47680.433267593384, 51884.75330400467, 50363.780084609985, 53909.05350494385, 51829.94674682617, 51558.10669994354, 53987.253410339355, 51374.84688663483, 50524.20670223236, 49760.320137023926, 51406.12664985657, 49858.69323730469, 54058.286880493164, 50045.09350204468, 49826.09993839264, 49849.58670806885, 50436.82020378113, 51417.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.99929302506611, "mean_inference_ms": 6.431520321797453, "mean_action_processing_ms": 0.20069156113214584, "mean_env_wait_ms": 209.88298485215182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0931963324546814, "StateBufferConnector_ms": 0.006348639726638794, "ViewRequirementAgentConnector_ms": 0.21945089101791382}}, "episode_reward_max": 54784.000076293945, "episode_reward_min": 46596.113493442535, "episode_reward_mean": 51490.87719026208, "episode_len_mean": 135.34375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46596.113493442535}, "policy_reward_max": {"agent_0": 54784.000076293945}, "policy_reward_mean": {"agent_0": 51490.87719026208}, "hist_stats": {"episode_reward": [54160.9603767395, 54565.1336517334, 52712.30020713806, 53917.79345703125, 54426.62678909302, 51443.07345867157, 51405.18683719635, 49720.85996246338, 54784.000076293945, 51957.3733291626, 49482.18703556061, 53112.85330104828, 46596.113493442535, 49652.706802368164, 47680.433267593384, 51884.75330400467, 50363.780084609985, 53909.05350494385, 51829.94674682617, 51558.10669994354, 53987.253410339355, 51374.84688663483, 50524.20670223236, 49760.320137023926, 51406.12664985657, 49858.69323730469, 54058.286880493164, 50045.09350204468, 49826.09993839264, 49849.58670806885, 50436.82020378113, 51417.4934463501], "episode_lengths": [134, 134, 137, 135, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 134, 135, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [54160.9603767395, 54565.1336517334, 52712.30020713806, 53917.79345703125, 54426.62678909302, 51443.07345867157, 51405.18683719635, 49720.85996246338, 54784.000076293945, 51957.3733291626, 49482.18703556061, 53112.85330104828, 46596.113493442535, 49652.706802368164, 47680.433267593384, 51884.75330400467, 50363.780084609985, 53909.05350494385, 51829.94674682617, 51558.10669994354, 53987.253410339355, 51374.84688663483, 50524.20670223236, 49760.320137023926, 51406.12664985657, 49858.69323730469, 54058.286880493164, 50045.09350204468, 49826.09993839264, 49849.58670806885, 50436.82020378113, 51417.4934463501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.99929302506611, "mean_inference_ms": 6.431520321797453, "mean_action_processing_ms": 0.20069156113214584, "mean_env_wait_ms": 209.88298485215182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0931963324546814, "StateBufferConnector_ms": 0.006348639726638794, "ViewRequirementAgentConnector_ms": 0.21945089101791382}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.05112197491806, "num_env_steps_trained_throughput_per_sec": 247.05112197491806, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 16045.624, "sample_time_ms": 11917.686, "learn_time_ms": 3981.568, "learn_throughput": 1004.629, "synch_weights_time_ms": 145.603}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 4900, "training_iteration": 169, "trial_id": "185f8_00000", "date": "2025-03-21_12-29-33", "timestamp": 1742560173, "time_this_iter_s": 16.252097606658936, "time_total_s": 2695.873568058014, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f53f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2695.873568058014, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.41739130434782, "ram_util_percent": 13.739130434782611}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.759769439697266, "policy_loss": -0.013722136616706848, "vf_loss": 9.77148723602295, "vf_explained_var": -1.0437021273901337e-06, "kl": 0.010018755681812763, "entropy": 0.4516976475715637, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": 57657.89360046387, "episode_reward_min": 42987.366797447205, "episode_reward_mean": 51716.05863263425, "episode_len_mean": 135.3804347826087, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42987.366797447205}, "policy_reward_max": {"agent_0": 57657.89360046387}, "policy_reward_mean": {"agent_0": 51716.05863263425}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54768.853172302246, 52027.58016395569, 54236.75335025787, 53524.73327636719, 51663.01328706741, 51505.08670806885, 43880.80676841736, 54584.14694213867, 55349.50670623779, 51390.85347080231, 49737.866765499115, 56036.62677001953, 52884.1068649292, 54894.00010108948, 54557.24695587158, 49531.880014419556, 51664.760025024414, 48969.78019332886, 55298.00011062622, 50003.22017228603, 56344.127014160156, 51292.24689543247, 45452.146986961365, 48689.820026397705, 52913.58027267456, 51753.34048271179, 53808.0401763916, 52189.22662448883, 54456.980224609375, 47240.14680194855, 56991.90016937256, 54729.0535736084, 54652.52661323547, 52972.473450660706, 54225.980056762695, 45249.81988620758, 50439.14687728882, 50353.97354888916, 55028.0534286499, 52143.980113983154, 52756.06676483154, 51381.51342391968, 50486.90010738373, 54166.627073287964, 48355.62016129494, 54125.56008911133, 52810.91349029541, 53966.38026428223, 54561.08012199402, 49387.92010116577, 51615.00679206848, 45049.733399152756, 48892.09349632263, 56696.4407043457, 53563.547174453735, 42987.366797447205, 51478.01356124878, 49868.25319862366, 49832.286697387695, 52648.68019104004, 52156.96689224243, 51344.77338337898, 51203.43337249756, 55245.240325927734, 50785.33352279663, 47019.89363193512, 57657.89360046387, 52375.81341934204, 55796.30015563965, 46366.8067445755, 51522.53330993652, 49322.933530807495, 47575.09338128567, 51467.56709098816, 55920.646797180176, 52296.23350524902, 53832.70683288574, 52745.740234375, 55019.52687072754, 50688.460092544556, 55448.7336769104, 52400.98009490967, 48368.82004261017, 50399.24689698219, 46902.61337137222, 49985.953523635864, 52363.493569374084, 48051.77343082428, 52060.21371459961, 50016.486891150475, 46161.98688542843, 53307.80675697327], "episode_lengths": [135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 134, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 136], "policy_agent_0_reward": [54768.853172302246, 52027.58016395569, 54236.75335025787, 53524.73327636719, 51663.01328706741, 51505.08670806885, 43880.80676841736, 54584.14694213867, 55349.50670623779, 51390.85347080231, 49737.866765499115, 56036.62677001953, 52884.1068649292, 54894.00010108948, 54557.24695587158, 49531.880014419556, 51664.760025024414, 48969.78019332886, 55298.00011062622, 50003.22017228603, 56344.127014160156, 51292.24689543247, 45452.146986961365, 48689.820026397705, 52913.58027267456, 51753.34048271179, 53808.0401763916, 52189.22662448883, 54456.980224609375, 47240.14680194855, 56991.90016937256, 54729.0535736084, 54652.52661323547, 52972.473450660706, 54225.980056762695, 45249.81988620758, 50439.14687728882, 50353.97354888916, 55028.0534286499, 52143.980113983154, 52756.06676483154, 51381.51342391968, 50486.90010738373, 54166.627073287964, 48355.62016129494, 54125.56008911133, 52810.91349029541, 53966.38026428223, 54561.08012199402, 49387.92010116577, 51615.00679206848, 45049.733399152756, 48892.09349632263, 56696.4407043457, 53563.547174453735, 42987.366797447205, 51478.01356124878, 49868.25319862366, 49832.286697387695, 52648.68019104004, 52156.96689224243, 51344.77338337898, 51203.43337249756, 55245.240325927734, 50785.33352279663, 47019.89363193512, 57657.89360046387, 52375.81341934204, 55796.30015563965, 46366.8067445755, 51522.53330993652, 49322.933530807495, 47575.09338128567, 51467.56709098816, 55920.646797180176, 52296.23350524902, 53832.70683288574, 52745.740234375, 55019.52687072754, 50688.460092544556, 55448.7336769104, 52400.98009490967, 48368.82004261017, 50399.24689698219, 46902.61337137222, 49985.953523635864, 52363.493569374084, 48051.77343082428, 52060.21371459961, 50016.486891150475, 46161.98688542843, 53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.2615917991929, "mean_inference_ms": 6.700962338239869, "mean_action_processing_ms": 0.20019556971688282, "mean_env_wait_ms": 225.7263661373967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051560350086378014, "StateBufferConnector_ms": 0.006108439486959706, "ViewRequirementAgentConnector_ms": 0.23977290029111115}}, "episode_reward_max": 57657.89360046387, "episode_reward_min": 42987.366797447205, "episode_reward_mean": 51716.05863263425, "episode_len_mean": 135.3804347826087, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 42987.366797447205}, "policy_reward_max": {"agent_0": 57657.89360046387}, "policy_reward_mean": {"agent_0": 51716.05863263425}, "hist_stats": {"episode_reward": [54768.853172302246, 52027.58016395569, 54236.75335025787, 53524.73327636719, 51663.01328706741, 51505.08670806885, 43880.80676841736, 54584.14694213867, 55349.50670623779, 51390.85347080231, 49737.866765499115, 56036.62677001953, 52884.1068649292, 54894.00010108948, 54557.24695587158, 49531.880014419556, 51664.760025024414, 48969.78019332886, 55298.00011062622, 50003.22017228603, 56344.127014160156, 51292.24689543247, 45452.146986961365, 48689.820026397705, 52913.58027267456, 51753.34048271179, 53808.0401763916, 52189.22662448883, 54456.980224609375, 47240.14680194855, 56991.90016937256, 54729.0535736084, 54652.52661323547, 52972.473450660706, 54225.980056762695, 45249.81988620758, 50439.14687728882, 50353.97354888916, 55028.0534286499, 52143.980113983154, 52756.06676483154, 51381.51342391968, 50486.90010738373, 54166.627073287964, 48355.62016129494, 54125.56008911133, 52810.91349029541, 53966.38026428223, 54561.08012199402, 49387.92010116577, 51615.00679206848, 45049.733399152756, 48892.09349632263, 56696.4407043457, 53563.547174453735, 42987.366797447205, 51478.01356124878, 49868.25319862366, 49832.286697387695, 52648.68019104004, 52156.96689224243, 51344.77338337898, 51203.43337249756, 55245.240325927734, 50785.33352279663, 47019.89363193512, 57657.89360046387, 52375.81341934204, 55796.30015563965, 46366.8067445755, 51522.53330993652, 49322.933530807495, 47575.09338128567, 51467.56709098816, 55920.646797180176, 52296.23350524902, 53832.70683288574, 52745.740234375, 55019.52687072754, 50688.460092544556, 55448.7336769104, 52400.98009490967, 48368.82004261017, 50399.24689698219, 46902.61337137222, 49985.953523635864, 52363.493569374084, 48051.77343082428, 52060.21371459961, 50016.486891150475, 46161.98688542843, 53307.80675697327], "episode_lengths": [135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 134, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 136, 136], "policy_agent_0_reward": [54768.853172302246, 52027.58016395569, 54236.75335025787, 53524.73327636719, 51663.01328706741, 51505.08670806885, 43880.80676841736, 54584.14694213867, 55349.50670623779, 51390.85347080231, 49737.866765499115, 56036.62677001953, 52884.1068649292, 54894.00010108948, 54557.24695587158, 49531.880014419556, 51664.760025024414, 48969.78019332886, 55298.00011062622, 50003.22017228603, 56344.127014160156, 51292.24689543247, 45452.146986961365, 48689.820026397705, 52913.58027267456, 51753.34048271179, 53808.0401763916, 52189.22662448883, 54456.980224609375, 47240.14680194855, 56991.90016937256, 54729.0535736084, 54652.52661323547, 52972.473450660706, 54225.980056762695, 45249.81988620758, 50439.14687728882, 50353.97354888916, 55028.0534286499, 52143.980113983154, 52756.06676483154, 51381.51342391968, 50486.90010738373, 54166.627073287964, 48355.62016129494, 54125.56008911133, 52810.91349029541, 53966.38026428223, 54561.08012199402, 49387.92010116577, 51615.00679206848, 45049.733399152756, 48892.09349632263, 56696.4407043457, 53563.547174453735, 42987.366797447205, 51478.01356124878, 49868.25319862366, 49832.286697387695, 52648.68019104004, 52156.96689224243, 51344.77338337898, 51203.43337249756, 55245.240325927734, 50785.33352279663, 47019.89363193512, 57657.89360046387, 52375.81341934204, 55796.30015563965, 46366.8067445755, 51522.53330993652, 49322.933530807495, 47575.09338128567, 51467.56709098816, 55920.646797180176, 52296.23350524902, 53832.70683288574, 52745.740234375, 55019.52687072754, 50688.460092544556, 55448.7336769104, 52400.98009490967, 48368.82004261017, 50399.24689698219, 46902.61337137222, 49985.953523635864, 52363.493569374084, 48051.77343082428, 52060.21371459961, 50016.486891150475, 46161.98688542843, 53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.2615917991929, "mean_inference_ms": 6.700962338239869, "mean_action_processing_ms": 0.20019556971688282, "mean_env_wait_ms": 225.7263661373967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051560350086378014, "StateBufferConnector_ms": 0.006108439486959706, "ViewRequirementAgentConnector_ms": 0.23977290029111115}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.7629546638352, "num_env_steps_trained_throughput_per_sec": 199.7629546638352, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 16634.923, "sample_time_ms": 12463.911, "learn_time_ms": 4030.325, "learn_throughput": 992.476, "synch_weights_time_ms": 139.942}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 4992, "training_iteration": 170, "trial_id": "185f8_00000", "date": "2025-03-21_12-29-53", "timestamp": 1742560193, "time_this_iter_s": 20.085942029953003, "time_total_s": 2715.959510087967, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f6a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2715.959510087967, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 95.47142857142856, "ram_util_percent": 13.775000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984639167785645, "policy_loss": -0.01731475628912449, "vf_loss": 10.0, "vf_explained_var": -1.4847765896774945e-06, "kl": 0.009766499511897564, "entropy": 0.4388512969017029, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 53307.80675697327, "episode_reward_min": 53307.80675697327, "episode_reward_mean": 53307.80675697327, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53307.80675697327}, "policy_reward_max": {"agent_0": 53307.80675697327}, "policy_reward_mean": {"agent_0": 53307.80675697327}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53307.80675697327], "episode_lengths": [136], "policy_agent_0_reward": [53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.24943813736924, "mean_inference_ms": 6.2908327463378235, "mean_action_processing_ms": 0.19985659774053932, "mean_env_wait_ms": 230.6170590198603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037860870361328125, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.1623392105102539}}, "episode_reward_max": 53307.80675697327, "episode_reward_min": 53307.80675697327, "episode_reward_mean": 53307.80675697327, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53307.80675697327}, "policy_reward_max": {"agent_0": 53307.80675697327}, "policy_reward_mean": {"agent_0": 53307.80675697327}, "hist_stats": {"episode_reward": [53307.80675697327], "episode_lengths": [136], "policy_agent_0_reward": [53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.24943813736924, "mean_inference_ms": 6.2908327463378235, "mean_action_processing_ms": 0.19985659774053932, "mean_env_wait_ms": 230.6170590198603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037860870361328125, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.1623392105102539}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.391358175513, "num_env_steps_trained_throughput_per_sec": 288.391358175513, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 16263.406, "sample_time_ms": 12059.465, "learn_time_ms": 4067.887, "learn_throughput": 983.311, "synch_weights_time_ms": 135.313}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 4992, "training_iteration": 171, "trial_id": "185f8_00000", "date": "2025-03-21_12-30-07", "timestamp": 1742560207, "time_this_iter_s": 13.93299388885498, "time_total_s": 2729.892503976822, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f5fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2729.892503976822, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.48500000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98534870147705, "policy_loss": -0.01662193052470684, "vf_loss": 10.0, "vf_explained_var": -2.779066505809169e-07, "kl": 0.00985463336110115, "entropy": 0.46722760796546936, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": 53307.80675697327, "episode_reward_min": 53307.80675697327, "episode_reward_mean": 53307.80675697327, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53307.80675697327}, "policy_reward_max": {"agent_0": 53307.80675697327}, "policy_reward_mean": {"agent_0": 53307.80675697327}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53307.80675697327], "episode_lengths": [136], "policy_agent_0_reward": [53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.24943813736924, "mean_inference_ms": 6.2908327463378235, "mean_action_processing_ms": 0.19985659774053932, "mean_env_wait_ms": 230.6170590198603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037860870361328125, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.1623392105102539}}, "episode_reward_max": 53307.80675697327, "episode_reward_min": 53307.80675697327, "episode_reward_mean": 53307.80675697327, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53307.80675697327}, "policy_reward_max": {"agent_0": 53307.80675697327}, "policy_reward_mean": {"agent_0": 53307.80675697327}, "hist_stats": {"episode_reward": [53307.80675697327], "episode_lengths": [136], "policy_agent_0_reward": [53307.80675697327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.24943813736924, "mean_inference_ms": 6.2908327463378235, "mean_action_processing_ms": 0.19985659774053932, "mean_env_wait_ms": 230.6170590198603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037860870361328125, "StateBufferConnector_ms": 0.0058650970458984375, "ViewRequirementAgentConnector_ms": 0.1623392105102539}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.04609144732507, "num_env_steps_trained_throughput_per_sec": 283.04609144732507, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15774.494, "sample_time_ms": 11595.573, "learn_time_ms": 4051.522, "learn_throughput": 987.283, "synch_weights_time_ms": 126.658}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 4992, "training_iteration": 172, "trial_id": "185f8_00000", "date": "2025-03-21_12-30-21", "timestamp": 1742560221, "time_this_iter_s": 14.218664646148682, "time_total_s": 2744.1111686229706, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f67a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2744.1111686229706, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.67500000000001, "ram_util_percent": 13.714999999999998}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.900590896606445, "policy_loss": -0.018506348133087158, "vf_loss": 9.9169921875, "vf_explained_var": 6.25227869477385e-08, "kl": 0.010526183061301708, "entropy": 0.44017308950424194, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": 56682.60004425049, "episode_reward_min": 41954.960252285004, "episode_reward_mean": 51717.62783902511, "episode_len_mean": 135.4375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 41954.960252285004}, "policy_reward_max": {"agent_0": 56682.60004425049}, "policy_reward_mean": {"agent_0": 51717.62783902511}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50692.39345240593, 46121.03999423981, 54040.28671169281, 55878.780014038086, 52443.18670654297, 56045.20664978027, 52430.76685142517, 53016.2533864975, 50908.00033569336, 54425.500076293945, 50737.52672576904, 46645.85328292847, 48798.35344696045, 54874.107025146484, 53169.9601521492, 55505.68684387207, 54389.8000793457, 51960.70705413818, 48095.38031959534, 47071.020116090775, 54776.98010253906, 47176.90682601929, 55755.47322845459, 51593.23355102539, 44551.94021320343, 54494.67353439331, 54343.17989528179, 50926.93360900879, 51605.186836242676, 41954.960252285004, 53852.21353149414, 56682.60004425049], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 137, 136, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 137, 135, 135], "policy_agent_0_reward": [50692.39345240593, 46121.03999423981, 54040.28671169281, 55878.780014038086, 52443.18670654297, 56045.20664978027, 52430.76685142517, 53016.2533864975, 50908.00033569336, 54425.500076293945, 50737.52672576904, 46645.85328292847, 48798.35344696045, 54874.107025146484, 53169.9601521492, 55505.68684387207, 54389.8000793457, 51960.70705413818, 48095.38031959534, 47071.020116090775, 54776.98010253906, 47176.90682601929, 55755.47322845459, 51593.23355102539, 44551.94021320343, 54494.67353439331, 54343.17989528179, 50926.93360900879, 51605.186836242676, 41954.960252285004, 53852.21353149414, 56682.60004425049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.479941560800356, "mean_inference_ms": 6.434020581418704, "mean_action_processing_ms": 0.20063934152890422, "mean_env_wait_ms": 210.11782075342074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05815625190734863, "StateBufferConnector_ms": 0.006383657455444336, "ViewRequirementAgentConnector_ms": 0.31722262501716614}}, "episode_reward_max": 56682.60004425049, "episode_reward_min": 41954.960252285004, "episode_reward_mean": 51717.62783902511, "episode_len_mean": 135.4375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 41954.960252285004}, "policy_reward_max": {"agent_0": 56682.60004425049}, "policy_reward_mean": {"agent_0": 51717.62783902511}, "hist_stats": {"episode_reward": [50692.39345240593, 46121.03999423981, 54040.28671169281, 55878.780014038086, 52443.18670654297, 56045.20664978027, 52430.76685142517, 53016.2533864975, 50908.00033569336, 54425.500076293945, 50737.52672576904, 46645.85328292847, 48798.35344696045, 54874.107025146484, 53169.9601521492, 55505.68684387207, 54389.8000793457, 51960.70705413818, 48095.38031959534, 47071.020116090775, 54776.98010253906, 47176.90682601929, 55755.47322845459, 51593.23355102539, 44551.94021320343, 54494.67353439331, 54343.17989528179, 50926.93360900879, 51605.186836242676, 41954.960252285004, 53852.21353149414, 56682.60004425049], "episode_lengths": [135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 137, 136, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 137, 135, 135], "policy_agent_0_reward": [50692.39345240593, 46121.03999423981, 54040.28671169281, 55878.780014038086, 52443.18670654297, 56045.20664978027, 52430.76685142517, 53016.2533864975, 50908.00033569336, 54425.500076293945, 50737.52672576904, 46645.85328292847, 48798.35344696045, 54874.107025146484, 53169.9601521492, 55505.68684387207, 54389.8000793457, 51960.70705413818, 48095.38031959534, 47071.020116090775, 54776.98010253906, 47176.90682601929, 55755.47322845459, 51593.23355102539, 44551.94021320343, 54494.67353439331, 54343.17989528179, 50926.93360900879, 51605.186836242676, 41954.960252285004, 53852.21353149414, 56682.60004425049]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.479941560800356, "mean_inference_ms": 6.434020581418704, "mean_action_processing_ms": 0.20063934152890422, "mean_env_wait_ms": 210.11782075342074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05815625190734863, "StateBufferConnector_ms": 0.006383657455444336, "ViewRequirementAgentConnector_ms": 0.31722262501716614}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.2965284180584, "num_env_steps_trained_throughput_per_sec": 269.2965284180584, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 15876.044, "sample_time_ms": 11641.425, "learn_time_ms": 4109.557, "learn_throughput": 973.341, "synch_weights_time_ms": 124.304}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 5024, "training_iteration": 173, "trial_id": "185f8_00000", "date": "2025-03-21_12-30-36", "timestamp": 1742560236, "time_this_iter_s": 14.91112494468689, "time_total_s": 2759.0222935676575, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc28c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2759.0222935676575, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.757142857142858}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.79322624206543, "policy_loss": -0.016346152871847153, "vf_loss": 9.807618141174316, "vf_explained_var": -2.8846164923379547e-07, "kl": 0.009771492332220078, "entropy": 0.42731934785842896, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 56181.92044067383, "episode_reward_min": 41335.51996421814, "episode_reward_mean": 51582.040064541136, "episode_len_mean": 135.3421052631579, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {"agent_0": 41335.51996421814}, "policy_reward_max": {"agent_0": 56181.92044067383}, "policy_reward_mean": {"agent_0": 51582.040064541136}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [41335.51996421814, 53622.11351776123, 53799.60689163208, 48278.68681097031, 45809.726867198944, 52166.02675437927, 55865.72020816803, 53143.82675027847, 53738.786880493164, 52823.000249385834, 49490.06662750244, 50742.64009094238, 50436.700202703476, 55015.21318054199, 52375.17997741699, 55613.97332859039, 51272.600111961365, 50974.32016944885, 52937.64012145996, 54256.646797180176, 52722.63349723816, 46156.020224928856, 52683.55348110199, 48533.25999426842, 52830.200105428696, 53747.153495788574, 54859.46696090698, 53485.83347129822, 52489.113607406616, 54808.7399559021, 51079.28672790527, 47332.56017303467, 53856.953594207764, 53035.38694000244, 50557.926834106445, 43418.95360660553, 46566.42688560486, 51534.91357803345, 55551.03355407715, 54692.09376525879, 55841.68016052246, 50184.34004211426, 53563.04001617432, 52035.18686956167, 53734.81997680664, 56181.92044067383, 51757.266872406006, 50220.446808815, 53649.80697631836, 54353.78667449951, 50445.76668679714, 48760.2334318161, 47842.38020014763, 48272.880210876465, 52593.73364448547, 49383.746660232544, 54494.69331359863, 50397.57338142395, 52703.84694290161, 48922.413610458374, 54477.14702320099, 49594.28013896942, 49923.74684596062, 53072.23337960243, 52855.78032493591, 47187.826758384705, 49479.786739349365, 53441.086585998535, 52690.41339111328, 53338.86018371582, 52432.22687149048, 46307.67361831665, 55382.02018737793, 49962.35342478752, 52754.2004699707, 48356.34008598328], "episode_lengths": [135, 135, 135, 136, 137, 135, 134, 135, 135, 135, 137, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [41335.51996421814, 53622.11351776123, 53799.60689163208, 48278.68681097031, 45809.726867198944, 52166.02675437927, 55865.72020816803, 53143.82675027847, 53738.786880493164, 52823.000249385834, 49490.06662750244, 50742.64009094238, 50436.700202703476, 55015.21318054199, 52375.17997741699, 55613.97332859039, 51272.600111961365, 50974.32016944885, 52937.64012145996, 54256.646797180176, 52722.63349723816, 46156.020224928856, 52683.55348110199, 48533.25999426842, 52830.200105428696, 53747.153495788574, 54859.46696090698, 53485.83347129822, 52489.113607406616, 54808.7399559021, 51079.28672790527, 47332.56017303467, 53856.953594207764, 53035.38694000244, 50557.926834106445, 43418.95360660553, 46566.42688560486, 51534.91357803345, 55551.03355407715, 54692.09376525879, 55841.68016052246, 50184.34004211426, 53563.04001617432, 52035.18686956167, 53734.81997680664, 56181.92044067383, 51757.266872406006, 50220.446808815, 53649.80697631836, 54353.78667449951, 50445.76668679714, 48760.2334318161, 47842.38020014763, 48272.880210876465, 52593.73364448547, 49383.746660232544, 54494.69331359863, 50397.57338142395, 52703.84694290161, 48922.413610458374, 54477.14702320099, 49594.28013896942, 49923.74684596062, 53072.23337960243, 52855.78032493591, 47187.826758384705, 49479.786739349365, 53441.086585998535, 52690.41339111328, 53338.86018371582, 52432.22687149048, 46307.67361831665, 55382.02018737793, 49962.35342478752, 52754.2004699707, 48356.34008598328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.22655441106876, "mean_inference_ms": 6.690220205249666, "mean_action_processing_ms": 0.20049757300456014, "mean_env_wait_ms": 225.52598008705178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07667447391309236, "StateBufferConnector_ms": 0.020662734383030942, "ViewRequirementAgentConnector_ms": 0.18473236184371145}}, "episode_reward_max": 56181.92044067383, "episode_reward_min": 41335.51996421814, "episode_reward_mean": 51582.040064541136, "episode_len_mean": 135.3421052631579, "episodes_this_iter": 76, "policy_reward_min": {"agent_0": 41335.51996421814}, "policy_reward_max": {"agent_0": 56181.92044067383}, "policy_reward_mean": {"agent_0": 51582.040064541136}, "hist_stats": {"episode_reward": [41335.51996421814, 53622.11351776123, 53799.60689163208, 48278.68681097031, 45809.726867198944, 52166.02675437927, 55865.72020816803, 53143.82675027847, 53738.786880493164, 52823.000249385834, 49490.06662750244, 50742.64009094238, 50436.700202703476, 55015.21318054199, 52375.17997741699, 55613.97332859039, 51272.600111961365, 50974.32016944885, 52937.64012145996, 54256.646797180176, 52722.63349723816, 46156.020224928856, 52683.55348110199, 48533.25999426842, 52830.200105428696, 53747.153495788574, 54859.46696090698, 53485.83347129822, 52489.113607406616, 54808.7399559021, 51079.28672790527, 47332.56017303467, 53856.953594207764, 53035.38694000244, 50557.926834106445, 43418.95360660553, 46566.42688560486, 51534.91357803345, 55551.03355407715, 54692.09376525879, 55841.68016052246, 50184.34004211426, 53563.04001617432, 52035.18686956167, 53734.81997680664, 56181.92044067383, 51757.266872406006, 50220.446808815, 53649.80697631836, 54353.78667449951, 50445.76668679714, 48760.2334318161, 47842.38020014763, 48272.880210876465, 52593.73364448547, 49383.746660232544, 54494.69331359863, 50397.57338142395, 52703.84694290161, 48922.413610458374, 54477.14702320099, 49594.28013896942, 49923.74684596062, 53072.23337960243, 52855.78032493591, 47187.826758384705, 49479.786739349365, 53441.086585998535, 52690.41339111328, 53338.86018371582, 52432.22687149048, 46307.67361831665, 55382.02018737793, 49962.35342478752, 52754.2004699707, 48356.34008598328], "episode_lengths": [135, 135, 135, 136, 137, 135, 134, 135, 135, 135, 137, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 134, 135, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [41335.51996421814, 53622.11351776123, 53799.60689163208, 48278.68681097031, 45809.726867198944, 52166.02675437927, 55865.72020816803, 53143.82675027847, 53738.786880493164, 52823.000249385834, 49490.06662750244, 50742.64009094238, 50436.700202703476, 55015.21318054199, 52375.17997741699, 55613.97332859039, 51272.600111961365, 50974.32016944885, 52937.64012145996, 54256.646797180176, 52722.63349723816, 46156.020224928856, 52683.55348110199, 48533.25999426842, 52830.200105428696, 53747.153495788574, 54859.46696090698, 53485.83347129822, 52489.113607406616, 54808.7399559021, 51079.28672790527, 47332.56017303467, 53856.953594207764, 53035.38694000244, 50557.926834106445, 43418.95360660553, 46566.42688560486, 51534.91357803345, 55551.03355407715, 54692.09376525879, 55841.68016052246, 50184.34004211426, 53563.04001617432, 52035.18686956167, 53734.81997680664, 56181.92044067383, 51757.266872406006, 50220.446808815, 53649.80697631836, 54353.78667449951, 50445.76668679714, 48760.2334318161, 47842.38020014763, 48272.880210876465, 52593.73364448547, 49383.746660232544, 54494.69331359863, 50397.57338142395, 52703.84694290161, 48922.413610458374, 54477.14702320099, 49594.28013896942, 49923.74684596062, 53072.23337960243, 52855.78032493591, 47187.826758384705, 49479.786739349365, 53441.086585998535, 52690.41339111328, 53338.86018371582, 52432.22687149048, 46307.67361831665, 55382.02018737793, 49962.35342478752, 52754.2004699707, 48356.34008598328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.22655441106876, "mean_inference_ms": 6.690220205249666, "mean_action_processing_ms": 0.20049757300456014, "mean_env_wait_ms": 225.52598008705178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07667447391309236, "StateBufferConnector_ms": 0.020662734383030942, "ViewRequirementAgentConnector_ms": 0.18473236184371145}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.30148957920207, "num_env_steps_trained_throughput_per_sec": 241.30148957920207, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 16138.0, "sample_time_ms": 11978.502, "learn_time_ms": 4037.758, "learn_throughput": 990.649, "synch_weights_time_ms": 120.948}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 5100, "training_iteration": 174, "trial_id": "185f8_00000", "date": "2025-03-21_12-30-53", "timestamp": 1742560253, "time_this_iter_s": 16.629181623458862, "time_total_s": 2775.6514751911163, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2775.6514751911163, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 95.16521739130434, "ram_util_percent": 13.708695652173908}}
{"custom_metrics": {"num_batches_mean": 5.9375, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.943842887878418, "policy_loss": -0.016438180580735207, "vf_loss": 9.958246231079102, "vf_explained_var": -8.912322300602682e-06, "kl": 0.01016758382320404, "entropy": 0.4356692433357239, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": 56865.0002746582, "episode_reward_min": 44390.84018564224, "episode_reward_mean": 51269.75348370522, "episode_len_mean": 135.375, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 44390.84018564224}, "policy_reward_max": {"agent_0": 56865.0002746582}, "policy_reward_mean": {"agent_0": 51269.75348370522}, "custom_metrics": {"num_batches_mean": 5.9375, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54849.646980285645, 51560.00677871704, 44390.84018564224, 54150.28001213074, 44410.85338640213, 56501.18702697754, 49374.56686735153, 56196.66019439697, 52236.16678619385, 56865.0002746582, 52798.64664077759, 45355.11354547739, 52417.81328582764, 54382.793575286865, 50411.78667169809, 44414.6935274601], "episode_lengths": [135, 135, 137, 136, 136, 135, 135, 135, 136, 134, 134, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54849.646980285645, 51560.00677871704, 44390.84018564224, 54150.28001213074, 44410.85338640213, 56501.18702697754, 49374.56686735153, 56196.66019439697, 52236.16678619385, 56865.0002746582, 52798.64664077759, 45355.11354547739, 52417.81328582764, 54382.793575286865, 50411.78667169809, 44414.6935274601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.35551247341763, "mean_inference_ms": 6.736656027358678, "mean_action_processing_ms": 0.19875490182298694, "mean_env_wait_ms": 224.85597987959073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045071542263031006, "StateBufferConnector_ms": 0.005777180194854736, "ViewRequirementAgentConnector_ms": 0.22011399269104004}}, "episode_reward_max": 56865.0002746582, "episode_reward_min": 44390.84018564224, "episode_reward_mean": 51269.75348370522, "episode_len_mean": 135.375, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 44390.84018564224}, "policy_reward_max": {"agent_0": 56865.0002746582}, "policy_reward_mean": {"agent_0": 51269.75348370522}, "hist_stats": {"episode_reward": [54849.646980285645, 51560.00677871704, 44390.84018564224, 54150.28001213074, 44410.85338640213, 56501.18702697754, 49374.56686735153, 56196.66019439697, 52236.16678619385, 56865.0002746582, 52798.64664077759, 45355.11354547739, 52417.81328582764, 54382.793575286865, 50411.78667169809, 44414.6935274601], "episode_lengths": [135, 135, 137, 136, 136, 135, 135, 135, 136, 134, 134, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54849.646980285645, 51560.00677871704, 44390.84018564224, 54150.28001213074, 44410.85338640213, 56501.18702697754, 49374.56686735153, 56196.66019439697, 52236.16678619385, 56865.0002746582, 52798.64664077759, 45355.11354547739, 52417.81328582764, 54382.793575286865, 50411.78667169809, 44414.6935274601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.35551247341763, "mean_inference_ms": 6.736656027358678, "mean_action_processing_ms": 0.19875490182298694, "mean_env_wait_ms": 224.85597987959073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045071542263031006, "StateBufferConnector_ms": 0.005777180194854736, "ViewRequirementAgentConnector_ms": 0.22011399269104004}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.56744805016146, "num_env_steps_trained_throughput_per_sec": 251.56744805016146, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 15984.313, "sample_time_ms": 11838.148, "learn_time_ms": 4017.578, "learn_throughput": 995.625, "synch_weights_time_ms": 127.793}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 5116, "training_iteration": 175, "trial_id": "185f8_00000", "date": "2025-03-21_12-31-09", "timestamp": 1742560269, "time_this_iter_s": 15.957629680633545, "time_total_s": 2791.60910487175, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20dc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2791.60910487175, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.3409090909091, "ram_util_percent": 13.786363636363637}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989696502685547, "policy_loss": -0.01201067864894867, "vf_loss": 10.0, "vf_explained_var": -2.0744775611092336e-05, "kl": 0.008536088280379772, "entropy": 0.43409886956214905, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": 44414.6935274601, "episode_reward_min": 44414.6935274601, "episode_reward_mean": 44414.6935274601, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 44414.6935274601}, "policy_reward_max": {"agent_0": 44414.6935274601}, "policy_reward_mean": {"agent_0": 44414.6935274601}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [44414.6935274601], "episode_lengths": [136], "policy_agent_0_reward": [44414.6935274601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.93518062081428, "mean_inference_ms": 6.337875086289392, "mean_action_processing_ms": 0.19311955987800553, "mean_env_wait_ms": 224.03526748850652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03714561462402344, "StateBufferConnector_ms": 0.004792213439941406, "ViewRequirementAgentConnector_ms": 0.12280941009521484}}, "episode_reward_max": 44414.6935274601, "episode_reward_min": 44414.6935274601, "episode_reward_mean": 44414.6935274601, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 44414.6935274601}, "policy_reward_max": {"agent_0": 44414.6935274601}, "policy_reward_mean": {"agent_0": 44414.6935274601}, "hist_stats": {"episode_reward": [44414.6935274601], "episode_lengths": [136], "policy_agent_0_reward": [44414.6935274601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.93518062081428, "mean_inference_ms": 6.337875086289392, "mean_action_processing_ms": 0.19311955987800553, "mean_env_wait_ms": 224.03526748850652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03714561462402344, "StateBufferConnector_ms": 0.004792213439941406, "ViewRequirementAgentConnector_ms": 0.12280941009521484}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.13437711043804, "num_env_steps_trained_throughput_per_sec": 297.13437711043804, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15414.435, "sample_time_ms": 11266.054, "learn_time_ms": 4016.934, "learn_throughput": 995.784, "synch_weights_time_ms": 130.647}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 5116, "training_iteration": 176, "trial_id": "185f8_00000", "date": "2025-03-21_12-31-23", "timestamp": 1742560283, "time_this_iter_s": 13.513277053833008, "time_total_s": 2805.122381925583, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2805.122381925583, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.67894736842106, "ram_util_percent": 13.752631578947366}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.915328979492188, "policy_loss": -0.013975922018289566, "vf_loss": 9.927526473999023, "vf_explained_var": -1.9972524114564294e-06, "kl": 0.008886243216693401, "entropy": 0.40722712874412537, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 55847.06034851074, "episode_reward_min": 40618.29345989227, "episode_reward_mean": 51413.99601989779, "episode_len_mean": 135.3448275862069, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 40618.29345989227}, "policy_reward_max": {"agent_0": 55847.06034851074}, "policy_reward_mean": {"agent_0": 51413.99601989779}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54249.22017478943, 53880.860206604004, 51673.7199344635, 46947.88684940338, 53957.746978759766, 48067.52011680603, 53112.80686569214, 55847.06034851074, 47908.760120391846, 54113.6536026001, 50688.840074539185, 50610.699964523315, 48150.25355911255, 52424.420194625854, 51868.32662200928, 51046.3401260376, 54078.940200805664, 40618.29345989227, 54728.73334503174, 53286.96682739258, 52523.03370666504, 53944.70694351196, 48266.52005124092, 49526.5267868042, 46872.680050849915, 53574.553482055664, 53053.066818237305, 52574.760204315186, 53408.986961364746], "episode_lengths": [135, 136, 136, 136, 135, 136, 135, 134, 136, 135, 135, 135, 136, 134, 135, 136, 135, 136, 134, 137, 135, 135, 135, 136, 136, 135, 134, 136, 136], "policy_agent_0_reward": [54249.22017478943, 53880.860206604004, 51673.7199344635, 46947.88684940338, 53957.746978759766, 48067.52011680603, 53112.80686569214, 55847.06034851074, 47908.760120391846, 54113.6536026001, 50688.840074539185, 50610.699964523315, 48150.25355911255, 52424.420194625854, 51868.32662200928, 51046.3401260376, 54078.940200805664, 40618.29345989227, 54728.73334503174, 53286.96682739258, 52523.03370666504, 53944.70694351196, 48266.52005124092, 49526.5267868042, 46872.680050849915, 53574.553482055664, 53053.066818237305, 52574.760204315186, 53408.986961364746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.09121158653308, "mean_inference_ms": 6.4219530593950775, "mean_action_processing_ms": 0.20105329565405258, "mean_env_wait_ms": 210.62974277450812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03951993481866244, "StateBufferConnector_ms": 0.006174219065699084, "ViewRequirementAgentConnector_ms": 0.20873711026948075}}, "episode_reward_max": 55847.06034851074, "episode_reward_min": 40618.29345989227, "episode_reward_mean": 51413.99601989779, "episode_len_mean": 135.3448275862069, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 40618.29345989227}, "policy_reward_max": {"agent_0": 55847.06034851074}, "policy_reward_mean": {"agent_0": 51413.99601989779}, "hist_stats": {"episode_reward": [54249.22017478943, 53880.860206604004, 51673.7199344635, 46947.88684940338, 53957.746978759766, 48067.52011680603, 53112.80686569214, 55847.06034851074, 47908.760120391846, 54113.6536026001, 50688.840074539185, 50610.699964523315, 48150.25355911255, 52424.420194625854, 51868.32662200928, 51046.3401260376, 54078.940200805664, 40618.29345989227, 54728.73334503174, 53286.96682739258, 52523.03370666504, 53944.70694351196, 48266.52005124092, 49526.5267868042, 46872.680050849915, 53574.553482055664, 53053.066818237305, 52574.760204315186, 53408.986961364746], "episode_lengths": [135, 136, 136, 136, 135, 136, 135, 134, 136, 135, 135, 135, 136, 134, 135, 136, 135, 136, 134, 137, 135, 135, 135, 136, 136, 135, 134, 136, 136], "policy_agent_0_reward": [54249.22017478943, 53880.860206604004, 51673.7199344635, 46947.88684940338, 53957.746978759766, 48067.52011680603, 53112.80686569214, 55847.06034851074, 47908.760120391846, 54113.6536026001, 50688.840074539185, 50610.699964523315, 48150.25355911255, 52424.420194625854, 51868.32662200928, 51046.3401260376, 54078.940200805664, 40618.29345989227, 54728.73334503174, 53286.96682739258, 52523.03370666504, 53944.70694351196, 48266.52005124092, 49526.5267868042, 46872.680050849915, 53574.553482055664, 53053.066818237305, 52574.760204315186, 53408.986961364746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.09121158653308, "mean_inference_ms": 6.4219530593950775, "mean_action_processing_ms": 0.20105329565405258, "mean_env_wait_ms": 210.62974277450812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03951993481866244, "StateBufferConnector_ms": 0.006174219065699084, "ViewRequirementAgentConnector_ms": 0.20873711026948075}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.0352119129397, "num_env_steps_trained_throughput_per_sec": 254.0352119129397, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 15567.911, "sample_time_ms": 11426.651, "learn_time_ms": 4008.591, "learn_throughput": 997.857, "synch_weights_time_ms": 131.85}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 5145, "training_iteration": 177, "trial_id": "185f8_00000", "date": "2025-03-21_12-31-38", "timestamp": 1742560298, "time_this_iter_s": 15.79144549369812, "time_total_s": 2820.913827419281, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a2407880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2820.913827419281, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.2304347826087, "ram_util_percent": 13.726086956521739}}
{"custom_metrics": {"num_batches_mean": 5.076923076923077, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.954302787780762, "policy_loss": -0.015399390831589699, "vf_loss": 9.967774391174316, "vf_explained_var": -2.7996798053209204e-06, "kl": 0.009635773487389088, "entropy": 0.4409589469432831, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": 54972.32011413574, "episode_reward_min": 47426.93334007263, "episode_reward_mean": 52493.90419544624, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"agent_0": 47426.93334007263}, "policy_reward_max": {"agent_0": 54972.32011413574}, "policy_reward_mean": {"agent_0": 52493.90419544624}, "custom_metrics": {"num_batches_mean": 5.076923076923077, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54306.84679412842, 53581.61329650879, 51319.40682828426, 54553.766662597656, 53212.600189208984, 49323.97325229645, 49737.47316741943, 54972.32011413574, 47426.93334007263, 54540.600341796875, 54897.31368637085, 53225.86682701111, 51322.04004096985], "episode_lengths": [134, 135, 135, 135, 136, 135, 135, 134, 135, 135, 135, 135, 136], "policy_agent_0_reward": [54306.84679412842, 53581.61329650879, 51319.40682828426, 54553.766662597656, 53212.600189208984, 49323.97325229645, 49737.47316741943, 54972.32011413574, 47426.93334007263, 54540.600341796875, 54897.31368637085, 53225.86682701111, 51322.04004096985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.62090174421206, "mean_inference_ms": 6.58940192447048, "mean_action_processing_ms": 0.20005107529746005, "mean_env_wait_ms": 222.48399716332509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08563078366793118, "StateBufferConnector_ms": 0.0061658712533804085, "ViewRequirementAgentConnector_ms": 0.3232369056114784}}, "episode_reward_max": 54972.32011413574, "episode_reward_min": 47426.93334007263, "episode_reward_mean": 52493.90419544624, "episode_len_mean": 135.0, "episodes_this_iter": 13, "policy_reward_min": {"agent_0": 47426.93334007263}, "policy_reward_max": {"agent_0": 54972.32011413574}, "policy_reward_mean": {"agent_0": 52493.90419544624}, "hist_stats": {"episode_reward": [54306.84679412842, 53581.61329650879, 51319.40682828426, 54553.766662597656, 53212.600189208984, 49323.97325229645, 49737.47316741943, 54972.32011413574, 47426.93334007263, 54540.600341796875, 54897.31368637085, 53225.86682701111, 51322.04004096985], "episode_lengths": [134, 135, 135, 135, 136, 135, 135, 134, 135, 135, 135, 135, 136], "policy_agent_0_reward": [54306.84679412842, 53581.61329650879, 51319.40682828426, 54553.766662597656, 53212.600189208984, 49323.97325229645, 49737.47316741943, 54972.32011413574, 47426.93334007263, 54540.600341796875, 54897.31368637085, 53225.86682701111, 51322.04004096985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.62090174421206, "mean_inference_ms": 6.58940192447048, "mean_action_processing_ms": 0.20005107529746005, "mean_env_wait_ms": 222.48399716332509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08563078366793118, "StateBufferConnector_ms": 0.0061658712533804085, "ViewRequirementAgentConnector_ms": 0.3232369056114784}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.1690603994558, "num_env_steps_trained_throughput_per_sec": 291.1690603994558, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 15449.232, "sample_time_ms": 11344.698, "learn_time_ms": 3972.295, "learn_throughput": 1006.975, "synch_weights_time_ms": 131.422}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 5158, "training_iteration": 178, "trial_id": "185f8_00000", "date": "2025-03-21_12-31-52", "timestamp": 1742560312, "time_this_iter_s": 13.790783643722534, "time_total_s": 2834.7046110630035, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc28c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2834.7046110630035, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 98.79473684210525, "ram_util_percent": 13.742105263157896}}
{"custom_metrics": {"num_batches_mean": 5.719512195121951, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.782369613647461, "policy_loss": -0.013817306607961655, "vf_loss": 9.794445037841797, "vf_explained_var": 7.774680739203177e-07, "kl": 0.008708009496331215, "entropy": 0.4405670166015625, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": 57563.73356628418, "episode_reward_min": 41376.513335227966, "episode_reward_mean": 51977.60202501605, "episode_len_mean": 135.4268292682927, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 41376.513335227966}, "policy_reward_max": {"agent_0": 57563.73356628418}, "policy_reward_mean": {"agent_0": 51977.60202501605}, "custom_metrics": {"num_batches_mean": 5.719512195121951, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49434.940031051636, 50448.786825060844, 53379.200119018555, 52544.573333740234, 48721.4000043869, 52504.23351287842, 54504.486879348755, 53719.56687927246, 54594.58694458008, 54316.38698005676, 53522.81382751465, 55153.38667297363, 49666.00689506531, 54690.453552246094, 53002.77351474762, 53418.32015609741, 54723.553730010986, 57563.73356628418, 44173.50029373169, 52195.63991165161, 53454.08686828613, 53456.58013153076, 49939.94668865204, 55677.76670837402, 54351.560134887695, 49229.266860961914, 52665.01364517212, 53506.7602148056, 50861.86697268486, 50837.5199508667, 51866.813672065735, 47789.52000141144, 56250.76037025452, 49948.740089416504, 49075.34001302719, 46894.74706494808, 53621.52682685852, 54613.2335562706, 56044.58686828613, 53026.773374557495, 52749.813705444336, 54115.19348144531, 53625.76023864746, 52282.38001918793, 53345.98684692383, 56711.20022583008, 50964.64681625366, 49455.16682815552, 48593.459968566895, 53812.16009902954, 52106.413303375244, 54653.287017822266, 51465.2266368866, 50476.58016586304, 43442.01990222931, 52235.06676864624, 55178.11346435547, 54838.84002685547, 51550.29349517822, 47662.866775512695, 54949.55335140228, 53249.093658447266, 52212.67370223999, 55490.14041137695, 49994.78009223938, 41376.513335227966, 48904.4799118042, 54774.81348800659, 55311.21354675293, 54427.65348434448, 52660.72003555298, 49436.39358139038, 50473.780121803284, 50007.68676280975, 46214.913450837135, 51873.54009437561, 47490.76673030853, 48153.6068277359, 53439.100116729736, 54116.79377365112, 49962.63339805603, 52987.28674697876], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 138, 135, 136, 137, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 137, 136, 136, 135, 135, 136, 136, 134, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [49434.940031051636, 50448.786825060844, 53379.200119018555, 52544.573333740234, 48721.4000043869, 52504.23351287842, 54504.486879348755, 53719.56687927246, 54594.58694458008, 54316.38698005676, 53522.81382751465, 55153.38667297363, 49666.00689506531, 54690.453552246094, 53002.77351474762, 53418.32015609741, 54723.553730010986, 57563.73356628418, 44173.50029373169, 52195.63991165161, 53454.08686828613, 53456.58013153076, 49939.94668865204, 55677.76670837402, 54351.560134887695, 49229.266860961914, 52665.01364517212, 53506.7602148056, 50861.86697268486, 50837.5199508667, 51866.813672065735, 47789.52000141144, 56250.76037025452, 49948.740089416504, 49075.34001302719, 46894.74706494808, 53621.52682685852, 54613.2335562706, 56044.58686828613, 53026.773374557495, 52749.813705444336, 54115.19348144531, 53625.76023864746, 52282.38001918793, 53345.98684692383, 56711.20022583008, 50964.64681625366, 49455.16682815552, 48593.459968566895, 53812.16009902954, 52106.413303375244, 54653.287017822266, 51465.2266368866, 50476.58016586304, 43442.01990222931, 52235.06676864624, 55178.11346435547, 54838.84002685547, 51550.29349517822, 47662.866775512695, 54949.55335140228, 53249.093658447266, 52212.67370223999, 55490.14041137695, 49994.78009223938, 41376.513335227966, 48904.4799118042, 54774.81348800659, 55311.21354675293, 54427.65348434448, 52660.72003555298, 49436.39358139038, 50473.780121803284, 50007.68676280975, 46214.913450837135, 51873.54009437561, 47490.76673030853, 48153.6068277359, 53439.100116729736, 54116.79377365112, 49962.63339805603, 52987.28674697876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.641792757210936, "mean_inference_ms": 6.705090319626814, "mean_action_processing_ms": 0.2000925988946656, "mean_env_wait_ms": 225.20167781199189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162206882383765, "StateBufferConnector_ms": 0.006130846535287253, "ViewRequirementAgentConnector_ms": 0.22799997794918897}}, "episode_reward_max": 57563.73356628418, "episode_reward_min": 41376.513335227966, "episode_reward_mean": 51977.60202501605, "episode_len_mean": 135.4268292682927, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 41376.513335227966}, "policy_reward_max": {"agent_0": 57563.73356628418}, "policy_reward_mean": {"agent_0": 51977.60202501605}, "hist_stats": {"episode_reward": [49434.940031051636, 50448.786825060844, 53379.200119018555, 52544.573333740234, 48721.4000043869, 52504.23351287842, 54504.486879348755, 53719.56687927246, 54594.58694458008, 54316.38698005676, 53522.81382751465, 55153.38667297363, 49666.00689506531, 54690.453552246094, 53002.77351474762, 53418.32015609741, 54723.553730010986, 57563.73356628418, 44173.50029373169, 52195.63991165161, 53454.08686828613, 53456.58013153076, 49939.94668865204, 55677.76670837402, 54351.560134887695, 49229.266860961914, 52665.01364517212, 53506.7602148056, 50861.86697268486, 50837.5199508667, 51866.813672065735, 47789.52000141144, 56250.76037025452, 49948.740089416504, 49075.34001302719, 46894.74706494808, 53621.52682685852, 54613.2335562706, 56044.58686828613, 53026.773374557495, 52749.813705444336, 54115.19348144531, 53625.76023864746, 52282.38001918793, 53345.98684692383, 56711.20022583008, 50964.64681625366, 49455.16682815552, 48593.459968566895, 53812.16009902954, 52106.413303375244, 54653.287017822266, 51465.2266368866, 50476.58016586304, 43442.01990222931, 52235.06676864624, 55178.11346435547, 54838.84002685547, 51550.29349517822, 47662.866775512695, 54949.55335140228, 53249.093658447266, 52212.67370223999, 55490.14041137695, 49994.78009223938, 41376.513335227966, 48904.4799118042, 54774.81348800659, 55311.21354675293, 54427.65348434448, 52660.72003555298, 49436.39358139038, 50473.780121803284, 50007.68676280975, 46214.913450837135, 51873.54009437561, 47490.76673030853, 48153.6068277359, 53439.100116729736, 54116.79377365112, 49962.63339805603, 52987.28674697876], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 138, 135, 136, 137, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 136, 137, 136, 136, 135, 135, 136, 136, 134, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 136, 136, 136, 136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [49434.940031051636, 50448.786825060844, 53379.200119018555, 52544.573333740234, 48721.4000043869, 52504.23351287842, 54504.486879348755, 53719.56687927246, 54594.58694458008, 54316.38698005676, 53522.81382751465, 55153.38667297363, 49666.00689506531, 54690.453552246094, 53002.77351474762, 53418.32015609741, 54723.553730010986, 57563.73356628418, 44173.50029373169, 52195.63991165161, 53454.08686828613, 53456.58013153076, 49939.94668865204, 55677.76670837402, 54351.560134887695, 49229.266860961914, 52665.01364517212, 53506.7602148056, 50861.86697268486, 50837.5199508667, 51866.813672065735, 47789.52000141144, 56250.76037025452, 49948.740089416504, 49075.34001302719, 46894.74706494808, 53621.52682685852, 54613.2335562706, 56044.58686828613, 53026.773374557495, 52749.813705444336, 54115.19348144531, 53625.76023864746, 52282.38001918793, 53345.98684692383, 56711.20022583008, 50964.64681625366, 49455.16682815552, 48593.459968566895, 53812.16009902954, 52106.413303375244, 54653.287017822266, 51465.2266368866, 50476.58016586304, 43442.01990222931, 52235.06676864624, 55178.11346435547, 54838.84002685547, 51550.29349517822, 47662.866775512695, 54949.55335140228, 53249.093658447266, 52212.67370223999, 55490.14041137695, 49994.78009223938, 41376.513335227966, 48904.4799118042, 54774.81348800659, 55311.21354675293, 54427.65348434448, 52660.72003555298, 49436.39358139038, 50473.780121803284, 50007.68676280975, 46214.913450837135, 51873.54009437561, 47490.76673030853, 48153.6068277359, 53439.100116729736, 54116.79377365112, 49962.63339805603, 52987.28674697876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.641792757210936, "mean_inference_ms": 6.705090319626814, "mean_action_processing_ms": 0.2000925988946656, "mean_env_wait_ms": 225.20167781199189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162206882383765, "StateBufferConnector_ms": 0.006130846535287253, "ViewRequirementAgentConnector_ms": 0.22799997794918897}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.25912695012804, "num_env_steps_trained_throughput_per_sec": 197.25912695012804, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 15857.923, "sample_time_ms": 11709.637, "learn_time_ms": 4005.29, "learn_throughput": 998.679, "synch_weights_time_ms": 142.214}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 5240, "training_iteration": 179, "trial_id": "185f8_00000", "date": "2025-03-21_12-32-13", "timestamp": 1742560333, "time_this_iter_s": 20.343278646469116, "time_total_s": 2855.0478897094727, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc2a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2855.0478897094727, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 97.41034482758621, "ram_util_percent": 13.77241379310345}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987920761108398, "policy_loss": -0.013798256404697895, "vf_loss": 10.0, "vf_explained_var": -1.604979189551159e-07, "kl": 0.008599098771810532, "entropy": 0.41811174154281616, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 52987.28674697876, "episode_reward_min": 52987.28674697876, "episode_reward_mean": 52987.28674697876, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52987.28674697876}, "policy_reward_max": {"agent_0": 52987.28674697876}, "policy_reward_mean": {"agent_0": 52987.28674697876}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52987.28674697876], "episode_lengths": [135], "policy_agent_0_reward": [52987.28674697876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.5889063678834, "mean_inference_ms": 6.243671457853632, "mean_action_processing_ms": 0.20048613738880502, "mean_env_wait_ms": 228.44578554376838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03981590270996094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1797199249267578}}, "episode_reward_max": 52987.28674697876, "episode_reward_min": 52987.28674697876, "episode_reward_mean": 52987.28674697876, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52987.28674697876}, "policy_reward_max": {"agent_0": 52987.28674697876}, "policy_reward_mean": {"agent_0": 52987.28674697876}, "hist_stats": {"episode_reward": [52987.28674697876], "episode_lengths": [135], "policy_agent_0_reward": [52987.28674697876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.5889063678834, "mean_inference_ms": 6.243671457853632, "mean_action_processing_ms": 0.20048613738880502, "mean_env_wait_ms": 228.44578554376838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03981590270996094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1797199249267578}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.0656152642334, "num_env_steps_trained_throughput_per_sec": 270.0656152642334, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15336.671, "sample_time_ms": 11203.078, "learn_time_ms": 3986.064, "learn_throughput": 1003.496, "synch_weights_time_ms": 146.726}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 5240, "training_iteration": 180, "trial_id": "185f8_00000", "date": "2025-03-21_12-32-28", "timestamp": 1742560348, "time_this_iter_s": 14.901502847671509, "time_total_s": 2869.949392557144, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2869.949392557144, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.44285714285715, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.928069114685059, "policy_loss": -0.016548367217183113, "vf_loss": 9.942626953125, "vf_explained_var": -1.7434358596801758e-06, "kl": 0.009949641302227974, "entropy": 0.46238791942596436, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": 57594.93370819092, "episode_reward_min": 47577.266693115234, "episode_reward_mean": 53326.94827154408, "episode_len_mean": 135.1304347826087, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 47577.266693115234}, "policy_reward_max": {"agent_0": 57594.93370819092}, "policy_reward_mean": {"agent_0": 53326.94827154408}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54404.00684738159, 52518.36678695679, 53655.073471069336, 47577.266693115234, 53780.720249176025, 54107.25336456299, 57594.93370819092, 54369.933532714844, 52979.04699707031, 49964.34004211426, 51437.84010887146, 55416.75991439819, 51592.566844940186, 49148.11343193054, 52144.673583984375, 56049.88693237305, 54567.40019989014, 53552.34001159668, 54044.69343948364, 54988.07374572754, 54407.08687210083, 54428.026695251465, 53791.406772613525], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 134], "policy_agent_0_reward": [54404.00684738159, 52518.36678695679, 53655.073471069336, 47577.266693115234, 53780.720249176025, 54107.25336456299, 57594.93370819092, 54369.933532714844, 52979.04699707031, 49964.34004211426, 51437.84010887146, 55416.75991439819, 51592.566844940186, 49148.11343193054, 52144.673583984375, 56049.88693237305, 54567.40019989014, 53552.34001159668, 54044.69343948364, 54988.07374572754, 54407.08687210083, 54428.026695251465, 53791.406772613525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.19497186612431, "mean_inference_ms": 6.397790642357698, "mean_action_processing_ms": 0.20072121500172485, "mean_env_wait_ms": 210.4032857211816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04048762114151665, "StateBufferConnector_ms": 0.006091076394786005, "ViewRequirementAgentConnector_ms": 0.2434844556062118}}, "episode_reward_max": 57594.93370819092, "episode_reward_min": 47577.266693115234, "episode_reward_mean": 53326.94827154408, "episode_len_mean": 135.1304347826087, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 47577.266693115234}, "policy_reward_max": {"agent_0": 57594.93370819092}, "policy_reward_mean": {"agent_0": 53326.94827154408}, "hist_stats": {"episode_reward": [54404.00684738159, 52518.36678695679, 53655.073471069336, 47577.266693115234, 53780.720249176025, 54107.25336456299, 57594.93370819092, 54369.933532714844, 52979.04699707031, 49964.34004211426, 51437.84010887146, 55416.75991439819, 51592.566844940186, 49148.11343193054, 52144.673583984375, 56049.88693237305, 54567.40019989014, 53552.34001159668, 54044.69343948364, 54988.07374572754, 54407.08687210083, 54428.026695251465, 53791.406772613525], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 134], "policy_agent_0_reward": [54404.00684738159, 52518.36678695679, 53655.073471069336, 47577.266693115234, 53780.720249176025, 54107.25336456299, 57594.93370819092, 54369.933532714844, 52979.04699707031, 49964.34004211426, 51437.84010887146, 55416.75991439819, 51592.566844940186, 49148.11343193054, 52144.673583984375, 56049.88693237305, 54567.40019989014, 53552.34001159668, 54044.69343948364, 54988.07374572754, 54407.08687210083, 54428.026695251465, 53791.406772613525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.19497186612431, "mean_inference_ms": 6.397790642357698, "mean_action_processing_ms": 0.20072121500172485, "mean_env_wait_ms": 210.4032857211816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04048762114151665, "StateBufferConnector_ms": 0.006091076394786005, "ViewRequirementAgentConnector_ms": 0.2434844556062118}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.93077955283144, "num_env_steps_trained_throughput_per_sec": 276.93077955283144, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 15394.069, "sample_time_ms": 11261.732, "learn_time_ms": 3986.365, "learn_throughput": 1003.42, "synch_weights_time_ms": 145.148}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 5263, "training_iteration": 181, "trial_id": "185f8_00000", "date": "2025-03-21_12-32-42", "timestamp": 1742560362, "time_this_iter_s": 14.501778602600098, "time_total_s": 2884.4511711597443, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc2a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2884.4511711597443, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 99.13500000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.958386421203613, "policy_loss": -0.018427234143018723, "vf_loss": 9.974854469299316, "vf_explained_var": -3.743916821008497e-08, "kl": 0.0097922682762146, "entropy": 0.44274428486824036, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": 54935.27363586426, "episode_reward_min": 46121.45989608765, "episode_reward_mean": 52402.7734796736, "episode_len_mean": 135.44444444444446, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 46121.45989608765}, "policy_reward_max": {"agent_0": 54935.27363586426}, "policy_reward_mean": {"agent_0": 52402.7734796736}, "custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51217.38024139404, 52716.839946746826, 54504.1069984436, 53105.40028381348, 53740.35340118408, 54522.433349609375, 46121.45989608765, 54935.27363586426, 50761.71356391907], "episode_lengths": [136, 136, 135, 136, 134, 136, 136, 135, 135], "policy_agent_0_reward": [51217.38024139404, 52716.839946746826, 54504.1069984436, 53105.40028381348, 53740.35340118408, 54522.433349609375, 46121.45989608765, 54935.27363586426, 50761.71356391907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.02122749885474, "mean_inference_ms": 6.517109519785341, "mean_action_processing_ms": 0.20159172204306247, "mean_env_wait_ms": 210.30959171369747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04056559668646918, "StateBufferConnector_ms": 0.006169743008083767, "ViewRequirementAgentConnector_ms": 0.17667081620958117}}, "episode_reward_max": 54935.27363586426, "episode_reward_min": 46121.45989608765, "episode_reward_mean": 52402.7734796736, "episode_len_mean": 135.44444444444446, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 46121.45989608765}, "policy_reward_max": {"agent_0": 54935.27363586426}, "policy_reward_mean": {"agent_0": 52402.7734796736}, "hist_stats": {"episode_reward": [51217.38024139404, 52716.839946746826, 54504.1069984436, 53105.40028381348, 53740.35340118408, 54522.433349609375, 46121.45989608765, 54935.27363586426, 50761.71356391907], "episode_lengths": [136, 136, 135, 136, 134, 136, 136, 135, 135], "policy_agent_0_reward": [51217.38024139404, 52716.839946746826, 54504.1069984436, 53105.40028381348, 53740.35340118408, 54522.433349609375, 46121.45989608765, 54935.27363586426, 50761.71356391907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.02122749885474, "mean_inference_ms": 6.517109519785341, "mean_action_processing_ms": 0.20159172204306247, "mean_env_wait_ms": 210.30959171369747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04056559668646918, "StateBufferConnector_ms": 0.006169743008083767, "ViewRequirementAgentConnector_ms": 0.17667081620958117}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.636443456248, "num_env_steps_trained_throughput_per_sec": 267.636443456248, "timesteps_total": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 15475.435, "sample_time_ms": 11302.508, "learn_time_ms": 4014.801, "learn_throughput": 996.313, "synch_weights_time_ms": 157.325}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 5272, "training_iteration": 182, "trial_id": "185f8_00000", "date": "2025-03-21_12-32-57", "timestamp": 1742560377, "time_this_iter_s": 15.01660966873169, "time_total_s": 2899.467780828476, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20dc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2899.467780828476, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.26666666666667, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.065217391304348, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.757426261901855, "policy_loss": -0.014252513647079468, "vf_loss": 9.769776344299316, "vf_explained_var": 8.642673776648735e-08, "kl": 0.009508627466857433, "entropy": 0.4463501572608948, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 58439.02674102783, "episode_reward_min": 43355.760023117065, "episode_reward_mean": 52052.425070993275, "episode_len_mean": 135.4891304347826, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43355.760023117065}, "policy_reward_max": {"agent_0": 58439.02674102783}, "policy_reward_mean": {"agent_0": 52052.425070993275}, "custom_metrics": {"num_batches_mean": 5.065217391304348, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49766.74020862579, 51324.460136413574, 55026.420139312744, 48515.146592617035, 54064.42016983032, 54835.58701324463, 52399.913539886475, 54645.20025253296, 44871.47348403931, 53844.2332572937, 58439.02674102783, 54466.72677612305, 51484.8933057785, 52690.74011230469, 48355.7803440094, 53595.439975738525, 47547.85340690613, 51689.46658706665, 49631.42671871185, 51462.55337333679, 53890.65372085571, 54498.70014190674, 53728.30029296875, 54640.88677692413, 52567.06667327881, 52931.526763916016, 54755.753662109375, 55406.086773216724, 53879.54685211182, 48846.753520965576, 48018.04002380371, 55862.40689086914, 49918.280013144016, 50012.43344497681, 45293.73339176178, 53824.04680252075, 50883.527212142944, 49341.1403465271, 56099.086921691895, 48615.09350037575, 53459.24692153931, 53301.80683517456, 49115.24688076973, 47476.013401031494, 47856.19352579117, 49155.53337287903, 56850.83351135254, 54081.04672241211, 50551.41330862045, 56011.233322143555, 43355.760023117065, 46870.98004579544, 54018.22667312622, 55873.50709152222, 54778.92018890381, 43392.56679344177, 50829.627002716064, 55256.92018699646, 55056.77346801758, 47560.026582717896, 49183.02698326111, 49609.300110816956, 52134.566734313965, 53128.44016647339, 53386.41384887695, 46361.44675445557, 48300.93333053589, 55483.50691986084, 52151.06008338928, 54249.58013153076, 54843.50022506714, 53121.4599647522, 56153.32028675079, 54888.0602645874, 51712.61355304718, 50978.14687156677, 52562.58030450344, 54054.53988838196, 51472.04664993286, 55406.7467918396, 53235.27340507507, 50546.906688690186, 52762.513498306274, 51098.62681102753, 57346.53353881836, 54429.41343688965, 51584.213331222534, 52746.046894073486, 53596.42674446106, 51631.293511390686, 53646.513553619385, 50495.61353492737], "episode_lengths": [135, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 137, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 137, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 135], "policy_agent_0_reward": [49766.74020862579, 51324.460136413574, 55026.420139312744, 48515.146592617035, 54064.42016983032, 54835.58701324463, 52399.913539886475, 54645.20025253296, 44871.47348403931, 53844.2332572937, 58439.02674102783, 54466.72677612305, 51484.8933057785, 52690.74011230469, 48355.7803440094, 53595.439975738525, 47547.85340690613, 51689.46658706665, 49631.42671871185, 51462.55337333679, 53890.65372085571, 54498.70014190674, 53728.30029296875, 54640.88677692413, 52567.06667327881, 52931.526763916016, 54755.753662109375, 55406.086773216724, 53879.54685211182, 48846.753520965576, 48018.04002380371, 55862.40689086914, 49918.280013144016, 50012.43344497681, 45293.73339176178, 53824.04680252075, 50883.527212142944, 49341.1403465271, 56099.086921691895, 48615.09350037575, 53459.24692153931, 53301.80683517456, 49115.24688076973, 47476.013401031494, 47856.19352579117, 49155.53337287903, 56850.83351135254, 54081.04672241211, 50551.41330862045, 56011.233322143555, 43355.760023117065, 46870.98004579544, 54018.22667312622, 55873.50709152222, 54778.92018890381, 43392.56679344177, 50829.627002716064, 55256.92018699646, 55056.77346801758, 47560.026582717896, 49183.02698326111, 49609.300110816956, 52134.566734313965, 53128.44016647339, 53386.41384887695, 46361.44675445557, 48300.93333053589, 55483.50691986084, 52151.06008338928, 54249.58013153076, 54843.50022506714, 53121.4599647522, 56153.32028675079, 54888.0602645874, 51712.61355304718, 50978.14687156677, 52562.58030450344, 54054.53988838196, 51472.04664993286, 55406.7467918396, 53235.27340507507, 50546.906688690186, 52762.513498306274, 51098.62681102753, 57346.53353881836, 54429.41343688965, 51584.213331222534, 52746.046894073486, 53596.42674446106, 51631.293511390686, 53646.513553619385, 50495.61353492737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.93694106175608, "mean_inference_ms": 6.696314562723713, "mean_action_processing_ms": 0.19996409150331512, "mean_env_wait_ms": 225.3529722350718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0414003496584685, "StateBufferConnector_ms": 0.006257451098898183, "ViewRequirementAgentConnector_ms": 0.31832974890004034}}, "episode_reward_max": 58439.02674102783, "episode_reward_min": 43355.760023117065, "episode_reward_mean": 52052.425070993275, "episode_len_mean": 135.4891304347826, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43355.760023117065}, "policy_reward_max": {"agent_0": 58439.02674102783}, "policy_reward_mean": {"agent_0": 52052.425070993275}, "hist_stats": {"episode_reward": [49766.74020862579, 51324.460136413574, 55026.420139312744, 48515.146592617035, 54064.42016983032, 54835.58701324463, 52399.913539886475, 54645.20025253296, 44871.47348403931, 53844.2332572937, 58439.02674102783, 54466.72677612305, 51484.8933057785, 52690.74011230469, 48355.7803440094, 53595.439975738525, 47547.85340690613, 51689.46658706665, 49631.42671871185, 51462.55337333679, 53890.65372085571, 54498.70014190674, 53728.30029296875, 54640.88677692413, 52567.06667327881, 52931.526763916016, 54755.753662109375, 55406.086773216724, 53879.54685211182, 48846.753520965576, 48018.04002380371, 55862.40689086914, 49918.280013144016, 50012.43344497681, 45293.73339176178, 53824.04680252075, 50883.527212142944, 49341.1403465271, 56099.086921691895, 48615.09350037575, 53459.24692153931, 53301.80683517456, 49115.24688076973, 47476.013401031494, 47856.19352579117, 49155.53337287903, 56850.83351135254, 54081.04672241211, 50551.41330862045, 56011.233322143555, 43355.760023117065, 46870.98004579544, 54018.22667312622, 55873.50709152222, 54778.92018890381, 43392.56679344177, 50829.627002716064, 55256.92018699646, 55056.77346801758, 47560.026582717896, 49183.02698326111, 49609.300110816956, 52134.566734313965, 53128.44016647339, 53386.41384887695, 46361.44675445557, 48300.93333053589, 55483.50691986084, 52151.06008338928, 54249.58013153076, 54843.50022506714, 53121.4599647522, 56153.32028675079, 54888.0602645874, 51712.61355304718, 50978.14687156677, 52562.58030450344, 54054.53988838196, 51472.04664993286, 55406.7467918396, 53235.27340507507, 50546.906688690186, 52762.513498306274, 51098.62681102753, 57346.53353881836, 54429.41343688965, 51584.213331222534, 52746.046894073486, 53596.42674446106, 51631.293511390686, 53646.513553619385, 50495.61353492737], "episode_lengths": [135, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 136, 136, 136, 136, 135, 136, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 137, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 137, 135, 134, 136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 135], "policy_agent_0_reward": [49766.74020862579, 51324.460136413574, 55026.420139312744, 48515.146592617035, 54064.42016983032, 54835.58701324463, 52399.913539886475, 54645.20025253296, 44871.47348403931, 53844.2332572937, 58439.02674102783, 54466.72677612305, 51484.8933057785, 52690.74011230469, 48355.7803440094, 53595.439975738525, 47547.85340690613, 51689.46658706665, 49631.42671871185, 51462.55337333679, 53890.65372085571, 54498.70014190674, 53728.30029296875, 54640.88677692413, 52567.06667327881, 52931.526763916016, 54755.753662109375, 55406.086773216724, 53879.54685211182, 48846.753520965576, 48018.04002380371, 55862.40689086914, 49918.280013144016, 50012.43344497681, 45293.73339176178, 53824.04680252075, 50883.527212142944, 49341.1403465271, 56099.086921691895, 48615.09350037575, 53459.24692153931, 53301.80683517456, 49115.24688076973, 47476.013401031494, 47856.19352579117, 49155.53337287903, 56850.83351135254, 54081.04672241211, 50551.41330862045, 56011.233322143555, 43355.760023117065, 46870.98004579544, 54018.22667312622, 55873.50709152222, 54778.92018890381, 43392.56679344177, 50829.627002716064, 55256.92018699646, 55056.77346801758, 47560.026582717896, 49183.02698326111, 49609.300110816956, 52134.566734313965, 53128.44016647339, 53386.41384887695, 46361.44675445557, 48300.93333053589, 55483.50691986084, 52151.06008338928, 54249.58013153076, 54843.50022506714, 53121.4599647522, 56153.32028675079, 54888.0602645874, 51712.61355304718, 50978.14687156677, 52562.58030450344, 54054.53988838196, 51472.04664993286, 55406.7467918396, 53235.27340507507, 50546.906688690186, 52762.513498306274, 51098.62681102753, 57346.53353881836, 54429.41343688965, 51584.213331222534, 52746.046894073486, 53596.42674446106, 51631.293511390686, 53646.513553619385, 50495.61353492737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.93694106175608, "mean_inference_ms": 6.696314562723713, "mean_action_processing_ms": 0.19996409150331512, "mean_env_wait_ms": 225.3529722350718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0414003496584685, "StateBufferConnector_ms": 0.006257451098898183, "ViewRequirementAgentConnector_ms": 0.31832974890004034}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.004470658108, "num_env_steps_trained_throughput_per_sec": 210.004470658108, "timesteps_total": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 15894.804, "sample_time_ms": 11717.672, "learn_time_ms": 4006.944, "learn_throughput": 998.267, "synch_weights_time_ms": 169.373}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 5364, "training_iteration": 183, "trial_id": "185f8_00000", "date": "2025-03-21_12-33-17", "timestamp": 1742560397, "time_this_iter_s": 19.111284494400024, "time_total_s": 2918.579065322876, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f53f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2918.579065322876, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 95.84814814814814, "ram_util_percent": 13.781481481481482}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98565673828125, "policy_loss": -0.01634446159005165, "vf_loss": 10.0, "vf_explained_var": 5.065774075774243e-07, "kl": 0.010006379336118698, "entropy": 0.43849003314971924, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "sampler_results": {"episode_reward_max": 50495.61353492737, "episode_reward_min": 50495.61353492737, "episode_reward_mean": 50495.61353492737, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50495.61353492737}, "policy_reward_max": {"agent_0": 50495.61353492737}, "policy_reward_mean": {"agent_0": 50495.61353492737}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50495.61353492737], "episode_lengths": [135], "policy_agent_0_reward": [50495.61353492737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.327189912318936, "mean_inference_ms": 6.235238328125771, "mean_action_processing_ms": 0.2001876287214459, "mean_env_wait_ms": 228.36523449256066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04286766052246094, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.1562356948852539}}, "episode_reward_max": 50495.61353492737, "episode_reward_min": 50495.61353492737, "episode_reward_mean": 50495.61353492737, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50495.61353492737}, "policy_reward_max": {"agent_0": 50495.61353492737}, "policy_reward_mean": {"agent_0": 50495.61353492737}, "hist_stats": {"episode_reward": [50495.61353492737], "episode_lengths": [135], "policy_agent_0_reward": [50495.61353492737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.327189912318936, "mean_inference_ms": 6.235238328125771, "mean_action_processing_ms": 0.2001876287214459, "mean_env_wait_ms": 228.36523449256066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04286766052246094, "StateBufferConnector_ms": 0.0055789947509765625, "ViewRequirementAgentConnector_ms": 0.1562356948852539}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.1509258244841, "num_env_steps_trained_throughput_per_sec": 277.1509258244841, "timesteps_total": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 15680.386, "sample_time_ms": 11420.93, "learn_time_ms": 4073.231, "learn_throughput": 982.022, "synch_weights_time_ms": 185.418}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "episodes_total": 5364, "training_iteration": 184, "trial_id": "185f8_00000", "date": "2025-03-21_12-33-31", "timestamp": 1742560411, "time_this_iter_s": 14.487393856048584, "time_total_s": 2933.0664591789246, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefff40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2933.0664591789246, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.56500000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.96730899810791, "policy_loss": -0.014936801046133041, "vf_loss": 9.980224609375, "vf_explained_var": 1.7822409290602081e-06, "kl": 0.010103483684360981, "entropy": 0.45606204867362976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "sampler_results": {"episode_reward_max": 54864.20680618286, "episode_reward_min": 44766.52035522461, "episode_reward_mean": 50954.66768217087, "episode_len_mean": 135.625, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 44766.52035522461}, "policy_reward_max": {"agent_0": 54864.20680618286}, "policy_reward_mean": {"agent_0": 50954.66768217087}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54864.20680618286, 44766.52035522461, 53153.74667644501, 46144.0068693161, 54426.606925964355, 50727.26016998291, 48717.0668964386, 54837.9267578125], "episode_lengths": [135, 136, 135, 137, 135, 136, 136, 135], "policy_agent_0_reward": [54864.20680618286, 44766.52035522461, 53153.74667644501, 46144.0068693161, 54426.606925964355, 50727.26016998291, 48717.0668964386, 54837.9267578125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.71785223917456, "mean_inference_ms": 6.377117026840082, "mean_action_processing_ms": 0.20006389802219904, "mean_env_wait_ms": 209.29341525317722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0392228364944458, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.2223372459411621}}, "episode_reward_max": 54864.20680618286, "episode_reward_min": 44766.52035522461, "episode_reward_mean": 50954.66768217087, "episode_len_mean": 135.625, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 44766.52035522461}, "policy_reward_max": {"agent_0": 54864.20680618286}, "policy_reward_mean": {"agent_0": 50954.66768217087}, "hist_stats": {"episode_reward": [54864.20680618286, 44766.52035522461, 53153.74667644501, 46144.0068693161, 54426.606925964355, 50727.26016998291, 48717.0668964386, 54837.9267578125], "episode_lengths": [135, 136, 135, 137, 135, 136, 136, 135], "policy_agent_0_reward": [54864.20680618286, 44766.52035522461, 53153.74667644501, 46144.0068693161, 54426.606925964355, 50727.26016998291, 48717.0668964386, 54837.9267578125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.71785223917456, "mean_inference_ms": 6.377117026840082, "mean_action_processing_ms": 0.20006389802219904, "mean_env_wait_ms": 209.29341525317722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0392228364944458, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.2223372459411621}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9453855348759, "num_env_steps_trained_throughput_per_sec": 292.9453855348759, "timesteps_total": 740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 15455.797, "sample_time_ms": 11214.367, "learn_time_ms": 4050.443, "learn_throughput": 987.546, "synch_weights_time_ms": 190.17}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "done": false, "episodes_total": 5372, "training_iteration": 185, "trial_id": "185f8_00000", "date": "2025-03-21_12-33-45", "timestamp": 1742560425, "time_this_iter_s": 13.705907821655273, "time_total_s": 2946.77236700058, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2946.77236700058, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 98.99473684210528, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.922099113464355, "policy_loss": -0.018051695078611374, "vf_loss": 9.937990188598633, "vf_explained_var": 5.582347739618854e-07, "kl": 0.010798431001603603, "entropy": 0.4358941316604614, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 57508.70718193054, "episode_reward_min": 44637.2533826828, "episode_reward_mean": 51704.82488485674, "episode_len_mean": 135.54166666666666, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 44637.2533826828}, "policy_reward_max": {"agent_0": 57508.70718193054}, "policy_reward_mean": {"agent_0": 51704.82488485674}, "custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52468.90017700195, 49918.78006350994, 55229.70032501221, 48528.00673675537, 45161.32019948959, 52041.14688682556, 57508.70718193054, 50437.36008262634, 51733.726749420166, 50668.006789922714, 53644.42674064636, 55135.887031555176, 52863.81369018555, 54553.593563079834, 53539.79351043701, 50449.933364868164, 52693.6468706131, 54562.020179748535, 44637.2533826828, 53429.80672454834, 49161.640005111694, 50574.28683567047, 52470.20666503906, 49503.83347988129], "episode_lengths": [136, 137, 136, 135, 137, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [52468.90017700195, 49918.78006350994, 55229.70032501221, 48528.00673675537, 45161.32019948959, 52041.14688682556, 57508.70718193054, 50437.36008262634, 51733.726749420166, 50668.006789922714, 53644.42674064636, 55135.887031555176, 52863.81369018555, 54553.593563079834, 53539.79351043701, 50449.933364868164, 52693.6468706131, 54562.020179748535, 44637.2533826828, 53429.80672454834, 49161.640005111694, 50574.28683567047, 52470.20666503906, 49503.83347988129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.86198450964036, "mean_inference_ms": 6.449419649686708, "mean_action_processing_ms": 0.201095862271324, "mean_env_wait_ms": 210.506828341518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05796253681182861, "StateBufferConnector_ms": 0.040299693743387856, "ViewRequirementAgentConnector_ms": 0.4254827896753947}}, "episode_reward_max": 57508.70718193054, "episode_reward_min": 44637.2533826828, "episode_reward_mean": 51704.82488485674, "episode_len_mean": 135.54166666666666, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 44637.2533826828}, "policy_reward_max": {"agent_0": 57508.70718193054}, "policy_reward_mean": {"agent_0": 51704.82488485674}, "hist_stats": {"episode_reward": [52468.90017700195, 49918.78006350994, 55229.70032501221, 48528.00673675537, 45161.32019948959, 52041.14688682556, 57508.70718193054, 50437.36008262634, 51733.726749420166, 50668.006789922714, 53644.42674064636, 55135.887031555176, 52863.81369018555, 54553.593563079834, 53539.79351043701, 50449.933364868164, 52693.6468706131, 54562.020179748535, 44637.2533826828, 53429.80672454834, 49161.640005111694, 50574.28683567047, 52470.20666503906, 49503.83347988129], "episode_lengths": [136, 137, 136, 135, 137, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [52468.90017700195, 49918.78006350994, 55229.70032501221, 48528.00673675537, 45161.32019948959, 52041.14688682556, 57508.70718193054, 50437.36008262634, 51733.726749420166, 50668.006789922714, 53644.42674064636, 55135.887031555176, 52863.81369018555, 54553.593563079834, 53539.79351043701, 50449.933364868164, 52693.6468706131, 54562.020179748535, 44637.2533826828, 53429.80672454834, 49161.640005111694, 50574.28683567047, 52470.20666503906, 49503.83347988129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.86198450964036, "mean_inference_ms": 6.449419649686708, "mean_action_processing_ms": 0.201095862271324, "mean_env_wait_ms": 210.506828341518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05796253681182861, "StateBufferConnector_ms": 0.040299693743387856, "ViewRequirementAgentConnector_ms": 0.4254827896753947}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.14017461980876, "num_env_steps_trained_throughput_per_sec": 220.14017461980876, "timesteps_total": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 15926.628, "sample_time_ms": 11656.719, "learn_time_ms": 4079.617, "learn_throughput": 980.484, "synch_weights_time_ms": 189.458}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 5396, "training_iteration": 186, "trial_id": "185f8_00000", "date": "2025-03-21_12-34-03", "timestamp": 1742560443, "time_this_iter_s": 18.228208541870117, "time_total_s": 2965.00057554245, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20dc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2965.00057554245, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.184, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.758645057678223, "policy_loss": -0.01272473856806755, "vf_loss": 9.76953125, "vf_explained_var": 5.904585265170681e-08, "kl": 0.009187131188809872, "entropy": 0.4518539011478424, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "sampler_results": {"episode_reward_max": 57407.87348937988, "episode_reward_min": 44403.286699295044, "episode_reward_mean": 52513.42767954132, "episode_len_mean": 135.42391304347825, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44403.286699295044}, "policy_reward_max": {"agent_0": 57407.87348937988}, "policy_reward_mean": {"agent_0": 52513.42767954132}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49231.660210609436, 57242.926986694336, 53627.76687049866, 51243.78684043884, 47334.49341011047, 53072.073472976685, 51088.45338821411, 49151.74678182602, 50387.45331954956, 49550.85343170166, 54478.60021972656, 44403.286699295044, 54461.466747283936, 56044.506801605225, 48179.0800075531, 47192.926644682884, 51612.1466807127, 55225.87354660034, 52378.5267162323, 52062.713463783264, 52852.72000694275, 52515.7135515213, 53509.38032531738, 52169.36045503616, 50443.62691307068, 50766.76010513306, 51441.03342437744, 52706.02701497078, 57337.186950683594, 55769.74034118652, 48828.26703643799, 51219.58000946045, 53922.44674682617, 54542.980195999146, 56340.72673416138, 52574.5534286499, 56974.98683166504, 47576.220083236694, 53695.500076293945, 49896.780316352844, 54246.086769104004, 52886.42007446289, 54441.42674636841, 56788.826904296875, 52115.7733707428, 52040.906757354736, 53421.83991622925, 46862.579939842224, 52736.20018577576, 52254.92009925842, 54134.480295181274, 55257.68020629883, 51605.18045425415, 52278.53342819214, 49187.25990104675, 53531.34034347534, 45450.806746959686, 56116.359912872314, 50733.74682426453, 54184.74024581909, 55695.50006866455, 47322.28010845184, 49950.77994918823, 51824.06684875488, 52034.220200538635, 57407.87348937988, 55859.02013587952, 46993.726742982864, 56227.50704574585, 52318.473304748535, 48731.446811676025, 52981.23363876343, 50336.6932926178, 55395.806968688965, 51347.90009307861, 54298.99351119995, 52859.546770095825, 54408.973625183105, 54805.40019226074, 51737.87336921692, 53369.68688964844, 54969.49345397949, 54257.18672943115, 52409.93340873718, 51435.66693019867, 53224.07334136963, 55982.66716003418, 53684.00673675537, 56189.14694976807, 54175.23351383209, 54367.600021362305, 51304.29330635071], "episode_lengths": [136, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 134, 135, 136, 136, 135, 137, 135, 136, 135, 137, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 135, 136, 135, 136, 134, 135, 136, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [49231.660210609436, 57242.926986694336, 53627.76687049866, 51243.78684043884, 47334.49341011047, 53072.073472976685, 51088.45338821411, 49151.74678182602, 50387.45331954956, 49550.85343170166, 54478.60021972656, 44403.286699295044, 54461.466747283936, 56044.506801605225, 48179.0800075531, 47192.926644682884, 51612.1466807127, 55225.87354660034, 52378.5267162323, 52062.713463783264, 52852.72000694275, 52515.7135515213, 53509.38032531738, 52169.36045503616, 50443.62691307068, 50766.76010513306, 51441.03342437744, 52706.02701497078, 57337.186950683594, 55769.74034118652, 48828.26703643799, 51219.58000946045, 53922.44674682617, 54542.980195999146, 56340.72673416138, 52574.5534286499, 56974.98683166504, 47576.220083236694, 53695.500076293945, 49896.780316352844, 54246.086769104004, 52886.42007446289, 54441.42674636841, 56788.826904296875, 52115.7733707428, 52040.906757354736, 53421.83991622925, 46862.579939842224, 52736.20018577576, 52254.92009925842, 54134.480295181274, 55257.68020629883, 51605.18045425415, 52278.53342819214, 49187.25990104675, 53531.34034347534, 45450.806746959686, 56116.359912872314, 50733.74682426453, 54184.74024581909, 55695.50006866455, 47322.28010845184, 49950.77994918823, 51824.06684875488, 52034.220200538635, 57407.87348937988, 55859.02013587952, 46993.726742982864, 56227.50704574585, 52318.473304748535, 48731.446811676025, 52981.23363876343, 50336.6932926178, 55395.806968688965, 51347.90009307861, 54298.99351119995, 52859.546770095825, 54408.973625183105, 54805.40019226074, 51737.87336921692, 53369.68688964844, 54969.49345397949, 54257.18672943115, 52409.93340873718, 51435.66693019867, 53224.07334136963, 55982.66716003418, 53684.00673675537, 56189.14694976807, 54175.23351383209, 54367.600021362305, 51304.29330635071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.997179378932685, "mean_inference_ms": 6.698734365561426, "mean_action_processing_ms": 0.1999297791875533, "mean_env_wait_ms": 225.40590933087933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048045749249665634, "StateBufferConnector_ms": 0.01180379287056301, "ViewRequirementAgentConnector_ms": 0.18849346948706586}}, "episode_reward_max": 57407.87348937988, "episode_reward_min": 44403.286699295044, "episode_reward_mean": 52513.42767954132, "episode_len_mean": 135.42391304347825, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 44403.286699295044}, "policy_reward_max": {"agent_0": 57407.87348937988}, "policy_reward_mean": {"agent_0": 52513.42767954132}, "hist_stats": {"episode_reward": [49231.660210609436, 57242.926986694336, 53627.76687049866, 51243.78684043884, 47334.49341011047, 53072.073472976685, 51088.45338821411, 49151.74678182602, 50387.45331954956, 49550.85343170166, 54478.60021972656, 44403.286699295044, 54461.466747283936, 56044.506801605225, 48179.0800075531, 47192.926644682884, 51612.1466807127, 55225.87354660034, 52378.5267162323, 52062.713463783264, 52852.72000694275, 52515.7135515213, 53509.38032531738, 52169.36045503616, 50443.62691307068, 50766.76010513306, 51441.03342437744, 52706.02701497078, 57337.186950683594, 55769.74034118652, 48828.26703643799, 51219.58000946045, 53922.44674682617, 54542.980195999146, 56340.72673416138, 52574.5534286499, 56974.98683166504, 47576.220083236694, 53695.500076293945, 49896.780316352844, 54246.086769104004, 52886.42007446289, 54441.42674636841, 56788.826904296875, 52115.7733707428, 52040.906757354736, 53421.83991622925, 46862.579939842224, 52736.20018577576, 52254.92009925842, 54134.480295181274, 55257.68020629883, 51605.18045425415, 52278.53342819214, 49187.25990104675, 53531.34034347534, 45450.806746959686, 56116.359912872314, 50733.74682426453, 54184.74024581909, 55695.50006866455, 47322.28010845184, 49950.77994918823, 51824.06684875488, 52034.220200538635, 57407.87348937988, 55859.02013587952, 46993.726742982864, 56227.50704574585, 52318.473304748535, 48731.446811676025, 52981.23363876343, 50336.6932926178, 55395.806968688965, 51347.90009307861, 54298.99351119995, 52859.546770095825, 54408.973625183105, 54805.40019226074, 51737.87336921692, 53369.68688964844, 54969.49345397949, 54257.18672943115, 52409.93340873718, 51435.66693019867, 53224.07334136963, 55982.66716003418, 53684.00673675537, 56189.14694976807, 54175.23351383209, 54367.600021362305, 51304.29330635071], "episode_lengths": [136, 135, 136, 136, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 134, 135, 136, 136, 135, 137, 135, 136, 135, 137, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 135, 135, 136, 135, 136, 134, 135, 136, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [49231.660210609436, 57242.926986694336, 53627.76687049866, 51243.78684043884, 47334.49341011047, 53072.073472976685, 51088.45338821411, 49151.74678182602, 50387.45331954956, 49550.85343170166, 54478.60021972656, 44403.286699295044, 54461.466747283936, 56044.506801605225, 48179.0800075531, 47192.926644682884, 51612.1466807127, 55225.87354660034, 52378.5267162323, 52062.713463783264, 52852.72000694275, 52515.7135515213, 53509.38032531738, 52169.36045503616, 50443.62691307068, 50766.76010513306, 51441.03342437744, 52706.02701497078, 57337.186950683594, 55769.74034118652, 48828.26703643799, 51219.58000946045, 53922.44674682617, 54542.980195999146, 56340.72673416138, 52574.5534286499, 56974.98683166504, 47576.220083236694, 53695.500076293945, 49896.780316352844, 54246.086769104004, 52886.42007446289, 54441.42674636841, 56788.826904296875, 52115.7733707428, 52040.906757354736, 53421.83991622925, 46862.579939842224, 52736.20018577576, 52254.92009925842, 54134.480295181274, 55257.68020629883, 51605.18045425415, 52278.53342819214, 49187.25990104675, 53531.34034347534, 45450.806746959686, 56116.359912872314, 50733.74682426453, 54184.74024581909, 55695.50006866455, 47322.28010845184, 49950.77994918823, 51824.06684875488, 52034.220200538635, 57407.87348937988, 55859.02013587952, 46993.726742982864, 56227.50704574585, 52318.473304748535, 48731.446811676025, 52981.23363876343, 50336.6932926178, 55395.806968688965, 51347.90009307861, 54298.99351119995, 52859.546770095825, 54408.973625183105, 54805.40019226074, 51737.87336921692, 53369.68688964844, 54969.49345397949, 54257.18672943115, 52409.93340873718, 51435.66693019867, 53224.07334136963, 55982.66716003418, 53684.00673675537, 56189.14694976807, 54175.23351383209, 54367.600021362305, 51304.29330635071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.997179378932685, "mean_inference_ms": 6.698734365561426, "mean_action_processing_ms": 0.1999297791875533, "mean_env_wait_ms": 225.40590933087933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048045749249665634, "StateBufferConnector_ms": 0.01180379287056301, "ViewRequirementAgentConnector_ms": 0.18849346948706586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.19050196006958, "num_env_steps_trained_throughput_per_sec": 194.19050196006958, "timesteps_total": 748000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 16411.87, "sample_time_ms": 12073.72, "learn_time_ms": 4153.797, "learn_throughput": 962.974, "synch_weights_time_ms": 183.501}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "done": false, "episodes_total": 5488, "training_iteration": 187, "trial_id": "185f8_00000", "date": "2025-03-21_12-34-24", "timestamp": 1742560464, "time_this_iter_s": 20.657864809036255, "time_total_s": 2985.658440351486, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc2a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2985.658440351486, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 94.78571428571426, "ram_util_percent": 13.78214285714286}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983431816101074, "policy_loss": -0.018892429769039154, "vf_loss": 10.0, "vf_explained_var": -1.0915100290276314e-07, "kl": 0.011622092686593533, "entropy": 0.4570554196834564, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "sampler_results": {"episode_reward_max": 51304.29330635071, "episode_reward_min": 51304.29330635071, "episode_reward_mean": 51304.29330635071, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51304.29330635071}, "policy_reward_max": {"agent_0": 51304.29330635071}, "policy_reward_mean": {"agent_0": 51304.29330635071}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51304.29330635071], "episode_lengths": [136], "policy_agent_0_reward": [51304.29330635071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.425985210421885, "mean_inference_ms": 6.246603063075066, "mean_action_processing_ms": 0.20004808653765352, "mean_env_wait_ms": 228.15472336739623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0385284423828125, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1636981964111328}}, "episode_reward_max": 51304.29330635071, "episode_reward_min": 51304.29330635071, "episode_reward_mean": 51304.29330635071, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51304.29330635071}, "policy_reward_max": {"agent_0": 51304.29330635071}, "policy_reward_mean": {"agent_0": 51304.29330635071}, "hist_stats": {"episode_reward": [51304.29330635071], "episode_lengths": [136], "policy_agent_0_reward": [51304.29330635071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.425985210421885, "mean_inference_ms": 6.246603063075066, "mean_action_processing_ms": 0.20004808653765352, "mean_env_wait_ms": 228.15472336739623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0385284423828125, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1636981964111328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1910632390016, "num_env_steps_trained_throughput_per_sec": 302.1910632390016, "timesteps_total": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 16361.764, "sample_time_ms": 12030.934, "learn_time_ms": 4147.197, "learn_throughput": 964.507, "synch_weights_time_ms": 182.773}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "episodes_total": 5488, "training_iteration": 188, "trial_id": "185f8_00000", "date": "2025-03-21_12-34-37", "timestamp": 1742560477, "time_this_iter_s": 13.291008949279785, "time_total_s": 2998.949449300766, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20dc1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2998.949449300766, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.60000000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982583045959473, "policy_loss": -0.014758828096091747, "vf_loss": 9.9951171875, "vf_explained_var": -1.7036994393038185e-07, "kl": 0.011116555891931057, "entropy": 0.4781602919101715, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 49887.93347167969, "episode_reward_min": 48232.093605041504, "episode_reward_mean": 49060.013538360596, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 48232.093605041504}, "policy_reward_max": {"agent_0": 49887.93347167969}, "policy_reward_mean": {"agent_0": 49060.013538360596}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49887.93347167969, 48232.093605041504], "episode_lengths": [136, 136], "policy_agent_0_reward": [49887.93347167969, 48232.093605041504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.842036116081157, "mean_inference_ms": 6.190892097544081, "mean_action_processing_ms": 0.19723702486068173, "mean_env_wait_ms": 212.22709971156092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04601478576660156, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.25964975357055664}}, "episode_reward_max": 49887.93347167969, "episode_reward_min": 48232.093605041504, "episode_reward_mean": 49060.013538360596, "episode_len_mean": 136.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 48232.093605041504}, "policy_reward_max": {"agent_0": 49887.93347167969}, "policy_reward_mean": {"agent_0": 49060.013538360596}, "hist_stats": {"episode_reward": [49887.93347167969, 48232.093605041504], "episode_lengths": [136, 136], "policy_agent_0_reward": [49887.93347167969, 48232.093605041504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.842036116081157, "mean_inference_ms": 6.190892097544081, "mean_action_processing_ms": 0.19723702486068173, "mean_env_wait_ms": 212.22709971156092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04601478576660156, "StateBufferConnector_ms": 0.006020069122314453, "ViewRequirementAgentConnector_ms": 0.25964975357055664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.69867192945145, "num_env_steps_trained_throughput_per_sec": 290.69867192945145, "timesteps_total": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 15709.965, "sample_time_ms": 11397.96, "learn_time_ms": 4130.768, "learn_throughput": 968.343, "synch_weights_time_ms": 180.367}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 5490, "training_iteration": 189, "trial_id": "185f8_00000", "date": "2025-03-21_12-34-51", "timestamp": 1742560491, "time_this_iter_s": 13.830467700958252, "time_total_s": 3012.7799170017242, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a20f5fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3012.7799170017242, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.35263157894735, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.133333333333334, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910358428955078, "policy_loss": -0.01698099821805954, "vf_loss": 9.925537109375, "vf_explained_var": -3.5930423791796784e-07, "kl": 0.009008576162159443, "entropy": 0.4850611090660095, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "sampler_results": {"episode_reward_max": 57734.68049621582, "episode_reward_min": 44289.71347618103, "episode_reward_mean": 53139.03591675758, "episode_len_mean": 135.46666666666667, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 44289.71347618103}, "policy_reward_max": {"agent_0": 57734.68049621582}, "policy_reward_mean": {"agent_0": 53139.03591675758}, "custom_metrics": {"num_batches_mean": 5.133333333333334, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51048.8936214447, 54374.020111083984, 57734.68049621582, 53520.6997795105, 53311.57343673706, 57124.14013671875, 54037.526779174805, 54938.773584365845, 51229.906792640686, 54666.8734292984, 52438.453468322754, 51826.96025657654, 54995.400182724, 55496.593673706055, 52840.65302276611, 51586.41352081299, 44289.71347618103, 57022.73345184326, 52049.80690765381, 54051.2600402832, 52413.94017648697, 55264.146545410156, 56849.43357849121, 51991.28672790527, 51496.486744880676, 56619.93354797363, 47607.59343624115, 49494.660190582275, 53756.42686653137, 50092.09352016449], "episode_lengths": [135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136], "policy_agent_0_reward": [51048.8936214447, 54374.020111083984, 57734.68049621582, 53520.6997795105, 53311.57343673706, 57124.14013671875, 54037.526779174805, 54938.773584365845, 51229.906792640686, 54666.8734292984, 52438.453468322754, 51826.96025657654, 54995.400182724, 55496.593673706055, 52840.65302276611, 51586.41352081299, 44289.71347618103, 57022.73345184326, 52049.80690765381, 54051.2600402832, 52413.94017648697, 55264.146545410156, 56849.43357849121, 51991.28672790527, 51496.486744880676, 56619.93354797363, 47607.59343624115, 49494.660190582275, 53756.42686653137, 50092.09352016449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.227868302019374, "mean_inference_ms": 6.434467977766014, "mean_action_processing_ms": 0.20089454769498896, "mean_env_wait_ms": 209.95780386271068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04259268442789713, "StateBufferConnector_ms": 0.006421407063802083, "ViewRequirementAgentConnector_ms": 0.19072930018107095}}, "episode_reward_max": 57734.68049621582, "episode_reward_min": 44289.71347618103, "episode_reward_mean": 53139.03591675758, "episode_len_mean": 135.46666666666667, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 44289.71347618103}, "policy_reward_max": {"agent_0": 57734.68049621582}, "policy_reward_mean": {"agent_0": 53139.03591675758}, "hist_stats": {"episode_reward": [51048.8936214447, 54374.020111083984, 57734.68049621582, 53520.6997795105, 53311.57343673706, 57124.14013671875, 54037.526779174805, 54938.773584365845, 51229.906792640686, 54666.8734292984, 52438.453468322754, 51826.96025657654, 54995.400182724, 55496.593673706055, 52840.65302276611, 51586.41352081299, 44289.71347618103, 57022.73345184326, 52049.80690765381, 54051.2600402832, 52413.94017648697, 55264.146545410156, 56849.43357849121, 51991.28672790527, 51496.486744880676, 56619.93354797363, 47607.59343624115, 49494.660190582275, 53756.42686653137, 50092.09352016449], "episode_lengths": [135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136], "policy_agent_0_reward": [51048.8936214447, 54374.020111083984, 57734.68049621582, 53520.6997795105, 53311.57343673706, 57124.14013671875, 54037.526779174805, 54938.773584365845, 51229.906792640686, 54666.8734292984, 52438.453468322754, 51826.96025657654, 54995.400182724, 55496.593673706055, 52840.65302276611, 51586.41352081299, 44289.71347618103, 57022.73345184326, 52049.80690765381, 54051.2600402832, 52413.94017648697, 55264.146545410156, 56849.43357849121, 51991.28672790527, 51496.486744880676, 56619.93354797363, 47607.59343624115, 49494.660190582275, 53756.42686653137, 50092.09352016449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.227868302019374, "mean_inference_ms": 6.434467977766014, "mean_action_processing_ms": 0.20089454769498896, "mean_env_wait_ms": 209.95780386271068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04259268442789713, "StateBufferConnector_ms": 0.006421407063802083, "ViewRequirementAgentConnector_ms": 0.19072930018107095}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.83473867701562, "num_env_steps_trained_throughput_per_sec": 214.83473867701562, "timesteps_total": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 16090.74, "sample_time_ms": 11754.784, "learn_time_ms": 4153.323, "learn_throughput": 963.084, "synch_weights_time_ms": 181.641}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "episodes_total": 5520, "training_iteration": 190, "trial_id": "185f8_00000", "date": "2025-03-21_12-35-10", "timestamp": 1742560510, "time_this_iter_s": 18.68484592437744, "time_total_s": 3031.4647629261017, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc28c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3031.4647629261017, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.31153846153846, "ram_util_percent": 13.792307692307693}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.772974967956543, "policy_loss": -0.01618550531566143, "vf_loss": 9.787353515625, "vf_explained_var": 1.2200325727462769e-07, "kl": 0.009032650850713253, "entropy": 0.4146023690700531, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "sampler_results": {"episode_reward_max": 57617.58026123047, "episode_reward_min": 45111.28665816784, "episode_reward_mean": 52281.99216877929, "episode_len_mean": 135.58139534883722, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 45111.28665816784}, "policy_reward_max": {"agent_0": 57617.58026123047}, "policy_reward_mean": {"agent_0": 52281.99216877929}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51797.086919784546, 51173.053525447845, 52384.78670215607, 50599.92017364502, 53463.693771362305, 54410.20680618286, 52412.78008747101, 53908.16017913818, 55019.493560791016, 53316.5067653656, 55469.24674987793, 53981.740283966064, 51091.87358665466, 55535.80684661865, 49360.24668264389, 55084.65317153931, 54542.700286865234, 55531.22018432617, 51470.49321937561, 49013.43376684189, 57617.58026123047, 51511.26016044617, 46388.65329837799, 52859.89330673218, 52007.72039794922, 51226.693574905396, 56604.72699737549, 56018.96011734009, 48466.46669006348, 53314.420249938965, 53348.48672771454, 56504.42695617676, 46373.81361192465, 54548.67335510254, 47171.36674308777, 55979.80017089844, 51155.89340209961, 55027.293449401855, 48835.08677482605, 52006.82017326355, 51641.82006645203, 54283.56693267822, 55876.15354347229, 50028.640209198, 49971.07351785898, 55695.433685302734, 52315.066922187805, 54995.06674194336, 48872.94668960571, 56377.24691772461, 45162.026748895645, 48466.18013572693, 50430.80663537979, 45111.28665816784, 54856.22679901123, 52902.7601184845, 51215.02680540085, 57441.50021362305, 47840.99335861206, 56024.48046875, 53181.46714782715, 52407.80018615723, 50072.086893081665, 51518.000061035156, 56197.41337585449, 53385.81343841553, 53461.106773376465, 55922.13374710083, 57480.460021972656, 50103.45339393616, 51548.513359069824, 53313.64711892605, 49562.2867603302, 51270.8268995285, 50957.36689019203, 45497.27335101366, 52320.38033294678, 49948.813373565674, 55282.053577423096, 48129.80687332153, 53200.573333740234, 48554.4665145874, 55646.92664337158, 50908.79353237152, 47750.79344677925, 52585.626611709595], "episode_lengths": [135, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 137, 136, 135, 136, 136, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 136, 134, 137, 136, 136, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 137, 137, 135, 135, 135, 135, 136, 135, 135, 136, 136, 137, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 137, 135, 136, 135, 135, 137, 135, 136, 135, 136, 136, 136], "policy_agent_0_reward": [51797.086919784546, 51173.053525447845, 52384.78670215607, 50599.92017364502, 53463.693771362305, 54410.20680618286, 52412.78008747101, 53908.16017913818, 55019.493560791016, 53316.5067653656, 55469.24674987793, 53981.740283966064, 51091.87358665466, 55535.80684661865, 49360.24668264389, 55084.65317153931, 54542.700286865234, 55531.22018432617, 51470.49321937561, 49013.43376684189, 57617.58026123047, 51511.26016044617, 46388.65329837799, 52859.89330673218, 52007.72039794922, 51226.693574905396, 56604.72699737549, 56018.96011734009, 48466.46669006348, 53314.420249938965, 53348.48672771454, 56504.42695617676, 46373.81361192465, 54548.67335510254, 47171.36674308777, 55979.80017089844, 51155.89340209961, 55027.293449401855, 48835.08677482605, 52006.82017326355, 51641.82006645203, 54283.56693267822, 55876.15354347229, 50028.640209198, 49971.07351785898, 55695.433685302734, 52315.066922187805, 54995.06674194336, 48872.94668960571, 56377.24691772461, 45162.026748895645, 48466.18013572693, 50430.80663537979, 45111.28665816784, 54856.22679901123, 52902.7601184845, 51215.02680540085, 57441.50021362305, 47840.99335861206, 56024.48046875, 53181.46714782715, 52407.80018615723, 50072.086893081665, 51518.000061035156, 56197.41337585449, 53385.81343841553, 53461.106773376465, 55922.13374710083, 57480.460021972656, 50103.45339393616, 51548.513359069824, 53313.64711892605, 49562.2867603302, 51270.8268995285, 50957.36689019203, 45497.27335101366, 52320.38033294678, 49948.813373565674, 55282.053577423096, 48129.80687332153, 53200.573333740234, 48554.4665145874, 55646.92664337158, 50908.79353237152, 47750.79344677925, 52585.626611709595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.554686949775785, "mean_inference_ms": 6.695412120194552, "mean_action_processing_ms": 0.19986253779930357, "mean_env_wait_ms": 225.72725622957964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04061044648636219, "StateBufferConnector_ms": 0.008583900540374046, "ViewRequirementAgentConnector_ms": 0.24126934450726176}}, "episode_reward_max": 57617.58026123047, "episode_reward_min": 45111.28665816784, "episode_reward_mean": 52281.99216877929, "episode_len_mean": 135.58139534883722, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 45111.28665816784}, "policy_reward_max": {"agent_0": 57617.58026123047}, "policy_reward_mean": {"agent_0": 52281.99216877929}, "hist_stats": {"episode_reward": [51797.086919784546, 51173.053525447845, 52384.78670215607, 50599.92017364502, 53463.693771362305, 54410.20680618286, 52412.78008747101, 53908.16017913818, 55019.493560791016, 53316.5067653656, 55469.24674987793, 53981.740283966064, 51091.87358665466, 55535.80684661865, 49360.24668264389, 55084.65317153931, 54542.700286865234, 55531.22018432617, 51470.49321937561, 49013.43376684189, 57617.58026123047, 51511.26016044617, 46388.65329837799, 52859.89330673218, 52007.72039794922, 51226.693574905396, 56604.72699737549, 56018.96011734009, 48466.46669006348, 53314.420249938965, 53348.48672771454, 56504.42695617676, 46373.81361192465, 54548.67335510254, 47171.36674308777, 55979.80017089844, 51155.89340209961, 55027.293449401855, 48835.08677482605, 52006.82017326355, 51641.82006645203, 54283.56693267822, 55876.15354347229, 50028.640209198, 49971.07351785898, 55695.433685302734, 52315.066922187805, 54995.06674194336, 48872.94668960571, 56377.24691772461, 45162.026748895645, 48466.18013572693, 50430.80663537979, 45111.28665816784, 54856.22679901123, 52902.7601184845, 51215.02680540085, 57441.50021362305, 47840.99335861206, 56024.48046875, 53181.46714782715, 52407.80018615723, 50072.086893081665, 51518.000061035156, 56197.41337585449, 53385.81343841553, 53461.106773376465, 55922.13374710083, 57480.460021972656, 50103.45339393616, 51548.513359069824, 53313.64711892605, 49562.2867603302, 51270.8268995285, 50957.36689019203, 45497.27335101366, 52320.38033294678, 49948.813373565674, 55282.053577423096, 48129.80687332153, 53200.573333740234, 48554.4665145874, 55646.92664337158, 50908.79353237152, 47750.79344677925, 52585.626611709595], "episode_lengths": [135, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 137, 136, 135, 136, 136, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 135, 136, 135, 136, 134, 137, 136, 136, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 137, 137, 135, 135, 135, 135, 136, 135, 135, 136, 136, 137, 135, 136, 136, 135, 135, 136, 135, 136, 135, 136, 137, 135, 136, 135, 135, 137, 135, 136, 135, 136, 136, 136], "policy_agent_0_reward": [51797.086919784546, 51173.053525447845, 52384.78670215607, 50599.92017364502, 53463.693771362305, 54410.20680618286, 52412.78008747101, 53908.16017913818, 55019.493560791016, 53316.5067653656, 55469.24674987793, 53981.740283966064, 51091.87358665466, 55535.80684661865, 49360.24668264389, 55084.65317153931, 54542.700286865234, 55531.22018432617, 51470.49321937561, 49013.43376684189, 57617.58026123047, 51511.26016044617, 46388.65329837799, 52859.89330673218, 52007.72039794922, 51226.693574905396, 56604.72699737549, 56018.96011734009, 48466.46669006348, 53314.420249938965, 53348.48672771454, 56504.42695617676, 46373.81361192465, 54548.67335510254, 47171.36674308777, 55979.80017089844, 51155.89340209961, 55027.293449401855, 48835.08677482605, 52006.82017326355, 51641.82006645203, 54283.56693267822, 55876.15354347229, 50028.640209198, 49971.07351785898, 55695.433685302734, 52315.066922187805, 54995.06674194336, 48872.94668960571, 56377.24691772461, 45162.026748895645, 48466.18013572693, 50430.80663537979, 45111.28665816784, 54856.22679901123, 52902.7601184845, 51215.02680540085, 57441.50021362305, 47840.99335861206, 56024.48046875, 53181.46714782715, 52407.80018615723, 50072.086893081665, 51518.000061035156, 56197.41337585449, 53385.81343841553, 53461.106773376465, 55922.13374710083, 57480.460021972656, 50103.45339393616, 51548.513359069824, 53313.64711892605, 49562.2867603302, 51270.8268995285, 50957.36689019203, 45497.27335101366, 52320.38033294678, 49948.813373565674, 55282.053577423096, 48129.80687332153, 53200.573333740234, 48554.4665145874, 55646.92664337158, 50908.79353237152, 47750.79344677925, 52585.626611709595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.554686949775785, "mean_inference_ms": 6.695412120194552, "mean_action_processing_ms": 0.19986253779930357, "mean_env_wait_ms": 225.72725622957964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04061044648636219, "StateBufferConnector_ms": 0.008583900540374046, "ViewRequirementAgentConnector_ms": 0.24126934450726176}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.8985781823103, "num_env_steps_trained_throughput_per_sec": 226.8985781823103, "timesteps_total": 764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 16409.238, "sample_time_ms": 12096.426, "learn_time_ms": 4135.333, "learn_throughput": 967.274, "synch_weights_time_ms": 176.512}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "done": false, "episodes_total": 5606, "training_iteration": 191, "trial_id": "185f8_00000", "date": "2025-03-21_12-35-28", "timestamp": 1742560528, "time_this_iter_s": 17.68053364753723, "time_total_s": 3049.145296573639, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3049.145296573639, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 95.34, "ram_util_percent": 13.784}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.973082542419434, "policy_loss": -0.01258131768554449, "vf_loss": 9.984130859375, "vf_explained_var": -4.284083843231201e-08, "kl": 0.007662641350179911, "entropy": 0.404327929019928, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 54918.88014125824, "episode_reward_min": 48435.35354143381, "episode_reward_mean": 51913.69782337546, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 48435.35354143381}, "policy_reward_max": {"agent_0": 54918.88014125824}, "policy_reward_mean": {"agent_0": 51913.69782337546}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52795.63338088989, 49600.35331249237, 48435.35354143381, 54261.393547058105, 54918.88014125824, 51470.57301712036], "episode_lengths": [136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [52795.63338088989, 49600.35331249237, 48435.35354143381, 54261.393547058105, 54918.88014125824, 51470.57301712036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.82614344815946, "mean_inference_ms": 6.753894757021725, "mean_action_processing_ms": 0.20098593101160034, "mean_env_wait_ms": 225.44063380458408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04161198933919271, "StateBufferConnector_ms": 0.0064055124918619795, "ViewRequirementAgentConnector_ms": 0.18030405044555664}}, "episode_reward_max": 54918.88014125824, "episode_reward_min": 48435.35354143381, "episode_reward_mean": 51913.69782337546, "episode_len_mean": 135.5, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 48435.35354143381}, "policy_reward_max": {"agent_0": 54918.88014125824}, "policy_reward_mean": {"agent_0": 51913.69782337546}, "hist_stats": {"episode_reward": [52795.63338088989, 49600.35331249237, 48435.35354143381, 54261.393547058105, 54918.88014125824, 51470.57301712036], "episode_lengths": [136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [52795.63338088989, 49600.35331249237, 48435.35354143381, 54261.393547058105, 54918.88014125824, 51470.57301712036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.82614344815946, "mean_inference_ms": 6.753894757021725, "mean_action_processing_ms": 0.20098593101160034, "mean_env_wait_ms": 225.44063380458408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04161198933919271, "StateBufferConnector_ms": 0.0064055124918619795, "ViewRequirementAgentConnector_ms": 0.18030405044555664}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.3069143058705, "num_env_steps_trained_throughput_per_sec": 274.3069143058705, "timesteps_total": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 16372.895, "sample_time_ms": 12073.444, "learn_time_ms": 4130.789, "learn_throughput": 968.338, "synch_weights_time_ms": 167.686}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 5612, "training_iteration": 192, "trial_id": "185f8_00000", "date": "2025-03-21_12-35-42", "timestamp": 1742560542, "time_this_iter_s": 14.63281536102295, "time_total_s": 3063.778111934662, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe5f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3063.778111934662, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.435, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.980813026428223, "policy_loss": -0.016335690394043922, "vf_loss": 9.995118141174316, "vf_explained_var": 2.059464634385222e-07, "kl": 0.01014632172882557, "entropy": 0.40827375650405884, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "sampler_results": {"episode_reward_max": 51470.57301712036, "episode_reward_min": 51470.57301712036, "episode_reward_mean": 51470.57301712036, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51470.57301712036}, "policy_reward_max": {"agent_0": 51470.57301712036}, "policy_reward_mean": {"agent_0": 51470.57301712036}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51470.57301712036], "episode_lengths": [135], "policy_agent_0_reward": [51470.57301712036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.2178680413714, "mean_inference_ms": 6.606404115942263, "mean_action_processing_ms": 0.19718760683635467, "mean_env_wait_ms": 225.39316756246146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044798851013183594, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.17406940460205078}}, "episode_reward_max": 51470.57301712036, "episode_reward_min": 51470.57301712036, "episode_reward_mean": 51470.57301712036, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51470.57301712036}, "policy_reward_max": {"agent_0": 51470.57301712036}, "policy_reward_mean": {"agent_0": 51470.57301712036}, "hist_stats": {"episode_reward": [51470.57301712036], "episode_lengths": [135], "policy_agent_0_reward": [51470.57301712036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.2178680413714, "mean_inference_ms": 6.606404115942263, "mean_action_processing_ms": 0.19718760683635467, "mean_env_wait_ms": 225.39316756246146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044798851013183594, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.17406940460205078}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.2802283313593, "num_env_steps_trained_throughput_per_sec": 283.2802283313593, "timesteps_total": 772000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 15880.201, "sample_time_ms": 11614.635, "learn_time_ms": 4098.899, "learn_throughput": 975.872, "synch_weights_time_ms": 165.687}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "done": false, "episodes_total": 5612, "training_iteration": 193, "trial_id": "185f8_00000", "date": "2025-03-21_12-35-56", "timestamp": 1742560556, "time_this_iter_s": 14.16542935371399, "time_total_s": 3077.943541288376, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789feff250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3077.943541288376, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.495, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.907588958740234, "policy_loss": -0.014550205320119858, "vf_loss": 9.920166015625, "vf_explained_var": 1.768892019526902e-07, "kl": 0.009861103259027004, "entropy": 0.4376993179321289, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "sampler_results": {"episode_reward_max": 58041.25367355347, "episode_reward_min": 42975.10001850128, "episode_reward_mean": 52284.340753398836, "episode_len_mean": 135.5625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42975.10001850128}, "policy_reward_max": {"agent_0": 58041.25367355347}, "policy_reward_mean": {"agent_0": 52284.340753398836}, "custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54615.78686141968, 49171.59342575073, 53174.87999725342, 55990.95350646973, 51441.719985723495, 51205.500314712524, 53257.82001686096, 50135.83342075348, 51803.666858673096, 56636.68031311035, 58041.25367355347, 52859.9668712616, 54250.42003631592, 55057.566747665405, 42975.10001850128, 52601.48669242859, 48701.93322753906, 55987.833435058594, 48233.553641319275, 49163.0668296814, 52801.88005065918, 52638.2333946228, 50463.25342082977, 53917.12018585205, 48768.95999336243, 50209.946657180786, 53056.62674713135, 52756.21343231201, 57087.2269859314, 49640.46685218811, 50429.72689342499, 56022.63362121582], "episode_lengths": [135, 136, 135, 135, 135, 134, 137, 135, 137, 135, 135, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 136, 135, 136, 135, 135, 136, 135], "policy_agent_0_reward": [54615.78686141968, 49171.59342575073, 53174.87999725342, 55990.95350646973, 51441.719985723495, 51205.500314712524, 53257.82001686096, 50135.83342075348, 51803.666858673096, 56636.68031311035, 58041.25367355347, 52859.9668712616, 54250.42003631592, 55057.566747665405, 42975.10001850128, 52601.48669242859, 48701.93322753906, 55987.833435058594, 48233.553641319275, 49163.0668296814, 52801.88005065918, 52638.2333946228, 50463.25342082977, 53917.12018585205, 48768.95999336243, 50209.946657180786, 53056.62674713135, 52756.21343231201, 57087.2269859314, 49640.46685218811, 50429.72689342499, 56022.63362121582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.068869585388065, "mean_inference_ms": 6.418772977338291, "mean_action_processing_ms": 0.20053882664411343, "mean_env_wait_ms": 210.2560731078356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043733417987823486, "StateBufferConnector_ms": 0.006552785634994507, "ViewRequirementAgentConnector_ms": 0.25567933917045593}}, "episode_reward_max": 58041.25367355347, "episode_reward_min": 42975.10001850128, "episode_reward_mean": 52284.340753398836, "episode_len_mean": 135.5625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 42975.10001850128}, "policy_reward_max": {"agent_0": 58041.25367355347}, "policy_reward_mean": {"agent_0": 52284.340753398836}, "hist_stats": {"episode_reward": [54615.78686141968, 49171.59342575073, 53174.87999725342, 55990.95350646973, 51441.719985723495, 51205.500314712524, 53257.82001686096, 50135.83342075348, 51803.666858673096, 56636.68031311035, 58041.25367355347, 52859.9668712616, 54250.42003631592, 55057.566747665405, 42975.10001850128, 52601.48669242859, 48701.93322753906, 55987.833435058594, 48233.553641319275, 49163.0668296814, 52801.88005065918, 52638.2333946228, 50463.25342082977, 53917.12018585205, 48768.95999336243, 50209.946657180786, 53056.62674713135, 52756.21343231201, 57087.2269859314, 49640.46685218811, 50429.72689342499, 56022.63362121582], "episode_lengths": [135, 136, 135, 135, 135, 134, 137, 135, 137, 135, 135, 136, 135, 135, 136, 136, 136, 135, 136, 136, 136, 136, 137, 136, 135, 136, 135, 136, 135, 135, 136, 135], "policy_agent_0_reward": [54615.78686141968, 49171.59342575073, 53174.87999725342, 55990.95350646973, 51441.719985723495, 51205.500314712524, 53257.82001686096, 50135.83342075348, 51803.666858673096, 56636.68031311035, 58041.25367355347, 52859.9668712616, 54250.42003631592, 55057.566747665405, 42975.10001850128, 52601.48669242859, 48701.93322753906, 55987.833435058594, 48233.553641319275, 49163.0668296814, 52801.88005065918, 52638.2333946228, 50463.25342082977, 53917.12018585205, 48768.95999336243, 50209.946657180786, 53056.62674713135, 52756.21343231201, 57087.2269859314, 49640.46685218811, 50429.72689342499, 56022.63362121582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.068869585388065, "mean_inference_ms": 6.418772977338291, "mean_action_processing_ms": 0.20053882664411343, "mean_env_wait_ms": 210.2560731078356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043733417987823486, "StateBufferConnector_ms": 0.006552785634994507, "ViewRequirementAgentConnector_ms": 0.25567933917045593}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.41971504687297, "num_env_steps_trained_throughput_per_sec": 216.41971504687297, "timesteps_total": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 16285.201, "sample_time_ms": 12023.907, "learn_time_ms": 4100.152, "learn_throughput": 975.574, "synch_weights_time_ms": 160.124}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "episodes_total": 5644, "training_iteration": 194, "trial_id": "185f8_00000", "date": "2025-03-21_12-36-15", "timestamp": 1742560575, "time_this_iter_s": 18.541916370391846, "time_total_s": 3096.4854576587677, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789feff910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3096.4854576587677, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.19615384615385, "ram_util_percent": 13.78846153846154}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.918318748474121, "policy_loss": -0.01681220531463623, "vf_loss": 9.932861328125, "vf_explained_var": 9.145587398506905e-08, "kl": 0.011345555074512959, "entropy": 0.4985416531562805, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 56528.406730651855, "episode_reward_min": 45126.78001499176, "episode_reward_mean": 52568.23316220001, "episode_len_mean": 135.11111111111111, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {"agent_0": 45126.78001499176}, "policy_reward_max": {"agent_0": 56528.406730651855}, "policy_reward_mean": {"agent_0": 52568.23316220001}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49094.36007118225, 55736.060260772705, 50367.67330932617, 53148.053396224976, 51843.459953308105, 54234.9935836792, 53293.89324569702, 51971.153440475464, 52785.426902770996, 56528.406730651855, 53378.08704376221, 50300.00650024414, 51123.573585510254, 52810.7735786438, 55615.7532119751, 52754.06003570557, 53776.313537597656, 54953.88673400879, 56302.079849243164, 46996.58002567291, 45126.78001499176, 55173.42017364502, 52758.79327774048, 46800.5467069149, 53642.10655975342, 55686.786823272705, 53139.26682662964], "episode_lengths": [135, 136, 136, 135, 135, 135, 136, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135], "policy_agent_0_reward": [49094.36007118225, 55736.060260772705, 50367.67330932617, 53148.053396224976, 51843.459953308105, 54234.9935836792, 53293.89324569702, 51971.153440475464, 52785.426902770996, 56528.406730651855, 53378.08704376221, 50300.00650024414, 51123.573585510254, 52810.7735786438, 55615.7532119751, 52754.06003570557, 53776.313537597656, 54953.88673400879, 56302.079849243164, 46996.58002567291, 45126.78001499176, 55173.42017364502, 52758.79327774048, 46800.5467069149, 53642.10655975342, 55686.786823272705, 53139.26682662964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.07023596551236, "mean_inference_ms": 6.631969936543148, "mean_action_processing_ms": 0.20116035153863024, "mean_env_wait_ms": 225.77993428774965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07935188434742114, "StateBufferConnector_ms": 0.024492652327926072, "ViewRequirementAgentConnector_ms": 0.22075882664433233}}, "episode_reward_max": 56528.406730651855, "episode_reward_min": 45126.78001499176, "episode_reward_mean": 52568.23316220001, "episode_len_mean": 135.11111111111111, "episodes_this_iter": 27, "policy_reward_min": {"agent_0": 45126.78001499176}, "policy_reward_max": {"agent_0": 56528.406730651855}, "policy_reward_mean": {"agent_0": 52568.23316220001}, "hist_stats": {"episode_reward": [49094.36007118225, 55736.060260772705, 50367.67330932617, 53148.053396224976, 51843.459953308105, 54234.9935836792, 53293.89324569702, 51971.153440475464, 52785.426902770996, 56528.406730651855, 53378.08704376221, 50300.00650024414, 51123.573585510254, 52810.7735786438, 55615.7532119751, 52754.06003570557, 53776.313537597656, 54953.88673400879, 56302.079849243164, 46996.58002567291, 45126.78001499176, 55173.42017364502, 52758.79327774048, 46800.5467069149, 53642.10655975342, 55686.786823272705, 53139.26682662964], "episode_lengths": [135, 136, 136, 135, 135, 135, 136, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135], "policy_agent_0_reward": [49094.36007118225, 55736.060260772705, 50367.67330932617, 53148.053396224976, 51843.459953308105, 54234.9935836792, 53293.89324569702, 51971.153440475464, 52785.426902770996, 56528.406730651855, 53378.08704376221, 50300.00650024414, 51123.573585510254, 52810.7735786438, 55615.7532119751, 52754.06003570557, 53776.313537597656, 54953.88673400879, 56302.079849243164, 46996.58002567291, 45126.78001499176, 55173.42017364502, 52758.79327774048, 46800.5467069149, 53642.10655975342, 55686.786823272705, 53139.26682662964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.07023596551236, "mean_inference_ms": 6.631969936543148, "mean_action_processing_ms": 0.20116035153863024, "mean_env_wait_ms": 225.77993428774965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07935188434742114, "StateBufferConnector_ms": 0.024492652327926072, "ViewRequirementAgentConnector_ms": 0.22075882664433233}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.0496796837001, "num_env_steps_trained_throughput_per_sec": 277.0496796837001, "timesteps_total": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 16363.544, "sample_time_ms": 12118.313, "learn_time_ms": 4088.267, "learn_throughput": 978.41, "synch_weights_time_ms": 155.908}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 5671, "training_iteration": 195, "trial_id": "185f8_00000", "date": "2025-03-21_12-36-30", "timestamp": 1742560590, "time_this_iter_s": 14.482224702835083, "time_total_s": 3110.967682361603, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3110.967682361603, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 97.15714285714284, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.861538461538461, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.824767112731934, "policy_loss": -0.01385525707155466, "vf_loss": 9.8369140625, "vf_explained_var": -1.5658636698390183e-07, "kl": 0.008541247807443142, "entropy": 0.40356042981147766, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "sampler_results": {"episode_reward_max": 57583.37326049805, "episode_reward_min": 43011.23999798298, "episode_reward_mean": 51784.464637945246, "episode_len_mean": 135.4, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {"agent_0": 43011.23999798298}, "policy_reward_max": {"agent_0": 57583.37326049805}, "policy_reward_mean": {"agent_0": 51784.464637945246}, "custom_metrics": {"num_batches_mean": 5.861538461538461, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52694.05344200134, 55030.92008590698, 50912.246952056885, 56086.4267616272, 53318.866859436035, 51154.586762428284, 53491.993492126465, 52345.35354804993, 50001.600105285645, 53621.57353019714, 47705.75356030464, 54305.719871520996, 50906.640087127686, 49623.68676030636, 49490.14688491821, 52138.053508758545, 53714.62032318115, 53210.24709320068, 52624.120056152344, 54871.0001373291, 52774.793380737305, 53418.51349258423, 50036.85350608826, 45479.88669395447, 52929.67330169678, 53529.63320159912, 50292.140219688416, 49931.58670043945, 45029.5333378315, 55788.21357727051, 57004.00704956055, 49907.06679034233, 55640.35997772217, 52200.59998321533, 48539.880048274994, 52023.08672332764, 48938.82680606842, 46356.58681845665, 55180.41989326477, 55598.867053985596, 53141.63354969025, 55941.933532714844, 48177.84008049965, 53401.32023239136, 50792.146673202515, 57583.37326049805, 51241.94005584717, 50498.5802154541, 47305.67999076843, 55999.11375427246, 52296.26668548584, 49825.080017089844, 50247.000173568726, 51908.1467628479, 56711.866775512695, 53141.5401134491, 55296.21345901489, 51171.380268096924, 50790.21351623535, 46999.139996528625, 51024.23341226578, 47471.193582654, 51200.913469314575, 52964.073513031006, 43011.23999798298], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135], "policy_agent_0_reward": [52694.05344200134, 55030.92008590698, 50912.246952056885, 56086.4267616272, 53318.866859436035, 51154.586762428284, 53491.993492126465, 52345.35354804993, 50001.600105285645, 53621.57353019714, 47705.75356030464, 54305.719871520996, 50906.640087127686, 49623.68676030636, 49490.14688491821, 52138.053508758545, 53714.62032318115, 53210.24709320068, 52624.120056152344, 54871.0001373291, 52774.793380737305, 53418.51349258423, 50036.85350608826, 45479.88669395447, 52929.67330169678, 53529.63320159912, 50292.140219688416, 49931.58670043945, 45029.5333378315, 55788.21357727051, 57004.00704956055, 49907.06679034233, 55640.35997772217, 52200.59998321533, 48539.880048274994, 52023.08672332764, 48938.82680606842, 46356.58681845665, 55180.41989326477, 55598.867053985596, 53141.63354969025, 55941.933532714844, 48177.84008049965, 53401.32023239136, 50792.146673202515, 57583.37326049805, 51241.94005584717, 50498.5802154541, 47305.67999076843, 55999.11375427246, 52296.26668548584, 49825.080017089844, 50247.000173568726, 51908.1467628479, 56711.866775512695, 53141.5401134491, 55296.21345901489, 51171.380268096924, 50790.21351623535, 46999.139996528625, 51024.23341226578, 47471.193582654, 51200.913469314575, 52964.073513031006, 43011.23999798298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.169424698122405, "mean_inference_ms": 6.721493057310664, "mean_action_processing_ms": 0.19918181990964356, "mean_env_wait_ms": 225.85725365346497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07755169501671424, "StateBufferConnector_ms": 0.006125890291654146, "ViewRequirementAgentConnector_ms": 0.2966723075279823}}, "episode_reward_max": 57583.37326049805, "episode_reward_min": 43011.23999798298, "episode_reward_mean": 51784.464637945246, "episode_len_mean": 135.4, "episodes_this_iter": 65, "policy_reward_min": {"agent_0": 43011.23999798298}, "policy_reward_max": {"agent_0": 57583.37326049805}, "policy_reward_mean": {"agent_0": 51784.464637945246}, "hist_stats": {"episode_reward": [52694.05344200134, 55030.92008590698, 50912.246952056885, 56086.4267616272, 53318.866859436035, 51154.586762428284, 53491.993492126465, 52345.35354804993, 50001.600105285645, 53621.57353019714, 47705.75356030464, 54305.719871520996, 50906.640087127686, 49623.68676030636, 49490.14688491821, 52138.053508758545, 53714.62032318115, 53210.24709320068, 52624.120056152344, 54871.0001373291, 52774.793380737305, 53418.51349258423, 50036.85350608826, 45479.88669395447, 52929.67330169678, 53529.63320159912, 50292.140219688416, 49931.58670043945, 45029.5333378315, 55788.21357727051, 57004.00704956055, 49907.06679034233, 55640.35997772217, 52200.59998321533, 48539.880048274994, 52023.08672332764, 48938.82680606842, 46356.58681845665, 55180.41989326477, 55598.867053985596, 53141.63354969025, 55941.933532714844, 48177.84008049965, 53401.32023239136, 50792.146673202515, 57583.37326049805, 51241.94005584717, 50498.5802154541, 47305.67999076843, 55999.11375427246, 52296.26668548584, 49825.080017089844, 50247.000173568726, 51908.1467628479, 56711.866775512695, 53141.5401134491, 55296.21345901489, 51171.380268096924, 50790.21351623535, 46999.139996528625, 51024.23341226578, 47471.193582654, 51200.913469314575, 52964.073513031006, 43011.23999798298], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136, 136, 135, 135], "policy_agent_0_reward": [52694.05344200134, 55030.92008590698, 50912.246952056885, 56086.4267616272, 53318.866859436035, 51154.586762428284, 53491.993492126465, 52345.35354804993, 50001.600105285645, 53621.57353019714, 47705.75356030464, 54305.719871520996, 50906.640087127686, 49623.68676030636, 49490.14688491821, 52138.053508758545, 53714.62032318115, 53210.24709320068, 52624.120056152344, 54871.0001373291, 52774.793380737305, 53418.51349258423, 50036.85350608826, 45479.88669395447, 52929.67330169678, 53529.63320159912, 50292.140219688416, 49931.58670043945, 45029.5333378315, 55788.21357727051, 57004.00704956055, 49907.06679034233, 55640.35997772217, 52200.59998321533, 48539.880048274994, 52023.08672332764, 48938.82680606842, 46356.58681845665, 55180.41989326477, 55598.867053985596, 53141.63354969025, 55941.933532714844, 48177.84008049965, 53401.32023239136, 50792.146673202515, 57583.37326049805, 51241.94005584717, 50498.5802154541, 47305.67999076843, 55999.11375427246, 52296.26668548584, 49825.080017089844, 50247.000173568726, 51908.1467628479, 56711.866775512695, 53141.5401134491, 55296.21345901489, 51171.380268096924, 50790.21351623535, 46999.139996528625, 51024.23341226578, 47471.193582654, 51200.913469314575, 52964.073513031006, 43011.23999798298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.169424698122405, "mean_inference_ms": 6.721493057310664, "mean_action_processing_ms": 0.19918181990964356, "mean_env_wait_ms": 225.85725365346497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07755169501671424, "StateBufferConnector_ms": 0.006125890291654146, "ViewRequirementAgentConnector_ms": 0.2966723075279823}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.33790564023388, "num_env_steps_trained_throughput_per_sec": 203.33790564023388, "timesteps_total": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 16513.69, "sample_time_ms": 12283.174, "learn_time_ms": 4070.147, "learn_throughput": 982.765, "synch_weights_time_ms": 159.3}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "episodes_total": 5736, "training_iteration": 196, "trial_id": "185f8_00000", "date": "2025-03-21_12-36-49", "timestamp": 1742560609, "time_this_iter_s": 19.739696264266968, "time_total_s": 3130.7073786258698, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe9e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3130.7073786258698, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 98.46000000000002, "ram_util_percent": 13.772}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985630989074707, "policy_loss": -0.016217412427067757, "vf_loss": 10.0, "vf_explained_var": 3.003825668201898e-07, "kl": 0.009243573993444443, "entropy": 0.4076457619667053, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "sampler_results": {"episode_reward_max": 43011.23999798298, "episode_reward_min": 43011.23999798298, "episode_reward_mean": 43011.23999798298, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 43011.23999798298}, "policy_reward_max": {"agent_0": 43011.23999798298}, "policy_reward_mean": {"agent_0": 43011.23999798298}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [43011.23999798298], "episode_lengths": [135], "policy_agent_0_reward": [43011.23999798298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.120087988312385, "mean_inference_ms": 6.586098469521808, "mean_action_processing_ms": 0.20213186427316615, "mean_env_wait_ms": 227.84778594058534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04553794860839844, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.19712448120117188}}, "episode_reward_max": 43011.23999798298, "episode_reward_min": 43011.23999798298, "episode_reward_mean": 43011.23999798298, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 43011.23999798298}, "policy_reward_max": {"agent_0": 43011.23999798298}, "policy_reward_mean": {"agent_0": 43011.23999798298}, "hist_stats": {"episode_reward": [43011.23999798298], "episode_lengths": [135], "policy_agent_0_reward": [43011.23999798298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.120087988312385, "mean_inference_ms": 6.586098469521808, "mean_action_processing_ms": 0.20213186427316615, "mean_env_wait_ms": 227.84778594058534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04553794860839844, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.19712448120117188}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.1412320054236, "num_env_steps_trained_throughput_per_sec": 288.1412320054236, "timesteps_total": 788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 15842.074, "sample_time_ms": 11702.743, "learn_time_ms": 3976.428, "learn_throughput": 1005.928, "synch_weights_time_ms": 161.828}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "done": false, "episodes_total": 5736, "training_iteration": 197, "trial_id": "185f8_00000", "date": "2025-03-21_12-37-03", "timestamp": 1742560623, "time_this_iter_s": 13.93106484413147, "time_total_s": 3144.638443470001, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24b57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3144.638443470001, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.49000000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906144142150879, "policy_loss": -0.01447473093867302, "vf_loss": 9.918701171875, "vf_explained_var": 1.585110993573835e-07, "kl": 0.009585412219166756, "entropy": 0.43249937891960144, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 57532.226791381836, "episode_reward_min": 44049.24684715271, "episode_reward_mean": 52261.87162446417, "episode_len_mean": 135.28125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44049.24684715271}, "policy_reward_max": {"agent_0": 57532.226791381836}, "policy_reward_mean": {"agent_0": 52261.87162446417}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50081.76017618179, 56246.05377864838, 55577.57984161377, 46295.02014923096, 54482.96019744873, 51013.43991088867, 54346.413635253906, 49593.49353027344, 46687.39990377426, 56063.0402469635, 54492.94699192047, 54762.1868057251, 54017.793674468994, 51463.52008187771, 51175.260078430176, 50474.48007106781, 55977.627128601074, 55283.33363342285, 47363.00680875778, 52384.21327972412, 53474.97343361378, 44049.24684715271, 54791.40675354004, 54893.633529663086, 53141.02020263672, 57532.226791381836, 49181.90022569895, 47299.16674232483, 56226.833713531494, 51576.786901474, 56215.4068069458, 46215.760110616684], "episode_lengths": [136, 134, 134, 136, 136, 135, 135, 135, 136, 135, 134, 135, 135, 135, 136, 137, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 137, 136, 135, 136, 134, 135], "policy_agent_0_reward": [50081.76017618179, 56246.05377864838, 55577.57984161377, 46295.02014923096, 54482.96019744873, 51013.43991088867, 54346.413635253906, 49593.49353027344, 46687.39990377426, 56063.0402469635, 54492.94699192047, 54762.1868057251, 54017.793674468994, 51463.52008187771, 51175.260078430176, 50474.48007106781, 55977.627128601074, 55283.33363342285, 47363.00680875778, 52384.21327972412, 53474.97343361378, 44049.24684715271, 54791.40675354004, 54893.633529663086, 53141.02020263672, 57532.226791381836, 49181.90022569895, 47299.16674232483, 56226.833713531494, 51576.786901474, 56215.4068069458, 46215.760110616684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.02053496950714, "mean_inference_ms": 6.406058016494656, "mean_action_processing_ms": 0.20042483758269689, "mean_env_wait_ms": 210.36611946945254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04085153341293335, "StateBufferConnector_ms": 0.019036978483200073, "ViewRequirementAgentConnector_ms": 0.38231462240219116}}, "episode_reward_max": 57532.226791381836, "episode_reward_min": 44049.24684715271, "episode_reward_mean": 52261.87162446417, "episode_len_mean": 135.28125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44049.24684715271}, "policy_reward_max": {"agent_0": 57532.226791381836}, "policy_reward_mean": {"agent_0": 52261.87162446417}, "hist_stats": {"episode_reward": [50081.76017618179, 56246.05377864838, 55577.57984161377, 46295.02014923096, 54482.96019744873, 51013.43991088867, 54346.413635253906, 49593.49353027344, 46687.39990377426, 56063.0402469635, 54492.94699192047, 54762.1868057251, 54017.793674468994, 51463.52008187771, 51175.260078430176, 50474.48007106781, 55977.627128601074, 55283.33363342285, 47363.00680875778, 52384.21327972412, 53474.97343361378, 44049.24684715271, 54791.40675354004, 54893.633529663086, 53141.02020263672, 57532.226791381836, 49181.90022569895, 47299.16674232483, 56226.833713531494, 51576.786901474, 56215.4068069458, 46215.760110616684], "episode_lengths": [136, 134, 134, 136, 136, 135, 135, 135, 136, 135, 134, 135, 135, 135, 136, 137, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 137, 136, 135, 136, 134, 135], "policy_agent_0_reward": [50081.76017618179, 56246.05377864838, 55577.57984161377, 46295.02014923096, 54482.96019744873, 51013.43991088867, 54346.413635253906, 49593.49353027344, 46687.39990377426, 56063.0402469635, 54492.94699192047, 54762.1868057251, 54017.793674468994, 51463.52008187771, 51175.260078430176, 50474.48007106781, 55977.627128601074, 55283.33363342285, 47363.00680875778, 52384.21327972412, 53474.97343361378, 44049.24684715271, 54791.40675354004, 54893.633529663086, 53141.02020263672, 57532.226791381836, 49181.90022569895, 47299.16674232483, 56226.833713531494, 51576.786901474, 56215.4068069458, 46215.760110616684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.02053496950714, "mean_inference_ms": 6.406058016494656, "mean_action_processing_ms": 0.20042483758269689, "mean_env_wait_ms": 210.36611946945254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04085153341293335, "StateBufferConnector_ms": 0.019036978483200073, "ViewRequirementAgentConnector_ms": 0.38231462240219116}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.70956106240502, "num_env_steps_trained_throughput_per_sec": 251.70956106240502, "timesteps_total": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 16107.538, "sample_time_ms": 12000.556, "learn_time_ms": 3942.376, "learn_throughput": 1014.617, "synch_weights_time_ms": 163.535}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 5768, "training_iteration": 198, "trial_id": "185f8_00000", "date": "2025-03-21_12-37-19", "timestamp": 1742560639, "time_this_iter_s": 15.95494556427002, "time_total_s": 3160.5933890342712, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3160.5933890342712, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.38500000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985215187072754, "policy_loss": -0.014038937166333199, "vf_loss": 9.997314453125, "vf_explained_var": 1.65216619052444e-07, "kl": 0.009697201661765575, "entropy": 0.3960760235786438, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "sampler_results": {"episode_reward_max": 51231.90677642822, "episode_reward_min": 51231.90677642822, "episode_reward_mean": 51231.90677642822, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 51231.90677642822}, "policy_reward_max": {"agent_0": 51231.90677642822}, "policy_reward_mean": {"agent_0": 51231.90677642822}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51231.90677642822], "episode_lengths": [135], "policy_agent_0_reward": [51231.90677642822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.64072256197564, "mean_inference_ms": 6.410149881090693, "mean_action_processing_ms": 0.19811569455842018, "mean_env_wait_ms": 222.56159842304427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03876686096191406, "StateBufferConnector_ms": 0.005698204040527344, "ViewRequirementAgentConnector_ms": 0.164031982421875}}, "episode_reward_max": 51231.90677642822, "episode_reward_min": 51231.90677642822, "episode_reward_mean": 51231.90677642822, "episode_len_mean": 135.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 51231.90677642822}, "policy_reward_max": {"agent_0": 51231.90677642822}, "policy_reward_mean": {"agent_0": 51231.90677642822}, "hist_stats": {"episode_reward": [51231.90677642822], "episode_lengths": [135], "policy_agent_0_reward": [51231.90677642822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.64072256197564, "mean_inference_ms": 6.410149881090693, "mean_action_processing_ms": 0.19811569455842018, "mean_env_wait_ms": 222.56159842304427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03876686096191406, "StateBufferConnector_ms": 0.005698204040527344, "ViewRequirementAgentConnector_ms": 0.164031982421875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.2896501915377, "num_env_steps_trained_throughput_per_sec": 276.2896501915377, "timesteps_total": 796000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 16179.304, "sample_time_ms": 12055.318, "learn_time_ms": 3956.168, "learn_throughput": 1011.079, "synch_weights_time_ms": 166.747}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "done": false, "episodes_total": 5769, "training_iteration": 199, "trial_id": "185f8_00000", "date": "2025-03-21_12-37-34", "timestamp": 1742560654, "time_this_iter_s": 14.53278636932373, "time_total_s": 3175.126175403595, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a215af80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3175.126175403595, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.40952380952383, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.208791208791209, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.760992050170898, "policy_loss": -0.013765319250524044, "vf_loss": 9.77294921875, "vf_explained_var": -1.4224400501916534e-07, "kl": 0.00904387328773737, "entropy": 0.4289074242115021, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "sampler_results": {"episode_reward_max": 57771.193756103516, "episode_reward_min": 43719.80666255951, "episode_reward_mean": 51846.44811269215, "episode_len_mean": 135.3846153846154, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43719.80666255951}, "policy_reward_max": {"agent_0": 57771.193756103516}, "policy_reward_mean": {"agent_0": 51846.44811269215}, "custom_metrics": {"num_batches_mean": 5.208791208791209, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52161.94012451172, 54517.74697113037, 55378.480056762695, 51093.88006401062, 51677.893824100494, 54057.206718444824, 56256.000396728516, 48988.633476257324, 52986.913429260254, 51361.200176239014, 49229.047201156616, 55293.93360900879, 50021.40016555786, 51786.10681915283, 50215.84673118591, 48128.78015947342, 54976.226638793945, 51837.65334320068, 45150.966767311096, 53424.73341369629, 57466.6467590332, 50923.19355773926, 57169.92670440674, 51835.33984184265, 53268.479961395264, 49773.753452301025, 51480.08020210266, 53091.52692604065, 49731.34020233154, 54199.10005617142, 57771.193756103516, 52934.16693305969, 47763.76018333435, 50713.82666540146, 51311.64696645737, 51625.36653518677, 52459.4534072876, 53282.426850795746, 51841.7400932312, 50915.1000289917, 47220.873452186584, 47407.57997524738, 50747.38026380539, 52186.04007911682, 55433.7467956543, 55315.08688354492, 53303.46006965637, 47715.46660423279, 53503.16007232666, 51427.626945495605, 46036.659989356995, 56234.4867682457, 54702.526666641235, 52007.0135345459, 51622.7802696228, 50155.09348678589, 56693.28686904907, 52788.42662811279, 53860.100116729736, 51163.846853256226, 55232.44009971619, 46409.740268707275, 54193.693267822266, 54357.02014923096, 46072.60016345978, 53309.75352478027, 49666.46660196781, 49417.69314575195, 51426.513541698456, 51676.29355120659, 55232.27996826172, 51260.78019332886, 47643.18668937683, 50250.21356964111, 50859.180247306824, 46816.41346216202, 50395.43991851807, 55131.200075149536, 52450.45343017578, 54077.76676750183, 55270.860050201416, 43719.80666255951, 49335.666873931885, 51509.42015552521, 53700.70010948181, 52383.98014831543, 52025.18701553345, 51767.22664356232, 55891.620208740234, 50560.08668899536, 48355.79356956482], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 137, 136, 134, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 137, 135, 136, 136, 136, 137, 136, 135, 137, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 134, 136, 136], "policy_agent_0_reward": [52161.94012451172, 54517.74697113037, 55378.480056762695, 51093.88006401062, 51677.893824100494, 54057.206718444824, 56256.000396728516, 48988.633476257324, 52986.913429260254, 51361.200176239014, 49229.047201156616, 55293.93360900879, 50021.40016555786, 51786.10681915283, 50215.84673118591, 48128.78015947342, 54976.226638793945, 51837.65334320068, 45150.966767311096, 53424.73341369629, 57466.6467590332, 50923.19355773926, 57169.92670440674, 51835.33984184265, 53268.479961395264, 49773.753452301025, 51480.08020210266, 53091.52692604065, 49731.34020233154, 54199.10005617142, 57771.193756103516, 52934.16693305969, 47763.76018333435, 50713.82666540146, 51311.64696645737, 51625.36653518677, 52459.4534072876, 53282.426850795746, 51841.7400932312, 50915.1000289917, 47220.873452186584, 47407.57997524738, 50747.38026380539, 52186.04007911682, 55433.7467956543, 55315.08688354492, 53303.46006965637, 47715.46660423279, 53503.16007232666, 51427.626945495605, 46036.659989356995, 56234.4867682457, 54702.526666641235, 52007.0135345459, 51622.7802696228, 50155.09348678589, 56693.28686904907, 52788.42662811279, 53860.100116729736, 51163.846853256226, 55232.44009971619, 46409.740268707275, 54193.693267822266, 54357.02014923096, 46072.60016345978, 53309.75352478027, 49666.46660196781, 49417.69314575195, 51426.513541698456, 51676.29355120659, 55232.27996826172, 51260.78019332886, 47643.18668937683, 50250.21356964111, 50859.180247306824, 46816.41346216202, 50395.43991851807, 55131.200075149536, 52450.45343017578, 54077.76676750183, 55270.860050201416, 43719.80666255951, 49335.666873931885, 51509.42015552521, 53700.70010948181, 52383.98014831543, 52025.18701553345, 51767.22664356232, 55891.620208740234, 50560.08668899536, 48355.79356956482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.8361859129784, "mean_inference_ms": 6.689313002864924, "mean_action_processing_ms": 0.19966700769889467, "mean_env_wait_ms": 225.9262137372086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04690741444682027, "StateBufferConnector_ms": 0.006074957795195527, "ViewRequirementAgentConnector_ms": 0.24766188401442307}}, "episode_reward_max": 57771.193756103516, "episode_reward_min": 43719.80666255951, "episode_reward_mean": 51846.44811269215, "episode_len_mean": 135.3846153846154, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43719.80666255951}, "policy_reward_max": {"agent_0": 57771.193756103516}, "policy_reward_mean": {"agent_0": 51846.44811269215}, "hist_stats": {"episode_reward": [52161.94012451172, 54517.74697113037, 55378.480056762695, 51093.88006401062, 51677.893824100494, 54057.206718444824, 56256.000396728516, 48988.633476257324, 52986.913429260254, 51361.200176239014, 49229.047201156616, 55293.93360900879, 50021.40016555786, 51786.10681915283, 50215.84673118591, 48128.78015947342, 54976.226638793945, 51837.65334320068, 45150.966767311096, 53424.73341369629, 57466.6467590332, 50923.19355773926, 57169.92670440674, 51835.33984184265, 53268.479961395264, 49773.753452301025, 51480.08020210266, 53091.52692604065, 49731.34020233154, 54199.10005617142, 57771.193756103516, 52934.16693305969, 47763.76018333435, 50713.82666540146, 51311.64696645737, 51625.36653518677, 52459.4534072876, 53282.426850795746, 51841.7400932312, 50915.1000289917, 47220.873452186584, 47407.57997524738, 50747.38026380539, 52186.04007911682, 55433.7467956543, 55315.08688354492, 53303.46006965637, 47715.46660423279, 53503.16007232666, 51427.626945495605, 46036.659989356995, 56234.4867682457, 54702.526666641235, 52007.0135345459, 51622.7802696228, 50155.09348678589, 56693.28686904907, 52788.42662811279, 53860.100116729736, 51163.846853256226, 55232.44009971619, 46409.740268707275, 54193.693267822266, 54357.02014923096, 46072.60016345978, 53309.75352478027, 49666.46660196781, 49417.69314575195, 51426.513541698456, 51676.29355120659, 55232.27996826172, 51260.78019332886, 47643.18668937683, 50250.21356964111, 50859.180247306824, 46816.41346216202, 50395.43991851807, 55131.200075149536, 52450.45343017578, 54077.76676750183, 55270.860050201416, 43719.80666255951, 49335.666873931885, 51509.42015552521, 53700.70010948181, 52383.98014831543, 52025.18701553345, 51767.22664356232, 55891.620208740234, 50560.08668899536, 48355.79356956482], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 137, 136, 134, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 137, 135, 136, 136, 136, 137, 136, 135, 137, 135, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 134, 136, 136], "policy_agent_0_reward": [52161.94012451172, 54517.74697113037, 55378.480056762695, 51093.88006401062, 51677.893824100494, 54057.206718444824, 56256.000396728516, 48988.633476257324, 52986.913429260254, 51361.200176239014, 49229.047201156616, 55293.93360900879, 50021.40016555786, 51786.10681915283, 50215.84673118591, 48128.78015947342, 54976.226638793945, 51837.65334320068, 45150.966767311096, 53424.73341369629, 57466.6467590332, 50923.19355773926, 57169.92670440674, 51835.33984184265, 53268.479961395264, 49773.753452301025, 51480.08020210266, 53091.52692604065, 49731.34020233154, 54199.10005617142, 57771.193756103516, 52934.16693305969, 47763.76018333435, 50713.82666540146, 51311.64696645737, 51625.36653518677, 52459.4534072876, 53282.426850795746, 51841.7400932312, 50915.1000289917, 47220.873452186584, 47407.57997524738, 50747.38026380539, 52186.04007911682, 55433.7467956543, 55315.08688354492, 53303.46006965637, 47715.46660423279, 53503.16007232666, 51427.626945495605, 46036.659989356995, 56234.4867682457, 54702.526666641235, 52007.0135345459, 51622.7802696228, 50155.09348678589, 56693.28686904907, 52788.42662811279, 53860.100116729736, 51163.846853256226, 55232.44009971619, 46409.740268707275, 54193.693267822266, 54357.02014923096, 46072.60016345978, 53309.75352478027, 49666.46660196781, 49417.69314575195, 51426.513541698456, 51676.29355120659, 55232.27996826172, 51260.78019332886, 47643.18668937683, 50250.21356964111, 50859.180247306824, 46816.41346216202, 50395.43991851807, 55131.200075149536, 52450.45343017578, 54077.76676750183, 55270.860050201416, 43719.80666255951, 49335.666873931885, 51509.42015552521, 53700.70010948181, 52383.98014831543, 52025.18701553345, 51767.22664356232, 55891.620208740234, 50560.08668899536, 48355.79356956482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.8361859129784, "mean_inference_ms": 6.689313002864924, "mean_action_processing_ms": 0.19966700769889467, "mean_env_wait_ms": 225.9262137372086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04690741444682027, "StateBufferConnector_ms": 0.006074957795195527, "ViewRequirementAgentConnector_ms": 0.24766188401442307}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.27817242748677, "num_env_steps_trained_throughput_per_sec": 195.27817242748677, "timesteps_total": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 16365.76, "sample_time_ms": 12223.957, "learn_time_ms": 3975.496, "learn_throughput": 1006.164, "synch_weights_time_ms": 165.345}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "episodes_total": 5860, "training_iteration": 200, "trial_id": "185f8_00000", "date": "2025-03-21_12-37-55", "timestamp": 1742560675, "time_this_iter_s": 20.54071283340454, "time_total_s": 3195.6668882369995, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24b56c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3195.6668882369995, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 95.47586206896551, "ram_util_percent": 13.77586206896552}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982458114624023, "policy_loss": -0.017398914322257042, "vf_loss": 9.99755859375, "vf_explained_var": 1.3931344255979639e-06, "kl": 0.011492199264466763, "entropy": 0.47504302859306335, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 48355.79356956482, "episode_reward_min": 48355.79356956482, "episode_reward_mean": 48355.79356956482, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48355.79356956482}, "policy_reward_max": {"agent_0": 48355.79356956482}, "policy_reward_mean": {"agent_0": 48355.79356956482}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48355.79356956482], "episode_lengths": [136], "policy_agent_0_reward": [48355.79356956482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.892991642712836, "mean_inference_ms": 6.208401213510206, "mean_action_processing_ms": 0.19940099312428142, "mean_env_wait_ms": 228.45569109100975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172325134277344, "StateBufferConnector_ms": 0.0062465667724609375, "ViewRequirementAgentConnector_ms": 0.1789569854736328}}, "episode_reward_max": 48355.79356956482, "episode_reward_min": 48355.79356956482, "episode_reward_mean": 48355.79356956482, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48355.79356956482}, "policy_reward_max": {"agent_0": 48355.79356956482}, "policy_reward_mean": {"agent_0": 48355.79356956482}, "hist_stats": {"episode_reward": [48355.79356956482], "episode_lengths": [136], "policy_agent_0_reward": [48355.79356956482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.892991642712836, "mean_inference_ms": 6.208401213510206, "mean_action_processing_ms": 0.19940099312428142, "mean_env_wait_ms": 228.45569109100975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04172325134277344, "StateBufferConnector_ms": 0.0062465667724609375, "ViewRequirementAgentConnector_ms": 0.1789569854736328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.89243582252004, "num_env_steps_trained_throughput_per_sec": 290.89243582252004, "timesteps_total": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 15977.936, "sample_time_ms": 11778.356, "learn_time_ms": 4029.943, "learn_throughput": 992.57, "synch_weights_time_ms": 168.668}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 5860, "training_iteration": 201, "trial_id": "185f8_00000", "date": "2025-03-21_12-38-09", "timestamp": 1742560689, "time_this_iter_s": 13.803150177001953, "time_total_s": 3209.4700384140015, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3209.4700384140015, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 99.56842105263159, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.905983924865723, "policy_loss": -0.0162127036601305, "vf_loss": 9.920166015625, "vf_explained_var": 2.5201589437529037e-07, "kl": 0.01014413870871067, "entropy": 0.45742395520210266, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "sampler_results": {"episode_reward_max": 58239.460189819336, "episode_reward_min": 43300.26685655117, "episode_reward_mean": 51227.00261649117, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43300.26685655117}, "policy_reward_max": {"agent_0": 58239.460189819336}, "policy_reward_mean": {"agent_0": 51227.00261649117}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50779.86700248718, 52136.92671394348, 54824.593673706055, 53210.94705200195, 50446.71368122101, 55361.52005767822, 43300.26685655117, 45571.679861068726, 48353.51324272156, 44990.400077819824, 46403.106494903564, 50778.30676150322, 47704.18666648865, 55171.66677856445, 53826.85364532471, 45366.61338043213, 53293.58025741577, 53904.60026168823, 55541.68693256378, 51634.8933429718, 52125.926540374756, 50797.89994049072, 57001.133697509766, 51335.1065864563, 51140.286766052246, 58239.460189819336, 50869.74027633667, 49849.593542099, 51577.62651062012, 49705.96673083305, 56357.233390808105, 47662.18681526184], "episode_lengths": [136, 136, 135, 136, 135, 135, 136, 136, 137, 136, 136, 136, 136, 135, 135, 136, 136, 135, 134, 136, 136, 135, 135, 135, 136, 134, 135, 136, 136, 136, 134, 135], "policy_agent_0_reward": [50779.86700248718, 52136.92671394348, 54824.593673706055, 53210.94705200195, 50446.71368122101, 55361.52005767822, 43300.26685655117, 45571.679861068726, 48353.51324272156, 44990.400077819824, 46403.106494903564, 50778.30676150322, 47704.18666648865, 55171.66677856445, 53826.85364532471, 45366.61338043213, 53293.58025741577, 53904.60026168823, 55541.68693256378, 51634.8933429718, 52125.926540374756, 50797.89994049072, 57001.133697509766, 51335.1065864563, 51140.286766052246, 58239.460189819336, 50869.74027633667, 49849.593542099, 51577.62651062012, 49705.96673083305, 56357.233390808105, 47662.18681526184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.94413907407767, "mean_inference_ms": 6.398253119365554, "mean_action_processing_ms": 0.20051774716509574, "mean_env_wait_ms": 210.12030758139107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04800334572792053, "StateBufferConnector_ms": 0.006457418203353882, "ViewRequirementAgentConnector_ms": 0.3107979893684387}}, "episode_reward_max": 58239.460189819336, "episode_reward_min": 43300.26685655117, "episode_reward_mean": 51227.00261649117, "episode_len_mean": 135.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 43300.26685655117}, "policy_reward_max": {"agent_0": 58239.460189819336}, "policy_reward_mean": {"agent_0": 51227.00261649117}, "hist_stats": {"episode_reward": [50779.86700248718, 52136.92671394348, 54824.593673706055, 53210.94705200195, 50446.71368122101, 55361.52005767822, 43300.26685655117, 45571.679861068726, 48353.51324272156, 44990.400077819824, 46403.106494903564, 50778.30676150322, 47704.18666648865, 55171.66677856445, 53826.85364532471, 45366.61338043213, 53293.58025741577, 53904.60026168823, 55541.68693256378, 51634.8933429718, 52125.926540374756, 50797.89994049072, 57001.133697509766, 51335.1065864563, 51140.286766052246, 58239.460189819336, 50869.74027633667, 49849.593542099, 51577.62651062012, 49705.96673083305, 56357.233390808105, 47662.18681526184], "episode_lengths": [136, 136, 135, 136, 135, 135, 136, 136, 137, 136, 136, 136, 136, 135, 135, 136, 136, 135, 134, 136, 136, 135, 135, 135, 136, 134, 135, 136, 136, 136, 134, 135], "policy_agent_0_reward": [50779.86700248718, 52136.92671394348, 54824.593673706055, 53210.94705200195, 50446.71368122101, 55361.52005767822, 43300.26685655117, 45571.679861068726, 48353.51324272156, 44990.400077819824, 46403.106494903564, 50778.30676150322, 47704.18666648865, 55171.66677856445, 53826.85364532471, 45366.61338043213, 53293.58025741577, 53904.60026168823, 55541.68693256378, 51634.8933429718, 52125.926540374756, 50797.89994049072, 57001.133697509766, 51335.1065864563, 51140.286766052246, 58239.460189819336, 50869.74027633667, 49849.593542099, 51577.62651062012, 49705.96673083305, 56357.233390808105, 47662.18681526184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.94413907407767, "mean_inference_ms": 6.398253119365554, "mean_action_processing_ms": 0.20051774716509574, "mean_env_wait_ms": 210.12030758139107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04800334572792053, "StateBufferConnector_ms": 0.006457418203353882, "ViewRequirementAgentConnector_ms": 0.3107979893684387}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.20475992714418, "num_env_steps_trained_throughput_per_sec": 243.20475992714418, "timesteps_total": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 16164.42, "sample_time_ms": 11974.138, "learn_time_ms": 4014.504, "learn_throughput": 996.387, "synch_weights_time_ms": 174.793}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "episodes_total": 5892, "training_iteration": 202, "trial_id": "185f8_00000", "date": "2025-03-21_12-38-25", "timestamp": 1742560705, "time_this_iter_s": 16.505820512771606, "time_total_s": 3225.975858926773, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe9e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3225.975858926773, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 99.43478260869566, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98669719696045, "policy_loss": -0.015116681344807148, "vf_loss": 10.0, "vf_explained_var": 1.4988084728884132e-07, "kl": 0.009072130545973778, "entropy": 0.42296141386032104, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "sampler_results": {"episode_reward_max": 47662.18681526184, "episode_reward_min": 47662.18681526184, "episode_reward_mean": 47662.18681526184, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47662.18681526184}, "policy_reward_max": {"agent_0": 47662.18681526184}, "policy_reward_mean": {"agent_0": 47662.18681526184}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47662.18681526184], "episode_lengths": [135], "policy_agent_0_reward": [47662.18681526184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.14983345633667, "mean_inference_ms": 6.358835603122645, "mean_action_processing_ms": 0.1915526458021581, "mean_env_wait_ms": 209.31272777067016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059723854064941406, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.17242431640625}}, "episode_reward_max": 47662.18681526184, "episode_reward_min": 47662.18681526184, "episode_reward_mean": 47662.18681526184, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 47662.18681526184}, "policy_reward_max": {"agent_0": 47662.18681526184}, "policy_reward_mean": {"agent_0": 47662.18681526184}, "hist_stats": {"episode_reward": [47662.18681526184], "episode_lengths": [135], "policy_agent_0_reward": [47662.18681526184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.14983345633667, "mean_inference_ms": 6.358835603122645, "mean_action_processing_ms": 0.1915526458021581, "mean_env_wait_ms": 209.31272777067016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059723854064941406, "StateBufferConnector_ms": 0.006008148193359375, "ViewRequirementAgentConnector_ms": 0.17242431640625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.5847418868681, "num_env_steps_trained_throughput_per_sec": 291.5847418868681, "timesteps_total": 812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 16124.203, "sample_time_ms": 11950.075, "learn_time_ms": 4003.545, "learn_throughput": 999.115, "synch_weights_time_ms": 169.603}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "done": false, "episodes_total": 5892, "training_iteration": 203, "trial_id": "185f8_00000", "date": "2025-03-21_12-38-39", "timestamp": 1742560719, "time_this_iter_s": 13.775445222854614, "time_total_s": 3239.7513041496277, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3239.7513041496277, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 99.5263157894737, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.753876686096191, "policy_loss": -0.016711775213479996, "vf_loss": 9.7685546875, "vf_explained_var": 4.041940115939724e-08, "kl": 0.010167027823626995, "entropy": 0.4244630038738251, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 57545.09385681152, "episode_reward_min": 39692.81344509125, "episode_reward_mean": 50932.593246405864, "episode_len_mean": 135.3695652173913, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 39692.81344509125}, "policy_reward_max": {"agent_0": 57545.09385681152}, "policy_reward_mean": {"agent_0": 50932.593246405864}, "custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [46854.20672720671, 46392.54026031494, 50613.28681373596, 54928.2667388916, 50727.480260849, 51634.68673706055, 49648.86010360718, 51557.473436415195, 55061.400131225586, 49886.96687722206, 52158.05330657959, 54486.64019012451, 51627.85340499878, 53869.820346832275, 54309.886947631836, 52761.10015678406, 51538.88020992279, 52237.786947250366, 51212.96001815796, 53824.740074157715, 52928.76015663147, 47284.22680950165, 48536.97325706482, 57545.09385681152, 43823.70012712479, 49614.98009967804, 48078.006779670715, 50192.09352016449, 56596.01334953308, 55872.41346740723, 52238.68008232117, 55577.40681934357, 52709.940311431885, 45166.366978645325, 56252.98680114746, 50102.106622219086, 40893.68009752035, 54253.04685211182, 42484.493240356445, 52470.15324783325, 55116.3868765831, 41269.44019651413, 49427.666721343994, 52474.86018371582, 53067.73346710205, 55861.033294677734, 48296.413314819336, 50315.386969566345, 51960.96032714844, 51633.54003202915, 45720.18013226986, 52647.03359794617, 52712.84002685547, 46524.406809806824, 54333.286865234375, 50620.926919937134, 53571.22000789642, 48544.56024646759, 50737.17335128784, 47600.773354530334, 56597.11363220215, 53082.27338409424, 53511.90023803711, 47639.953411102295, 48067.66685330868, 48995.073464393616, 43490.53346565366, 53471.98017883301, 52694.16021156311, 48334.2401702404, 48778.320209503174, 52218.00667953491, 54292.12691497803, 55473.340127944946, 45696.63329601288, 53271.36015129089, 48577.7865165472, 52599.546924591064, 52696.693365097046, 39692.81344509125, 54200.680096149445, 45447.6668381691, 51382.61329460144, 47326.21339136362, 54469.03349685669, 54778.333532333374, 51077.30681228638, 48208.86661481857, 53873.75330352783, 52774.06698036194, 51315.1535320282, 51373.53327560425], "episode_lengths": [136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 134, 136, 135, 135, 136, 134, 135, 136, 135, 136, 135, 134, 136, 136, 135, 136, 134, 135, 136, 136, 135, 135, 135, 137, 135, 136, 135, 136, 136, 134, 135, 135, 135, 135, 136, 135, 136, 134, 136, 135, 135, 135, 135, 137, 136, 135, 136, 135, 135, 135, 135, 136, 136, 137, 136, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135], "policy_agent_0_reward": [46854.20672720671, 46392.54026031494, 50613.28681373596, 54928.2667388916, 50727.480260849, 51634.68673706055, 49648.86010360718, 51557.473436415195, 55061.400131225586, 49886.96687722206, 52158.05330657959, 54486.64019012451, 51627.85340499878, 53869.820346832275, 54309.886947631836, 52761.10015678406, 51538.88020992279, 52237.786947250366, 51212.96001815796, 53824.740074157715, 52928.76015663147, 47284.22680950165, 48536.97325706482, 57545.09385681152, 43823.70012712479, 49614.98009967804, 48078.006779670715, 50192.09352016449, 56596.01334953308, 55872.41346740723, 52238.68008232117, 55577.40681934357, 52709.940311431885, 45166.366978645325, 56252.98680114746, 50102.106622219086, 40893.68009752035, 54253.04685211182, 42484.493240356445, 52470.15324783325, 55116.3868765831, 41269.44019651413, 49427.666721343994, 52474.86018371582, 53067.73346710205, 55861.033294677734, 48296.413314819336, 50315.386969566345, 51960.96032714844, 51633.54003202915, 45720.18013226986, 52647.03359794617, 52712.84002685547, 46524.406809806824, 54333.286865234375, 50620.926919937134, 53571.22000789642, 48544.56024646759, 50737.17335128784, 47600.773354530334, 56597.11363220215, 53082.27338409424, 53511.90023803711, 47639.953411102295, 48067.66685330868, 48995.073464393616, 43490.53346565366, 53471.98017883301, 52694.16021156311, 48334.2401702404, 48778.320209503174, 52218.00667953491, 54292.12691497803, 55473.340127944946, 45696.63329601288, 53271.36015129089, 48577.7865165472, 52599.546924591064, 52696.693365097046, 39692.81344509125, 54200.680096149445, 45447.6668381691, 51382.61329460144, 47326.21339136362, 54469.03349685669, 54778.333532333374, 51077.30681228638, 48208.86661481857, 53873.75330352783, 52774.06698036194, 51315.1535320282, 51373.53327560425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.73543608024224, "mean_inference_ms": 6.689081272702986, "mean_action_processing_ms": 0.19957587492352696, "mean_env_wait_ms": 225.8881119236108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03920275232066279, "StateBufferConnector_ms": 0.008441054302713146, "ViewRequirementAgentConnector_ms": 0.29093338095623517}}, "episode_reward_max": 57545.09385681152, "episode_reward_min": 39692.81344509125, "episode_reward_mean": 50932.593246405864, "episode_len_mean": 135.3695652173913, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 39692.81344509125}, "policy_reward_max": {"agent_0": 57545.09385681152}, "policy_reward_mean": {"agent_0": 50932.593246405864}, "hist_stats": {"episode_reward": [46854.20672720671, 46392.54026031494, 50613.28681373596, 54928.2667388916, 50727.480260849, 51634.68673706055, 49648.86010360718, 51557.473436415195, 55061.400131225586, 49886.96687722206, 52158.05330657959, 54486.64019012451, 51627.85340499878, 53869.820346832275, 54309.886947631836, 52761.10015678406, 51538.88020992279, 52237.786947250366, 51212.96001815796, 53824.740074157715, 52928.76015663147, 47284.22680950165, 48536.97325706482, 57545.09385681152, 43823.70012712479, 49614.98009967804, 48078.006779670715, 50192.09352016449, 56596.01334953308, 55872.41346740723, 52238.68008232117, 55577.40681934357, 52709.940311431885, 45166.366978645325, 56252.98680114746, 50102.106622219086, 40893.68009752035, 54253.04685211182, 42484.493240356445, 52470.15324783325, 55116.3868765831, 41269.44019651413, 49427.666721343994, 52474.86018371582, 53067.73346710205, 55861.033294677734, 48296.413314819336, 50315.386969566345, 51960.96032714844, 51633.54003202915, 45720.18013226986, 52647.03359794617, 52712.84002685547, 46524.406809806824, 54333.286865234375, 50620.926919937134, 53571.22000789642, 48544.56024646759, 50737.17335128784, 47600.773354530334, 56597.11363220215, 53082.27338409424, 53511.90023803711, 47639.953411102295, 48067.66685330868, 48995.073464393616, 43490.53346565366, 53471.98017883301, 52694.16021156311, 48334.2401702404, 48778.320209503174, 52218.00667953491, 54292.12691497803, 55473.340127944946, 45696.63329601288, 53271.36015129089, 48577.7865165472, 52599.546924591064, 52696.693365097046, 39692.81344509125, 54200.680096149445, 45447.6668381691, 51382.61329460144, 47326.21339136362, 54469.03349685669, 54778.333532333374, 51077.30681228638, 48208.86661481857, 53873.75330352783, 52774.06698036194, 51315.1535320282, 51373.53327560425], "episode_lengths": [136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 134, 136, 135, 135, 136, 134, 135, 136, 135, 136, 135, 134, 136, 136, 135, 136, 134, 135, 136, 136, 135, 135, 135, 137, 135, 136, 135, 136, 136, 134, 135, 135, 135, 135, 136, 135, 136, 134, 136, 135, 135, 135, 135, 137, 136, 135, 136, 135, 135, 135, 135, 136, 136, 137, 136, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 135], "policy_agent_0_reward": [46854.20672720671, 46392.54026031494, 50613.28681373596, 54928.2667388916, 50727.480260849, 51634.68673706055, 49648.86010360718, 51557.473436415195, 55061.400131225586, 49886.96687722206, 52158.05330657959, 54486.64019012451, 51627.85340499878, 53869.820346832275, 54309.886947631836, 52761.10015678406, 51538.88020992279, 52237.786947250366, 51212.96001815796, 53824.740074157715, 52928.76015663147, 47284.22680950165, 48536.97325706482, 57545.09385681152, 43823.70012712479, 49614.98009967804, 48078.006779670715, 50192.09352016449, 56596.01334953308, 55872.41346740723, 52238.68008232117, 55577.40681934357, 52709.940311431885, 45166.366978645325, 56252.98680114746, 50102.106622219086, 40893.68009752035, 54253.04685211182, 42484.493240356445, 52470.15324783325, 55116.3868765831, 41269.44019651413, 49427.666721343994, 52474.86018371582, 53067.73346710205, 55861.033294677734, 48296.413314819336, 50315.386969566345, 51960.96032714844, 51633.54003202915, 45720.18013226986, 52647.03359794617, 52712.84002685547, 46524.406809806824, 54333.286865234375, 50620.926919937134, 53571.22000789642, 48544.56024646759, 50737.17335128784, 47600.773354530334, 56597.11363220215, 53082.27338409424, 53511.90023803711, 47639.953411102295, 48067.66685330868, 48995.073464393616, 43490.53346565366, 53471.98017883301, 52694.16021156311, 48334.2401702404, 48778.320209503174, 52218.00667953491, 54292.12691497803, 55473.340127944946, 45696.63329601288, 53271.36015129089, 48577.7865165472, 52599.546924591064, 52696.693365097046, 39692.81344509125, 54200.680096149445, 45447.6668381691, 51382.61329460144, 47326.21339136362, 54469.03349685669, 54778.333532333374, 51077.30681228638, 48208.86661481857, 53873.75330352783, 52774.06698036194, 51315.1535320282, 51373.53327560425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.73543608024224, "mean_inference_ms": 6.689081272702986, "mean_action_processing_ms": 0.19957587492352696, "mean_env_wait_ms": 225.8881119236108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03920275232066279, "StateBufferConnector_ms": 0.008441054302713146, "ViewRequirementAgentConnector_ms": 0.29093338095623517}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.5121964750895, "num_env_steps_trained_throughput_per_sec": 200.5121964750895, "timesteps_total": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 16270.837, "sample_time_ms": 12103.705, "learn_time_ms": 3991.382, "learn_throughput": 1002.159, "synch_weights_time_ms": 174.833}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 5984, "training_iteration": 204, "trial_id": "185f8_00000", "date": "2025-03-21_12-38-59", "timestamp": 1742560739, "time_this_iter_s": 20.03332805633545, "time_total_s": 3259.784632205963, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde4310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3259.784632205963, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 95.55357142857146, "ram_util_percent": 13.775000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986169815063477, "policy_loss": -0.01573866978287697, "vf_loss": 10.0, "vf_explained_var": -4.2977433167834533e-07, "kl": 0.009540408849716187, "entropy": 0.4182611405849457, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "sampler_results": {"episode_reward_max": 51373.53327560425, "episode_reward_min": 51373.53327560425, "episode_reward_mean": 51373.53327560425, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51373.53327560425}, "policy_reward_max": {"agent_0": 51373.53327560425}, "policy_reward_mean": {"agent_0": 51373.53327560425}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51373.53327560425], "episode_lengths": [135], "policy_agent_0_reward": [51373.53327560425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.75987114002884, "mean_inference_ms": 6.227564822661601, "mean_action_processing_ms": 0.19918497424155618, "mean_env_wait_ms": 228.26955606568956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036597251892089844, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1611471176147461}}, "episode_reward_max": 51373.53327560425, "episode_reward_min": 51373.53327560425, "episode_reward_mean": 51373.53327560425, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51373.53327560425}, "policy_reward_max": {"agent_0": 51373.53327560425}, "policy_reward_mean": {"agent_0": 51373.53327560425}, "hist_stats": {"episode_reward": [51373.53327560425], "episode_lengths": [135], "policy_agent_0_reward": [51373.53327560425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.75987114002884, "mean_inference_ms": 6.227564822661601, "mean_action_processing_ms": 0.19918497424155618, "mean_env_wait_ms": 228.26955606568956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036597251892089844, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1611471176147461}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.37463782416853, "num_env_steps_trained_throughput_per_sec": 293.37463782416853, "timesteps_total": 820000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 16190.478, "sample_time_ms": 11988.668, "learn_time_ms": 4023.406, "learn_throughput": 994.183, "synch_weights_time_ms": 177.484}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "done": false, "episodes_total": 5984, "training_iteration": 205, "trial_id": "185f8_00000", "date": "2025-03-21_12-39-13", "timestamp": 1742560753, "time_this_iter_s": 13.699017524719238, "time_total_s": 3273.4836497306824, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3273.4836497306824, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 99.54500000000003, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.905701637268066, "policy_loss": -0.016147295013070107, "vf_loss": 9.919677734375, "vf_explained_var": -1.7198424018260994e-07, "kl": 0.0108565092086792, "entropy": 0.4046160876750946, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "sampler_results": {"episode_reward_max": 55564.23351287842, "episode_reward_min": 46682.6399936676, "episode_reward_mean": 51787.41613288224, "episode_len_mean": 135.46875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46682.6399936676}, "policy_reward_max": {"agent_0": 55564.23351287842}, "policy_reward_mean": {"agent_0": 51787.41613288224}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52881.453384399414, 46967.486698150635, 47178.78684806824, 54281.35325050354, 53472.220249176025, 52801.04693412781, 52002.05333900452, 51183.813316345215, 49625.76011276245, 53396.78680419922, 52046.9267539978, 54611.480237960815, 52896.620080947876, 53671.91341018677, 52914.66689300537, 54799.04662132263, 55564.23351287842, 48785.6399307251, 51266.70016860962, 50611.71336603165, 53438.63324356079, 49386.70683526993, 53758.74687194824, 52890.80694580078, 54920.00011444092, 50869.64665412903, 53556.3200378418, 47074.673570632935, 50460.02651977539, 53551.14693450928, 46682.6399936676, 49648.2666182518], "episode_lengths": [136, 136, 135, 135, 135, 135, 137, 135, 136, 136, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [52881.453384399414, 46967.486698150635, 47178.78684806824, 54281.35325050354, 53472.220249176025, 52801.04693412781, 52002.05333900452, 51183.813316345215, 49625.76011276245, 53396.78680419922, 52046.9267539978, 54611.480237960815, 52896.620080947876, 53671.91341018677, 52914.66689300537, 54799.04662132263, 55564.23351287842, 48785.6399307251, 51266.70016860962, 50611.71336603165, 53438.63324356079, 49386.70683526993, 53758.74687194824, 52890.80694580078, 54920.00011444092, 50869.64665412903, 53556.3200378418, 47074.673570632935, 50460.02651977539, 53551.14693450928, 46682.6399936676, 49648.2666182518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.79294917300828, "mean_inference_ms": 6.413887992801518, "mean_action_processing_ms": 0.20041993754385917, "mean_env_wait_ms": 209.9376402653952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05056709051132202, "StateBufferConnector_ms": 0.006753206253051758, "ViewRequirementAgentConnector_ms": 0.23867934942245483}}, "episode_reward_max": 55564.23351287842, "episode_reward_min": 46682.6399936676, "episode_reward_mean": 51787.41613288224, "episode_len_mean": 135.46875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46682.6399936676}, "policy_reward_max": {"agent_0": 55564.23351287842}, "policy_reward_mean": {"agent_0": 51787.41613288224}, "hist_stats": {"episode_reward": [52881.453384399414, 46967.486698150635, 47178.78684806824, 54281.35325050354, 53472.220249176025, 52801.04693412781, 52002.05333900452, 51183.813316345215, 49625.76011276245, 53396.78680419922, 52046.9267539978, 54611.480237960815, 52896.620080947876, 53671.91341018677, 52914.66689300537, 54799.04662132263, 55564.23351287842, 48785.6399307251, 51266.70016860962, 50611.71336603165, 53438.63324356079, 49386.70683526993, 53758.74687194824, 52890.80694580078, 54920.00011444092, 50869.64665412903, 53556.3200378418, 47074.673570632935, 50460.02651977539, 53551.14693450928, 46682.6399936676, 49648.2666182518], "episode_lengths": [136, 136, 135, 135, 135, 135, 137, 135, 136, 136, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 136, 136, 135, 135, 135, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [52881.453384399414, 46967.486698150635, 47178.78684806824, 54281.35325050354, 53472.220249176025, 52801.04693412781, 52002.05333900452, 51183.813316345215, 49625.76011276245, 53396.78680419922, 52046.9267539978, 54611.480237960815, 52896.620080947876, 53671.91341018677, 52914.66689300537, 54799.04662132263, 55564.23351287842, 48785.6399307251, 51266.70016860962, 50611.71336603165, 53438.63324356079, 49386.70683526993, 53758.74687194824, 52890.80694580078, 54920.00011444092, 50869.64665412903, 53556.3200378418, 47074.673570632935, 50460.02651977539, 53551.14693450928, 46682.6399936676, 49648.2666182518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.79294917300828, "mean_inference_ms": 6.413887992801518, "mean_action_processing_ms": 0.20041993754385917, "mean_env_wait_ms": 209.9376402653952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05056709051132202, "StateBufferConnector_ms": 0.006753206253051758, "ViewRequirementAgentConnector_ms": 0.23867934942245483}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.5237443539468, "num_env_steps_trained_throughput_per_sec": 239.5237443539468, "timesteps_total": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 15893.289, "sample_time_ms": 11663.928, "learn_time_ms": 4051.956, "learn_throughput": 987.177, "synch_weights_time_ms": 176.508}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "episodes_total": 6016, "training_iteration": 206, "trial_id": "185f8_00000", "date": "2025-03-21_12-39-30", "timestamp": 1742560770, "time_this_iter_s": 16.76470923423767, "time_total_s": 3290.24835896492, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3290.24835896492, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 99.32727272727274, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986559867858887, "policy_loss": -0.015471293590962887, "vf_loss": 10.0, "vf_explained_var": -1.4603138254187797e-07, "kl": 0.01015609223395586, "entropy": 0.3900274932384491, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 49648.2666182518, "episode_reward_min": 49648.2666182518, "episode_reward_mean": 49648.2666182518, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49648.2666182518}, "policy_reward_max": {"agent_0": 49648.2666182518}, "policy_reward_mean": {"agent_0": 49648.2666182518}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49648.2666182518], "episode_lengths": [136], "policy_agent_0_reward": [49648.2666182518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.907270631819614, "mean_inference_ms": 6.358124891051932, "mean_action_processing_ms": 0.19149780974771752, "mean_env_wait_ms": 209.1180272866109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.3282308578491211}}, "episode_reward_max": 49648.2666182518, "episode_reward_min": 49648.2666182518, "episode_reward_mean": 49648.2666182518, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49648.2666182518}, "policy_reward_max": {"agent_0": 49648.2666182518}, "policy_reward_mean": {"agent_0": 49648.2666182518}, "hist_stats": {"episode_reward": [49648.2666182518], "episode_lengths": [136], "policy_agent_0_reward": [49648.2666182518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.907270631819614, "mean_inference_ms": 6.358124891051932, "mean_action_processing_ms": 0.19149780974771752, "mean_env_wait_ms": 209.1180272866109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04076957702636719, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.3282308578491211}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.5199677983718, "num_env_steps_trained_throughput_per_sec": 277.5199677983718, "timesteps_total": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 15946.418, "sample_time_ms": 11706.093, "learn_time_ms": 4063.645, "learn_throughput": 984.338, "synch_weights_time_ms": 175.811}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 6016, "training_iteration": 207, "trial_id": "185f8_00000", "date": "2025-03-21_12-39-44", "timestamp": 1742560784, "time_this_iter_s": 14.472705125808716, "time_total_s": 3304.7210640907288, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3304.7210640907288, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 99.59523809523812, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.76406478881836, "policy_loss": -0.015011063776910305, "vf_loss": 9.777587890625, "vf_explained_var": 1.3690441846847534e-07, "kl": 0.007437540218234062, "entropy": 0.34669923782348633, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "sampler_results": {"episode_reward_max": 57619.69987487793, "episode_reward_min": 43703.760043144226, "episode_reward_mean": 52230.237777862945, "episode_len_mean": 135.2888888888889, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 43703.760043144226}, "policy_reward_max": {"agent_0": 57619.69987487793}, "policy_reward_mean": {"agent_0": 52230.237777862945}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51296.600116729736, 50990.18040847778, 51922.72013092041, 53559.693588256836, 52955.64032745361, 51703.75330066681, 51458.20018005371, 55252.64712142944, 52992.72024726868, 51455.90692901611, 55090.43340110779, 52013.28683567047, 52240.620208740234, 54654.56007385254, 47569.11335718632, 49762.2467956543, 43703.760043144226, 49816.82004207373, 49507.953489780426, 53997.820110321045, 51117.313608169556, 52177.873653411865, 51731.31344985962, 55570.54041290283, 50714.953654289246, 56136.973487854004, 57163.48659515381, 50226.6667098999, 51369.76021194458, 55436.63360595703, 47294.30668210983, 55418.87366485596, 51367.973487854004, 52271.67348861694, 52034.33338165283, 57619.69987487793, 50423.926805496216, 47385.66008114815, 51395.76020240784, 54768.160095214844, 54551.773513793945, 47608.38663864136, 52799.60018539429, 53141.36016654968, 50125.440044403076, 51084.60007476807, 47398.94014596939, 52220.493644714355, 55714.92021179199, 51026.106830596924, 52644.78687667847, 49398.386848688126, 52861.97994995117, 56245.9469833374, 54123.6065826416, 54313.8469543457, 53920.286497592926, 57001.53339385986, 43934.43992805481, 49046.86010360718, 43813.03352355957, 55256.46020698547, 53374.00680732727, 51376.59359741211, 51720.92030334473, 53640.273445129395, 55022.220255851746, 52141.580030441284, 54503.71368408203, 54851.24002838135, 49828.72025156021, 51659.113510131836, 55567.24690246582, 52875.93351173401, 53025.373500823975, 49554.453349113464, 53747.373374938965, 51519.36015892029, 52441.60688781738, 51983.76670074463, 51675.78012275696, 54122.40705871582, 50311.29333496094, 54523.433322906494, 51993.23999786377, 48644.68684709072, 55383.1667175293, 57557.833435058594, 54426.16695213318, 51446.54675102234], "episode_lengths": [136, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 134, 136, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 136, 136, 137, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135], "policy_agent_0_reward": [51296.600116729736, 50990.18040847778, 51922.72013092041, 53559.693588256836, 52955.64032745361, 51703.75330066681, 51458.20018005371, 55252.64712142944, 52992.72024726868, 51455.90692901611, 55090.43340110779, 52013.28683567047, 52240.620208740234, 54654.56007385254, 47569.11335718632, 49762.2467956543, 43703.760043144226, 49816.82004207373, 49507.953489780426, 53997.820110321045, 51117.313608169556, 52177.873653411865, 51731.31344985962, 55570.54041290283, 50714.953654289246, 56136.973487854004, 57163.48659515381, 50226.6667098999, 51369.76021194458, 55436.63360595703, 47294.30668210983, 55418.87366485596, 51367.973487854004, 52271.67348861694, 52034.33338165283, 57619.69987487793, 50423.926805496216, 47385.66008114815, 51395.76020240784, 54768.160095214844, 54551.773513793945, 47608.38663864136, 52799.60018539429, 53141.36016654968, 50125.440044403076, 51084.60007476807, 47398.94014596939, 52220.493644714355, 55714.92021179199, 51026.106830596924, 52644.78687667847, 49398.386848688126, 52861.97994995117, 56245.9469833374, 54123.6065826416, 54313.8469543457, 53920.286497592926, 57001.53339385986, 43934.43992805481, 49046.86010360718, 43813.03352355957, 55256.46020698547, 53374.00680732727, 51376.59359741211, 51720.92030334473, 53640.273445129395, 55022.220255851746, 52141.580030441284, 54503.71368408203, 54851.24002838135, 49828.72025156021, 51659.113510131836, 55567.24690246582, 52875.93351173401, 53025.373500823975, 49554.453349113464, 53747.373374938965, 51519.36015892029, 52441.60688781738, 51983.76670074463, 51675.78012275696, 54122.40705871582, 50311.29333496094, 54523.433322906494, 51993.23999786377, 48644.68684709072, 55383.1667175293, 57557.833435058594, 54426.16695213318, 51446.54675102234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.60957733849771, "mean_inference_ms": 6.700913047300264, "mean_action_processing_ms": 0.1994898161142301, "mean_env_wait_ms": 225.8326600195758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07370021608140734, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1949498388502333}}, "episode_reward_max": 57619.69987487793, "episode_reward_min": 43703.760043144226, "episode_reward_mean": 52230.237777862945, "episode_len_mean": 135.2888888888889, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 43703.760043144226}, "policy_reward_max": {"agent_0": 57619.69987487793}, "policy_reward_mean": {"agent_0": 52230.237777862945}, "hist_stats": {"episode_reward": [51296.600116729736, 50990.18040847778, 51922.72013092041, 53559.693588256836, 52955.64032745361, 51703.75330066681, 51458.20018005371, 55252.64712142944, 52992.72024726868, 51455.90692901611, 55090.43340110779, 52013.28683567047, 52240.620208740234, 54654.56007385254, 47569.11335718632, 49762.2467956543, 43703.760043144226, 49816.82004207373, 49507.953489780426, 53997.820110321045, 51117.313608169556, 52177.873653411865, 51731.31344985962, 55570.54041290283, 50714.953654289246, 56136.973487854004, 57163.48659515381, 50226.6667098999, 51369.76021194458, 55436.63360595703, 47294.30668210983, 55418.87366485596, 51367.973487854004, 52271.67348861694, 52034.33338165283, 57619.69987487793, 50423.926805496216, 47385.66008114815, 51395.76020240784, 54768.160095214844, 54551.773513793945, 47608.38663864136, 52799.60018539429, 53141.36016654968, 50125.440044403076, 51084.60007476807, 47398.94014596939, 52220.493644714355, 55714.92021179199, 51026.106830596924, 52644.78687667847, 49398.386848688126, 52861.97994995117, 56245.9469833374, 54123.6065826416, 54313.8469543457, 53920.286497592926, 57001.53339385986, 43934.43992805481, 49046.86010360718, 43813.03352355957, 55256.46020698547, 53374.00680732727, 51376.59359741211, 51720.92030334473, 53640.273445129395, 55022.220255851746, 52141.580030441284, 54503.71368408203, 54851.24002838135, 49828.72025156021, 51659.113510131836, 55567.24690246582, 52875.93351173401, 53025.373500823975, 49554.453349113464, 53747.373374938965, 51519.36015892029, 52441.60688781738, 51983.76670074463, 51675.78012275696, 54122.40705871582, 50311.29333496094, 54523.433322906494, 51993.23999786377, 48644.68684709072, 55383.1667175293, 57557.833435058594, 54426.16695213318, 51446.54675102234], "episode_lengths": [136, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 134, 136, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 136, 136, 137, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135], "policy_agent_0_reward": [51296.600116729736, 50990.18040847778, 51922.72013092041, 53559.693588256836, 52955.64032745361, 51703.75330066681, 51458.20018005371, 55252.64712142944, 52992.72024726868, 51455.90692901611, 55090.43340110779, 52013.28683567047, 52240.620208740234, 54654.56007385254, 47569.11335718632, 49762.2467956543, 43703.760043144226, 49816.82004207373, 49507.953489780426, 53997.820110321045, 51117.313608169556, 52177.873653411865, 51731.31344985962, 55570.54041290283, 50714.953654289246, 56136.973487854004, 57163.48659515381, 50226.6667098999, 51369.76021194458, 55436.63360595703, 47294.30668210983, 55418.87366485596, 51367.973487854004, 52271.67348861694, 52034.33338165283, 57619.69987487793, 50423.926805496216, 47385.66008114815, 51395.76020240784, 54768.160095214844, 54551.773513793945, 47608.38663864136, 52799.60018539429, 53141.36016654968, 50125.440044403076, 51084.60007476807, 47398.94014596939, 52220.493644714355, 55714.92021179199, 51026.106830596924, 52644.78687667847, 49398.386848688126, 52861.97994995117, 56245.9469833374, 54123.6065826416, 54313.8469543457, 53920.286497592926, 57001.53339385986, 43934.43992805481, 49046.86010360718, 43813.03352355957, 55256.46020698547, 53374.00680732727, 51376.59359741211, 51720.92030334473, 53640.273445129395, 55022.220255851746, 52141.580030441284, 54503.71368408203, 54851.24002838135, 49828.72025156021, 51659.113510131836, 55567.24690246582, 52875.93351173401, 53025.373500823975, 49554.453349113464, 53747.373374938965, 51519.36015892029, 52441.60688781738, 51983.76670074463, 51675.78012275696, 54122.40705871582, 50311.29333496094, 54523.433322906494, 51993.23999786377, 48644.68684709072, 55383.1667175293, 57557.833435058594, 54426.16695213318, 51446.54675102234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.60957733849771, "mean_inference_ms": 6.700913047300264, "mean_action_processing_ms": 0.1994898161142301, "mean_env_wait_ms": 225.8326600195758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07370021608140734, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1949498388502333}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.64578833061464, "num_env_steps_trained_throughput_per_sec": 210.64578833061464, "timesteps_total": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 16256.209, "sample_time_ms": 11956.56, "learn_time_ms": 4125.171, "learn_throughput": 969.657, "synch_weights_time_ms": 173.601}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "episodes_total": 6106, "training_iteration": 208, "trial_id": "185f8_00000", "date": "2025-03-21_12-40-03", "timestamp": 1742560803, "time_this_iter_s": 19.0509934425354, "time_total_s": 3323.772057533264, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3323.772057533264, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 94.87407407407409, "ram_util_percent": 13.781481481481482}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981581687927246, "policy_loss": -0.015380465425550938, "vf_loss": 9.9951171875, "vf_explained_var": -2.427647594061e-08, "kl": 0.009223737753927708, "entropy": 0.35795828700065613, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "sampler_results": {"episode_reward_max": 54386.1867723465, "episode_reward_min": 50066.33993911743, "episode_reward_mean": 52226.263355731964, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 50066.33993911743}, "policy_reward_max": {"agent_0": 54386.1867723465}, "policy_reward_mean": {"agent_0": 52226.263355731964}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50066.33993911743, 54386.1867723465], "episode_lengths": [136, 136], "policy_agent_0_reward": [50066.33993911743, 54386.1867723465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.09736632801774, "mean_inference_ms": 6.793914291779901, "mean_action_processing_ms": 0.20394683115898288, "mean_env_wait_ms": 224.06691192493503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052428245544433594, "StateBufferConnector_ms": 0.005364418029785156, "ViewRequirementAgentConnector_ms": 0.14753341674804688}}, "episode_reward_max": 54386.1867723465, "episode_reward_min": 50066.33993911743, "episode_reward_mean": 52226.263355731964, "episode_len_mean": 136.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 50066.33993911743}, "policy_reward_max": {"agent_0": 54386.1867723465}, "policy_reward_mean": {"agent_0": 52226.263355731964}, "hist_stats": {"episode_reward": [50066.33993911743, 54386.1867723465], "episode_lengths": [136, 136], "policy_agent_0_reward": [50066.33993911743, 54386.1867723465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.09736632801774, "mean_inference_ms": 6.793914291779901, "mean_action_processing_ms": 0.20394683115898288, "mean_env_wait_ms": 224.06691192493503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052428245544433594, "StateBufferConnector_ms": 0.005364418029785156, "ViewRequirementAgentConnector_ms": 0.14753341674804688}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.3834525326304, "num_env_steps_trained_throughput_per_sec": 276.3834525326304, "timesteps_total": 836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 16255.717, "sample_time_ms": 11936.655, "learn_time_ms": 4146.505, "learn_throughput": 964.668, "synch_weights_time_ms": 171.664}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "done": false, "episodes_total": 6108, "training_iteration": 209, "trial_id": "185f8_00000", "date": "2025-03-21_12-40-18", "timestamp": 1742560818, "time_this_iter_s": 14.539039373397827, "time_total_s": 3338.311096906662, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3338.311096906662, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 99.50500000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.904739379882812, "policy_loss": -0.016885582357645035, "vf_loss": 9.919677734375, "vf_explained_var": 9.487072816227737e-08, "kl": 0.009732103906571865, "entropy": 0.36879628896713257, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 57311.64030456543, "episode_reward_min": 47112.053760528564, "episode_reward_mean": 52824.537433065474, "episode_len_mean": 135.125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47112.053760528564}, "policy_reward_max": {"agent_0": 57311.64030456543}, "policy_reward_mean": {"agent_0": 52824.537433065474}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53725.37989807129, 50170.36008834839, 54209.320132255554, 57311.64030456543, 54370.740074157715, 54137.33352279663, 52294.14645385742, 52210.960079193115, 50698.78680419922, 53197.32015323639, 52315.20022583008, 51981.10673522949, 51374.48694229126, 54906.11343193054, 49397.90688729286, 53511.579931259155, 51911.66011047363, 51689.940128326416, 52417.02680969238, 54453.607036590576, 52646.65334701538, 55365.20012664795, 50606.679973602295, 53159.1602935791, 56400.473388671875, 53584.613372802734, 56999.053466796875, 47112.053760528564, 51314.39350891113, 54200.18021392822, 51871.573652267456, 50840.54700374603], "episode_lengths": [136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [53725.37989807129, 50170.36008834839, 54209.320132255554, 57311.64030456543, 54370.740074157715, 54137.33352279663, 52294.14645385742, 52210.960079193115, 50698.78680419922, 53197.32015323639, 52315.20022583008, 51981.10673522949, 51374.48694229126, 54906.11343193054, 49397.90688729286, 53511.579931259155, 51911.66011047363, 51689.940128326416, 52417.02680969238, 54453.607036590576, 52646.65334701538, 55365.20012664795, 50606.679973602295, 53159.1602935791, 56400.473388671875, 53584.613372802734, 56999.053466796875, 47112.053760528564, 51314.39350891113, 54200.18021392822, 51871.573652267456, 50840.54700374603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.63214278398284, "mean_inference_ms": 6.4308931979846164, "mean_action_processing_ms": 0.20038822184495125, "mean_env_wait_ms": 209.86845737742132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04124492406845093, "StateBufferConnector_ms": 0.018781423568725586, "ViewRequirementAgentConnector_ms": 0.23077353835105896}}, "episode_reward_max": 57311.64030456543, "episode_reward_min": 47112.053760528564, "episode_reward_mean": 52824.537433065474, "episode_len_mean": 135.125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47112.053760528564}, "policy_reward_max": {"agent_0": 57311.64030456543}, "policy_reward_mean": {"agent_0": 52824.537433065474}, "hist_stats": {"episode_reward": [53725.37989807129, 50170.36008834839, 54209.320132255554, 57311.64030456543, 54370.740074157715, 54137.33352279663, 52294.14645385742, 52210.960079193115, 50698.78680419922, 53197.32015323639, 52315.20022583008, 51981.10673522949, 51374.48694229126, 54906.11343193054, 49397.90688729286, 53511.579931259155, 51911.66011047363, 51689.940128326416, 52417.02680969238, 54453.607036590576, 52646.65334701538, 55365.20012664795, 50606.679973602295, 53159.1602935791, 56400.473388671875, 53584.613372802734, 56999.053466796875, 47112.053760528564, 51314.39350891113, 54200.18021392822, 51871.573652267456, 50840.54700374603], "episode_lengths": [136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [53725.37989807129, 50170.36008834839, 54209.320132255554, 57311.64030456543, 54370.740074157715, 54137.33352279663, 52294.14645385742, 52210.960079193115, 50698.78680419922, 53197.32015323639, 52315.20022583008, 51981.10673522949, 51374.48694229126, 54906.11343193054, 49397.90688729286, 53511.579931259155, 51911.66011047363, 51689.940128326416, 52417.02680969238, 54453.607036590576, 52646.65334701538, 55365.20012664795, 50606.679973602295, 53159.1602935791, 56400.473388671875, 53584.613372802734, 56999.053466796875, 47112.053760528564, 51314.39350891113, 54200.18021392822, 51871.573652267456, 50840.54700374603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.63214278398284, "mean_inference_ms": 6.4308931979846164, "mean_action_processing_ms": 0.20038822184495125, "mean_env_wait_ms": 209.86845737742132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04124492406845093, "StateBufferConnector_ms": 0.018781423568725586, "ViewRequirementAgentConnector_ms": 0.23077353835105896}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.49221584471104, "num_env_steps_trained_throughput_per_sec": 241.49221584471104, "timesteps_total": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 15863.733, "sample_time_ms": 11634.227, "learn_time_ms": 4056.276, "learn_throughput": 986.126, "synch_weights_time_ms": 172.361}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 6140, "training_iteration": 210, "trial_id": "185f8_00000", "date": "2025-03-21_12-40-35", "timestamp": 1742560835, "time_this_iter_s": 16.620368480682373, "time_total_s": 3354.9314653873444, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3354.9314653873444, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 99.30833333333334, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985868453979492, "policy_loss": -0.016034146770834923, "vf_loss": 10.0, "vf_explained_var": -2.0551185642148084e-08, "kl": 0.009512271732091904, "entropy": 0.37449944019317627, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "sampler_results": {"episode_reward_max": 50840.54700374603, "episode_reward_min": 50840.54700374603, "episode_reward_mean": 50840.54700374603, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50840.54700374603}, "policy_reward_max": {"agent_0": 50840.54700374603}, "policy_reward_mean": {"agent_0": 50840.54700374603}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50840.54700374603], "episode_lengths": [135], "policy_agent_0_reward": [50840.54700374603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.491062609840824, "mean_inference_ms": 6.342126081007381, "mean_action_processing_ms": 0.19141792167473143, "mean_env_wait_ms": 208.30304628497956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032639503479003906, "StateBufferConnector_ms": 0.005364418029785156, "ViewRequirementAgentConnector_ms": 0.14693737030029297}}, "episode_reward_max": 50840.54700374603, "episode_reward_min": 50840.54700374603, "episode_reward_mean": 50840.54700374603, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50840.54700374603}, "policy_reward_max": {"agent_0": 50840.54700374603}, "policy_reward_mean": {"agent_0": 50840.54700374603}, "hist_stats": {"episode_reward": [50840.54700374603], "episode_lengths": [135], "policy_agent_0_reward": [50840.54700374603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.491062609840824, "mean_inference_ms": 6.342126081007381, "mean_action_processing_ms": 0.19141792167473143, "mean_env_wait_ms": 208.30304628497956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032639503479003906, "StateBufferConnector_ms": 0.005364418029785156, "ViewRequirementAgentConnector_ms": 0.14693737030029297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.2087083916935, "num_env_steps_trained_throughput_per_sec": 295.2087083916935, "timesteps_total": 844000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 15843.63, "sample_time_ms": 11629.702, "learn_time_ms": 4038.611, "learn_throughput": 990.44, "synch_weights_time_ms": 174.458}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "done": false, "episodes_total": 6140, "training_iteration": 211, "trial_id": "185f8_00000", "date": "2025-03-21_12-40-48", "timestamp": 1742560848, "time_this_iter_s": 13.60366940498352, "time_total_s": 3368.535134792328, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3368.535134792328, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 99.56315789473685, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.857563972473145, "policy_loss": -0.013251016847789288, "vf_loss": 9.86865234375, "vf_explained_var": 1.148631199043848e-07, "kl": 0.010814118199050426, "entropy": 0.4267817735671997, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "sampler_results": {"episode_reward_max": 58266.16022109985, "episode_reward_min": 47052.146699905396, "episode_reward_mean": 53006.87461302191, "episode_len_mean": 135.1320754716981, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {"agent_0": 47052.146699905396}, "policy_reward_max": {"agent_0": 58266.16022109985}, "policy_reward_mean": {"agent_0": 53006.87461302191}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50471.48025512695, 47052.146699905396, 51600.06005477905, 54547.99997937679, 55137.340072631836, 53165.667055130005, 49085.320160865784, 55764.0468044281, 51338.48705291748, 52139.28019475937, 48378.159954071045, 53344.38006591797, 52687.013580322266, 52308.54660606384, 50363.540212631226, 56613.36680603027, 47919.166818618774, 49005.0200920105, 56587.467140197754, 51953.38669157028, 55830.62003707886, 55365.82016372681, 54663.9335975647, 51339.23999786377, 55186.95372772217, 50777.5532951355, 52414.53335094452, 53614.71356964111, 53464.046491622925, 55513.22687339783, 50352.106660842896, 55126.71336364746, 58266.16022109985, 54445.82689666748, 49906.21367120743, 49261.240186691284, 52153.013469696045, 54538.573554992676, 56748.20021057129, 54697.446922302246, 56523.99339103699, 55683.97332763672, 55103.81350708008, 51123.766733169556, 53378.0735168457, 55806.72685146332, 49916.52010726929, 58204.7336730957, 56705.353591918945, 54234.7466545105, 51619.72679710388, 48041.00005912781, 49893.91372013092], "episode_lengths": [135, 137, 135, 135, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [50471.48025512695, 47052.146699905396, 51600.06005477905, 54547.99997937679, 55137.340072631836, 53165.667055130005, 49085.320160865784, 55764.0468044281, 51338.48705291748, 52139.28019475937, 48378.159954071045, 53344.38006591797, 52687.013580322266, 52308.54660606384, 50363.540212631226, 56613.36680603027, 47919.166818618774, 49005.0200920105, 56587.467140197754, 51953.38669157028, 55830.62003707886, 55365.82016372681, 54663.9335975647, 51339.23999786377, 55186.95372772217, 50777.5532951355, 52414.53335094452, 53614.71356964111, 53464.046491622925, 55513.22687339783, 50352.106660842896, 55126.71336364746, 58266.16022109985, 54445.82689666748, 49906.21367120743, 49261.240186691284, 52153.013469696045, 54538.573554992676, 56748.20021057129, 54697.446922302246, 56523.99339103699, 55683.97332763672, 55103.81350708008, 51123.766733169556, 53378.0735168457, 55806.72685146332, 49916.52010726929, 58204.7336730957, 56705.353591918945, 54234.7466545105, 51619.72679710388, 48041.00005912781, 49893.91372013092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.43817321368511, "mean_inference_ms": 6.693708076338617, "mean_action_processing_ms": 0.2003988728580472, "mean_env_wait_ms": 226.05468460838617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03890451395286704, "StateBufferConnector_ms": 0.0058614982748931305, "ViewRequirementAgentConnector_ms": 0.2117660810362618}}, "episode_reward_max": 58266.16022109985, "episode_reward_min": 47052.146699905396, "episode_reward_mean": 53006.87461302191, "episode_len_mean": 135.1320754716981, "episodes_this_iter": 53, "policy_reward_min": {"agent_0": 47052.146699905396}, "policy_reward_max": {"agent_0": 58266.16022109985}, "policy_reward_mean": {"agent_0": 53006.87461302191}, "hist_stats": {"episode_reward": [50471.48025512695, 47052.146699905396, 51600.06005477905, 54547.99997937679, 55137.340072631836, 53165.667055130005, 49085.320160865784, 55764.0468044281, 51338.48705291748, 52139.28019475937, 48378.159954071045, 53344.38006591797, 52687.013580322266, 52308.54660606384, 50363.540212631226, 56613.36680603027, 47919.166818618774, 49005.0200920105, 56587.467140197754, 51953.38669157028, 55830.62003707886, 55365.82016372681, 54663.9335975647, 51339.23999786377, 55186.95372772217, 50777.5532951355, 52414.53335094452, 53614.71356964111, 53464.046491622925, 55513.22687339783, 50352.106660842896, 55126.71336364746, 58266.16022109985, 54445.82689666748, 49906.21367120743, 49261.240186691284, 52153.013469696045, 54538.573554992676, 56748.20021057129, 54697.446922302246, 56523.99339103699, 55683.97332763672, 55103.81350708008, 51123.766733169556, 53378.0735168457, 55806.72685146332, 49916.52010726929, 58204.7336730957, 56705.353591918945, 54234.7466545105, 51619.72679710388, 48041.00005912781, 49893.91372013092], "episode_lengths": [135, 137, 135, 135, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [50471.48025512695, 47052.146699905396, 51600.06005477905, 54547.99997937679, 55137.340072631836, 53165.667055130005, 49085.320160865784, 55764.0468044281, 51338.48705291748, 52139.28019475937, 48378.159954071045, 53344.38006591797, 52687.013580322266, 52308.54660606384, 50363.540212631226, 56613.36680603027, 47919.166818618774, 49005.0200920105, 56587.467140197754, 51953.38669157028, 55830.62003707886, 55365.82016372681, 54663.9335975647, 51339.23999786377, 55186.95372772217, 50777.5532951355, 52414.53335094452, 53614.71356964111, 53464.046491622925, 55513.22687339783, 50352.106660842896, 55126.71336364746, 58266.16022109985, 54445.82689666748, 49906.21367120743, 49261.240186691284, 52153.013469696045, 54538.573554992676, 56748.20021057129, 54697.446922302246, 56523.99339103699, 55683.97332763672, 55103.81350708008, 51123.766733169556, 53378.0735168457, 55806.72685146332, 49916.52010726929, 58204.7336730957, 56705.353591918945, 54234.7466545105, 51619.72679710388, 48041.00005912781, 49893.91372013092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.43817321368511, "mean_inference_ms": 6.693708076338617, "mean_action_processing_ms": 0.2003988728580472, "mean_env_wait_ms": 226.05468460838617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03890451395286704, "StateBufferConnector_ms": 0.0058614982748931305, "ViewRequirementAgentConnector_ms": 0.2117660810362618}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.6294442090249, "num_env_steps_trained_throughput_per_sec": 259.6294442090249, "timesteps_total": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 15739.583, "sample_time_ms": 11577.019, "learn_time_ms": 3995.704, "learn_throughput": 1001.075, "synch_weights_time_ms": 166.015}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "episodes_total": 6193, "training_iteration": 212, "trial_id": "185f8_00000", "date": "2025-03-21_12-41-04", "timestamp": 1742560864, "time_this_iter_s": 15.453351020812988, "time_total_s": 3383.988485813141, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde4310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3383.988485813141, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 97.47727272727273, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.897435897435898, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.887284278869629, "policy_loss": -0.015517023392021656, "vf_loss": 9.900850296020508, "vf_explained_var": -1.2431294180714758e-06, "kl": 0.009754707105457783, "entropy": 0.40884533524513245, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 55915.04024505615, "episode_reward_min": 46939.52018737793, "episode_reward_mean": 52257.09638703175, "episode_len_mean": 135.25641025641025, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {"agent_0": 46939.52018737793}, "policy_reward_max": {"agent_0": 55915.04024505615}, "policy_reward_mean": {"agent_0": 52257.09638703175}, "custom_metrics": {"num_batches_mean": 5.897435897435898, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51861.26678466797, 54831.51345825195, 55264.940086364746, 53308.12666606903, 52735.19332122803, 50065.16015505791, 53609.380126953125, 51408.50670814514, 54764.133586883545, 52507.24017715454, 54066.23355484009, 53971.546646118164, 55008.093687057495, 47537.566710829735, 53483.520082473755, 52282.393505096436, 55915.04024505615, 55872.093584775925, 53856.24003601074, 53433.88039302826, 47777.813349723816, 53722.20692443848, 49793.78013420105, 55390.493423461914, 54737.90675354004, 51749.83366775513, 48019.59354972839, 47772.84021997452, 48290.34004116058, 54628.24671936035, 54231.28053665161, 52403.00001335144, 51149.89335346222, 51778.65348815918, 51415.04669189453, 51607.647013783455, 46939.52018737793, 49363.52004480362, 51473.07346534729], "episode_lengths": [135, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 136, 134, 135, 136, 136, 137, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [51861.26678466797, 54831.51345825195, 55264.940086364746, 53308.12666606903, 52735.19332122803, 50065.16015505791, 53609.380126953125, 51408.50670814514, 54764.133586883545, 52507.24017715454, 54066.23355484009, 53971.546646118164, 55008.093687057495, 47537.566710829735, 53483.520082473755, 52282.393505096436, 55915.04024505615, 55872.093584775925, 53856.24003601074, 53433.88039302826, 47777.813349723816, 53722.20692443848, 49793.78013420105, 55390.493423461914, 54737.90675354004, 51749.83366775513, 48019.59354972839, 47772.84021997452, 48290.34004116058, 54628.24671936035, 54231.28053665161, 52403.00001335144, 51149.89335346222, 51778.65348815918, 51415.04669189453, 51607.647013783455, 46939.52018737793, 49363.52004480362, 51473.07346534729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.1922004354256, "mean_inference_ms": 6.71580103754839, "mean_action_processing_ms": 0.1984782689613025, "mean_env_wait_ms": 225.06453131801493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0414891120715019, "StateBufferConnector_ms": 0.006193381089430589, "ViewRequirementAgentConnector_ms": 0.20072643573467547}}, "episode_reward_max": 55915.04024505615, "episode_reward_min": 46939.52018737793, "episode_reward_mean": 52257.09638703175, "episode_len_mean": 135.25641025641025, "episodes_this_iter": 39, "policy_reward_min": {"agent_0": 46939.52018737793}, "policy_reward_max": {"agent_0": 55915.04024505615}, "policy_reward_mean": {"agent_0": 52257.09638703175}, "hist_stats": {"episode_reward": [51861.26678466797, 54831.51345825195, 55264.940086364746, 53308.12666606903, 52735.19332122803, 50065.16015505791, 53609.380126953125, 51408.50670814514, 54764.133586883545, 52507.24017715454, 54066.23355484009, 53971.546646118164, 55008.093687057495, 47537.566710829735, 53483.520082473755, 52282.393505096436, 55915.04024505615, 55872.093584775925, 53856.24003601074, 53433.88039302826, 47777.813349723816, 53722.20692443848, 49793.78013420105, 55390.493423461914, 54737.90675354004, 51749.83366775513, 48019.59354972839, 47772.84021997452, 48290.34004116058, 54628.24671936035, 54231.28053665161, 52403.00001335144, 51149.89335346222, 51778.65348815918, 51415.04669189453, 51607.647013783455, 46939.52018737793, 49363.52004480362, 51473.07346534729], "episode_lengths": [135, 135, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 136, 134, 135, 136, 136, 137, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [51861.26678466797, 54831.51345825195, 55264.940086364746, 53308.12666606903, 52735.19332122803, 50065.16015505791, 53609.380126953125, 51408.50670814514, 54764.133586883545, 52507.24017715454, 54066.23355484009, 53971.546646118164, 55008.093687057495, 47537.566710829735, 53483.520082473755, 52282.393505096436, 55915.04024505615, 55872.093584775925, 53856.24003601074, 53433.88039302826, 47777.813349723816, 53722.20692443848, 49793.78013420105, 55390.493423461914, 54737.90675354004, 51749.83366775513, 48019.59354972839, 47772.84021997452, 48290.34004116058, 54628.24671936035, 54231.28053665161, 52403.00001335144, 51149.89335346222, 51778.65348815918, 51415.04669189453, 51607.647013783455, 46939.52018737793, 49363.52004480362, 51473.07346534729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.1922004354256, "mean_inference_ms": 6.71580103754839, "mean_action_processing_ms": 0.1984782689613025, "mean_env_wait_ms": 225.06453131801493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0414891120715019, "StateBufferConnector_ms": 0.006193381089430589, "ViewRequirementAgentConnector_ms": 0.20072643573467547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.7649107824848, "num_env_steps_trained_throughput_per_sec": 207.7649107824848, "timesteps_total": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 16293.024, "sample_time_ms": 12053.021, "learn_time_ms": 4071.725, "learn_throughput": 982.385, "synch_weights_time_ms": 167.435}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 6232, "training_iteration": 213, "trial_id": "185f8_00000", "date": "2025-03-21_12-41-23", "timestamp": 1742560883, "time_this_iter_s": 19.301193714141846, "time_total_s": 3403.2896795272827, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde6200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3403.2896795272827, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 99.06296296296296, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906435012817383, "policy_loss": -0.014779270626604557, "vf_loss": 9.919193267822266, "vf_explained_var": -4.6460579028462234e-07, "kl": 0.01009881217032671, "entropy": 0.41853660345077515, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "sampler_results": {"episode_reward_max": 57349.566665649414, "episode_reward_min": 44864.98674464226, "episode_reward_mean": 51607.01033784449, "episode_len_mean": 135.40625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44864.98674464226}, "policy_reward_max": {"agent_0": 57349.566665649414}, "policy_reward_mean": {"agent_0": 51607.01033784449}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48574.48713684082, 49106.62020301819, 54716.31992340088, 51606.11365890503, 56071.87348175049, 53188.993498802185, 46933.9402756691, 52631.08669471741, 48467.36010360718, 44864.98674464226, 48099.30007815361, 46248.79349517822, 51839.040254592896, 52465.10679626465, 45038.50011444092, 53982.013275146484, 57349.566665649414, 51393.24677991867, 48121.246700286865, 52824.13362121582, 53589.1802148819, 53966.460105895996, 53238.85995864868, 56627.98700904846, 51665.20692062378, 53813.360023498535, 54038.1469078064, 52523.06657409668, 49791.74001789093, 51190.60017204285, 53759.2599067688, 53697.73349761963], "episode_lengths": [135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 137, 135, 135, 136], "policy_agent_0_reward": [48574.48713684082, 49106.62020301819, 54716.31992340088, 51606.11365890503, 56071.87348175049, 53188.993498802185, 46933.9402756691, 52631.08669471741, 48467.36010360718, 44864.98674464226, 48099.30007815361, 46248.79349517822, 51839.040254592896, 52465.10679626465, 45038.50011444092, 53982.013275146484, 57349.566665649414, 51393.24677991867, 48121.246700286865, 52824.13362121582, 53589.1802148819, 53966.460105895996, 53238.85995864868, 56627.98700904846, 51665.20692062378, 53813.360023498535, 54038.1469078064, 52523.06657409668, 49791.74001789093, 51190.60017204285, 53759.2599067688, 53697.73349761963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.457350987441544, "mean_inference_ms": 6.429417429877698, "mean_action_processing_ms": 0.20049901424142233, "mean_env_wait_ms": 210.35885845768405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14452189207077026, "StateBufferConnector_ms": 0.006112456321716309, "ViewRequirementAgentConnector_ms": 0.21493583917617798}}, "episode_reward_max": 57349.566665649414, "episode_reward_min": 44864.98674464226, "episode_reward_mean": 51607.01033784449, "episode_len_mean": 135.40625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 44864.98674464226}, "policy_reward_max": {"agent_0": 57349.566665649414}, "policy_reward_mean": {"agent_0": 51607.01033784449}, "hist_stats": {"episode_reward": [48574.48713684082, 49106.62020301819, 54716.31992340088, 51606.11365890503, 56071.87348175049, 53188.993498802185, 46933.9402756691, 52631.08669471741, 48467.36010360718, 44864.98674464226, 48099.30007815361, 46248.79349517822, 51839.040254592896, 52465.10679626465, 45038.50011444092, 53982.013275146484, 57349.566665649414, 51393.24677991867, 48121.246700286865, 52824.13362121582, 53589.1802148819, 53966.460105895996, 53238.85995864868, 56627.98700904846, 51665.20692062378, 53813.360023498535, 54038.1469078064, 52523.06657409668, 49791.74001789093, 51190.60017204285, 53759.2599067688, 53697.73349761963], "episode_lengths": [135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 137, 135, 135, 136], "policy_agent_0_reward": [48574.48713684082, 49106.62020301819, 54716.31992340088, 51606.11365890503, 56071.87348175049, 53188.993498802185, 46933.9402756691, 52631.08669471741, 48467.36010360718, 44864.98674464226, 48099.30007815361, 46248.79349517822, 51839.040254592896, 52465.10679626465, 45038.50011444092, 53982.013275146484, 57349.566665649414, 51393.24677991867, 48121.246700286865, 52824.13362121582, 53589.1802148819, 53966.460105895996, 53238.85995864868, 56627.98700904846, 51665.20692062378, 53813.360023498535, 54038.1469078064, 52523.06657409668, 49791.74001789093, 51190.60017204285, 53759.2599067688, 53697.73349761963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.457350987441544, "mean_inference_ms": 6.429417429877698, "mean_action_processing_ms": 0.20049901424142233, "mean_env_wait_ms": 210.35885845768405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14452189207077026, "StateBufferConnector_ms": 0.006112456321716309, "ViewRequirementAgentConnector_ms": 0.21493583917617798}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.9682992839141, "num_env_steps_trained_throughput_per_sec": 250.9682992839141, "timesteps_total": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 15891.952, "sample_time_ms": 11674.537, "learn_time_ms": 4061.126, "learn_throughput": 984.949, "synch_weights_time_ms": 155.418}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "episodes_total": 6264, "training_iteration": 214, "trial_id": "185f8_00000", "date": "2025-03-21_12-41-39", "timestamp": 1742560899, "time_this_iter_s": 16.0105562210083, "time_total_s": 3419.300235748291, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5b40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3419.300235748291, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 99.37391304347828, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98630142211914, "policy_loss": -0.015445458702743053, "vf_loss": 10.0, "vf_explained_var": -2.086162531611535e-08, "kl": 0.008731739595532417, "entropy": 0.39075133204460144, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "sampler_results": {"episode_reward_max": 53697.73349761963, "episode_reward_min": 53697.73349761963, "episode_reward_mean": 53697.73349761963, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53697.73349761963}, "policy_reward_max": {"agent_0": 53697.73349761963}, "policy_reward_mean": {"agent_0": 53697.73349761963}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53697.73349761963], "episode_lengths": [136], "policy_agent_0_reward": [53697.73349761963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.308727469640736, "mean_inference_ms": 6.351538054179862, "mean_action_processing_ms": 0.1913998901008564, "mean_env_wait_ms": 208.90634468015963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059223175048828125, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.1836538314819336}}, "episode_reward_max": 53697.73349761963, "episode_reward_min": 53697.73349761963, "episode_reward_mean": 53697.73349761963, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53697.73349761963}, "policy_reward_max": {"agent_0": 53697.73349761963}, "policy_reward_mean": {"agent_0": 53697.73349761963}, "hist_stats": {"episode_reward": [53697.73349761963], "episode_lengths": [136], "policy_agent_0_reward": [53697.73349761963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.308727469640736, "mean_inference_ms": 6.351538054179862, "mean_action_processing_ms": 0.1913998901008564, "mean_env_wait_ms": 208.90634468015963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059223175048828125, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.1836538314819336}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.0036603269737, "num_env_steps_trained_throughput_per_sec": 283.0036603269737, "timesteps_total": 860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 15941.936, "sample_time_ms": 11652.301, "learn_time_ms": 4143.728, "learn_throughput": 965.314, "synch_weights_time_ms": 145.065}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "done": false, "episodes_total": 6264, "training_iteration": 215, "trial_id": "185f8_00000", "date": "2025-03-21_12-41-53", "timestamp": 1742560913, "time_this_iter_s": 14.201788663864136, "time_total_s": 3433.502024412155, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd78f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3433.502024412155, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 99.60499999999999, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.976218223571777, "policy_loss": -0.015233169309794903, "vf_loss": 9.989824295043945, "vf_explained_var": -3.6930043734173523e-06, "kl": 0.008138386532664299, "entropy": 0.3584037721157074, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 54575.9204788208, "episode_reward_min": 51656.63994216919, "episode_reward_mean": 53358.21131451925, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 51656.63994216919}, "policy_reward_max": {"agent_0": 54575.9204788208}, "policy_reward_mean": {"agent_0": 53358.21131451925}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51656.63994216919, 54575.9204788208, 53842.07352256775], "episode_lengths": [135, 135, 135], "policy_agent_0_reward": [51656.63994216919, 54575.9204788208, 53842.07352256775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.7740174732257, "mean_inference_ms": 6.44576652420539, "mean_action_processing_ms": 0.198992096852978, "mean_env_wait_ms": 223.33352994226755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11028448740641277, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.37255287170410156}}, "episode_reward_max": 54575.9204788208, "episode_reward_min": 51656.63994216919, "episode_reward_mean": 53358.21131451925, "episode_len_mean": 135.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 51656.63994216919}, "policy_reward_max": {"agent_0": 54575.9204788208}, "policy_reward_mean": {"agent_0": 53358.21131451925}, "hist_stats": {"episode_reward": [51656.63994216919, 54575.9204788208, 53842.07352256775], "episode_lengths": [135, 135, 135], "policy_agent_0_reward": [51656.63994216919, 54575.9204788208, 53842.07352256775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.7740174732257, "mean_inference_ms": 6.44576652420539, "mean_action_processing_ms": 0.198992096852978, "mean_env_wait_ms": 223.33352994226755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11028448740641277, "StateBufferConnector_ms": 0.0063737233479817705, "ViewRequirementAgentConnector_ms": 0.37255287170410156}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.4342839523865, "num_env_steps_trained_throughput_per_sec": 291.4342839523865, "timesteps_total": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 15644.477, "sample_time_ms": 11404.399, "learn_time_ms": 4096.341, "learn_throughput": 976.481, "synch_weights_time_ms": 142.888}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 6267, "training_iteration": 216, "trial_id": "185f8_00000", "date": "2025-03-21_12-42-07", "timestamp": 1742560927, "time_this_iter_s": 13.787027597427368, "time_total_s": 3447.2890520095825, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3447.2890520095825, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 99.29473684210527, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.48314606741573, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.76170539855957, "policy_loss": -0.018654821440577507, "vf_loss": 9.77785873413086, "vf_explained_var": -1.3497968609499367e-07, "kl": 0.012513414956629276, "entropy": 0.3916400074958801, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "sampler_results": {"episode_reward_max": 58763.573486328125, "episode_reward_min": 42450.253418922424, "episode_reward_mean": 52088.28412882666, "episode_len_mean": 135.31460674157304, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 42450.253418922424}, "policy_reward_max": {"agent_0": 58763.573486328125}, "policy_reward_mean": {"agent_0": 52088.28412882666}, "custom_metrics": {"num_batches_mean": 5.48314606741573, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54506.373611450195, 53187.553482055664, 50091.42009925842, 46830.10018777847, 48422.4867811203, 54127.440465927124, 49283.96679401398, 53657.10007095337, 52375.620098114014, 51281.84014129639, 53477.9399433136, 49988.24020957947, 52849.25334739685, 54332.54027748108, 49100.38035726547, 55052.233489990234, 53581.66697692871, 47483.846883773804, 53089.96006774902, 52073.82007408142, 49996.206787109375, 46607.27356338501, 53856.926834106445, 50704.666942596436, 54513.40037918091, 52166.086921691895, 50327.70012664795, 53237.580224990845, 55801.386947631836, 49259.11363220215, 53345.41343307495, 51127.1067199707, 48988.693479537964, 55910.966720581055, 58763.573486328125, 46667.83340072632, 50155.000131607056, 56781.866470336914, 42450.253418922424, 48955.01996040344, 50770.86692047119, 50800.63331794739, 51394.226791381836, 45341.34679603577, 48836.11991882324, 51885.1335105896, 52709.61344265938, 52668.69337463379, 54253.07348203659, 50591.500069856644, 54276.48692321777, 55434.873626708984, 55946.72675323486, 54206.260150909424, 50353.24677276611, 47418.133502960205, 45637.81344985962, 54778.70703125, 56127.98706817627, 50436.16026306152, 55081.40012741089, 49285.3202457428, 55416.71348571777, 52652.59367752075, 53994.04012572765, 53155.46697425842, 48451.14012479782, 52783.8601808548, 54730.959897994995, 50143.32696914673, 53932.020080566406, 51601.900047302246, 55504.93339538574, 47528.77338218689, 54234.27988052368, 53288.87332725525, 56826.373359680176, 55943.98729324341, 52619.84030914307, 52546.793380737305, 47015.2867641449, 52252.54676246643, 58535.33348083496, 54389.913650512695, 48509.01360619068, 52203.14039993286, 54621.39345359802, 55298.28025817871, 55032.32671737671], "episode_lengths": [135, 135, 135, 136, 135, 134, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 134, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 134, 135], "policy_agent_0_reward": [54506.373611450195, 53187.553482055664, 50091.42009925842, 46830.10018777847, 48422.4867811203, 54127.440465927124, 49283.96679401398, 53657.10007095337, 52375.620098114014, 51281.84014129639, 53477.9399433136, 49988.24020957947, 52849.25334739685, 54332.54027748108, 49100.38035726547, 55052.233489990234, 53581.66697692871, 47483.846883773804, 53089.96006774902, 52073.82007408142, 49996.206787109375, 46607.27356338501, 53856.926834106445, 50704.666942596436, 54513.40037918091, 52166.086921691895, 50327.70012664795, 53237.580224990845, 55801.386947631836, 49259.11363220215, 53345.41343307495, 51127.1067199707, 48988.693479537964, 55910.966720581055, 58763.573486328125, 46667.83340072632, 50155.000131607056, 56781.866470336914, 42450.253418922424, 48955.01996040344, 50770.86692047119, 50800.63331794739, 51394.226791381836, 45341.34679603577, 48836.11991882324, 51885.1335105896, 52709.61344265938, 52668.69337463379, 54253.07348203659, 50591.500069856644, 54276.48692321777, 55434.873626708984, 55946.72675323486, 54206.260150909424, 50353.24677276611, 47418.133502960205, 45637.81344985962, 54778.70703125, 56127.98706817627, 50436.16026306152, 55081.40012741089, 49285.3202457428, 55416.71348571777, 52652.59367752075, 53994.04012572765, 53155.46697425842, 48451.14012479782, 52783.8601808548, 54730.959897994995, 50143.32696914673, 53932.020080566406, 51601.900047302246, 55504.93339538574, 47528.77338218689, 54234.27988052368, 53288.87332725525, 56826.373359680176, 55943.98729324341, 52619.84030914307, 52546.793380737305, 47015.2867641449, 52252.54676246643, 58535.33348083496, 54389.913650512695, 48509.01360619068, 52203.14039993286, 54621.39345359802, 55298.28025817871, 55032.32671737671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.75106969841968, "mean_inference_ms": 6.708423881948271, "mean_action_processing_ms": 0.19947390390820832, "mean_env_wait_ms": 225.76072114260387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04268924841720067, "StateBufferConnector_ms": 0.00646462601222349, "ViewRequirementAgentConnector_ms": 0.24978364451547688}}, "episode_reward_max": 58763.573486328125, "episode_reward_min": 42450.253418922424, "episode_reward_mean": 52088.28412882666, "episode_len_mean": 135.31460674157304, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 42450.253418922424}, "policy_reward_max": {"agent_0": 58763.573486328125}, "policy_reward_mean": {"agent_0": 52088.28412882666}, "hist_stats": {"episode_reward": [54506.373611450195, 53187.553482055664, 50091.42009925842, 46830.10018777847, 48422.4867811203, 54127.440465927124, 49283.96679401398, 53657.10007095337, 52375.620098114014, 51281.84014129639, 53477.9399433136, 49988.24020957947, 52849.25334739685, 54332.54027748108, 49100.38035726547, 55052.233489990234, 53581.66697692871, 47483.846883773804, 53089.96006774902, 52073.82007408142, 49996.206787109375, 46607.27356338501, 53856.926834106445, 50704.666942596436, 54513.40037918091, 52166.086921691895, 50327.70012664795, 53237.580224990845, 55801.386947631836, 49259.11363220215, 53345.41343307495, 51127.1067199707, 48988.693479537964, 55910.966720581055, 58763.573486328125, 46667.83340072632, 50155.000131607056, 56781.866470336914, 42450.253418922424, 48955.01996040344, 50770.86692047119, 50800.63331794739, 51394.226791381836, 45341.34679603577, 48836.11991882324, 51885.1335105896, 52709.61344265938, 52668.69337463379, 54253.07348203659, 50591.500069856644, 54276.48692321777, 55434.873626708984, 55946.72675323486, 54206.260150909424, 50353.24677276611, 47418.133502960205, 45637.81344985962, 54778.70703125, 56127.98706817627, 50436.16026306152, 55081.40012741089, 49285.3202457428, 55416.71348571777, 52652.59367752075, 53994.04012572765, 53155.46697425842, 48451.14012479782, 52783.8601808548, 54730.959897994995, 50143.32696914673, 53932.020080566406, 51601.900047302246, 55504.93339538574, 47528.77338218689, 54234.27988052368, 53288.87332725525, 56826.373359680176, 55943.98729324341, 52619.84030914307, 52546.793380737305, 47015.2867641449, 52252.54676246643, 58535.33348083496, 54389.913650512695, 48509.01360619068, 52203.14039993286, 54621.39345359802, 55298.28025817871, 55032.32671737671], "episode_lengths": [135, 135, 135, 136, 135, 134, 136, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 134, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 136, 136, 135, 135, 134, 135], "policy_agent_0_reward": [54506.373611450195, 53187.553482055664, 50091.42009925842, 46830.10018777847, 48422.4867811203, 54127.440465927124, 49283.96679401398, 53657.10007095337, 52375.620098114014, 51281.84014129639, 53477.9399433136, 49988.24020957947, 52849.25334739685, 54332.54027748108, 49100.38035726547, 55052.233489990234, 53581.66697692871, 47483.846883773804, 53089.96006774902, 52073.82007408142, 49996.206787109375, 46607.27356338501, 53856.926834106445, 50704.666942596436, 54513.40037918091, 52166.086921691895, 50327.70012664795, 53237.580224990845, 55801.386947631836, 49259.11363220215, 53345.41343307495, 51127.1067199707, 48988.693479537964, 55910.966720581055, 58763.573486328125, 46667.83340072632, 50155.000131607056, 56781.866470336914, 42450.253418922424, 48955.01996040344, 50770.86692047119, 50800.63331794739, 51394.226791381836, 45341.34679603577, 48836.11991882324, 51885.1335105896, 52709.61344265938, 52668.69337463379, 54253.07348203659, 50591.500069856644, 54276.48692321777, 55434.873626708984, 55946.72675323486, 54206.260150909424, 50353.24677276611, 47418.133502960205, 45637.81344985962, 54778.70703125, 56127.98706817627, 50436.16026306152, 55081.40012741089, 49285.3202457428, 55416.71348571777, 52652.59367752075, 53994.04012572765, 53155.46697425842, 48451.14012479782, 52783.8601808548, 54730.959897994995, 50143.32696914673, 53932.020080566406, 51601.900047302246, 55504.93339538574, 47528.77338218689, 54234.27988052368, 53288.87332725525, 56826.373359680176, 55943.98729324341, 52619.84030914307, 52546.793380737305, 47015.2867641449, 52252.54676246643, 58535.33348083496, 54389.913650512695, 48509.01360619068, 52203.14039993286, 54621.39345359802, 55298.28025817871, 55032.32671737671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.75106969841968, "mean_inference_ms": 6.708423881948271, "mean_action_processing_ms": 0.19947390390820832, "mean_env_wait_ms": 225.76072114260387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04268924841720067, "StateBufferConnector_ms": 0.00646462601222349, "ViewRequirementAgentConnector_ms": 0.24978364451547688}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.9540915164231, "num_env_steps_trained_throughput_per_sec": 198.9540915164231, "timesteps_total": 868000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 16213.654, "sample_time_ms": 11921.678, "learn_time_ms": 4143.963, "learn_throughput": 965.26, "synch_weights_time_ms": 147.136}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "done": false, "episodes_total": 6356, "training_iteration": 217, "trial_id": "185f8_00000", "date": "2025-03-21_12-42-27", "timestamp": 1742560947, "time_this_iter_s": 20.16356921195984, "time_total_s": 3467.4526212215424, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3467.4526212215424, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 95.98620689655175, "ram_util_percent": 13.789655172413797}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.919658660888672, "policy_loss": -0.016977282240986824, "vf_loss": 9.934571266174316, "vf_explained_var": 2.1227945978807838e-07, "kl": 0.010319608263671398, "entropy": 0.41633349657058716, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "sampler_results": {"episode_reward_max": 57767.06701660156, "episode_reward_min": 47955.94670295715, "episode_reward_mean": 53135.1508951233, "episode_len_mean": 135.26923076923077, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 47955.94670295715}, "policy_reward_max": {"agent_0": 57767.06701660156}, "policy_reward_mean": {"agent_0": 53135.1508951233}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55573.36025238037, 53801.30023956299, 47955.94670295715, 52370.12009048462, 50600.13996505737, 49132.2600774765, 53210.82670211792, 51608.36005115509, 52002.63335418701, 56670.433404922485, 50819.76668167114, 53245.98681640625, 57767.06701660156, 53526.50651931763, 54451.8069229126, 54805.439865112305, 54392.48682594299, 49849.0134305954, 51665.32001495361, 57210.45364379883, 51011.68015956879, 50973.16687965393, 56259.773498535156, 55162.68697166443, 54095.24684727192, 53352.140338897705], "episode_lengths": [134, 135, 136, 134, 136, 135, 136, 136, 135, 136, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 137, 136, 135, 135, 136, 135], "policy_agent_0_reward": [55573.36025238037, 53801.30023956299, 47955.94670295715, 52370.12009048462, 50600.13996505737, 49132.2600774765, 53210.82670211792, 51608.36005115509, 52002.63335418701, 56670.433404922485, 50819.76668167114, 53245.98681640625, 57767.06701660156, 53526.50651931763, 54451.8069229126, 54805.439865112305, 54392.48682594299, 49849.0134305954, 51665.32001495361, 57210.45364379883, 51011.68015956879, 50973.16687965393, 56259.773498535156, 55162.68697166443, 54095.24684727192, 53352.140338897705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.855945913835114, "mean_inference_ms": 6.3949782863524565, "mean_action_processing_ms": 0.200297851988689, "mean_env_wait_ms": 210.04313836215226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039485784677358776, "StateBufferConnector_ms": 0.006319009340726412, "ViewRequirementAgentConnector_ms": 0.26820714657123274}}, "episode_reward_max": 57767.06701660156, "episode_reward_min": 47955.94670295715, "episode_reward_mean": 53135.1508951233, "episode_len_mean": 135.26923076923077, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 47955.94670295715}, "policy_reward_max": {"agent_0": 57767.06701660156}, "policy_reward_mean": {"agent_0": 53135.1508951233}, "hist_stats": {"episode_reward": [55573.36025238037, 53801.30023956299, 47955.94670295715, 52370.12009048462, 50600.13996505737, 49132.2600774765, 53210.82670211792, 51608.36005115509, 52002.63335418701, 56670.433404922485, 50819.76668167114, 53245.98681640625, 57767.06701660156, 53526.50651931763, 54451.8069229126, 54805.439865112305, 54392.48682594299, 49849.0134305954, 51665.32001495361, 57210.45364379883, 51011.68015956879, 50973.16687965393, 56259.773498535156, 55162.68697166443, 54095.24684727192, 53352.140338897705], "episode_lengths": [134, 135, 136, 134, 136, 135, 136, 136, 135, 136, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 137, 136, 135, 135, 136, 135], "policy_agent_0_reward": [55573.36025238037, 53801.30023956299, 47955.94670295715, 52370.12009048462, 50600.13996505737, 49132.2600774765, 53210.82670211792, 51608.36005115509, 52002.63335418701, 56670.433404922485, 50819.76668167114, 53245.98681640625, 57767.06701660156, 53526.50651931763, 54451.8069229126, 54805.439865112305, 54392.48682594299, 49849.0134305954, 51665.32001495361, 57210.45364379883, 51011.68015956879, 50973.16687965393, 56259.773498535156, 55162.68697166443, 54095.24684727192, 53352.140338897705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.855945913835114, "mean_inference_ms": 6.3949782863524565, "mean_action_processing_ms": 0.200297851988689, "mean_env_wait_ms": 210.04313836215226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039485784677358776, "StateBufferConnector_ms": 0.006319009340726412, "ViewRequirementAgentConnector_ms": 0.26820714657123274}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.0255432606643, "num_env_steps_trained_throughput_per_sec": 275.0255432606643, "timesteps_total": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 15769.142, "sample_time_ms": 11489.594, "learn_time_ms": 4128.92, "learn_throughput": 968.776, "synch_weights_time_ms": 149.763}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "episodes_total": 6382, "training_iteration": 218, "trial_id": "185f8_00000", "date": "2025-03-21_12-42-42", "timestamp": 1742560962, "time_this_iter_s": 14.588554859161377, "time_total_s": 3482.0411760807037, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde7e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3482.0411760807037, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 99.00500000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.833333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.97022533416748, "policy_loss": -0.015943489968776703, "vf_loss": 9.984130859375, "vf_explained_var": -2.496565514320537e-07, "kl": 0.01019163429737091, "entropy": 0.420553058385849, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 56280.56692504883, "episode_reward_min": 40819.76004528999, "episode_reward_mean": 50668.3890427351, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 40819.76004528999}, "policy_reward_max": {"agent_0": 56280.56692504883}, "policy_reward_mean": {"agent_0": 50668.3890427351}, "custom_metrics": {"num_batches_mean": 5.833333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56280.56692504883, 55331.76027679443, 46212.83338546753, 40819.76004528999, 53394.45356750488, 51970.96005630493], "episode_lengths": [135, 135, 136, 136, 135, 135], "policy_agent_0_reward": [56280.56692504883, 55331.76027679443, 46212.83338546753, 40819.76004528999, 53394.45356750488, 51970.96005630493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.49473717933518, "mean_inference_ms": 6.552820995359311, "mean_action_processing_ms": 0.20139655752873384, "mean_env_wait_ms": 210.54574041827493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0423431396484375, "StateBufferConnector_ms": 0.006949901580810547, "ViewRequirementAgentConnector_ms": 0.2835234006245931}}, "episode_reward_max": 56280.56692504883, "episode_reward_min": 40819.76004528999, "episode_reward_mean": 50668.3890427351, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 40819.76004528999}, "policy_reward_max": {"agent_0": 56280.56692504883}, "policy_reward_mean": {"agent_0": 50668.3890427351}, "hist_stats": {"episode_reward": [56280.56692504883, 55331.76027679443, 46212.83338546753, 40819.76004528999, 53394.45356750488, 51970.96005630493], "episode_lengths": [135, 135, 136, 136, 135, 135], "policy_agent_0_reward": [56280.56692504883, 55331.76027679443, 46212.83338546753, 40819.76004528999, 53394.45356750488, 51970.96005630493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.49473717933518, "mean_inference_ms": 6.552820995359311, "mean_action_processing_ms": 0.20139655752873384, "mean_env_wait_ms": 210.54574041827493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0423431396484375, "StateBufferConnector_ms": 0.006949901580810547, "ViewRequirementAgentConnector_ms": 0.2835234006245931}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.2180063111765, "num_env_steps_trained_throughput_per_sec": 277.2180063111765, "timesteps_total": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 15764.785, "sample_time_ms": 11476.608, "learn_time_ms": 4139.769, "learn_throughput": 966.238, "synch_weights_time_ms": 147.558}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 6388, "training_iteration": 219, "trial_id": "185f8_00000", "date": "2025-03-21_12-42-57", "timestamp": 1742560977, "time_this_iter_s": 14.487744569778442, "time_total_s": 3496.528920650482, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd78550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3496.528920650482, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 99.5, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983351707458496, "policy_loss": -0.016118567436933517, "vf_loss": 9.99755859375, "vf_explained_var": 2.0035852799082932e-07, "kl": 0.009554171934723854, "entropy": 0.40074431896209717, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "sampler_results": {"episode_reward_max": 54673.60015106201, "episode_reward_min": 54673.60015106201, "episode_reward_mean": 54673.60015106201, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54673.60015106201}, "policy_reward_max": {"agent_0": 54673.60015106201}, "policy_reward_mean": {"agent_0": 54673.60015106201}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54673.60015106201], "episode_lengths": [134], "policy_agent_0_reward": [54673.60015106201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.606196594075747, "mean_inference_ms": 6.354431218170439, "mean_action_processing_ms": 0.19835467501774276, "mean_env_wait_ms": 221.825976548522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03962516784667969, "StateBufferConnector_ms": 0.005650520324707031, "ViewRequirementAgentConnector_ms": 0.16646385192871094}}, "episode_reward_max": 54673.60015106201, "episode_reward_min": 54673.60015106201, "episode_reward_mean": 54673.60015106201, "episode_len_mean": 134.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54673.60015106201}, "policy_reward_max": {"agent_0": 54673.60015106201}, "policy_reward_mean": {"agent_0": 54673.60015106201}, "hist_stats": {"episode_reward": [54673.60015106201], "episode_lengths": [134], "policy_agent_0_reward": [54673.60015106201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.606196594075747, "mean_inference_ms": 6.354431218170439, "mean_action_processing_ms": 0.19835467501774276, "mean_env_wait_ms": 221.825976548522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03962516784667969, "StateBufferConnector_ms": 0.005650520324707031, "ViewRequirementAgentConnector_ms": 0.16646385192871094}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.6947819592711, "num_env_steps_trained_throughput_per_sec": 277.6947819592711, "timesteps_total": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 15548.846, "sample_time_ms": 11219.518, "learn_time_ms": 4177.271, "learn_throughput": 957.563, "synch_weights_time_ms": 151.202}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "episodes_total": 6389, "training_iteration": 220, "trial_id": "185f8_00000", "date": "2025-03-21_12-43-11", "timestamp": 1742560991, "time_this_iter_s": 14.463177680969238, "time_total_s": 3510.9920983314514, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde5b40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3510.9920983314514, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 99.39500000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.010989010989011, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.759246826171875, "policy_loss": -0.014389397576451302, "vf_loss": 9.771485328674316, "vf_explained_var": -1.3013060424782452e-06, "kl": 0.010752644389867783, "entropy": 0.39194074273109436, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "sampler_results": {"episode_reward_max": 57435.63995361328, "episode_reward_min": 43213.300141334534, "episode_reward_mean": 52216.584468515364, "episode_len_mean": 135.35164835164835, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43213.300141334534}, "policy_reward_max": {"agent_0": 57435.63995361328}, "policy_reward_mean": {"agent_0": 52216.584468515364}, "custom_metrics": {"num_batches_mean": 5.010989010989011, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56021.013412475586, 50153.533432006836, 52215.50680923462, 51665.266914367676, 49062.32025909424, 49557.0134408474, 51655.48021507263, 54266.740060806274, 47035.093477249146, 50100.81350457668, 47020.89370727539, 50750.16015434265, 52029.34049701691, 53395.3734664917, 55123.400299072266, 46045.48005104065, 52698.43360042572, 54745.92671585083, 50274.020122528076, 49494.32004451752, 56645.453552246094, 51251.88034534454, 49256.36667776108, 53121.653438568115, 54207.14683532715, 51951.96685028076, 52907.226937294006, 50927.92671871185, 53192.84039020538, 51719.166496276855, 57435.63995361328, 53224.206703186035, 51022.24662590027, 52516.02680969238, 52094.400131225586, 52856.02670478821, 52039.56684112549, 55218.62023925781, 46541.62680053711, 51602.066650390625, 50804.30669593811, 55423.033628463745, 55230.379954099655, 50072.74005126953, 53567.88658905029, 54000.35363006592, 56879.446853637695, 54174.0002784729, 48308.7200858593, 49928.120098114014, 52115.88020324707, 48126.81337070465, 52975.073548316956, 45352.38006782532, 51577.879901885986, 52975.74027442932, 51376.40662384033, 53113.74000167847, 51958.05350494385, 53000.75366592407, 46934.026891708374, 54135.240158081055, 56307.007064819336, 51408.30682182312, 55004.753536224365, 55791.97351837158, 50773.886796951294, 53514.26012802124, 54949.773513793945, 48576.16003751755, 56876.140281677246, 52295.87351441383, 54951.180210113525, 55119.02021789551, 55450.81335449219, 48432.89341545105, 54303.206718444824, 51902.86686325073, 55029.046798706055, 53496.986607551575, 52172.380100250244, 51832.1532459259, 54058.80699157715, 43213.300141334534, 54504.72694396973, 54840.16019821167, 56789.59363555908, 49260.873416900635, 52626.83352661133, 54834.273666381836, 48318.77340507507], "episode_lengths": [135, 135, 136, 135, 135, 135, 135, 136, 137, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [56021.013412475586, 50153.533432006836, 52215.50680923462, 51665.266914367676, 49062.32025909424, 49557.0134408474, 51655.48021507263, 54266.740060806274, 47035.093477249146, 50100.81350457668, 47020.89370727539, 50750.16015434265, 52029.34049701691, 53395.3734664917, 55123.400299072266, 46045.48005104065, 52698.43360042572, 54745.92671585083, 50274.020122528076, 49494.32004451752, 56645.453552246094, 51251.88034534454, 49256.36667776108, 53121.653438568115, 54207.14683532715, 51951.96685028076, 52907.226937294006, 50927.92671871185, 53192.84039020538, 51719.166496276855, 57435.63995361328, 53224.206703186035, 51022.24662590027, 52516.02680969238, 52094.400131225586, 52856.02670478821, 52039.56684112549, 55218.62023925781, 46541.62680053711, 51602.066650390625, 50804.30669593811, 55423.033628463745, 55230.379954099655, 50072.74005126953, 53567.88658905029, 54000.35363006592, 56879.446853637695, 54174.0002784729, 48308.7200858593, 49928.120098114014, 52115.88020324707, 48126.81337070465, 52975.073548316956, 45352.38006782532, 51577.879901885986, 52975.74027442932, 51376.40662384033, 53113.74000167847, 51958.05350494385, 53000.75366592407, 46934.026891708374, 54135.240158081055, 56307.007064819336, 51408.30682182312, 55004.753536224365, 55791.97351837158, 50773.886796951294, 53514.26012802124, 54949.773513793945, 48576.16003751755, 56876.140281677246, 52295.87351441383, 54951.180210113525, 55119.02021789551, 55450.81335449219, 48432.89341545105, 54303.206718444824, 51902.86686325073, 55029.046798706055, 53496.986607551575, 52172.380100250244, 51832.1532459259, 54058.80699157715, 43213.300141334534, 54504.72694396973, 54840.16019821167, 56789.59363555908, 49260.873416900635, 52626.83352661133, 54834.273666381836, 48318.77340507507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.65369042913969, "mean_inference_ms": 6.705906039899942, "mean_action_processing_ms": 0.19942600935557675, "mean_env_wait_ms": 225.55676290594252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08665991353464651, "StateBufferConnector_ms": 0.00617346920809903, "ViewRequirementAgentConnector_ms": 0.21860573317978407}}, "episode_reward_max": 57435.63995361328, "episode_reward_min": 43213.300141334534, "episode_reward_mean": 52216.584468515364, "episode_len_mean": 135.35164835164835, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43213.300141334534}, "policy_reward_max": {"agent_0": 57435.63995361328}, "policy_reward_mean": {"agent_0": 52216.584468515364}, "hist_stats": {"episode_reward": [56021.013412475586, 50153.533432006836, 52215.50680923462, 51665.266914367676, 49062.32025909424, 49557.0134408474, 51655.48021507263, 54266.740060806274, 47035.093477249146, 50100.81350457668, 47020.89370727539, 50750.16015434265, 52029.34049701691, 53395.3734664917, 55123.400299072266, 46045.48005104065, 52698.43360042572, 54745.92671585083, 50274.020122528076, 49494.32004451752, 56645.453552246094, 51251.88034534454, 49256.36667776108, 53121.653438568115, 54207.14683532715, 51951.96685028076, 52907.226937294006, 50927.92671871185, 53192.84039020538, 51719.166496276855, 57435.63995361328, 53224.206703186035, 51022.24662590027, 52516.02680969238, 52094.400131225586, 52856.02670478821, 52039.56684112549, 55218.62023925781, 46541.62680053711, 51602.066650390625, 50804.30669593811, 55423.033628463745, 55230.379954099655, 50072.74005126953, 53567.88658905029, 54000.35363006592, 56879.446853637695, 54174.0002784729, 48308.7200858593, 49928.120098114014, 52115.88020324707, 48126.81337070465, 52975.073548316956, 45352.38006782532, 51577.879901885986, 52975.74027442932, 51376.40662384033, 53113.74000167847, 51958.05350494385, 53000.75366592407, 46934.026891708374, 54135.240158081055, 56307.007064819336, 51408.30682182312, 55004.753536224365, 55791.97351837158, 50773.886796951294, 53514.26012802124, 54949.773513793945, 48576.16003751755, 56876.140281677246, 52295.87351441383, 54951.180210113525, 55119.02021789551, 55450.81335449219, 48432.89341545105, 54303.206718444824, 51902.86686325073, 55029.046798706055, 53496.986607551575, 52172.380100250244, 51832.1532459259, 54058.80699157715, 43213.300141334534, 54504.72694396973, 54840.16019821167, 56789.59363555908, 49260.873416900635, 52626.83352661133, 54834.273666381836, 48318.77340507507], "episode_lengths": [135, 135, 136, 135, 135, 135, 135, 136, 137, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 136, 136, 135, 136, 135, 136, 135, 136, 135, 136, 135, 135, 135], "policy_agent_0_reward": [56021.013412475586, 50153.533432006836, 52215.50680923462, 51665.266914367676, 49062.32025909424, 49557.0134408474, 51655.48021507263, 54266.740060806274, 47035.093477249146, 50100.81350457668, 47020.89370727539, 50750.16015434265, 52029.34049701691, 53395.3734664917, 55123.400299072266, 46045.48005104065, 52698.43360042572, 54745.92671585083, 50274.020122528076, 49494.32004451752, 56645.453552246094, 51251.88034534454, 49256.36667776108, 53121.653438568115, 54207.14683532715, 51951.96685028076, 52907.226937294006, 50927.92671871185, 53192.84039020538, 51719.166496276855, 57435.63995361328, 53224.206703186035, 51022.24662590027, 52516.02680969238, 52094.400131225586, 52856.02670478821, 52039.56684112549, 55218.62023925781, 46541.62680053711, 51602.066650390625, 50804.30669593811, 55423.033628463745, 55230.379954099655, 50072.74005126953, 53567.88658905029, 54000.35363006592, 56879.446853637695, 54174.0002784729, 48308.7200858593, 49928.120098114014, 52115.88020324707, 48126.81337070465, 52975.073548316956, 45352.38006782532, 51577.879901885986, 52975.74027442932, 51376.40662384033, 53113.74000167847, 51958.05350494385, 53000.75366592407, 46934.026891708374, 54135.240158081055, 56307.007064819336, 51408.30682182312, 55004.753536224365, 55791.97351837158, 50773.886796951294, 53514.26012802124, 54949.773513793945, 48576.16003751755, 56876.140281677246, 52295.87351441383, 54951.180210113525, 55119.02021789551, 55450.81335449219, 48432.89341545105, 54303.206718444824, 51902.86686325073, 55029.046798706055, 53496.986607551575, 52172.380100250244, 51832.1532459259, 54058.80699157715, 43213.300141334534, 54504.72694396973, 54840.16019821167, 56789.59363555908, 49260.873416900635, 52626.83352661133, 54834.273666381836, 48318.77340507507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.65369042913969, "mean_inference_ms": 6.705906039899942, "mean_action_processing_ms": 0.19942600935557675, "mean_env_wait_ms": 225.55676290594252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08665991353464651, "StateBufferConnector_ms": 0.00617346920809903, "ViewRequirementAgentConnector_ms": 0.21860573317978407}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.75110917423638, "num_env_steps_trained_throughput_per_sec": 204.75110917423638, "timesteps_total": 884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 16147.465, "sample_time_ms": 11796.635, "learn_time_ms": 4194.88, "learn_throughput": 953.543, "synch_weights_time_ms": 155.119}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "done": false, "episodes_total": 6480, "training_iteration": 221, "trial_id": "185f8_00000", "date": "2025-03-21_12-43-31", "timestamp": 1742561011, "time_this_iter_s": 19.628948211669922, "time_total_s": 3530.6210465431213, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde4160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3530.6210465431213, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 95.54642857142858, "ram_util_percent": 13.77857142857143}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.936826705932617, "policy_loss": -0.018392611294984818, "vf_loss": 9.952880859375, "vf_explained_var": -8.439024554718344e-07, "kl": 0.011687594465911388, "entropy": 0.43241462111473083, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 55649.13335609436, "episode_reward_min": 48713.03357076645, "episode_reward_mean": 52520.781194410825, "episode_len_mean": 135.10526315789474, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 48713.03357076645}, "policy_reward_max": {"agent_0": 55649.13335609436}, "policy_reward_mean": {"agent_0": 52520.781194410825}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55107.80693054199, 55649.13335609436, 50615.06007575989, 54458.36672210693, 54417.13341617584, 51416.599880218506, 54315.80023574829, 53463.18016052246, 52272.060218811035, 54113.720032691956, 55587.86689376831, 51406.706745147705, 49668.08020401001, 49572.7136592865, 53807.07334136963, 51246.26047325134, 51411.16675281525, 48713.03357076645, 50653.08002471924], "episode_lengths": [135, 135, 136, 134, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55107.80693054199, 55649.13335609436, 50615.06007575989, 54458.36672210693, 54417.13341617584, 51416.599880218506, 54315.80023574829, 53463.18016052246, 52272.060218811035, 54113.720032691956, 55587.86689376831, 51406.706745147705, 49668.08020401001, 49572.7136592865, 53807.07334136963, 51246.26047325134, 51411.16675281525, 48713.03357076645, 50653.08002471924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.33579289143955, "mean_inference_ms": 6.412594193694235, "mean_action_processing_ms": 0.20033870507482712, "mean_env_wait_ms": 210.684338670802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040378068622789885, "StateBufferConnector_ms": 0.0062553506148488895, "ViewRequirementAgentConnector_ms": 0.2815196388646176}}, "episode_reward_max": 55649.13335609436, "episode_reward_min": 48713.03357076645, "episode_reward_mean": 52520.781194410825, "episode_len_mean": 135.10526315789474, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 48713.03357076645}, "policy_reward_max": {"agent_0": 55649.13335609436}, "policy_reward_mean": {"agent_0": 52520.781194410825}, "hist_stats": {"episode_reward": [55107.80693054199, 55649.13335609436, 50615.06007575989, 54458.36672210693, 54417.13341617584, 51416.599880218506, 54315.80023574829, 53463.18016052246, 52272.060218811035, 54113.720032691956, 55587.86689376831, 51406.706745147705, 49668.08020401001, 49572.7136592865, 53807.07334136963, 51246.26047325134, 51411.16675281525, 48713.03357076645, 50653.08002471924], "episode_lengths": [135, 135, 136, 134, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55107.80693054199, 55649.13335609436, 50615.06007575989, 54458.36672210693, 54417.13341617584, 51416.599880218506, 54315.80023574829, 53463.18016052246, 52272.060218811035, 54113.720032691956, 55587.86689376831, 51406.706745147705, 49668.08020401001, 49572.7136592865, 53807.07334136963, 51246.26047325134, 51411.16675281525, 48713.03357076645, 50653.08002471924]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.33579289143955, "mean_inference_ms": 6.412594193694235, "mean_action_processing_ms": 0.20033870507482712, "mean_env_wait_ms": 210.684338670802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040378068622789885, "StateBufferConnector_ms": 0.0062553506148488895, "ViewRequirementAgentConnector_ms": 0.2815196388646176}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.1672819783549, "num_env_steps_trained_throughput_per_sec": 264.1672819783549, "timesteps_total": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 16121.001, "sample_time_ms": 11714.853, "learn_time_ms": 4241.256, "learn_throughput": 943.117, "synch_weights_time_ms": 164.059}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 6499, "training_iteration": 222, "trial_id": "185f8_00000", "date": "2025-03-21_12-43-46", "timestamp": 1742561026, "time_this_iter_s": 15.190682649612427, "time_total_s": 3545.8117291927338, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3545.8117291927338, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 99.30952380952381, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.230769230769231, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.956769943237305, "policy_loss": -0.013345873914659023, "vf_loss": 9.968017578125, "vf_explained_var": 2.568587547102652e-07, "kl": 0.010492680594325066, "entropy": 0.36953508853912354, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "sampler_results": {"episode_reward_max": 55532.720180511475, "episode_reward_min": 49396.10689353943, "episode_reward_mean": 53135.01041958882, "episode_len_mean": 135.3846153846154, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {"agent_0": 49396.10689353943}, "policy_reward_max": {"agent_0": 55532.720180511475}, "policy_reward_mean": {"agent_0": 53135.01041958882}, "custom_metrics": {"num_batches_mean": 5.230769230769231, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55221.56689453125, 50436.986786842346, 55108.52671813965, 51763.68021726608, 54921.62014770508, 54777.48022651672, 52896.6934261322, 53528.10012054443, 50143.020069122314, 49396.10689353943, 51628.173515319824, 55532.720180511475, 55400.46025848389], "episode_lengths": [135, 136, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135], "policy_agent_0_reward": [55221.56689453125, 50436.986786842346, 55108.52671813965, 51763.68021726608, 54921.62014770508, 54777.48022651672, 52896.6934261322, 53528.10012054443, 50143.020069122314, 49396.10689353943, 51628.173515319824, 55532.720180511475, 55400.46025848389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.63215358161607, "mean_inference_ms": 6.436529013026118, "mean_action_processing_ms": 0.20121217870393326, "mean_env_wait_ms": 209.0964848256629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04419913658728966, "StateBufferConnector_ms": 0.0065766848050631006, "ViewRequirementAgentConnector_ms": 0.19853665278508112}}, "episode_reward_max": 55532.720180511475, "episode_reward_min": 49396.10689353943, "episode_reward_mean": 53135.01041958882, "episode_len_mean": 135.3846153846154, "episodes_this_iter": 13, "policy_reward_min": {"agent_0": 49396.10689353943}, "policy_reward_max": {"agent_0": 55532.720180511475}, "policy_reward_mean": {"agent_0": 53135.01041958882}, "hist_stats": {"episode_reward": [55221.56689453125, 50436.986786842346, 55108.52671813965, 51763.68021726608, 54921.62014770508, 54777.48022651672, 52896.6934261322, 53528.10012054443, 50143.020069122314, 49396.10689353943, 51628.173515319824, 55532.720180511475, 55400.46025848389], "episode_lengths": [135, 136, 135, 135, 135, 136, 136, 135, 136, 136, 135, 135, 135], "policy_agent_0_reward": [55221.56689453125, 50436.986786842346, 55108.52671813965, 51763.68021726608, 54921.62014770508, 54777.48022651672, 52896.6934261322, 53528.10012054443, 50143.020069122314, 49396.10689353943, 51628.173515319824, 55532.720180511475, 55400.46025848389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.63215358161607, "mean_inference_ms": 6.436529013026118, "mean_action_processing_ms": 0.20121217870393326, "mean_env_wait_ms": 209.0964848256629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04419913658728966, "StateBufferConnector_ms": 0.0065766848050631006, "ViewRequirementAgentConnector_ms": 0.19853665278508112}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.74418771337645, "num_env_steps_trained_throughput_per_sec": 237.74418771337645, "timesteps_total": 892000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 15878.221, "sample_time_ms": 11502.668, "learn_time_ms": 4201.462, "learn_throughput": 952.049, "synch_weights_time_ms": 173.114}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "done": false, "episodes_total": 6512, "training_iteration": 223, "trial_id": "185f8_00000", "date": "2025-03-21_12-44-03", "timestamp": 1742561043, "time_this_iter_s": 16.87417960166931, "time_total_s": 3562.685908794403, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789ffc2320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3562.685908794403, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 99.41249999999998, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988557815551758, "policy_loss": -0.013347744941711426, "vf_loss": 10.0, "vf_explained_var": -9.046246418620285e-07, "kl": 0.009532392956316471, "entropy": 0.3866751790046692, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "sampler_results": {"episode_reward_max": 55400.46025848389, "episode_reward_min": 55400.46025848389, "episode_reward_mean": 55400.46025848389, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55400.46025848389}, "policy_reward_max": {"agent_0": 55400.46025848389}, "policy_reward_mean": {"agent_0": 55400.46025848389}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55400.46025848389], "episode_lengths": [135], "policy_agent_0_reward": [55400.46025848389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.24315667800281, "mean_inference_ms": 6.39861744383107, "mean_action_processing_ms": 0.19371810814608698, "mean_env_wait_ms": 210.97144384099087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299713134765625, "StateBufferConnector_ms": 0.005221366882324219, "ViewRequirementAgentConnector_ms": 0.1479625701904297}}, "episode_reward_max": 55400.46025848389, "episode_reward_min": 55400.46025848389, "episode_reward_mean": 55400.46025848389, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55400.46025848389}, "policy_reward_max": {"agent_0": 55400.46025848389}, "policy_reward_mean": {"agent_0": 55400.46025848389}, "hist_stats": {"episode_reward": [55400.46025848389], "episode_lengths": [135], "policy_agent_0_reward": [55400.46025848389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.24315667800281, "mean_inference_ms": 6.39861744383107, "mean_action_processing_ms": 0.19371810814608698, "mean_env_wait_ms": 210.97144384099087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299713134765625, "StateBufferConnector_ms": 0.005221366882324219, "ViewRequirementAgentConnector_ms": 0.1479625701904297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.018889568082, "num_env_steps_trained_throughput_per_sec": 283.018889568082, "timesteps_total": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 15697.734, "sample_time_ms": 11300.352, "learn_time_ms": 4221.706, "learn_throughput": 947.484, "synch_weights_time_ms": 174.673}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "episodes_total": 6512, "training_iteration": 224, "trial_id": "185f8_00000", "date": "2025-03-21_12-44-17", "timestamp": 1742561057, "time_this_iter_s": 14.195890665054321, "time_total_s": 3576.8817994594574, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb57d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3576.8817994594574, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 99.565, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75374984741211, "policy_loss": -0.015054760500788689, "vf_loss": 9.767019271850586, "vf_explained_var": -7.85924476076616e-06, "kl": 0.008924364112317562, "entropy": 0.40818074345588684, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 57529.40721130371, "episode_reward_min": 41997.153414011, "episode_reward_mean": 52455.39949573641, "episode_len_mean": 135.2826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41997.153414011}, "policy_reward_max": {"agent_0": 57529.40721130371}, "policy_reward_mean": {"agent_0": 52455.39949573641}, "custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50721.96703910828, 52465.959899902344, 50965.86675453186, 55021.500061035156, 49920.366930007935, 47536.373569488525, 50650.08656358719, 52798.94014644623, 53822.28664398193, 52983.37354326248, 55232.81363296509, 48554.960176348686, 52832.326721191406, 53448.84032249451, 54716.07992553711, 50336.93352627754, 53414.3666973114, 56280.45358657837, 53510.853558540344, 53943.72019195557, 51128.633467674255, 44935.146763801575, 47652.1136341095, 53535.96699523926, 55228.71989440918, 45660.93345999718, 47895.94667005539, 53885.780086517334, 54196.40673828125, 56719.793533325195, 52002.00012779236, 41997.153414011, 55548.93342971802, 55249.91346740723, 57529.40721130371, 52235.28664779663, 49901.766625761986, 55612.52039337158, 45469.62003040314, 48702.740107536316, 52043.9933784008, 53326.300287246704, 52016.479961395264, 54345.93339920044, 55523.24702453613, 54922.22016143799, 48068.766721725464, 57435.06657409668, 56171.826889038086, 50240.27350997925, 50439.766817092896, 50833.806732177734, 56248.54047203064, 54990.07353973389, 52950.40666294098, 52946.99345779419, 53487.20662498474, 54442.5601272583, 55395.906931877136, 56880.64678955078, 53058.946937561035, 51179.90674340725, 54460.15361785889, 55147.84678649902, 51812.013451099396, 52429.933280944824, 50675.46682929993, 52130.0936126709, 51250.32688140869, 57397.66027832031, 51349.71340560913, 50924.4335231781, 55337.60684585571, 55249.82679748535, 53803.520195007324, 50405.40019226074, 45085.64690577984, 55057.68688964844, 47624.87342405319, 55604.27367401123, 49630.47340512276, 51312.73341369629, 51335.726903915405, 56118.820137023926, 56024.606855392456, 50347.80006027222, 48981.78015708923, 51776.300172805786, 53926.513442993164, 55571.92684555054, 49708.780134916306, 54219.09355545044], "episode_lengths": [135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 137, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 134, 136, 135, 135, 135, 135, 134, 135, 135, 137, 134, 134, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 134, 135, 136, 136, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135], "policy_agent_0_reward": [50721.96703910828, 52465.959899902344, 50965.86675453186, 55021.500061035156, 49920.366930007935, 47536.373569488525, 50650.08656358719, 52798.94014644623, 53822.28664398193, 52983.37354326248, 55232.81363296509, 48554.960176348686, 52832.326721191406, 53448.84032249451, 54716.07992553711, 50336.93352627754, 53414.3666973114, 56280.45358657837, 53510.853558540344, 53943.72019195557, 51128.633467674255, 44935.146763801575, 47652.1136341095, 53535.96699523926, 55228.71989440918, 45660.93345999718, 47895.94667005539, 53885.780086517334, 54196.40673828125, 56719.793533325195, 52002.00012779236, 41997.153414011, 55548.93342971802, 55249.91346740723, 57529.40721130371, 52235.28664779663, 49901.766625761986, 55612.52039337158, 45469.62003040314, 48702.740107536316, 52043.9933784008, 53326.300287246704, 52016.479961395264, 54345.93339920044, 55523.24702453613, 54922.22016143799, 48068.766721725464, 57435.06657409668, 56171.826889038086, 50240.27350997925, 50439.766817092896, 50833.806732177734, 56248.54047203064, 54990.07353973389, 52950.40666294098, 52946.99345779419, 53487.20662498474, 54442.5601272583, 55395.906931877136, 56880.64678955078, 53058.946937561035, 51179.90674340725, 54460.15361785889, 55147.84678649902, 51812.013451099396, 52429.933280944824, 50675.46682929993, 52130.0936126709, 51250.32688140869, 57397.66027832031, 51349.71340560913, 50924.4335231781, 55337.60684585571, 55249.82679748535, 53803.520195007324, 50405.40019226074, 45085.64690577984, 55057.68688964844, 47624.87342405319, 55604.27367401123, 49630.47340512276, 51312.73341369629, 51335.726903915405, 56118.820137023926, 56024.606855392456, 50347.80006027222, 48981.78015708923, 51776.300172805786, 53926.513442993164, 55571.92684555054, 49708.780134916306, 54219.09355545044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.53432718052308, "mean_inference_ms": 6.6997621286905975, "mean_action_processing_ms": 0.1993749985298411, "mean_env_wait_ms": 225.48650168742333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044306464817212975, "StateBufferConnector_ms": 0.006024215532385785, "ViewRequirementAgentConnector_ms": 0.23274499437083368}}, "episode_reward_max": 57529.40721130371, "episode_reward_min": 41997.153414011, "episode_reward_mean": 52455.39949573641, "episode_len_mean": 135.2826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 41997.153414011}, "policy_reward_max": {"agent_0": 57529.40721130371}, "policy_reward_mean": {"agent_0": 52455.39949573641}, "hist_stats": {"episode_reward": [50721.96703910828, 52465.959899902344, 50965.86675453186, 55021.500061035156, 49920.366930007935, 47536.373569488525, 50650.08656358719, 52798.94014644623, 53822.28664398193, 52983.37354326248, 55232.81363296509, 48554.960176348686, 52832.326721191406, 53448.84032249451, 54716.07992553711, 50336.93352627754, 53414.3666973114, 56280.45358657837, 53510.853558540344, 53943.72019195557, 51128.633467674255, 44935.146763801575, 47652.1136341095, 53535.96699523926, 55228.71989440918, 45660.93345999718, 47895.94667005539, 53885.780086517334, 54196.40673828125, 56719.793533325195, 52002.00012779236, 41997.153414011, 55548.93342971802, 55249.91346740723, 57529.40721130371, 52235.28664779663, 49901.766625761986, 55612.52039337158, 45469.62003040314, 48702.740107536316, 52043.9933784008, 53326.300287246704, 52016.479961395264, 54345.93339920044, 55523.24702453613, 54922.22016143799, 48068.766721725464, 57435.06657409668, 56171.826889038086, 50240.27350997925, 50439.766817092896, 50833.806732177734, 56248.54047203064, 54990.07353973389, 52950.40666294098, 52946.99345779419, 53487.20662498474, 54442.5601272583, 55395.906931877136, 56880.64678955078, 53058.946937561035, 51179.90674340725, 54460.15361785889, 55147.84678649902, 51812.013451099396, 52429.933280944824, 50675.46682929993, 52130.0936126709, 51250.32688140869, 57397.66027832031, 51349.71340560913, 50924.4335231781, 55337.60684585571, 55249.82679748535, 53803.520195007324, 50405.40019226074, 45085.64690577984, 55057.68688964844, 47624.87342405319, 55604.27367401123, 49630.47340512276, 51312.73341369629, 51335.726903915405, 56118.820137023926, 56024.606855392456, 50347.80006027222, 48981.78015708923, 51776.300172805786, 53926.513442993164, 55571.92684555054, 49708.780134916306, 54219.09355545044], "episode_lengths": [135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 136, 135, 137, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 134, 136, 135, 135, 135, 135, 134, 135, 135, 137, 134, 134, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 134, 135, 136, 136, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 136, 135], "policy_agent_0_reward": [50721.96703910828, 52465.959899902344, 50965.86675453186, 55021.500061035156, 49920.366930007935, 47536.373569488525, 50650.08656358719, 52798.94014644623, 53822.28664398193, 52983.37354326248, 55232.81363296509, 48554.960176348686, 52832.326721191406, 53448.84032249451, 54716.07992553711, 50336.93352627754, 53414.3666973114, 56280.45358657837, 53510.853558540344, 53943.72019195557, 51128.633467674255, 44935.146763801575, 47652.1136341095, 53535.96699523926, 55228.71989440918, 45660.93345999718, 47895.94667005539, 53885.780086517334, 54196.40673828125, 56719.793533325195, 52002.00012779236, 41997.153414011, 55548.93342971802, 55249.91346740723, 57529.40721130371, 52235.28664779663, 49901.766625761986, 55612.52039337158, 45469.62003040314, 48702.740107536316, 52043.9933784008, 53326.300287246704, 52016.479961395264, 54345.93339920044, 55523.24702453613, 54922.22016143799, 48068.766721725464, 57435.06657409668, 56171.826889038086, 50240.27350997925, 50439.766817092896, 50833.806732177734, 56248.54047203064, 54990.07353973389, 52950.40666294098, 52946.99345779419, 53487.20662498474, 54442.5601272583, 55395.906931877136, 56880.64678955078, 53058.946937561035, 51179.90674340725, 54460.15361785889, 55147.84678649902, 51812.013451099396, 52429.933280944824, 50675.46682929993, 52130.0936126709, 51250.32688140869, 57397.66027832031, 51349.71340560913, 50924.4335231781, 55337.60684585571, 55249.82679748535, 53803.520195007324, 50405.40019226074, 45085.64690577984, 55057.68688964844, 47624.87342405319, 55604.27367401123, 49630.47340512276, 51312.73341369629, 51335.726903915405, 56118.820137023926, 56024.606855392456, 50347.80006027222, 48981.78015708923, 51776.300172805786, 53926.513442993164, 55571.92684555054, 49708.780134916306, 54219.09355545044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.53432718052308, "mean_inference_ms": 6.6997621286905975, "mean_action_processing_ms": 0.1993749985298411, "mean_env_wait_ms": 225.48650168742333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044306464817212975, "StateBufferConnector_ms": 0.006024215532385785, "ViewRequirementAgentConnector_ms": 0.23274499437083368}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.10787059936314, "num_env_steps_trained_throughput_per_sec": 210.10787059936314, "timesteps_total": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 16188.108, "sample_time_ms": 11854.625, "learn_time_ms": 4148.294, "learn_throughput": 964.252, "synch_weights_time_ms": 184.204}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 6604, "training_iteration": 225, "trial_id": "185f8_00000", "date": "2025-03-21_12-44-36", "timestamp": 1742561076, "time_this_iter_s": 19.09890127182007, "time_total_s": 3595.9807007312775, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb55360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3595.9807007312775, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 95.86666666666667, "ram_util_percent": 13.781481481481482}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.965831756591797, "policy_loss": -0.016019245609641075, "vf_loss": 9.979736328125, "vf_explained_var": -4.429990895005176e-06, "kl": 0.010572460480034351, "entropy": 0.38778719305992126, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "sampler_results": {"episode_reward_max": 56813.19332885742, "episode_reward_min": 51101.013359069824, "episode_reward_mean": 53931.52521753311, "episode_len_mean": 135.125, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 51101.013359069824}, "policy_reward_max": {"agent_0": 56813.19332885742}, "policy_reward_mean": {"agent_0": 53931.52521753311}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52225.12019920349, 55959.246994018555, 53509.846755981445, 55360.76044654846, 56813.19332885742, 53525.74031448364, 52957.28034210205, 51101.013359069824], "episode_lengths": [136, 135, 135, 135, 134, 135, 135, 136], "policy_agent_0_reward": [52225.12019920349, 55959.246994018555, 53509.846755981445, 55360.76044654846, 56813.19332885742, 53525.74031448364, 52957.28034210205, 51101.013359069824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.06733885430222, "mean_inference_ms": 6.446165399395409, "mean_action_processing_ms": 0.20075917947162875, "mean_env_wait_ms": 210.3859939920725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04248619079589844, "StateBufferConnector_ms": 0.006380677223205566, "ViewRequirementAgentConnector_ms": 0.3170222043991089}}, "episode_reward_max": 56813.19332885742, "episode_reward_min": 51101.013359069824, "episode_reward_mean": 53931.52521753311, "episode_len_mean": 135.125, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 51101.013359069824}, "policy_reward_max": {"agent_0": 56813.19332885742}, "policy_reward_mean": {"agent_0": 53931.52521753311}, "hist_stats": {"episode_reward": [52225.12019920349, 55959.246994018555, 53509.846755981445, 55360.76044654846, 56813.19332885742, 53525.74031448364, 52957.28034210205, 51101.013359069824], "episode_lengths": [136, 135, 135, 135, 134, 135, 135, 136], "policy_agent_0_reward": [52225.12019920349, 55959.246994018555, 53509.846755981445, 55360.76044654846, 56813.19332885742, 53525.74031448364, 52957.28034210205, 51101.013359069824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.06733885430222, "mean_inference_ms": 6.446165399395409, "mean_action_processing_ms": 0.20075917947162875, "mean_env_wait_ms": 210.3859939920725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04248619079589844, "StateBufferConnector_ms": 0.006380677223205566, "ViewRequirementAgentConnector_ms": 0.3170222043991089}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.373379053851, "num_env_steps_trained_throughput_per_sec": 292.373379053851, "timesteps_total": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 16183.694, "sample_time_ms": 11878.56, "learn_time_ms": 4122.546, "learn_throughput": 970.274, "synch_weights_time_ms": 181.58}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "episodes_total": 6612, "training_iteration": 226, "trial_id": "185f8_00000", "date": "2025-03-21_12-44-50", "timestamp": 1742561090, "time_this_iter_s": 13.72617506980896, "time_total_s": 3609.7068758010864, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f78a24b56c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3609.7068758010864, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 99.01052631578948, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.924582481384277, "policy_loss": -0.014650632627308369, "vf_loss": 9.9375, "vf_explained_var": -3.1109277642826783e-06, "kl": 0.008663564920425415, "entropy": 0.40141603350639343, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "sampler_results": {"episode_reward_max": 56923.380168914795, "episode_reward_min": 46198.47350883484, "episode_reward_mean": 52116.637381980814, "episode_len_mean": 135.25, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 46198.47350883484}, "policy_reward_max": {"agent_0": 56923.380168914795}, "policy_reward_mean": {"agent_0": 52116.637381980814}, "custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49577.41344547272, 49172.02030181885, 52674.486740112305, 52789.080139160156, 53791.2603635788, 50666.23354434967, 51777.71351480484, 51968.02672767639, 53336.82020568848, 54803.066732406616, 53635.85338592529, 53357.45356273651, 56923.380168914795, 54801.60014343262, 46776.800142765045, 53713.76680660248, 50406.08025074005, 53064.45337295532, 52527.01327133179, 46198.47350883484, 53878.33993721008, 53753.280448913574, 52916.38005065918, 48290.3004014492], "episode_lengths": [136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [49577.41344547272, 49172.02030181885, 52674.486740112305, 52789.080139160156, 53791.2603635788, 50666.23354434967, 51777.71351480484, 51968.02672767639, 53336.82020568848, 54803.066732406616, 53635.85338592529, 53357.45356273651, 56923.380168914795, 54801.60014343262, 46776.800142765045, 53713.76680660248, 50406.08025074005, 53064.45337295532, 52527.01327133179, 46198.47350883484, 53878.33993721008, 53753.280448913574, 52916.38005065918, 48290.3004014492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.635991565653775, "mean_inference_ms": 6.422643091123201, "mean_action_processing_ms": 0.20059976480804445, "mean_env_wait_ms": 210.03153838626983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05701581637064616, "StateBufferConnector_ms": 0.006139278411865234, "ViewRequirementAgentConnector_ms": 0.26055872440338135}}, "episode_reward_max": 56923.380168914795, "episode_reward_min": 46198.47350883484, "episode_reward_mean": 52116.637381980814, "episode_len_mean": 135.25, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 46198.47350883484}, "policy_reward_max": {"agent_0": 56923.380168914795}, "policy_reward_mean": {"agent_0": 52116.637381980814}, "hist_stats": {"episode_reward": [49577.41344547272, 49172.02030181885, 52674.486740112305, 52789.080139160156, 53791.2603635788, 50666.23354434967, 51777.71351480484, 51968.02672767639, 53336.82020568848, 54803.066732406616, 53635.85338592529, 53357.45356273651, 56923.380168914795, 54801.60014343262, 46776.800142765045, 53713.76680660248, 50406.08025074005, 53064.45337295532, 52527.01327133179, 46198.47350883484, 53878.33993721008, 53753.280448913574, 52916.38005065918, 48290.3004014492], "episode_lengths": [136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [49577.41344547272, 49172.02030181885, 52674.486740112305, 52789.080139160156, 53791.2603635788, 50666.23354434967, 51777.71351480484, 51968.02672767639, 53336.82020568848, 54803.066732406616, 53635.85338592529, 53357.45356273651, 56923.380168914795, 54801.60014343262, 46776.800142765045, 53713.76680660248, 50406.08025074005, 53064.45337295532, 52527.01327133179, 46198.47350883484, 53878.33993721008, 53753.280448913574, 52916.38005065918, 48290.3004014492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.635991565653775, "mean_inference_ms": 6.422643091123201, "mean_action_processing_ms": 0.20059976480804445, "mean_env_wait_ms": 210.03153838626983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05701581637064616, "StateBufferConnector_ms": 0.006139278411865234, "ViewRequirementAgentConnector_ms": 0.26055872440338135}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.1009997118985, "num_env_steps_trained_throughput_per_sec": 237.1009997118985, "timesteps_total": 908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 15860.225, "sample_time_ms": 11582.237, "learn_time_ms": 4101.245, "learn_throughput": 975.314, "synch_weights_time_ms": 175.752}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "done": false, "episodes_total": 6636, "training_iteration": 227, "trial_id": "185f8_00000", "date": "2025-03-21_12-45-07", "timestamp": 1742561107, "time_this_iter_s": 16.917653560638428, "time_total_s": 3626.624529361725, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb54280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3626.624529361725, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 99.34782608695654, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98724365234375, "policy_loss": -0.014697222970426083, "vf_loss": 10.0, "vf_explained_var": -3.027232878594077e-06, "kl": 0.009705448523163795, "entropy": 0.3718057870864868, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 48290.3004014492, "episode_reward_min": 48290.3004014492, "episode_reward_mean": 48290.3004014492, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48290.3004014492}, "policy_reward_max": {"agent_0": 48290.3004014492}, "policy_reward_mean": {"agent_0": 48290.3004014492}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48290.3004014492], "episode_lengths": [135], "policy_agent_0_reward": [48290.3004014492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.5645169628793, "mean_inference_ms": 6.32216621068984, "mean_action_processing_ms": 0.191247151360051, "mean_env_wait_ms": 208.8205319830777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4429340362548828, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.17113685607910156}}, "episode_reward_max": 48290.3004014492, "episode_reward_min": 48290.3004014492, "episode_reward_mean": 48290.3004014492, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48290.3004014492}, "policy_reward_max": {"agent_0": 48290.3004014492}, "policy_reward_mean": {"agent_0": 48290.3004014492}, "hist_stats": {"episode_reward": [48290.3004014492], "episode_lengths": [135], "policy_agent_0_reward": [48290.3004014492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.5645169628793, "mean_inference_ms": 6.32216621068984, "mean_action_processing_ms": 0.191247151360051, "mean_env_wait_ms": 208.8205319830777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4429340362548828, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.17113685607910156}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.20116361588333, "num_env_steps_trained_throughput_per_sec": 266.20116361588333, "timesteps_total": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 15908.439, "sample_time_ms": 11584.709, "learn_time_ms": 4147.561, "learn_throughput": 964.422, "synch_weights_time_ms": 175.205}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 6636, "training_iteration": 228, "trial_id": "185f8_00000", "date": "2025-03-21_12-45-22", "timestamp": 1742561122, "time_this_iter_s": 15.080404996871948, "time_total_s": 3641.704934358597, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3641.704934358597, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 99.56190476190477, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.799161911010742, "policy_loss": -0.015322834253311157, "vf_loss": 9.812503814697266, "vf_explained_var": -3.657614229268802e-07, "kl": 0.009896715171635151, "entropy": 0.35810795426368713, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "sampler_results": {"episode_reward_max": 57204.34024810791, "episode_reward_min": 45889.1333656311, "episode_reward_mean": 52397.132403666976, "episode_len_mean": 135.25333333333333, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 45889.1333656311}, "policy_reward_max": {"agent_0": 57204.34024810791}, "policy_reward_mean": {"agent_0": 52397.132403666976}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [46405.36690479517, 51889.96678686142, 54732.30654144287, 55432.320404052734, 54250.64672088623, 54041.40019607544, 53581.71335411072, 51769.446727752686, 52690.48027420044, 54329.40009689331, 52044.98665237427, 48877.51343250275, 51488.68008041382, 46809.53348040581, 57204.34024810791, 52551.82677459717, 51857.113763809204, 53446.9133644104, 52022.973556518555, 54624.586738586426, 53092.79345703125, 53123.93353652954, 55594.87356567383, 53509.140228271484, 55815.3136138916, 54662.25336456299, 50024.54015767574, 54674.39373397827, 52851.82654953003, 51578.34687805176, 50671.80670928955, 50927.58017253876, 53806.27347564697, 55754.91343688965, 46107.67333316803, 51331.75333118439, 50035.92673969269, 49479.51329898834, 51688.76009845734, 55805.76664733887, 55171.580017089844, 51792.353608608246, 54515.72019004822, 52547.59365081787, 56812.28678894043, 47933.62685775757, 54714.85357093811, 55068.17323303223, 52199.000257492065, 45889.1333656311, 50602.900369644165, 49999.513721466064, 54656.420082092285, 51669.86701011658, 53989.72676849365, 53571.64680480957, 52792.90669822693, 55538.353439331055, 56151.060386657715, 50555.080018401146, 48809.493223667145, 52055.213371276855, 53937.9535484314, 52224.459924697876, 49947.753531455994, 53220.54697036743, 52486.26671218872, 53237.16007423401, 53450.573583602905, 50680.213565826416, 47863.53356361389, 52554.026549339294, 53306.206933021545, 50288.86683559418, 48961.96662092209], "episode_lengths": [135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 135, 135, 135, 134, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136], "policy_agent_0_reward": [46405.36690479517, 51889.96678686142, 54732.30654144287, 55432.320404052734, 54250.64672088623, 54041.40019607544, 53581.71335411072, 51769.446727752686, 52690.48027420044, 54329.40009689331, 52044.98665237427, 48877.51343250275, 51488.68008041382, 46809.53348040581, 57204.34024810791, 52551.82677459717, 51857.113763809204, 53446.9133644104, 52022.973556518555, 54624.586738586426, 53092.79345703125, 53123.93353652954, 55594.87356567383, 53509.140228271484, 55815.3136138916, 54662.25336456299, 50024.54015767574, 54674.39373397827, 52851.82654953003, 51578.34687805176, 50671.80670928955, 50927.58017253876, 53806.27347564697, 55754.91343688965, 46107.67333316803, 51331.75333118439, 50035.92673969269, 49479.51329898834, 51688.76009845734, 55805.76664733887, 55171.580017089844, 51792.353608608246, 54515.72019004822, 52547.59365081787, 56812.28678894043, 47933.62685775757, 54714.85357093811, 55068.17323303223, 52199.000257492065, 45889.1333656311, 50602.900369644165, 49999.513721466064, 54656.420082092285, 51669.86701011658, 53989.72676849365, 53571.64680480957, 52792.90669822693, 55538.353439331055, 56151.060386657715, 50555.080018401146, 48809.493223667145, 52055.213371276855, 53937.9535484314, 52224.459924697876, 49947.753531455994, 53220.54697036743, 52486.26671218872, 53237.16007423401, 53450.573583602905, 50680.213565826416, 47863.53356361389, 52554.026549339294, 53306.206933021545, 50288.86683559418, 48961.96662092209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.81872642688158, "mean_inference_ms": 6.6997995019615075, "mean_action_processing_ms": 0.19962398233932888, "mean_env_wait_ms": 225.91561831778225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06342538197835286, "StateBufferConnector_ms": 0.022435506184895832, "ViewRequirementAgentConnector_ms": 0.170683224995931}}, "episode_reward_max": 57204.34024810791, "episode_reward_min": 45889.1333656311, "episode_reward_mean": 52397.132403666976, "episode_len_mean": 135.25333333333333, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 45889.1333656311}, "policy_reward_max": {"agent_0": 57204.34024810791}, "policy_reward_mean": {"agent_0": 52397.132403666976}, "hist_stats": {"episode_reward": [46405.36690479517, 51889.96678686142, 54732.30654144287, 55432.320404052734, 54250.64672088623, 54041.40019607544, 53581.71335411072, 51769.446727752686, 52690.48027420044, 54329.40009689331, 52044.98665237427, 48877.51343250275, 51488.68008041382, 46809.53348040581, 57204.34024810791, 52551.82677459717, 51857.113763809204, 53446.9133644104, 52022.973556518555, 54624.586738586426, 53092.79345703125, 53123.93353652954, 55594.87356567383, 53509.140228271484, 55815.3136138916, 54662.25336456299, 50024.54015767574, 54674.39373397827, 52851.82654953003, 51578.34687805176, 50671.80670928955, 50927.58017253876, 53806.27347564697, 55754.91343688965, 46107.67333316803, 51331.75333118439, 50035.92673969269, 49479.51329898834, 51688.76009845734, 55805.76664733887, 55171.580017089844, 51792.353608608246, 54515.72019004822, 52547.59365081787, 56812.28678894043, 47933.62685775757, 54714.85357093811, 55068.17323303223, 52199.000257492065, 45889.1333656311, 50602.900369644165, 49999.513721466064, 54656.420082092285, 51669.86701011658, 53989.72676849365, 53571.64680480957, 52792.90669822693, 55538.353439331055, 56151.060386657715, 50555.080018401146, 48809.493223667145, 52055.213371276855, 53937.9535484314, 52224.459924697876, 49947.753531455994, 53220.54697036743, 52486.26671218872, 53237.16007423401, 53450.573583602905, 50680.213565826416, 47863.53356361389, 52554.026549339294, 53306.206933021545, 50288.86683559418, 48961.96662092209], "episode_lengths": [135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 135, 135, 135, 134, 135, 136, 135, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 136, 136, 136, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136], "policy_agent_0_reward": [46405.36690479517, 51889.96678686142, 54732.30654144287, 55432.320404052734, 54250.64672088623, 54041.40019607544, 53581.71335411072, 51769.446727752686, 52690.48027420044, 54329.40009689331, 52044.98665237427, 48877.51343250275, 51488.68008041382, 46809.53348040581, 57204.34024810791, 52551.82677459717, 51857.113763809204, 53446.9133644104, 52022.973556518555, 54624.586738586426, 53092.79345703125, 53123.93353652954, 55594.87356567383, 53509.140228271484, 55815.3136138916, 54662.25336456299, 50024.54015767574, 54674.39373397827, 52851.82654953003, 51578.34687805176, 50671.80670928955, 50927.58017253876, 53806.27347564697, 55754.91343688965, 46107.67333316803, 51331.75333118439, 50035.92673969269, 49479.51329898834, 51688.76009845734, 55805.76664733887, 55171.580017089844, 51792.353608608246, 54515.72019004822, 52547.59365081787, 56812.28678894043, 47933.62685775757, 54714.85357093811, 55068.17323303223, 52199.000257492065, 45889.1333656311, 50602.900369644165, 49999.513721466064, 54656.420082092285, 51669.86701011658, 53989.72676849365, 53571.64680480957, 52792.90669822693, 55538.353439331055, 56151.060386657715, 50555.080018401146, 48809.493223667145, 52055.213371276855, 53937.9535484314, 52224.459924697876, 49947.753531455994, 53220.54697036743, 52486.26671218872, 53237.16007423401, 53450.573583602905, 50680.213565826416, 47863.53356361389, 52554.026549339294, 53306.206933021545, 50288.86683559418, 48961.96662092209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.81872642688158, "mean_inference_ms": 6.6997995019615075, "mean_action_processing_ms": 0.19962398233932888, "mean_env_wait_ms": 225.91561831778225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06342538197835286, "StateBufferConnector_ms": 0.022435506184895832, "ViewRequirementAgentConnector_ms": 0.170683224995931}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.65934266256335, "num_env_steps_trained_throughput_per_sec": 229.65934266256335, "timesteps_total": 916000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 16207.239, "sample_time_ms": 11967.762, "learn_time_ms": 4069.989, "learn_throughput": 982.804, "synch_weights_time_ms": 168.479}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "done": false, "episodes_total": 6711, "training_iteration": 229, "trial_id": "185f8_00000", "date": "2025-03-21_12-45-40", "timestamp": 1742561140, "time_this_iter_s": 17.465103149414062, "time_total_s": 3659.170037508011, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb57e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3659.170037508011, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 96.3875, "ram_util_percent": 13.791666666666666}}
{"custom_metrics": {"num_batches_mean": 5.842105263157895, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.940909385681152, "policy_loss": -0.012640642933547497, "vf_loss": 9.951904296875, "vf_explained_var": 1.775721756303028e-07, "kl": 0.008229774422943592, "entropy": 0.3412582278251648, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "sampler_results": {"episode_reward_max": 58146.82020568848, "episode_reward_min": 46842.74680805206, "episode_reward_mean": 53043.010326485884, "episode_len_mean": 135.3684210526316, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 46842.74680805206}, "policy_reward_max": {"agent_0": 58146.82020568848}, "policy_reward_mean": {"agent_0": 53043.010326485884}, "custom_metrics": {"num_batches_mean": 5.842105263157895, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55010.86000061035, 52706.33369445801, 51372.74671459198, 50605.233751297, 51717.48680496216, 57381.019958496094, 52072.68697452545, 58146.82020568848, 54742.913414001465, 46842.74680805206, 52459.67985057831, 52644.94693565369, 54406.86015701294, 52315.16015911102, 51884.066789627075, 57453.68000793457, 52342.36681652069, 50996.89360618591, 52714.69355392456], "episode_lengths": [135, 135, 136, 137, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [55010.86000061035, 52706.33369445801, 51372.74671459198, 50605.233751297, 51717.48680496216, 57381.019958496094, 52072.68697452545, 58146.82020568848, 54742.913414001465, 46842.74680805206, 52459.67985057831, 52644.94693565369, 54406.86015701294, 52315.16015911102, 51884.066789627075, 57453.68000793457, 52342.36681652069, 50996.89360618591, 52714.69355392456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.14105761774888, "mean_inference_ms": 6.688190883879076, "mean_action_processing_ms": 0.19810628456535953, "mean_env_wait_ms": 223.07227233860124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03770276119834498, "StateBufferConnector_ms": 0.0057333394100791525, "ViewRequirementAgentConnector_ms": 0.19058428312602796}}, "episode_reward_max": 58146.82020568848, "episode_reward_min": 46842.74680805206, "episode_reward_mean": 53043.010326485884, "episode_len_mean": 135.3684210526316, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 46842.74680805206}, "policy_reward_max": {"agent_0": 58146.82020568848}, "policy_reward_mean": {"agent_0": 53043.010326485884}, "hist_stats": {"episode_reward": [55010.86000061035, 52706.33369445801, 51372.74671459198, 50605.233751297, 51717.48680496216, 57381.019958496094, 52072.68697452545, 58146.82020568848, 54742.913414001465, 46842.74680805206, 52459.67985057831, 52644.94693565369, 54406.86015701294, 52315.16015911102, 51884.066789627075, 57453.68000793457, 52342.36681652069, 50996.89360618591, 52714.69355392456], "episode_lengths": [135, 135, 136, 137, 135, 135, 135, 135, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [55010.86000061035, 52706.33369445801, 51372.74671459198, 50605.233751297, 51717.48680496216, 57381.019958496094, 52072.68697452545, 58146.82020568848, 54742.913414001465, 46842.74680805206, 52459.67985057831, 52644.94693565369, 54406.86015701294, 52315.16015911102, 51884.066789627075, 57453.68000793457, 52342.36681652069, 50996.89360618591, 52714.69355392456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.14105761774888, "mean_inference_ms": 6.688190883879076, "mean_action_processing_ms": 0.19810628456535953, "mean_env_wait_ms": 223.07227233860124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03770276119834498, "StateBufferConnector_ms": 0.0057333394100791525, "ViewRequirementAgentConnector_ms": 0.19058428312602796}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.89022852085293, "num_env_steps_trained_throughput_per_sec": 229.89022852085293, "timesteps_total": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 16506.767, "sample_time_ms": 12296.055, "learn_time_ms": 4044.81, "learn_throughput": 988.922, "synch_weights_time_ms": 164.869}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "episodes_total": 6730, "training_iteration": 230, "trial_id": "185f8_00000", "date": "2025-03-21_12-45-57", "timestamp": 1742561157, "time_this_iter_s": 17.4478600025177, "time_total_s": 3676.6178975105286, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3676.6178975105286, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 99.17826086956524, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.066666666666666, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91203784942627, "policy_loss": -0.014282304793596268, "vf_loss": 9.924560546875, "vf_explained_var": -3.4403055906295776e-06, "kl": 0.008802447468042374, "entropy": 0.3702201247215271, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 56932.4602355957, "episode_reward_min": 45649.09992694855, "episode_reward_mean": 52385.110361299914, "episode_len_mean": 135.23333333333332, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 45649.09992694855}, "policy_reward_max": {"agent_0": 56932.4602355957}, "policy_reward_mean": {"agent_0": 52385.110361299914}, "custom_metrics": {"num_batches_mean": 5.066666666666666, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53176.68665313721, 48289.5137052536, 50774.85342788696, 53539.486598968506, 50595.95351409912, 51356.80679702759, 51827.40674209595, 45649.09992694855, 53352.9266204834, 53366.50015640259, 54378.607025146484, 50464.46020793915, 50825.62016105652, 53981.95341491699, 51940.427001953125, 53954.04666137695, 54519.48686981201, 53044.03330659866, 55163.18041372299, 51824.426882267, 56932.4602355957, 52622.87356185913, 55307.00006866455, 51774.593393325806, 53790.480125427246, 54821.1135559082, 46264.4333820343, 51853.15337753296, 53371.0403137207, 52790.68673783541], "episode_lengths": [135, 135, 136, 135, 136, 136, 135, 137, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 134, 135, 136, 135, 136, 135, 135], "policy_agent_0_reward": [53176.68665313721, 48289.5137052536, 50774.85342788696, 53539.486598968506, 50595.95351409912, 51356.80679702759, 51827.40674209595, 45649.09992694855, 53352.9266204834, 53366.50015640259, 54378.607025146484, 50464.46020793915, 50825.62016105652, 53981.95341491699, 51940.427001953125, 53954.04666137695, 54519.48686981201, 53044.03330659866, 55163.18041372299, 51824.426882267, 56932.4602355957, 52622.87356185913, 55307.00006866455, 51774.593393325806, 53790.480125427246, 54821.1135559082, 46264.4333820343, 51853.15337753296, 53371.0403137207, 52790.68673783541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.151444202746994, "mean_inference_ms": 6.4421108320235545, "mean_action_processing_ms": 0.20098323670247503, "mean_env_wait_ms": 210.60181662997988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043184757232666016, "StateBufferConnector_ms": 0.006554126739501953, "ViewRequirementAgentConnector_ms": 0.24927457173665366}}, "episode_reward_max": 56932.4602355957, "episode_reward_min": 45649.09992694855, "episode_reward_mean": 52385.110361299914, "episode_len_mean": 135.23333333333332, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 45649.09992694855}, "policy_reward_max": {"agent_0": 56932.4602355957}, "policy_reward_mean": {"agent_0": 52385.110361299914}, "hist_stats": {"episode_reward": [53176.68665313721, 48289.5137052536, 50774.85342788696, 53539.486598968506, 50595.95351409912, 51356.80679702759, 51827.40674209595, 45649.09992694855, 53352.9266204834, 53366.50015640259, 54378.607025146484, 50464.46020793915, 50825.62016105652, 53981.95341491699, 51940.427001953125, 53954.04666137695, 54519.48686981201, 53044.03330659866, 55163.18041372299, 51824.426882267, 56932.4602355957, 52622.87356185913, 55307.00006866455, 51774.593393325806, 53790.480125427246, 54821.1135559082, 46264.4333820343, 51853.15337753296, 53371.0403137207, 52790.68673783541], "episode_lengths": [135, 135, 136, 135, 136, 136, 135, 137, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 134, 135, 136, 135, 136, 135, 135], "policy_agent_0_reward": [53176.68665313721, 48289.5137052536, 50774.85342788696, 53539.486598968506, 50595.95351409912, 51356.80679702759, 51827.40674209595, 45649.09992694855, 53352.9266204834, 53366.50015640259, 54378.607025146484, 50464.46020793915, 50825.62016105652, 53981.95341491699, 51940.427001953125, 53954.04666137695, 54519.48686981201, 53044.03330659866, 55163.18041372299, 51824.426882267, 56932.4602355957, 52622.87356185913, 55307.00006866455, 51774.593393325806, 53790.480125427246, 54821.1135559082, 46264.4333820343, 51853.15337753296, 53371.0403137207, 52790.68673783541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.151444202746994, "mean_inference_ms": 6.4421108320235545, "mean_action_processing_ms": 0.20098323670247503, "mean_env_wait_ms": 210.60181662997988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043184757232666016, "StateBufferConnector_ms": 0.006554126739501953, "ViewRequirementAgentConnector_ms": 0.24927457173665366}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.19369019072172, "num_env_steps_trained_throughput_per_sec": 214.19369019072172, "timesteps_total": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 16420.643, "sample_time_ms": 12182.086, "learn_time_ms": 4076.63, "learn_throughput": 981.203, "synch_weights_time_ms": 160.896}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 6760, "training_iteration": 231, "trial_id": "185f8_00000", "date": "2025-03-21_12-46-16", "timestamp": 1742561176, "time_this_iter_s": 18.72429347038269, "time_total_s": 3695.3421909809113, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3695.3421909809113, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 99.288, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981165885925293, "policy_loss": -0.01597709394991398, "vf_loss": 9.99512767791748, "vf_explained_var": -3.550139581420808e-06, "kl": 0.010074730962514877, "entropy": 0.35647138953208923, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "sampler_results": {"episode_reward_max": 52790.68673783541, "episode_reward_min": 52790.68673783541, "episode_reward_mean": 52790.68673783541, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52790.68673783541}, "policy_reward_max": {"agent_0": 52790.68673783541}, "policy_reward_mean": {"agent_0": 52790.68673783541}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52790.68673783541], "episode_lengths": [135], "policy_agent_0_reward": [52790.68673783541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.520321674887306, "mean_inference_ms": 6.32485681665907, "mean_action_processing_ms": 0.19114071274604277, "mean_env_wait_ms": 209.98341164083573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031828880310058594, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.13790130615234375}}, "episode_reward_max": 52790.68673783541, "episode_reward_min": 52790.68673783541, "episode_reward_mean": 52790.68673783541, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52790.68673783541}, "policy_reward_max": {"agent_0": 52790.68673783541}, "policy_reward_mean": {"agent_0": 52790.68673783541}, "hist_stats": {"episode_reward": [52790.68673783541], "episode_lengths": [135], "policy_agent_0_reward": [52790.68673783541]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.520321674887306, "mean_inference_ms": 6.32485681665907, "mean_action_processing_ms": 0.19114071274604277, "mean_env_wait_ms": 209.98341164083573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031828880310058594, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.13790130615234375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.4840911734593, "num_env_steps_trained_throughput_per_sec": 284.4840911734593, "timesteps_total": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 16312.5, "sample_time_ms": 12061.21, "learn_time_ms": 4094.434, "learn_throughput": 976.936, "synch_weights_time_ms": 155.783}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "episodes_total": 6760, "training_iteration": 232, "trial_id": "185f8_00000", "date": "2025-03-21_12-46-30", "timestamp": 1742561190, "time_this_iter_s": 14.122994184494019, "time_total_s": 3709.4651851654053, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3709.4651851654053, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 99.50952380952383, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.941370010375977, "policy_loss": -0.016727181151509285, "vf_loss": 9.9560546875, "vf_explained_var": -4.27501890953863e-06, "kl": 0.010212121531367302, "entropy": 0.3871791958808899, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "sampler_results": {"episode_reward_max": 57206.49317932129, "episode_reward_min": 48761.466628074646, "episode_reward_mean": 53318.519381556245, "episode_len_mean": 135.11111111111111, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"agent_0": 48761.466628074646}, "policy_reward_max": {"agent_0": 57206.49317932129}, "policy_reward_mean": {"agent_0": 53318.519381556245}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52323.953411102295, 56126.22019958496, 54254.15994262695, 53130.393463134766, 53757.12680435181, 55789.37353515625, 49466.26664352417, 55562.32684326172, 57206.49317932129, 52985.97356617451, 48761.466628074646, 50561.47340774536, 51175.72022151947, 53870.02029418945, 55783.07357263565, 52895.626832962036, 53462.63356208801, 52621.04676055908], "episode_lengths": [135, 135, 135, 135, 135, 134, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [52323.953411102295, 56126.22019958496, 54254.15994262695, 53130.393463134766, 53757.12680435181, 55789.37353515625, 49466.26664352417, 55562.32684326172, 57206.49317932129, 52985.97356617451, 48761.466628074646, 50561.47340774536, 51175.72022151947, 53870.02029418945, 55783.07357263565, 52895.626832962036, 53462.63356208801, 52621.04676055908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.72901212422185, "mean_inference_ms": 6.607389261080522, "mean_action_processing_ms": 0.19979677999912898, "mean_env_wait_ms": 225.89055451290577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0953992207845052, "StateBufferConnector_ms": 0.00623729493882921, "ViewRequirementAgentConnector_ms": 0.2505514356825087}}, "episode_reward_max": 57206.49317932129, "episode_reward_min": 48761.466628074646, "episode_reward_mean": 53318.519381556245, "episode_len_mean": 135.11111111111111, "episodes_this_iter": 18, "policy_reward_min": {"agent_0": 48761.466628074646}, "policy_reward_max": {"agent_0": 57206.49317932129}, "policy_reward_mean": {"agent_0": 53318.519381556245}, "hist_stats": {"episode_reward": [52323.953411102295, 56126.22019958496, 54254.15994262695, 53130.393463134766, 53757.12680435181, 55789.37353515625, 49466.26664352417, 55562.32684326172, 57206.49317932129, 52985.97356617451, 48761.466628074646, 50561.47340774536, 51175.72022151947, 53870.02029418945, 55783.07357263565, 52895.626832962036, 53462.63356208801, 52621.04676055908], "episode_lengths": [135, 135, 135, 135, 135, 134, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [52323.953411102295, 56126.22019958496, 54254.15994262695, 53130.393463134766, 53757.12680435181, 55789.37353515625, 49466.26664352417, 55562.32684326172, 57206.49317932129, 52985.97356617451, 48761.466628074646, 50561.47340774536, 51175.72022151947, 53870.02029418945, 55783.07357263565, 52895.626832962036, 53462.63356208801, 52621.04676055908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.72901212422185, "mean_inference_ms": 6.607389261080522, "mean_action_processing_ms": 0.19979677999912898, "mean_env_wait_ms": 225.89055451290577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0953992207845052, "StateBufferConnector_ms": 0.00623729493882921, "ViewRequirementAgentConnector_ms": 0.2505514356825087}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.29443737181765, "num_env_steps_trained_throughput_per_sec": 287.29443737181765, "timesteps_total": 932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 16022.317, "sample_time_ms": 11829.268, "learn_time_ms": 4052.066, "learn_throughput": 987.151, "synch_weights_time_ms": 140.061}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "done": false, "episodes_total": 6778, "training_iteration": 233, "trial_id": "185f8_00000", "date": "2025-03-21_12-46-44", "timestamp": 1742561204, "time_this_iter_s": 13.977704524993896, "time_total_s": 3723.442889690399, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3723.442889690399, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 98.81052631578947, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.64, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.796388626098633, "policy_loss": -0.01901094987988472, "vf_loss": 9.813239097595215, "vf_explained_var": 4.443650425400847e-07, "kl": 0.010801654309034348, "entropy": 0.385967880487442, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 58445.62043762207, "episode_reward_min": 42759.20035839081, "episode_reward_mean": 53265.77259683609, "episode_len_mean": 135.14666666666668, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 42759.20035839081}, "policy_reward_max": {"agent_0": 58445.62043762207}, "policy_reward_mean": {"agent_0": 53265.77259683609}, "custom_metrics": {"num_batches_mean": 5.64, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54466.52671813965, 54896.926765441895, 54551.46676635742, 54022.100021362305, 49530.6199760437, 50603.24026584625, 54412.840240478516, 42759.20035839081, 55531.293464660645, 55203.273471832275, 53009.973693847656, 53284.36005401611, 53809.69351387024, 46794.020090818405, 54037.48670196533, 54763.01341629028, 54379.25352692604, 52296.08029174805, 53708.6600189209, 56908.40698432922, 56338.04666137695, 53025.68674182892, 54768.73366355896, 51828.106842041016, 58445.62043762207, 53891.07360458374, 50459.140256881714, 53561.81329059601, 55868.09345245361, 49568.026804447174, 52668.5733833313, 53995.52674674988, 53300.19992637634, 54876.533462524414, 51583.03342914581, 53164.18692398071, 52644.846740722656, 52729.653482437134, 54807.54019165039, 49615.54013442993, 56568.320360183716, 55346.220039367676, 52434.96003341675, 53917.72685241699, 55095.206886291504, 51170.60669898987, 50189.12657737732, 52831.30689239502, 55135.733306884766, 51915.78680419922, 56360.753786087036, 55510.726989746094, 51102.213450431824, 54052.313552856445, 54704.026723861694, 53081.01344680786, 49868.726764678955, 57144.42663574219, 54794.293643951416, 52133.96683883667, 53743.74020385742, 51324.36711883545, 55592.13362121582, 54375.48000335693, 47430.52008342743, 53448.45999145508, 54647.353523254395, 52259.460094451904, 55497.82019042969, 55384.0803565979, 46934.44670200348, 50575.64679336548, 55111.020095825195, 55613.43383598328, 53529.11334609985], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 136, 136, 137, 135, 135, 135, 135, 135, 135, 134, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135], "policy_agent_0_reward": [54466.52671813965, 54896.926765441895, 54551.46676635742, 54022.100021362305, 49530.6199760437, 50603.24026584625, 54412.840240478516, 42759.20035839081, 55531.293464660645, 55203.273471832275, 53009.973693847656, 53284.36005401611, 53809.69351387024, 46794.020090818405, 54037.48670196533, 54763.01341629028, 54379.25352692604, 52296.08029174805, 53708.6600189209, 56908.40698432922, 56338.04666137695, 53025.68674182892, 54768.73366355896, 51828.106842041016, 58445.62043762207, 53891.07360458374, 50459.140256881714, 53561.81329059601, 55868.09345245361, 49568.026804447174, 52668.5733833313, 53995.52674674988, 53300.19992637634, 54876.533462524414, 51583.03342914581, 53164.18692398071, 52644.846740722656, 52729.653482437134, 54807.54019165039, 49615.54013442993, 56568.320360183716, 55346.220039367676, 52434.96003341675, 53917.72685241699, 55095.206886291504, 51170.60669898987, 50189.12657737732, 52831.30689239502, 55135.733306884766, 51915.78680419922, 56360.753786087036, 55510.726989746094, 51102.213450431824, 54052.313552856445, 54704.026723861694, 53081.01344680786, 49868.726764678955, 57144.42663574219, 54794.293643951416, 52133.96683883667, 53743.74020385742, 51324.36711883545, 55592.13362121582, 54375.48000335693, 47430.52008342743, 53448.45999145508, 54647.353523254395, 52259.460094451904, 55497.82019042969, 55384.0803565979, 46934.44670200348, 50575.64679336548, 55111.020095825195, 55613.43383598328, 53529.11334609985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.16288125839949, "mean_inference_ms": 6.717486882465566, "mean_action_processing_ms": 0.19907497161856177, "mean_env_wait_ms": 225.8208710369033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048472086588541664, "StateBufferConnector_ms": 0.0061422983805338545, "ViewRequirementAgentConnector_ms": 0.3248097101847331}}, "episode_reward_max": 58445.62043762207, "episode_reward_min": 42759.20035839081, "episode_reward_mean": 53265.77259683609, "episode_len_mean": 135.14666666666668, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 42759.20035839081}, "policy_reward_max": {"agent_0": 58445.62043762207}, "policy_reward_mean": {"agent_0": 53265.77259683609}, "hist_stats": {"episode_reward": [54466.52671813965, 54896.926765441895, 54551.46676635742, 54022.100021362305, 49530.6199760437, 50603.24026584625, 54412.840240478516, 42759.20035839081, 55531.293464660645, 55203.273471832275, 53009.973693847656, 53284.36005401611, 53809.69351387024, 46794.020090818405, 54037.48670196533, 54763.01341629028, 54379.25352692604, 52296.08029174805, 53708.6600189209, 56908.40698432922, 56338.04666137695, 53025.68674182892, 54768.73366355896, 51828.106842041016, 58445.62043762207, 53891.07360458374, 50459.140256881714, 53561.81329059601, 55868.09345245361, 49568.026804447174, 52668.5733833313, 53995.52674674988, 53300.19992637634, 54876.533462524414, 51583.03342914581, 53164.18692398071, 52644.846740722656, 52729.653482437134, 54807.54019165039, 49615.54013442993, 56568.320360183716, 55346.220039367676, 52434.96003341675, 53917.72685241699, 55095.206886291504, 51170.60669898987, 50189.12657737732, 52831.30689239502, 55135.733306884766, 51915.78680419922, 56360.753786087036, 55510.726989746094, 51102.213450431824, 54052.313552856445, 54704.026723861694, 53081.01344680786, 49868.726764678955, 57144.42663574219, 54794.293643951416, 52133.96683883667, 53743.74020385742, 51324.36711883545, 55592.13362121582, 54375.48000335693, 47430.52008342743, 53448.45999145508, 54647.353523254395, 52259.460094451904, 55497.82019042969, 55384.0803565979, 46934.44670200348, 50575.64679336548, 55111.020095825195, 55613.43383598328, 53529.11334609985], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 136, 136, 137, 135, 135, 135, 135, 135, 135, 134, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135], "policy_agent_0_reward": [54466.52671813965, 54896.926765441895, 54551.46676635742, 54022.100021362305, 49530.6199760437, 50603.24026584625, 54412.840240478516, 42759.20035839081, 55531.293464660645, 55203.273471832275, 53009.973693847656, 53284.36005401611, 53809.69351387024, 46794.020090818405, 54037.48670196533, 54763.01341629028, 54379.25352692604, 52296.08029174805, 53708.6600189209, 56908.40698432922, 56338.04666137695, 53025.68674182892, 54768.73366355896, 51828.106842041016, 58445.62043762207, 53891.07360458374, 50459.140256881714, 53561.81329059601, 55868.09345245361, 49568.026804447174, 52668.5733833313, 53995.52674674988, 53300.19992637634, 54876.533462524414, 51583.03342914581, 53164.18692398071, 52644.846740722656, 52729.653482437134, 54807.54019165039, 49615.54013442993, 56568.320360183716, 55346.220039367676, 52434.96003341675, 53917.72685241699, 55095.206886291504, 51170.60669898987, 50189.12657737732, 52831.30689239502, 55135.733306884766, 51915.78680419922, 56360.753786087036, 55510.726989746094, 51102.213450431824, 54052.313552856445, 54704.026723861694, 53081.01344680786, 49868.726764678955, 57144.42663574219, 54794.293643951416, 52133.96683883667, 53743.74020385742, 51324.36711883545, 55592.13362121582, 54375.48000335693, 47430.52008342743, 53448.45999145508, 54647.353523254395, 52259.460094451904, 55497.82019042969, 55384.0803565979, 46934.44670200348, 50575.64679336548, 55111.020095825195, 55613.43383598328, 53529.11334609985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.16288125839949, "mean_inference_ms": 6.717486882465566, "mean_action_processing_ms": 0.19907497161856177, "mean_env_wait_ms": 225.8208710369033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048472086588541664, "StateBufferConnector_ms": 0.0061422983805338545, "ViewRequirementAgentConnector_ms": 0.3248097101847331}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.5662276364563, "num_env_steps_trained_throughput_per_sec": 203.5662276364563, "timesteps_total": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 16573.938, "sample_time_ms": 12388.933, "learn_time_ms": 4041.276, "learn_throughput": 989.786, "synch_weights_time_ms": 142.829}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 6853, "training_iteration": 234, "trial_id": "185f8_00000", "date": "2025-03-21_12-47-04", "timestamp": 1742561224, "time_this_iter_s": 19.70872163772583, "time_total_s": 3743.151611328125, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb54d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3743.151611328125, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 98.04642857142858, "ram_util_percent": 13.792857142857144}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906585693359375, "policy_loss": -0.01522186677902937, "vf_loss": 9.919921875, "vf_explained_var": 1.3951212451956962e-07, "kl": 0.00943201594054699, "entropy": 0.33108556270599365, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "sampler_results": {"episode_reward_max": 57104.400146484375, "episode_reward_min": 46520.68030357361, "episode_reward_mean": 52512.261424295364, "episode_len_mean": 135.16129032258064, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 46520.68030357361}, "policy_reward_max": {"agent_0": 57104.400146484375}, "policy_reward_mean": {"agent_0": 52512.261424295364}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54686.47999191284, 53882.719999313354, 51868.6868057251, 49729.11324882507, 53511.29320526123, 47681.31346178055, 48228.913412094116, 53346.280113220215, 50253.23336982727, 56258.786849975586, 53541.2001953125, 51873.37373352051, 46836.68019199371, 54643.63355636597, 53564.71353340149, 53330.3134765625, 55346.83351898193, 56134.40002441406, 52324.02005004883, 54993.88017272949, 46520.68030357361, 49354.41330528259, 53246.21326637268, 56084.633586883545, 48732.90026473999, 50654.32669353485, 57104.400146484375, 53405.98686981201, 53991.55346107483, 53167.16054916382, 53581.96679496765], "episode_lengths": [135, 134, 136, 134, 135, 137, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [54686.47999191284, 53882.719999313354, 51868.6868057251, 49729.11324882507, 53511.29320526123, 47681.31346178055, 48228.913412094116, 53346.280113220215, 50253.23336982727, 56258.786849975586, 53541.2001953125, 51873.37373352051, 46836.68019199371, 54643.63355636597, 53564.71353340149, 53330.3134765625, 55346.83351898193, 56134.40002441406, 52324.02005004883, 54993.88017272949, 46520.68030357361, 49354.41330528259, 53246.21326637268, 56084.633586883545, 48732.90026473999, 50654.32669353485, 57104.400146484375, 53405.98686981201, 53991.55346107483, 53167.16054916382, 53581.96679496765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.25426759787913, "mean_inference_ms": 6.424458436737951, "mean_action_processing_ms": 0.20093458751395485, "mean_env_wait_ms": 210.51902105943554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04421049548733619, "StateBufferConnector_ms": 0.006498829010994204, "ViewRequirementAgentConnector_ms": 0.19792818254040134}}, "episode_reward_max": 57104.400146484375, "episode_reward_min": 46520.68030357361, "episode_reward_mean": 52512.261424295364, "episode_len_mean": 135.16129032258064, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 46520.68030357361}, "policy_reward_max": {"agent_0": 57104.400146484375}, "policy_reward_mean": {"agent_0": 52512.261424295364}, "hist_stats": {"episode_reward": [54686.47999191284, 53882.719999313354, 51868.6868057251, 49729.11324882507, 53511.29320526123, 47681.31346178055, 48228.913412094116, 53346.280113220215, 50253.23336982727, 56258.786849975586, 53541.2001953125, 51873.37373352051, 46836.68019199371, 54643.63355636597, 53564.71353340149, 53330.3134765625, 55346.83351898193, 56134.40002441406, 52324.02005004883, 54993.88017272949, 46520.68030357361, 49354.41330528259, 53246.21326637268, 56084.633586883545, 48732.90026473999, 50654.32669353485, 57104.400146484375, 53405.98686981201, 53991.55346107483, 53167.16054916382, 53581.96679496765], "episode_lengths": [135, 134, 136, 134, 135, 137, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [54686.47999191284, 53882.719999313354, 51868.6868057251, 49729.11324882507, 53511.29320526123, 47681.31346178055, 48228.913412094116, 53346.280113220215, 50253.23336982727, 56258.786849975586, 53541.2001953125, 51873.37373352051, 46836.68019199371, 54643.63355636597, 53564.71353340149, 53330.3134765625, 55346.83351898193, 56134.40002441406, 52324.02005004883, 54993.88017272949, 46520.68030357361, 49354.41330528259, 53246.21326637268, 56084.633586883545, 48732.90026473999, 50654.32669353485, 57104.400146484375, 53405.98686981201, 53991.55346107483, 53167.16054916382, 53581.96679496765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.25426759787913, "mean_inference_ms": 6.424458436737951, "mean_action_processing_ms": 0.20093458751395485, "mean_env_wait_ms": 210.51902105943554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04421049548733619, "StateBufferConnector_ms": 0.006498829010994204, "ViewRequirementAgentConnector_ms": 0.19792818254040134}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.5749650681063, "num_env_steps_trained_throughput_per_sec": 217.5749650681063, "timesteps_total": 940000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 16508.601, "sample_time_ms": 12305.933, "learn_time_ms": 4066.457, "learn_throughput": 983.657, "synch_weights_time_ms": 135.294}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "done": false, "episodes_total": 6884, "training_iteration": 235, "trial_id": "185f8_00000", "date": "2025-03-21_12-47-23", "timestamp": 1742561243, "time_this_iter_s": 18.448964834213257, "time_total_s": 3761.6005761623383, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2da20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3761.6005761623383, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 99.38000000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986218452453613, "policy_loss": -0.015441272407770157, "vf_loss": 10.0, "vf_explained_var": -6.631637461396167e-07, "kl": 0.008298494853079319, "entropy": 0.3469836413860321, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "sampler_results": {"episode_reward_max": 53581.96679496765, "episode_reward_min": 53581.96679496765, "episode_reward_mean": 53581.96679496765, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53581.96679496765}, "policy_reward_max": {"agent_0": 53581.96679496765}, "policy_reward_mean": {"agent_0": 53581.96679496765}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53581.96679496765], "episode_lengths": [136], "policy_agent_0_reward": [53581.96679496765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.80958883807855, "mean_inference_ms": 6.298717301552169, "mean_action_processing_ms": 0.19098145867082617, "mean_env_wait_ms": 209.7139718177209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05230903625488281, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.19693374633789062}}, "episode_reward_max": 53581.96679496765, "episode_reward_min": 53581.96679496765, "episode_reward_mean": 53581.96679496765, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53581.96679496765}, "policy_reward_max": {"agent_0": 53581.96679496765}, "policy_reward_mean": {"agent_0": 53581.96679496765}, "hist_stats": {"episode_reward": [53581.96679496765], "episode_lengths": [136], "policy_agent_0_reward": [53581.96679496765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.80958883807855, "mean_inference_ms": 6.298717301552169, "mean_action_processing_ms": 0.19098145867082617, "mean_env_wait_ms": 209.7139718177209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05230903625488281, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.19693374633789062}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.18049042339106, "num_env_steps_trained_throughput_per_sec": 288.18049042339106, "timesteps_total": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 16528.509, "sample_time_ms": 12277.818, "learn_time_ms": 4112.242, "learn_throughput": 972.705, "synch_weights_time_ms": 137.416}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "episodes_total": 6884, "training_iteration": 236, "trial_id": "185f8_00000", "date": "2025-03-21_12-47-37", "timestamp": 1742561257, "time_this_iter_s": 13.940495014190674, "time_total_s": 3775.541071176529, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb57e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3775.541071176529, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 99.53, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9796142578125, "policy_loss": -0.016996195539832115, "vf_loss": 9.994629859924316, "vf_explained_var": 3.3813219602052413e-07, "kl": 0.009901478886604309, "entropy": 0.3502890169620514, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 54221.300285339355, "episode_reward_min": 54221.300285339355, "episode_reward_mean": 54221.300285339355, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54221.300285339355}, "policy_reward_max": {"agent_0": 54221.300285339355}, "policy_reward_mean": {"agent_0": 54221.300285339355}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54221.300285339355], "episode_lengths": [135], "policy_agent_0_reward": [54221.300285339355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.67578193900926, "mean_inference_ms": 6.376968187647739, "mean_action_processing_ms": 0.19745251499042749, "mean_env_wait_ms": 222.34261490124655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03807544708251953, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.1693248748779297}}, "episode_reward_max": 54221.300285339355, "episode_reward_min": 54221.300285339355, "episode_reward_mean": 54221.300285339355, "episode_len_mean": 135.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54221.300285339355}, "policy_reward_max": {"agent_0": 54221.300285339355}, "policy_reward_mean": {"agent_0": 54221.300285339355}, "hist_stats": {"episode_reward": [54221.300285339355], "episode_lengths": [135], "policy_agent_0_reward": [54221.300285339355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.67578193900926, "mean_inference_ms": 6.376968187647739, "mean_action_processing_ms": 0.19745251499042749, "mean_env_wait_ms": 222.34261490124655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03807544708251953, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.1693248748779297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.5902759191491, "num_env_steps_trained_throughput_per_sec": 286.5902759191491, "timesteps_total": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 16237.183, "sample_time_ms": 11991.166, "learn_time_ms": 4103.915, "learn_throughput": 974.679, "synch_weights_time_ms": 141.095}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 6885, "training_iteration": 237, "trial_id": "185f8_00000", "date": "2025-03-21_12-47-51", "timestamp": 1742561271, "time_this_iter_s": 14.021852016448975, "time_total_s": 3789.562923192978, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2dab0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3789.562923192978, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 99.62000000000002, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0989010989010985, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.756353378295898, "policy_loss": -0.016743632033467293, "vf_loss": 9.771240234375, "vf_explained_var": -1.0269383921013286e-07, "kl": 0.00928096380084753, "entropy": 0.3512718975543976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "sampler_results": {"episode_reward_max": 59052.106994628906, "episode_reward_min": 44553.62679386139, "episode_reward_mean": 52948.045527255796, "episode_len_mean": 135.0989010989011, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 44553.62679386139}, "policy_reward_max": {"agent_0": 59052.106994628906}, "policy_reward_mean": {"agent_0": 52948.045527255796}, "custom_metrics": {"num_batches_mean": 5.0989010989010985, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [44553.62679386139, 53083.17370223999, 53719.86666870117, 55002.107011795044, 59052.106994628906, 46342.65352869034, 52597.11351776123, 49071.166858673096, 52684.773345947266, 49185.10006660223, 54647.25343322754, 57882.393630981445, 52442.21365356445, 57138.46694564819, 54709.29347229004, 51121.69368171692, 51367.873668670654, 54795.64029312134, 52640.54676055908, 56096.82678222656, 54117.13994598389, 57020.81359863281, 47555.06669998169, 55542.820220947266, 50804.200117111206, 54752.28707885742, 51471.60675048828, 52034.4868144989, 50848.67358779907, 51616.233358860016, 53627.226764678955, 54625.57361602783, 54009.05358886719, 46451.48672866821, 57286.70666503906, 48377.74680137634, 53737.267013549805, 49323.80012893677, 55025.66689300537, 55577.887073516846, 56972.76710510254, 53534.89347743988, 49508.199962973595, 55179.7003364563, 56652.94692993164, 58109.31358337402, 49856.75346779823, 50863.87334537506, 56517.800384521484, 54965.14005279541, 54576.83341217041, 53503.48003387451, 55795.660415649414, 51520.0134601593, 53037.72012233734, 53780.686950683594, 50761.626796245575, 51165.71334648132, 51813.386758327484, 49710.75335121155, 54899.00019073486, 55271.54674911499, 55365.000418663025, 49593.28000831604, 49916.36692714691, 47155.366552352905, 54931.66008758545, 49428.413513183594, 52853.08023071289, 57021.006996154785, 50293.22026062012, 55044.76662635803, 51901.133538246155, 54639.22018241882, 54971.14673614502, 56372.44031524658, 53379.15348815918, 47737.51347744465, 55523.68028259277, 55372.80702209473, 54220.67362976074, 49495.620056152344, 57278.57354736328, 47854.80673980713, 49629.640197753906, 53791.900035858154, 52898.86010932922, 53723.286865234375, 47547.133400440216, 56573.67361450195, 53821.27363014221], "episode_lengths": [136, 135, 135, 135, 134, 136, 135, 136, 135, 135, 135, 134, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 134, 135, 137, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 134, 134, 135, 135, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 134, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [44553.62679386139, 53083.17370223999, 53719.86666870117, 55002.107011795044, 59052.106994628906, 46342.65352869034, 52597.11351776123, 49071.166858673096, 52684.773345947266, 49185.10006660223, 54647.25343322754, 57882.393630981445, 52442.21365356445, 57138.46694564819, 54709.29347229004, 51121.69368171692, 51367.873668670654, 54795.64029312134, 52640.54676055908, 56096.82678222656, 54117.13994598389, 57020.81359863281, 47555.06669998169, 55542.820220947266, 50804.200117111206, 54752.28707885742, 51471.60675048828, 52034.4868144989, 50848.67358779907, 51616.233358860016, 53627.226764678955, 54625.57361602783, 54009.05358886719, 46451.48672866821, 57286.70666503906, 48377.74680137634, 53737.267013549805, 49323.80012893677, 55025.66689300537, 55577.887073516846, 56972.76710510254, 53534.89347743988, 49508.199962973595, 55179.7003364563, 56652.94692993164, 58109.31358337402, 49856.75346779823, 50863.87334537506, 56517.800384521484, 54965.14005279541, 54576.83341217041, 53503.48003387451, 55795.660415649414, 51520.0134601593, 53037.72012233734, 53780.686950683594, 50761.626796245575, 51165.71334648132, 51813.386758327484, 49710.75335121155, 54899.00019073486, 55271.54674911499, 55365.000418663025, 49593.28000831604, 49916.36692714691, 47155.366552352905, 54931.66008758545, 49428.413513183594, 52853.08023071289, 57021.006996154785, 50293.22026062012, 55044.76662635803, 51901.133538246155, 54639.22018241882, 54971.14673614502, 56372.44031524658, 53379.15348815918, 47737.51347744465, 55523.68028259277, 55372.80702209473, 54220.67362976074, 49495.620056152344, 57278.57354736328, 47854.80673980713, 49629.640197753906, 53791.900035858154, 52898.86010932922, 53723.286865234375, 47547.133400440216, 56573.67361450195, 53821.27363014221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.433787502287295, "mean_inference_ms": 6.705417830726673, "mean_action_processing_ms": 0.19917708036495055, "mean_env_wait_ms": 226.01658107234678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07145326216142256, "StateBufferConnector_ms": 0.006379137982378949, "ViewRequirementAgentConnector_ms": 0.27100515889597465}}, "episode_reward_max": 59052.106994628906, "episode_reward_min": 44553.62679386139, "episode_reward_mean": 52948.045527255796, "episode_len_mean": 135.0989010989011, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 44553.62679386139}, "policy_reward_max": {"agent_0": 59052.106994628906}, "policy_reward_mean": {"agent_0": 52948.045527255796}, "hist_stats": {"episode_reward": [44553.62679386139, 53083.17370223999, 53719.86666870117, 55002.107011795044, 59052.106994628906, 46342.65352869034, 52597.11351776123, 49071.166858673096, 52684.773345947266, 49185.10006660223, 54647.25343322754, 57882.393630981445, 52442.21365356445, 57138.46694564819, 54709.29347229004, 51121.69368171692, 51367.873668670654, 54795.64029312134, 52640.54676055908, 56096.82678222656, 54117.13994598389, 57020.81359863281, 47555.06669998169, 55542.820220947266, 50804.200117111206, 54752.28707885742, 51471.60675048828, 52034.4868144989, 50848.67358779907, 51616.233358860016, 53627.226764678955, 54625.57361602783, 54009.05358886719, 46451.48672866821, 57286.70666503906, 48377.74680137634, 53737.267013549805, 49323.80012893677, 55025.66689300537, 55577.887073516846, 56972.76710510254, 53534.89347743988, 49508.199962973595, 55179.7003364563, 56652.94692993164, 58109.31358337402, 49856.75346779823, 50863.87334537506, 56517.800384521484, 54965.14005279541, 54576.83341217041, 53503.48003387451, 55795.660415649414, 51520.0134601593, 53037.72012233734, 53780.686950683594, 50761.626796245575, 51165.71334648132, 51813.386758327484, 49710.75335121155, 54899.00019073486, 55271.54674911499, 55365.000418663025, 49593.28000831604, 49916.36692714691, 47155.366552352905, 54931.66008758545, 49428.413513183594, 52853.08023071289, 57021.006996154785, 50293.22026062012, 55044.76662635803, 51901.133538246155, 54639.22018241882, 54971.14673614502, 56372.44031524658, 53379.15348815918, 47737.51347744465, 55523.68028259277, 55372.80702209473, 54220.67362976074, 49495.620056152344, 57278.57354736328, 47854.80673980713, 49629.640197753906, 53791.900035858154, 52898.86010932922, 53723.286865234375, 47547.133400440216, 56573.67361450195, 53821.27363014221], "episode_lengths": [136, 135, 135, 135, 134, 136, 135, 136, 135, 135, 135, 134, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 134, 135, 137, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 134, 134, 135, 135, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 134, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [44553.62679386139, 53083.17370223999, 53719.86666870117, 55002.107011795044, 59052.106994628906, 46342.65352869034, 52597.11351776123, 49071.166858673096, 52684.773345947266, 49185.10006660223, 54647.25343322754, 57882.393630981445, 52442.21365356445, 57138.46694564819, 54709.29347229004, 51121.69368171692, 51367.873668670654, 54795.64029312134, 52640.54676055908, 56096.82678222656, 54117.13994598389, 57020.81359863281, 47555.06669998169, 55542.820220947266, 50804.200117111206, 54752.28707885742, 51471.60675048828, 52034.4868144989, 50848.67358779907, 51616.233358860016, 53627.226764678955, 54625.57361602783, 54009.05358886719, 46451.48672866821, 57286.70666503906, 48377.74680137634, 53737.267013549805, 49323.80012893677, 55025.66689300537, 55577.887073516846, 56972.76710510254, 53534.89347743988, 49508.199962973595, 55179.7003364563, 56652.94692993164, 58109.31358337402, 49856.75346779823, 50863.87334537506, 56517.800384521484, 54965.14005279541, 54576.83341217041, 53503.48003387451, 55795.660415649414, 51520.0134601593, 53037.72012233734, 53780.686950683594, 50761.626796245575, 51165.71334648132, 51813.386758327484, 49710.75335121155, 54899.00019073486, 55271.54674911499, 55365.000418663025, 49593.28000831604, 49916.36692714691, 47155.366552352905, 54931.66008758545, 49428.413513183594, 52853.08023071289, 57021.006996154785, 50293.22026062012, 55044.76662635803, 51901.133538246155, 54639.22018241882, 54971.14673614502, 56372.44031524658, 53379.15348815918, 47737.51347744465, 55523.68028259277, 55372.80702209473, 54220.67362976074, 49495.620056152344, 57278.57354736328, 47854.80673980713, 49629.640197753906, 53791.900035858154, 52898.86010932922, 53723.286865234375, 47547.133400440216, 56573.67361450195, 53821.27363014221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.433787502287295, "mean_inference_ms": 6.705417830726673, "mean_action_processing_ms": 0.19917708036495055, "mean_env_wait_ms": 226.01658107234678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07145326216142256, "StateBufferConnector_ms": 0.006379137982378949, "ViewRequirementAgentConnector_ms": 0.27100515889597465}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.93689382840842, "num_env_steps_trained_throughput_per_sec": 205.93689382840842, "timesteps_total": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 16676.902, "sample_time_ms": 12440.289, "learn_time_ms": 4096.411, "learn_throughput": 976.464, "synch_weights_time_ms": 139.197}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "episodes_total": 6976, "training_iteration": 238, "trial_id": "185f8_00000", "date": "2025-03-21_12-48-10", "timestamp": 1742561290, "time_this_iter_s": 19.487711906433105, "time_total_s": 3809.050635099411, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7a950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3809.050635099411, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 96.81111111111113, "ram_util_percent": 13.785185185185187}}
{"custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.907672882080078, "policy_loss": -0.014794619753956795, "vf_loss": 9.92041015625, "vf_explained_var": 8.883575333129556e-07, "kl": 0.010288723744452, "entropy": 0.3738437294960022, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "sampler_results": {"episode_reward_max": 56505.83361816406, "episode_reward_min": 49196.44020962715, "episode_reward_mean": 52696.05453632027, "episode_len_mean": 135.15625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 49196.44020962715}, "policy_reward_max": {"agent_0": 56505.83361816406}, "policy_reward_mean": {"agent_0": 52696.05453632027}, "custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49196.44020962715, 56113.39356994629, 52378.70682144165, 55047.22682952881, 55719.980197906494, 52443.03335952759, 50845.34005641937, 54510.53353881836, 54742.373458862305, 50241.93347167969, 50438.76014709473, 53046.007038354874, 49779.526849746704, 52452.913665771484, 55253.07328796387, 49965.39336967468, 51349.24678647518, 49528.18656384945, 52919.55361557007, 56505.83361816406, 54606.86033630371, 50806.293491363525, 50894.453269958496, 50571.266859054565, 50046.960050582886, 56341.29364013672, 52985.680210113525, 49373.34678649902, 54569.98024749756, 55622.24671173096, 55803.13359832764, 52174.7735042572], "episode_lengths": [136, 135, 136, 135, 135, 135, 135, 134, 135, 136, 136, 135, 135, 135, 134, 135, 135, 136, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [49196.44020962715, 56113.39356994629, 52378.70682144165, 55047.22682952881, 55719.980197906494, 52443.03335952759, 50845.34005641937, 54510.53353881836, 54742.373458862305, 50241.93347167969, 50438.76014709473, 53046.007038354874, 49779.526849746704, 52452.913665771484, 55253.07328796387, 49965.39336967468, 51349.24678647518, 49528.18656384945, 52919.55361557007, 56505.83361816406, 54606.86033630371, 50806.293491363525, 50894.453269958496, 50571.266859054565, 50046.960050582886, 56341.29364013672, 52985.680210113525, 49373.34678649902, 54569.98024749756, 55622.24671173096, 55803.13359832764, 52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.15016389663877, "mean_inference_ms": 6.42601420827074, "mean_action_processing_ms": 0.2008917265426194, "mean_env_wait_ms": 210.47370344151045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042088329792022705, "StateBufferConnector_ms": 0.006340444087982178, "ViewRequirementAgentConnector_ms": 0.21494701504707336}}, "episode_reward_max": 56505.83361816406, "episode_reward_min": 49196.44020962715, "episode_reward_mean": 52696.05453632027, "episode_len_mean": 135.15625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 49196.44020962715}, "policy_reward_max": {"agent_0": 56505.83361816406}, "policy_reward_mean": {"agent_0": 52696.05453632027}, "hist_stats": {"episode_reward": [49196.44020962715, 56113.39356994629, 52378.70682144165, 55047.22682952881, 55719.980197906494, 52443.03335952759, 50845.34005641937, 54510.53353881836, 54742.373458862305, 50241.93347167969, 50438.76014709473, 53046.007038354874, 49779.526849746704, 52452.913665771484, 55253.07328796387, 49965.39336967468, 51349.24678647518, 49528.18656384945, 52919.55361557007, 56505.83361816406, 54606.86033630371, 50806.293491363525, 50894.453269958496, 50571.266859054565, 50046.960050582886, 56341.29364013672, 52985.680210113525, 49373.34678649902, 54569.98024749756, 55622.24671173096, 55803.13359832764, 52174.7735042572], "episode_lengths": [136, 135, 136, 135, 135, 135, 135, 134, 135, 136, 136, 135, 135, 135, 134, 135, 135, 136, 136, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [49196.44020962715, 56113.39356994629, 52378.70682144165, 55047.22682952881, 55719.980197906494, 52443.03335952759, 50845.34005641937, 54510.53353881836, 54742.373458862305, 50241.93347167969, 50438.76014709473, 53046.007038354874, 49779.526849746704, 52452.913665771484, 55253.07328796387, 49965.39336967468, 51349.24678647518, 49528.18656384945, 52919.55361557007, 56505.83361816406, 54606.86033630371, 50806.293491363525, 50894.453269958496, 50571.266859054565, 50046.960050582886, 56341.29364013672, 52985.680210113525, 49373.34678649902, 54569.98024749756, 55622.24671173096, 55803.13359832764, 52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.15016389663877, "mean_inference_ms": 6.42601420827074, "mean_action_processing_ms": 0.2008917265426194, "mean_env_wait_ms": 210.47370344151045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042088329792022705, "StateBufferConnector_ms": 0.006340444087982178, "ViewRequirementAgentConnector_ms": 0.21494701504707336}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.03699593049885, "num_env_steps_trained_throughput_per_sec": 211.03699593049885, "timesteps_total": 956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 16830.593, "sample_time_ms": 12531.474, "learn_time_ms": 4151.779, "learn_throughput": 963.442, "synch_weights_time_ms": 146.391}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "done": false, "episodes_total": 7008, "training_iteration": 239, "trial_id": "185f8_00000", "date": "2025-03-21_12-48-29", "timestamp": 1742561309, "time_this_iter_s": 19.010869026184082, "time_total_s": 3828.061504125595, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefda20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3828.061504125595, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 99.23846153846155, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984416007995605, "policy_loss": -0.018067728728055954, "vf_loss": 10.0, "vf_explained_var": 5.795930633212265e-07, "kl": 0.012416008859872818, "entropy": 0.4172229766845703, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 52174.7735042572, "episode_reward_min": 52174.7735042572, "episode_reward_mean": 52174.7735042572, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52174.7735042572}, "policy_reward_max": {"agent_0": 52174.7735042572}, "policy_reward_mean": {"agent_0": 52174.7735042572}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52174.7735042572], "episode_lengths": [136], "policy_agent_0_reward": [52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.20784580103041, "mean_inference_ms": 6.301748704233228, "mean_action_processing_ms": 0.1907567767535939, "mean_env_wait_ms": 209.5829462122482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043010711669921875, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16586780548095703}}, "episode_reward_max": 52174.7735042572, "episode_reward_min": 52174.7735042572, "episode_reward_mean": 52174.7735042572, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52174.7735042572}, "policy_reward_max": {"agent_0": 52174.7735042572}, "policy_reward_mean": {"agent_0": 52174.7735042572}, "hist_stats": {"episode_reward": [52174.7735042572], "episode_lengths": [136], "policy_agent_0_reward": [52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.20784580103041, "mean_inference_ms": 6.301748704233228, "mean_action_processing_ms": 0.1907567767535939, "mean_env_wait_ms": 209.5829462122482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043010711669921875, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16586780548095703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.3478496912993, "num_env_steps_trained_throughput_per_sec": 274.3478496912993, "timesteps_total": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 16548.64, "sample_time_ms": 12175.985, "learn_time_ms": 4229.695, "learn_throughput": 945.695, "synch_weights_time_ms": 142.033}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 7008, "training_iteration": 240, "trial_id": "185f8_00000", "date": "2025-03-21_12-48-44", "timestamp": 1742561324, "time_this_iter_s": 14.63954758644104, "time_total_s": 3842.701051712036, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3842.701051712036, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 99.55238095238094, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986580848693848, "policy_loss": -0.01567082479596138, "vf_loss": 10.0, "vf_explained_var": 2.971540027374431e-07, "kl": 0.011252613738179207, "entropy": 0.41389086842536926, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "sampler_results": {"episode_reward_max": 52174.7735042572, "episode_reward_min": 52174.7735042572, "episode_reward_mean": 52174.7735042572, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52174.7735042572}, "policy_reward_max": {"agent_0": 52174.7735042572}, "policy_reward_mean": {"agent_0": 52174.7735042572}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52174.7735042572], "episode_lengths": [136], "policy_agent_0_reward": [52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.20784580103041, "mean_inference_ms": 6.301748704233228, "mean_action_processing_ms": 0.1907567767535939, "mean_env_wait_ms": 209.5829462122482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043010711669921875, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16586780548095703}}, "episode_reward_max": 52174.7735042572, "episode_reward_min": 52174.7735042572, "episode_reward_mean": 52174.7735042572, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52174.7735042572}, "policy_reward_max": {"agent_0": 52174.7735042572}, "policy_reward_mean": {"agent_0": 52174.7735042572}, "hist_stats": {"episode_reward": [52174.7735042572], "episode_lengths": [136], "policy_agent_0_reward": [52174.7735042572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.20784580103041, "mean_inference_ms": 6.301748704233228, "mean_action_processing_ms": 0.1907567767535939, "mean_env_wait_ms": 209.5829462122482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043010711669921875, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.16586780548095703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.33812439551923, "num_env_steps_trained_throughput_per_sec": 268.33812439551923, "timesteps_total": 964000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 16171.821, "sample_time_ms": 11822.906, "learn_time_ms": 4199.133, "learn_throughput": 952.578, "synch_weights_time_ms": 148.83}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "done": false, "episodes_total": 7008, "training_iteration": 241, "trial_id": "185f8_00000", "date": "2025-03-21_12-48-59", "timestamp": 1742561339, "time_this_iter_s": 14.953407526016235, "time_total_s": 3857.6544592380524, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fde6200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3857.6544592380524, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 99.56190476190477, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.757341384887695, "policy_loss": -0.014599391259253025, "vf_loss": 9.770021438598633, "vf_explained_var": -6.405015824384463e-07, "kl": 0.009594563394784927, "entropy": 0.37508663535118103, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "sampler_results": {"episode_reward_max": 58349.46691894531, "episode_reward_min": 43854.93340396881, "episode_reward_mean": 52594.98036086948, "episode_len_mean": 135.25, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43854.93340396881}, "policy_reward_max": {"agent_0": 58349.46691894531}, "policy_reward_mean": {"agent_0": 52594.98036086948}, "custom_metrics": {"num_batches_mean": 5.010869565217392, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51615.45344209671, 49580.36018180847, 50747.83359336853, 53258.13343715668, 52779.89335632324, 53637.17331314087, 48620.78674507141, 53607.18688774109, 52624.57334136963, 54143.82009410858, 52901.20008468628, 51395.680278778076, 50145.733739852905, 52519.186758995056, 54549.34009552002, 51496.82006645203, 51930.73342895508, 54357.613761901855, 52331.74662780762, 54180.76013183594, 53995.59361076355, 52966.8402967453, 56808.5471496582, 52826.23338317871, 49632.02684259415, 51532.140209198, 52491.92000579834, 57851.800369262695, 51451.480306625366, 54867.646938323975, 52767.05325126648, 53957.3132019043, 50414.31375336647, 53809.14647293091, 52511.41343688965, 51924.74018287659, 53959.22012138367, 52634.56015110016, 53077.98021221161, 56310.813574790955, 57481.78678894043, 49458.02685928345, 55601.5866394043, 55874.22024536133, 51244.24679374695, 52289.646854400635, 49661.29998588562, 50107.29994046688, 53332.42674255371, 53621.00670623779, 52907.773584365845, 54037.40000915527, 52290.36020088196, 55824.553634643555, 50666.62658691406, 54503.87361907959, 52799.02012634277, 47246.30672073364, 46102.600175857544, 52813.486636161804, 51716.39363479614, 52981.91337966919, 49379.3200302124, 52954.81368255615, 48226.2399559021, 51360.673612594604, 58349.46691894531, 49058.506834983826, 57534.04692077637, 55094.94036483765, 48865.78012752533, 51692.91343688965, 43854.93340396881, 50432.88026046753, 55072.2002696991, 55442.25352478027, 54132.24025917053, 54840.70025253296, 52945.960247039795, 48737.57321929932, 54446.7732963562, 51981.780071258545, 48103.48654747009, 55386.97381591797, 50912.58003234863, 54166.4535484314, 51588.8800201416, 53215.79333329201, 53924.56007385254, 57500.49337768555, 52839.18014526367, 51919.12691307068], "episode_lengths": [135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 134, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [51615.45344209671, 49580.36018180847, 50747.83359336853, 53258.13343715668, 52779.89335632324, 53637.17331314087, 48620.78674507141, 53607.18688774109, 52624.57334136963, 54143.82009410858, 52901.20008468628, 51395.680278778076, 50145.733739852905, 52519.186758995056, 54549.34009552002, 51496.82006645203, 51930.73342895508, 54357.613761901855, 52331.74662780762, 54180.76013183594, 53995.59361076355, 52966.8402967453, 56808.5471496582, 52826.23338317871, 49632.02684259415, 51532.140209198, 52491.92000579834, 57851.800369262695, 51451.480306625366, 54867.646938323975, 52767.05325126648, 53957.3132019043, 50414.31375336647, 53809.14647293091, 52511.41343688965, 51924.74018287659, 53959.22012138367, 52634.56015110016, 53077.98021221161, 56310.813574790955, 57481.78678894043, 49458.02685928345, 55601.5866394043, 55874.22024536133, 51244.24679374695, 52289.646854400635, 49661.29998588562, 50107.29994046688, 53332.42674255371, 53621.00670623779, 52907.773584365845, 54037.40000915527, 52290.36020088196, 55824.553634643555, 50666.62658691406, 54503.87361907959, 52799.02012634277, 47246.30672073364, 46102.600175857544, 52813.486636161804, 51716.39363479614, 52981.91337966919, 49379.3200302124, 52954.81368255615, 48226.2399559021, 51360.673612594604, 58349.46691894531, 49058.506834983826, 57534.04692077637, 55094.94036483765, 48865.78012752533, 51692.91343688965, 43854.93340396881, 50432.88026046753, 55072.2002696991, 55442.25352478027, 54132.24025917053, 54840.70025253296, 52945.960247039795, 48737.57321929932, 54446.7732963562, 51981.780071258545, 48103.48654747009, 55386.97381591797, 50912.58003234863, 54166.4535484314, 51588.8800201416, 53215.79333329201, 53924.56007385254, 57500.49337768555, 52839.18014526367, 51919.12691307068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.36379918953885, "mean_inference_ms": 6.699036343625624, "mean_action_processing_ms": 0.1991228209827552, "mean_env_wait_ms": 226.1277289070951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05328810733297597, "StateBufferConnector_ms": 0.015305177025173021, "ViewRequirementAgentConnector_ms": 0.219003791394441}}, "episode_reward_max": 58349.46691894531, "episode_reward_min": 43854.93340396881, "episode_reward_mean": 52594.98036086948, "episode_len_mean": 135.25, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43854.93340396881}, "policy_reward_max": {"agent_0": 58349.46691894531}, "policy_reward_mean": {"agent_0": 52594.98036086948}, "hist_stats": {"episode_reward": [51615.45344209671, 49580.36018180847, 50747.83359336853, 53258.13343715668, 52779.89335632324, 53637.17331314087, 48620.78674507141, 53607.18688774109, 52624.57334136963, 54143.82009410858, 52901.20008468628, 51395.680278778076, 50145.733739852905, 52519.186758995056, 54549.34009552002, 51496.82006645203, 51930.73342895508, 54357.613761901855, 52331.74662780762, 54180.76013183594, 53995.59361076355, 52966.8402967453, 56808.5471496582, 52826.23338317871, 49632.02684259415, 51532.140209198, 52491.92000579834, 57851.800369262695, 51451.480306625366, 54867.646938323975, 52767.05325126648, 53957.3132019043, 50414.31375336647, 53809.14647293091, 52511.41343688965, 51924.74018287659, 53959.22012138367, 52634.56015110016, 53077.98021221161, 56310.813574790955, 57481.78678894043, 49458.02685928345, 55601.5866394043, 55874.22024536133, 51244.24679374695, 52289.646854400635, 49661.29998588562, 50107.29994046688, 53332.42674255371, 53621.00670623779, 52907.773584365845, 54037.40000915527, 52290.36020088196, 55824.553634643555, 50666.62658691406, 54503.87361907959, 52799.02012634277, 47246.30672073364, 46102.600175857544, 52813.486636161804, 51716.39363479614, 52981.91337966919, 49379.3200302124, 52954.81368255615, 48226.2399559021, 51360.673612594604, 58349.46691894531, 49058.506834983826, 57534.04692077637, 55094.94036483765, 48865.78012752533, 51692.91343688965, 43854.93340396881, 50432.88026046753, 55072.2002696991, 55442.25352478027, 54132.24025917053, 54840.70025253296, 52945.960247039795, 48737.57321929932, 54446.7732963562, 51981.780071258545, 48103.48654747009, 55386.97381591797, 50912.58003234863, 54166.4535484314, 51588.8800201416, 53215.79333329201, 53924.56007385254, 57500.49337768555, 52839.18014526367, 51919.12691307068], "episode_lengths": [135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 134, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 134, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [51615.45344209671, 49580.36018180847, 50747.83359336853, 53258.13343715668, 52779.89335632324, 53637.17331314087, 48620.78674507141, 53607.18688774109, 52624.57334136963, 54143.82009410858, 52901.20008468628, 51395.680278778076, 50145.733739852905, 52519.186758995056, 54549.34009552002, 51496.82006645203, 51930.73342895508, 54357.613761901855, 52331.74662780762, 54180.76013183594, 53995.59361076355, 52966.8402967453, 56808.5471496582, 52826.23338317871, 49632.02684259415, 51532.140209198, 52491.92000579834, 57851.800369262695, 51451.480306625366, 54867.646938323975, 52767.05325126648, 53957.3132019043, 50414.31375336647, 53809.14647293091, 52511.41343688965, 51924.74018287659, 53959.22012138367, 52634.56015110016, 53077.98021221161, 56310.813574790955, 57481.78678894043, 49458.02685928345, 55601.5866394043, 55874.22024536133, 51244.24679374695, 52289.646854400635, 49661.29998588562, 50107.29994046688, 53332.42674255371, 53621.00670623779, 52907.773584365845, 54037.40000915527, 52290.36020088196, 55824.553634643555, 50666.62658691406, 54503.87361907959, 52799.02012634277, 47246.30672073364, 46102.600175857544, 52813.486636161804, 51716.39363479614, 52981.91337966919, 49379.3200302124, 52954.81368255615, 48226.2399559021, 51360.673612594604, 58349.46691894531, 49058.506834983826, 57534.04692077637, 55094.94036483765, 48865.78012752533, 51692.91343688965, 43854.93340396881, 50432.88026046753, 55072.2002696991, 55442.25352478027, 54132.24025917053, 54840.70025253296, 52945.960247039795, 48737.57321929932, 54446.7732963562, 51981.780071258545, 48103.48654747009, 55386.97381591797, 50912.58003234863, 54166.4535484314, 51588.8800201416, 53215.79333329201, 53924.56007385254, 57500.49337768555, 52839.18014526367, 51919.12691307068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.36379918953885, "mean_inference_ms": 6.699036343625624, "mean_action_processing_ms": 0.1991228209827552, "mean_env_wait_ms": 226.1277289070951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05328810733297597, "StateBufferConnector_ms": 0.015305177025173021, "ViewRequirementAgentConnector_ms": 0.219003791394441}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.65330325022896, "num_env_steps_trained_throughput_per_sec": 206.65330325022896, "timesteps_total": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 16701.381, "sample_time_ms": 12345.693, "learn_time_ms": 4197.912, "learn_throughput": 952.855, "synch_weights_time_ms": 156.846}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "episodes_total": 7100, "training_iteration": 242, "trial_id": "185f8_00000", "date": "2025-03-21_12-49-19", "timestamp": 1742561359, "time_this_iter_s": 19.43690013885498, "time_total_s": 3877.0913593769073, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb1fd00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3877.0913593769073, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 95.48076923076923, "ram_util_percent": 13.792307692307693}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.904183387756348, "policy_loss": -0.017551351338624954, "vf_loss": 9.919921875, "vf_explained_var": -7.475416197166851e-08, "kl": 0.009063192643225193, "entropy": 0.3600047528743744, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 57693.06043243408, "episode_reward_min": 46647.48672962189, "episode_reward_mean": 53184.843916103244, "episode_len_mean": 135.15625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46647.48672962189}, "policy_reward_max": {"agent_0": 57693.06043243408}, "policy_reward_mean": {"agent_0": 53184.843916103244}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52520.41340446472, 54989.62014770508, 51262.0135910511, 52222.86020278931, 57693.06043243408, 55772.146896362305, 55655.666734695435, 55481.700103759766, 54639.840153217316, 50809.31350517273, 55834.19348144531, 46647.48672962189, 54618.759994506836, 48780.47333526611, 55701.99336719513, 53549.1934530735, 54014.57359313965, 51275.333225250244, 49961.82007217407, 56210.58008289337, 51376.72018814087, 54618.70691680908, 53194.433532714844, 55581.433433532715, 55218.42687988281, 52194.74016571045, 54884.23371505737, 51753.72028255463, 54638.00709915161, 48165.87369155884, 51369.593383312225, 51278.0735206604], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 136, 135], "policy_agent_0_reward": [52520.41340446472, 54989.62014770508, 51262.0135910511, 52222.86020278931, 57693.06043243408, 55772.146896362305, 55655.666734695435, 55481.700103759766, 54639.840153217316, 50809.31350517273, 55834.19348144531, 46647.48672962189, 54618.759994506836, 48780.47333526611, 55701.99336719513, 53549.1934530735, 54014.57359313965, 51275.333225250244, 49961.82007217407, 56210.58008289337, 51376.72018814087, 54618.70691680908, 53194.433532714844, 55581.433433532715, 55218.42687988281, 52194.74016571045, 54884.23371505737, 51753.72028255463, 54638.00709915161, 48165.87369155884, 51369.593383312225, 51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.06070984599002, "mean_inference_ms": 6.4237774588966605, "mean_action_processing_ms": 0.2010350995824819, "mean_env_wait_ms": 210.52309002476443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04308000206947327, "StateBufferConnector_ms": 0.006677955389022827, "ViewRequirementAgentConnector_ms": 0.3487996757030487}}, "episode_reward_max": 57693.06043243408, "episode_reward_min": 46647.48672962189, "episode_reward_mean": 53184.843916103244, "episode_len_mean": 135.15625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46647.48672962189}, "policy_reward_max": {"agent_0": 57693.06043243408}, "policy_reward_mean": {"agent_0": 53184.843916103244}, "hist_stats": {"episode_reward": [52520.41340446472, 54989.62014770508, 51262.0135910511, 52222.86020278931, 57693.06043243408, 55772.146896362305, 55655.666734695435, 55481.700103759766, 54639.840153217316, 50809.31350517273, 55834.19348144531, 46647.48672962189, 54618.759994506836, 48780.47333526611, 55701.99336719513, 53549.1934530735, 54014.57359313965, 51275.333225250244, 49961.82007217407, 56210.58008289337, 51376.72018814087, 54618.70691680908, 53194.433532714844, 55581.433433532715, 55218.42687988281, 52194.74016571045, 54884.23371505737, 51753.72028255463, 54638.00709915161, 48165.87369155884, 51369.593383312225, 51278.0735206604], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 134, 134, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 136, 135], "policy_agent_0_reward": [52520.41340446472, 54989.62014770508, 51262.0135910511, 52222.86020278931, 57693.06043243408, 55772.146896362305, 55655.666734695435, 55481.700103759766, 54639.840153217316, 50809.31350517273, 55834.19348144531, 46647.48672962189, 54618.759994506836, 48780.47333526611, 55701.99336719513, 53549.1934530735, 54014.57359313965, 51275.333225250244, 49961.82007217407, 56210.58008289337, 51376.72018814087, 54618.70691680908, 53194.433532714844, 55581.433433532715, 55218.42687988281, 52194.74016571045, 54884.23371505737, 51753.72028255463, 54638.00709915161, 48165.87369155884, 51369.593383312225, 51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.06070984599002, "mean_inference_ms": 6.4237774588966605, "mean_action_processing_ms": 0.2010350995824819, "mean_env_wait_ms": 210.52309002476443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04308000206947327, "StateBufferConnector_ms": 0.006677955389022827, "ViewRequirementAgentConnector_ms": 0.3487996757030487}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.17799899780616, "num_env_steps_trained_throughput_per_sec": 237.17799899780616, "timesteps_total": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 16995.59, "sample_time_ms": 12602.632, "learn_time_ms": 4232.506, "learn_throughput": 945.066, "synch_weights_time_ms": 159.552}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 7132, "training_iteration": 243, "trial_id": "185f8_00000", "date": "2025-03-21_12-49-36", "timestamp": 1742561376, "time_this_iter_s": 16.916924476623535, "time_total_s": 3894.008283853531, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb1dbd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3894.008283853531, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 99.37826086956525, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988404273986816, "policy_loss": -0.013126176781952381, "vf_loss": 10.0, "vf_explained_var": -1.6664465363191994e-07, "kl": 0.007650754414498806, "entropy": 0.3785322308540344, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "sampler_results": {"episode_reward_max": 51278.0735206604, "episode_reward_min": 51278.0735206604, "episode_reward_mean": 51278.0735206604, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51278.0735206604}, "policy_reward_max": {"agent_0": 51278.0735206604}, "policy_reward_mean": {"agent_0": 51278.0735206604}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51278.0735206604], "episode_lengths": [135], "policy_agent_0_reward": [51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.02468836634534, "mean_inference_ms": 6.294356676705758, "mean_action_processing_ms": 0.1905450202580402, "mean_env_wait_ms": 210.0940249507267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883838653564453, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16698837280273438}}, "episode_reward_max": 51278.0735206604, "episode_reward_min": 51278.0735206604, "episode_reward_mean": 51278.0735206604, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51278.0735206604}, "policy_reward_max": {"agent_0": 51278.0735206604}, "policy_reward_mean": {"agent_0": 51278.0735206604}, "hist_stats": {"episode_reward": [51278.0735206604], "episode_lengths": [135], "policy_agent_0_reward": [51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.02468836634534, "mean_inference_ms": 6.294356676705758, "mean_action_processing_ms": 0.1905450202580402, "mean_env_wait_ms": 210.0940249507267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883838653564453, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16698837280273438}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.15126980676996, "num_env_steps_trained_throughput_per_sec": 285.15126980676996, "timesteps_total": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 16433.4, "sample_time_ms": 12033.445, "learn_time_ms": 4245.677, "learn_throughput": 942.135, "synch_weights_time_ms": 153.412}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "episodes_total": 7132, "training_iteration": 244, "trial_id": "185f8_00000", "date": "2025-03-21_12-49-50", "timestamp": 1742561390, "time_this_iter_s": 14.077545881271362, "time_total_s": 3908.0858297348022, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb56c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3908.0858297348022, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983810424804688, "policy_loss": -0.015250837430357933, "vf_loss": 9.997314453125, "vf_explained_var": -3.0479083079626434e-07, "kl": 0.008730802685022354, "entropy": 0.4060642421245575, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "sampler_results": {"episode_reward_max": 51278.0735206604, "episode_reward_min": 51278.0735206604, "episode_reward_mean": 51278.0735206604, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51278.0735206604}, "policy_reward_max": {"agent_0": 51278.0735206604}, "policy_reward_mean": {"agent_0": 51278.0735206604}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51278.0735206604], "episode_lengths": [135], "policy_agent_0_reward": [51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.02468836634534, "mean_inference_ms": 6.294356676705758, "mean_action_processing_ms": 0.1905450202580402, "mean_env_wait_ms": 210.0940249507267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883838653564453, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16698837280273438}}, "episode_reward_max": 51278.0735206604, "episode_reward_min": 51278.0735206604, "episode_reward_mean": 51278.0735206604, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51278.0735206604}, "policy_reward_max": {"agent_0": 51278.0735206604}, "policy_reward_mean": {"agent_0": 51278.0735206604}, "hist_stats": {"episode_reward": [51278.0735206604], "episode_lengths": [135], "policy_agent_0_reward": [51278.0735206604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.02468836634534, "mean_inference_ms": 6.294356676705758, "mean_action_processing_ms": 0.1905450202580402, "mean_env_wait_ms": 210.0940249507267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883838653564453, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16698837280273438}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.1907256443878, "num_env_steps_trained_throughput_per_sec": 280.1907256443878, "timesteps_total": 980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 16022.549, "sample_time_ms": 11598.772, "learn_time_ms": 4259.152, "learn_throughput": 939.154, "synch_weights_time_ms": 163.716}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "episodes_total": 7132, "training_iteration": 245, "trial_id": "185f8_00000", "date": "2025-03-21_12-50-04", "timestamp": 1742561404, "time_this_iter_s": 14.336761236190796, "time_total_s": 3922.422590970993, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb56cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3922.422590970993, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 99.59, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.77004623413086, "policy_loss": -0.014516104012727737, "vf_loss": 9.78271484375, "vf_explained_var": -3.19691991990112e-07, "kl": 0.009237698279321194, "entropy": 0.36609792709350586, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 59384.473220825195, "episode_reward_min": 45255.7866692543, "episode_reward_mean": 53067.19413707037, "episode_len_mean": 135.24137931034483, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 45255.7866692543}, "policy_reward_max": {"agent_0": 59384.473220825195}, "policy_reward_mean": {"agent_0": 53067.19413707037}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56705.726707458496, 52495.83345794678, 48912.380310058594, 49192.40675878525, 54617.49349975586, 53262.733615875244, 55503.066665649414, 54559.013690948486, 56598.23342895508, 53715.32679748535, 54692.91368103027, 53148.4401473999, 54749.17343711853, 56373.57328796387, 53618.54697036743, 52426.46668624878, 56323.44013977051, 49720.239990234375, 51638.43999481201, 50517.92686462402, 53574.34006023407, 52626.01336669922, 54401.006870269775, 54572.46678161621, 54169.960220336914, 50623.46030473709, 53529.44669151306, 52709.766832351685, 55683.66692352295, 56192.120056152344, 45255.7866692543, 53221.9202003479, 55120.30005645752, 54257.30665588379, 55286.84670257568, 52689.76013183594, 50412.62006807327, 50960.67314338684, 54140.94685459137, 55660.08010864258, 52078.37334251404, 54227.366790771484, 59384.473220825195, 51736.38693237305, 53043.5266494751, 51475.65347099304, 53974.56681060791, 51829.159906864166, 46689.65340900421, 55477.12689971924, 57741.82699584961, 53698.47996902466, 51026.873453855515, 54106.34677505493, 57682.56678581238, 50252.77338027954, 55623.24678993225, 52891.67992210388, 54119.58018493652, 55835.20029067993, 51493.42670440674, 51105.70677566528, 50822.773319244385, 46786.33359146118, 52267.113286972046, 51137.666773200035, 53056.46684265137, 52767.50017738342, 55982.73352813721, 54145.48684310913, 52800.58002662659, 54575.60681915283, 54061.366874694824, 53717.006690979004, 50265.35333919525, 52920.82683134079, 53826.440032958984, 51651.70665168762, 54725.88020706177, 50618.653356552124, 48196.6068649292, 51938.08693885803, 55741.780181884766, 50907.72661590576, 51729.23351478577, 51169.660301208496, 51679.44002342224], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 134, 136, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 134, 136, 136, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136], "policy_agent_0_reward": [56705.726707458496, 52495.83345794678, 48912.380310058594, 49192.40675878525, 54617.49349975586, 53262.733615875244, 55503.066665649414, 54559.013690948486, 56598.23342895508, 53715.32679748535, 54692.91368103027, 53148.4401473999, 54749.17343711853, 56373.57328796387, 53618.54697036743, 52426.46668624878, 56323.44013977051, 49720.239990234375, 51638.43999481201, 50517.92686462402, 53574.34006023407, 52626.01336669922, 54401.006870269775, 54572.46678161621, 54169.960220336914, 50623.46030473709, 53529.44669151306, 52709.766832351685, 55683.66692352295, 56192.120056152344, 45255.7866692543, 53221.9202003479, 55120.30005645752, 54257.30665588379, 55286.84670257568, 52689.76013183594, 50412.62006807327, 50960.67314338684, 54140.94685459137, 55660.08010864258, 52078.37334251404, 54227.366790771484, 59384.473220825195, 51736.38693237305, 53043.5266494751, 51475.65347099304, 53974.56681060791, 51829.159906864166, 46689.65340900421, 55477.12689971924, 57741.82699584961, 53698.47996902466, 51026.873453855515, 54106.34677505493, 57682.56678581238, 50252.77338027954, 55623.24678993225, 52891.67992210388, 54119.58018493652, 55835.20029067993, 51493.42670440674, 51105.70677566528, 50822.773319244385, 46786.33359146118, 52267.113286972046, 51137.666773200035, 53056.46684265137, 52767.50017738342, 55982.73352813721, 54145.48684310913, 52800.58002662659, 54575.60681915283, 54061.366874694824, 53717.006690979004, 50265.35333919525, 52920.82683134079, 53826.440032958984, 51651.70665168762, 54725.88020706177, 50618.653356552124, 48196.6068649292, 51938.08693885803, 55741.780181884766, 50907.72661590576, 51729.23351478577, 51169.660301208496, 51679.44002342224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.05969941258004, "mean_inference_ms": 6.695586519499149, "mean_action_processing_ms": 0.19903711133993793, "mean_env_wait_ms": 226.21283891996035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066218189809514, "StateBufferConnector_ms": 0.00591332885040634, "ViewRequirementAgentConnector_ms": 0.20197671035240436}}, "episode_reward_max": 59384.473220825195, "episode_reward_min": 45255.7866692543, "episode_reward_mean": 53067.19413707037, "episode_len_mean": 135.24137931034483, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 45255.7866692543}, "policy_reward_max": {"agent_0": 59384.473220825195}, "policy_reward_mean": {"agent_0": 53067.19413707037}, "hist_stats": {"episode_reward": [56705.726707458496, 52495.83345794678, 48912.380310058594, 49192.40675878525, 54617.49349975586, 53262.733615875244, 55503.066665649414, 54559.013690948486, 56598.23342895508, 53715.32679748535, 54692.91368103027, 53148.4401473999, 54749.17343711853, 56373.57328796387, 53618.54697036743, 52426.46668624878, 56323.44013977051, 49720.239990234375, 51638.43999481201, 50517.92686462402, 53574.34006023407, 52626.01336669922, 54401.006870269775, 54572.46678161621, 54169.960220336914, 50623.46030473709, 53529.44669151306, 52709.766832351685, 55683.66692352295, 56192.120056152344, 45255.7866692543, 53221.9202003479, 55120.30005645752, 54257.30665588379, 55286.84670257568, 52689.76013183594, 50412.62006807327, 50960.67314338684, 54140.94685459137, 55660.08010864258, 52078.37334251404, 54227.366790771484, 59384.473220825195, 51736.38693237305, 53043.5266494751, 51475.65347099304, 53974.56681060791, 51829.159906864166, 46689.65340900421, 55477.12689971924, 57741.82699584961, 53698.47996902466, 51026.873453855515, 54106.34677505493, 57682.56678581238, 50252.77338027954, 55623.24678993225, 52891.67992210388, 54119.58018493652, 55835.20029067993, 51493.42670440674, 51105.70677566528, 50822.773319244385, 46786.33359146118, 52267.113286972046, 51137.666773200035, 53056.46684265137, 52767.50017738342, 55982.73352813721, 54145.48684310913, 52800.58002662659, 54575.60681915283, 54061.366874694824, 53717.006690979004, 50265.35333919525, 52920.82683134079, 53826.440032958984, 51651.70665168762, 54725.88020706177, 50618.653356552124, 48196.6068649292, 51938.08693885803, 55741.780181884766, 50907.72661590576, 51729.23351478577, 51169.660301208496, 51679.44002342224], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 136, 135, 135, 136, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 134, 136, 136, 135, 136, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 134, 136, 136, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136], "policy_agent_0_reward": [56705.726707458496, 52495.83345794678, 48912.380310058594, 49192.40675878525, 54617.49349975586, 53262.733615875244, 55503.066665649414, 54559.013690948486, 56598.23342895508, 53715.32679748535, 54692.91368103027, 53148.4401473999, 54749.17343711853, 56373.57328796387, 53618.54697036743, 52426.46668624878, 56323.44013977051, 49720.239990234375, 51638.43999481201, 50517.92686462402, 53574.34006023407, 52626.01336669922, 54401.006870269775, 54572.46678161621, 54169.960220336914, 50623.46030473709, 53529.44669151306, 52709.766832351685, 55683.66692352295, 56192.120056152344, 45255.7866692543, 53221.9202003479, 55120.30005645752, 54257.30665588379, 55286.84670257568, 52689.76013183594, 50412.62006807327, 50960.67314338684, 54140.94685459137, 55660.08010864258, 52078.37334251404, 54227.366790771484, 59384.473220825195, 51736.38693237305, 53043.5266494751, 51475.65347099304, 53974.56681060791, 51829.159906864166, 46689.65340900421, 55477.12689971924, 57741.82699584961, 53698.47996902466, 51026.873453855515, 54106.34677505493, 57682.56678581238, 50252.77338027954, 55623.24678993225, 52891.67992210388, 54119.58018493652, 55835.20029067993, 51493.42670440674, 51105.70677566528, 50822.773319244385, 46786.33359146118, 52267.113286972046, 51137.666773200035, 53056.46684265137, 52767.50017738342, 55982.73352813721, 54145.48684310913, 52800.58002662659, 54575.60681915283, 54061.366874694824, 53717.006690979004, 50265.35333919525, 52920.82683134079, 53826.440032958984, 51651.70665168762, 54725.88020706177, 50618.653356552124, 48196.6068649292, 51938.08693885803, 55741.780181884766, 50907.72661590576, 51729.23351478577, 51169.660301208496, 51679.44002342224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.05969941258004, "mean_inference_ms": 6.695586519499149, "mean_action_processing_ms": 0.19903711133993793, "mean_env_wait_ms": 226.21283891996035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066218189809514, "StateBufferConnector_ms": 0.00591332885040634, "ViewRequirementAgentConnector_ms": 0.20197671035240436}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.70097396952414, "num_env_steps_trained_throughput_per_sec": 212.70097396952414, "timesteps_total": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 16515.11, "sample_time_ms": 12087.727, "learn_time_ms": 4262.774, "learn_throughput": 938.356, "synch_weights_time_ms": 163.842}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 7219, "training_iteration": 246, "trial_id": "185f8_00000", "date": "2025-03-21_12-50-23", "timestamp": 1742561423, "time_this_iter_s": 18.86216402053833, "time_total_s": 3941.2847549915314, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3941.2847549915314, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 95.94999999999999, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.135135135135135, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.89622688293457, "policy_loss": -0.012520302087068558, "vf_loss": 9.906982421875, "vf_explained_var": 1.7508864402770996e-07, "kl": 0.008821926079690456, "entropy": 0.3469468057155609, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "sampler_results": {"episode_reward_max": 58014.13368225098, "episode_reward_min": 46598.153436899185, "episode_reward_mean": 52359.07129610551, "episode_len_mean": 135.24324324324326, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {"agent_0": 46598.153436899185}, "policy_reward_max": {"agent_0": 58014.13368225098}, "policy_reward_mean": {"agent_0": 52359.07129610551}, "custom_metrics": {"num_batches_mean": 5.135135135135135, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49693.86015021801, 56461.07991027832, 47318.033432006836, 53923.88020324707, 48041.08679795265, 50138.0067615509, 52396.60676574707, 53893.36689376831, 52053.71997833252, 48396.466873168945, 46956.08678936958, 53758.80016517639, 52841.24018859863, 51538.0802693367, 49836.29342842102, 54084.82678985596, 53012.45348358154, 57429.48679924011, 54680.02702331543, 47607.933612823486, 51405.900091171265, 58014.13368225098, 51884.60658836365, 53706.34004211426, 53554.80026626587, 51270.39348983765, 49893.686836242676, 55699.33341217041, 55670.71338272095, 51323.47339642048, 46598.153436899185, 54113.67351150513, 54264.35338592529, 56447.58694458008, 50975.68653488159, 50864.913370132446, 57536.55326843262], "episode_lengths": [136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 134, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135], "policy_agent_0_reward": [49693.86015021801, 56461.07991027832, 47318.033432006836, 53923.88020324707, 48041.08679795265, 50138.0067615509, 52396.60676574707, 53893.36689376831, 52053.71997833252, 48396.466873168945, 46956.08678936958, 53758.80016517639, 52841.24018859863, 51538.0802693367, 49836.29342842102, 54084.82678985596, 53012.45348358154, 57429.48679924011, 54680.02702331543, 47607.933612823486, 51405.900091171265, 58014.13368225098, 51884.60658836365, 53706.34004211426, 53554.80026626587, 51270.39348983765, 49893.686836242676, 55699.33341217041, 55670.71338272095, 51323.47339642048, 46598.153436899185, 54113.67351150513, 54264.35338592529, 56447.58694458008, 50975.68653488159, 50864.913370132446, 57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.56131566593457, "mean_inference_ms": 6.474801411364584, "mean_action_processing_ms": 0.20091242946074073, "mean_env_wait_ms": 212.60427843571375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043294236466691303, "StateBufferConnector_ms": 0.006347733574944573, "ViewRequirementAgentConnector_ms": 0.24159405682538007}}, "episode_reward_max": 58014.13368225098, "episode_reward_min": 46598.153436899185, "episode_reward_mean": 52359.07129610551, "episode_len_mean": 135.24324324324326, "episodes_this_iter": 37, "policy_reward_min": {"agent_0": 46598.153436899185}, "policy_reward_max": {"agent_0": 58014.13368225098}, "policy_reward_mean": {"agent_0": 52359.07129610551}, "hist_stats": {"episode_reward": [49693.86015021801, 56461.07991027832, 47318.033432006836, 53923.88020324707, 48041.08679795265, 50138.0067615509, 52396.60676574707, 53893.36689376831, 52053.71997833252, 48396.466873168945, 46956.08678936958, 53758.80016517639, 52841.24018859863, 51538.0802693367, 49836.29342842102, 54084.82678985596, 53012.45348358154, 57429.48679924011, 54680.02702331543, 47607.933612823486, 51405.900091171265, 58014.13368225098, 51884.60658836365, 53706.34004211426, 53554.80026626587, 51270.39348983765, 49893.686836242676, 55699.33341217041, 55670.71338272095, 51323.47339642048, 46598.153436899185, 54113.67351150513, 54264.35338592529, 56447.58694458008, 50975.68653488159, 50864.913370132446, 57536.55326843262], "episode_lengths": [136, 135, 136, 135, 136, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 134, 136, 135, 134, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135], "policy_agent_0_reward": [49693.86015021801, 56461.07991027832, 47318.033432006836, 53923.88020324707, 48041.08679795265, 50138.0067615509, 52396.60676574707, 53893.36689376831, 52053.71997833252, 48396.466873168945, 46956.08678936958, 53758.80016517639, 52841.24018859863, 51538.0802693367, 49836.29342842102, 54084.82678985596, 53012.45348358154, 57429.48679924011, 54680.02702331543, 47607.933612823486, 51405.900091171265, 58014.13368225098, 51884.60658836365, 53706.34004211426, 53554.80026626587, 51270.39348983765, 49893.686836242676, 55699.33341217041, 55670.71338272095, 51323.47339642048, 46598.153436899185, 54113.67351150513, 54264.35338592529, 56447.58694458008, 50975.68653488159, 50864.913370132446, 57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.56131566593457, "mean_inference_ms": 6.474801411364584, "mean_action_processing_ms": 0.20091242946074073, "mean_env_wait_ms": 212.60427843571375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043294236466691303, "StateBufferConnector_ms": 0.006347733574944573, "ViewRequirementAgentConnector_ms": 0.24159405682538007}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.18034555155452, "num_env_steps_trained_throughput_per_sec": 235.18034555155452, "timesteps_total": 988000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 16820.214, "sample_time_ms": 12435.59, "learn_time_ms": 4226.243, "learn_throughput": 946.467, "synch_weights_time_ms": 157.6}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "done": false, "episodes_total": 7256, "training_iteration": 247, "trial_id": "185f8_00000", "date": "2025-03-21_12-50-40", "timestamp": 1742561440, "time_this_iter_s": 17.062324047088623, "time_total_s": 3958.34707903862, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe8c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3958.34707903862, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 99.2391304347826, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982732772827148, "policy_loss": -0.019867876544594765, "vf_loss": 10.0, "vf_explained_var": -3.240381545310811e-07, "kl": 0.013002832420170307, "entropy": 0.34291306138038635, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "sampler_results": {"episode_reward_max": 57536.55326843262, "episode_reward_min": 57536.55326843262, "episode_reward_mean": 57536.55326843262, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57536.55326843262}, "policy_reward_max": {"agent_0": 57536.55326843262}, "policy_reward_mean": {"agent_0": 57536.55326843262}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57536.55326843262], "episode_lengths": [135], "policy_agent_0_reward": [57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.019090880479034, "mean_inference_ms": 6.706040121195514, "mean_action_processing_ms": 0.19676520958646498, "mean_env_wait_ms": 226.18955796764743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03020763397216797, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12891292572021484}}, "episode_reward_max": 57536.55326843262, "episode_reward_min": 57536.55326843262, "episode_reward_mean": 57536.55326843262, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57536.55326843262}, "policy_reward_max": {"agent_0": 57536.55326843262}, "policy_reward_mean": {"agent_0": 57536.55326843262}, "hist_stats": {"episode_reward": [57536.55326843262], "episode_lengths": [135], "policy_agent_0_reward": [57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.019090880479034, "mean_inference_ms": 6.706040121195514, "mean_action_processing_ms": 0.19676520958646498, "mean_env_wait_ms": 226.18955796764743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03020763397216797, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12891292572021484}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.14784985867794, "num_env_steps_trained_throughput_per_sec": 298.14784985867794, "timesteps_total": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 16219.489, "sample_time_ms": 11856.755, "learn_time_ms": 4199.235, "learn_throughput": 952.554, "synch_weights_time_ms": 162.722}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "episodes_total": 7256, "training_iteration": 248, "trial_id": "185f8_00000", "date": "2025-03-21_12-50-54", "timestamp": 1742561454, "time_this_iter_s": 13.475994348526001, "time_total_s": 3971.823073387146, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb1c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3971.823073387146, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 99.64736842105265, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988645553588867, "policy_loss": -0.01309951115399599, "vf_loss": 10.0, "vf_explained_var": -1.8471230589511833e-07, "kl": 0.008726825937628746, "entropy": 0.3821081221103668, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 57536.55326843262, "episode_reward_min": 57536.55326843262, "episode_reward_mean": 57536.55326843262, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57536.55326843262}, "policy_reward_max": {"agent_0": 57536.55326843262}, "policy_reward_mean": {"agent_0": 57536.55326843262}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57536.55326843262], "episode_lengths": [135], "policy_agent_0_reward": [57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.019090880479034, "mean_inference_ms": 6.706040121195514, "mean_action_processing_ms": 0.19676520958646498, "mean_env_wait_ms": 226.18955796764743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03020763397216797, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12891292572021484}}, "episode_reward_max": 57536.55326843262, "episode_reward_min": 57536.55326843262, "episode_reward_mean": 57536.55326843262, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57536.55326843262}, "policy_reward_max": {"agent_0": 57536.55326843262}, "policy_reward_mean": {"agent_0": 57536.55326843262}, "hist_stats": {"episode_reward": [57536.55326843262], "episode_lengths": [135], "policy_agent_0_reward": [57536.55326843262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.019090880479034, "mean_inference_ms": 6.706040121195514, "mean_action_processing_ms": 0.19676520958646498, "mean_env_wait_ms": 226.18955796764743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03020763397216797, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12891292572021484}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.4312785982274, "num_env_steps_trained_throughput_per_sec": 280.4312785982274, "timesteps_total": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 15750.464, "sample_time_ms": 11394.36, "learn_time_ms": 4195.59, "learn_throughput": 953.382, "synch_weights_time_ms": 159.676}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 7256, "training_iteration": 249, "trial_id": "185f8_00000", "date": "2025-03-21_12-51-08", "timestamp": 1742561468, "time_this_iter_s": 14.316665172576904, "time_total_s": 3986.139738559723, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb54670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3986.139738559723, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 99.44285714285715, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.869903564453125, "policy_loss": -0.015134253539144993, "vf_loss": 9.88330078125, "vf_explained_var": -1.1778126207673267e-07, "kl": 0.00868383888155222, "entropy": 0.3691520094871521, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "sampler_results": {"episode_reward_max": 58986.980377197266, "episode_reward_min": 47235.593479156494, "episode_reward_mean": 53521.686676328485, "episode_len_mean": 135.04255319148936, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {"agent_0": 47235.593479156494}, "policy_reward_max": {"agent_0": 58986.980377197266}, "policy_reward_mean": {"agent_0": 53521.686676328485}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54296.16014289856, 49859.480184555054, 54006.86019897461, 50135.626640319824, 52786.220251083374, 57340.84013366699, 55660.726919174194, 51208.92011642456, 50904.400071144104, 55233.65351867676, 52961.193504333496, 57768.08000946045, 52262.62002360821, 53656.74027252197, 53904.16019439697, 56584.85372161865, 50127.733278274536, 52980.64010334015, 55034.66667175293, 56362.46008300781, 57551.14018249512, 55208.56681251526, 52930.306732177734, 54014.54672241211, 55816.80039215088, 54071.533306121826, 54798.92702484131, 56282.29342651367, 53256.43363189697, 56483.40693664551, 47235.593479156494, 56375.05994415283, 54307.866777420044, 57387.69346618652, 49296.20675420761, 53655.37355041504, 48462.666677474976, 51613.10036087036, 53308.79343724251, 49457.12018966675, 48452.82013040781, 52278.480157375336, 51644.27372741699, 58986.980377197266, 49711.81338095665, 52860.260025024414, 56995.18014526367], "episode_lengths": [135, 135, 135, 135, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 134, 135, 135, 135, 135, 134, 134, 135, 135, 134, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 134, 136, 135, 135], "policy_agent_0_reward": [54296.16014289856, 49859.480184555054, 54006.86019897461, 50135.626640319824, 52786.220251083374, 57340.84013366699, 55660.726919174194, 51208.92011642456, 50904.400071144104, 55233.65351867676, 52961.193504333496, 57768.08000946045, 52262.62002360821, 53656.74027252197, 53904.16019439697, 56584.85372161865, 50127.733278274536, 52980.64010334015, 55034.66667175293, 56362.46008300781, 57551.14018249512, 55208.56681251526, 52930.306732177734, 54014.54672241211, 55816.80039215088, 54071.533306121826, 54798.92702484131, 56282.29342651367, 53256.43363189697, 56483.40693664551, 47235.593479156494, 56375.05994415283, 54307.866777420044, 57387.69346618652, 49296.20675420761, 53655.37355041504, 48462.666677474976, 51613.10036087036, 53308.79343724251, 49457.12018966675, 48452.82013040781, 52278.480157375336, 51644.27372741699, 58986.980377197266, 49711.81338095665, 52860.260025024414, 56995.18014526367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.88754664326951, "mean_inference_ms": 6.7045687982457425, "mean_action_processing_ms": 0.19984987577018135, "mean_env_wait_ms": 226.81025643311122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04903306352331283, "StateBufferConnector_ms": 0.006041120975575549, "ViewRequirementAgentConnector_ms": 0.21486941804277135}}, "episode_reward_max": 58986.980377197266, "episode_reward_min": 47235.593479156494, "episode_reward_mean": 53521.686676328485, "episode_len_mean": 135.04255319148936, "episodes_this_iter": 47, "policy_reward_min": {"agent_0": 47235.593479156494}, "policy_reward_max": {"agent_0": 58986.980377197266}, "policy_reward_mean": {"agent_0": 53521.686676328485}, "hist_stats": {"episode_reward": [54296.16014289856, 49859.480184555054, 54006.86019897461, 50135.626640319824, 52786.220251083374, 57340.84013366699, 55660.726919174194, 51208.92011642456, 50904.400071144104, 55233.65351867676, 52961.193504333496, 57768.08000946045, 52262.62002360821, 53656.74027252197, 53904.16019439697, 56584.85372161865, 50127.733278274536, 52980.64010334015, 55034.66667175293, 56362.46008300781, 57551.14018249512, 55208.56681251526, 52930.306732177734, 54014.54672241211, 55816.80039215088, 54071.533306121826, 54798.92702484131, 56282.29342651367, 53256.43363189697, 56483.40693664551, 47235.593479156494, 56375.05994415283, 54307.866777420044, 57387.69346618652, 49296.20675420761, 53655.37355041504, 48462.666677474976, 51613.10036087036, 53308.79343724251, 49457.12018966675, 48452.82013040781, 52278.480157375336, 51644.27372741699, 58986.980377197266, 49711.81338095665, 52860.260025024414, 56995.18014526367], "episode_lengths": [135, 135, 135, 135, 134, 135, 135, 135, 135, 136, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 134, 135, 135, 135, 135, 134, 134, 135, 135, 134, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 136, 136, 135, 134, 136, 135, 135], "policy_agent_0_reward": [54296.16014289856, 49859.480184555054, 54006.86019897461, 50135.626640319824, 52786.220251083374, 57340.84013366699, 55660.726919174194, 51208.92011642456, 50904.400071144104, 55233.65351867676, 52961.193504333496, 57768.08000946045, 52262.62002360821, 53656.74027252197, 53904.16019439697, 56584.85372161865, 50127.733278274536, 52980.64010334015, 55034.66667175293, 56362.46008300781, 57551.14018249512, 55208.56681251526, 52930.306732177734, 54014.54672241211, 55816.80039215088, 54071.533306121826, 54798.92702484131, 56282.29342651367, 53256.43363189697, 56483.40693664551, 47235.593479156494, 56375.05994415283, 54307.866777420044, 57387.69346618652, 49296.20675420761, 53655.37355041504, 48462.666677474976, 51613.10036087036, 53308.79343724251, 49457.12018966675, 48452.82013040781, 52278.480157375336, 51644.27372741699, 58986.980377197266, 49711.81338095665, 52860.260025024414, 56995.18014526367]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.88754664326951, "mean_inference_ms": 6.7045687982457425, "mean_action_processing_ms": 0.19984987577018135, "mean_env_wait_ms": 226.81025643311122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04903306352331283, "StateBufferConnector_ms": 0.006041120975575549, "ViewRequirementAgentConnector_ms": 0.21486941804277135}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.98825079376013, "num_env_steps_trained_throughput_per_sec": 263.98825079376013, "timesteps_total": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 15807.68, "sample_time_ms": 11561.763, "learn_time_ms": 4085.561, "learn_throughput": 979.058, "synch_weights_time_ms": 159.514}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "episodes_total": 7303, "training_iteration": 250, "trial_id": "185f8_00000", "date": "2025-03-21_12-51-23", "timestamp": 1742561483, "time_this_iter_s": 15.198580980300903, "time_total_s": 4001.338319540024, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4001.338319540024, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 97.61904761904762, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.5064935064935066, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.793871879577637, "policy_loss": -0.015788933262228966, "vf_loss": 9.807861328125, "vf_explained_var": -3.293156680683751e-07, "kl": 0.00899464450776577, "entropy": 0.3518883287906647, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "sampler_results": {"episode_reward_max": 56934.813385009766, "episode_reward_min": 45146.51345157623, "episode_reward_mean": 52640.75979984271, "episode_len_mean": 135.14285714285714, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 45146.51345157623}, "policy_reward_max": {"agent_0": 56934.813385009766}, "policy_reward_mean": {"agent_0": 52640.75979984271}, "custom_metrics": {"num_batches_mean": 5.5064935064935066, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56540.4001159668, 51284.4001121521, 56934.813385009766, 55370.973373413086, 52698.126960754395, 55911.85331726074, 51555.36004829407, 52857.75358963013, 53550.446771621704, 48702.227045059204, 48576.733476638794, 53656.99362564087, 53823.87341880798, 53034.70672225952, 56504.433502197266, 53802.52681159973, 55172.40672302246, 50969.64026069641, 56567.84683227539, 56320.087074279785, 47090.08006584644, 54799.406677246094, 55359.70007419586, 49306.30666542053, 50331.640303611755, 51755.68684196472, 54158.686807632446, 48716.68678379059, 56021.20698547363, 50677.35328102112, 54084.026750564575, 46615.973320007324, 54217.74678039551, 49179.46702194214, 51056.626777648926, 56489.87341308594, 51852.033336639404, 54783.05337524414, 54139.280029296875, 53608.273654937744, 52172.66014671326, 49973.02684020996, 51128.40694642067, 55981.62696838379, 55420.86674499512, 55123.52680969238, 54960.22674560547, 55661.05341720581, 56074.833251953125, 54296.3935546875, 50833.12685394287, 51131.060024261475, 46233.339990615845, 52260.980100631714, 49417.7466468811, 48413.57353782654, 53855.02687835693, 50677.146869659424, 55252.88042449951, 49925.23332345486, 48981.8801651001, 49056.38027191162, 55937.40021133423, 53569.40674781799, 49355.72021484375, 55987.98014831543, 54043.6467666626, 54785.9935836792, 45146.51345157623, 54755.666858673096, 46619.97354888916, 52819.99998855591, 54857.27356338501, 50439.35352516174, 55100.453521728516, 56805.05375671387, 48204.36007499695], "episode_lengths": [135, 136, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 134, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135], "policy_agent_0_reward": [56540.4001159668, 51284.4001121521, 56934.813385009766, 55370.973373413086, 52698.126960754395, 55911.85331726074, 51555.36004829407, 52857.75358963013, 53550.446771621704, 48702.227045059204, 48576.733476638794, 53656.99362564087, 53823.87341880798, 53034.70672225952, 56504.433502197266, 53802.52681159973, 55172.40672302246, 50969.64026069641, 56567.84683227539, 56320.087074279785, 47090.08006584644, 54799.406677246094, 55359.70007419586, 49306.30666542053, 50331.640303611755, 51755.68684196472, 54158.686807632446, 48716.68678379059, 56021.20698547363, 50677.35328102112, 54084.026750564575, 46615.973320007324, 54217.74678039551, 49179.46702194214, 51056.626777648926, 56489.87341308594, 51852.033336639404, 54783.05337524414, 54139.280029296875, 53608.273654937744, 52172.66014671326, 49973.02684020996, 51128.40694642067, 55981.62696838379, 55420.86674499512, 55123.52680969238, 54960.22674560547, 55661.05341720581, 56074.833251953125, 54296.3935546875, 50833.12685394287, 51131.060024261475, 46233.339990615845, 52260.980100631714, 49417.7466468811, 48413.57353782654, 53855.02687835693, 50677.146869659424, 55252.88042449951, 49925.23332345486, 48981.8801651001, 49056.38027191162, 55937.40021133423, 53569.40674781799, 49355.72021484375, 55987.98014831543, 54043.6467666626, 54785.9935836792, 45146.51345157623, 54755.666858673096, 46619.97354888916, 52819.99998855591, 54857.27356338501, 50439.35352516174, 55100.453521728516, 56805.05375671387, 48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.2555978252958, "mean_inference_ms": 6.5833549681610295, "mean_action_processing_ms": 0.19937245803650827, "mean_env_wait_ms": 219.4983283501426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049482382737196885, "StateBufferConnector_ms": 0.00595612959428267, "ViewRequirementAgentConnector_ms": 0.22534426156576579}}, "episode_reward_max": 56934.813385009766, "episode_reward_min": 45146.51345157623, "episode_reward_mean": 52640.75979984271, "episode_len_mean": 135.14285714285714, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 45146.51345157623}, "policy_reward_max": {"agent_0": 56934.813385009766}, "policy_reward_mean": {"agent_0": 52640.75979984271}, "hist_stats": {"episode_reward": [56540.4001159668, 51284.4001121521, 56934.813385009766, 55370.973373413086, 52698.126960754395, 55911.85331726074, 51555.36004829407, 52857.75358963013, 53550.446771621704, 48702.227045059204, 48576.733476638794, 53656.99362564087, 53823.87341880798, 53034.70672225952, 56504.433502197266, 53802.52681159973, 55172.40672302246, 50969.64026069641, 56567.84683227539, 56320.087074279785, 47090.08006584644, 54799.406677246094, 55359.70007419586, 49306.30666542053, 50331.640303611755, 51755.68684196472, 54158.686807632446, 48716.68678379059, 56021.20698547363, 50677.35328102112, 54084.026750564575, 46615.973320007324, 54217.74678039551, 49179.46702194214, 51056.626777648926, 56489.87341308594, 51852.033336639404, 54783.05337524414, 54139.280029296875, 53608.273654937744, 52172.66014671326, 49973.02684020996, 51128.40694642067, 55981.62696838379, 55420.86674499512, 55123.52680969238, 54960.22674560547, 55661.05341720581, 56074.833251953125, 54296.3935546875, 50833.12685394287, 51131.060024261475, 46233.339990615845, 52260.980100631714, 49417.7466468811, 48413.57353782654, 53855.02687835693, 50677.146869659424, 55252.88042449951, 49925.23332345486, 48981.8801651001, 49056.38027191162, 55937.40021133423, 53569.40674781799, 49355.72021484375, 55987.98014831543, 54043.6467666626, 54785.9935836792, 45146.51345157623, 54755.666858673096, 46619.97354888916, 52819.99998855591, 54857.27356338501, 50439.35352516174, 55100.453521728516, 56805.05375671387, 48204.36007499695], "episode_lengths": [135, 136, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 136, 135, 136, 135, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 134, 135, 135, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135], "policy_agent_0_reward": [56540.4001159668, 51284.4001121521, 56934.813385009766, 55370.973373413086, 52698.126960754395, 55911.85331726074, 51555.36004829407, 52857.75358963013, 53550.446771621704, 48702.227045059204, 48576.733476638794, 53656.99362564087, 53823.87341880798, 53034.70672225952, 56504.433502197266, 53802.52681159973, 55172.40672302246, 50969.64026069641, 56567.84683227539, 56320.087074279785, 47090.08006584644, 54799.406677246094, 55359.70007419586, 49306.30666542053, 50331.640303611755, 51755.68684196472, 54158.686807632446, 48716.68678379059, 56021.20698547363, 50677.35328102112, 54084.026750564575, 46615.973320007324, 54217.74678039551, 49179.46702194214, 51056.626777648926, 56489.87341308594, 51852.033336639404, 54783.05337524414, 54139.280029296875, 53608.273654937744, 52172.66014671326, 49973.02684020996, 51128.40694642067, 55981.62696838379, 55420.86674499512, 55123.52680969238, 54960.22674560547, 55661.05341720581, 56074.833251953125, 54296.3935546875, 50833.12685394287, 51131.060024261475, 46233.339990615845, 52260.980100631714, 49417.7466468811, 48413.57353782654, 53855.02687835693, 50677.146869659424, 55252.88042449951, 49925.23332345486, 48981.8801651001, 49056.38027191162, 55937.40021133423, 53569.40674781799, 49355.72021484375, 55987.98014831543, 54043.6467666626, 54785.9935836792, 45146.51345157623, 54755.666858673096, 46619.97354888916, 52819.99998855591, 54857.27356338501, 50439.35352516174, 55100.453521728516, 56805.05375671387, 48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.2555978252958, "mean_inference_ms": 6.5833549681610295, "mean_action_processing_ms": 0.19937245803650827, "mean_env_wait_ms": 219.4983283501426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049482382737196885, "StateBufferConnector_ms": 0.00595612959428267, "ViewRequirementAgentConnector_ms": 0.22534426156576579}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.1760751415389, "num_env_steps_trained_throughput_per_sec": 192.1760751415389, "timesteps_total": 1004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1004000, "timers": {"training_iteration_time_ms": 16398.453, "sample_time_ms": 12210.945, "learn_time_ms": 4035.674, "learn_throughput": 991.16, "synch_weights_time_ms": 150.982}, "counters": {"num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "done": false, "episodes_total": 7380, "training_iteration": 251, "trial_id": "185f8_00000", "date": "2025-03-21_12-51-44", "timestamp": 1742561504, "time_this_iter_s": 20.87609601020813, "time_total_s": 4022.214415550232, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fefe710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4022.214415550232, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 98.70384615384617, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988653182983398, "policy_loss": -0.012745027430355549, "vf_loss": 10.0, "vf_explained_var": -1.028180136586343e-07, "kl": 0.006997026037424803, "entropy": 0.3106924593448639, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 48204.36007499695, "episode_reward_min": 48204.36007499695, "episode_reward_mean": 48204.36007499695, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48204.36007499695}, "policy_reward_max": {"agent_0": 48204.36007499695}, "policy_reward_mean": {"agent_0": 48204.36007499695}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48204.36007499695], "episode_lengths": [135], "policy_agent_0_reward": [48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.43207633389967, "mean_inference_ms": 6.417083633386761, "mean_action_processing_ms": 0.19170536609689073, "mean_env_wait_ms": 225.84916446272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04296302795410156, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16450881958007812}}, "episode_reward_max": 48204.36007499695, "episode_reward_min": 48204.36007499695, "episode_reward_mean": 48204.36007499695, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48204.36007499695}, "policy_reward_max": {"agent_0": 48204.36007499695}, "policy_reward_mean": {"agent_0": 48204.36007499695}, "hist_stats": {"episode_reward": [48204.36007499695], "episode_lengths": [135], "policy_agent_0_reward": [48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.43207633389967, "mean_inference_ms": 6.417083633386761, "mean_action_processing_ms": 0.19170536609689073, "mean_env_wait_ms": 225.84916446272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04296302795410156, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16450881958007812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.7448244916344, "num_env_steps_trained_throughput_per_sec": 288.7448244916344, "timesteps_total": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 15848.151, "sample_time_ms": 11663.856, "learn_time_ms": 4040.722, "learn_throughput": 989.922, "synch_weights_time_ms": 142.726}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 7380, "training_iteration": 252, "trial_id": "185f8_00000", "date": "2025-03-21_12-51-58", "timestamp": 1742561518, "time_this_iter_s": 13.908082485198975, "time_total_s": 4036.122498035431, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb54670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4036.122498035431, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 99.495, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984593391418457, "policy_loss": -0.01748158223927021, "vf_loss": 10.0, "vf_explained_var": 4.0295223158182125e-08, "kl": 0.010375024750828743, "entropy": 0.35961806774139404, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "sampler_results": {"episode_reward_max": 48204.36007499695, "episode_reward_min": 48204.36007499695, "episode_reward_mean": 48204.36007499695, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48204.36007499695}, "policy_reward_max": {"agent_0": 48204.36007499695}, "policy_reward_mean": {"agent_0": 48204.36007499695}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [48204.36007499695], "episode_lengths": [135], "policy_agent_0_reward": [48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.43207633389967, "mean_inference_ms": 6.417083633386761, "mean_action_processing_ms": 0.19170536609689073, "mean_env_wait_ms": 225.84916446272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04296302795410156, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16450881958007812}}, "episode_reward_max": 48204.36007499695, "episode_reward_min": 48204.36007499695, "episode_reward_mean": 48204.36007499695, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48204.36007499695}, "policy_reward_max": {"agent_0": 48204.36007499695}, "policy_reward_mean": {"agent_0": 48204.36007499695}, "hist_stats": {"episode_reward": [48204.36007499695], "episode_lengths": [135], "policy_agent_0_reward": [48204.36007499695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.43207633389967, "mean_inference_ms": 6.417083633386761, "mean_action_processing_ms": 0.19170536609689073, "mean_env_wait_ms": 225.84916446272172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04296302795410156, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.16450881958007812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.83363618111815, "num_env_steps_trained_throughput_per_sec": 295.83363618111815, "timesteps_total": 1012000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1012000, "timers": {"training_iteration_time_ms": 15513.764, "sample_time_ms": 11346.48, "learn_time_ms": 4022.512, "learn_throughput": 994.403, "synch_weights_time_ms": 143.916}, "counters": {"num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "done": false, "episodes_total": 7380, "training_iteration": 253, "trial_id": "185f8_00000", "date": "2025-03-21_12-52-12", "timestamp": 1742561532, "time_this_iter_s": 13.569453239440918, "time_total_s": 4049.691951274872, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb57eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4049.691951274872, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 99.54210526315791, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.973724365234375, "policy_loss": -0.01891588233411312, "vf_loss": 9.990234375, "vf_explained_var": -1.347313371979908e-07, "kl": 0.01202976144850254, "entropy": 0.3550027906894684, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "sampler_results": {"episode_reward_max": 56096.6067199707, "episode_reward_min": 48698.206562042236, "episode_reward_mean": 51787.62342070043, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 48698.206562042236}, "policy_reward_max": {"agent_0": 56096.6067199707}, "policy_reward_mean": {"agent_0": 51787.62342070043}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48698.206562042236, 56096.6067199707, 51278.52022266388, 51077.160178124905], "episode_lengths": [136, 135, 136, 135], "policy_agent_0_reward": [48698.206562042236, 56096.6067199707, 51278.52022266388, 51077.160178124905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.3381637844715, "mean_inference_ms": 6.439551199651289, "mean_action_processing_ms": 0.1987317036931285, "mean_env_wait_ms": 224.62322589787686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1268148422241211, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.27577877044677734}}, "episode_reward_max": 56096.6067199707, "episode_reward_min": 48698.206562042236, "episode_reward_mean": 51787.62342070043, "episode_len_mean": 135.5, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 48698.206562042236}, "policy_reward_max": {"agent_0": 56096.6067199707}, "policy_reward_mean": {"agent_0": 51787.62342070043}, "hist_stats": {"episode_reward": [48698.206562042236, 56096.6067199707, 51278.52022266388, 51077.160178124905], "episode_lengths": [136, 135, 136, 135], "policy_agent_0_reward": [48698.206562042236, 56096.6067199707, 51278.52022266388, 51077.160178124905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.3381637844715, "mean_inference_ms": 6.439551199651289, "mean_action_processing_ms": 0.1987317036931285, "mean_env_wait_ms": 224.62322589787686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1268148422241211, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.27577877044677734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.89490376363034, "num_env_steps_trained_throughput_per_sec": 275.89490376363034, "timesteps_total": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 15560.822, "sample_time_ms": 11427.078, "learn_time_ms": 3989.019, "learn_throughput": 1002.753, "synch_weights_time_ms": 143.865}, "counters": {"num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "episodes_total": 7384, "training_iteration": 254, "trial_id": "185f8_00000", "date": "2025-03-21_12-52-27", "timestamp": 1742561547, "time_this_iter_s": 14.548852682113647, "time_total_s": 4064.2408039569855, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb56cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4064.2408039569855, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 99.5095238095238, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.2521008403361344, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.687732696533203, "policy_loss": -0.014522340148687363, "vf_loss": 9.700439453125, "vf_explained_var": 2.475455289641104e-07, "kl": 0.009077894501388073, "entropy": 0.33807137608528137, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 58191.22713088989, "episode_reward_min": 43960.586731910706, "episode_reward_mean": 52868.18327193351, "episode_len_mean": 135.05882352941177, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {"agent_0": 43960.586731910706}, "policy_reward_max": {"agent_0": 58191.22713088989}, "policy_reward_mean": {"agent_0": 52868.18327193351}, "custom_metrics": {"num_batches_mean": 5.2521008403361344, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51320.64685535431, 54504.1999206543, 51819.373474121094, 51978.12683105469, 49518.42654418945, 52539.1536026001, 53211.88697242737, 51148.233536720276, 54674.94691467285, 53204.46002483368, 48470.19344520569, 53300.173412323, 51848.31366252899, 55559.26696777344, 52798.12007713318, 54452.22010040283, 50376.773292541504, 53577.939933776855, 52653.0666809082, 43960.586731910706, 55976.92672729492, 51698.3536157608, 54472.9736328125, 51869.160022735596, 53892.426681518555, 50752.600116729736, 53908.91349029541, 48182.60669326782, 52420.52677154541, 57035.253425598145, 56860.82676696777, 52252.066776275635, 55203.23312950134, 58191.22713088989, 48996.380113601685, 55073.9666595459, 48436.34687995911, 55943.56701660156, 56162.80702209473, 54338.633460998535, 52651.60687637329, 54932.040130615234, 54272.940242767334, 55025.69355010986, 48409.36003494263, 52924.866747796535, 52226.433382987976, 51911.91341018677, 51855.75322723389, 52263.82029533386, 53423.93361186981, 44572.96677827835, 52512.54002952576, 55323.07995223999, 55741.31354522705, 51943.72013282776, 54080.19375991821, 54421.066734313965, 48843.48682594299, 52501.76678466797, 52392.933502197266, 54530.71347808838, 53682.2933921814, 52525.38663101196, 51461.42683029175, 55789.247009277344, 55397.2067527771, 49516.506788253784, 55336.59349822998, 50587.353536605835, 54253.46022415161, 55463.373233795166, 51381.60017967224, 54998.57362365723, 54705.346755981445, 50521.093534469604, 56744.86666870117, 52138.43345928192, 51669.533473968506, 55439.30033874512, 51434.80029773712, 54972.78018951416, 52633.146560668945, 55639.41338348389, 50911.56681108475, 52860.32682800293, 49559.04015159607, 51541.066665649414, 57344.57364845276, 53785.7534866333, 52602.140184402466, 55901.553451538086, 53818.42029476166, 50894.406940460205, 52278.913635253906, 54540.95994567871, 53253.466796875, 52600.64035797119, 55150.206676483154, 54509.493639945984, 53971.366874694824, 50202.820034623146, 53501.44675254822, 48820.740191459656, 55928.72002029419, 47835.31324958801, 51433.380096912384, 52511.51326370239, 52383.086656570435, 49737.72679424286, 51065.12679672241, 54119.2338180542, 55950.553367614746, 56598.100189208984, 51907.54020500183, 50989.300174713135, 53855.41994857788, 50462.25346374512, 52848.853435993195], "episode_lengths": [135, 134, 135, 136, 135, 136, 136, 136, 135, 136, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 134, 135, 135, 136, 135, 136, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 134, 135, 136, 134, 135, 135, 135, 136, 134, 135, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136], "policy_agent_0_reward": [51320.64685535431, 54504.1999206543, 51819.373474121094, 51978.12683105469, 49518.42654418945, 52539.1536026001, 53211.88697242737, 51148.233536720276, 54674.94691467285, 53204.46002483368, 48470.19344520569, 53300.173412323, 51848.31366252899, 55559.26696777344, 52798.12007713318, 54452.22010040283, 50376.773292541504, 53577.939933776855, 52653.0666809082, 43960.586731910706, 55976.92672729492, 51698.3536157608, 54472.9736328125, 51869.160022735596, 53892.426681518555, 50752.600116729736, 53908.91349029541, 48182.60669326782, 52420.52677154541, 57035.253425598145, 56860.82676696777, 52252.066776275635, 55203.23312950134, 58191.22713088989, 48996.380113601685, 55073.9666595459, 48436.34687995911, 55943.56701660156, 56162.80702209473, 54338.633460998535, 52651.60687637329, 54932.040130615234, 54272.940242767334, 55025.69355010986, 48409.36003494263, 52924.866747796535, 52226.433382987976, 51911.91341018677, 51855.75322723389, 52263.82029533386, 53423.93361186981, 44572.96677827835, 52512.54002952576, 55323.07995223999, 55741.31354522705, 51943.72013282776, 54080.19375991821, 54421.066734313965, 48843.48682594299, 52501.76678466797, 52392.933502197266, 54530.71347808838, 53682.2933921814, 52525.38663101196, 51461.42683029175, 55789.247009277344, 55397.2067527771, 49516.506788253784, 55336.59349822998, 50587.353536605835, 54253.46022415161, 55463.373233795166, 51381.60017967224, 54998.57362365723, 54705.346755981445, 50521.093534469604, 56744.86666870117, 52138.43345928192, 51669.533473968506, 55439.30033874512, 51434.80029773712, 54972.78018951416, 52633.146560668945, 55639.41338348389, 50911.56681108475, 52860.32682800293, 49559.04015159607, 51541.066665649414, 57344.57364845276, 53785.7534866333, 52602.140184402466, 55901.553451538086, 53818.42029476166, 50894.406940460205, 52278.913635253906, 54540.95994567871, 53253.466796875, 52600.64035797119, 55150.206676483154, 54509.493639945984, 53971.366874694824, 50202.820034623146, 53501.44675254822, 48820.740191459656, 55928.72002029419, 47835.31324958801, 51433.380096912384, 52511.51326370239, 52383.086656570435, 49737.72679424286, 51065.12679672241, 54119.2338180542, 55950.553367614746, 56598.100189208984, 51907.54020500183, 50989.300174713135, 53855.41994857788, 50462.25346374512, 52848.853435993195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.46580622225153, "mean_inference_ms": 6.634919316492469, "mean_action_processing_ms": 0.19956692868616224, "mean_env_wait_ms": 222.184268694747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040761162252987135, "StateBufferConnector_ms": 0.005673160072134323, "ViewRequirementAgentConnector_ms": 0.182298051209009}}, "episode_reward_max": 58191.22713088989, "episode_reward_min": 43960.586731910706, "episode_reward_mean": 52868.18327193351, "episode_len_mean": 135.05882352941177, "episodes_this_iter": 119, "policy_reward_min": {"agent_0": 43960.586731910706}, "policy_reward_max": {"agent_0": 58191.22713088989}, "policy_reward_mean": {"agent_0": 52868.18327193351}, "hist_stats": {"episode_reward": [51320.64685535431, 54504.1999206543, 51819.373474121094, 51978.12683105469, 49518.42654418945, 52539.1536026001, 53211.88697242737, 51148.233536720276, 54674.94691467285, 53204.46002483368, 48470.19344520569, 53300.173412323, 51848.31366252899, 55559.26696777344, 52798.12007713318, 54452.22010040283, 50376.773292541504, 53577.939933776855, 52653.0666809082, 43960.586731910706, 55976.92672729492, 51698.3536157608, 54472.9736328125, 51869.160022735596, 53892.426681518555, 50752.600116729736, 53908.91349029541, 48182.60669326782, 52420.52677154541, 57035.253425598145, 56860.82676696777, 52252.066776275635, 55203.23312950134, 58191.22713088989, 48996.380113601685, 55073.9666595459, 48436.34687995911, 55943.56701660156, 56162.80702209473, 54338.633460998535, 52651.60687637329, 54932.040130615234, 54272.940242767334, 55025.69355010986, 48409.36003494263, 52924.866747796535, 52226.433382987976, 51911.91341018677, 51855.75322723389, 52263.82029533386, 53423.93361186981, 44572.96677827835, 52512.54002952576, 55323.07995223999, 55741.31354522705, 51943.72013282776, 54080.19375991821, 54421.066734313965, 48843.48682594299, 52501.76678466797, 52392.933502197266, 54530.71347808838, 53682.2933921814, 52525.38663101196, 51461.42683029175, 55789.247009277344, 55397.2067527771, 49516.506788253784, 55336.59349822998, 50587.353536605835, 54253.46022415161, 55463.373233795166, 51381.60017967224, 54998.57362365723, 54705.346755981445, 50521.093534469604, 56744.86666870117, 52138.43345928192, 51669.533473968506, 55439.30033874512, 51434.80029773712, 54972.78018951416, 52633.146560668945, 55639.41338348389, 50911.56681108475, 52860.32682800293, 49559.04015159607, 51541.066665649414, 57344.57364845276, 53785.7534866333, 52602.140184402466, 55901.553451538086, 53818.42029476166, 50894.406940460205, 52278.913635253906, 54540.95994567871, 53253.466796875, 52600.64035797119, 55150.206676483154, 54509.493639945984, 53971.366874694824, 50202.820034623146, 53501.44675254822, 48820.740191459656, 55928.72002029419, 47835.31324958801, 51433.380096912384, 52511.51326370239, 52383.086656570435, 49737.72679424286, 51065.12679672241, 54119.2338180542, 55950.553367614746, 56598.100189208984, 51907.54020500183, 50989.300174713135, 53855.41994857788, 50462.25346374512, 52848.853435993195], "episode_lengths": [135, 134, 135, 136, 135, 136, 136, 136, 135, 136, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 135, 135, 136, 135, 134, 135, 135, 136, 135, 136, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 134, 135, 134, 135, 136, 134, 135, 135, 135, 136, 134, 135, 134, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 134, 135, 136, 135, 135, 136, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136], "policy_agent_0_reward": [51320.64685535431, 54504.1999206543, 51819.373474121094, 51978.12683105469, 49518.42654418945, 52539.1536026001, 53211.88697242737, 51148.233536720276, 54674.94691467285, 53204.46002483368, 48470.19344520569, 53300.173412323, 51848.31366252899, 55559.26696777344, 52798.12007713318, 54452.22010040283, 50376.773292541504, 53577.939933776855, 52653.0666809082, 43960.586731910706, 55976.92672729492, 51698.3536157608, 54472.9736328125, 51869.160022735596, 53892.426681518555, 50752.600116729736, 53908.91349029541, 48182.60669326782, 52420.52677154541, 57035.253425598145, 56860.82676696777, 52252.066776275635, 55203.23312950134, 58191.22713088989, 48996.380113601685, 55073.9666595459, 48436.34687995911, 55943.56701660156, 56162.80702209473, 54338.633460998535, 52651.60687637329, 54932.040130615234, 54272.940242767334, 55025.69355010986, 48409.36003494263, 52924.866747796535, 52226.433382987976, 51911.91341018677, 51855.75322723389, 52263.82029533386, 53423.93361186981, 44572.96677827835, 52512.54002952576, 55323.07995223999, 55741.31354522705, 51943.72013282776, 54080.19375991821, 54421.066734313965, 48843.48682594299, 52501.76678466797, 52392.933502197266, 54530.71347808838, 53682.2933921814, 52525.38663101196, 51461.42683029175, 55789.247009277344, 55397.2067527771, 49516.506788253784, 55336.59349822998, 50587.353536605835, 54253.46022415161, 55463.373233795166, 51381.60017967224, 54998.57362365723, 54705.346755981445, 50521.093534469604, 56744.86666870117, 52138.43345928192, 51669.533473968506, 55439.30033874512, 51434.80029773712, 54972.78018951416, 52633.146560668945, 55639.41338348389, 50911.56681108475, 52860.32682800293, 49559.04015159607, 51541.066665649414, 57344.57364845276, 53785.7534866333, 52602.140184402466, 55901.553451538086, 53818.42029476166, 50894.406940460205, 52278.913635253906, 54540.95994567871, 53253.466796875, 52600.64035797119, 55150.206676483154, 54509.493639945984, 53971.366874694824, 50202.820034623146, 53501.44675254822, 48820.740191459656, 55928.72002029419, 47835.31324958801, 51433.380096912384, 52511.51326370239, 52383.086656570435, 49737.72679424286, 51065.12679672241, 54119.2338180542, 55950.553367614746, 56598.100189208984, 51907.54020500183, 50989.300174713135, 53855.41994857788, 50462.25346374512, 52848.853435993195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.46580622225153, "mean_inference_ms": 6.634919316492469, "mean_action_processing_ms": 0.19956692868616224, "mean_env_wait_ms": 222.184268694747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040761162252987135, "StateBufferConnector_ms": 0.005673160072134323, "ViewRequirementAgentConnector_ms": 0.182298051209009}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.66171848425867, "num_env_steps_trained_throughput_per_sec": 202.66171848425867, "timesteps_total": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 16106.955, "sample_time_ms": 12066.08, "learn_time_ms": 3902.883, "learn_throughput": 1024.884, "synch_weights_time_ms": 137.163}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 7503, "training_iteration": 255, "trial_id": "185f8_00000", "date": "2025-03-21_12-52-46", "timestamp": 1742561566, "time_this_iter_s": 19.789525032043457, "time_total_s": 4084.030328989029, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f9ad750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4084.030328989029, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 92.6148148148148, "ram_util_percent": 13.766666666666666}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.979819297790527, "policy_loss": -0.01747286692261696, "vf_loss": 9.9951171875, "vf_explained_var": 7.015963632284183e-08, "kl": 0.010878738015890121, "entropy": 0.3480314612388611, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "sampler_results": {"episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}}, "episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.5023667650289, "num_env_steps_trained_throughput_per_sec": 274.5023667650289, "timesteps_total": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 15683.562, "sample_time_ms": 11681.732, "learn_time_ms": 3865.488, "learn_throughput": 1034.798, "synch_weights_time_ms": 135.486}, "counters": {"num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "episodes_total": 7504, "training_iteration": 256, "trial_id": "185f8_00000", "date": "2025-03-21_12-53-01", "timestamp": 1742561581, "time_this_iter_s": 14.620176553726196, "time_total_s": 4098.650505542755, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb54e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4098.650505542755, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 99.54285714285714, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989091873168945, "policy_loss": -0.012437904253602028, "vf_loss": 10.0, "vf_explained_var": -1.447896096351542e-07, "kl": 0.007653006352484226, "entropy": 0.32699498534202576, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "sampler_results": {"episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}}, "episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.5607509204734, "num_env_steps_trained_throughput_per_sec": 271.5607509204734, "timesteps_total": 1028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1028000, "timers": {"training_iteration_time_ms": 15455.704, "sample_time_ms": 11423.469, "learn_time_ms": 3891.459, "learn_throughput": 1027.892, "synch_weights_time_ms": 139.896}, "counters": {"num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "done": false, "episodes_total": 7504, "training_iteration": 257, "trial_id": "185f8_00000", "date": "2025-03-21_12-53-16", "timestamp": 1742561596, "time_this_iter_s": 14.779873371124268, "time_total_s": 4113.430378913879, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2d240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4113.430378913879, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 99.4952380952381, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985881805419922, "policy_loss": -0.013644577004015446, "vf_loss": 9.997617721557617, "vf_explained_var": -7.264316259636416e-09, "kl": 0.009545267559587955, "entropy": 0.3689623177051544, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}}, "episode_reward_max": 54378.793518066406, "episode_reward_min": 54378.793518066406, "episode_reward_mean": 54378.793518066406, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54378.793518066406}, "policy_reward_max": {"agent_0": 54378.793518066406}, "policy_reward_mean": {"agent_0": 54378.793518066406}, "hist_stats": {"episode_reward": [54378.793518066406], "episode_lengths": [134], "policy_agent_0_reward": [54378.793518066406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.942268689887342, "mean_inference_ms": 6.702371258215871, "mean_action_processing_ms": 0.19661964559176925, "mean_env_wait_ms": 211.47610111509726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02853870391845703, "StateBufferConnector_ms": 0.004696846008300781, "ViewRequirementAgentConnector_ms": 0.12307167053222658}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.56601540627884, "num_env_steps_trained_throughput_per_sec": 292.56601540627884, "timesteps_total": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 15481.3, "sample_time_ms": 11466.856, "learn_time_ms": 3882.885, "learn_throughput": 1030.162, "synch_weights_time_ms": 130.676}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 7504, "training_iteration": 258, "trial_id": "185f8_00000", "date": "2025-03-21_12-53-30", "timestamp": 1742561610, "time_this_iter_s": 13.72103762626648, "time_total_s": 4127.151416540146, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2f910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4127.151416540146, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 99.4421052631579, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.016528925619835, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.681463241577148, "policy_loss": -0.016560057178139687, "vf_loss": 9.696137428283691, "vf_explained_var": 1.0891507145061041e-06, "kl": 0.009433862753212452, "entropy": 0.3665217161178589, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "sampler_results": {"episode_reward_max": 58331.547035217285, "episode_reward_min": 44350.98673534393, "episode_reward_mean": 52752.39259262568, "episode_len_mean": 135.06611570247935, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 44350.98673534393}, "policy_reward_max": {"agent_0": 58331.547035217285}, "policy_reward_mean": {"agent_0": 52752.39259262568}, "custom_metrics": {"num_batches_mean": 5.016528925619835, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55352.02682495117, 51111.23346042633, 49325.313344955444, 52633.38679122925, 55649.040128707886, 50644.77987098694, 55060.18013000488, 57035.846908569336, 54937.58670043945, 53417.2799987793, 50249.46684575081, 50226.780113220215, 58093.59991455078, 53125.52674865723, 54248.87350463867, 52194.43335914612, 53171.6132273674, 54686.03345489502, 50684.48020744324, 53158.89349985123, 47964.513530135155, 55981.70016479492, 56677.18028259277, 51130.640058517456, 54147.693714141846, 44350.98673534393, 55767.100189208984, 54570.58674621582, 51050.320097625256, 48701.45354413986, 52200.30015563965, 50986.353424072266, 54586.98027420044, 49500.81338787079, 56118.22024536133, 56041.48037338257, 54609.52027130127, 54722.84684753418, 54115.33348083496, 50277.7669467926, 54186.42000579834, 48859.54010486603, 54758.073570251465, 54797.36023712158, 52147.09321975708, 51465.847054481506, 53266.76684188843, 54574.60661315918, 55757.133502960205, 47841.526708602905, 51504.38696670532, 49515.386793613434, 52885.40675389767, 54891.20036315918, 52323.13987541199, 49701.18018245697, 56796.67346191406, 55140.75996398926, 56925.96025085449, 44723.88663005829, 52915.62700843811, 52467.19351053238, 54942.18681430817, 46004.946825027466, 55017.31997680664, 51056.69368124008, 49615.47353076935, 56390.820137023926, 53751.22700881958, 54578.340171813965, 58331.547035217285, 52120.42021369934, 53508.39359664917, 48204.93342208862, 53183.09339904785, 50847.44003534317, 51559.98663330078, 47841.02689743042, 56430.79995727539, 53155.40032577515, 50086.093547821045, 56294.86042404175, 54563.18016052246, 53860.486892700195, 48658.31345939636, 49840.94668388367, 54480.22671508789, 44738.49325478077, 55324.24021911621, 54079.28016662598, 53193.64666748047, 52722.620151519775, 53653.46659851074, 51408.48665332794, 54328.62701034546, 50695.20678329468, 55203.88687133789, 49298.78025960922, 55013.82678222656, 50248.26025390625, 52611.6668548584, 56381.900049209595, 54895.84005737305, 55378.00016784668, 55215.90020751953, 52446.3270740509, 52907.140075683594, 52405.69358634949, 54071.52012634277, 51408.320083618164, 47745.766706466675, 53089.00017166138, 52917.053564071655, 45429.31999492645, 48502.046699523926, 53174.06677246094, 55687.06008148193, 55558.75353240967, 55926.02670478821, 54439.800256729126, 52661.986598968506], "episode_lengths": [135, 135, 135, 135, 134, 135, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 135, 135, 134, 136, 135, 136, 134, 136, 136, 135, 135, 135, 134, 135, 135, 135, 134, 136, 135, 136, 135, 135, 134, 136, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 136, 136, 135, 136, 137, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55352.02682495117, 51111.23346042633, 49325.313344955444, 52633.38679122925, 55649.040128707886, 50644.77987098694, 55060.18013000488, 57035.846908569336, 54937.58670043945, 53417.2799987793, 50249.46684575081, 50226.780113220215, 58093.59991455078, 53125.52674865723, 54248.87350463867, 52194.43335914612, 53171.6132273674, 54686.03345489502, 50684.48020744324, 53158.89349985123, 47964.513530135155, 55981.70016479492, 56677.18028259277, 51130.640058517456, 54147.693714141846, 44350.98673534393, 55767.100189208984, 54570.58674621582, 51050.320097625256, 48701.45354413986, 52200.30015563965, 50986.353424072266, 54586.98027420044, 49500.81338787079, 56118.22024536133, 56041.48037338257, 54609.52027130127, 54722.84684753418, 54115.33348083496, 50277.7669467926, 54186.42000579834, 48859.54010486603, 54758.073570251465, 54797.36023712158, 52147.09321975708, 51465.847054481506, 53266.76684188843, 54574.60661315918, 55757.133502960205, 47841.526708602905, 51504.38696670532, 49515.386793613434, 52885.40675389767, 54891.20036315918, 52323.13987541199, 49701.18018245697, 56796.67346191406, 55140.75996398926, 56925.96025085449, 44723.88663005829, 52915.62700843811, 52467.19351053238, 54942.18681430817, 46004.946825027466, 55017.31997680664, 51056.69368124008, 49615.47353076935, 56390.820137023926, 53751.22700881958, 54578.340171813965, 58331.547035217285, 52120.42021369934, 53508.39359664917, 48204.93342208862, 53183.09339904785, 50847.44003534317, 51559.98663330078, 47841.02689743042, 56430.79995727539, 53155.40032577515, 50086.093547821045, 56294.86042404175, 54563.18016052246, 53860.486892700195, 48658.31345939636, 49840.94668388367, 54480.22671508789, 44738.49325478077, 55324.24021911621, 54079.28016662598, 53193.64666748047, 52722.620151519775, 53653.46659851074, 51408.48665332794, 54328.62701034546, 50695.20678329468, 55203.88687133789, 49298.78025960922, 55013.82678222656, 50248.26025390625, 52611.6668548584, 56381.900049209595, 54895.84005737305, 55378.00016784668, 55215.90020751953, 52446.3270740509, 52907.140075683594, 52405.69358634949, 54071.52012634277, 51408.320083618164, 47745.766706466675, 53089.00017166138, 52917.053564071655, 45429.31999492645, 48502.046699523926, 53174.06677246094, 55687.06008148193, 55558.75353240967, 55926.02670478821, 54439.800256729126, 52661.986598968506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.46007071241194, "mean_inference_ms": 6.629047360935953, "mean_action_processing_ms": 0.1994163163121683, "mean_env_wait_ms": 222.36346223301692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04646955442822669, "StateBufferConnector_ms": 0.005783325384471042, "ViewRequirementAgentConnector_ms": 0.1805943891036609}}, "episode_reward_max": 58331.547035217285, "episode_reward_min": 44350.98673534393, "episode_reward_mean": 52752.39259262568, "episode_len_mean": 135.06611570247935, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 44350.98673534393}, "policy_reward_max": {"agent_0": 58331.547035217285}, "policy_reward_mean": {"agent_0": 52752.39259262568}, "hist_stats": {"episode_reward": [55352.02682495117, 51111.23346042633, 49325.313344955444, 52633.38679122925, 55649.040128707886, 50644.77987098694, 55060.18013000488, 57035.846908569336, 54937.58670043945, 53417.2799987793, 50249.46684575081, 50226.780113220215, 58093.59991455078, 53125.52674865723, 54248.87350463867, 52194.43335914612, 53171.6132273674, 54686.03345489502, 50684.48020744324, 53158.89349985123, 47964.513530135155, 55981.70016479492, 56677.18028259277, 51130.640058517456, 54147.693714141846, 44350.98673534393, 55767.100189208984, 54570.58674621582, 51050.320097625256, 48701.45354413986, 52200.30015563965, 50986.353424072266, 54586.98027420044, 49500.81338787079, 56118.22024536133, 56041.48037338257, 54609.52027130127, 54722.84684753418, 54115.33348083496, 50277.7669467926, 54186.42000579834, 48859.54010486603, 54758.073570251465, 54797.36023712158, 52147.09321975708, 51465.847054481506, 53266.76684188843, 54574.60661315918, 55757.133502960205, 47841.526708602905, 51504.38696670532, 49515.386793613434, 52885.40675389767, 54891.20036315918, 52323.13987541199, 49701.18018245697, 56796.67346191406, 55140.75996398926, 56925.96025085449, 44723.88663005829, 52915.62700843811, 52467.19351053238, 54942.18681430817, 46004.946825027466, 55017.31997680664, 51056.69368124008, 49615.47353076935, 56390.820137023926, 53751.22700881958, 54578.340171813965, 58331.547035217285, 52120.42021369934, 53508.39359664917, 48204.93342208862, 53183.09339904785, 50847.44003534317, 51559.98663330078, 47841.02689743042, 56430.79995727539, 53155.40032577515, 50086.093547821045, 56294.86042404175, 54563.18016052246, 53860.486892700195, 48658.31345939636, 49840.94668388367, 54480.22671508789, 44738.49325478077, 55324.24021911621, 54079.28016662598, 53193.64666748047, 52722.620151519775, 53653.46659851074, 51408.48665332794, 54328.62701034546, 50695.20678329468, 55203.88687133789, 49298.78025960922, 55013.82678222656, 50248.26025390625, 52611.6668548584, 56381.900049209595, 54895.84005737305, 55378.00016784668, 55215.90020751953, 52446.3270740509, 52907.140075683594, 52405.69358634949, 54071.52012634277, 51408.320083618164, 47745.766706466675, 53089.00017166138, 52917.053564071655, 45429.31999492645, 48502.046699523926, 53174.06677246094, 55687.06008148193, 55558.75353240967, 55926.02670478821, 54439.800256729126, 52661.986598968506], "episode_lengths": [135, 135, 135, 135, 134, 135, 134, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 135, 135, 134, 136, 135, 136, 134, 136, 136, 135, 135, 135, 134, 135, 135, 135, 134, 136, 135, 136, 135, 135, 134, 136, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 135, 136, 136, 135, 136, 137, 136, 135, 135, 135, 135, 135], "policy_agent_0_reward": [55352.02682495117, 51111.23346042633, 49325.313344955444, 52633.38679122925, 55649.040128707886, 50644.77987098694, 55060.18013000488, 57035.846908569336, 54937.58670043945, 53417.2799987793, 50249.46684575081, 50226.780113220215, 58093.59991455078, 53125.52674865723, 54248.87350463867, 52194.43335914612, 53171.6132273674, 54686.03345489502, 50684.48020744324, 53158.89349985123, 47964.513530135155, 55981.70016479492, 56677.18028259277, 51130.640058517456, 54147.693714141846, 44350.98673534393, 55767.100189208984, 54570.58674621582, 51050.320097625256, 48701.45354413986, 52200.30015563965, 50986.353424072266, 54586.98027420044, 49500.81338787079, 56118.22024536133, 56041.48037338257, 54609.52027130127, 54722.84684753418, 54115.33348083496, 50277.7669467926, 54186.42000579834, 48859.54010486603, 54758.073570251465, 54797.36023712158, 52147.09321975708, 51465.847054481506, 53266.76684188843, 54574.60661315918, 55757.133502960205, 47841.526708602905, 51504.38696670532, 49515.386793613434, 52885.40675389767, 54891.20036315918, 52323.13987541199, 49701.18018245697, 56796.67346191406, 55140.75996398926, 56925.96025085449, 44723.88663005829, 52915.62700843811, 52467.19351053238, 54942.18681430817, 46004.946825027466, 55017.31997680664, 51056.69368124008, 49615.47353076935, 56390.820137023926, 53751.22700881958, 54578.340171813965, 58331.547035217285, 52120.42021369934, 53508.39359664917, 48204.93342208862, 53183.09339904785, 50847.44003534317, 51559.98663330078, 47841.02689743042, 56430.79995727539, 53155.40032577515, 50086.093547821045, 56294.86042404175, 54563.18016052246, 53860.486892700195, 48658.31345939636, 49840.94668388367, 54480.22671508789, 44738.49325478077, 55324.24021911621, 54079.28016662598, 53193.64666748047, 52722.620151519775, 53653.46659851074, 51408.48665332794, 54328.62701034546, 50695.20678329468, 55203.88687133789, 49298.78025960922, 55013.82678222656, 50248.26025390625, 52611.6668548584, 56381.900049209595, 54895.84005737305, 55378.00016784668, 55215.90020751953, 52446.3270740509, 52907.140075683594, 52405.69358634949, 54071.52012634277, 51408.320083618164, 47745.766706466675, 53089.00017166138, 52917.053564071655, 45429.31999492645, 48502.046699523926, 53174.06677246094, 55687.06008148193, 55558.75353240967, 55926.02670478821, 54439.800256729126, 52661.986598968506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.46007071241194, "mean_inference_ms": 6.629047360935953, "mean_action_processing_ms": 0.1994163163121683, "mean_env_wait_ms": 222.36346223301692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04646955442822669, "StateBufferConnector_ms": 0.005783325384471042, "ViewRequirementAgentConnector_ms": 0.1805943891036609}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.3408247595014, "num_env_steps_trained_throughput_per_sec": 198.3408247595014, "timesteps_total": 1036000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1036000, "timers": {"training_iteration_time_ms": 16071.655, "sample_time_ms": 12112.318, "learn_time_ms": 3831.529, "learn_throughput": 1043.97, "synch_weights_time_ms": 126.957}, "counters": {"num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "done": false, "episodes_total": 7625, "training_iteration": 259, "trial_id": "185f8_00000", "date": "2025-03-21_12-53-50", "timestamp": 1742561630, "time_this_iter_s": 20.227001190185547, "time_total_s": 4147.378417730331, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2fac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4147.378417730331, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 91.14074074074075, "ram_util_percent": 13.77037037037037}}
{"custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.980199813842773, "policy_loss": -0.014371665194630623, "vf_loss": 9.99267578125, "vf_explained_var": -1.4256686426961096e-06, "kl": 0.009481502696871758, "entropy": 0.3538997769355774, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "sampler_results": {"episode_reward_max": 55418.360275268555, "episode_reward_min": 52309.77341175079, "episode_reward_mean": 54334.61572933197, "episode_len_mean": 134.66666666666666, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 52309.77341175079}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 54334.61572933197}, "custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55275.71350097656, 52309.77341175079, 55418.360275268555], "episode_lengths": [135, 135, 134], "policy_agent_0_reward": [55275.71350097656, 52309.77341175079, 55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.423171392628326, "mean_inference_ms": 6.525999441229463, "mean_action_processing_ms": 0.20531916569261263, "mean_env_wait_ms": 210.44110453490475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033370653788248696, "StateBufferConnector_ms": 0.005404154459635417, "ViewRequirementAgentConnector_ms": 0.14430681864420572}}, "episode_reward_max": 55418.360275268555, "episode_reward_min": 52309.77341175079, "episode_reward_mean": 54334.61572933197, "episode_len_mean": 134.66666666666666, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 52309.77341175079}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 54334.61572933197}, "hist_stats": {"episode_reward": [55275.71350097656, 52309.77341175079, 55418.360275268555], "episode_lengths": [135, 135, 134], "policy_agent_0_reward": [55275.71350097656, 52309.77341175079, 55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.423171392628326, "mean_inference_ms": 6.525999441229463, "mean_action_processing_ms": 0.20531916569261263, "mean_env_wait_ms": 210.44110453490475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033370653788248696, "StateBufferConnector_ms": 0.005404154459635417, "ViewRequirementAgentConnector_ms": 0.14430681864420572}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0922921329691, "num_env_steps_trained_throughput_per_sec": 301.0922921329691, "timesteps_total": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 15884.932, "sample_time_ms": 11909.844, "learn_time_ms": 3844.37, "learn_throughput": 1040.483, "synch_weights_time_ms": 129.867}, "counters": {"num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "episodes_total": 7628, "training_iteration": 260, "trial_id": "185f8_00000", "date": "2025-03-21_12-54-03", "timestamp": 1742561643, "time_this_iter_s": 13.339606523513794, "time_total_s": 4160.718024253845, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2d120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4160.718024253845, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 99.55263157894737, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986116409301758, "policy_loss": -0.01579725369811058, "vf_loss": 10.0, "vf_explained_var": 3.103166932305612e-07, "kl": 0.009569760411977768, "entropy": 0.37139734625816345, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 55418.360275268555, "episode_reward_min": 55418.360275268555, "episode_reward_mean": 55418.360275268555, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55418.360275268555}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 55418.360275268555}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55418.360275268555], "episode_lengths": [134], "policy_agent_0_reward": [55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.65769984413452, "mean_inference_ms": 6.710419606501206, "mean_action_processing_ms": 0.1968284987469762, "mean_env_wait_ms": 211.10950201461537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982616424560547, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.1316070556640625}}, "episode_reward_max": 55418.360275268555, "episode_reward_min": 55418.360275268555, "episode_reward_mean": 55418.360275268555, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55418.360275268555}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 55418.360275268555}, "hist_stats": {"episode_reward": [55418.360275268555], "episode_lengths": [134], "policy_agent_0_reward": [55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.65769984413452, "mean_inference_ms": 6.710419606501206, "mean_action_processing_ms": 0.1968284987469762, "mean_env_wait_ms": 211.10950201461537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982616424560547, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.1316070556640625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.45778136784105, "num_env_steps_trained_throughput_per_sec": 288.45778136784105, "timesteps_total": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 15190.195, "sample_time_ms": 11215.357, "learn_time_ms": 3846.579, "learn_throughput": 1039.885, "synch_weights_time_ms": 127.417}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 7628, "training_iteration": 261, "trial_id": "185f8_00000", "date": "2025-03-21_12-54-17", "timestamp": 1742561657, "time_this_iter_s": 13.913261651992798, "time_total_s": 4174.631285905838, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2ea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4174.631285905838, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 99.56, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983867645263672, "policy_loss": -0.015509067103266716, "vf_loss": 9.99736213684082, "vf_explained_var": -5.119790671415103e-07, "kl": 0.010069935582578182, "entropy": 0.39981651306152344, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "sampler_results": {"episode_reward_max": 55418.360275268555, "episode_reward_min": 55418.360275268555, "episode_reward_mean": 55418.360275268555, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55418.360275268555}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 55418.360275268555}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55418.360275268555], "episode_lengths": [134], "policy_agent_0_reward": [55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.65769984413452, "mean_inference_ms": 6.710419606501206, "mean_action_processing_ms": 0.1968284987469762, "mean_env_wait_ms": 211.10950201461537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982616424560547, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.1316070556640625}}, "episode_reward_max": 55418.360275268555, "episode_reward_min": 55418.360275268555, "episode_reward_mean": 55418.360275268555, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55418.360275268555}, "policy_reward_max": {"agent_0": 55418.360275268555}, "policy_reward_mean": {"agent_0": 55418.360275268555}, "hist_stats": {"episode_reward": [55418.360275268555], "episode_lengths": [134], "policy_agent_0_reward": [55418.360275268555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.65769984413452, "mean_inference_ms": 6.710419606501206, "mean_action_processing_ms": 0.1968284987469762, "mean_env_wait_ms": 211.10950201461537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02982616424560547, "StateBufferConnector_ms": 0.005078315734863281, "ViewRequirementAgentConnector_ms": 0.1316070556640625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.8695495696034, "num_env_steps_trained_throughput_per_sec": 277.8695495696034, "timesteps_total": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 15244.411, "sample_time_ms": 11309.495, "learn_time_ms": 3805.928, "learn_throughput": 1050.992, "synch_weights_time_ms": 128.138}, "counters": {"num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "episodes_total": 7628, "training_iteration": 262, "trial_id": "185f8_00000", "date": "2025-03-21_12-54-32", "timestamp": 1742561672, "time_this_iter_s": 14.441261529922485, "time_total_s": 4189.0725474357605, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f9ad750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4189.0725474357605, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 99.42857142857143, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.708783149719238, "policy_loss": -0.012315292842686176, "vf_loss": 9.719514846801758, "vf_explained_var": -1.4894952471422584e-07, "kl": 0.007914687506854534, "entropy": 0.33812931180000305, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "sampler_results": {"episode_reward_max": 59111.900299072266, "episode_reward_min": 43679.08672237396, "episode_reward_mean": 52438.2963411808, "episode_len_mean": 135.16964285714286, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {"agent_0": 43679.08672237396}, "policy_reward_max": {"agent_0": 59111.900299072266}, "policy_reward_mean": {"agent_0": 52438.2963411808}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51137.46011924744, 53551.413646698, 55407.80034637451, 51495.75997924805, 49843.3270111084, 55517.273292541504, 53547.753677368164, 48140.73354911804, 52319.79347991943, 53655.85342025757, 45252.77331352234, 52874.77993583679, 57364.40019226074, 59111.900299072266, 51349.006711006165, 53106.746918678284, 52713.19339752197, 49773.033348083496, 56130.6335144043, 55642.333362579346, 54875.55362701416, 46925.32675135136, 55312.67367553711, 48747.40688705444, 51995.666732788086, 56667.38706970215, 54752.01362609863, 51271.433811187744, 51346.17353916168, 49418.413621902466, 47906.52009296417, 53471.32017326355, 54117.91332817078, 49698.920139312744, 55099.31344985962, 51039.686893463135, 53834.20698547363, 55871.273361206055, 51212.82003116608, 51713.78014945984, 51605.99338054657, 49335.79322910309, 52151.92687892914, 51668.62015628815, 56996.259899139404, 55910.91352844238, 51699.300178050995, 55009.42029380798, 54301.70669174194, 54921.113525390625, 54816.60688781738, 52449.67337036133, 55498.42032241821, 56706.70686340332, 45618.89998161793, 48313.22665655613, 43679.08672237396, 49720.2334356308, 55702.40027999878, 47183.760202884674, 52583.64671707153, 55495.98699951172, 51390.306732177734, 50374.60001087189, 52308.74674797058, 54865.70009613037, 54690.68670654297, 52485.06698703766, 55853.80684661865, 46480.74009561539, 44140.640171051025, 51135.680070877075, 54213.86025810242, 52750.60018157959, 52098.5202331543, 53437.39353179932, 54961.086780548096, 57464.11364746094, 52153.31993103027, 50289.37317657471, 54650.02015686035, 48474.926865935326, 54652.03377532959, 52691.73989534378, 49597.44673156738, 51082.64693450928, 51724.08684206009, 51338.15347862244, 53172.34034347534, 50598.7866601944, 51836.81309890747, 54108.29379892349, 54442.28025817871, 49670.806888103485, 56763.92706298828, 56415.18670654297, 56794.4201965332, 52758.966899871826, 53863.34671783447, 52368.7135925293, 45954.98002433777, 53624.33368110657, 52656.44011306763, 51023.20024681091, 52857.18682098389, 52309.93340873718, 50200.11342835426, 51219.68672180176, 52380.35345649719, 51552.373403549194, 54386.29341506958, 52241.64672040939], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 134, 136, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 134, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 134, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 134, 134, 135, 135, 135, 136, 134, 136, 135, 135, 134, 136, 136, 135, 136, 135, 135], "policy_agent_0_reward": [51137.46011924744, 53551.413646698, 55407.80034637451, 51495.75997924805, 49843.3270111084, 55517.273292541504, 53547.753677368164, 48140.73354911804, 52319.79347991943, 53655.85342025757, 45252.77331352234, 52874.77993583679, 57364.40019226074, 59111.900299072266, 51349.006711006165, 53106.746918678284, 52713.19339752197, 49773.033348083496, 56130.6335144043, 55642.333362579346, 54875.55362701416, 46925.32675135136, 55312.67367553711, 48747.40688705444, 51995.666732788086, 56667.38706970215, 54752.01362609863, 51271.433811187744, 51346.17353916168, 49418.413621902466, 47906.52009296417, 53471.32017326355, 54117.91332817078, 49698.920139312744, 55099.31344985962, 51039.686893463135, 53834.20698547363, 55871.273361206055, 51212.82003116608, 51713.78014945984, 51605.99338054657, 49335.79322910309, 52151.92687892914, 51668.62015628815, 56996.259899139404, 55910.91352844238, 51699.300178050995, 55009.42029380798, 54301.70669174194, 54921.113525390625, 54816.60688781738, 52449.67337036133, 55498.42032241821, 56706.70686340332, 45618.89998161793, 48313.22665655613, 43679.08672237396, 49720.2334356308, 55702.40027999878, 47183.760202884674, 52583.64671707153, 55495.98699951172, 51390.306732177734, 50374.60001087189, 52308.74674797058, 54865.70009613037, 54690.68670654297, 52485.06698703766, 55853.80684661865, 46480.74009561539, 44140.640171051025, 51135.680070877075, 54213.86025810242, 52750.60018157959, 52098.5202331543, 53437.39353179932, 54961.086780548096, 57464.11364746094, 52153.31993103027, 50289.37317657471, 54650.02015686035, 48474.926865935326, 54652.03377532959, 52691.73989534378, 49597.44673156738, 51082.64693450928, 51724.08684206009, 51338.15347862244, 53172.34034347534, 50598.7866601944, 51836.81309890747, 54108.29379892349, 54442.28025817871, 49670.806888103485, 56763.92706298828, 56415.18670654297, 56794.4201965332, 52758.966899871826, 53863.34671783447, 52368.7135925293, 45954.98002433777, 53624.33368110657, 52656.44011306763, 51023.20024681091, 52857.18682098389, 52309.93340873718, 50200.11342835426, 51219.68672180176, 52380.35345649719, 51552.373403549194, 54386.29341506958, 52241.64672040939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.72063684367606, "mean_inference_ms": 6.652907498281117, "mean_action_processing_ms": 0.19951884830519304, "mean_env_wait_ms": 223.17830293572965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05184007542473929, "StateBufferConnector_ms": 0.005822522299630302, "ViewRequirementAgentConnector_ms": 0.18155638660703385}}, "episode_reward_max": 59111.900299072266, "episode_reward_min": 43679.08672237396, "episode_reward_mean": 52438.2963411808, "episode_len_mean": 135.16964285714286, "episodes_this_iter": 112, "policy_reward_min": {"agent_0": 43679.08672237396}, "policy_reward_max": {"agent_0": 59111.900299072266}, "policy_reward_mean": {"agent_0": 52438.2963411808}, "hist_stats": {"episode_reward": [51137.46011924744, 53551.413646698, 55407.80034637451, 51495.75997924805, 49843.3270111084, 55517.273292541504, 53547.753677368164, 48140.73354911804, 52319.79347991943, 53655.85342025757, 45252.77331352234, 52874.77993583679, 57364.40019226074, 59111.900299072266, 51349.006711006165, 53106.746918678284, 52713.19339752197, 49773.033348083496, 56130.6335144043, 55642.333362579346, 54875.55362701416, 46925.32675135136, 55312.67367553711, 48747.40688705444, 51995.666732788086, 56667.38706970215, 54752.01362609863, 51271.433811187744, 51346.17353916168, 49418.413621902466, 47906.52009296417, 53471.32017326355, 54117.91332817078, 49698.920139312744, 55099.31344985962, 51039.686893463135, 53834.20698547363, 55871.273361206055, 51212.82003116608, 51713.78014945984, 51605.99338054657, 49335.79322910309, 52151.92687892914, 51668.62015628815, 56996.259899139404, 55910.91352844238, 51699.300178050995, 55009.42029380798, 54301.70669174194, 54921.113525390625, 54816.60688781738, 52449.67337036133, 55498.42032241821, 56706.70686340332, 45618.89998161793, 48313.22665655613, 43679.08672237396, 49720.2334356308, 55702.40027999878, 47183.760202884674, 52583.64671707153, 55495.98699951172, 51390.306732177734, 50374.60001087189, 52308.74674797058, 54865.70009613037, 54690.68670654297, 52485.06698703766, 55853.80684661865, 46480.74009561539, 44140.640171051025, 51135.680070877075, 54213.86025810242, 52750.60018157959, 52098.5202331543, 53437.39353179932, 54961.086780548096, 57464.11364746094, 52153.31993103027, 50289.37317657471, 54650.02015686035, 48474.926865935326, 54652.03377532959, 52691.73989534378, 49597.44673156738, 51082.64693450928, 51724.08684206009, 51338.15347862244, 53172.34034347534, 50598.7866601944, 51836.81309890747, 54108.29379892349, 54442.28025817871, 49670.806888103485, 56763.92706298828, 56415.18670654297, 56794.4201965332, 52758.966899871826, 53863.34671783447, 52368.7135925293, 45954.98002433777, 53624.33368110657, 52656.44011306763, 51023.20024681091, 52857.18682098389, 52309.93340873718, 50200.11342835426, 51219.68672180176, 52380.35345649719, 51552.373403549194, 54386.29341506958, 52241.64672040939], "episode_lengths": [135, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 136, 135, 135, 134, 136, 135, 136, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 136, 136, 135, 135, 134, 135, 134, 135, 135, 135, 135, 135, 134, 135, 136, 135, 136, 136, 136, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 135, 135, 135, 134, 136, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 136, 135, 134, 134, 135, 135, 135, 136, 134, 136, 135, 135, 134, 136, 136, 135, 136, 135, 135], "policy_agent_0_reward": [51137.46011924744, 53551.413646698, 55407.80034637451, 51495.75997924805, 49843.3270111084, 55517.273292541504, 53547.753677368164, 48140.73354911804, 52319.79347991943, 53655.85342025757, 45252.77331352234, 52874.77993583679, 57364.40019226074, 59111.900299072266, 51349.006711006165, 53106.746918678284, 52713.19339752197, 49773.033348083496, 56130.6335144043, 55642.333362579346, 54875.55362701416, 46925.32675135136, 55312.67367553711, 48747.40688705444, 51995.666732788086, 56667.38706970215, 54752.01362609863, 51271.433811187744, 51346.17353916168, 49418.413621902466, 47906.52009296417, 53471.32017326355, 54117.91332817078, 49698.920139312744, 55099.31344985962, 51039.686893463135, 53834.20698547363, 55871.273361206055, 51212.82003116608, 51713.78014945984, 51605.99338054657, 49335.79322910309, 52151.92687892914, 51668.62015628815, 56996.259899139404, 55910.91352844238, 51699.300178050995, 55009.42029380798, 54301.70669174194, 54921.113525390625, 54816.60688781738, 52449.67337036133, 55498.42032241821, 56706.70686340332, 45618.89998161793, 48313.22665655613, 43679.08672237396, 49720.2334356308, 55702.40027999878, 47183.760202884674, 52583.64671707153, 55495.98699951172, 51390.306732177734, 50374.60001087189, 52308.74674797058, 54865.70009613037, 54690.68670654297, 52485.06698703766, 55853.80684661865, 46480.74009561539, 44140.640171051025, 51135.680070877075, 54213.86025810242, 52750.60018157959, 52098.5202331543, 53437.39353179932, 54961.086780548096, 57464.11364746094, 52153.31993103027, 50289.37317657471, 54650.02015686035, 48474.926865935326, 54652.03377532959, 52691.73989534378, 49597.44673156738, 51082.64693450928, 51724.08684206009, 51338.15347862244, 53172.34034347534, 50598.7866601944, 51836.81309890747, 54108.29379892349, 54442.28025817871, 49670.806888103485, 56763.92706298828, 56415.18670654297, 56794.4201965332, 52758.966899871826, 53863.34671783447, 52368.7135925293, 45954.98002433777, 53624.33368110657, 52656.44011306763, 51023.20024681091, 52857.18682098389, 52309.93340873718, 50200.11342835426, 51219.68672180176, 52380.35345649719, 51552.373403549194, 54386.29341506958, 52241.64672040939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.72063684367606, "mean_inference_ms": 6.652907498281117, "mean_action_processing_ms": 0.19951884830519304, "mean_env_wait_ms": 223.17830293572965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05184007542473929, "StateBufferConnector_ms": 0.005822522299630302, "ViewRequirementAgentConnector_ms": 0.18155638660703385}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.24023556828763, "num_env_steps_trained_throughput_per_sec": 210.24023556828763, "timesteps_total": 1052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1052000, "timers": {"training_iteration_time_ms": 15794.874, "sample_time_ms": 11922.092, "learn_time_ms": 3746.556, "learn_throughput": 1067.647, "synch_weights_time_ms": 125.351}, "counters": {"num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "done": false, "episodes_total": 7740, "training_iteration": 263, "trial_id": "185f8_00000", "date": "2025-03-21_12-54-51", "timestamp": 1742561691, "time_this_iter_s": 19.080721616744995, "time_total_s": 4208.1532690525055, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fb1edd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4208.1532690525055, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 91.49230769230768, "ram_util_percent": 13.78076923076923}}
{"custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.95201587677002, "policy_loss": -0.017279362305998802, "vf_loss": 9.967085838317871, "vf_explained_var": -4.8782676458358765e-06, "kl": 0.011043054983019829, "entropy": 0.36119306087493896, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 56635.666915893555, "episode_reward_min": 45698.80013227463, "episode_reward_mean": 51787.50511332353, "episode_len_mean": 135.16666666666666, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 45698.80013227463}, "policy_reward_max": {"agent_0": 56635.666915893555}, "policy_reward_mean": {"agent_0": 51787.50511332353}, "custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56635.666915893555, 52160.95334625244, 51625.23338508606, 46355.62000179291, 54785.1602268219, 52128.39324569702, 54313.82017707825, 48589.54033088684, 45698.80013227463, 49306.90675163269, 54769.49346923828, 55080.47337722778], "episode_lengths": [134, 135, 135, 136, 135, 135, 134, 136, 136, 136, 135, 135], "policy_agent_0_reward": [56635.666915893555, 52160.95334625244, 51625.23338508606, 46355.62000179291, 54785.1602268219, 52128.39324569702, 54313.82017707825, 48589.54033088684, 45698.80013227463, 49306.90675163269, 54769.49346923828, 55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.778273514409214, "mean_inference_ms": 6.430336669850516, "mean_action_processing_ms": 0.2001844992053081, "mean_env_wait_ms": 211.14397629339763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037839015324910484, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.2051393191019694}}, "episode_reward_max": 56635.666915893555, "episode_reward_min": 45698.80013227463, "episode_reward_mean": 51787.50511332353, "episode_len_mean": 135.16666666666666, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 45698.80013227463}, "policy_reward_max": {"agent_0": 56635.666915893555}, "policy_reward_mean": {"agent_0": 51787.50511332353}, "hist_stats": {"episode_reward": [56635.666915893555, 52160.95334625244, 51625.23338508606, 46355.62000179291, 54785.1602268219, 52128.39324569702, 54313.82017707825, 48589.54033088684, 45698.80013227463, 49306.90675163269, 54769.49346923828, 55080.47337722778], "episode_lengths": [134, 135, 135, 136, 135, 135, 134, 136, 136, 136, 135, 135], "policy_agent_0_reward": [56635.666915893555, 52160.95334625244, 51625.23338508606, 46355.62000179291, 54785.1602268219, 52128.39324569702, 54313.82017707825, 48589.54033088684, 45698.80013227463, 49306.90675163269, 54769.49346923828, 55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.778273514409214, "mean_inference_ms": 6.430336669850516, "mean_action_processing_ms": 0.2001844992053081, "mean_env_wait_ms": 211.14397629339763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037839015324910484, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.2051393191019694}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.23752833092726, "num_env_steps_trained_throughput_per_sec": 260.23752833092726, "timesteps_total": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15882.107, "sample_time_ms": 11935.444, "learn_time_ms": 3812.616, "learn_throughput": 1049.148, "synch_weights_time_ms": 133.131}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 7752, "training_iteration": 264, "trial_id": "185f8_00000", "date": "2025-03-21_12-55-06", "timestamp": 1742561706, "time_this_iter_s": 15.421732425689697, "time_total_s": 4223.575001478195, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4223.575001478195, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 99.45238095238095, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986967086791992, "policy_loss": -0.015030277892947197, "vf_loss": 10.0, "vf_explained_var": -7.181676664913539e-06, "kl": 0.009985287673771381, "entropy": 0.3742814064025879, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "sampler_results": {"episode_reward_max": 55080.47337722778, "episode_reward_min": 55080.47337722778, "episode_reward_mean": 55080.47337722778, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55080.47337722778}, "policy_reward_max": {"agent_0": 55080.47337722778}, "policy_reward_mean": {"agent_0": 55080.47337722778}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55080.47337722778], "episode_lengths": [135], "policy_agent_0_reward": [55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.02663847685904, "mean_inference_ms": 6.555634287634267, "mean_action_processing_ms": 0.2008225173128471, "mean_env_wait_ms": 226.0223322188957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03132820129394531, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.14095306396484375}}, "episode_reward_max": 55080.47337722778, "episode_reward_min": 55080.47337722778, "episode_reward_mean": 55080.47337722778, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55080.47337722778}, "policy_reward_max": {"agent_0": 55080.47337722778}, "policy_reward_mean": {"agent_0": 55080.47337722778}, "hist_stats": {"episode_reward": [55080.47337722778], "episode_lengths": [135], "policy_agent_0_reward": [55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.02663847685904, "mean_inference_ms": 6.555634287634267, "mean_action_processing_ms": 0.2008225173128471, "mean_env_wait_ms": 226.0223322188957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03132820129394531, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.14095306396484375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.7863383079628, "num_env_steps_trained_throughput_per_sec": 284.7863383079628, "timesteps_total": 1060000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1060000, "timers": {"training_iteration_time_ms": 15312.938, "sample_time_ms": 11274.226, "learn_time_ms": 3903.284, "learn_throughput": 1024.778, "synch_weights_time_ms": 134.509}, "counters": {"num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "done": false, "episodes_total": 7752, "training_iteration": 265, "trial_id": "185f8_00000", "date": "2025-03-21_12-55-21", "timestamp": 1742561721, "time_this_iter_s": 14.10543942451477, "time_total_s": 4237.68044090271, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2f910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4237.68044090271, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 99.51500000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986944198608398, "policy_loss": -0.012308569625020027, "vf_loss": 9.99755859375, "vf_explained_var": -5.343308203009656e-06, "kl": 0.008471059612929821, "entropy": 0.37906837463378906, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "sampler_results": {"episode_reward_max": 55080.47337722778, "episode_reward_min": 55080.47337722778, "episode_reward_mean": 55080.47337722778, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55080.47337722778}, "policy_reward_max": {"agent_0": 55080.47337722778}, "policy_reward_mean": {"agent_0": 55080.47337722778}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55080.47337722778], "episode_lengths": [135], "policy_agent_0_reward": [55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.02663847685904, "mean_inference_ms": 6.555634287634267, "mean_action_processing_ms": 0.2008225173128471, "mean_env_wait_ms": 226.0223322188957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03132820129394531, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.14095306396484375}}, "episode_reward_max": 55080.47337722778, "episode_reward_min": 55080.47337722778, "episode_reward_mean": 55080.47337722778, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55080.47337722778}, "policy_reward_max": {"agent_0": 55080.47337722778}, "policy_reward_mean": {"agent_0": 55080.47337722778}, "hist_stats": {"episode_reward": [55080.47337722778], "episode_lengths": [135], "policy_agent_0_reward": [55080.47337722778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 43.02663847685904, "mean_inference_ms": 6.555634287634267, "mean_action_processing_ms": 0.2008225173128471, "mean_env_wait_ms": 226.0223322188957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03132820129394531, "StateBufferConnector_ms": 0.00553131103515625, "ViewRequirementAgentConnector_ms": 0.14095306396484375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.95280331920713, "num_env_steps_trained_throughput_per_sec": 275.95280331920713, "timesteps_total": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 15305.27, "sample_time_ms": 11225.446, "learn_time_ms": 3941.379, "learn_throughput": 1014.873, "synch_weights_time_ms": 137.506}, "counters": {"num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "episodes_total": 7752, "training_iteration": 266, "trial_id": "185f8_00000", "date": "2025-03-21_12-55-35", "timestamp": 1742561735, "time_this_iter_s": 14.550299644470215, "time_total_s": 4252.23074054718, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f893c70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4252.23074054718, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 99.56666666666668, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.775992393493652, "policy_loss": -0.0157591812312603, "vf_loss": 9.790040969848633, "vf_explained_var": -2.9578805538221786e-07, "kl": 0.008556756190955639, "entropy": 0.33783242106437683, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 57073.693183898926, "episode_reward_min": 41684.04679334164, "episode_reward_mean": 52469.938382072105, "episode_len_mean": 135.1904761904762, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {"agent_0": 41684.04679334164}, "policy_reward_max": {"agent_0": 57073.693183898926}, "policy_reward_mean": {"agent_0": 52469.938382072105}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47638.3668422699, 52209.246854782104, 56575.780265808105, 48430.466868400574, 54030.84672546387, 54333.300148010254, 52570.07359313965, 53245.42016410828, 55625.31350708008, 55217.560150146484, 53484.74014186859, 55421.47343444824, 53825.373646736145, 52654.33339691162, 53337.77997589111, 41684.04679334164, 53483.593477249146, 55690.04669189453, 54278.94705200195, 50742.80675315857, 53059.05362224579, 50577.233457803726, 52950.27347755432, 55741.6203918457, 53272.86671447754, 50064.25341510773, 52568.120022296906, 54759.98009109497, 52442.853563308716, 42457.180146217346, 55385.40660858154, 49285.646728515625, 51907.620195388794, 55949.593200683594, 52226.94017791748, 53526.20683288574, 52104.700328826904, 54837.02674484253, 53857.02668762207, 55575.053787231445, 53742.300117492676, 52688.186809539795, 55977.846824645996, 55022.15347290039, 53327.64685058594, 50971.02660083771, 54789.826820373535, 49634.61350059509, 51102.10665130615, 55631.17343902588, 51463.43358182907, 50583.126874923706, 50497.26702404022, 54055.7066078186, 53649.51343727112, 47317.56022644043, 51344.54012167454, 57036.90000915527, 50795.706535339355, 50618.893421173096, 46320.76687049866, 54065.65355682373, 53274.206892967224, 51095.46001625061, 53003.64696311951, 54141.32024383545, 50010.04684770107, 52304.44014167786, 53365.97314453125, 51488.293268203735, 56227.11331176758, 56651.18018245697, 46587.12677836418, 54318.87329864502, 51825.57334899902, 49494.940114974976, 52075.93347251415, 48517.98683929443, 48546.65350532532, 52883.36015701294, 52555.893630981445, 50445.71335887909, 53923.273361206055, 57073.693183898926], "episode_lengths": [136, 135, 134, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 134, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 136, 136, 135, 135, 136, 135, 136, 136, 134, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [47638.3668422699, 52209.246854782104, 56575.780265808105, 48430.466868400574, 54030.84672546387, 54333.300148010254, 52570.07359313965, 53245.42016410828, 55625.31350708008, 55217.560150146484, 53484.74014186859, 55421.47343444824, 53825.373646736145, 52654.33339691162, 53337.77997589111, 41684.04679334164, 53483.593477249146, 55690.04669189453, 54278.94705200195, 50742.80675315857, 53059.05362224579, 50577.233457803726, 52950.27347755432, 55741.6203918457, 53272.86671447754, 50064.25341510773, 52568.120022296906, 54759.98009109497, 52442.853563308716, 42457.180146217346, 55385.40660858154, 49285.646728515625, 51907.620195388794, 55949.593200683594, 52226.94017791748, 53526.20683288574, 52104.700328826904, 54837.02674484253, 53857.02668762207, 55575.053787231445, 53742.300117492676, 52688.186809539795, 55977.846824645996, 55022.15347290039, 53327.64685058594, 50971.02660083771, 54789.826820373535, 49634.61350059509, 51102.10665130615, 55631.17343902588, 51463.43358182907, 50583.126874923706, 50497.26702404022, 54055.7066078186, 53649.51343727112, 47317.56022644043, 51344.54012167454, 57036.90000915527, 50795.706535339355, 50618.893421173096, 46320.76687049866, 54065.65355682373, 53274.206892967224, 51095.46001625061, 53003.64696311951, 54141.32024383545, 50010.04684770107, 52304.44014167786, 53365.97314453125, 51488.293268203735, 56227.11331176758, 56651.18018245697, 46587.12677836418, 54318.87329864502, 51825.57334899902, 49494.940114974976, 52075.93347251415, 48517.98683929443, 48546.65350532532, 52883.36015701294, 52555.893630981445, 50445.71335887909, 53923.273361206055, 57073.693183898926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.71970642611139, "mean_inference_ms": 6.647788995856618, "mean_action_processing_ms": 0.19982151360388278, "mean_env_wait_ms": 223.87028396908713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06744010107857841, "StateBufferConnector_ms": 0.005943150747390021, "ViewRequirementAgentConnector_ms": 0.19643704096476236}}, "episode_reward_max": 57073.693183898926, "episode_reward_min": 41684.04679334164, "episode_reward_mean": 52469.938382072105, "episode_len_mean": 135.1904761904762, "episodes_this_iter": 84, "policy_reward_min": {"agent_0": 41684.04679334164}, "policy_reward_max": {"agent_0": 57073.693183898926}, "policy_reward_mean": {"agent_0": 52469.938382072105}, "hist_stats": {"episode_reward": [47638.3668422699, 52209.246854782104, 56575.780265808105, 48430.466868400574, 54030.84672546387, 54333.300148010254, 52570.07359313965, 53245.42016410828, 55625.31350708008, 55217.560150146484, 53484.74014186859, 55421.47343444824, 53825.373646736145, 52654.33339691162, 53337.77997589111, 41684.04679334164, 53483.593477249146, 55690.04669189453, 54278.94705200195, 50742.80675315857, 53059.05362224579, 50577.233457803726, 52950.27347755432, 55741.6203918457, 53272.86671447754, 50064.25341510773, 52568.120022296906, 54759.98009109497, 52442.853563308716, 42457.180146217346, 55385.40660858154, 49285.646728515625, 51907.620195388794, 55949.593200683594, 52226.94017791748, 53526.20683288574, 52104.700328826904, 54837.02674484253, 53857.02668762207, 55575.053787231445, 53742.300117492676, 52688.186809539795, 55977.846824645996, 55022.15347290039, 53327.64685058594, 50971.02660083771, 54789.826820373535, 49634.61350059509, 51102.10665130615, 55631.17343902588, 51463.43358182907, 50583.126874923706, 50497.26702404022, 54055.7066078186, 53649.51343727112, 47317.56022644043, 51344.54012167454, 57036.90000915527, 50795.706535339355, 50618.893421173096, 46320.76687049866, 54065.65355682373, 53274.206892967224, 51095.46001625061, 53003.64696311951, 54141.32024383545, 50010.04684770107, 52304.44014167786, 53365.97314453125, 51488.293268203735, 56227.11331176758, 56651.18018245697, 46587.12677836418, 54318.87329864502, 51825.57334899902, 49494.940114974976, 52075.93347251415, 48517.98683929443, 48546.65350532532, 52883.36015701294, 52555.893630981445, 50445.71335887909, 53923.273361206055, 57073.693183898926], "episode_lengths": [136, 135, 134, 136, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 134, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 136, 136, 135, 135, 136, 135, 136, 136, 134, 135, 135, 136, 134, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [47638.3668422699, 52209.246854782104, 56575.780265808105, 48430.466868400574, 54030.84672546387, 54333.300148010254, 52570.07359313965, 53245.42016410828, 55625.31350708008, 55217.560150146484, 53484.74014186859, 55421.47343444824, 53825.373646736145, 52654.33339691162, 53337.77997589111, 41684.04679334164, 53483.593477249146, 55690.04669189453, 54278.94705200195, 50742.80675315857, 53059.05362224579, 50577.233457803726, 52950.27347755432, 55741.6203918457, 53272.86671447754, 50064.25341510773, 52568.120022296906, 54759.98009109497, 52442.853563308716, 42457.180146217346, 55385.40660858154, 49285.646728515625, 51907.620195388794, 55949.593200683594, 52226.94017791748, 53526.20683288574, 52104.700328826904, 54837.02674484253, 53857.02668762207, 55575.053787231445, 53742.300117492676, 52688.186809539795, 55977.846824645996, 55022.15347290039, 53327.64685058594, 50971.02660083771, 54789.826820373535, 49634.61350059509, 51102.10665130615, 55631.17343902588, 51463.43358182907, 50583.126874923706, 50497.26702404022, 54055.7066078186, 53649.51343727112, 47317.56022644043, 51344.54012167454, 57036.90000915527, 50795.706535339355, 50618.893421173096, 46320.76687049866, 54065.65355682373, 53274.206892967224, 51095.46001625061, 53003.64696311951, 54141.32024383545, 50010.04684770107, 52304.44014167786, 53365.97314453125, 51488.293268203735, 56227.11331176758, 56651.18018245697, 46587.12677836418, 54318.87329864502, 51825.57334899902, 49494.940114974976, 52075.93347251415, 48517.98683929443, 48546.65350532532, 52883.36015701294, 52555.893630981445, 50445.71335887909, 53923.273361206055, 57073.693183898926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 38.71970642611139, "mean_inference_ms": 6.647788995856618, "mean_action_processing_ms": 0.19982151360388278, "mean_env_wait_ms": 223.87028396908713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06744010107857841, "StateBufferConnector_ms": 0.005943150747390021, "ViewRequirementAgentConnector_ms": 0.19643704096476236}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.3815068360441, "num_env_steps_trained_throughput_per_sec": 230.3815068360441, "timesteps_total": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 15568.556, "sample_time_ms": 11521.341, "learn_time_ms": 3912.719, "learn_throughput": 1022.307, "synch_weights_time_ms": 133.561}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 7836, "training_iteration": 267, "trial_id": "185f8_00000", "date": "2025-03-21_12-55-53", "timestamp": 1742561753, "time_this_iter_s": 17.40750551223755, "time_total_s": 4269.638246059418, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f893d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4269.638246059418, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 94.81666666666668, "ram_util_percent": 13.783333333333333}}
{"custom_metrics": {"num_batches_mean": 5.6, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.888566017150879, "policy_loss": -0.013886988162994385, "vf_loss": 9.900634765625, "vf_explained_var": 6.487655355158495e-06, "kl": 0.009090179577469826, "entropy": 0.33719781041145325, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "sampler_results": {"episode_reward_max": 57287.920349121094, "episode_reward_min": 44706.506834983826, "episode_reward_mean": 52895.61097464561, "episode_len_mean": 135.225, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 44706.506834983826}, "policy_reward_max": {"agent_0": 57287.920349121094}, "policy_reward_mean": {"agent_0": 52895.61097464561}, "custom_metrics": {"num_batches_mean": 5.6, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53634.86022949219, 56446.74681854248, 54237.08017539978, 52363.840187072754, 57066.986892700195, 54020.32684326172, 52623.180042266846, 53914.14694213867, 49348.35348510742, 51432.8533782959, 44706.506834983826, 53984.86669921875, 54605.85340499878, 57287.920349121094, 50997.76013755798, 56314.18687057495, 48425.786796569824, 55141.52031707764, 53882.44013977051, 52959.02014160156, 49822.906883239746, 47030.76701807976, 55129.007064819336, 52728.85337352753, 49818.973471045494, 54828.64673995972, 54045.240116119385, 54556.319915771484, 56775.67329406738, 54607.926765441895, 57169.34700012207, 51972.420082092285, 52628.306690216064, 50541.066719055176, 55023.91342544556, 48659.4134683609, 53744.85331726074, 46703.27333819866, 53788.98685455322, 52854.30676269531], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 136, 135, 136, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [53634.86022949219, 56446.74681854248, 54237.08017539978, 52363.840187072754, 57066.986892700195, 54020.32684326172, 52623.180042266846, 53914.14694213867, 49348.35348510742, 51432.8533782959, 44706.506834983826, 53984.86669921875, 54605.85340499878, 57287.920349121094, 50997.76013755798, 56314.18687057495, 48425.786796569824, 55141.52031707764, 53882.44013977051, 52959.02014160156, 49822.906883239746, 47030.76701807976, 55129.007064819336, 52728.85337352753, 49818.973471045494, 54828.64673995972, 54045.240116119385, 54556.319915771484, 56775.67329406738, 54607.926765441895, 57169.34700012207, 51972.420082092285, 52628.306690216064, 50541.066719055176, 55023.91342544556, 48659.4134683609, 53744.85331726074, 46703.27333819866, 53788.98685455322, 52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.61994210713162, "mean_inference_ms": 6.603959672975115, "mean_action_processing_ms": 0.19908593485815856, "mean_env_wait_ms": 218.08629406559493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048065185546875, "StateBufferConnector_ms": 0.0062018632888793945, "ViewRequirementAgentConnector_ms": 0.2464359998703003}}, "episode_reward_max": 57287.920349121094, "episode_reward_min": 44706.506834983826, "episode_reward_mean": 52895.61097464561, "episode_len_mean": 135.225, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 44706.506834983826}, "policy_reward_max": {"agent_0": 57287.920349121094}, "policy_reward_mean": {"agent_0": 52895.61097464561}, "hist_stats": {"episode_reward": [53634.86022949219, 56446.74681854248, 54237.08017539978, 52363.840187072754, 57066.986892700195, 54020.32684326172, 52623.180042266846, 53914.14694213867, 49348.35348510742, 51432.8533782959, 44706.506834983826, 53984.86669921875, 54605.85340499878, 57287.920349121094, 50997.76013755798, 56314.18687057495, 48425.786796569824, 55141.52031707764, 53882.44013977051, 52959.02014160156, 49822.906883239746, 47030.76701807976, 55129.007064819336, 52728.85337352753, 49818.973471045494, 54828.64673995972, 54045.240116119385, 54556.319915771484, 56775.67329406738, 54607.926765441895, 57169.34700012207, 51972.420082092285, 52628.306690216064, 50541.066719055176, 55023.91342544556, 48659.4134683609, 53744.85331726074, 46703.27333819866, 53788.98685455322, 52854.30676269531], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 136, 135, 136, 136, 135, 135, 135, 134, 136, 135, 136, 135, 135, 135, 136, 135, 135], "policy_agent_0_reward": [53634.86022949219, 56446.74681854248, 54237.08017539978, 52363.840187072754, 57066.986892700195, 54020.32684326172, 52623.180042266846, 53914.14694213867, 49348.35348510742, 51432.8533782959, 44706.506834983826, 53984.86669921875, 54605.85340499878, 57287.920349121094, 50997.76013755798, 56314.18687057495, 48425.786796569824, 55141.52031707764, 53882.44013977051, 52959.02014160156, 49822.906883239746, 47030.76701807976, 55129.007064819336, 52728.85337352753, 49818.973471045494, 54828.64673995972, 54045.240116119385, 54556.319915771484, 56775.67329406738, 54607.926765441895, 57169.34700012207, 51972.420082092285, 52628.306690216064, 50541.066719055176, 55023.91342544556, 48659.4134683609, 53744.85331726074, 46703.27333819866, 53788.98685455322, 52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.61994210713162, "mean_inference_ms": 6.603959672975115, "mean_action_processing_ms": 0.19908593485815856, "mean_env_wait_ms": 218.08629406559493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048065185546875, "StateBufferConnector_ms": 0.0062018632888793945, "ViewRequirementAgentConnector_ms": 0.2464359998703003}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.27260193312475, "num_env_steps_trained_throughput_per_sec": 212.27260193312475, "timesteps_total": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 16085.712, "sample_time_ms": 12001.299, "learn_time_ms": 3940.713, "learn_throughput": 1015.045, "synch_weights_time_ms": 142.723}, "counters": {"num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "episodes_total": 7876, "training_iteration": 268, "trial_id": "185f8_00000", "date": "2025-03-21_12-56-12", "timestamp": 1742561772, "time_this_iter_s": 18.89951753616333, "time_total_s": 4288.537763595581, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f893c70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4288.537763595581, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 99.016, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988046646118164, "policy_loss": -0.013812475837767124, "vf_loss": 10.0, "vf_explained_var": -1.0766088820446384e-07, "kl": 0.009294611401855946, "entropy": 0.3502863049507141, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "sampler_results": {"episode_reward_max": 52854.30676269531, "episode_reward_min": 52854.30676269531, "episode_reward_mean": 52854.30676269531, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52854.30676269531}, "policy_reward_max": {"agent_0": 52854.30676269531}, "policy_reward_mean": {"agent_0": 52854.30676269531}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52854.30676269531], "episode_lengths": [135], "policy_agent_0_reward": [52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.52575426901139, "mean_inference_ms": 6.548763502863052, "mean_action_processing_ms": 0.19546662564459444, "mean_env_wait_ms": 220.4711281003771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05283355712890625, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.16951560974121094}}, "episode_reward_max": 52854.30676269531, "episode_reward_min": 52854.30676269531, "episode_reward_mean": 52854.30676269531, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52854.30676269531}, "policy_reward_max": {"agent_0": 52854.30676269531}, "policy_reward_mean": {"agent_0": 52854.30676269531}, "hist_stats": {"episode_reward": [52854.30676269531], "episode_lengths": [135], "policy_agent_0_reward": [52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.52575426901139, "mean_inference_ms": 6.548763502863052, "mean_action_processing_ms": 0.19546662564459444, "mean_env_wait_ms": 220.4711281003771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05283355712890625, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.16951560974121094}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.87044442065337, "num_env_steps_trained_throughput_per_sec": 280.87044442065337, "timesteps_total": 1076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1076000, "timers": {"training_iteration_time_ms": 15493.124, "sample_time_ms": 11331.592, "learn_time_ms": 4013.68, "learn_throughput": 996.592, "synch_weights_time_ms": 146.885}, "counters": {"num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "done": false, "episodes_total": 7876, "training_iteration": 269, "trial_id": "185f8_00000", "date": "2025-03-21_12-56-26", "timestamp": 1742561786, "time_this_iter_s": 14.304407358169556, "time_total_s": 4302.842170953751, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f893e20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4302.842170953751, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 99.52380952380952, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989442825317383, "policy_loss": -0.012069286778569221, "vf_loss": 10.0, "vf_explained_var": -2.4955720618891064e-06, "kl": 0.007566618267446756, "entropy": 0.36196714639663696, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 52854.30676269531, "episode_reward_min": 52854.30676269531, "episode_reward_mean": 52854.30676269531, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52854.30676269531}, "policy_reward_max": {"agent_0": 52854.30676269531}, "policy_reward_mean": {"agent_0": 52854.30676269531}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52854.30676269531], "episode_lengths": [135], "policy_agent_0_reward": [52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.52575426901139, "mean_inference_ms": 6.548763502863052, "mean_action_processing_ms": 0.19546662564459444, "mean_env_wait_ms": 220.4711281003771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05283355712890625, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.16951560974121094}}, "episode_reward_max": 52854.30676269531, "episode_reward_min": 52854.30676269531, "episode_reward_mean": 52854.30676269531, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52854.30676269531}, "policy_reward_max": {"agent_0": 52854.30676269531}, "policy_reward_mean": {"agent_0": 52854.30676269531}, "hist_stats": {"episode_reward": [52854.30676269531], "episode_lengths": [135], "policy_agent_0_reward": [52854.30676269531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 47.52575426901139, "mean_inference_ms": 6.548763502863052, "mean_action_processing_ms": 0.19546662564459444, "mean_env_wait_ms": 220.4711281003771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05283355712890625, "StateBufferConnector_ms": 0.005888938903808594, "ViewRequirementAgentConnector_ms": 0.16951560974121094}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2958863915345, "num_env_steps_trained_throughput_per_sec": 293.2958863915345, "timesteps_total": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 15528.439, "sample_time_ms": 11317.505, "learn_time_ms": 4061.893, "learn_throughput": 984.762, "synch_weights_time_ms": 148.082}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 7876, "training_iteration": 270, "trial_id": "185f8_00000", "date": "2025-03-21_12-56-40", "timestamp": 1742561800, "time_this_iter_s": 13.702157258987427, "time_total_s": 4316.544328212738, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f893c70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4316.544328212738, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 99.55789473684212, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.93813419342041, "policy_loss": -0.013677640818059444, "vf_loss": 9.949951171875, "vf_explained_var": -7.688378218517755e-07, "kl": 0.009301785379648209, "entropy": 0.3573906719684601, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "sampler_results": {"episode_reward_max": 57628.60029792786, "episode_reward_min": 46189.00668096542, "episode_reward_mean": 52481.45282769203, "episode_len_mean": 135.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 46189.00668096542}, "policy_reward_max": {"agent_0": 57628.60029792786}, "policy_reward_mean": {"agent_0": 52481.45282769203}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55020.96008300781, 50247.45352745056, 53529.08667755127, 46189.00668096542, 53382.40683221817, 47841.81356525421, 54986.20697402954, 54731.44009780884, 50362.767011642456, 54645.487018585205, 48894.45344161987, 57628.60029792786, 53924.80679321289, 49076.94003486633, 53161.700412750244, 55740.780181884766, 54682.77335357666, 54310.13338088989, 49711.27339553833, 51560.9667930603], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 134, 135, 135, 136, 136], "policy_agent_0_reward": [55020.96008300781, 50247.45352745056, 53529.08667755127, 46189.00668096542, 53382.40683221817, 47841.81356525421, 54986.20697402954, 54731.44009780884, 50362.767011642456, 54645.487018585205, 48894.45344161987, 57628.60029792786, 53924.80679321289, 49076.94003486633, 53161.700412750244, 55740.780181884766, 54682.77335357666, 54310.13338088989, 49711.27339553833, 51560.9667930603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.536995686568616, "mean_inference_ms": 6.560457009831748, "mean_action_processing_ms": 0.19873015568350977, "mean_env_wait_ms": 223.3661767700084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042067766189575195, "StateBufferConnector_ms": 0.005882978439331055, "ViewRequirementAgentConnector_ms": 0.1803898811340332}}, "episode_reward_max": 57628.60029792786, "episode_reward_min": 46189.00668096542, "episode_reward_mean": 52481.45282769203, "episode_len_mean": 135.15, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 46189.00668096542}, "policy_reward_max": {"agent_0": 57628.60029792786}, "policy_reward_mean": {"agent_0": 52481.45282769203}, "hist_stats": {"episode_reward": [55020.96008300781, 50247.45352745056, 53529.08667755127, 46189.00668096542, 53382.40683221817, 47841.81356525421, 54986.20697402954, 54731.44009780884, 50362.767011642456, 54645.487018585205, 48894.45344161987, 57628.60029792786, 53924.80679321289, 49076.94003486633, 53161.700412750244, 55740.780181884766, 54682.77335357666, 54310.13338088989, 49711.27339553833, 51560.9667930603], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 134, 135, 135, 135, 134, 135, 135, 136, 136], "policy_agent_0_reward": [55020.96008300781, 50247.45352745056, 53529.08667755127, 46189.00668096542, 53382.40683221817, 47841.81356525421, 54986.20697402954, 54731.44009780884, 50362.767011642456, 54645.487018585205, 48894.45344161987, 57628.60029792786, 53924.80679321289, 49076.94003486633, 53161.700412750244, 55740.780181884766, 54682.77335357666, 54310.13338088989, 49711.27339553833, 51560.9667930603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.536995686568616, "mean_inference_ms": 6.560457009831748, "mean_action_processing_ms": 0.19873015568350977, "mean_env_wait_ms": 223.3661767700084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042067766189575195, "StateBufferConnector_ms": 0.005882978439331055, "ViewRequirementAgentConnector_ms": 0.1803898811340332}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.79492474137453, "num_env_steps_trained_throughput_per_sec": 295.79492474137453, "timesteps_total": 1084000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1084000, "timers": {"training_iteration_time_ms": 15494.042, "sample_time_ms": 11325.193, "learn_time_ms": 4018.289, "learn_throughput": 995.449, "synch_weights_time_ms": 149.6}, "counters": {"num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "done": false, "episodes_total": 7896, "training_iteration": 271, "trial_id": "185f8_00000", "date": "2025-03-21_12-56-53", "timestamp": 1742561813, "time_this_iter_s": 13.56390929222107, "time_total_s": 4330.108237504959, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2ea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4330.108237504959, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 98.13157894736844, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.490384615384615, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.726302146911621, "policy_loss": -0.015997078269720078, "vf_loss": 9.740479469299316, "vf_explained_var": 3.70542210248459e-07, "kl": 0.00909471046179533, "entropy": 0.35057538747787476, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "sampler_results": {"episode_reward_max": 58199.39384460449, "episode_reward_min": 39996.41352844238, "episode_reward_mean": 53060.268114991486, "episode_len_mean": 135.21153846153845, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {"agent_0": 39996.41352844238}, "policy_reward_max": {"agent_0": 58199.39384460449}, "policy_reward_mean": {"agent_0": 53060.268114991486}, "custom_metrics": {"num_batches_mean": 5.490384615384615, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54466.55347061157, 48554.200187683105, 57288.600105285645, 54313.36015701294, 57055.12693786621, 56268.44679260254, 56778.940017700195, 53931.2933921814, 53455.63330459595, 54028.46007347107, 39996.41352844238, 54719.5866394043, 52441.2799115181, 53178.36012458801, 51377.34014034271, 50197.39346694946, 54742.38705062866, 57274.32684326172, 48444.013374090195, 50394.26012802124, 51609.886719584465, 51915.66020202637, 51237.48027229309, 54411.76020812988, 53261.480407714844, 50001.107047080994, 51392.333599090576, 54752.42681121826, 53785.58681678772, 51245.580097198486, 55942.45997238159, 53057.75379180908, 53506.6203250885, 49919.960233688354, 50899.05347061157, 52818.88027191162, 50829.613607406616, 53577.47356796265, 51010.41345977783, 54482.37364196777, 53603.820264816284, 51758.35339641571, 58199.39384460449, 54931.85367393494, 52773.733432769775, 53903.06018066406, 51226.45358657837, 52685.90012359619, 54127.42680931091, 52037.286935806274, 52439.23356342316, 48271.333459854126, 57785.94044494629, 50388.56702232361, 51048.733428001404, 50661.13349533081, 52912.580059051514, 54424.0666885376, 55646.65997314453, 56051.780349731445, 57188.380111694336, 48326.91336154938, 56347.84009552002, 51019.846799850464, 54103.7801322937, 54427.91357421875, 55722.64012145996, 50978.553431510925, 52531.753452301025, 51348.66668355465, 56134.71366882324, 55449.24687576294, 53893.986907958984, 52134.2335357666, 56455.21348571777, 55567.180267333984, 52715.13343048096, 56093.13343811035, 55163.887021541595, 53861.66680145264, 50990.773418426514, 53987.23348236084, 52366.20662307739, 51123.60675525665, 56956.19345855713, 47622.82683569193, 54462.793504714966, 51597.60670566559, 53288.086893081665, 55267.74024963379, 49960.340052604675, 53967.96007156372, 55267.560218811035, 55338.439949035645, 52254.72686767578, 52493.15363121033, 52631.83343887329, 51733.506772994995, 55285.32042694092, 55484.6134185791, 47868.900027513504, 50007.353509902954, 50233.38005447388, 55171.85349273682], "episode_lengths": [135, 136, 135, 136, 135, 135, 135, 136, 135, 134, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 134, 135, 136, 136, 135, 135], "policy_agent_0_reward": [54466.55347061157, 48554.200187683105, 57288.600105285645, 54313.36015701294, 57055.12693786621, 56268.44679260254, 56778.940017700195, 53931.2933921814, 53455.63330459595, 54028.46007347107, 39996.41352844238, 54719.5866394043, 52441.2799115181, 53178.36012458801, 51377.34014034271, 50197.39346694946, 54742.38705062866, 57274.32684326172, 48444.013374090195, 50394.26012802124, 51609.886719584465, 51915.66020202637, 51237.48027229309, 54411.76020812988, 53261.480407714844, 50001.107047080994, 51392.333599090576, 54752.42681121826, 53785.58681678772, 51245.580097198486, 55942.45997238159, 53057.75379180908, 53506.6203250885, 49919.960233688354, 50899.05347061157, 52818.88027191162, 50829.613607406616, 53577.47356796265, 51010.41345977783, 54482.37364196777, 53603.820264816284, 51758.35339641571, 58199.39384460449, 54931.85367393494, 52773.733432769775, 53903.06018066406, 51226.45358657837, 52685.90012359619, 54127.42680931091, 52037.286935806274, 52439.23356342316, 48271.333459854126, 57785.94044494629, 50388.56702232361, 51048.733428001404, 50661.13349533081, 52912.580059051514, 54424.0666885376, 55646.65997314453, 56051.780349731445, 57188.380111694336, 48326.91336154938, 56347.84009552002, 51019.846799850464, 54103.7801322937, 54427.91357421875, 55722.64012145996, 50978.553431510925, 52531.753452301025, 51348.66668355465, 56134.71366882324, 55449.24687576294, 53893.986907958984, 52134.2335357666, 56455.21348571777, 55567.180267333984, 52715.13343048096, 56093.13343811035, 55163.887021541595, 53861.66680145264, 50990.773418426514, 53987.23348236084, 52366.20662307739, 51123.60675525665, 56956.19345855713, 47622.82683569193, 54462.793504714966, 51597.60670566559, 53288.086893081665, 55267.74024963379, 49960.340052604675, 53967.96007156372, 55267.560218811035, 55338.439949035645, 52254.72686767578, 52493.15363121033, 52631.83343887329, 51733.506772994995, 55285.32042694092, 55484.6134185791, 47868.900027513504, 50007.353509902954, 50233.38005447388, 55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.24489647775936, "mean_inference_ms": 6.652321667856943, "mean_action_processing_ms": 0.19972097121427984, "mean_env_wait_ms": 221.83570381018328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07144373196821946, "StateBufferConnector_ms": 0.006208740747891939, "ViewRequirementAgentConnector_ms": 0.2014089089173537}}, "episode_reward_max": 58199.39384460449, "episode_reward_min": 39996.41352844238, "episode_reward_mean": 53060.268114991486, "episode_len_mean": 135.21153846153845, "episodes_this_iter": 104, "policy_reward_min": {"agent_0": 39996.41352844238}, "policy_reward_max": {"agent_0": 58199.39384460449}, "policy_reward_mean": {"agent_0": 53060.268114991486}, "hist_stats": {"episode_reward": [54466.55347061157, 48554.200187683105, 57288.600105285645, 54313.36015701294, 57055.12693786621, 56268.44679260254, 56778.940017700195, 53931.2933921814, 53455.63330459595, 54028.46007347107, 39996.41352844238, 54719.5866394043, 52441.2799115181, 53178.36012458801, 51377.34014034271, 50197.39346694946, 54742.38705062866, 57274.32684326172, 48444.013374090195, 50394.26012802124, 51609.886719584465, 51915.66020202637, 51237.48027229309, 54411.76020812988, 53261.480407714844, 50001.107047080994, 51392.333599090576, 54752.42681121826, 53785.58681678772, 51245.580097198486, 55942.45997238159, 53057.75379180908, 53506.6203250885, 49919.960233688354, 50899.05347061157, 52818.88027191162, 50829.613607406616, 53577.47356796265, 51010.41345977783, 54482.37364196777, 53603.820264816284, 51758.35339641571, 58199.39384460449, 54931.85367393494, 52773.733432769775, 53903.06018066406, 51226.45358657837, 52685.90012359619, 54127.42680931091, 52037.286935806274, 52439.23356342316, 48271.333459854126, 57785.94044494629, 50388.56702232361, 51048.733428001404, 50661.13349533081, 52912.580059051514, 54424.0666885376, 55646.65997314453, 56051.780349731445, 57188.380111694336, 48326.91336154938, 56347.84009552002, 51019.846799850464, 54103.7801322937, 54427.91357421875, 55722.64012145996, 50978.553431510925, 52531.753452301025, 51348.66668355465, 56134.71366882324, 55449.24687576294, 53893.986907958984, 52134.2335357666, 56455.21348571777, 55567.180267333984, 52715.13343048096, 56093.13343811035, 55163.887021541595, 53861.66680145264, 50990.773418426514, 53987.23348236084, 52366.20662307739, 51123.60675525665, 56956.19345855713, 47622.82683569193, 54462.793504714966, 51597.60670566559, 53288.086893081665, 55267.74024963379, 49960.340052604675, 53967.96007156372, 55267.560218811035, 55338.439949035645, 52254.72686767578, 52493.15363121033, 52631.83343887329, 51733.506772994995, 55285.32042694092, 55484.6134185791, 47868.900027513504, 50007.353509902954, 50233.38005447388, 55171.85349273682], "episode_lengths": [135, 136, 135, 136, 135, 135, 135, 136, 135, 134, 136, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 135, 136, 135, 136, 135, 136, 134, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 136, 135, 135, 135, 134, 136, 135, 135, 135, 135, 135, 135, 136, 134, 135, 136, 136, 135, 135], "policy_agent_0_reward": [54466.55347061157, 48554.200187683105, 57288.600105285645, 54313.36015701294, 57055.12693786621, 56268.44679260254, 56778.940017700195, 53931.2933921814, 53455.63330459595, 54028.46007347107, 39996.41352844238, 54719.5866394043, 52441.2799115181, 53178.36012458801, 51377.34014034271, 50197.39346694946, 54742.38705062866, 57274.32684326172, 48444.013374090195, 50394.26012802124, 51609.886719584465, 51915.66020202637, 51237.48027229309, 54411.76020812988, 53261.480407714844, 50001.107047080994, 51392.333599090576, 54752.42681121826, 53785.58681678772, 51245.580097198486, 55942.45997238159, 53057.75379180908, 53506.6203250885, 49919.960233688354, 50899.05347061157, 52818.88027191162, 50829.613607406616, 53577.47356796265, 51010.41345977783, 54482.37364196777, 53603.820264816284, 51758.35339641571, 58199.39384460449, 54931.85367393494, 52773.733432769775, 53903.06018066406, 51226.45358657837, 52685.90012359619, 54127.42680931091, 52037.286935806274, 52439.23356342316, 48271.333459854126, 57785.94044494629, 50388.56702232361, 51048.733428001404, 50661.13349533081, 52912.580059051514, 54424.0666885376, 55646.65997314453, 56051.780349731445, 57188.380111694336, 48326.91336154938, 56347.84009552002, 51019.846799850464, 54103.7801322937, 54427.91357421875, 55722.64012145996, 50978.553431510925, 52531.753452301025, 51348.66668355465, 56134.71366882324, 55449.24687576294, 53893.986907958984, 52134.2335357666, 56455.21348571777, 55567.180267333984, 52715.13343048096, 56093.13343811035, 55163.887021541595, 53861.66680145264, 50990.773418426514, 53987.23348236084, 52366.20662307739, 51123.60675525665, 56956.19345855713, 47622.82683569193, 54462.793504714966, 51597.60670566559, 53288.086893081665, 55267.74024963379, 49960.340052604675, 53967.96007156372, 55267.560218811035, 55338.439949035645, 52254.72686767578, 52493.15363121033, 52631.83343887329, 51733.506772994995, 55285.32042694092, 55484.6134185791, 47868.900027513504, 50007.353509902954, 50233.38005447388, 55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.24489647775936, "mean_inference_ms": 6.652321667856943, "mean_action_processing_ms": 0.19972097121427984, "mean_env_wait_ms": 221.83570381018328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07144373196821946, "StateBufferConnector_ms": 0.006208740747891939, "ViewRequirementAgentConnector_ms": 0.2014089089173537}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.19828275112656, "num_env_steps_trained_throughput_per_sec": 193.19828275112656, "timesteps_total": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 16124.929, "sample_time_ms": 11908.537, "learn_time_ms": 4066.691, "learn_throughput": 983.601, "synch_weights_time_ms": 148.726}, "counters": {"num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "episodes_total": 8000, "training_iteration": 272, "trial_id": "185f8_00000", "date": "2025-03-21_12-57-14", "timestamp": 1742561834, "time_this_iter_s": 20.758591413497925, "time_total_s": 4350.866828918457, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4350.866828918457, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 93.74137931034483, "ram_util_percent": 13.786206896551727}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985230445861816, "policy_loss": -0.016726655885577202, "vf_loss": 10.0, "vf_explained_var": -4.530573960437323e-07, "kl": 0.00978582538664341, "entropy": 0.33961501717567444, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 55171.85349273682, "episode_reward_min": 55171.85349273682, "episode_reward_mean": 55171.85349273682, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55171.85349273682}, "policy_reward_max": {"agent_0": 55171.85349273682}, "policy_reward_mean": {"agent_0": 55171.85349273682}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55171.85349273682], "episode_lengths": [135], "policy_agent_0_reward": [55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.15419763699816, "mean_inference_ms": 6.160059446305259, "mean_action_processing_ms": 0.19716422219580443, "mean_env_wait_ms": 225.76554480261805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024505615234375, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.1694202423095703}}, "episode_reward_max": 55171.85349273682, "episode_reward_min": 55171.85349273682, "episode_reward_mean": 55171.85349273682, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55171.85349273682}, "policy_reward_max": {"agent_0": 55171.85349273682}, "policy_reward_mean": {"agent_0": 55171.85349273682}, "hist_stats": {"episode_reward": [55171.85349273682], "episode_lengths": [135], "policy_agent_0_reward": [55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.15419763699816, "mean_inference_ms": 6.160059446305259, "mean_action_processing_ms": 0.19716422219580443, "mean_env_wait_ms": 225.76554480261805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024505615234375, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.1694202423095703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.49547608498193, "num_env_steps_trained_throughput_per_sec": 276.49547608498193, "timesteps_total": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 15669.027, "sample_time_ms": 11371.967, "learn_time_ms": 4145.821, "learn_throughput": 964.827, "synch_weights_time_ms": 150.23}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 8000, "training_iteration": 273, "trial_id": "185f8_00000", "date": "2025-03-21_12-57-29", "timestamp": 1742561849, "time_this_iter_s": 14.526793718338013, "time_total_s": 4365.393622636795, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f9aed40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4365.393622636795, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 99.57619047619049, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989941596984863, "policy_loss": -0.011657672002911568, "vf_loss": 10.0, "vf_explained_var": -9.443611048709499e-08, "kl": 0.007990500889718533, "entropy": 0.36396411061286926, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "sampler_results": {"episode_reward_max": 55171.85349273682, "episode_reward_min": 55171.85349273682, "episode_reward_mean": 55171.85349273682, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55171.85349273682}, "policy_reward_max": {"agent_0": 55171.85349273682}, "policy_reward_mean": {"agent_0": 55171.85349273682}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55171.85349273682], "episode_lengths": [135], "policy_agent_0_reward": [55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.15419763699816, "mean_inference_ms": 6.160059446305259, "mean_action_processing_ms": 0.19716422219580443, "mean_env_wait_ms": 225.76554480261805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024505615234375, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.1694202423095703}}, "episode_reward_max": 55171.85349273682, "episode_reward_min": 55171.85349273682, "episode_reward_mean": 55171.85349273682, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55171.85349273682}, "policy_reward_max": {"agent_0": 55171.85349273682}, "policy_reward_mean": {"agent_0": 55171.85349273682}, "hist_stats": {"episode_reward": [55171.85349273682], "episode_lengths": [135], "policy_agent_0_reward": [55171.85349273682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.15419763699816, "mean_inference_ms": 6.160059446305259, "mean_action_processing_ms": 0.19716422219580443, "mean_env_wait_ms": 225.76554480261805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024505615234375, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.1694202423095703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.14039072927744, "num_env_steps_trained_throughput_per_sec": 288.14039072927744, "timesteps_total": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 15520.182, "sample_time_ms": 11292.303, "learn_time_ms": 4083.439, "learn_throughput": 979.566, "synch_weights_time_ms": 143.426}, "counters": {"num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "episodes_total": 8000, "training_iteration": 274, "trial_id": "185f8_00000", "date": "2025-03-21_12-57-43", "timestamp": 1742561863, "time_this_iter_s": 13.941129207611084, "time_total_s": 4379.334751844406, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f8936d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4379.334751844406, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 99.55, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981851577758789, "policy_loss": -0.012299946509301662, "vf_loss": 9.99267578125, "vf_explained_var": -5.207335220802634e-07, "kl": 0.007377101108431816, "entropy": 0.3438018560409546, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "sampler_results": {"episode_reward_max": 54432.12682533264, "episode_reward_min": 50885.78014755249, "episode_reward_mean": 53170.41569709778, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 50885.78014755249}, "policy_reward_max": {"agent_0": 54432.12682533264}, "policy_reward_mean": {"agent_0": 53170.41569709778}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54432.12682533264, 54193.3401184082, 50885.78014755249], "episode_lengths": [136, 135, 135], "policy_agent_0_reward": [54432.12682533264, 54193.3401184082, 50885.78014755249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.491993177364737, "mean_inference_ms": 6.314700760285934, "mean_action_processing_ms": 0.19912137783350645, "mean_env_wait_ms": 216.17527338685125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03991127014160156, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.5766868591308594}}, "episode_reward_max": 54432.12682533264, "episode_reward_min": 50885.78014755249, "episode_reward_mean": 53170.41569709778, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 50885.78014755249}, "policy_reward_max": {"agent_0": 54432.12682533264}, "policy_reward_mean": {"agent_0": 53170.41569709778}, "hist_stats": {"episode_reward": [54432.12682533264, 54193.3401184082, 50885.78014755249], "episode_lengths": [136, 135, 135], "policy_agent_0_reward": [54432.12682533264, 54193.3401184082, 50885.78014755249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.491993177364737, "mean_inference_ms": 6.314700760285934, "mean_action_processing_ms": 0.19912137783350645, "mean_env_wait_ms": 216.17527338685125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03991127014160156, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.5766868591308594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.3247456360151, "num_env_steps_trained_throughput_per_sec": 287.3247456360151, "timesteps_total": 1100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1100000, "timers": {"training_iteration_time_ms": 15507.774, "sample_time_ms": 11311.226, "learn_time_ms": 4051.639, "learn_throughput": 987.255, "synch_weights_time_ms": 143.9}, "counters": {"num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "done": false, "episodes_total": 8003, "training_iteration": 275, "trial_id": "185f8_00000", "date": "2025-03-21_12-57-57", "timestamp": 1742561877, "time_this_iter_s": 13.9765465259552, "time_total_s": 4393.311298370361, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f9afa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4393.311298370361, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 99.44000000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.090909090909091, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.679250717163086, "policy_loss": -0.01696024090051651, "vf_loss": 9.693950653076172, "vf_explained_var": 2.158855386369396e-05, "kl": 0.011303978972136974, "entropy": 0.3410346210002899, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 59249.60707092285, "episode_reward_min": 43287.78002548218, "episode_reward_mean": 53186.07759498269, "episode_len_mean": 135.11570247933884, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 43287.78002548218}, "policy_reward_max": {"agent_0": 59249.60707092285}, "policy_reward_mean": {"agent_0": 53186.07759498269}, "custom_metrics": {"num_batches_mean": 5.090909090909091, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54810.56681060791, 54625.96689414978, 54493.0734872818, 53872.26681137085, 53036.46014404297, 54359.23369598389, 51594.786907196045, 55356.199922561646, 50666.36664199829, 53923.066734313965, 53762.27369976044, 54332.05346298218, 54359.68031311035, 53185.42031764984, 55925.04044723511, 51696.19342327118, 48143.80661821365, 53997.06021118164, 56010.360122680664, 57790.94046020508, 55342.63998031616, 51158.85336303711, 50004.6202583313, 51693.07332611084, 52075.20666694641, 51788.79349422455, 54506.319969177246, 52416.786949157715, 54289.23347091675, 43287.78002548218, 55023.29350090027, 53603.85342979431, 48611.746658325195, 54661.48697280884, 54099.33337402344, 54518.77345275879, 50404.540407180786, 52500.37345123291, 48076.93328285217, 53551.50022792816, 54982.39355754852, 51533.27334690094, 49960.753496170044, 55492.76675415039, 50718.92694282532, 52663.980140686035, 47283.62656211853, 55270.81323623657, 54603.49355888367, 51801.033349990845, 51891.92671775818, 52944.58679962158, 51536.966851234436, 55386.446685791016, 55480.34003448486, 56297.15350341797, 54069.70673370361, 51243.23341798782, 52743.81327819824, 52345.57325553894, 48836.380264759064, 55043.466691970825, 51910.76016807556, 53332.61348628998, 50314.15999221802, 51345.20001125336, 57408.04031944275, 56003.07990670204, 59249.60707092285, 54656.0334777832, 49120.920129776, 55364.90009307861, 51508.30024719238, 53618.57997131348, 45442.1201993227, 54520.40009689331, 54014.31339263916, 57834.1867351532, 55506.41355133057, 50638.80678939819, 47539.14012813568, 51942.41337966919, 57143.78045654297, 56297.23352813721, 56877.55323791504, 53996.260135650635, 51922.180337905884, 55241.36686706543, 50530.04669761658, 48816.059980392456, 55084.92014122009, 52487.92675971985, 55114.96682739258, 55349.18701171875, 49425.98014640808, 50954.25344085693, 56130.90009307861, 52752.95348358154, 51098.633348464966, 51014.193699359894, 55035.1999874115, 56289.266746520996, 57028.573543548584, 54303.93342971802, 52585.113805770874, 53491.2400970459, 52518.98678588867, 55773.88673019409, 52515.99344539642, 53198.933307647705, 51218.57350540161, 44717.03352165222, 54855.1735534668, 56336.76664352417, 53751.1734316349, 55406.9933013916, 51813.96655464172, 56877.080169677734, 53699.55360412598, 55815.77350521088, 57087.173416137695], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 134, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 134, 135, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 137, 134, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135, 135, 135, 136, 136, 134, 134, 136, 135, 136, 135, 135, 135, 134, 135, 134, 135, 135, 135], "policy_agent_0_reward": [54810.56681060791, 54625.96689414978, 54493.0734872818, 53872.26681137085, 53036.46014404297, 54359.23369598389, 51594.786907196045, 55356.199922561646, 50666.36664199829, 53923.066734313965, 53762.27369976044, 54332.05346298218, 54359.68031311035, 53185.42031764984, 55925.04044723511, 51696.19342327118, 48143.80661821365, 53997.06021118164, 56010.360122680664, 57790.94046020508, 55342.63998031616, 51158.85336303711, 50004.6202583313, 51693.07332611084, 52075.20666694641, 51788.79349422455, 54506.319969177246, 52416.786949157715, 54289.23347091675, 43287.78002548218, 55023.29350090027, 53603.85342979431, 48611.746658325195, 54661.48697280884, 54099.33337402344, 54518.77345275879, 50404.540407180786, 52500.37345123291, 48076.93328285217, 53551.50022792816, 54982.39355754852, 51533.27334690094, 49960.753496170044, 55492.76675415039, 50718.92694282532, 52663.980140686035, 47283.62656211853, 55270.81323623657, 54603.49355888367, 51801.033349990845, 51891.92671775818, 52944.58679962158, 51536.966851234436, 55386.446685791016, 55480.34003448486, 56297.15350341797, 54069.70673370361, 51243.23341798782, 52743.81327819824, 52345.57325553894, 48836.380264759064, 55043.466691970825, 51910.76016807556, 53332.61348628998, 50314.15999221802, 51345.20001125336, 57408.04031944275, 56003.07990670204, 59249.60707092285, 54656.0334777832, 49120.920129776, 55364.90009307861, 51508.30024719238, 53618.57997131348, 45442.1201993227, 54520.40009689331, 54014.31339263916, 57834.1867351532, 55506.41355133057, 50638.80678939819, 47539.14012813568, 51942.41337966919, 57143.78045654297, 56297.23352813721, 56877.55323791504, 53996.260135650635, 51922.180337905884, 55241.36686706543, 50530.04669761658, 48816.059980392456, 55084.92014122009, 52487.92675971985, 55114.96682739258, 55349.18701171875, 49425.98014640808, 50954.25344085693, 56130.90009307861, 52752.95348358154, 51098.633348464966, 51014.193699359894, 55035.1999874115, 56289.266746520996, 57028.573543548584, 54303.93342971802, 52585.113805770874, 53491.2400970459, 52518.98678588867, 55773.88673019409, 52515.99344539642, 53198.933307647705, 51218.57350540161, 44717.03352165222, 54855.1735534668, 56336.76664352417, 53751.1734316349, 55406.9933013916, 51813.96655464172, 56877.080169677734, 53699.55360412598, 55815.77350521088, 57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.80401940880679, "mean_inference_ms": 6.641851639334182, "mean_action_processing_ms": 0.19953965504867546, "mean_env_wait_ms": 222.13079780469133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05575014539986602, "StateBufferConnector_ms": 0.005920465327491445, "ViewRequirementAgentConnector_ms": 0.190425116168566}}, "episode_reward_max": 59249.60707092285, "episode_reward_min": 43287.78002548218, "episode_reward_mean": 53186.07759498269, "episode_len_mean": 135.11570247933884, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 43287.78002548218}, "policy_reward_max": {"agent_0": 59249.60707092285}, "policy_reward_mean": {"agent_0": 53186.07759498269}, "hist_stats": {"episode_reward": [54810.56681060791, 54625.96689414978, 54493.0734872818, 53872.26681137085, 53036.46014404297, 54359.23369598389, 51594.786907196045, 55356.199922561646, 50666.36664199829, 53923.066734313965, 53762.27369976044, 54332.05346298218, 54359.68031311035, 53185.42031764984, 55925.04044723511, 51696.19342327118, 48143.80661821365, 53997.06021118164, 56010.360122680664, 57790.94046020508, 55342.63998031616, 51158.85336303711, 50004.6202583313, 51693.07332611084, 52075.20666694641, 51788.79349422455, 54506.319969177246, 52416.786949157715, 54289.23347091675, 43287.78002548218, 55023.29350090027, 53603.85342979431, 48611.746658325195, 54661.48697280884, 54099.33337402344, 54518.77345275879, 50404.540407180786, 52500.37345123291, 48076.93328285217, 53551.50022792816, 54982.39355754852, 51533.27334690094, 49960.753496170044, 55492.76675415039, 50718.92694282532, 52663.980140686035, 47283.62656211853, 55270.81323623657, 54603.49355888367, 51801.033349990845, 51891.92671775818, 52944.58679962158, 51536.966851234436, 55386.446685791016, 55480.34003448486, 56297.15350341797, 54069.70673370361, 51243.23341798782, 52743.81327819824, 52345.57325553894, 48836.380264759064, 55043.466691970825, 51910.76016807556, 53332.61348628998, 50314.15999221802, 51345.20001125336, 57408.04031944275, 56003.07990670204, 59249.60707092285, 54656.0334777832, 49120.920129776, 55364.90009307861, 51508.30024719238, 53618.57997131348, 45442.1201993227, 54520.40009689331, 54014.31339263916, 57834.1867351532, 55506.41355133057, 50638.80678939819, 47539.14012813568, 51942.41337966919, 57143.78045654297, 56297.23352813721, 56877.55323791504, 53996.260135650635, 51922.180337905884, 55241.36686706543, 50530.04669761658, 48816.059980392456, 55084.92014122009, 52487.92675971985, 55114.96682739258, 55349.18701171875, 49425.98014640808, 50954.25344085693, 56130.90009307861, 52752.95348358154, 51098.633348464966, 51014.193699359894, 55035.1999874115, 56289.266746520996, 57028.573543548584, 54303.93342971802, 52585.113805770874, 53491.2400970459, 52518.98678588867, 55773.88673019409, 52515.99344539642, 53198.933307647705, 51218.57350540161, 44717.03352165222, 54855.1735534668, 56336.76664352417, 53751.1734316349, 55406.9933013916, 51813.96655464172, 56877.080169677734, 53699.55360412598, 55815.77350521088, 57087.173416137695], "episode_lengths": [135, 135, 135, 135, 134, 135, 136, 134, 135, 135, 135, 134, 135, 135, 134, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 134, 135, 134, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 137, 134, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135, 135, 135, 136, 136, 134, 134, 136, 135, 136, 135, 135, 135, 134, 135, 134, 135, 135, 135], "policy_agent_0_reward": [54810.56681060791, 54625.96689414978, 54493.0734872818, 53872.26681137085, 53036.46014404297, 54359.23369598389, 51594.786907196045, 55356.199922561646, 50666.36664199829, 53923.066734313965, 53762.27369976044, 54332.05346298218, 54359.68031311035, 53185.42031764984, 55925.04044723511, 51696.19342327118, 48143.80661821365, 53997.06021118164, 56010.360122680664, 57790.94046020508, 55342.63998031616, 51158.85336303711, 50004.6202583313, 51693.07332611084, 52075.20666694641, 51788.79349422455, 54506.319969177246, 52416.786949157715, 54289.23347091675, 43287.78002548218, 55023.29350090027, 53603.85342979431, 48611.746658325195, 54661.48697280884, 54099.33337402344, 54518.77345275879, 50404.540407180786, 52500.37345123291, 48076.93328285217, 53551.50022792816, 54982.39355754852, 51533.27334690094, 49960.753496170044, 55492.76675415039, 50718.92694282532, 52663.980140686035, 47283.62656211853, 55270.81323623657, 54603.49355888367, 51801.033349990845, 51891.92671775818, 52944.58679962158, 51536.966851234436, 55386.446685791016, 55480.34003448486, 56297.15350341797, 54069.70673370361, 51243.23341798782, 52743.81327819824, 52345.57325553894, 48836.380264759064, 55043.466691970825, 51910.76016807556, 53332.61348628998, 50314.15999221802, 51345.20001125336, 57408.04031944275, 56003.07990670204, 59249.60707092285, 54656.0334777832, 49120.920129776, 55364.90009307861, 51508.30024719238, 53618.57997131348, 45442.1201993227, 54520.40009689331, 54014.31339263916, 57834.1867351532, 55506.41355133057, 50638.80678939819, 47539.14012813568, 51942.41337966919, 57143.78045654297, 56297.23352813721, 56877.55323791504, 53996.260135650635, 51922.180337905884, 55241.36686706543, 50530.04669761658, 48816.059980392456, 55084.92014122009, 52487.92675971985, 55114.96682739258, 55349.18701171875, 49425.98014640808, 50954.25344085693, 56130.90009307861, 52752.95348358154, 51098.633348464966, 51014.193699359894, 55035.1999874115, 56289.266746520996, 57028.573543548584, 54303.93342971802, 52585.113805770874, 53491.2400970459, 52518.98678588867, 55773.88673019409, 52515.99344539642, 53198.933307647705, 51218.57350540161, 44717.03352165222, 54855.1735534668, 56336.76664352417, 53751.1734316349, 55406.9933013916, 51813.96655464172, 56877.080169677734, 53699.55360412598, 55815.77350521088, 57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.80401940880679, "mean_inference_ms": 6.641851639334182, "mean_action_processing_ms": 0.19953965504867546, "mean_env_wait_ms": 222.13079780469133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05575014539986602, "StateBufferConnector_ms": 0.005920465327491445, "ViewRequirementAgentConnector_ms": 0.190425116168566}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.23455586622947, "num_env_steps_trained_throughput_per_sec": 180.23455586622947, "timesteps_total": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 16277.589, "sample_time_ms": 12073.956, "learn_time_ms": 4055.569, "learn_throughput": 986.298, "synch_weights_time_ms": 146.665}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 8124, "training_iteration": 276, "trial_id": "185f8_00000", "date": "2025-03-21_12-58-19", "timestamp": 1742561899, "time_this_iter_s": 22.270886182785034, "time_total_s": 4415.582184553146, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d5090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4415.582184553146, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 89.98666666666668, "ram_util_percent": 13.783333333333335}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9893217086792, "policy_loss": -0.012685028836131096, "vf_loss": 10.0, "vf_explained_var": 3.818174263869878e-06, "kl": 0.01003462728112936, "entropy": 0.32824286818504333, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "sampler_results": {"episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}}, "episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.23293085410734, "num_env_steps_trained_throughput_per_sec": 288.23293085410734, "timesteps_total": 1108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1108000, "timers": {"training_iteration_time_ms": 15929.106, "sample_time_ms": 11658.004, "learn_time_ms": 4117.483, "learn_throughput": 971.467, "synch_weights_time_ms": 152.241}, "counters": {"num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "done": false, "episodes_total": 8124, "training_iteration": 277, "trial_id": "185f8_00000", "date": "2025-03-21_12-58-33", "timestamp": 1742561913, "time_this_iter_s": 13.932467460632324, "time_total_s": 4429.514652013779, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f9adf30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4429.514652013779, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 99.48, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98712158203125, "policy_loss": -0.014590738341212273, "vf_loss": 10.0, "vf_explained_var": -1.5512108575421735e-06, "kl": 0.008564481511712074, "entropy": 0.32979315519332886, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "sampler_results": {"episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}}, "episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.2665646625743, "num_env_steps_trained_throughput_per_sec": 277.2665646625743, "timesteps_total": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 15487.39, "sample_time_ms": 11212.779, "learn_time_ms": 4125.398, "learn_throughput": 969.603, "synch_weights_time_ms": 147.866}, "counters": {"num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "episodes_total": 8124, "training_iteration": 278, "trial_id": "185f8_00000", "date": "2025-03-21_12-58-48", "timestamp": 1742561928, "time_this_iter_s": 14.477426528930664, "time_total_s": 4443.992078542709, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f892cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4443.992078542709, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 99.54761904761905, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987310409545898, "policy_loss": -0.014778892509639263, "vf_loss": 10.0, "vf_explained_var": 1.7419457662981586e-06, "kl": 0.010447848588228226, "entropy": 0.33783620595932007, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}}, "episode_reward_max": 57087.173416137695, "episode_reward_min": 57087.173416137695, "episode_reward_mean": 57087.173416137695, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57087.173416137695}, "policy_reward_max": {"agent_0": 57087.173416137695}, "policy_reward_mean": {"agent_0": 57087.173416137695}, "hist_stats": {"episode_reward": [57087.173416137695], "episode_lengths": [135], "policy_agent_0_reward": [57087.173416137695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.69054793145477, "mean_inference_ms": 6.170967083264487, "mean_action_processing_ms": 0.19705928520479896, "mean_env_wait_ms": 225.86801866436144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04513263702392578, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.17752647399902344}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.5459481472477, "num_env_steps_trained_throughput_per_sec": 270.5459481472477, "timesteps_total": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 15541.736, "sample_time_ms": 11284.497, "learn_time_ms": 4097.531, "learn_throughput": 976.198, "synch_weights_time_ms": 158.325}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 8124, "training_iteration": 279, "trial_id": "185f8_00000", "date": "2025-03-21_12-59-03", "timestamp": 1742561943, "time_this_iter_s": 14.843024730682373, "time_total_s": 4458.835103273392, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d5090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4458.835103273392, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 99.38571428571429, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.016129032258065, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.679585456848145, "policy_loss": -0.013784946873784065, "vf_loss": 9.691417694091797, "vf_explained_var": -2.2817403078079224e-07, "kl": 0.00976340752094984, "entropy": 0.3555248975753784, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "sampler_results": {"episode_reward_max": 60000.433837890625, "episode_reward_min": 46616.740065574646, "episode_reward_mean": 53578.53449745428, "episode_len_mean": 135.1209677419355, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 46616.740065574646}, "policy_reward_max": {"agent_0": 60000.433837890625}, "policy_reward_mean": {"agent_0": 53578.53449745428}, "custom_metrics": {"num_batches_mean": 5.016129032258065, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50889.74677181244, 54268.84679603577, 54709.3934135437, 55623.50663757324, 55347.193450927734, 49579.62024116516, 56955.067054748535, 56820.907165527344, 52184.25347137451, 58195.59324645996, 51103.59344673157, 54134.72692108154, 53936.17997741699, 54320.56025695801, 52951.51343154907, 53050.893825531006, 53199.366901397705, 54327.10680389404, 54619.21350097656, 53011.63352012634, 55196.36000061035, 49230.60045051575, 55184.30019378662, 50877.46683692932, 54937.07989501953, 54794.040184020996, 53801.953466415405, 54033.18000793457, 55474.407002449036, 55050.700134277344, 56148.773498535156, 56583.106773376465, 53752.11339187622, 55091.187004089355, 53687.013496398926, 52644.56001472473, 50062.50682449341, 54481.713497161865, 54829.26008605957, 52710.966777801514, 55213.106941223145, 51438.77323055267, 52419.59346199036, 51851.893553733826, 54381.980056762695, 52104.37350463867, 53601.139835357666, 56385.9533996582, 47992.74670243263, 54297.58685684204, 60000.433837890625, 47693.96001243591, 54511.8868560791, 53577.993591308594, 53117.9135055542, 48720.00011062622, 55611.44667816162, 54358.58673477173, 50027.93323135376, 52908.220270872116, 55109.10681915283, 50530.99340629578, 50095.17981147766, 53798.740102767944, 57790.32026672363, 51032.86693954468, 55746.333404541016, 53255.82674789429, 55188.21353149414, 53385.10017776489, 50948.74025821686, 58004.360176086426, 49284.73354721069, 57500.29331493378, 54924.046798706055, 53342.9401550293, 50979.46666145325, 55720.9135055542, 55872.613666534424, 54978.873373031616, 51863.88003921509, 54667.520278692245, 56026.76671600342, 53660.40028381348, 54138.56684303284, 53999.92038345337, 53373.340114593506, 52733.81320333481, 54088.63350868225, 53002.94002151489, 54650.12692260742, 52426.18677902222, 53458.16002655029, 54381.3600730896, 55129.02680969238, 56599.52685546875, 52582.893270373344, 54555.50012969971, 55194.12019729614, 54069.38023376465, 52710.933490753174, 46616.740065574646, 50941.78697872162, 56909.813400268555, 51426.67356109619, 57285.033710479736, 51593.49354171753, 51113.2469291687, 54419.91353607178, 56323.5133934021, 52019.953536987305, 50442.7934589386, 57701.41371154785, 49460.65331363678, 51928.43350791931, 53251.28673648834, 51022.51997947693, 50655.70007419586, 50576.30668067932, 56101.59996032715, 53568.78689575195, 54976.45361328125, 55217.92682266235, 51365.846687316895], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 135, 134, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 136, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 135, 136, 134, 135, 136, 135, 134, 135, 135, 135, 136, 135, 134, 136, 135, 135, 135, 137, 134, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 134, 135, 134, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 134, 136], "policy_agent_0_reward": [50889.74677181244, 54268.84679603577, 54709.3934135437, 55623.50663757324, 55347.193450927734, 49579.62024116516, 56955.067054748535, 56820.907165527344, 52184.25347137451, 58195.59324645996, 51103.59344673157, 54134.72692108154, 53936.17997741699, 54320.56025695801, 52951.51343154907, 53050.893825531006, 53199.366901397705, 54327.10680389404, 54619.21350097656, 53011.63352012634, 55196.36000061035, 49230.60045051575, 55184.30019378662, 50877.46683692932, 54937.07989501953, 54794.040184020996, 53801.953466415405, 54033.18000793457, 55474.407002449036, 55050.700134277344, 56148.773498535156, 56583.106773376465, 53752.11339187622, 55091.187004089355, 53687.013496398926, 52644.56001472473, 50062.50682449341, 54481.713497161865, 54829.26008605957, 52710.966777801514, 55213.106941223145, 51438.77323055267, 52419.59346199036, 51851.893553733826, 54381.980056762695, 52104.37350463867, 53601.139835357666, 56385.9533996582, 47992.74670243263, 54297.58685684204, 60000.433837890625, 47693.96001243591, 54511.8868560791, 53577.993591308594, 53117.9135055542, 48720.00011062622, 55611.44667816162, 54358.58673477173, 50027.93323135376, 52908.220270872116, 55109.10681915283, 50530.99340629578, 50095.17981147766, 53798.740102767944, 57790.32026672363, 51032.86693954468, 55746.333404541016, 53255.82674789429, 55188.21353149414, 53385.10017776489, 50948.74025821686, 58004.360176086426, 49284.73354721069, 57500.29331493378, 54924.046798706055, 53342.9401550293, 50979.46666145325, 55720.9135055542, 55872.613666534424, 54978.873373031616, 51863.88003921509, 54667.520278692245, 56026.76671600342, 53660.40028381348, 54138.56684303284, 53999.92038345337, 53373.340114593506, 52733.81320333481, 54088.63350868225, 53002.94002151489, 54650.12692260742, 52426.18677902222, 53458.16002655029, 54381.3600730896, 55129.02680969238, 56599.52685546875, 52582.893270373344, 54555.50012969971, 55194.12019729614, 54069.38023376465, 52710.933490753174, 46616.740065574646, 50941.78697872162, 56909.813400268555, 51426.67356109619, 57285.033710479736, 51593.49354171753, 51113.2469291687, 54419.91353607178, 56323.5133934021, 52019.953536987305, 50442.7934589386, 57701.41371154785, 49460.65331363678, 51928.43350791931, 53251.28673648834, 51022.51997947693, 50655.70007419586, 50576.30668067932, 56101.59996032715, 53568.78689575195, 54976.45361328125, 55217.92682266235, 51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.688288615648915, "mean_inference_ms": 6.636739726331175, "mean_action_processing_ms": 0.1995882222920693, "mean_env_wait_ms": 222.0877112832883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050531664202290195, "StateBufferConnector_ms": 0.006036027785270444, "ViewRequirementAgentConnector_ms": 0.22875474345299504}}, "episode_reward_max": 60000.433837890625, "episode_reward_min": 46616.740065574646, "episode_reward_mean": 53578.53449745428, "episode_len_mean": 135.1209677419355, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 46616.740065574646}, "policy_reward_max": {"agent_0": 60000.433837890625}, "policy_reward_mean": {"agent_0": 53578.53449745428}, "hist_stats": {"episode_reward": [50889.74677181244, 54268.84679603577, 54709.3934135437, 55623.50663757324, 55347.193450927734, 49579.62024116516, 56955.067054748535, 56820.907165527344, 52184.25347137451, 58195.59324645996, 51103.59344673157, 54134.72692108154, 53936.17997741699, 54320.56025695801, 52951.51343154907, 53050.893825531006, 53199.366901397705, 54327.10680389404, 54619.21350097656, 53011.63352012634, 55196.36000061035, 49230.60045051575, 55184.30019378662, 50877.46683692932, 54937.07989501953, 54794.040184020996, 53801.953466415405, 54033.18000793457, 55474.407002449036, 55050.700134277344, 56148.773498535156, 56583.106773376465, 53752.11339187622, 55091.187004089355, 53687.013496398926, 52644.56001472473, 50062.50682449341, 54481.713497161865, 54829.26008605957, 52710.966777801514, 55213.106941223145, 51438.77323055267, 52419.59346199036, 51851.893553733826, 54381.980056762695, 52104.37350463867, 53601.139835357666, 56385.9533996582, 47992.74670243263, 54297.58685684204, 60000.433837890625, 47693.96001243591, 54511.8868560791, 53577.993591308594, 53117.9135055542, 48720.00011062622, 55611.44667816162, 54358.58673477173, 50027.93323135376, 52908.220270872116, 55109.10681915283, 50530.99340629578, 50095.17981147766, 53798.740102767944, 57790.32026672363, 51032.86693954468, 55746.333404541016, 53255.82674789429, 55188.21353149414, 53385.10017776489, 50948.74025821686, 58004.360176086426, 49284.73354721069, 57500.29331493378, 54924.046798706055, 53342.9401550293, 50979.46666145325, 55720.9135055542, 55872.613666534424, 54978.873373031616, 51863.88003921509, 54667.520278692245, 56026.76671600342, 53660.40028381348, 54138.56684303284, 53999.92038345337, 53373.340114593506, 52733.81320333481, 54088.63350868225, 53002.94002151489, 54650.12692260742, 52426.18677902222, 53458.16002655029, 54381.3600730896, 55129.02680969238, 56599.52685546875, 52582.893270373344, 54555.50012969971, 55194.12019729614, 54069.38023376465, 52710.933490753174, 46616.740065574646, 50941.78697872162, 56909.813400268555, 51426.67356109619, 57285.033710479736, 51593.49354171753, 51113.2469291687, 54419.91353607178, 56323.5133934021, 52019.953536987305, 50442.7934589386, 57701.41371154785, 49460.65331363678, 51928.43350791931, 53251.28673648834, 51022.51997947693, 50655.70007419586, 50576.30668067932, 56101.59996032715, 53568.78689575195, 54976.45361328125, 55217.92682266235, 51365.846687316895], "episode_lengths": [135, 135, 136, 135, 135, 136, 135, 136, 135, 134, 136, 135, 135, 135, 135, 135, 134, 136, 135, 135, 136, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 135, 136, 134, 135, 136, 135, 134, 135, 135, 135, 136, 135, 134, 136, 135, 135, 135, 137, 134, 135, 135, 136, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 134, 136, 135, 134, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 134, 135, 135, 136, 135, 134, 135, 134, 136, 136, 136, 135, 135, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 134, 136], "policy_agent_0_reward": [50889.74677181244, 54268.84679603577, 54709.3934135437, 55623.50663757324, 55347.193450927734, 49579.62024116516, 56955.067054748535, 56820.907165527344, 52184.25347137451, 58195.59324645996, 51103.59344673157, 54134.72692108154, 53936.17997741699, 54320.56025695801, 52951.51343154907, 53050.893825531006, 53199.366901397705, 54327.10680389404, 54619.21350097656, 53011.63352012634, 55196.36000061035, 49230.60045051575, 55184.30019378662, 50877.46683692932, 54937.07989501953, 54794.040184020996, 53801.953466415405, 54033.18000793457, 55474.407002449036, 55050.700134277344, 56148.773498535156, 56583.106773376465, 53752.11339187622, 55091.187004089355, 53687.013496398926, 52644.56001472473, 50062.50682449341, 54481.713497161865, 54829.26008605957, 52710.966777801514, 55213.106941223145, 51438.77323055267, 52419.59346199036, 51851.893553733826, 54381.980056762695, 52104.37350463867, 53601.139835357666, 56385.9533996582, 47992.74670243263, 54297.58685684204, 60000.433837890625, 47693.96001243591, 54511.8868560791, 53577.993591308594, 53117.9135055542, 48720.00011062622, 55611.44667816162, 54358.58673477173, 50027.93323135376, 52908.220270872116, 55109.10681915283, 50530.99340629578, 50095.17981147766, 53798.740102767944, 57790.32026672363, 51032.86693954468, 55746.333404541016, 53255.82674789429, 55188.21353149414, 53385.10017776489, 50948.74025821686, 58004.360176086426, 49284.73354721069, 57500.29331493378, 54924.046798706055, 53342.9401550293, 50979.46666145325, 55720.9135055542, 55872.613666534424, 54978.873373031616, 51863.88003921509, 54667.520278692245, 56026.76671600342, 53660.40028381348, 54138.56684303284, 53999.92038345337, 53373.340114593506, 52733.81320333481, 54088.63350868225, 53002.94002151489, 54650.12692260742, 52426.18677902222, 53458.16002655029, 54381.3600730896, 55129.02680969238, 56599.52685546875, 52582.893270373344, 54555.50012969971, 55194.12019729614, 54069.38023376465, 52710.933490753174, 46616.740065574646, 50941.78697872162, 56909.813400268555, 51426.67356109619, 57285.033710479736, 51593.49354171753, 51113.2469291687, 54419.91353607178, 56323.5133934021, 52019.953536987305, 50442.7934589386, 57701.41371154785, 49460.65331363678, 51928.43350791931, 53251.28673648834, 51022.51997947693, 50655.70007419586, 50576.30668067932, 56101.59996032715, 53568.78689575195, 54976.45361328125, 55217.92682266235, 51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.688288615648915, "mean_inference_ms": 6.636739726331175, "mean_action_processing_ms": 0.1995882222920693, "mean_env_wait_ms": 222.0877112832883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050531664202290195, "StateBufferConnector_ms": 0.006036027785270444, "ViewRequirementAgentConnector_ms": 0.22875474345299504}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.66663729350233, "num_env_steps_trained_throughput_per_sec": 186.66663729350233, "timesteps_total": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 16320.78, "sample_time_ms": 12064.786, "learn_time_ms": 4092.905, "learn_throughput": 977.301, "synch_weights_time_ms": 161.694}, "counters": {"num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "episodes_total": 8248, "training_iteration": 280, "trial_id": "185f8_00000", "date": "2025-03-21_12-59-24", "timestamp": 1742561964, "time_this_iter_s": 21.491547107696533, "time_total_s": 4480.326650381088, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4480.326650381088, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 91.17586206896551, "ram_util_percent": 13.782758620689659}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988329887390137, "policy_loss": -0.013548457063734531, "vf_loss": 10.0, "vf_explained_var": 9.33185191343e-08, "kl": 0.009392757900059223, "entropy": 0.34962770342826843, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "sampler_results": {"episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}}, "episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.34436897403026, "num_env_steps_trained_throughput_per_sec": 272.34436897403026, "timesteps_total": 1124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1124000, "timers": {"training_iteration_time_ms": 16437.22, "sample_time_ms": 12109.4, "learn_time_ms": 4160.854, "learn_throughput": 961.341, "synch_weights_time_ms": 165.573}, "counters": {"num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "done": false, "episodes_total": 8248, "training_iteration": 281, "trial_id": "185f8_00000", "date": "2025-03-21_12-59-39", "timestamp": 1742561979, "time_this_iter_s": 14.748880863189697, "time_total_s": 4495.075531244278, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2f910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4495.075531244278, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 99.51428571428572, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989259719848633, "policy_loss": -0.012466571293771267, "vf_loss": 10.0, "vf_explained_var": 3.753850990051433e-07, "kl": 0.008631122298538685, "entropy": 0.33919721841812134, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}}, "episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.5442082346507, "num_env_steps_trained_throughput_per_sec": 277.5442082346507, "timesteps_total": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 15808.022, "sample_time_ms": 11460.949, "learn_time_ms": 4180.054, "learn_throughput": 956.925, "synch_weights_time_ms": 165.619}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 8248, "training_iteration": 282, "trial_id": "185f8_00000", "date": "2025-03-21_12-59-54", "timestamp": 1742561994, "time_this_iter_s": 14.453895092010498, "time_total_s": 4509.529426336288, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fd7b880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4509.529426336288, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 99.675, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982904434204102, "policy_loss": -0.016311822459101677, "vf_loss": 9.997314453125, "vf_explained_var": 5.718941338272998e-07, "kl": 0.009509711526334286, "entropy": 0.37292519211769104, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "sampler_results": {"episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}}, "episode_reward_max": 51365.846687316895, "episode_reward_min": 51365.846687316895, "episode_reward_mean": 51365.846687316895, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51365.846687316895}, "policy_reward_max": {"agent_0": 51365.846687316895}, "policy_reward_mean": {"agent_0": 51365.846687316895}, "hist_stats": {"episode_reward": [51365.846687316895], "episode_lengths": [136], "policy_agent_0_reward": [51365.846687316895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.03370066862955, "mean_inference_ms": 6.167945764969668, "mean_action_processing_ms": 0.1969534349606487, "mean_env_wait_ms": 226.09642653203997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05745887756347656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.1659393310546875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.4149479839332, "num_env_steps_trained_throughput_per_sec": 266.4149479839332, "timesteps_total": 1132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1132000, "timers": {"training_iteration_time_ms": 15862.767, "sample_time_ms": 11520.796, "learn_time_ms": 4171.995, "learn_throughput": 958.774, "synch_weights_time_ms": 168.632}, "counters": {"num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "done": false, "episodes_total": 8248, "training_iteration": 283, "trial_id": "185f8_00000", "date": "2025-03-21_13-00-09", "timestamp": 1742562009, "time_this_iter_s": 15.077766180038452, "time_total_s": 4524.607192516327, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2f910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4524.607192516327, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 99.61363636363639, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.705056190490723, "policy_loss": -0.013232619501650333, "vf_loss": 9.716552734375, "vf_explained_var": 3.049150052447658e-07, "kl": 0.008673882111907005, "entropy": 0.39248764514923096, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "sampler_results": {"episode_reward_max": 58275.780029296875, "episode_reward_min": 46535.00691592693, "episode_reward_mean": 53350.12568786292, "episode_len_mean": 135.20353982300884, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {"agent_0": 46535.00691592693}, "policy_reward_max": {"agent_0": 58275.780029296875}, "policy_reward_mean": {"agent_0": 53350.12568786292}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55403.21346282959, 57377.006744384766, 52394.946758270264, 53289.76690673828, 53830.07342720032, 49166.87347793579, 53407.66680145264, 55311.646743774414, 54168.46681976318, 51280.04035949707, 53145.05352020264, 53067.89331817627, 55699.13338851929, 58275.780029296875, 57072.97378540039, 53300.37344098091, 49300.93337440491, 56011.27346801758, 51451.893339157104, 55221.840423583984, 55179.32020568848, 55290.0669631958, 52504.34019088745, 49743.56005752087, 53234.8868560791, 52254.59316825867, 51168.83344459534, 57431.67329406738, 50722.11364412308, 51812.18023109436, 52669.56678390503, 53148.933274269104, 55248.25997924805, 52469.77995491028, 56731.90019226074, 54867.42661857605, 55851.000228881836, 48609.16673088074, 49145.419962882996, 56526.70684814453, 47388.12021827698, 52929.286860466, 55023.47355270386, 46535.00691592693, 53250.82026672363, 50898.880148887634, 54677.573574543, 55352.44002079964, 55756.553508758545, 56866.99994659424, 53351.81363296509, 49550.91993045807, 49480.13349151611, 54977.1201210022, 53031.853340148926, 54976.36018371582, 52145.83364677429, 55445.22692680359, 52038.27349281311, 50312.040243148804, 49952.44020271301, 53253.46043968201, 50788.46024894714, 53732.88665962219, 50665.773376464844, 50978.386587142944, 54668.466844558716, 54573.86045742035, 56212.660247802734, 54191.193546295166, 55559.74676513672, 53682.00014400482, 53744.68012428284, 54162.693435668945, 53908.7133808136, 53721.38700866699, 56531.64013671875, 52220.580313682556, 55815.36666870117, 56950.78022766113, 55207.35347366333, 49931.98676228523, 52286.160148620605, 48275.366579055786, 50271.69321167469, 53186.40728378296, 56276.42682647705, 52895.58667802811, 48811.660019397736, 51739.77321052551, 51468.706807255745, 53503.21352767944, 50787.88676548004, 55703.48020553589, 51505.3468914032, 51859.606494903564, 55568.04027938843, 57549.0870513916, 53614.66008377075, 54594.113441467285, 54262.2066860199, 51797.48663330078, 52722.60034561157, 52007.72025489807, 51659.460099220276, 56538.086990356445, 56129.500061035156, 55673.46016120911, 54146.960092544556, 52638.57345581055, 55991.68008804321, 52353.200174331665, 55516.22688627243], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 134, 136, 136, 135, 135, 136, 136, 135, 135, 135, 135, 134, 135, 134, 136, 135, 135, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 135, 136, 135, 136, 135, 137, 135, 136, 135, 134, 135, 136, 135, 135, 136, 136, 135, 136, 134, 135, 135, 136, 136, 135, 136, 135], "policy_agent_0_reward": [55403.21346282959, 57377.006744384766, 52394.946758270264, 53289.76690673828, 53830.07342720032, 49166.87347793579, 53407.66680145264, 55311.646743774414, 54168.46681976318, 51280.04035949707, 53145.05352020264, 53067.89331817627, 55699.13338851929, 58275.780029296875, 57072.97378540039, 53300.37344098091, 49300.93337440491, 56011.27346801758, 51451.893339157104, 55221.840423583984, 55179.32020568848, 55290.0669631958, 52504.34019088745, 49743.56005752087, 53234.8868560791, 52254.59316825867, 51168.83344459534, 57431.67329406738, 50722.11364412308, 51812.18023109436, 52669.56678390503, 53148.933274269104, 55248.25997924805, 52469.77995491028, 56731.90019226074, 54867.42661857605, 55851.000228881836, 48609.16673088074, 49145.419962882996, 56526.70684814453, 47388.12021827698, 52929.286860466, 55023.47355270386, 46535.00691592693, 53250.82026672363, 50898.880148887634, 54677.573574543, 55352.44002079964, 55756.553508758545, 56866.99994659424, 53351.81363296509, 49550.91993045807, 49480.13349151611, 54977.1201210022, 53031.853340148926, 54976.36018371582, 52145.83364677429, 55445.22692680359, 52038.27349281311, 50312.040243148804, 49952.44020271301, 53253.46043968201, 50788.46024894714, 53732.88665962219, 50665.773376464844, 50978.386587142944, 54668.466844558716, 54573.86045742035, 56212.660247802734, 54191.193546295166, 55559.74676513672, 53682.00014400482, 53744.68012428284, 54162.693435668945, 53908.7133808136, 53721.38700866699, 56531.64013671875, 52220.580313682556, 55815.36666870117, 56950.78022766113, 55207.35347366333, 49931.98676228523, 52286.160148620605, 48275.366579055786, 50271.69321167469, 53186.40728378296, 56276.42682647705, 52895.58667802811, 48811.660019397736, 51739.77321052551, 51468.706807255745, 53503.21352767944, 50787.88676548004, 55703.48020553589, 51505.3468914032, 51859.606494903564, 55568.04027938843, 57549.0870513916, 53614.66008377075, 54594.113441467285, 54262.2066860199, 51797.48663330078, 52722.60034561157, 52007.72025489807, 51659.460099220276, 56538.086990356445, 56129.500061035156, 55673.46016120911, 54146.960092544556, 52638.57345581055, 55991.68008804321, 52353.200174331665, 55516.22688627243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.1424977393229, "mean_inference_ms": 6.620577696548678, "mean_action_processing_ms": 0.19945612461069195, "mean_env_wait_ms": 221.87423196505677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0554141745103144, "StateBufferConnector_ms": 0.005962363386576155, "ViewRequirementAgentConnector_ms": 0.19339565682200205}}, "episode_reward_max": 58275.780029296875, "episode_reward_min": 46535.00691592693, "episode_reward_mean": 53350.12568786292, "episode_len_mean": 135.20353982300884, "episodes_this_iter": 113, "policy_reward_min": {"agent_0": 46535.00691592693}, "policy_reward_max": {"agent_0": 58275.780029296875}, "policy_reward_mean": {"agent_0": 53350.12568786292}, "hist_stats": {"episode_reward": [55403.21346282959, 57377.006744384766, 52394.946758270264, 53289.76690673828, 53830.07342720032, 49166.87347793579, 53407.66680145264, 55311.646743774414, 54168.46681976318, 51280.04035949707, 53145.05352020264, 53067.89331817627, 55699.13338851929, 58275.780029296875, 57072.97378540039, 53300.37344098091, 49300.93337440491, 56011.27346801758, 51451.893339157104, 55221.840423583984, 55179.32020568848, 55290.0669631958, 52504.34019088745, 49743.56005752087, 53234.8868560791, 52254.59316825867, 51168.83344459534, 57431.67329406738, 50722.11364412308, 51812.18023109436, 52669.56678390503, 53148.933274269104, 55248.25997924805, 52469.77995491028, 56731.90019226074, 54867.42661857605, 55851.000228881836, 48609.16673088074, 49145.419962882996, 56526.70684814453, 47388.12021827698, 52929.286860466, 55023.47355270386, 46535.00691592693, 53250.82026672363, 50898.880148887634, 54677.573574543, 55352.44002079964, 55756.553508758545, 56866.99994659424, 53351.81363296509, 49550.91993045807, 49480.13349151611, 54977.1201210022, 53031.853340148926, 54976.36018371582, 52145.83364677429, 55445.22692680359, 52038.27349281311, 50312.040243148804, 49952.44020271301, 53253.46043968201, 50788.46024894714, 53732.88665962219, 50665.773376464844, 50978.386587142944, 54668.466844558716, 54573.86045742035, 56212.660247802734, 54191.193546295166, 55559.74676513672, 53682.00014400482, 53744.68012428284, 54162.693435668945, 53908.7133808136, 53721.38700866699, 56531.64013671875, 52220.580313682556, 55815.36666870117, 56950.78022766113, 55207.35347366333, 49931.98676228523, 52286.160148620605, 48275.366579055786, 50271.69321167469, 53186.40728378296, 56276.42682647705, 52895.58667802811, 48811.660019397736, 51739.77321052551, 51468.706807255745, 53503.21352767944, 50787.88676548004, 55703.48020553589, 51505.3468914032, 51859.606494903564, 55568.04027938843, 57549.0870513916, 53614.66008377075, 54594.113441467285, 54262.2066860199, 51797.48663330078, 52722.60034561157, 52007.72025489807, 51659.460099220276, 56538.086990356445, 56129.500061035156, 55673.46016120911, 54146.960092544556, 52638.57345581055, 55991.68008804321, 52353.200174331665, 55516.22688627243], "episode_lengths": [135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 134, 136, 136, 135, 135, 136, 136, 135, 135, 135, 135, 134, 135, 134, 136, 135, 135, 136, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 134, 135, 136, 135, 136, 135, 137, 135, 136, 135, 134, 135, 136, 135, 135, 136, 136, 135, 136, 134, 135, 135, 136, 136, 135, 136, 135], "policy_agent_0_reward": [55403.21346282959, 57377.006744384766, 52394.946758270264, 53289.76690673828, 53830.07342720032, 49166.87347793579, 53407.66680145264, 55311.646743774414, 54168.46681976318, 51280.04035949707, 53145.05352020264, 53067.89331817627, 55699.13338851929, 58275.780029296875, 57072.97378540039, 53300.37344098091, 49300.93337440491, 56011.27346801758, 51451.893339157104, 55221.840423583984, 55179.32020568848, 55290.0669631958, 52504.34019088745, 49743.56005752087, 53234.8868560791, 52254.59316825867, 51168.83344459534, 57431.67329406738, 50722.11364412308, 51812.18023109436, 52669.56678390503, 53148.933274269104, 55248.25997924805, 52469.77995491028, 56731.90019226074, 54867.42661857605, 55851.000228881836, 48609.16673088074, 49145.419962882996, 56526.70684814453, 47388.12021827698, 52929.286860466, 55023.47355270386, 46535.00691592693, 53250.82026672363, 50898.880148887634, 54677.573574543, 55352.44002079964, 55756.553508758545, 56866.99994659424, 53351.81363296509, 49550.91993045807, 49480.13349151611, 54977.1201210022, 53031.853340148926, 54976.36018371582, 52145.83364677429, 55445.22692680359, 52038.27349281311, 50312.040243148804, 49952.44020271301, 53253.46043968201, 50788.46024894714, 53732.88665962219, 50665.773376464844, 50978.386587142944, 54668.466844558716, 54573.86045742035, 56212.660247802734, 54191.193546295166, 55559.74676513672, 53682.00014400482, 53744.68012428284, 54162.693435668945, 53908.7133808136, 53721.38700866699, 56531.64013671875, 52220.580313682556, 55815.36666870117, 56950.78022766113, 55207.35347366333, 49931.98676228523, 52286.160148620605, 48275.366579055786, 50271.69321167469, 53186.40728378296, 56276.42682647705, 52895.58667802811, 48811.660019397736, 51739.77321052551, 51468.706807255745, 53503.21352767944, 50787.88676548004, 55703.48020553589, 51505.3468914032, 51859.606494903564, 55568.04027938843, 57549.0870513916, 53614.66008377075, 54594.113441467285, 54262.2066860199, 51797.48663330078, 52722.60034561157, 52007.72025489807, 51659.460099220276, 56538.086990356445, 56129.500061035156, 55673.46016120911, 54146.960092544556, 52638.57345581055, 55991.68008804321, 52353.200174331665, 55516.22688627243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 39.1424977393229, "mean_inference_ms": 6.620577696548678, "mean_action_processing_ms": 0.19945612461069195, "mean_env_wait_ms": 221.87423196505677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0554141745103144, "StateBufferConnector_ms": 0.005962363386576155, "ViewRequirementAgentConnector_ms": 0.19339565682200205}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.8547034435242, "num_env_steps_trained_throughput_per_sec": 203.8547034435242, "timesteps_total": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 16436.734, "sample_time_ms": 12093.276, "learn_time_ms": 4173.777, "learn_throughput": 958.365, "synch_weights_time_ms": 168.287}, "counters": {"num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "episodes_total": 8361, "training_iteration": 284, "trial_id": "185f8_00000", "date": "2025-03-21_13-00-29", "timestamp": 1742562029, "time_this_iter_s": 19.675577640533447, "time_total_s": 4544.28277015686, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4544.28277015686, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 93.32592592592592, "ram_util_percent": 13.796296296296298}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.957090377807617, "policy_loss": -0.01771414279937744, "vf_loss": 9.97265625, "vf_explained_var": -3.8910656030566315e-07, "kl": 0.010740679688751698, "entropy": 0.36357420682907104, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 55576.206886291504, "episode_reward_min": 49311.60684680939, "episode_reward_mean": 52721.33347615329, "episode_len_mean": 135.45454545454547, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"agent_0": 49311.60684680939}, "policy_reward_max": {"agent_0": 55576.206886291504}, "policy_reward_mean": {"agent_0": 52721.33347615329}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53036.1800365448, 54380.340213775635, 52856.86661338806, 50349.30007171631, 54126.22680854797, 50296.86008453369, 55390.79364013672, 54571.42698287964, 55576.206886291504, 49311.60684680939, 50038.86005306244], "episode_lengths": [136, 136, 136, 136, 134, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [53036.1800365448, 54380.340213775635, 52856.86661338806, 50349.30007171631, 54126.22680854797, 50296.86008453369, 55390.79364013672, 54571.42698287964, 55576.206886291504, 49311.60684680939, 50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.11350678156669, "mean_inference_ms": 6.808381962194699, "mean_action_processing_ms": 0.2008200658934771, "mean_env_wait_ms": 223.53470068470943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03737536343661221, "StateBufferConnector_ms": 0.0058044086803089485, "ViewRequirementAgentConnector_ms": 0.16499215906316583}}, "episode_reward_max": 55576.206886291504, "episode_reward_min": 49311.60684680939, "episode_reward_mean": 52721.33347615329, "episode_len_mean": 135.45454545454547, "episodes_this_iter": 11, "policy_reward_min": {"agent_0": 49311.60684680939}, "policy_reward_max": {"agent_0": 55576.206886291504}, "policy_reward_mean": {"agent_0": 52721.33347615329}, "hist_stats": {"episode_reward": [53036.1800365448, 54380.340213775635, 52856.86661338806, 50349.30007171631, 54126.22680854797, 50296.86008453369, 55390.79364013672, 54571.42698287964, 55576.206886291504, 49311.60684680939, 50038.86005306244], "episode_lengths": [136, 136, 136, 136, 134, 135, 135, 135, 135, 136, 136], "policy_agent_0_reward": [53036.1800365448, 54380.340213775635, 52856.86661338806, 50349.30007171631, 54126.22680854797, 50296.86008453369, 55390.79364013672, 54571.42698287964, 55576.206886291504, 49311.60684680939, 50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.11350678156669, "mean_inference_ms": 6.808381962194699, "mean_action_processing_ms": 0.2008200658934771, "mean_env_wait_ms": 223.53470068470943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03737536343661221, "StateBufferConnector_ms": 0.0058044086803089485, "ViewRequirementAgentConnector_ms": 0.16499215906316583}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.1688871400429, "num_env_steps_trained_throughput_per_sec": 273.1688871400429, "timesteps_total": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 16508.877, "sample_time_ms": 12156.842, "learn_time_ms": 4183.45, "learn_throughput": 956.149, "synch_weights_time_ms": 167.222}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 8372, "training_iteration": 285, "trial_id": "185f8_00000", "date": "2025-03-21_13-00-43", "timestamp": 1742562043, "time_this_iter_s": 14.696962594985962, "time_total_s": 4558.979732751846, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d7f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4558.979732751846, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 99.35238095238095, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989130020141602, "policy_loss": -0.012639441527426243, "vf_loss": 10.0, "vf_explained_var": -8.56195896403733e-08, "kl": 0.008845188654959202, "entropy": 0.33236464858055115, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "sampler_results": {"episode_reward_max": 50038.86005306244, "episode_reward_min": 50038.86005306244, "episode_reward_mean": 50038.86005306244, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50038.86005306244}, "policy_reward_max": {"agent_0": 50038.86005306244}, "policy_reward_mean": {"agent_0": 50038.86005306244}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50038.86005306244], "episode_lengths": [136], "policy_agent_0_reward": [50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.77867682902074, "mean_inference_ms": 6.651811884129443, "mean_action_processing_ms": 0.19472498287823675, "mean_env_wait_ms": 225.62673533384952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03180503845214844, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.14450550079345703}}, "episode_reward_max": 50038.86005306244, "episode_reward_min": 50038.86005306244, "episode_reward_mean": 50038.86005306244, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50038.86005306244}, "policy_reward_max": {"agent_0": 50038.86005306244}, "policy_reward_mean": {"agent_0": 50038.86005306244}, "hist_stats": {"episode_reward": [50038.86005306244], "episode_lengths": [136], "policy_agent_0_reward": [50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.77867682902074, "mean_inference_ms": 6.651811884129443, "mean_action_processing_ms": 0.19472498287823675, "mean_env_wait_ms": 225.62673533384952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03180503845214844, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.14450550079345703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.18265007795094, "num_env_steps_trained_throughput_per_sec": 289.18265007795094, "timesteps_total": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 15672.756, "sample_time_ms": 11326.137, "learn_time_ms": 4177.598, "learn_throughput": 957.488, "synch_weights_time_ms": 168.062}, "counters": {"num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "episodes_total": 8372, "training_iteration": 286, "trial_id": "185f8_00000", "date": "2025-03-21_13-00-57", "timestamp": 1742562057, "time_this_iter_s": 13.895056247711182, "time_total_s": 4572.8747889995575, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d51b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4572.8747889995575, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 99.60499999999999, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985058784484863, "policy_loss": -0.016874922439455986, "vf_loss": 10.0, "vf_explained_var": 4.1890888269335846e-07, "kl": 0.009664053097367287, "entropy": 0.35950225591659546, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "sampler_results": {"episode_reward_max": 50038.86005306244, "episode_reward_min": 50038.86005306244, "episode_reward_mean": 50038.86005306244, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50038.86005306244}, "policy_reward_max": {"agent_0": 50038.86005306244}, "policy_reward_mean": {"agent_0": 50038.86005306244}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50038.86005306244], "episode_lengths": [136], "policy_agent_0_reward": [50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.77867682902074, "mean_inference_ms": 6.651811884129443, "mean_action_processing_ms": 0.19472498287823675, "mean_env_wait_ms": 225.62673533384952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03180503845214844, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.14450550079345703}}, "episode_reward_max": 50038.86005306244, "episode_reward_min": 50038.86005306244, "episode_reward_mean": 50038.86005306244, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50038.86005306244}, "policy_reward_max": {"agent_0": 50038.86005306244}, "policy_reward_mean": {"agent_0": 50038.86005306244}, "hist_stats": {"episode_reward": [50038.86005306244], "episode_lengths": [136], "policy_agent_0_reward": [50038.86005306244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 46.77867682902074, "mean_inference_ms": 6.651811884129443, "mean_action_processing_ms": 0.19472498287823675, "mean_env_wait_ms": 225.62673533384952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03180503845214844, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.14450550079345703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.67978338440116, "num_env_steps_trained_throughput_per_sec": 289.67978338440116, "timesteps_total": 1148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1148000, "timers": {"training_iteration_time_ms": 15665.823, "sample_time_ms": 11328.668, "learn_time_ms": 4167.959, "learn_throughput": 959.702, "synch_weights_time_ms": 168.241}, "counters": {"num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "done": false, "episodes_total": 8372, "training_iteration": 287, "trial_id": "185f8_00000", "date": "2025-03-21_13-01-11", "timestamp": 1742562071, "time_this_iter_s": 13.86061716079712, "time_total_s": 4586.735406160355, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789f891bd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4586.735406160355, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 99.54, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.800508499145508, "policy_loss": -0.01374014001339674, "vf_loss": 9.812623977661133, "vf_explained_var": -8.39432061638945e-07, "kl": 0.008115223608911037, "entropy": 0.3414466977119446, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 58428.813537597656, "episode_reward_min": 46590.12679862976, "episode_reward_mean": 53386.484982088004, "episode_len_mean": 135.1917808219178, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 46590.12679862976}, "policy_reward_max": {"agent_0": 58428.813537597656}, "policy_reward_mean": {"agent_0": 53386.484982088004}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48943.28681373596, 55797.80696296692, 56261.9200630188, 51486.386739730835, 55620.659927368164, 52338.126876831055, 56755.41370391846, 52198.64008331299, 54774.600158691406, 46590.12679862976, 49654.173409461975, 54698.17344665527, 55199.3468170166, 53385.440032958984, 51773.98006820679, 55500.78677368164, 55040.15345001221, 53641.07349395752, 55331.646699905396, 53704.81349182129, 56086.14666116238, 51135.64023208618, 55438.62010192871, 51461.4866027832, 56052.32015991211, 55238.53339385986, 51183.37996673584, 50352.72683811188, 51188.30692863464, 49202.606662750244, 58428.813537597656, 55074.14668273926, 53464.660095214844, 51364.360107421875, 55726.74675941467, 54998.91331100464, 51581.43348479271, 51039.24689292908, 53508.87350654602, 54109.466735839844, 52013.333251953125, 53194.78685760498, 55655.060066223145, 53904.486892700195, 49424.83333873749, 54426.44007110596, 54774.62010192871, 55887.246826171875, 53410.05994415283, 52941.43365097046, 57102.020248413086, 50273.76678711176, 56953.16661834717, 55412.00023651123, 50764.580211639404, 53801.30035209656, 55232.84711456299, 54306.620153427124, 54431.72036361694, 50121.96683549881, 57765.7003326416, 54229.90661621094, 56312.54675292969, 49026.94690608978, 54791.82698917389, 51848.68020439148, 54579.80684661865, 53685.40683364868, 50063.78026390076, 51396.933753967285, 50035.013421058655, 50881.9266204834, 53229.65375518799], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 134, 135, 134, 135, 135, 136, 135, 135, 135, 136, 136, 136, 134, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 134, 134, 135, 135, 135, 135, 136, 135, 135, 135, 137, 135, 136], "policy_agent_0_reward": [48943.28681373596, 55797.80696296692, 56261.9200630188, 51486.386739730835, 55620.659927368164, 52338.126876831055, 56755.41370391846, 52198.64008331299, 54774.600158691406, 46590.12679862976, 49654.173409461975, 54698.17344665527, 55199.3468170166, 53385.440032958984, 51773.98006820679, 55500.78677368164, 55040.15345001221, 53641.07349395752, 55331.646699905396, 53704.81349182129, 56086.14666116238, 51135.64023208618, 55438.62010192871, 51461.4866027832, 56052.32015991211, 55238.53339385986, 51183.37996673584, 50352.72683811188, 51188.30692863464, 49202.606662750244, 58428.813537597656, 55074.14668273926, 53464.660095214844, 51364.360107421875, 55726.74675941467, 54998.91331100464, 51581.43348479271, 51039.24689292908, 53508.87350654602, 54109.466735839844, 52013.333251953125, 53194.78685760498, 55655.060066223145, 53904.486892700195, 49424.83333873749, 54426.44007110596, 54774.62010192871, 55887.246826171875, 53410.05994415283, 52941.43365097046, 57102.020248413086, 50273.76678711176, 56953.16661834717, 55412.00023651123, 50764.580211639404, 53801.30035209656, 55232.84711456299, 54306.620153427124, 54431.72036361694, 50121.96683549881, 57765.7003326416, 54229.90661621094, 56312.54675292969, 49026.94690608978, 54791.82698917389, 51848.68020439148, 54579.80684661865, 53685.40683364868, 50063.78026390076, 51396.933753967285, 50035.013421058655, 50881.9266204834, 53229.65375518799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.56550954703713, "mean_inference_ms": 6.591829153230872, "mean_action_processing_ms": 0.2005090349087362, "mean_env_wait_ms": 219.73190612337294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046874725655333634, "StateBufferConnector_ms": 0.005991164952108305, "ViewRequirementAgentConnector_ms": 0.22182889180640653}}, "episode_reward_max": 58428.813537597656, "episode_reward_min": 46590.12679862976, "episode_reward_mean": 53386.484982088004, "episode_len_mean": 135.1917808219178, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 46590.12679862976}, "policy_reward_max": {"agent_0": 58428.813537597656}, "policy_reward_mean": {"agent_0": 53386.484982088004}, "hist_stats": {"episode_reward": [48943.28681373596, 55797.80696296692, 56261.9200630188, 51486.386739730835, 55620.659927368164, 52338.126876831055, 56755.41370391846, 52198.64008331299, 54774.600158691406, 46590.12679862976, 49654.173409461975, 54698.17344665527, 55199.3468170166, 53385.440032958984, 51773.98006820679, 55500.78677368164, 55040.15345001221, 53641.07349395752, 55331.646699905396, 53704.81349182129, 56086.14666116238, 51135.64023208618, 55438.62010192871, 51461.4866027832, 56052.32015991211, 55238.53339385986, 51183.37996673584, 50352.72683811188, 51188.30692863464, 49202.606662750244, 58428.813537597656, 55074.14668273926, 53464.660095214844, 51364.360107421875, 55726.74675941467, 54998.91331100464, 51581.43348479271, 51039.24689292908, 53508.87350654602, 54109.466735839844, 52013.333251953125, 53194.78685760498, 55655.060066223145, 53904.486892700195, 49424.83333873749, 54426.44007110596, 54774.62010192871, 55887.246826171875, 53410.05994415283, 52941.43365097046, 57102.020248413086, 50273.76678711176, 56953.16661834717, 55412.00023651123, 50764.580211639404, 53801.30035209656, 55232.84711456299, 54306.620153427124, 54431.72036361694, 50121.96683549881, 57765.7003326416, 54229.90661621094, 56312.54675292969, 49026.94690608978, 54791.82698917389, 51848.68020439148, 54579.80684661865, 53685.40683364868, 50063.78026390076, 51396.933753967285, 50035.013421058655, 50881.9266204834, 53229.65375518799], "episode_lengths": [136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 136, 135, 135, 135, 136, 135, 135, 135, 134, 135, 134, 135, 135, 136, 135, 135, 135, 136, 136, 136, 134, 135, 135, 136, 135, 135, 135, 136, 136, 135, 135, 135, 135, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 136, 134, 134, 135, 135, 135, 135, 136, 135, 135, 135, 137, 135, 136], "policy_agent_0_reward": [48943.28681373596, 55797.80696296692, 56261.9200630188, 51486.386739730835, 55620.659927368164, 52338.126876831055, 56755.41370391846, 52198.64008331299, 54774.600158691406, 46590.12679862976, 49654.173409461975, 54698.17344665527, 55199.3468170166, 53385.440032958984, 51773.98006820679, 55500.78677368164, 55040.15345001221, 53641.07349395752, 55331.646699905396, 53704.81349182129, 56086.14666116238, 51135.64023208618, 55438.62010192871, 51461.4866027832, 56052.32015991211, 55238.53339385986, 51183.37996673584, 50352.72683811188, 51188.30692863464, 49202.606662750244, 58428.813537597656, 55074.14668273926, 53464.660095214844, 51364.360107421875, 55726.74675941467, 54998.91331100464, 51581.43348479271, 51039.24689292908, 53508.87350654602, 54109.466735839844, 52013.333251953125, 53194.78685760498, 55655.060066223145, 53904.486892700195, 49424.83333873749, 54426.44007110596, 54774.62010192871, 55887.246826171875, 53410.05994415283, 52941.43365097046, 57102.020248413086, 50273.76678711176, 56953.16661834717, 55412.00023651123, 50764.580211639404, 53801.30035209656, 55232.84711456299, 54306.620153427124, 54431.72036361694, 50121.96683549881, 57765.7003326416, 54229.90661621094, 56312.54675292969, 49026.94690608978, 54791.82698917389, 51848.68020439148, 54579.80684661865, 53685.40683364868, 50063.78026390076, 51396.933753967285, 50035.013421058655, 50881.9266204834, 53229.65375518799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.56550954703713, "mean_inference_ms": 6.591829153230872, "mean_action_processing_ms": 0.2005090349087362, "mean_env_wait_ms": 219.73190612337294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046874725655333634, "StateBufferConnector_ms": 0.005991164952108305, "ViewRequirementAgentConnector_ms": 0.22182889180640653}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.06619417222262, "num_env_steps_trained_throughput_per_sec": 222.06619417222262, "timesteps_total": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 16024.436, "sample_time_ms": 11740.8, "learn_time_ms": 4116.368, "learn_throughput": 971.73, "synch_weights_time_ms": 166.276}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 8445, "training_iteration": 288, "trial_id": "185f8_00000", "date": "2025-03-21_13-01-29", "timestamp": 1742562089, "time_this_iter_s": 18.0687894821167, "time_total_s": 4604.804195642471, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d75b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4604.804195642471, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 96.73200000000001, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.705882352941177, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.859174728393555, "policy_loss": -0.014763099141418934, "vf_loss": 9.872316360473633, "vf_explained_var": 1.527368986842248e-08, "kl": 0.008100053295493126, "entropy": 0.35161033272743225, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "sampler_results": {"episode_reward_max": 57601.88673400879, "episode_reward_min": 43854.813343048096, "episode_reward_mean": 53724.349027255004, "episode_len_mean": 135.19607843137254, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {"agent_0": 43854.813343048096}, "policy_reward_max": {"agent_0": 57601.88673400879}, "policy_reward_mean": {"agent_0": 53724.349027255004}, "custom_metrics": {"num_batches_mean": 5.705882352941177, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56814.18001937866, 53377.34014892578, 52127.513437986374, 54891.74682807922, 53739.539923250675, 51225.50673484802, 52939.813558101654, 54136.71354675293, 49903.00008201599, 53754.646881103516, 51412.52007484436, 56016.72013092041, 49707.40678024292, 54296.26693725586, 51376.706621170044, 47279.78678882122, 54973.08013153076, 52819.11995887756, 53609.806800842285, 56214.113372802734, 52790.69349861145, 55045.06694793701, 52766.44005012512, 54980.37371444702, 55139.24038314819, 55097.82663726807, 43854.813343048096, 52185.6534614563, 57199.5202331543, 55176.726570129395, 46120.25349330902, 54283.03347688913, 55010.36001586914, 56437.63367462158, 51691.04700469971, 55160.193512916565, 56193.05354499817, 56981.56700134277, 57601.88673400879, 53483.54677963257, 55813.70004081726, 55662.05360412598, 54030.26666641235, 55758.07340621948, 53487.05344390869, 55151.42660522461, 53131.14023017883, 55258.353494644165, 54475.54698562622, 55635.92013168335, 53723.80694580078], "episode_lengths": [135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 134, 136, 135, 135, 136, 135, 134, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [56814.18001937866, 53377.34014892578, 52127.513437986374, 54891.74682807922, 53739.539923250675, 51225.50673484802, 52939.813558101654, 54136.71354675293, 49903.00008201599, 53754.646881103516, 51412.52007484436, 56016.72013092041, 49707.40678024292, 54296.26693725586, 51376.706621170044, 47279.78678882122, 54973.08013153076, 52819.11995887756, 53609.806800842285, 56214.113372802734, 52790.69349861145, 55045.06694793701, 52766.44005012512, 54980.37371444702, 55139.24038314819, 55097.82663726807, 43854.813343048096, 52185.6534614563, 57199.5202331543, 55176.726570129395, 46120.25349330902, 54283.03347688913, 55010.36001586914, 56437.63367462158, 51691.04700469971, 55160.193512916565, 56193.05354499817, 56981.56700134277, 57601.88673400879, 53483.54677963257, 55813.70004081726, 55662.05360412598, 54030.26666641235, 55758.07340621948, 53487.05344390869, 55151.42660522461, 53131.14023017883, 55258.353494644165, 54475.54698562622, 55635.92013168335, 53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.17846732805877, "mean_inference_ms": 6.702014142023259, "mean_action_processing_ms": 0.1981164723000195, "mean_env_wait_ms": 225.24361006464764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024832856421377, "StateBufferConnector_ms": 0.006143719542260263, "ViewRequirementAgentConnector_ms": 0.1829652225269991}}, "episode_reward_max": 57601.88673400879, "episode_reward_min": 43854.813343048096, "episode_reward_mean": 53724.349027255004, "episode_len_mean": 135.19607843137254, "episodes_this_iter": 51, "policy_reward_min": {"agent_0": 43854.813343048096}, "policy_reward_max": {"agent_0": 57601.88673400879}, "policy_reward_mean": {"agent_0": 53724.349027255004}, "hist_stats": {"episode_reward": [56814.18001937866, 53377.34014892578, 52127.513437986374, 54891.74682807922, 53739.539923250675, 51225.50673484802, 52939.813558101654, 54136.71354675293, 49903.00008201599, 53754.646881103516, 51412.52007484436, 56016.72013092041, 49707.40678024292, 54296.26693725586, 51376.706621170044, 47279.78678882122, 54973.08013153076, 52819.11995887756, 53609.806800842285, 56214.113372802734, 52790.69349861145, 55045.06694793701, 52766.44005012512, 54980.37371444702, 55139.24038314819, 55097.82663726807, 43854.813343048096, 52185.6534614563, 57199.5202331543, 55176.726570129395, 46120.25349330902, 54283.03347688913, 55010.36001586914, 56437.63367462158, 51691.04700469971, 55160.193512916565, 56193.05354499817, 56981.56700134277, 57601.88673400879, 53483.54677963257, 55813.70004081726, 55662.05360412598, 54030.26666641235, 55758.07340621948, 53487.05344390869, 55151.42660522461, 53131.14023017883, 55258.353494644165, 54475.54698562622, 55635.92013168335, 53723.80694580078], "episode_lengths": [135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 136, 135, 135, 136, 135, 135, 134, 136, 135, 135, 136, 135, 134, 135, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135], "policy_agent_0_reward": [56814.18001937866, 53377.34014892578, 52127.513437986374, 54891.74682807922, 53739.539923250675, 51225.50673484802, 52939.813558101654, 54136.71354675293, 49903.00008201599, 53754.646881103516, 51412.52007484436, 56016.72013092041, 49707.40678024292, 54296.26693725586, 51376.706621170044, 47279.78678882122, 54973.08013153076, 52819.11995887756, 53609.806800842285, 56214.113372802734, 52790.69349861145, 55045.06694793701, 52766.44005012512, 54980.37371444702, 55139.24038314819, 55097.82663726807, 43854.813343048096, 52185.6534614563, 57199.5202331543, 55176.726570129395, 46120.25349330902, 54283.03347688913, 55010.36001586914, 56437.63367462158, 51691.04700469971, 55160.193512916565, 56193.05354499817, 56981.56700134277, 57601.88673400879, 53483.54677963257, 55813.70004081726, 55662.05360412598, 54030.26666641235, 55758.07340621948, 53487.05344390869, 55151.42660522461, 53131.14023017883, 55258.353494644165, 54475.54698562622, 55635.92013168335, 53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 44.17846732805877, "mean_inference_ms": 6.702014142023259, "mean_action_processing_ms": 0.1981164723000195, "mean_env_wait_ms": 225.24361006464764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04024832856421377, "StateBufferConnector_ms": 0.006143719542260263, "ViewRequirementAgentConnector_ms": 0.1829652225269991}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.39047032257375, "num_env_steps_trained_throughput_per_sec": 200.39047032257375, "timesteps_total": 1156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1156000, "timers": {"training_iteration_time_ms": 16542.048, "sample_time_ms": 12255.492, "learn_time_ms": 4126.169, "learn_throughput": 969.422, "synch_weights_time_ms": 159.386}, "counters": {"num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "done": false, "episodes_total": 8496, "training_iteration": 289, "trial_id": "185f8_00000", "date": "2025-03-21_13-01-49", "timestamp": 1742562109, "time_this_iter_s": 20.028570890426636, "time_total_s": 4624.832766532898, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789fa2c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4624.832766532898, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 98.77692307692308, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987500190734863, "policy_loss": -0.014583572745323181, "vf_loss": 10.0, "vf_explained_var": 4.477798825064383e-07, "kl": 0.01041350793093443, "entropy": 0.33560147881507874, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "sampler_results": {"episode_reward_max": 53723.80694580078, "episode_reward_min": 53723.80694580078, "episode_reward_mean": 53723.80694580078, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53723.80694580078}, "policy_reward_max": {"agent_0": 53723.80694580078}, "policy_reward_mean": {"agent_0": 53723.80694580078}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53723.80694580078], "episode_lengths": [135], "policy_agent_0_reward": [53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.9229292614368, "mean_inference_ms": 6.64796266237173, "mean_action_processing_ms": 0.20071395294951652, "mean_env_wait_ms": 228.2396434178055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029611587524414062, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.13403892517089844}}, "episode_reward_max": 53723.80694580078, "episode_reward_min": 53723.80694580078, "episode_reward_mean": 53723.80694580078, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53723.80694580078}, "policy_reward_max": {"agent_0": 53723.80694580078}, "policy_reward_mean": {"agent_0": 53723.80694580078}, "hist_stats": {"episode_reward": [53723.80694580078], "episode_lengths": [135], "policy_agent_0_reward": [53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.9229292614368, "mean_inference_ms": 6.64796266237173, "mean_action_processing_ms": 0.20071395294951652, "mean_env_wait_ms": 228.2396434178055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029611587524414062, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.13403892517089844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.5637486516971, "num_env_steps_trained_throughput_per_sec": 278.5637486516971, "timesteps_total": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 15835.131, "sample_time_ms": 11522.305, "learn_time_ms": 4153.371, "learn_throughput": 963.073, "synch_weights_time_ms": 158.455}, "counters": {"num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "episodes_total": 8496, "training_iteration": 290, "trial_id": "185f8_00000", "date": "2025-03-21_13-02-04", "timestamp": 1742562124, "time_this_iter_s": 14.418571710586548, "time_total_s": 4639.2513382434845, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d6d3910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4639.2513382434845, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 99.555, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.97822093963623, "policy_loss": -0.016764111816883087, "vf_loss": 9.99267578125, "vf_explained_var": 2.2624929840731056e-07, "kl": 0.011542890220880508, "entropy": 0.3794194161891937, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 53723.80694580078, "episode_reward_min": 53723.80694580078, "episode_reward_mean": 53723.80694580078, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53723.80694580078}, "policy_reward_max": {"agent_0": 53723.80694580078}, "policy_reward_mean": {"agent_0": 53723.80694580078}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53723.80694580078], "episode_lengths": [135], "policy_agent_0_reward": [53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.9229292614368, "mean_inference_ms": 6.64796266237173, "mean_action_processing_ms": 0.20071395294951652, "mean_env_wait_ms": 228.2396434178055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029611587524414062, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.13403892517089844}}, "episode_reward_max": 53723.80694580078, "episode_reward_min": 53723.80694580078, "episode_reward_mean": 53723.80694580078, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53723.80694580078}, "policy_reward_max": {"agent_0": 53723.80694580078}, "policy_reward_mean": {"agent_0": 53723.80694580078}, "hist_stats": {"episode_reward": [53723.80694580078], "episode_lengths": [135], "policy_agent_0_reward": [53723.80694580078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.9229292614368, "mean_inference_ms": 6.64796266237173, "mean_action_processing_ms": 0.20071395294951652, "mean_env_wait_ms": 228.2396434178055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029611587524414062, "StateBufferConnector_ms": 0.005269050598144531, "ViewRequirementAgentConnector_ms": 0.13403892517089844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.6151631649036, "num_env_steps_trained_throughput_per_sec": 284.6151631649036, "timesteps_total": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 15771.806, "sample_time_ms": 11425.533, "learn_time_ms": 4182.009, "learn_throughput": 956.478, "synch_weights_time_ms": 163.24}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 8496, "training_iteration": 291, "trial_id": "185f8_00000", "date": "2025-03-21_13-02-18", "timestamp": 1742562138, "time_this_iter_s": 14.113667488098145, "time_total_s": 4653.365005731583, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d6d2f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4653.365005731583, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 99.56, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.893924713134766, "policy_loss": -0.015744218602776527, "vf_loss": 9.907470703125, "vf_explained_var": -6.44599424504122e-07, "kl": 0.010987335816025734, "entropy": 0.40742027759552, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "sampler_results": {"episode_reward_max": 57854.85333251953, "episode_reward_min": 48920.06697559357, "episode_reward_mean": 53490.63435102637, "episode_len_mean": 135.16216216216216, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {"agent_0": 48920.06697559357}, "policy_reward_max": {"agent_0": 57854.85333251953}, "policy_reward_mean": {"agent_0": 53490.63435102637}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57854.85333251953, 52199.53356742859, 53098.20005583763, 52188.4736174345, 53996.12693786621, 55246.55358886719, 54232.513427734375, 49249.79324764013, 53490.25343322754, 54627.92684543133, 54089.78017807007, 54778.306900024414, 55103.75991439819, 50116.706718444824, 48920.06697559357, 54355.16020202637, 54487.526779174805, 52867.2534968853, 55055.48691558838, 54665.580169677734, 53213.020062446594, 56273.793464660645, 55146.10007476807, 55949.44660949707, 53824.740198135376, 51794.2935218811, 54775.4401140213, 56643.38692474365, 50455.32661533356, 53357.54008483887, 53923.37339782715, 53844.98672866821, 52223.54673576355, 52205.086654663086, 56079.520053863525, 49646.5865688324, 49173.42687416077], "episode_lengths": [135, 135, 135, 136, 135, 134, 135, 137, 135, 136, 134, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 134, 135, 134, 136, 136, 135, 136, 135, 135, 136, 135, 134, 136, 135, 136, 136], "policy_agent_0_reward": [57854.85333251953, 52199.53356742859, 53098.20005583763, 52188.4736174345, 53996.12693786621, 55246.55358886719, 54232.513427734375, 49249.79324764013, 53490.25343322754, 54627.92684543133, 54089.78017807007, 54778.306900024414, 55103.75991439819, 50116.706718444824, 48920.06697559357, 54355.16020202637, 54487.526779174805, 52867.2534968853, 55055.48691558838, 54665.580169677734, 53213.020062446594, 56273.793464660645, 55146.10007476807, 55949.44660949707, 53824.740198135376, 51794.2935218811, 54775.4401140213, 56643.38692474365, 50455.32661533356, 53357.54008483887, 53923.37339782715, 53844.98672866821, 52223.54673576355, 52205.086654663086, 56079.520053863525, 49646.5865688324, 49173.42687416077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.01613720686407, "mean_inference_ms": 6.482064840740016, "mean_action_processing_ms": 0.2008138178141938, "mean_env_wait_ms": 213.61879884544888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06467587239033468, "StateBufferConnector_ms": 0.006203393678407412, "ViewRequirementAgentConnector_ms": 0.22962995477624842}}, "episode_reward_max": 57854.85333251953, "episode_reward_min": 48920.06697559357, "episode_reward_mean": 53490.63435102637, "episode_len_mean": 135.16216216216216, "episodes_this_iter": 37, "policy_reward_min": {"agent_0": 48920.06697559357}, "policy_reward_max": {"agent_0": 57854.85333251953}, "policy_reward_mean": {"agent_0": 53490.63435102637}, "hist_stats": {"episode_reward": [57854.85333251953, 52199.53356742859, 53098.20005583763, 52188.4736174345, 53996.12693786621, 55246.55358886719, 54232.513427734375, 49249.79324764013, 53490.25343322754, 54627.92684543133, 54089.78017807007, 54778.306900024414, 55103.75991439819, 50116.706718444824, 48920.06697559357, 54355.16020202637, 54487.526779174805, 52867.2534968853, 55055.48691558838, 54665.580169677734, 53213.020062446594, 56273.793464660645, 55146.10007476807, 55949.44660949707, 53824.740198135376, 51794.2935218811, 54775.4401140213, 56643.38692474365, 50455.32661533356, 53357.54008483887, 53923.37339782715, 53844.98672866821, 52223.54673576355, 52205.086654663086, 56079.520053863525, 49646.5865688324, 49173.42687416077], "episode_lengths": [135, 135, 135, 136, 135, 134, 135, 137, 135, 136, 134, 135, 135, 136, 135, 134, 135, 135, 135, 135, 135, 134, 135, 134, 136, 136, 135, 136, 135, 135, 136, 135, 134, 136, 135, 136, 136], "policy_agent_0_reward": [57854.85333251953, 52199.53356742859, 53098.20005583763, 52188.4736174345, 53996.12693786621, 55246.55358886719, 54232.513427734375, 49249.79324764013, 53490.25343322754, 54627.92684543133, 54089.78017807007, 54778.306900024414, 55103.75991439819, 50116.706718444824, 48920.06697559357, 54355.16020202637, 54487.526779174805, 52867.2534968853, 55055.48691558838, 54665.580169677734, 53213.020062446594, 56273.793464660645, 55146.10007476807, 55949.44660949707, 53824.740198135376, 51794.2935218811, 54775.4401140213, 56643.38692474365, 50455.32661533356, 53357.54008483887, 53923.37339782715, 53844.98672866821, 52223.54673576355, 52205.086654663086, 56079.520053863525, 49646.5865688324, 49173.42687416077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.01613720686407, "mean_inference_ms": 6.482064840740016, "mean_action_processing_ms": 0.2008138178141938, "mean_env_wait_ms": 213.61879884544888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06467587239033468, "StateBufferConnector_ms": 0.006203393678407412, "ViewRequirementAgentConnector_ms": 0.22962995477624842}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.02171648803454, "num_env_steps_trained_throughput_per_sec": 247.02171648803454, "timesteps_total": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 15949.88, "sample_time_ms": 11675.991, "learn_time_ms": 4106.617, "learn_throughput": 974.038, "synch_weights_time_ms": 166.252}, "counters": {"num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "episodes_total": 8533, "training_iteration": 292, "trial_id": "185f8_00000", "date": "2025-03-21_13-02-34", "timestamp": 1742562154, "time_this_iter_s": 16.242289543151855, "time_total_s": 4669.6072952747345, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d6dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4669.6072952747345, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 98.91304347826085, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.770794868469238, "policy_loss": -0.011941713280975819, "vf_loss": 9.781005859375, "vf_explained_var": 1.7136335017653437e-08, "kl": 0.008648606017231941, "entropy": 0.37815678119659424, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "sampler_results": {"episode_reward_max": 57572.32000732422, "episode_reward_min": 45934.17991864681, "episode_reward_mean": 52602.46206571316, "episode_len_mean": 135.22988505747125, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 45934.17991864681}, "policy_reward_max": {"agent_0": 57572.32000732422}, "policy_reward_mean": {"agent_0": 52602.46206571316}, "custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54111.42682266235, 53744.70687198639, 51337.026760458946, 48636.24012756348, 55943.700271606445, 54226.57344818115, 55131.767013549805, 57109.04039001465, 54693.000061035156, 54267.393535614014, 52644.726954460144, 53652.69354248047, 57572.32000732422, 51570.98697280884, 52051.81365776062, 49107.81359767914, 54996.34008598328, 49595.42017555237, 51430.02688884735, 50245.48682975769, 50126.11989784241, 55631.960273742676, 53720.02695465088, 54422.46681976318, 50578.96675777435, 54808.68689727783, 51360.75342690945, 54839.74028778076, 55521.69365692139, 55508.47360229492, 51327.73337459564, 52296.54690170288, 46153.43349123001, 50160.666964530945, 55275.67360687256, 55089.493701934814, 53264.06682682037, 50248.646827697754, 52015.606676101685, 53942.36028575897, 54114.56695270538, 56700.30001831055, 47481.4200053215, 53356.81996154785, 49060.139961481094, 54462.126806259155, 55590.81381607056, 55737.83315849304, 48746.660022735596, 48331.146605968475, 54294.57336807251, 48384.40012216568, 53227.70018005371, 55600.92697811127, 55922.80693054199, 49698.820041656494, 54940.78006744385, 55123.833557128906, 50812.41354942322, 46728.11999332905, 49773.05363559723, 51279.02676200867, 51118.533407211304, 53333.31344604492, 50031.893303871155, 50739.6000790596, 53891.266770362854, 50055.66671657562, 54038.14678955078, 52879.76655578613, 46405.61345434189, 51904.16030502319, 55130.51347351074, 55928.22011947632, 45934.17991864681, 55615.48670196533, 47998.473445892334, 52594.45351982117, 53151.53340435028, 52668.406997680664, 55626.92674255371, 51539.70006942749, 55266.520038604736, 53647.293601989746, 56900.2001991272, 48452.35354232788, 53832.07337188721], "episode_lengths": [135, 135, 136, 136, 135, 135, 135, 134, 135, 136, 136, 135, 134, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 134, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135, 135, 135, 135, 136, 136, 134, 135, 137, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135], "policy_agent_0_reward": [54111.42682266235, 53744.70687198639, 51337.026760458946, 48636.24012756348, 55943.700271606445, 54226.57344818115, 55131.767013549805, 57109.04039001465, 54693.000061035156, 54267.393535614014, 52644.726954460144, 53652.69354248047, 57572.32000732422, 51570.98697280884, 52051.81365776062, 49107.81359767914, 54996.34008598328, 49595.42017555237, 51430.02688884735, 50245.48682975769, 50126.11989784241, 55631.960273742676, 53720.02695465088, 54422.46681976318, 50578.96675777435, 54808.68689727783, 51360.75342690945, 54839.74028778076, 55521.69365692139, 55508.47360229492, 51327.73337459564, 52296.54690170288, 46153.43349123001, 50160.666964530945, 55275.67360687256, 55089.493701934814, 53264.06682682037, 50248.646827697754, 52015.606676101685, 53942.36028575897, 54114.56695270538, 56700.30001831055, 47481.4200053215, 53356.81996154785, 49060.139961481094, 54462.126806259155, 55590.81381607056, 55737.83315849304, 48746.660022735596, 48331.146605968475, 54294.57336807251, 48384.40012216568, 53227.70018005371, 55600.92697811127, 55922.80693054199, 49698.820041656494, 54940.78006744385, 55123.833557128906, 50812.41354942322, 46728.11999332905, 49773.05363559723, 51279.02676200867, 51118.533407211304, 53333.31344604492, 50031.893303871155, 50739.6000790596, 53891.266770362854, 50055.66671657562, 54038.14678955078, 52879.76655578613, 46405.61345434189, 51904.16030502319, 55130.51347351074, 55928.22011947632, 45934.17991864681, 55615.48670196533, 47998.473445892334, 52594.45351982117, 53151.53340435028, 52668.406997680664, 55626.92674255371, 51539.70006942749, 55266.520038604736, 53647.293601989746, 56900.2001991272, 48452.35354232788, 53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.071051825487174, "mean_inference_ms": 6.701217571507677, "mean_action_processing_ms": 0.19892544843245266, "mean_env_wait_ms": 225.64371777719072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06626556659566946, "StateBufferConnector_ms": 0.005982936113730244, "ViewRequirementAgentConnector_ms": 0.26005766857629536}}, "episode_reward_max": 57572.32000732422, "episode_reward_min": 45934.17991864681, "episode_reward_mean": 52602.46206571316, "episode_len_mean": 135.22988505747125, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 45934.17991864681}, "policy_reward_max": {"agent_0": 57572.32000732422}, "policy_reward_mean": {"agent_0": 52602.46206571316}, "hist_stats": {"episode_reward": [54111.42682266235, 53744.70687198639, 51337.026760458946, 48636.24012756348, 55943.700271606445, 54226.57344818115, 55131.767013549805, 57109.04039001465, 54693.000061035156, 54267.393535614014, 52644.726954460144, 53652.69354248047, 57572.32000732422, 51570.98697280884, 52051.81365776062, 49107.81359767914, 54996.34008598328, 49595.42017555237, 51430.02688884735, 50245.48682975769, 50126.11989784241, 55631.960273742676, 53720.02695465088, 54422.46681976318, 50578.96675777435, 54808.68689727783, 51360.75342690945, 54839.74028778076, 55521.69365692139, 55508.47360229492, 51327.73337459564, 52296.54690170288, 46153.43349123001, 50160.666964530945, 55275.67360687256, 55089.493701934814, 53264.06682682037, 50248.646827697754, 52015.606676101685, 53942.36028575897, 54114.56695270538, 56700.30001831055, 47481.4200053215, 53356.81996154785, 49060.139961481094, 54462.126806259155, 55590.81381607056, 55737.83315849304, 48746.660022735596, 48331.146605968475, 54294.57336807251, 48384.40012216568, 53227.70018005371, 55600.92697811127, 55922.80693054199, 49698.820041656494, 54940.78006744385, 55123.833557128906, 50812.41354942322, 46728.11999332905, 49773.05363559723, 51279.02676200867, 51118.533407211304, 53333.31344604492, 50031.893303871155, 50739.6000790596, 53891.266770362854, 50055.66671657562, 54038.14678955078, 52879.76655578613, 46405.61345434189, 51904.16030502319, 55130.51347351074, 55928.22011947632, 45934.17991864681, 55615.48670196533, 47998.473445892334, 52594.45351982117, 53151.53340435028, 52668.406997680664, 55626.92674255371, 51539.70006942749, 55266.520038604736, 53647.293601989746, 56900.2001991272, 48452.35354232788, 53832.07337188721], "episode_lengths": [135, 135, 136, 136, 135, 135, 135, 134, 135, 136, 136, 135, 134, 135, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 135, 136, 135, 135, 134, 135, 135, 135, 136, 135, 135, 136, 135, 135, 135, 134, 135, 135, 135, 135, 136, 136, 134, 135, 137, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 136, 135, 134, 135, 136, 135, 135, 135, 136, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135], "policy_agent_0_reward": [54111.42682266235, 53744.70687198639, 51337.026760458946, 48636.24012756348, 55943.700271606445, 54226.57344818115, 55131.767013549805, 57109.04039001465, 54693.000061035156, 54267.393535614014, 52644.726954460144, 53652.69354248047, 57572.32000732422, 51570.98697280884, 52051.81365776062, 49107.81359767914, 54996.34008598328, 49595.42017555237, 51430.02688884735, 50245.48682975769, 50126.11989784241, 55631.960273742676, 53720.02695465088, 54422.46681976318, 50578.96675777435, 54808.68689727783, 51360.75342690945, 54839.74028778076, 55521.69365692139, 55508.47360229492, 51327.73337459564, 52296.54690170288, 46153.43349123001, 50160.666964530945, 55275.67360687256, 55089.493701934814, 53264.06682682037, 50248.646827697754, 52015.606676101685, 53942.36028575897, 54114.56695270538, 56700.30001831055, 47481.4200053215, 53356.81996154785, 49060.139961481094, 54462.126806259155, 55590.81381607056, 55737.83315849304, 48746.660022735596, 48331.146605968475, 54294.57336807251, 48384.40012216568, 53227.70018005371, 55600.92697811127, 55922.80693054199, 49698.820041656494, 54940.78006744385, 55123.833557128906, 50812.41354942322, 46728.11999332905, 49773.05363559723, 51279.02676200867, 51118.533407211304, 53333.31344604492, 50031.893303871155, 50739.6000790596, 53891.266770362854, 50055.66671657562, 54038.14678955078, 52879.76655578613, 46405.61345434189, 51904.16030502319, 55130.51347351074, 55928.22011947632, 45934.17991864681, 55615.48670196533, 47998.473445892334, 52594.45351982117, 53151.53340435028, 52668.406997680664, 55626.92674255371, 51539.70006942749, 55266.520038604736, 53647.293601989746, 56900.2001991272, 48452.35354232788, 53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.071051825487174, "mean_inference_ms": 6.701217571507677, "mean_action_processing_ms": 0.19892544843245266, "mean_env_wait_ms": 225.64371777719072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06626556659566946, "StateBufferConnector_ms": 0.005982936113730244, "ViewRequirementAgentConnector_ms": 0.26005766857629536}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.64639825850892, "num_env_steps_trained_throughput_per_sec": 199.64639825850892, "timesteps_total": 1172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1172000, "timers": {"training_iteration_time_ms": 16452.004, "sample_time_ms": 12123.85, "learn_time_ms": 4133.184, "learn_throughput": 967.777, "synch_weights_time_ms": 193.926}, "counters": {"num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "done": false, "episodes_total": 8620, "training_iteration": 293, "trial_id": "185f8_00000", "date": "2025-03-21_13-02-55", "timestamp": 1742562175, "time_this_iter_s": 20.131746768951416, "time_total_s": 4689.739042043686, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d6c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4689.739042043686, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 97.08571428571429, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988178253173828, "policy_loss": -0.013376235961914062, "vf_loss": 10.0, "vf_explained_var": 1.1660158349968697e-07, "kl": 0.007772721815854311, "entropy": 0.3451836407184601, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 53832.07337188721, "episode_reward_min": 53832.07337188721, "episode_reward_mean": 53832.07337188721, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53832.07337188721}, "policy_reward_max": {"agent_0": 53832.07337188721}, "policy_reward_mean": {"agent_0": 53832.07337188721}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53832.07337188721], "episode_lengths": [135], "policy_agent_0_reward": [53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.38992278571066, "mean_inference_ms": 6.171033824063496, "mean_action_processing_ms": 0.1968269830219423, "mean_env_wait_ms": 225.8519016502635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.18107891082763672}}, "episode_reward_max": 53832.07337188721, "episode_reward_min": 53832.07337188721, "episode_reward_mean": 53832.07337188721, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53832.07337188721}, "policy_reward_max": {"agent_0": 53832.07337188721}, "policy_reward_mean": {"agent_0": 53832.07337188721}, "hist_stats": {"episode_reward": [53832.07337188721], "episode_lengths": [135], "policy_agent_0_reward": [53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.38992278571066, "mean_inference_ms": 6.171033824063496, "mean_action_processing_ms": 0.1968269830219423, "mean_env_wait_ms": 225.8519016502635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.18107891082763672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.67822212675276, "num_env_steps_trained_throughput_per_sec": 298.67822212675276, "timesteps_total": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 15829.06, "sample_time_ms": 11524.179, "learn_time_ms": 4106.465, "learn_throughput": 974.074, "synch_weights_time_ms": 197.47}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 8620, "training_iteration": 294, "trial_id": "185f8_00000", "date": "2025-03-21_13-03-08", "timestamp": 1742562188, "time_this_iter_s": 13.443751096725464, "time_total_s": 4703.182793140411, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d5090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4703.182793140411, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 99.53157894736843, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983465194702148, "policy_loss": -0.018664594739675522, "vf_loss": 10.0, "vf_explained_var": -1.6602376717855805e-07, "kl": 0.010648343712091446, "entropy": 0.357037216424942, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "sampler_results": {"episode_reward_max": 53832.07337188721, "episode_reward_min": 53832.07337188721, "episode_reward_mean": 53832.07337188721, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53832.07337188721}, "policy_reward_max": {"agent_0": 53832.07337188721}, "policy_reward_mean": {"agent_0": 53832.07337188721}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53832.07337188721], "episode_lengths": [135], "policy_agent_0_reward": [53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.38992278571066, "mean_inference_ms": 6.171033824063496, "mean_action_processing_ms": 0.1968269830219423, "mean_env_wait_ms": 225.8519016502635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.18107891082763672}}, "episode_reward_max": 53832.07337188721, "episode_reward_min": 53832.07337188721, "episode_reward_mean": 53832.07337188721, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53832.07337188721}, "policy_reward_max": {"agent_0": 53832.07337188721}, "policy_reward_mean": {"agent_0": 53832.07337188721}, "hist_stats": {"episode_reward": [53832.07337188721], "episode_lengths": [135], "policy_agent_0_reward": [53832.07337188721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.38992278571066, "mean_inference_ms": 6.171033824063496, "mean_action_processing_ms": 0.1968269830219423, "mean_env_wait_ms": 225.8519016502635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.18107891082763672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.360008116783, "num_env_steps_trained_throughput_per_sec": 273.360008116783, "timesteps_total": 1180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1180000, "timers": {"training_iteration_time_ms": 15828.032, "sample_time_ms": 11528.594, "learn_time_ms": 4104.656, "learn_throughput": 974.503, "synch_weights_time_ms": 193.795}, "counters": {"num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "done": false, "episodes_total": 8620, "training_iteration": 295, "trial_id": "185f8_00000", "date": "2025-03-21_13-03-23", "timestamp": 1742562203, "time_this_iter_s": 14.681337356567383, "time_total_s": 4717.864130496979, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d6c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4717.864130496979, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 99.5095238095238, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906463623046875, "policy_loss": -0.015030751004815102, "vf_loss": 9.91943359375, "vf_explained_var": 3.5576523060854015e-08, "kl": 0.010302159935235977, "entropy": 0.3584643304347992, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "sampler_results": {"episode_reward_max": 57099.5002746582, "episode_reward_min": 46293.466735839844, "episode_reward_mean": 52388.30908543989, "episode_len_mean": 135.375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46293.466735839844}, "policy_reward_max": {"agent_0": 57099.5002746582}, "policy_reward_mean": {"agent_0": 52388.30908543989}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51482.95339143276, 54751.71357727051, 50363.566732406616, 54428.693450927734, 57099.5002746582, 49461.99351119995, 51206.56013870239, 55751.30030822754, 49046.47320842743, 54816.519969940186, 55385.91354370117, 50112.04681015015, 51256.76005411148, 53557.96661901474, 53722.61379432678, 52313.586769104004, 54580.20007324219, 49935.24008560181, 48838.133414268494, 55728.30015563965, 50703.000151634216, 51520.61351394653, 49947.320178985596, 47756.40660858154, 46293.466735839844, 56801.22025299072, 55334.90676116943, 50790.66663169861, 55611.82704162598, 51614.23332595825, 53321.08018875122, 52891.11346054077], "episode_lengths": [136, 135, 136, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 134, 135, 136, 136, 135, 135, 136, 135, 134, 136, 135, 134, 135, 135, 135, 137, 137, 135], "policy_agent_0_reward": [51482.95339143276, 54751.71357727051, 50363.566732406616, 54428.693450927734, 57099.5002746582, 49461.99351119995, 51206.56013870239, 55751.30030822754, 49046.47320842743, 54816.519969940186, 55385.91354370117, 50112.04681015015, 51256.76005411148, 53557.96661901474, 53722.61379432678, 52313.586769104004, 54580.20007324219, 49935.24008560181, 48838.133414268494, 55728.30015563965, 50703.000151634216, 51520.61351394653, 49947.320178985596, 47756.40660858154, 46293.466735839844, 56801.22025299072, 55334.90676116943, 50790.66663169861, 55611.82704162598, 51614.23332595825, 53321.08018875122, 52891.11346054077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.1601779239975, "mean_inference_ms": 6.457791610223657, "mean_action_processing_ms": 0.20111910026409524, "mean_env_wait_ms": 211.572218640963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07406771183013916, "StateBufferConnector_ms": 0.006340444087982178, "ViewRequirementAgentConnector_ms": 0.23259595036506653}}, "episode_reward_max": 57099.5002746582, "episode_reward_min": 46293.466735839844, "episode_reward_mean": 52388.30908543989, "episode_len_mean": 135.375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46293.466735839844}, "policy_reward_max": {"agent_0": 57099.5002746582}, "policy_reward_mean": {"agent_0": 52388.30908543989}, "hist_stats": {"episode_reward": [51482.95339143276, 54751.71357727051, 50363.566732406616, 54428.693450927734, 57099.5002746582, 49461.99351119995, 51206.56013870239, 55751.30030822754, 49046.47320842743, 54816.519969940186, 55385.91354370117, 50112.04681015015, 51256.76005411148, 53557.96661901474, 53722.61379432678, 52313.586769104004, 54580.20007324219, 49935.24008560181, 48838.133414268494, 55728.30015563965, 50703.000151634216, 51520.61351394653, 49947.320178985596, 47756.40660858154, 46293.466735839844, 56801.22025299072, 55334.90676116943, 50790.66663169861, 55611.82704162598, 51614.23332595825, 53321.08018875122, 52891.11346054077], "episode_lengths": [136, 135, 136, 135, 136, 136, 135, 135, 136, 136, 135, 135, 135, 136, 134, 135, 136, 136, 135, 135, 136, 135, 134, 136, 135, 134, 135, 135, 135, 137, 137, 135], "policy_agent_0_reward": [51482.95339143276, 54751.71357727051, 50363.566732406616, 54428.693450927734, 57099.5002746582, 49461.99351119995, 51206.56013870239, 55751.30030822754, 49046.47320842743, 54816.519969940186, 55385.91354370117, 50112.04681015015, 51256.76005411148, 53557.96661901474, 53722.61379432678, 52313.586769104004, 54580.20007324219, 49935.24008560181, 48838.133414268494, 55728.30015563965, 50703.000151634216, 51520.61351394653, 49947.320178985596, 47756.40660858154, 46293.466735839844, 56801.22025299072, 55334.90676116943, 50790.66663169861, 55611.82704162598, 51614.23332595825, 53321.08018875122, 52891.11346054077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.1601779239975, "mean_inference_ms": 6.457791610223657, "mean_action_processing_ms": 0.20111910026409524, "mean_env_wait_ms": 211.572218640963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07406771183013916, "StateBufferConnector_ms": 0.006340444087982178, "ViewRequirementAgentConnector_ms": 0.23259595036506653}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.23067961530234, "num_env_steps_trained_throughput_per_sec": 241.23067961530234, "timesteps_total": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 16102.988, "sample_time_ms": 11815.488, "learn_time_ms": 4092.355, "learn_throughput": 977.432, "synch_weights_time_ms": 194.202}, "counters": {"num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "episodes_total": 8652, "training_iteration": 296, "trial_id": "185f8_00000", "date": "2025-03-21_13-03-40", "timestamp": 1742562220, "time_this_iter_s": 16.64927053451538, "time_total_s": 4734.513401031494, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4734.513401031494, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 99.32608695652173, "ram_util_percent": 13.800000000000004}}
{"custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.756802558898926, "policy_loss": -0.014006288722157478, "vf_loss": 9.769044876098633, "vf_explained_var": 1.5528252106378204e-07, "kl": 0.008820073679089546, "entropy": 0.3455120027065277, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 58311.15344238281, "episode_reward_min": 45391.23998272419, "episode_reward_mean": 53050.87521694018, "episode_len_mean": 135.27173913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45391.23998272419}, "policy_reward_max": {"agent_0": 58311.15344238281}, "policy_reward_mean": {"agent_0": 53050.87521694018}, "custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52885.9534072876, 51695.86709403992, 52231.64685058594, 51685.860036849976, 50402.373678684235, 53266.68025588989, 56011.87335205078, 56966.766929626465, 54878.42687034607, 54698.38007926941, 54335.12003517151, 53531.8332901001, 54382.833351135254, 54963.8801574707, 52789.11357879639, 54764.23350703716, 53382.073303222656, 50418.18021726608, 50067.4800863266, 55439.68006896973, 53015.34693145752, 52637.96681213379, 53277.26010513306, 49156.91993379593, 53089.806858062744, 51105.35350036621, 52803.09367752075, 56860.44004821777, 54898.5267868042, 52526.91342163086, 51684.586906433105, 52349.76032781601, 55736.12683105469, 54052.53347969055, 55248.56664276123, 54606.986936569214, 53357.853355407715, 51447.32019805908, 52378.060203552246, 52353.26671409607, 55298.4733505249, 49693.33359050751, 52638.980083465576, 58311.15344238281, 54171.18048095703, 53330.28703689575, 55434.600160598755, 55048.38661193848, 49270.00685119629, 52169.713233947754, 53328.2537279129, 53700.64681625366, 52446.49994850159, 55298.02698516846, 51963.36697220802, 52397.626708984375, 51022.28003883362, 55361.420166015625, 58100.373710632324, 52292.14672470093, 55757.1598815918, 53564.666915893555, 49745.29371261597, 53134.13340759277, 55435.13335418701, 54036.4733581543, 45391.23998272419, 56214.94653129578, 53966.820137023926, 53212.120178222656, 53700.59348487854, 54230.80682373047, 55216.43338775635, 49079.54012107849, 56229.30029296875, 48973.393500328064, 54738.293449401855, 53227.50031661987, 47168.54675388336, 54362.31336784363, 46450.726991415024, 52667.260290145874, 50012.760182380676, 48912.66024971008, 52260.66666030884, 48966.526737213135, 55529.68695640564, 55150.78016662598, 51357.77324676514, 50699.69358444214, 56184.26008605957, 52441.313386917114], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 134, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 137, 135, 135, 137, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [52885.9534072876, 51695.86709403992, 52231.64685058594, 51685.860036849976, 50402.373678684235, 53266.68025588989, 56011.87335205078, 56966.766929626465, 54878.42687034607, 54698.38007926941, 54335.12003517151, 53531.8332901001, 54382.833351135254, 54963.8801574707, 52789.11357879639, 54764.23350703716, 53382.073303222656, 50418.18021726608, 50067.4800863266, 55439.68006896973, 53015.34693145752, 52637.96681213379, 53277.26010513306, 49156.91993379593, 53089.806858062744, 51105.35350036621, 52803.09367752075, 56860.44004821777, 54898.5267868042, 52526.91342163086, 51684.586906433105, 52349.76032781601, 55736.12683105469, 54052.53347969055, 55248.56664276123, 54606.986936569214, 53357.853355407715, 51447.32019805908, 52378.060203552246, 52353.26671409607, 55298.4733505249, 49693.33359050751, 52638.980083465576, 58311.15344238281, 54171.18048095703, 53330.28703689575, 55434.600160598755, 55048.38661193848, 49270.00685119629, 52169.713233947754, 53328.2537279129, 53700.64681625366, 52446.49994850159, 55298.02698516846, 51963.36697220802, 52397.626708984375, 51022.28003883362, 55361.420166015625, 58100.373710632324, 52292.14672470093, 55757.1598815918, 53564.666915893555, 49745.29371261597, 53134.13340759277, 55435.13335418701, 54036.4733581543, 45391.23998272419, 56214.94653129578, 53966.820137023926, 53212.120178222656, 53700.59348487854, 54230.80682373047, 55216.43338775635, 49079.54012107849, 56229.30029296875, 48973.393500328064, 54738.293449401855, 53227.50031661987, 47168.54675388336, 54362.31336784363, 46450.726991415024, 52667.260290145874, 50012.760182380676, 48912.66024971008, 52260.66666030884, 48966.526737213135, 55529.68695640564, 55150.78016662598, 51357.77324676514, 50699.69358444214, 56184.26008605957, 52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.58119575387809, "mean_inference_ms": 6.6908170444417925, "mean_action_processing_ms": 0.19886825848260456, "mean_env_wait_ms": 225.60608942592728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062249276949011764, "StateBufferConnector_ms": 0.005968498147052267, "ViewRequirementAgentConnector_ms": 0.2002547616543977}}, "episode_reward_max": 58311.15344238281, "episode_reward_min": 45391.23998272419, "episode_reward_mean": 53050.87521694018, "episode_len_mean": 135.27173913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45391.23998272419}, "policy_reward_max": {"agent_0": 58311.15344238281}, "policy_reward_mean": {"agent_0": 53050.87521694018}, "hist_stats": {"episode_reward": [52885.9534072876, 51695.86709403992, 52231.64685058594, 51685.860036849976, 50402.373678684235, 53266.68025588989, 56011.87335205078, 56966.766929626465, 54878.42687034607, 54698.38007926941, 54335.12003517151, 53531.8332901001, 54382.833351135254, 54963.8801574707, 52789.11357879639, 54764.23350703716, 53382.073303222656, 50418.18021726608, 50067.4800863266, 55439.68006896973, 53015.34693145752, 52637.96681213379, 53277.26010513306, 49156.91993379593, 53089.806858062744, 51105.35350036621, 52803.09367752075, 56860.44004821777, 54898.5267868042, 52526.91342163086, 51684.586906433105, 52349.76032781601, 55736.12683105469, 54052.53347969055, 55248.56664276123, 54606.986936569214, 53357.853355407715, 51447.32019805908, 52378.060203552246, 52353.26671409607, 55298.4733505249, 49693.33359050751, 52638.980083465576, 58311.15344238281, 54171.18048095703, 53330.28703689575, 55434.600160598755, 55048.38661193848, 49270.00685119629, 52169.713233947754, 53328.2537279129, 53700.64681625366, 52446.49994850159, 55298.02698516846, 51963.36697220802, 52397.626708984375, 51022.28003883362, 55361.420166015625, 58100.373710632324, 52292.14672470093, 55757.1598815918, 53564.666915893555, 49745.29371261597, 53134.13340759277, 55435.13335418701, 54036.4733581543, 45391.23998272419, 56214.94653129578, 53966.820137023926, 53212.120178222656, 53700.59348487854, 54230.80682373047, 55216.43338775635, 49079.54012107849, 56229.30029296875, 48973.393500328064, 54738.293449401855, 53227.50031661987, 47168.54675388336, 54362.31336784363, 46450.726991415024, 52667.260290145874, 50012.760182380676, 48912.66024971008, 52260.66666030884, 48966.526737213135, 55529.68695640564, 55150.78016662598, 51357.77324676514, 50699.69358444214, 56184.26008605957, 52441.313386917114], "episode_lengths": [135, 135, 135, 136, 136, 135, 135, 135, 134, 134, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 134, 135, 136, 135, 135, 135, 134, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 134, 136, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 136, 136, 135, 135, 135, 135, 136, 135, 136, 135, 137, 135, 135, 137, 135, 135, 136, 135, 135, 135], "policy_agent_0_reward": [52885.9534072876, 51695.86709403992, 52231.64685058594, 51685.860036849976, 50402.373678684235, 53266.68025588989, 56011.87335205078, 56966.766929626465, 54878.42687034607, 54698.38007926941, 54335.12003517151, 53531.8332901001, 54382.833351135254, 54963.8801574707, 52789.11357879639, 54764.23350703716, 53382.073303222656, 50418.18021726608, 50067.4800863266, 55439.68006896973, 53015.34693145752, 52637.96681213379, 53277.26010513306, 49156.91993379593, 53089.806858062744, 51105.35350036621, 52803.09367752075, 56860.44004821777, 54898.5267868042, 52526.91342163086, 51684.586906433105, 52349.76032781601, 55736.12683105469, 54052.53347969055, 55248.56664276123, 54606.986936569214, 53357.853355407715, 51447.32019805908, 52378.060203552246, 52353.26671409607, 55298.4733505249, 49693.33359050751, 52638.980083465576, 58311.15344238281, 54171.18048095703, 53330.28703689575, 55434.600160598755, 55048.38661193848, 49270.00685119629, 52169.713233947754, 53328.2537279129, 53700.64681625366, 52446.49994850159, 55298.02698516846, 51963.36697220802, 52397.626708984375, 51022.28003883362, 55361.420166015625, 58100.373710632324, 52292.14672470093, 55757.1598815918, 53564.666915893555, 49745.29371261597, 53134.13340759277, 55435.13335418701, 54036.4733581543, 45391.23998272419, 56214.94653129578, 53966.820137023926, 53212.120178222656, 53700.59348487854, 54230.80682373047, 55216.43338775635, 49079.54012107849, 56229.30029296875, 48973.393500328064, 54738.293449401855, 53227.50031661987, 47168.54675388336, 54362.31336784363, 46450.726991415024, 52667.260290145874, 50012.760182380676, 48912.66024971008, 52260.66666030884, 48966.526737213135, 55529.68695640564, 55150.78016662598, 51357.77324676514, 50699.69358444214, 56184.26008605957, 52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 41.58119575387809, "mean_inference_ms": 6.6908170444417925, "mean_action_processing_ms": 0.19886825848260456, "mean_env_wait_ms": 225.60608942592728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062249276949011764, "StateBufferConnector_ms": 0.005968498147052267, "ViewRequirementAgentConnector_ms": 0.2002547616543977}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.9901711187751, "num_env_steps_trained_throughput_per_sec": 207.9901711187751, "timesteps_total": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 16645.323, "sample_time_ms": 12365.587, "learn_time_ms": 4084.683, "learn_throughput": 979.268, "synch_weights_time_ms": 194.121}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 8744, "training_iteration": 297, "trial_id": "185f8_00000", "date": "2025-03-21_13-03-59", "timestamp": 1742562239, "time_this_iter_s": 19.296788454055786, "time_total_s": 4753.81018948555, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d6dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4753.81018948555, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 96.23703703703704, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986316680908203, "policy_loss": -0.015771830454468727, "vf_loss": 10.0, "vf_explained_var": -1.7769635007880424e-07, "kl": 0.010443003848195076, "entropy": 0.3179447054862976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "sampler_results": {"episode_reward_max": 52441.313386917114, "episode_reward_min": 52441.313386917114, "episode_reward_mean": 52441.313386917114, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52441.313386917114}, "policy_reward_max": {"agent_0": 52441.313386917114}, "policy_reward_mean": {"agent_0": 52441.313386917114}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52441.313386917114], "episode_lengths": [135], "policy_agent_0_reward": [52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.542948254781415, "mean_inference_ms": 6.169976440622328, "mean_action_processing_ms": 0.19667960041012028, "mean_env_wait_ms": 226.25680102730098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04093647003173828, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17845630645751953}}, "episode_reward_max": 52441.313386917114, "episode_reward_min": 52441.313386917114, "episode_reward_mean": 52441.313386917114, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52441.313386917114}, "policy_reward_max": {"agent_0": 52441.313386917114}, "policy_reward_mean": {"agent_0": 52441.313386917114}, "hist_stats": {"episode_reward": [52441.313386917114], "episode_lengths": [135], "policy_agent_0_reward": [52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.542948254781415, "mean_inference_ms": 6.169976440622328, "mean_action_processing_ms": 0.19667960041012028, "mean_env_wait_ms": 226.25680102730098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04093647003173828, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17845630645751953}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.4533080563188, "num_env_steps_trained_throughput_per_sec": 274.4533080563188, "timesteps_total": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 16301.493, "sample_time_ms": 11951.767, "learn_time_ms": 4148.97, "learn_throughput": 964.095, "synch_weights_time_ms": 199.843}, "counters": {"num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "episodes_total": 8744, "training_iteration": 298, "trial_id": "185f8_00000", "date": "2025-03-21_13-04-14", "timestamp": 1742562254, "time_this_iter_s": 14.626305103302002, "time_total_s": 4768.436494588852, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d76d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4768.436494588852, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 99.535, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987652778625488, "policy_loss": -0.014623564667999744, "vf_loss": 10.0, "vf_explained_var": 6.208816927255612e-08, "kl": 0.01138134766370058, "entropy": 0.35080617666244507, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000}, "sampler_results": {"episode_reward_max": 52441.313386917114, "episode_reward_min": 52441.313386917114, "episode_reward_mean": 52441.313386917114, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52441.313386917114}, "policy_reward_max": {"agent_0": 52441.313386917114}, "policy_reward_mean": {"agent_0": 52441.313386917114}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52441.313386917114], "episode_lengths": [135], "policy_agent_0_reward": [52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.542948254781415, "mean_inference_ms": 6.169976440622328, "mean_action_processing_ms": 0.19667960041012028, "mean_env_wait_ms": 226.25680102730098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04093647003173828, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17845630645751953}}, "episode_reward_max": 52441.313386917114, "episode_reward_min": 52441.313386917114, "episode_reward_mean": 52441.313386917114, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52441.313386917114}, "policy_reward_max": {"agent_0": 52441.313386917114}, "policy_reward_mean": {"agent_0": 52441.313386917114}, "hist_stats": {"episode_reward": [52441.313386917114], "episode_lengths": [135], "policy_agent_0_reward": [52441.313386917114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.542948254781415, "mean_inference_ms": 6.169976440622328, "mean_action_processing_ms": 0.19667960041012028, "mean_env_wait_ms": 226.25680102730098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04093647003173828, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17845630645751953}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000, "num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.5389982232514, "num_env_steps_trained_throughput_per_sec": 274.5389982232514, "timesteps_total": 1196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1196000, "timers": {"training_iteration_time_ms": 15762.377, "sample_time_ms": 11393.167, "learn_time_ms": 4161.389, "learn_throughput": 961.217, "synch_weights_time_ms": 206.895}, "counters": {"num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000}, "done": false, "episodes_total": 8744, "training_iteration": 299, "trial_id": "185f8_00000", "date": "2025-03-21_13-04-28", "timestamp": 1742562268, "time_this_iter_s": 14.636873245239258, "time_total_s": 4783.073367834091, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d65f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4783.073367834091, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 99.5952380952381, "ram_util_percent": 13.800000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91311264038086, "policy_loss": -0.013667939230799675, "vf_loss": 9.925050735473633, "vf_explained_var": 1.038114234575005e-07, "kl": 0.008653013966977596, "entropy": 0.3474721908569336, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 57297.020111083984, "episode_reward_min": 48986.48018074036, "episode_reward_mean": 52965.541490401825, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 48986.48018074036}, "policy_reward_max": {"agent_0": 57297.020111083984}, "policy_reward_mean": {"agent_0": 52965.541490401825}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52838.03364467621, 48986.48018074036, 55410.10012817383, 51115.89352798462, 54667.98037290573, 52689.106649398804, 50664.65349006653, 56263.62693786621, 53152.32035064697, 52729.42664146423, 52955.93325996399, 52500.60009384155, 54588.06703186035, 49164.82009601593, 54610.11362838745, 51840.63347387314, 57297.020111083984, 51735.906661987305, 53069.18660259247, 55825.720138549805, 50128.2066116333, 53354.24697113037, 52233.26672935486, 56329.020223617554, 52189.446868896484, 50566.56029623747, 53840.45371246338, 51236.973348617554, 52097.99343109131, 54884.45349693298], "episode_lengths": [135, 135, 135, 137, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52838.03364467621, 48986.48018074036, 55410.10012817383, 51115.89352798462, 54667.98037290573, 52689.106649398804, 50664.65349006653, 56263.62693786621, 53152.32035064697, 52729.42664146423, 52955.93325996399, 52500.60009384155, 54588.06703186035, 49164.82009601593, 54610.11362838745, 51840.63347387314, 57297.020111083984, 51735.906661987305, 53069.18660259247, 55825.720138549805, 50128.2066116333, 53354.24697113037, 52233.26672935486, 56329.020223617554, 52189.446868896484, 50566.56029623747, 53840.45371246338, 51236.973348617554, 52097.99343109131, 54884.45349693298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.88045026136842, "mean_inference_ms": 6.455984866262322, "mean_action_processing_ms": 0.2006179061605566, "mean_env_wait_ms": 211.41971244846687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05465904871622721, "StateBufferConnector_ms": 0.009378592173258463, "ViewRequirementAgentConnector_ms": 0.24280150731404623}}, "episode_reward_max": 57297.020111083984, "episode_reward_min": 48986.48018074036, "episode_reward_mean": 52965.541490401825, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 48986.48018074036}, "policy_reward_max": {"agent_0": 57297.020111083984}, "policy_reward_mean": {"agent_0": 52965.541490401825}, "hist_stats": {"episode_reward": [52838.03364467621, 48986.48018074036, 55410.10012817383, 51115.89352798462, 54667.98037290573, 52689.106649398804, 50664.65349006653, 56263.62693786621, 53152.32035064697, 52729.42664146423, 52955.93325996399, 52500.60009384155, 54588.06703186035, 49164.82009601593, 54610.11362838745, 51840.63347387314, 57297.020111083984, 51735.906661987305, 53069.18660259247, 55825.720138549805, 50128.2066116333, 53354.24697113037, 52233.26672935486, 56329.020223617554, 52189.446868896484, 50566.56029623747, 53840.45371246338, 51236.973348617554, 52097.99343109131, 54884.45349693298], "episode_lengths": [135, 135, 135, 137, 135, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 135, 136, 135, 135, 135, 136, 135, 135, 136, 136, 135, 136, 136, 135], "policy_agent_0_reward": [52838.03364467621, 48986.48018074036, 55410.10012817383, 51115.89352798462, 54667.98037290573, 52689.106649398804, 50664.65349006653, 56263.62693786621, 53152.32035064697, 52729.42664146423, 52955.93325996399, 52500.60009384155, 54588.06703186035, 49164.82009601593, 54610.11362838745, 51840.63347387314, 57297.020111083984, 51735.906661987305, 53069.18660259247, 55825.720138549805, 50128.2066116333, 53354.24697113037, 52233.26672935486, 56329.020223617554, 52189.446868896484, 50566.56029623747, 53840.45371246338, 51236.973348617554, 52097.99343109131, 54884.45349693298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.88045026136842, "mean_inference_ms": 6.455984866262322, "mean_action_processing_ms": 0.2006179061605566, "mean_env_wait_ms": 211.41971244846687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05465904871622721, "StateBufferConnector_ms": 0.009378592173258463, "ViewRequirementAgentConnector_ms": 0.24280150731404623}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.12527271359465, "num_env_steps_trained_throughput_per_sec": 233.12527271359465, "timesteps_total": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 16042.244, "sample_time_ms": 11718.319, "learn_time_ms": 4116.537, "learn_throughput": 971.69, "synch_weights_time_ms": 206.425}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": true, "episodes_total": 8774, "training_iteration": 300, "trial_id": "185f8_00000", "date": "2025-03-21_13-04-46", "timestamp": 1742562286, "time_this_iter_s": 17.21490240097046, "time_total_s": 4800.288270235062, "pid": 3108052, "hostname": "cx17", "node_ip": "172.20.32.70", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "5000", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f789d7d4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4800.288270235062, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 99.084, "ram_util_percent": 13.800000000000002}}
