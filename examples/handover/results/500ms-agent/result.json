{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985392570495605, "policy_loss": -0.01293884590268135, "vf_loss": 9.995949745178223, "vf_explained_var": -1.2987603668079828e-06, "kl": 0.011907517910003662, "entropy": 1.3746083974838257, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.4397587504785, "num_env_steps_trained_throughput_per_sec": 153.4397587504785, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 26068.807, "sample_time_ms": 22257.051, "learn_time_ms": 3676.125, "learn_throughput": 1088.102, "synch_weights_time_ms": 134.549}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "32397_00000", "date": "2025-03-21_08-37-20", "timestamp": 1742546240, "time_this_iter_s": 26.119994401931763, "time_total_s": 26.119994401931763, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 26.119994401931763, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 94.28684210526315, "ram_util_percent": 13.136842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988543510437012, "policy_loss": -0.011473127640783787, "vf_loss": 9.997559547424316, "vf_explained_var": 5.915698693570448e-06, "kl": 0.01228813361376524, "entropy": 1.344354510307312, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.79314009260503, "num_env_steps_trained_throughput_per_sec": 284.79314009260503, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 20056.968, "sample_time_ms": 16495.738, "learn_time_ms": 3394.129, "learn_throughput": 1178.506, "synch_weights_time_ms": 166.09}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "32397_00000", "date": "2025-03-21_08-37-43", "timestamp": 1742546263, "time_this_iter_s": 14.106489419937134, "time_total_s": 40.2264838218689, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41f30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 40.2264838218689, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 98.9151515151515, "ram_util_percent": 13.275757575757575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984463691711426, "policy_loss": -0.010745333507657051, "vf_loss": 9.992810249328613, "vf_explained_var": 3.6727946280734614e-05, "kl": 0.01199312973767519, "entropy": 1.2981007099151611, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.52525137497014, "num_env_steps_trained_throughput_per_sec": 279.52525137497014, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 18141.283, "sample_time_ms": 14750.455, "learn_time_ms": 3211.379, "learn_throughput": 1245.571, "synch_weights_time_ms": 178.548}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "32397_00000", "date": "2025-03-21_08-37-58", "timestamp": 1742546278, "time_this_iter_s": 14.364981174468994, "time_total_s": 54.59146499633789, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 54.59146499633789, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 99.45238095238098, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 4.0, "num_batches_min": 4, "num_batches_max": 4}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.901175498962402, "policy_loss": -0.014455769211053848, "vf_loss": 9.913305282592773, "vf_explained_var": -5.974620762572158e-06, "kl": 0.011624081060290337, "entropy": 1.2666394710540771, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 42898.239933013916, "episode_reward_min": 31202.05328771472, "episode_reward_mean": 37240.4876398904, "episode_len_mean": 129.82857142857142, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"agent_0": 31202.05328771472}, "policy_reward_max": {"agent_0": 42898.239933013916}, "policy_reward_mean": {"agent_0": 37240.4876398904}, "custom_metrics": {"num_batches_mean": 4.0, "num_batches_min": 4, "num_batches_max": 4}, "hist_stats": {"episode_reward": [41034.62010002136, 37621.680156707764, 36421.90680599213, 35870.94668793678, 32993.186777591705, 36877.3800201416, 32351.513410568237, 36136.706709861755, 38790.80666732788, 42898.239933013916, 31202.05328771472, 38133.78005027771, 37036.64675140381, 37782.6467962265, 35128.0198931694, 41928.086629867554, 36184.25324058533, 32461.9467086792, 38577.793355733156, 35723.87343752384, 36870.99325180054, 41603.886567115784, 34443.060070335865, 32867.83332717419, 35714.34676647186, 42074.15996551514, 41476.35999202728, 35158.04680681229, 36324.1400949955, 39588.88001728058, 38759.49991321564, 38946.76003742218, 39593.90003967285, 40046.95982170105, 34792.15330427885], "episode_lengths": [130, 130, 130, 130, 129, 132, 130, 130, 131, 130, 129, 130, 128, 130, 131, 131, 130, 130, 129, 129, 130, 131, 130, 130, 131, 130, 130, 130, 129, 131, 129, 130, 128, 128, 128], "policy_agent_0_reward": [41034.62010002136, 37621.680156707764, 36421.90680599213, 35870.94668793678, 32993.186777591705, 36877.3800201416, 32351.513410568237, 36136.706709861755, 38790.80666732788, 42898.239933013916, 31202.05328771472, 38133.78005027771, 37036.64675140381, 37782.6467962265, 35128.0198931694, 41928.086629867554, 36184.25324058533, 32461.9467086792, 38577.793355733156, 35723.87343752384, 36870.99325180054, 41603.886567115784, 34443.060070335865, 32867.83332717419, 35714.34676647186, 42074.15996551514, 41476.35999202728, 35158.04680681229, 36324.1400949955, 39588.88001728058, 38759.49991321564, 38946.76003742218, 39593.90003967285, 40046.95982170105, 34792.15330427885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.511057217415585, "mean_inference_ms": 6.46632426690249, "mean_action_processing_ms": 0.20875472446916474, "mean_env_wait_ms": 268.892140917302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04498686109270368, "StateBufferConnector_ms": 0.0069468361990792414, "ViewRequirementAgentConnector_ms": 0.226330075945173}}, "episode_reward_max": 42898.239933013916, "episode_reward_min": 31202.05328771472, "episode_reward_mean": 37240.4876398904, "episode_len_mean": 129.82857142857142, "episodes_this_iter": 35, "policy_reward_min": {"agent_0": 31202.05328771472}, "policy_reward_max": {"agent_0": 42898.239933013916}, "policy_reward_mean": {"agent_0": 37240.4876398904}, "hist_stats": {"episode_reward": [41034.62010002136, 37621.680156707764, 36421.90680599213, 35870.94668793678, 32993.186777591705, 36877.3800201416, 32351.513410568237, 36136.706709861755, 38790.80666732788, 42898.239933013916, 31202.05328771472, 38133.78005027771, 37036.64675140381, 37782.6467962265, 35128.0198931694, 41928.086629867554, 36184.25324058533, 32461.9467086792, 38577.793355733156, 35723.87343752384, 36870.99325180054, 41603.886567115784, 34443.060070335865, 32867.83332717419, 35714.34676647186, 42074.15996551514, 41476.35999202728, 35158.04680681229, 36324.1400949955, 39588.88001728058, 38759.49991321564, 38946.76003742218, 39593.90003967285, 40046.95982170105, 34792.15330427885], "episode_lengths": [130, 130, 130, 130, 129, 132, 130, 130, 131, 130, 129, 130, 128, 130, 131, 131, 130, 130, 129, 129, 130, 131, 130, 130, 131, 130, 130, 130, 129, 131, 129, 130, 128, 128, 128], "policy_agent_0_reward": [41034.62010002136, 37621.680156707764, 36421.90680599213, 35870.94668793678, 32993.186777591705, 36877.3800201416, 32351.513410568237, 36136.706709861755, 38790.80666732788, 42898.239933013916, 31202.05328771472, 38133.78005027771, 37036.64675140381, 37782.6467962265, 35128.0198931694, 41928.086629867554, 36184.25324058533, 32461.9467086792, 38577.793355733156, 35723.87343752384, 36870.99325180054, 41603.886567115784, 34443.060070335865, 32867.83332717419, 35714.34676647186, 42074.15996551514, 41476.35999202728, 35158.04680681229, 36324.1400949955, 39588.88001728058, 38759.49991321564, 38946.76003742218, 39593.90003967285, 40046.95982170105, 34792.15330427885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.511057217415585, "mean_inference_ms": 6.46632426690249, "mean_action_processing_ms": 0.20875472446916474, "mean_env_wait_ms": 268.892140917302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04498686109270368, "StateBufferConnector_ms": 0.0069468361990792414, "ViewRequirementAgentConnector_ms": 0.226330075945173}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6056285530627, "num_env_steps_trained_throughput_per_sec": 309.6056285530627, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 16835.867, "sample_time_ms": 13760.405, "learn_time_ms": 2914.763, "learn_throughput": 1372.324, "synch_weights_time_ms": 159.865}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 35, "training_iteration": 4, "trial_id": "32397_00000", "date": "2025-03-21_08-38-11", "timestamp": 1742546291, "time_this_iter_s": 12.960851669311523, "time_total_s": 67.55231666564941, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e43eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 67.55231666564941, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 95.80588235294118, "ram_util_percent": 13.3}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.752581596374512, "policy_loss": -0.018631892278790474, "vf_loss": 9.768424034118652, "vf_explained_var": -1.82868291176419e-06, "kl": 0.013942146673798561, "entropy": 1.194994568824768, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 44727.34669113159, "episode_reward_min": 31316.220097780228, "episode_reward_mean": 37313.65044469311, "episode_len_mean": 129.98876404494382, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 31316.220097780228}, "policy_reward_max": {"agent_0": 44727.34669113159}, "policy_reward_mean": {"agent_0": 37313.65044469311}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [39629.81336450577, 35422.75336033106, 34390.100078225136, 35608.33345794678, 42688.11343574524, 33651.46669578552, 37398.27988898754, 38007.48007297516, 34120.43332540989, 38310.68676495552, 37315.88010597229, 40734.83997631073, 43411.526671886444, 35955.320125579834, 35645.57342863083, 35477.79333114624, 37427.38003540039, 39661.413392066956, 41495.55984687805, 38604.186563014984, 36978.279973864555, 37688.953391075134, 42154.78672218323, 39004.706707179546, 39725.1867017746, 33658.79321670532, 34591.240089416504, 39437.08665084839, 41067.27341461182, 38928.69333457947, 43653.379943847656, 34520.48666715622, 41792.579921245575, 39578.56658267975, 32701.506635427475, 40219.433455467224, 35722.673334002495, 37776.61991298199, 38355.68008232117, 36518.54658663273, 35011.35348653793, 37190.15333032608, 35414.113471627235, 42872.97325325012, 36095.46011638641, 38302.47333693504, 36307.64004611969, 33329.65326410532, 42739.380084991455, 36777.46665287018, 31626.046740293503, 37095.473402023315, 36786.08001613617, 33179.8067009449, 38944.19338226318, 34769.726843357086, 35531.80018931627, 38135.733417510986, 37340.75327396393, 37660.92001140118, 34871.8666434288, 44727.34669113159, 33431.49339008331, 32862.24004340172, 37400.053460121155, 32667.96003961563, 37699.58659648895, 34861.433540821075, 37344.28676986694, 35529.16003704071, 35055.353383898735, 36702.446743011475, 38989.139945209026, 35556.986598968506, 39202.78010869026, 38028.56676244736, 40178.36015367508, 36826.380140304565, 35613.3798995018, 32071.853378534317, 40102.959918022156, 31316.220097780228, 36824.5867228508, 34845.67999243736, 39852.0533323288, 39745.313420295715, 37354.973343372345, 38986.07345199585, 38123.74670624733], "episode_lengths": [130, 130, 131, 130, 132, 131, 129, 129, 129, 130, 130, 129, 130, 129, 129, 130, 129, 130, 130, 130, 131, 131, 130, 130, 130, 130, 131, 130, 131, 130, 129, 129, 129, 130, 130, 130, 129, 130, 130, 130, 131, 130, 131, 130, 130, 129, 130, 130, 130, 129, 130, 130, 130, 130, 130, 129, 131, 130, 130, 130, 129, 131, 129, 131, 129, 132, 131, 130, 130, 131, 131, 130, 131, 131, 131, 130, 129, 130, 129, 129, 130, 130, 130, 130, 129, 129, 130, 130, 130], "policy_agent_0_reward": [39629.81336450577, 35422.75336033106, 34390.100078225136, 35608.33345794678, 42688.11343574524, 33651.46669578552, 37398.27988898754, 38007.48007297516, 34120.43332540989, 38310.68676495552, 37315.88010597229, 40734.83997631073, 43411.526671886444, 35955.320125579834, 35645.57342863083, 35477.79333114624, 37427.38003540039, 39661.413392066956, 41495.55984687805, 38604.186563014984, 36978.279973864555, 37688.953391075134, 42154.78672218323, 39004.706707179546, 39725.1867017746, 33658.79321670532, 34591.240089416504, 39437.08665084839, 41067.27341461182, 38928.69333457947, 43653.379943847656, 34520.48666715622, 41792.579921245575, 39578.56658267975, 32701.506635427475, 40219.433455467224, 35722.673334002495, 37776.61991298199, 38355.68008232117, 36518.54658663273, 35011.35348653793, 37190.15333032608, 35414.113471627235, 42872.97325325012, 36095.46011638641, 38302.47333693504, 36307.64004611969, 33329.65326410532, 42739.380084991455, 36777.46665287018, 31626.046740293503, 37095.473402023315, 36786.08001613617, 33179.8067009449, 38944.19338226318, 34769.726843357086, 35531.80018931627, 38135.733417510986, 37340.75327396393, 37660.92001140118, 34871.8666434288, 44727.34669113159, 33431.49339008331, 32862.24004340172, 37400.053460121155, 32667.96003961563, 37699.58659648895, 34861.433540821075, 37344.28676986694, 35529.16003704071, 35055.353383898735, 36702.446743011475, 38989.139945209026, 35556.986598968506, 39202.78010869026, 38028.56676244736, 40178.36015367508, 36826.380140304565, 35613.3798995018, 32071.853378534317, 40102.959918022156, 31316.220097780228, 36824.5867228508, 34845.67999243736, 39852.0533323288, 39745.313420295715, 37354.973343372345, 38986.07345199585, 38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.282052549582744, "mean_inference_ms": 6.042302316211342, "mean_action_processing_ms": 0.20293835377658234, "mean_env_wait_ms": 280.3331330762804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06430497330226255, "StateBufferConnector_ms": 0.0069162818822967875, "ViewRequirementAgentConnector_ms": 0.24477069297533358}}, "episode_reward_max": 44727.34669113159, "episode_reward_min": 31316.220097780228, "episode_reward_mean": 37313.65044469311, "episode_len_mean": 129.98876404494382, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 31316.220097780228}, "policy_reward_max": {"agent_0": 44727.34669113159}, "policy_reward_mean": {"agent_0": 37313.65044469311}, "hist_stats": {"episode_reward": [39629.81336450577, 35422.75336033106, 34390.100078225136, 35608.33345794678, 42688.11343574524, 33651.46669578552, 37398.27988898754, 38007.48007297516, 34120.43332540989, 38310.68676495552, 37315.88010597229, 40734.83997631073, 43411.526671886444, 35955.320125579834, 35645.57342863083, 35477.79333114624, 37427.38003540039, 39661.413392066956, 41495.55984687805, 38604.186563014984, 36978.279973864555, 37688.953391075134, 42154.78672218323, 39004.706707179546, 39725.1867017746, 33658.79321670532, 34591.240089416504, 39437.08665084839, 41067.27341461182, 38928.69333457947, 43653.379943847656, 34520.48666715622, 41792.579921245575, 39578.56658267975, 32701.506635427475, 40219.433455467224, 35722.673334002495, 37776.61991298199, 38355.68008232117, 36518.54658663273, 35011.35348653793, 37190.15333032608, 35414.113471627235, 42872.97325325012, 36095.46011638641, 38302.47333693504, 36307.64004611969, 33329.65326410532, 42739.380084991455, 36777.46665287018, 31626.046740293503, 37095.473402023315, 36786.08001613617, 33179.8067009449, 38944.19338226318, 34769.726843357086, 35531.80018931627, 38135.733417510986, 37340.75327396393, 37660.92001140118, 34871.8666434288, 44727.34669113159, 33431.49339008331, 32862.24004340172, 37400.053460121155, 32667.96003961563, 37699.58659648895, 34861.433540821075, 37344.28676986694, 35529.16003704071, 35055.353383898735, 36702.446743011475, 38989.139945209026, 35556.986598968506, 39202.78010869026, 38028.56676244736, 40178.36015367508, 36826.380140304565, 35613.3798995018, 32071.853378534317, 40102.959918022156, 31316.220097780228, 36824.5867228508, 34845.67999243736, 39852.0533323288, 39745.313420295715, 37354.973343372345, 38986.07345199585, 38123.74670624733], "episode_lengths": [130, 130, 131, 130, 132, 131, 129, 129, 129, 130, 130, 129, 130, 129, 129, 130, 129, 130, 130, 130, 131, 131, 130, 130, 130, 130, 131, 130, 131, 130, 129, 129, 129, 130, 130, 130, 129, 130, 130, 130, 131, 130, 131, 130, 130, 129, 130, 130, 130, 129, 130, 130, 130, 130, 130, 129, 131, 130, 130, 130, 129, 131, 129, 131, 129, 132, 131, 130, 130, 131, 131, 130, 131, 131, 131, 130, 129, 130, 129, 129, 130, 130, 130, 130, 129, 129, 130, 130, 130], "policy_agent_0_reward": [39629.81336450577, 35422.75336033106, 34390.100078225136, 35608.33345794678, 42688.11343574524, 33651.46669578552, 37398.27988898754, 38007.48007297516, 34120.43332540989, 38310.68676495552, 37315.88010597229, 40734.83997631073, 43411.526671886444, 35955.320125579834, 35645.57342863083, 35477.79333114624, 37427.38003540039, 39661.413392066956, 41495.55984687805, 38604.186563014984, 36978.279973864555, 37688.953391075134, 42154.78672218323, 39004.706707179546, 39725.1867017746, 33658.79321670532, 34591.240089416504, 39437.08665084839, 41067.27341461182, 38928.69333457947, 43653.379943847656, 34520.48666715622, 41792.579921245575, 39578.56658267975, 32701.506635427475, 40219.433455467224, 35722.673334002495, 37776.61991298199, 38355.68008232117, 36518.54658663273, 35011.35348653793, 37190.15333032608, 35414.113471627235, 42872.97325325012, 36095.46011638641, 38302.47333693504, 36307.64004611969, 33329.65326410532, 42739.380084991455, 36777.46665287018, 31626.046740293503, 37095.473402023315, 36786.08001613617, 33179.8067009449, 38944.19338226318, 34769.726843357086, 35531.80018931627, 38135.733417510986, 37340.75327396393, 37660.92001140118, 34871.8666434288, 44727.34669113159, 33431.49339008331, 32862.24004340172, 37400.053460121155, 32667.96003961563, 37699.58659648895, 34861.433540821075, 37344.28676986694, 35529.16003704071, 35055.353383898735, 36702.446743011475, 38989.139945209026, 35556.986598968506, 39202.78010869026, 38028.56676244736, 40178.36015367508, 36826.380140304565, 35613.3798995018, 32071.853378534317, 40102.959918022156, 31316.220097780228, 36824.5867228508, 34845.67999243736, 39852.0533323288, 39745.313420295715, 37354.973343372345, 38986.07345199585, 38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.282052549582744, "mean_inference_ms": 6.042302316211342, "mean_action_processing_ms": 0.20293835377658234, "mean_env_wait_ms": 280.3331330762804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06430497330226255, "StateBufferConnector_ms": 0.0069162818822967875, "ViewRequirementAgentConnector_ms": 0.24477069297533358}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.94352785424869, "num_env_steps_trained_throughput_per_sec": 232.94352785424869, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 16902.99, "sample_time_ms": 13852.959, "learn_time_ms": 2892.364, "learn_throughput": 1382.952, "synch_weights_time_ms": 156.868}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 124, "training_iteration": 5, "trial_id": "32397_00000", "date": "2025-03-21_08-38-28", "timestamp": 1742546308, "time_this_iter_s": 17.237617254257202, "time_total_s": 84.78993391990662, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b1a15fd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 84.78993391990662, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 96.82083333333333, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986218452453613, "policy_loss": -0.016321666538715363, "vf_loss": 10.0, "vf_explained_var": 2.030221139648347e-06, "kl": 0.012705788016319275, "entropy": 1.1321442127227783, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 38123.74670624733, "episode_reward_min": 38123.74670624733, "episode_reward_mean": 38123.74670624733, "episode_len_mean": 130.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 38123.74670624733}, "policy_reward_max": {"agent_0": 38123.74670624733}, "policy_reward_mean": {"agent_0": 38123.74670624733}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [38123.74670624733], "episode_lengths": [130], "policy_agent_0_reward": [38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.576264150394415, "mean_inference_ms": 6.327553565457741, "mean_action_processing_ms": 0.19207504225073394, "mean_env_wait_ms": 315.3222229169763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16622543334960938}}, "episode_reward_max": 38123.74670624733, "episode_reward_min": 38123.74670624733, "episode_reward_mean": 38123.74670624733, "episode_len_mean": 130.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 38123.74670624733}, "policy_reward_max": {"agent_0": 38123.74670624733}, "policy_reward_mean": {"agent_0": 38123.74670624733}, "hist_stats": {"episode_reward": [38123.74670624733], "episode_lengths": [130], "policy_agent_0_reward": [38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.576264150394415, "mean_inference_ms": 6.327553565457741, "mean_action_processing_ms": 0.19207504225073394, "mean_env_wait_ms": 315.3222229169763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16622543334960938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.1383174293685, "num_env_steps_trained_throughput_per_sec": 290.1383174293685, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16383.574, "sample_time_ms": 13226.135, "learn_time_ms": 3001.657, "learn_throughput": 1332.597, "synch_weights_time_ms": 155.014}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 124, "training_iteration": 6, "trial_id": "32397_00000", "date": "2025-03-21_08-38-42", "timestamp": 1742546322, "time_this_iter_s": 13.849347114562988, "time_total_s": 98.6392810344696, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 98.6392810344696, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 99.64736842105265, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983505249023438, "policy_loss": -0.019125334918498993, "vf_loss": 10.0, "vf_explained_var": -7.17571629138547e-06, "kl": 0.013153048232197762, "entropy": 1.079287052154541, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 38123.74670624733, "episode_reward_min": 38123.74670624733, "episode_reward_mean": 38123.74670624733, "episode_len_mean": 130.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 38123.74670624733}, "policy_reward_max": {"agent_0": 38123.74670624733}, "policy_reward_mean": {"agent_0": 38123.74670624733}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [38123.74670624733], "episode_lengths": [130], "policy_agent_0_reward": [38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.576264150394415, "mean_inference_ms": 6.327553565457741, "mean_action_processing_ms": 0.19207504225073394, "mean_env_wait_ms": 315.3222229169763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16622543334960938}}, "episode_reward_max": 38123.74670624733, "episode_reward_min": 38123.74670624733, "episode_reward_mean": 38123.74670624733, "episode_len_mean": 130.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 38123.74670624733}, "policy_reward_max": {"agent_0": 38123.74670624733}, "policy_reward_mean": {"agent_0": 38123.74670624733}, "hist_stats": {"episode_reward": [38123.74670624733], "episode_lengths": [130], "policy_agent_0_reward": [38123.74670624733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 42.576264150394415, "mean_inference_ms": 6.327553565457741, "mean_action_processing_ms": 0.19207504225073394, "mean_env_wait_ms": 315.3222229169763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.007224082946777344, "ViewRequirementAgentConnector_ms": 0.16622543334960938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.72837222945554, "num_env_steps_trained_throughput_per_sec": 298.72837222945554, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15955.922, "sample_time_ms": 12790.405, "learn_time_ms": 3007.188, "learn_throughput": 1330.146, "synch_weights_time_ms": 157.576}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 124, "training_iteration": 7, "trial_id": "32397_00000", "date": "2025-03-21_08-38-55", "timestamp": 1742546335, "time_this_iter_s": 13.443441152572632, "time_total_s": 112.08272218704224, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 112.08272218704224, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 99.5421052631579, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 4.96875, "num_batches_min": 4, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910845756530762, "policy_loss": -0.011488795280456543, "vf_loss": 9.920449256896973, "vf_explained_var": -5.682930463990488e-07, "kl": 0.009426623582839966, "entropy": 1.083802580833435, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 51345.39342498779, "episode_reward_min": 41037.15999221802, "episode_reward_mean": 45280.754479499534, "episode_len_mean": 130.96875, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 41037.15999221802}, "policy_reward_max": {"agent_0": 51345.39342498779}, "policy_reward_mean": {"agent_0": 45280.754479499534}, "custom_metrics": {"num_batches_mean": 4.96875, "num_batches_min": 4, "num_batches_max": 5}, "hist_stats": {"episode_reward": [46046.76025390625, 44869.10013103485, 47915.39334964752, 43983.38675880432, 43968.366654872894, 45739.64019393921, 48051.62672615051, 45759.58026981354, 41037.15999221802, 45174.146686553955, 41986.406631946564, 45961.31358718872, 47377.94027519226, 42593.36670398712, 48556.339838027954, 46381.48673248291, 48591.40689468384, 42350.45998382568, 46727.41340446472, 42350.32014799118, 42117.34694957733, 42141.99996680021, 49058.740072250366, 41725.280014038086, 46656.45355606079, 48037.5601272583, 45159.95363330841, 46673.15340709686, 51345.39342498779, 41666.88675439358, 43430.9133644104, 45548.84685707092], "episode_lengths": [131, 131, 133, 130, 131, 132, 131, 131, 131, 130, 130, 131, 131, 130, 132, 130, 132, 131, 131, 131, 130, 130, 132, 130, 131, 129, 131, 132, 133, 131, 132, 130], "policy_agent_0_reward": [46046.76025390625, 44869.10013103485, 47915.39334964752, 43983.38675880432, 43968.366654872894, 45739.64019393921, 48051.62672615051, 45759.58026981354, 41037.15999221802, 45174.146686553955, 41986.406631946564, 45961.31358718872, 47377.94027519226, 42593.36670398712, 48556.339838027954, 46381.48673248291, 48591.40689468384, 42350.45998382568, 46727.41340446472, 42350.32014799118, 42117.34694957733, 42141.99996680021, 49058.740072250366, 41725.280014038086, 46656.45355606079, 48037.5601272583, 45159.95363330841, 46673.15340709686, 51345.39342498779, 41666.88675439358, 43430.9133644104, 45548.84685707092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.160138247148046, "mean_inference_ms": 6.415287110040773, "mean_action_processing_ms": 0.20724655884616777, "mean_env_wait_ms": 243.39163649194649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06487220525741577, "StateBufferConnector_ms": 0.007098168134689331, "ViewRequirementAgentConnector_ms": 0.3719694912433624}}, "episode_reward_max": 51345.39342498779, "episode_reward_min": 41037.15999221802, "episode_reward_mean": 45280.754479499534, "episode_len_mean": 130.96875, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 41037.15999221802}, "policy_reward_max": {"agent_0": 51345.39342498779}, "policy_reward_mean": {"agent_0": 45280.754479499534}, "hist_stats": {"episode_reward": [46046.76025390625, 44869.10013103485, 47915.39334964752, 43983.38675880432, 43968.366654872894, 45739.64019393921, 48051.62672615051, 45759.58026981354, 41037.15999221802, 45174.146686553955, 41986.406631946564, 45961.31358718872, 47377.94027519226, 42593.36670398712, 48556.339838027954, 46381.48673248291, 48591.40689468384, 42350.45998382568, 46727.41340446472, 42350.32014799118, 42117.34694957733, 42141.99996680021, 49058.740072250366, 41725.280014038086, 46656.45355606079, 48037.5601272583, 45159.95363330841, 46673.15340709686, 51345.39342498779, 41666.88675439358, 43430.9133644104, 45548.84685707092], "episode_lengths": [131, 131, 133, 130, 131, 132, 131, 131, 131, 130, 130, 131, 131, 130, 132, 130, 132, 131, 131, 131, 130, 130, 132, 130, 131, 129, 131, 132, 133, 131, 132, 130], "policy_agent_0_reward": [46046.76025390625, 44869.10013103485, 47915.39334964752, 43983.38675880432, 43968.366654872894, 45739.64019393921, 48051.62672615051, 45759.58026981354, 41037.15999221802, 45174.146686553955, 41986.406631946564, 45961.31358718872, 47377.94027519226, 42593.36670398712, 48556.339838027954, 46381.48673248291, 48591.40689468384, 42350.45998382568, 46727.41340446472, 42350.32014799118, 42117.34694957733, 42141.99996680021, 49058.740072250366, 41725.280014038086, 46656.45355606079, 48037.5601272583, 45159.95363330841, 46673.15340709686, 51345.39342498779, 41666.88675439358, 43430.9133644104, 45548.84685707092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.160138247148046, "mean_inference_ms": 6.415287110040773, "mean_action_processing_ms": 0.20724655884616777, "mean_env_wait_ms": 243.39163649194649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06487220525741577, "StateBufferConnector_ms": 0.007098168134689331, "ViewRequirementAgentConnector_ms": 0.3719694912433624}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.97870809642336, "num_env_steps_trained_throughput_per_sec": 302.97870809642336, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15611.707, "sample_time_ms": 12474.085, "learn_time_ms": 2980.224, "learn_throughput": 1342.181, "synch_weights_time_ms": 156.624}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 156, "training_iteration": 8, "trial_id": "32397_00000", "date": "2025-03-21_08-39-09", "timestamp": 1742546349, "time_this_iter_s": 13.25983214378357, "time_total_s": 125.3425543308258, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 125.3425543308258, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 99.58421052631579, "ram_util_percent": 13.331578947368422}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75323486328125, "policy_loss": -0.013345216400921345, "vf_loss": 9.764894485473633, "vf_explained_var": 1.3932586284681747e-07, "kl": 0.008426284417510033, "entropy": 1.0317002534866333, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 50902.62000274658, "episode_reward_min": 39434.300161361694, "episode_reward_mean": 45132.823111874255, "episode_len_mean": 131.20652173913044, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 39434.300161361694}, "policy_reward_max": {"agent_0": 50902.62000274658}, "policy_reward_mean": {"agent_0": 45132.823111874255}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48510.51996231079, 44197.27343022823, 45245.21343421936, 45166.18674468994, 47614.30680465698, 44812.240193367004, 48512.366539001465, 46022.52006101608, 44277.24013364315, 49396.94669151306, 44039.89339649677, 46257.21353149414, 47497.833426475525, 45763.706733226776, 46399.62670326233, 42107.006809711456, 45847.933421611786, 39434.300161361694, 45008.35339927673, 43390.41326236725, 44545.43994522095, 47720.97992706299, 45259.32011413574, 44814.713267982006, 45383.06658935547, 42593.11336624622, 50902.62000274658, 42011.16001391411, 45552.41346168518, 45051.04674100876, 43634.193444252014, 46229.75343132019, 46084.95330619812, 46454.24676513672, 43316.85993003845, 46813.16000556946, 43832.63995552063, 42441.980098724365, 49951.11336135864, 47451.35337257385, 49020.100131988525, 44812.713532447815, 47655.28009605408, 45913.12016296387, 42109.666670799255, 48252.42007446289, 46002.20672225952, 47361.24000740051, 43253.626809597015, 44821.22673034668, 43827.38684749603, 42191.96673202515, 48375.86024093628, 43206.90023803711, 45981.9666697979, 45224.16670584679, 43866.80002307892, 47683.660427093506, 44376.673345565796, 41623.38674259186, 44747.30676269531, 46237.52682209015, 44317.15993928909, 41518.14007949829, 44477.59361553192, 44477.35348367691, 41377.58679008484, 45337.68653964996, 42086.01335334778, 46943.59338378906, 47534.98006820679, 46295.34673309326, 43880.366693496704, 45690.92677783966, 41513.253381729126, 39566.74002742767, 44851.33344972134, 41100.38667738438, 48423.32011902332, 48980.48667263985, 46084.02658843994, 40614.19324922562, 40569.83360862732, 45066.88673400879, 46156.43320083618, 45906.2668838501, 46230.18685054779, 42021.37348937988, 41862.07360458374, 48792.6799697876, 44934.899889945984, 49518.180002212524], "episode_lengths": [132, 132, 131, 131, 132, 132, 132, 131, 132, 132, 131, 130, 132, 133, 131, 131, 130, 131, 131, 131, 131, 130, 131, 131, 131, 131, 131, 131, 131, 132, 130, 131, 131, 133, 131, 132, 130, 131, 132, 132, 132, 131, 132, 132, 131, 132, 130, 131, 131, 131, 132, 130, 133, 131, 131, 131, 131, 131, 130, 130, 130, 132, 131, 130, 131, 132, 132, 130, 130, 132, 132, 131, 132, 131, 130, 130, 131, 131, 131, 132, 131, 130, 132, 132, 131, 130, 131, 131, 133, 132, 132, 131], "policy_agent_0_reward": [48510.51996231079, 44197.27343022823, 45245.21343421936, 45166.18674468994, 47614.30680465698, 44812.240193367004, 48512.366539001465, 46022.52006101608, 44277.24013364315, 49396.94669151306, 44039.89339649677, 46257.21353149414, 47497.833426475525, 45763.706733226776, 46399.62670326233, 42107.006809711456, 45847.933421611786, 39434.300161361694, 45008.35339927673, 43390.41326236725, 44545.43994522095, 47720.97992706299, 45259.32011413574, 44814.713267982006, 45383.06658935547, 42593.11336624622, 50902.62000274658, 42011.16001391411, 45552.41346168518, 45051.04674100876, 43634.193444252014, 46229.75343132019, 46084.95330619812, 46454.24676513672, 43316.85993003845, 46813.16000556946, 43832.63995552063, 42441.980098724365, 49951.11336135864, 47451.35337257385, 49020.100131988525, 44812.713532447815, 47655.28009605408, 45913.12016296387, 42109.666670799255, 48252.42007446289, 46002.20672225952, 47361.24000740051, 43253.626809597015, 44821.22673034668, 43827.38684749603, 42191.96673202515, 48375.86024093628, 43206.90023803711, 45981.9666697979, 45224.16670584679, 43866.80002307892, 47683.660427093506, 44376.673345565796, 41623.38674259186, 44747.30676269531, 46237.52682209015, 44317.15993928909, 41518.14007949829, 44477.59361553192, 44477.35348367691, 41377.58679008484, 45337.68653964996, 42086.01335334778, 46943.59338378906, 47534.98006820679, 46295.34673309326, 43880.366693496704, 45690.92677783966, 41513.253381729126, 39566.74002742767, 44851.33344972134, 41100.38667738438, 48423.32011902332, 48980.48667263985, 46084.02658843994, 40614.19324922562, 40569.83360862732, 45066.88673400879, 46156.43320083618, 45906.2668838501, 46230.18685054779, 42021.37348937988, 41862.07360458374, 48792.6799697876, 44934.899889945984, 49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.685933880973117, "mean_inference_ms": 6.6206655377496615, "mean_action_processing_ms": 0.2057638332613146, "mean_env_wait_ms": 256.5285509576363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06710964700450069, "StateBufferConnector_ms": 0.020585889401643173, "ViewRequirementAgentConnector_ms": 0.23893817611362622}}, "episode_reward_max": 50902.62000274658, "episode_reward_min": 39434.300161361694, "episode_reward_mean": 45132.823111874255, "episode_len_mean": 131.20652173913044, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 39434.300161361694}, "policy_reward_max": {"agent_0": 50902.62000274658}, "policy_reward_mean": {"agent_0": 45132.823111874255}, "hist_stats": {"episode_reward": [48510.51996231079, 44197.27343022823, 45245.21343421936, 45166.18674468994, 47614.30680465698, 44812.240193367004, 48512.366539001465, 46022.52006101608, 44277.24013364315, 49396.94669151306, 44039.89339649677, 46257.21353149414, 47497.833426475525, 45763.706733226776, 46399.62670326233, 42107.006809711456, 45847.933421611786, 39434.300161361694, 45008.35339927673, 43390.41326236725, 44545.43994522095, 47720.97992706299, 45259.32011413574, 44814.713267982006, 45383.06658935547, 42593.11336624622, 50902.62000274658, 42011.16001391411, 45552.41346168518, 45051.04674100876, 43634.193444252014, 46229.75343132019, 46084.95330619812, 46454.24676513672, 43316.85993003845, 46813.16000556946, 43832.63995552063, 42441.980098724365, 49951.11336135864, 47451.35337257385, 49020.100131988525, 44812.713532447815, 47655.28009605408, 45913.12016296387, 42109.666670799255, 48252.42007446289, 46002.20672225952, 47361.24000740051, 43253.626809597015, 44821.22673034668, 43827.38684749603, 42191.96673202515, 48375.86024093628, 43206.90023803711, 45981.9666697979, 45224.16670584679, 43866.80002307892, 47683.660427093506, 44376.673345565796, 41623.38674259186, 44747.30676269531, 46237.52682209015, 44317.15993928909, 41518.14007949829, 44477.59361553192, 44477.35348367691, 41377.58679008484, 45337.68653964996, 42086.01335334778, 46943.59338378906, 47534.98006820679, 46295.34673309326, 43880.366693496704, 45690.92677783966, 41513.253381729126, 39566.74002742767, 44851.33344972134, 41100.38667738438, 48423.32011902332, 48980.48667263985, 46084.02658843994, 40614.19324922562, 40569.83360862732, 45066.88673400879, 46156.43320083618, 45906.2668838501, 46230.18685054779, 42021.37348937988, 41862.07360458374, 48792.6799697876, 44934.899889945984, 49518.180002212524], "episode_lengths": [132, 132, 131, 131, 132, 132, 132, 131, 132, 132, 131, 130, 132, 133, 131, 131, 130, 131, 131, 131, 131, 130, 131, 131, 131, 131, 131, 131, 131, 132, 130, 131, 131, 133, 131, 132, 130, 131, 132, 132, 132, 131, 132, 132, 131, 132, 130, 131, 131, 131, 132, 130, 133, 131, 131, 131, 131, 131, 130, 130, 130, 132, 131, 130, 131, 132, 132, 130, 130, 132, 132, 131, 132, 131, 130, 130, 131, 131, 131, 132, 131, 130, 132, 132, 131, 130, 131, 131, 133, 132, 132, 131], "policy_agent_0_reward": [48510.51996231079, 44197.27343022823, 45245.21343421936, 45166.18674468994, 47614.30680465698, 44812.240193367004, 48512.366539001465, 46022.52006101608, 44277.24013364315, 49396.94669151306, 44039.89339649677, 46257.21353149414, 47497.833426475525, 45763.706733226776, 46399.62670326233, 42107.006809711456, 45847.933421611786, 39434.300161361694, 45008.35339927673, 43390.41326236725, 44545.43994522095, 47720.97992706299, 45259.32011413574, 44814.713267982006, 45383.06658935547, 42593.11336624622, 50902.62000274658, 42011.16001391411, 45552.41346168518, 45051.04674100876, 43634.193444252014, 46229.75343132019, 46084.95330619812, 46454.24676513672, 43316.85993003845, 46813.16000556946, 43832.63995552063, 42441.980098724365, 49951.11336135864, 47451.35337257385, 49020.100131988525, 44812.713532447815, 47655.28009605408, 45913.12016296387, 42109.666670799255, 48252.42007446289, 46002.20672225952, 47361.24000740051, 43253.626809597015, 44821.22673034668, 43827.38684749603, 42191.96673202515, 48375.86024093628, 43206.90023803711, 45981.9666697979, 45224.16670584679, 43866.80002307892, 47683.660427093506, 44376.673345565796, 41623.38674259186, 44747.30676269531, 46237.52682209015, 44317.15993928909, 41518.14007949829, 44477.59361553192, 44477.35348367691, 41377.58679008484, 45337.68653964996, 42086.01335334778, 46943.59338378906, 47534.98006820679, 46295.34673309326, 43880.366693496704, 45690.92677783966, 41513.253381729126, 39566.74002742767, 44851.33344972134, 41100.38667738438, 48423.32011902332, 48980.48667263985, 46084.02658843994, 40614.19324922562, 40569.83360862732, 45066.88673400879, 46156.43320083618, 45906.2668838501, 46230.18685054779, 42021.37348937988, 41862.07360458374, 48792.6799697876, 44934.899889945984, 49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.685933880973117, "mean_inference_ms": 6.6206655377496615, "mean_action_processing_ms": 0.2057638332613146, "mean_env_wait_ms": 256.5285509576363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06710964700450069, "StateBufferConnector_ms": 0.020585889401643173, "ViewRequirementAgentConnector_ms": 0.23893817611362622}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.63220637100494, "num_env_steps_trained_throughput_per_sec": 226.63220637100494, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 15838.148, "sample_time_ms": 12711.985, "learn_time_ms": 2971.033, "learn_throughput": 1346.333, "synch_weights_time_ms": 154.352}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 248, "training_iteration": 9, "trial_id": "32397_00000", "date": "2025-03-21_08-39-26", "timestamp": 1742546366, "time_this_iter_s": 17.708895206451416, "time_total_s": 143.05144953727722, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cee680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 143.05144953727722, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 95.01600000000002, "ram_util_percent": 13.38}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986035346984863, "policy_loss": -0.013311282731592655, "vf_loss": 9.99755859375, "vf_explained_var": -2.2016465095475724e-07, "kl": 0.008939188905060291, "entropy": 0.9680813550949097, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 49518.180002212524, "episode_reward_min": 49518.180002212524, "episode_reward_mean": 49518.180002212524, "episode_len_mean": 131.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49518.180002212524}, "policy_reward_max": {"agent_0": 49518.180002212524}, "policy_reward_mean": {"agent_0": 49518.180002212524}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49518.180002212524], "episode_lengths": [131], "policy_agent_0_reward": [49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.712223013379583, "mean_inference_ms": 5.658744528219362, "mean_action_processing_ms": 0.21999435028815353, "mean_env_wait_ms": 268.7506205482879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04839897155761719, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.18858909606933594}}, "episode_reward_max": 49518.180002212524, "episode_reward_min": 49518.180002212524, "episode_reward_mean": 49518.180002212524, "episode_len_mean": 131.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49518.180002212524}, "policy_reward_max": {"agent_0": 49518.180002212524}, "policy_reward_mean": {"agent_0": 49518.180002212524}, "hist_stats": {"episode_reward": [49518.180002212524], "episode_lengths": [131], "policy_agent_0_reward": [49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.712223013379583, "mean_inference_ms": 5.658744528219362, "mean_action_processing_ms": 0.21999435028815353, "mean_env_wait_ms": 268.7506205482879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04839897155761719, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.18858909606933594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.8161520471281, "num_env_steps_trained_throughput_per_sec": 305.8161520471281, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15562.305, "sample_time_ms": 12443.125, "learn_time_ms": 2965.993, "learn_throughput": 1348.621, "synch_weights_time_ms": 152.425}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 248, "training_iteration": 10, "trial_id": "32397_00000", "date": "2025-03-21_08-39-40", "timestamp": 1742546380, "time_this_iter_s": 13.130523920059204, "time_total_s": 156.18197345733643, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 156.18197345733643, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 99.61578947368422, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989396095275879, "policy_loss": -0.012158901430666447, "vf_loss": 10.0, "vf_explained_var": 3.998478348421486e-08, "kl": 0.0077757081016898155, "entropy": 0.9464135766029358, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 49518.180002212524, "episode_reward_min": 49518.180002212524, "episode_reward_mean": 49518.180002212524, "episode_len_mean": 131.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49518.180002212524}, "policy_reward_max": {"agent_0": 49518.180002212524}, "policy_reward_mean": {"agent_0": 49518.180002212524}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49518.180002212524], "episode_lengths": [131], "policy_agent_0_reward": [49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.712223013379583, "mean_inference_ms": 5.658744528219362, "mean_action_processing_ms": 0.21999435028815353, "mean_env_wait_ms": 268.7506205482879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04839897155761719, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.18858909606933594}}, "episode_reward_max": 49518.180002212524, "episode_reward_min": 49518.180002212524, "episode_reward_mean": 49518.180002212524, "episode_len_mean": 131.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49518.180002212524}, "policy_reward_max": {"agent_0": 49518.180002212524}, "policy_reward_mean": {"agent_0": 49518.180002212524}, "hist_stats": {"episode_reward": [49518.180002212524], "episode_lengths": [131], "policy_agent_0_reward": [49518.180002212524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.712223013379583, "mean_inference_ms": 5.658744528219362, "mean_action_processing_ms": 0.21999435028815353, "mean_env_wait_ms": 268.7506205482879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04839897155761719, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.18858909606933594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.0276009805576, "num_env_steps_trained_throughput_per_sec": 314.0276009805576, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14229.191, "sample_time_ms": 11208.088, "learn_time_ms": 2870.56, "learn_throughput": 1393.456, "synch_weights_time_ms": 149.823}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 248, "training_iteration": 11, "trial_id": "32397_00000", "date": "2025-03-21_08-39-53", "timestamp": 1742546393, "time_this_iter_s": 12.781006097793579, "time_total_s": 168.96297955513, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ced900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 168.96297955513, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 99.61111111111111, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.90749740600586, "policy_loss": -0.015732787549495697, "vf_loss": 9.921630859375, "vf_explained_var": -9.623666841207523e-08, "kl": 0.007990176789462566, "entropy": 0.9052273631095886, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 52184.46005630493, "episode_reward_min": 43913.833625912666, "episode_reward_mean": 49330.535439149025, "episode_len_mean": 132.41935483870967, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 43913.833625912666}, "policy_reward_max": {"agent_0": 52184.46005630493}, "policy_reward_mean": {"agent_0": 49330.535439149025}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51306.06000137329, 49877.020235061646, 51986.813524246216, 48382.5934677124, 49831.1002407074, 49278.34691810608, 50840.80029296875, 50550.04029095173, 48215.80670118332, 47523.346945762634, 48373.8135266304, 49949.86021614075, 47147.57341760397, 49200.04028511047, 49278.00657939911, 50831.41347885132, 48141.993534088135, 48870.29344177246, 48075.340270996094, 50354.73341178894, 49121.61346912384, 43913.833625912666, 50343.38673490286, 52184.46005630493, 51719.7000579834, 47142.46020030975, 50634.63353538513, 50066.24699997902, 46623.56692504883, 49903.61363220215, 49578.086596012115], "episode_lengths": [132, 133, 132, 132, 132, 132, 134, 134, 133, 132, 132, 132, 132, 133, 133, 132, 131, 132, 132, 132, 133, 131, 131, 133, 133, 132, 134, 134, 132, 132, 133], "policy_agent_0_reward": [51306.06000137329, 49877.020235061646, 51986.813524246216, 48382.5934677124, 49831.1002407074, 49278.34691810608, 50840.80029296875, 50550.04029095173, 48215.80670118332, 47523.346945762634, 48373.8135266304, 49949.86021614075, 47147.57341760397, 49200.04028511047, 49278.00657939911, 50831.41347885132, 48141.993534088135, 48870.29344177246, 48075.340270996094, 50354.73341178894, 49121.61346912384, 43913.833625912666, 50343.38673490286, 52184.46005630493, 51719.7000579834, 47142.46020030975, 50634.63353538513, 50066.24699997902, 46623.56692504883, 49903.61363220215, 49578.086596012115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.11326916723235, "mean_inference_ms": 6.415799716606336, "mean_action_processing_ms": 0.2112527512376543, "mean_env_wait_ms": 237.21368616791776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05455401635939075, "StateBufferConnector_ms": 0.026309105657762098, "ViewRequirementAgentConnector_ms": 0.2702090048020886}}, "episode_reward_max": 52184.46005630493, "episode_reward_min": 43913.833625912666, "episode_reward_mean": 49330.535439149025, "episode_len_mean": 132.41935483870967, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 43913.833625912666}, "policy_reward_max": {"agent_0": 52184.46005630493}, "policy_reward_mean": {"agent_0": 49330.535439149025}, "hist_stats": {"episode_reward": [51306.06000137329, 49877.020235061646, 51986.813524246216, 48382.5934677124, 49831.1002407074, 49278.34691810608, 50840.80029296875, 50550.04029095173, 48215.80670118332, 47523.346945762634, 48373.8135266304, 49949.86021614075, 47147.57341760397, 49200.04028511047, 49278.00657939911, 50831.41347885132, 48141.993534088135, 48870.29344177246, 48075.340270996094, 50354.73341178894, 49121.61346912384, 43913.833625912666, 50343.38673490286, 52184.46005630493, 51719.7000579834, 47142.46020030975, 50634.63353538513, 50066.24699997902, 46623.56692504883, 49903.61363220215, 49578.086596012115], "episode_lengths": [132, 133, 132, 132, 132, 132, 134, 134, 133, 132, 132, 132, 132, 133, 133, 132, 131, 132, 132, 132, 133, 131, 131, 133, 133, 132, 134, 134, 132, 132, 133], "policy_agent_0_reward": [51306.06000137329, 49877.020235061646, 51986.813524246216, 48382.5934677124, 49831.1002407074, 49278.34691810608, 50840.80029296875, 50550.04029095173, 48215.80670118332, 47523.346945762634, 48373.8135266304, 49949.86021614075, 47147.57341760397, 49200.04028511047, 49278.00657939911, 50831.41347885132, 48141.993534088135, 48870.29344177246, 48075.340270996094, 50354.73341178894, 49121.61346912384, 43913.833625912666, 50343.38673490286, 52184.46005630493, 51719.7000579834, 47142.46020030975, 50634.63353538513, 50066.24699997902, 46623.56692504883, 49903.61363220215, 49578.086596012115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.11326916723235, "mean_inference_ms": 6.415799716606336, "mean_action_processing_ms": 0.2112527512376543, "mean_env_wait_ms": 237.21368616791776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05455401635939075, "StateBufferConnector_ms": 0.026309105657762098, "ViewRequirementAgentConnector_ms": 0.2702090048020886}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.48830267707393, "num_env_steps_trained_throughput_per_sec": 285.48830267707393, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14225.783, "sample_time_ms": 11217.02, "learn_time_ms": 2862.359, "learn_throughput": 1397.449, "synch_weights_time_ms": 145.715}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 279, "training_iteration": 12, "trial_id": "32397_00000", "date": "2025-03-21_08-40-07", "timestamp": 1742546407, "time_this_iter_s": 14.061631917953491, "time_total_s": 183.0246114730835, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 183.0246114730835, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 99.44999999999999, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.750273704528809, "policy_loss": -0.015927810221910477, "vf_loss": 9.764404296875, "vf_explained_var": 2.2593886228605697e-07, "kl": 0.008983691222965717, "entropy": 0.8788922429084778, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 53769.0934753418, "episode_reward_min": 43787.24028110504, "episode_reward_mean": 49448.585714520945, "episode_len_mean": 132.32258064516128, "episode_media": {}, "episodes_this_iter": 93, "policy_reward_min": {"agent_0": 43787.24028110504}, "policy_reward_max": {"agent_0": 53769.0934753418}, "policy_reward_mean": {"agent_0": 49448.585714520945}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48083.66681957245, 50856.413663864136, 48893.65344333649, 50650.87343978882, 47831.746890068054, 52583.293469429016, 48997.97357368469, 50366.28014445305, 48437.28684043884, 51392.22678756714, 49843.58014297485, 48261.52667808533, 48675.37351131439, 51715.10000014305, 48406.473331451416, 48280.393315792084, 46962.27341461182, 49084.09331321716, 46341.79348897934, 48857.02666139603, 47963.80658340454, 48063.72669029236, 49135.62000083923, 51539.353271484375, 48175.020205020905, 46694.246797561646, 49730.253465652466, 48338.013468921185, 50648.746826171875, 52266.020091056824, 48585.62016296387, 49408.586966753006, 50523.06670284271, 51398.21350193024, 51309.886779785156, 45968.659994125366, 44811.84003448486, 51316.20020020008, 50716.05368232727, 49995.55348587036, 48679.420097351074, 53084.66024017334, 48186.04023742676, 49733.52651023865, 52609.82034111023, 50671.55336046219, 47422.92003631592, 48936.91339111328, 50738.80675125122, 52886.5001373291, 51451.213371276855, 48163.06684112549, 50072.673444747925, 50766.973742723465, 49336.21374511719, 52922.639976501465, 52779.64682388306, 50145.76696586609, 52650.06020736694, 48670.2468996048, 49442.24028301239, 47973.34672355652, 47979.83346939087, 49946.98697280884, 49711.346618652344, 48505.34664726257, 43787.24028110504, 51064.30675506592, 47489.00695800781, 48866.28682231903, 47248.30000114441, 47595.126908779144, 49109.11340022087, 48481.98651885986, 53769.0934753418, 49731.59335708618, 47490.63352108002, 51102.28685760498, 46240.44690799713, 48554.946743011475, 51310.300075531006, 50960.480140686035, 47677.020167827606, 52379.840213775635, 48774.820095062256, 47266.34672546387, 48200.913469314575, 51672.48645401001, 48540.773263931274, 49222.74026298523, 49890.31346464157, 49520.720167160034, 48194.04676491022], "episode_lengths": [133, 133, 132, 132, 133, 134, 132, 133, 133, 133, 132, 132, 131, 134, 132, 131, 132, 131, 131, 132, 132, 132, 132, 133, 132, 131, 133, 132, 132, 133, 132, 132, 132, 131, 133, 132, 132, 132, 133, 132, 133, 134, 133, 132, 133, 134, 132, 132, 131, 133, 132, 132, 132, 133, 132, 134, 132, 133, 133, 130, 133, 132, 133, 134, 131, 131, 131, 132, 132, 132, 131, 132, 132, 131, 133, 134, 133, 133, 133, 132, 133, 133, 132, 134, 132, 132, 130, 132, 133, 133, 132, 133, 133], "policy_agent_0_reward": [48083.66681957245, 50856.413663864136, 48893.65344333649, 50650.87343978882, 47831.746890068054, 52583.293469429016, 48997.97357368469, 50366.28014445305, 48437.28684043884, 51392.22678756714, 49843.58014297485, 48261.52667808533, 48675.37351131439, 51715.10000014305, 48406.473331451416, 48280.393315792084, 46962.27341461182, 49084.09331321716, 46341.79348897934, 48857.02666139603, 47963.80658340454, 48063.72669029236, 49135.62000083923, 51539.353271484375, 48175.020205020905, 46694.246797561646, 49730.253465652466, 48338.013468921185, 50648.746826171875, 52266.020091056824, 48585.62016296387, 49408.586966753006, 50523.06670284271, 51398.21350193024, 51309.886779785156, 45968.659994125366, 44811.84003448486, 51316.20020020008, 50716.05368232727, 49995.55348587036, 48679.420097351074, 53084.66024017334, 48186.04023742676, 49733.52651023865, 52609.82034111023, 50671.55336046219, 47422.92003631592, 48936.91339111328, 50738.80675125122, 52886.5001373291, 51451.213371276855, 48163.06684112549, 50072.673444747925, 50766.973742723465, 49336.21374511719, 52922.639976501465, 52779.64682388306, 50145.76696586609, 52650.06020736694, 48670.2468996048, 49442.24028301239, 47973.34672355652, 47979.83346939087, 49946.98697280884, 49711.346618652344, 48505.34664726257, 43787.24028110504, 51064.30675506592, 47489.00695800781, 48866.28682231903, 47248.30000114441, 47595.126908779144, 49109.11340022087, 48481.98651885986, 53769.0934753418, 49731.59335708618, 47490.63352108002, 51102.28685760498, 46240.44690799713, 48554.946743011475, 51310.300075531006, 50960.480140686035, 47677.020167827606, 52379.840213775635, 48774.820095062256, 47266.34672546387, 48200.913469314575, 51672.48645401001, 48540.773263931274, 49222.74026298523, 49890.31346464157, 49520.720167160034, 48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.3081456932841, "mean_inference_ms": 6.7724289040046095, "mean_action_processing_ms": 0.20447807540973661, "mean_env_wait_ms": 246.2071810489527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04383697304674374, "StateBufferConnector_ms": 0.007266639381326655, "ViewRequirementAgentConnector_ms": 0.24224635093442856}}, "episode_reward_max": 53769.0934753418, "episode_reward_min": 43787.24028110504, "episode_reward_mean": 49448.585714520945, "episode_len_mean": 132.32258064516128, "episodes_this_iter": 93, "policy_reward_min": {"agent_0": 43787.24028110504}, "policy_reward_max": {"agent_0": 53769.0934753418}, "policy_reward_mean": {"agent_0": 49448.585714520945}, "hist_stats": {"episode_reward": [48083.66681957245, 50856.413663864136, 48893.65344333649, 50650.87343978882, 47831.746890068054, 52583.293469429016, 48997.97357368469, 50366.28014445305, 48437.28684043884, 51392.22678756714, 49843.58014297485, 48261.52667808533, 48675.37351131439, 51715.10000014305, 48406.473331451416, 48280.393315792084, 46962.27341461182, 49084.09331321716, 46341.79348897934, 48857.02666139603, 47963.80658340454, 48063.72669029236, 49135.62000083923, 51539.353271484375, 48175.020205020905, 46694.246797561646, 49730.253465652466, 48338.013468921185, 50648.746826171875, 52266.020091056824, 48585.62016296387, 49408.586966753006, 50523.06670284271, 51398.21350193024, 51309.886779785156, 45968.659994125366, 44811.84003448486, 51316.20020020008, 50716.05368232727, 49995.55348587036, 48679.420097351074, 53084.66024017334, 48186.04023742676, 49733.52651023865, 52609.82034111023, 50671.55336046219, 47422.92003631592, 48936.91339111328, 50738.80675125122, 52886.5001373291, 51451.213371276855, 48163.06684112549, 50072.673444747925, 50766.973742723465, 49336.21374511719, 52922.639976501465, 52779.64682388306, 50145.76696586609, 52650.06020736694, 48670.2468996048, 49442.24028301239, 47973.34672355652, 47979.83346939087, 49946.98697280884, 49711.346618652344, 48505.34664726257, 43787.24028110504, 51064.30675506592, 47489.00695800781, 48866.28682231903, 47248.30000114441, 47595.126908779144, 49109.11340022087, 48481.98651885986, 53769.0934753418, 49731.59335708618, 47490.63352108002, 51102.28685760498, 46240.44690799713, 48554.946743011475, 51310.300075531006, 50960.480140686035, 47677.020167827606, 52379.840213775635, 48774.820095062256, 47266.34672546387, 48200.913469314575, 51672.48645401001, 48540.773263931274, 49222.74026298523, 49890.31346464157, 49520.720167160034, 48194.04676491022], "episode_lengths": [133, 133, 132, 132, 133, 134, 132, 133, 133, 133, 132, 132, 131, 134, 132, 131, 132, 131, 131, 132, 132, 132, 132, 133, 132, 131, 133, 132, 132, 133, 132, 132, 132, 131, 133, 132, 132, 132, 133, 132, 133, 134, 133, 132, 133, 134, 132, 132, 131, 133, 132, 132, 132, 133, 132, 134, 132, 133, 133, 130, 133, 132, 133, 134, 131, 131, 131, 132, 132, 132, 131, 132, 132, 131, 133, 134, 133, 133, 133, 132, 133, 133, 132, 134, 132, 132, 130, 132, 133, 133, 132, 133, 133], "policy_agent_0_reward": [48083.66681957245, 50856.413663864136, 48893.65344333649, 50650.87343978882, 47831.746890068054, 52583.293469429016, 48997.97357368469, 50366.28014445305, 48437.28684043884, 51392.22678756714, 49843.58014297485, 48261.52667808533, 48675.37351131439, 51715.10000014305, 48406.473331451416, 48280.393315792084, 46962.27341461182, 49084.09331321716, 46341.79348897934, 48857.02666139603, 47963.80658340454, 48063.72669029236, 49135.62000083923, 51539.353271484375, 48175.020205020905, 46694.246797561646, 49730.253465652466, 48338.013468921185, 50648.746826171875, 52266.020091056824, 48585.62016296387, 49408.586966753006, 50523.06670284271, 51398.21350193024, 51309.886779785156, 45968.659994125366, 44811.84003448486, 51316.20020020008, 50716.05368232727, 49995.55348587036, 48679.420097351074, 53084.66024017334, 48186.04023742676, 49733.52651023865, 52609.82034111023, 50671.55336046219, 47422.92003631592, 48936.91339111328, 50738.80675125122, 52886.5001373291, 51451.213371276855, 48163.06684112549, 50072.673444747925, 50766.973742723465, 49336.21374511719, 52922.639976501465, 52779.64682388306, 50145.76696586609, 52650.06020736694, 48670.2468996048, 49442.24028301239, 47973.34672355652, 47979.83346939087, 49946.98697280884, 49711.346618652344, 48505.34664726257, 43787.24028110504, 51064.30675506592, 47489.00695800781, 48866.28682231903, 47248.30000114441, 47595.126908779144, 49109.11340022087, 48481.98651885986, 53769.0934753418, 49731.59335708618, 47490.63352108002, 51102.28685760498, 46240.44690799713, 48554.946743011475, 51310.300075531006, 50960.480140686035, 47677.020167827606, 52379.840213775635, 48774.820095062256, 47266.34672546387, 48200.913469314575, 51672.48645401001, 48540.773263931274, 49222.74026298523, 49890.31346464157, 49520.720167160034, 48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.3081456932841, "mean_inference_ms": 6.7724289040046095, "mean_action_processing_ms": 0.20447807540973661, "mean_env_wait_ms": 246.2071810489527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04383697304674374, "StateBufferConnector_ms": 0.007266639381326655, "ViewRequirementAgentConnector_ms": 0.24224635093442856}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.03945563562357, "num_env_steps_trained_throughput_per_sec": 235.03945563562357, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14496.627, "sample_time_ms": 11481.255, "learn_time_ms": 2868.863, "learn_throughput": 1394.28, "synch_weights_time_ms": 145.822}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 372, "training_iteration": 13, "trial_id": "32397_00000", "date": "2025-03-21_08-40-24", "timestamp": 1742546424, "time_this_iter_s": 17.080037832260132, "time_total_s": 200.10464930534363, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e43eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 200.10464930534363, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 95.43043478260869, "ram_util_percent": 13.386956521739126}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988780975341797, "policy_loss": -0.0127480523660779, "vf_loss": 10.0, "vf_explained_var": -1.1449058945345314e-07, "kl": 0.007643485441803932, "entropy": 0.8317393660545349, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 48194.04676491022, "episode_reward_min": 48194.04676491022, "episode_reward_mean": 48194.04676491022, "episode_len_mean": 133.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48194.04676491022}, "policy_reward_max": {"agent_0": 48194.04676491022}, "policy_reward_mean": {"agent_0": 48194.04676491022}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48194.04676491022], "episode_lengths": [133], "policy_agent_0_reward": [48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.426509038435757, "mean_inference_ms": 5.953891100071603, "mean_action_processing_ms": 0.21138522836515944, "mean_env_wait_ms": 253.29715628132263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.16388893127441406}}, "episode_reward_max": 48194.04676491022, "episode_reward_min": 48194.04676491022, "episode_reward_mean": 48194.04676491022, "episode_len_mean": 133.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48194.04676491022}, "policy_reward_max": {"agent_0": 48194.04676491022}, "policy_reward_mean": {"agent_0": 48194.04676491022}, "hist_stats": {"episode_reward": [48194.04676491022], "episode_lengths": [133], "policy_agent_0_reward": [48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.426509038435757, "mean_inference_ms": 5.953891100071603, "mean_action_processing_ms": 0.21138522836515944, "mean_env_wait_ms": 253.29715628132263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.16388893127441406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2803495151143, "num_env_steps_trained_throughput_per_sec": 297.2803495151143, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14550.192, "sample_time_ms": 11416.453, "learn_time_ms": 2980.834, "learn_throughput": 1341.906, "synch_weights_time_ms": 152.217}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 372, "training_iteration": 14, "trial_id": "32397_00000", "date": "2025-03-21_08-40-38", "timestamp": 1742546438, "time_this_iter_s": 13.519772052764893, "time_total_s": 213.62442135810852, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 213.62442135810852, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 99.66842105263159, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9879732131958, "policy_loss": -0.013375425711274147, "vf_loss": 10.0, "vf_explained_var": 1.3367584017487388e-07, "kl": 0.006743806414306164, "entropy": 0.8114919662475586, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 48194.04676491022, "episode_reward_min": 48194.04676491022, "episode_reward_mean": 48194.04676491022, "episode_len_mean": 133.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48194.04676491022}, "policy_reward_max": {"agent_0": 48194.04676491022}, "policy_reward_mean": {"agent_0": 48194.04676491022}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48194.04676491022], "episode_lengths": [133], "policy_agent_0_reward": [48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.426509038435757, "mean_inference_ms": 5.953891100071603, "mean_action_processing_ms": 0.21138522836515944, "mean_env_wait_ms": 253.29715628132263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.16388893127441406}}, "episode_reward_max": 48194.04676491022, "episode_reward_min": 48194.04676491022, "episode_reward_mean": 48194.04676491022, "episode_len_mean": 133.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 48194.04676491022}, "policy_reward_max": {"agent_0": 48194.04676491022}, "policy_reward_mean": {"agent_0": 48194.04676491022}, "hist_stats": {"episode_reward": [48194.04676491022], "episode_lengths": [133], "policy_agent_0_reward": [48194.04676491022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.426509038435757, "mean_inference_ms": 5.953891100071603, "mean_action_processing_ms": 0.21138522836515944, "mean_env_wait_ms": 253.29715628132263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.006461143493652344, "ViewRequirementAgentConnector_ms": 0.16388893127441406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.2431302520437, "num_env_steps_trained_throughput_per_sec": 310.2431302520437, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14122.35, "sample_time_ms": 10982.891, "learn_time_ms": 2990.679, "learn_throughput": 1337.489, "synch_weights_time_ms": 148.086}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 372, "training_iteration": 15, "trial_id": "32397_00000", "date": "2025-03-21_08-40-50", "timestamp": 1742546450, "time_this_iter_s": 12.941853046417236, "time_total_s": 226.56627440452576, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbc1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 226.56627440452576, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 99.56842105263159, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 4.961538461538462, "num_batches_min": 4, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.921509742736816, "policy_loss": -0.014427700079977512, "vf_loss": 9.934326171875, "vf_explained_var": -5.4016709327697754e-08, "kl": 0.008053328841924667, "entropy": 0.8032483458518982, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 54101.72032165527, "episode_reward_min": 48646.66695213318, "episode_reward_mean": 51894.7450298048, "episode_len_mean": 133.34615384615384, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 48646.66695213318}, "policy_reward_max": {"agent_0": 54101.72032165527}, "policy_reward_mean": {"agent_0": 51894.7450298048}, "custom_metrics": {"num_batches_mean": 4.961538461538462, "num_batches_min": 4, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49502.59328460693, 52027.66673660278, 49969.367067337036, 52898.76675415039, 49917.02665472031, 52100.00682640076, 51495.11999320984, 52398.71359825134, 50556.10660171509, 53683.12692070007, 50344.806926727295, 53044.16000366211, 52155.72029495239, 53629.5669593811, 53260.15351486206, 53964.22685337067, 50884.780356407166, 53450.60673618317, 54101.72032165527, 50372.53356838226, 53823.60659509897, 48646.66695213318, 51221.9669342041, 49996.51344871521, 52387.18009185791, 53430.66677963734], "episode_lengths": [132, 134, 133, 134, 133, 133, 132, 133, 133, 134, 134, 134, 133, 134, 134, 133, 133, 134, 134, 133, 134, 133, 133, 132, 133, 135], "policy_agent_0_reward": [49502.59328460693, 52027.66673660278, 49969.367067337036, 52898.76675415039, 49917.02665472031, 52100.00682640076, 51495.11999320984, 52398.71359825134, 50556.10660171509, 53683.12692070007, 50344.806926727295, 53044.16000366211, 52155.72029495239, 53629.5669593811, 53260.15351486206, 53964.22685337067, 50884.780356407166, 53450.60673618317, 54101.72032165527, 50372.53356838226, 53823.60659509897, 48646.66695213318, 51221.9669342041, 49996.51344871521, 52387.18009185791, 53430.66677963734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.457121433725671, "mean_inference_ms": 6.371126283093977, "mean_action_processing_ms": 0.21044672688235547, "mean_env_wait_ms": 232.27751053955313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1040963026193472, "StateBufferConnector_ms": 0.006971909449650691, "ViewRequirementAgentConnector_ms": 0.25344536854670596}}, "episode_reward_max": 54101.72032165527, "episode_reward_min": 48646.66695213318, "episode_reward_mean": 51894.7450298048, "episode_len_mean": 133.34615384615384, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 48646.66695213318}, "policy_reward_max": {"agent_0": 54101.72032165527}, "policy_reward_mean": {"agent_0": 51894.7450298048}, "hist_stats": {"episode_reward": [49502.59328460693, 52027.66673660278, 49969.367067337036, 52898.76675415039, 49917.02665472031, 52100.00682640076, 51495.11999320984, 52398.71359825134, 50556.10660171509, 53683.12692070007, 50344.806926727295, 53044.16000366211, 52155.72029495239, 53629.5669593811, 53260.15351486206, 53964.22685337067, 50884.780356407166, 53450.60673618317, 54101.72032165527, 50372.53356838226, 53823.60659509897, 48646.66695213318, 51221.9669342041, 49996.51344871521, 52387.18009185791, 53430.66677963734], "episode_lengths": [132, 134, 133, 134, 133, 133, 132, 133, 133, 134, 134, 134, 133, 134, 134, 133, 133, 134, 134, 133, 134, 133, 133, 132, 133, 135], "policy_agent_0_reward": [49502.59328460693, 52027.66673660278, 49969.367067337036, 52898.76675415039, 49917.02665472031, 52100.00682640076, 51495.11999320984, 52398.71359825134, 50556.10660171509, 53683.12692070007, 50344.806926727295, 53044.16000366211, 52155.72029495239, 53629.5669593811, 53260.15351486206, 53964.22685337067, 50884.780356407166, 53450.60673618317, 54101.72032165527, 50372.53356838226, 53823.60659509897, 48646.66695213318, 51221.9669342041, 49996.51344871521, 52387.18009185791, 53430.66677963734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.457121433725671, "mean_inference_ms": 6.371126283093977, "mean_action_processing_ms": 0.21044672688235547, "mean_env_wait_ms": 232.27751053955313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1040963026193472, "StateBufferConnector_ms": 0.006971909449650691, "ViewRequirementAgentConnector_ms": 0.25344536854670596}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.5851893772793, "num_env_steps_trained_throughput_per_sec": 294.5851893772793, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14101.534, "sample_time_ms": 11076.527, "learn_time_ms": 2876.858, "learn_throughput": 1390.406, "synch_weights_time_ms": 147.444}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 398, "training_iteration": 16, "trial_id": "32397_00000", "date": "2025-03-21_08-41-04", "timestamp": 1742546464, "time_this_iter_s": 13.627874374389648, "time_total_s": 240.1941487789154, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cee680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 240.1941487789154, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 98.99473684210525, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.020408163265306, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.740029335021973, "policy_loss": -0.016698259860277176, "vf_loss": 9.754639625549316, "vf_explained_var": -1.794348136741064e-08, "kl": 0.010434665717184544, "entropy": 0.7495095133781433, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 56638.666999816895, "episode_reward_min": 46048.433364868164, "episode_reward_mean": 51921.32686414038, "episode_len_mean": 133.3673469387755, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {"agent_0": 46048.433364868164}, "policy_reward_max": {"agent_0": 56638.666999816895}, "policy_reward_mean": {"agent_0": 51921.32686414038}, "custom_metrics": {"num_batches_mean": 5.020408163265306, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51910.61354827881, 53231.13350772858, 51233.72687339783, 55306.04012966156, 50705.35333824158, 52081.25334262848, 52210.31336593628, 51167.01996707916, 55058.87368774414, 52656.960220336914, 55643.766677856445, 51214.81345272064, 49008.60002422333, 50883.54006576538, 48795.83358621597, 53346.840282440186, 50910.63365459442, 50754.833404541016, 56638.666999816895, 51825.82671356201, 52013.47355937958, 50320.83368206024, 50909.75327682495, 51115.90019893646, 53782.080154418945, 50381.36013793945, 49553.526825904846, 52015.773345947266, 50078.78668308258, 53350.98022079468, 51052.46693944931, 53273.38005447388, 51621.140268325806, 50238.89337730408, 56154.14028930664, 51764.6668548584, 55354.213455200195, 52154.800256729126, 49511.8936252594, 52000.673460006714, 52767.100286483765, 47202.933331012726, 50641.69350814819, 53000.47351837158, 53793.56686282158, 52376.72022151947, 52419.220207214355, 49765.0668296814, 53472.60671234131, 50157.326835632324, 54989.72023010254, 54262.96681976318, 53096.06011199951, 53957.313694000244, 51989.36672782898, 52560.87999725342, 51594.02675771713, 49462.65325176716, 49111.013441085815, 52332.666648864746, 50401.839893341064, 52949.40669631958, 53724.440172195435, 46048.433364868164, 53344.28664803505, 54983.84688806534, 50546.96686267853, 51923.679971694946, 51860.76647090912, 52686.506747722626, 54716.29342842102, 49520.57353210449, 52451.3000869751, 50482.380058288574, 51642.12676358223, 51608.32667207718, 54009.186727523804, 52451.79355049133, 52166.75353264809, 50995.00681114197, 53808.29343223572, 53175.61336135864, 52139.83347606659, 52009.766830444336, 52637.33355140686, 48742.72013759613, 52957.88026428223, 53053.00031661987, 48956.973229408264, 50086.68023312092, 51507.30684185028, 52056.21992111206, 47741.27346038818, 53831.36666536331, 50692.95365524292, 51799.03340220451, 53430.07341384888, 50963.04011154175], "episode_lengths": [133, 134, 134, 135, 133, 133, 134, 133, 134, 133, 134, 134, 132, 131, 132, 135, 133, 132, 135, 134, 134, 134, 133, 134, 133, 134, 133, 132, 133, 133, 132, 134, 132, 133, 135, 134, 135, 134, 133, 134, 133, 133, 134, 134, 134, 134, 134, 133, 133, 133, 135, 134, 134, 133, 132, 134, 132, 132, 132, 133, 133, 133, 134, 132, 134, 134, 133, 132, 133, 134, 134, 133, 132, 132, 134, 133, 135, 133, 134, 134, 135, 134, 132, 133, 134, 133, 134, 133, 132, 133, 134, 133, 133, 134, 134, 133, 134, 133], "policy_agent_0_reward": [51910.61354827881, 53231.13350772858, 51233.72687339783, 55306.04012966156, 50705.35333824158, 52081.25334262848, 52210.31336593628, 51167.01996707916, 55058.87368774414, 52656.960220336914, 55643.766677856445, 51214.81345272064, 49008.60002422333, 50883.54006576538, 48795.83358621597, 53346.840282440186, 50910.63365459442, 50754.833404541016, 56638.666999816895, 51825.82671356201, 52013.47355937958, 50320.83368206024, 50909.75327682495, 51115.90019893646, 53782.080154418945, 50381.36013793945, 49553.526825904846, 52015.773345947266, 50078.78668308258, 53350.98022079468, 51052.46693944931, 53273.38005447388, 51621.140268325806, 50238.89337730408, 56154.14028930664, 51764.6668548584, 55354.213455200195, 52154.800256729126, 49511.8936252594, 52000.673460006714, 52767.100286483765, 47202.933331012726, 50641.69350814819, 53000.47351837158, 53793.56686282158, 52376.72022151947, 52419.220207214355, 49765.0668296814, 53472.60671234131, 50157.326835632324, 54989.72023010254, 54262.96681976318, 53096.06011199951, 53957.313694000244, 51989.36672782898, 52560.87999725342, 51594.02675771713, 49462.65325176716, 49111.013441085815, 52332.666648864746, 50401.839893341064, 52949.40669631958, 53724.440172195435, 46048.433364868164, 53344.28664803505, 54983.84688806534, 50546.96686267853, 51923.679971694946, 51860.76647090912, 52686.506747722626, 54716.29342842102, 49520.57353210449, 52451.3000869751, 50482.380058288574, 51642.12676358223, 51608.32667207718, 54009.186727523804, 52451.79355049133, 52166.75353264809, 50995.00681114197, 53808.29343223572, 53175.61336135864, 52139.83347606659, 52009.766830444336, 52637.33355140686, 48742.72013759613, 52957.88026428223, 53053.00031661987, 48956.973229408264, 50086.68023312092, 51507.30684185028, 52056.21992111206, 47741.27346038818, 53831.36666536331, 50692.95365524292, 51799.03340220451, 53430.07341384888, 50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.275664938208255, "mean_inference_ms": 6.7939225483778, "mean_action_processing_ms": 0.20452797168984385, "mean_env_wait_ms": 242.36291358073518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05459006951779735, "StateBufferConnector_ms": 0.007179805210658482, "ViewRequirementAgentConnector_ms": 0.22645191270477918}}, "episode_reward_max": 56638.666999816895, "episode_reward_min": 46048.433364868164, "episode_reward_mean": 51921.32686414038, "episode_len_mean": 133.3673469387755, "episodes_this_iter": 98, "policy_reward_min": {"agent_0": 46048.433364868164}, "policy_reward_max": {"agent_0": 56638.666999816895}, "policy_reward_mean": {"agent_0": 51921.32686414038}, "hist_stats": {"episode_reward": [51910.61354827881, 53231.13350772858, 51233.72687339783, 55306.04012966156, 50705.35333824158, 52081.25334262848, 52210.31336593628, 51167.01996707916, 55058.87368774414, 52656.960220336914, 55643.766677856445, 51214.81345272064, 49008.60002422333, 50883.54006576538, 48795.83358621597, 53346.840282440186, 50910.63365459442, 50754.833404541016, 56638.666999816895, 51825.82671356201, 52013.47355937958, 50320.83368206024, 50909.75327682495, 51115.90019893646, 53782.080154418945, 50381.36013793945, 49553.526825904846, 52015.773345947266, 50078.78668308258, 53350.98022079468, 51052.46693944931, 53273.38005447388, 51621.140268325806, 50238.89337730408, 56154.14028930664, 51764.6668548584, 55354.213455200195, 52154.800256729126, 49511.8936252594, 52000.673460006714, 52767.100286483765, 47202.933331012726, 50641.69350814819, 53000.47351837158, 53793.56686282158, 52376.72022151947, 52419.220207214355, 49765.0668296814, 53472.60671234131, 50157.326835632324, 54989.72023010254, 54262.96681976318, 53096.06011199951, 53957.313694000244, 51989.36672782898, 52560.87999725342, 51594.02675771713, 49462.65325176716, 49111.013441085815, 52332.666648864746, 50401.839893341064, 52949.40669631958, 53724.440172195435, 46048.433364868164, 53344.28664803505, 54983.84688806534, 50546.96686267853, 51923.679971694946, 51860.76647090912, 52686.506747722626, 54716.29342842102, 49520.57353210449, 52451.3000869751, 50482.380058288574, 51642.12676358223, 51608.32667207718, 54009.186727523804, 52451.79355049133, 52166.75353264809, 50995.00681114197, 53808.29343223572, 53175.61336135864, 52139.83347606659, 52009.766830444336, 52637.33355140686, 48742.72013759613, 52957.88026428223, 53053.00031661987, 48956.973229408264, 50086.68023312092, 51507.30684185028, 52056.21992111206, 47741.27346038818, 53831.36666536331, 50692.95365524292, 51799.03340220451, 53430.07341384888, 50963.04011154175], "episode_lengths": [133, 134, 134, 135, 133, 133, 134, 133, 134, 133, 134, 134, 132, 131, 132, 135, 133, 132, 135, 134, 134, 134, 133, 134, 133, 134, 133, 132, 133, 133, 132, 134, 132, 133, 135, 134, 135, 134, 133, 134, 133, 133, 134, 134, 134, 134, 134, 133, 133, 133, 135, 134, 134, 133, 132, 134, 132, 132, 132, 133, 133, 133, 134, 132, 134, 134, 133, 132, 133, 134, 134, 133, 132, 132, 134, 133, 135, 133, 134, 134, 135, 134, 132, 133, 134, 133, 134, 133, 132, 133, 134, 133, 133, 134, 134, 133, 134, 133], "policy_agent_0_reward": [51910.61354827881, 53231.13350772858, 51233.72687339783, 55306.04012966156, 50705.35333824158, 52081.25334262848, 52210.31336593628, 51167.01996707916, 55058.87368774414, 52656.960220336914, 55643.766677856445, 51214.81345272064, 49008.60002422333, 50883.54006576538, 48795.83358621597, 53346.840282440186, 50910.63365459442, 50754.833404541016, 56638.666999816895, 51825.82671356201, 52013.47355937958, 50320.83368206024, 50909.75327682495, 51115.90019893646, 53782.080154418945, 50381.36013793945, 49553.526825904846, 52015.773345947266, 50078.78668308258, 53350.98022079468, 51052.46693944931, 53273.38005447388, 51621.140268325806, 50238.89337730408, 56154.14028930664, 51764.6668548584, 55354.213455200195, 52154.800256729126, 49511.8936252594, 52000.673460006714, 52767.100286483765, 47202.933331012726, 50641.69350814819, 53000.47351837158, 53793.56686282158, 52376.72022151947, 52419.220207214355, 49765.0668296814, 53472.60671234131, 50157.326835632324, 54989.72023010254, 54262.96681976318, 53096.06011199951, 53957.313694000244, 51989.36672782898, 52560.87999725342, 51594.02675771713, 49462.65325176716, 49111.013441085815, 52332.666648864746, 50401.839893341064, 52949.40669631958, 53724.440172195435, 46048.433364868164, 53344.28664803505, 54983.84688806534, 50546.96686267853, 51923.679971694946, 51860.76647090912, 52686.506747722626, 54716.29342842102, 49520.57353210449, 52451.3000869751, 50482.380058288574, 51642.12676358223, 51608.32667207718, 54009.186727523804, 52451.79355049133, 52166.75353264809, 50995.00681114197, 53808.29343223572, 53175.61336135864, 52139.83347606659, 52009.766830444336, 52637.33355140686, 48742.72013759613, 52957.88026428223, 53053.00031661987, 48956.973229408264, 50086.68023312092, 51507.30684185028, 52056.21992111206, 47741.27346038818, 53831.36666536331, 50692.95365524292, 51799.03340220451, 53430.07341384888, 50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.275664938208255, "mean_inference_ms": 6.7939225483778, "mean_action_processing_ms": 0.20452797168984385, "mean_env_wait_ms": 242.36291358073518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05459006951779735, "StateBufferConnector_ms": 0.007179805210658482, "ViewRequirementAgentConnector_ms": 0.22645191270477918}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.97109852281238, "num_env_steps_trained_throughput_per_sec": 213.97109852281238, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14631.941, "sample_time_ms": 11601.978, "learn_time_ms": 2885.435, "learn_throughput": 1386.273, "synch_weights_time_ms": 143.822}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 496, "training_iteration": 17, "trial_id": "32397_00000", "date": "2025-03-21_08-41-23", "timestamp": 1742546483, "time_this_iter_s": 18.74951195716858, "time_total_s": 258.943660736084, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbc430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 258.943660736084, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 95.9307692307692, "ram_util_percent": 13.38076923076923}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989206314086914, "policy_loss": -0.011955028399825096, "vf_loss": 10.0, "vf_explained_var": 1.819183381712719e-08, "kl": 0.005805350374430418, "entropy": 0.7310127019882202, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 50963.04011154175, "episode_reward_min": 50963.04011154175, "episode_reward_mean": 50963.04011154175, "episode_len_mean": 133.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50963.04011154175}, "policy_reward_max": {"agent_0": 50963.04011154175}, "policy_reward_mean": {"agent_0": 50963.04011154175}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50963.04011154175], "episode_lengths": [133], "policy_agent_0_reward": [50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.30666942771422, "mean_inference_ms": 6.308562602471868, "mean_action_processing_ms": 0.20758471357713054, "mean_env_wait_ms": 247.9725448363418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03788471221923828, "StateBufferConnector_ms": 0.006794929504394531, "ViewRequirementAgentConnector_ms": 0.15544891357421875}}, "episode_reward_max": 50963.04011154175, "episode_reward_min": 50963.04011154175, "episode_reward_mean": 50963.04011154175, "episode_len_mean": 133.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50963.04011154175}, "policy_reward_max": {"agent_0": 50963.04011154175}, "policy_reward_mean": {"agent_0": 50963.04011154175}, "hist_stats": {"episode_reward": [50963.04011154175], "episode_lengths": [133], "policy_agent_0_reward": [50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.30666942771422, "mean_inference_ms": 6.308562602471868, "mean_action_processing_ms": 0.20758471357713054, "mean_env_wait_ms": 247.9725448363418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03788471221923828, "StateBufferConnector_ms": 0.006794929504394531, "ViewRequirementAgentConnector_ms": 0.15544891357421875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.28853042732317, "num_env_steps_trained_throughput_per_sec": 289.28853042732317, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14694.419, "sample_time_ms": 11580.586, "learn_time_ms": 2972.279, "learn_throughput": 1345.769, "synch_weights_time_ms": 140.85}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 496, "training_iteration": 18, "trial_id": "32397_00000", "date": "2025-03-21_08-41-37", "timestamp": 1742546497, "time_this_iter_s": 13.891159296035767, "time_total_s": 272.83482003211975, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 272.83482003211975, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 99.64736842105265, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989277839660645, "policy_loss": -0.011951889842748642, "vf_loss": 10.0, "vf_explained_var": -8.332232681595997e-08, "kl": 0.006149889435619116, "entropy": 0.7248086333274841, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 50963.04011154175, "episode_reward_min": 50963.04011154175, "episode_reward_mean": 50963.04011154175, "episode_len_mean": 133.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50963.04011154175}, "policy_reward_max": {"agent_0": 50963.04011154175}, "policy_reward_mean": {"agent_0": 50963.04011154175}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50963.04011154175], "episode_lengths": [133], "policy_agent_0_reward": [50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.30666942771422, "mean_inference_ms": 6.308562602471868, "mean_action_processing_ms": 0.20758471357713054, "mean_env_wait_ms": 247.9725448363418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03788471221923828, "StateBufferConnector_ms": 0.006794929504394531, "ViewRequirementAgentConnector_ms": 0.15544891357421875}}, "episode_reward_max": 50963.04011154175, "episode_reward_min": 50963.04011154175, "episode_reward_mean": 50963.04011154175, "episode_len_mean": 133.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 50963.04011154175}, "policy_reward_max": {"agent_0": 50963.04011154175}, "policy_reward_mean": {"agent_0": 50963.04011154175}, "hist_stats": {"episode_reward": [50963.04011154175], "episode_lengths": [133], "policy_agent_0_reward": [50963.04011154175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.30666942771422, "mean_inference_ms": 6.308562602471868, "mean_action_processing_ms": 0.20758471357713054, "mean_env_wait_ms": 247.9725448363418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03788471221923828, "StateBufferConnector_ms": 0.006794929504394531, "ViewRequirementAgentConnector_ms": 0.15544891357421875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.06067983539907, "num_env_steps_trained_throughput_per_sec": 288.06067983539907, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14318.039, "sample_time_ms": 11167.926, "learn_time_ms": 3006.587, "learn_throughput": 1330.412, "synch_weights_time_ms": 142.824}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 496, "training_iteration": 19, "trial_id": "32397_00000", "date": "2025-03-21_08-41-51", "timestamp": 1742546511, "time_this_iter_s": 13.936222314834595, "time_total_s": 286.77104234695435, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbd360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 286.77104234695435, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 99.61500000000002, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 4.9375, "num_batches_min": 4, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.947266578674316, "policy_loss": -0.011784439906477928, "vf_loss": 9.95760440826416, "vf_explained_var": 3.207474890132289e-07, "kl": 0.007234731689095497, "entropy": 0.660744845867157, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 56663.92021942139, "episode_reward_min": 51296.593547821045, "episode_reward_mean": 53616.10847720504, "episode_len_mean": 133.5625, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51296.593547821045}, "policy_reward_max": {"agent_0": 56663.92021942139}, "policy_reward_mean": {"agent_0": 53616.10847720504}, "custom_metrics": {"num_batches_mean": 4.9375, "num_batches_min": 4, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51298.68683433533, 54016.84020614624, 51329.560108184814, 53943.76006126404, 53566.433331012726, 52704.126819610596, 53495.500091552734, 51770.92004394531, 54757.84020996094, 51296.593547821045, 56663.92021942139, 53083.18689441681, 54766.96011352539, 54662.25360107422, 55138.82014846802, 55362.333404541016], "episode_lengths": [134, 134, 133, 133, 134, 133, 133, 131, 134, 133, 135, 133, 134, 135, 134, 134], "policy_agent_0_reward": [51298.68683433533, 54016.84020614624, 51329.560108184814, 53943.76006126404, 53566.433331012726, 52704.126819610596, 53495.500091552734, 51770.92004394531, 54757.84020996094, 51296.593547821045, 56663.92021942139, 53083.18689441681, 54766.96011352539, 54662.25360107422, 55138.82014846802, 55362.333404541016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.091664508142918, "mean_inference_ms": 6.460860394133022, "mean_action_processing_ms": 0.21074353837029114, "mean_env_wait_ms": 232.4514909113409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03906935453414917, "StateBufferConnector_ms": 0.006864964962005615, "ViewRequirementAgentConnector_ms": 0.18671005964279175}}, "episode_reward_max": 56663.92021942139, "episode_reward_min": 51296.593547821045, "episode_reward_mean": 53616.10847720504, "episode_len_mean": 133.5625, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51296.593547821045}, "policy_reward_max": {"agent_0": 56663.92021942139}, "policy_reward_mean": {"agent_0": 53616.10847720504}, "hist_stats": {"episode_reward": [51298.68683433533, 54016.84020614624, 51329.560108184814, 53943.76006126404, 53566.433331012726, 52704.126819610596, 53495.500091552734, 51770.92004394531, 54757.84020996094, 51296.593547821045, 56663.92021942139, 53083.18689441681, 54766.96011352539, 54662.25360107422, 55138.82014846802, 55362.333404541016], "episode_lengths": [134, 134, 133, 133, 134, 133, 133, 131, 134, 133, 135, 133, 134, 135, 134, 134], "policy_agent_0_reward": [51298.68683433533, 54016.84020614624, 51329.560108184814, 53943.76006126404, 53566.433331012726, 52704.126819610596, 53495.500091552734, 51770.92004394531, 54757.84020996094, 51296.593547821045, 56663.92021942139, 53083.18689441681, 54766.96011352539, 54662.25360107422, 55138.82014846802, 55362.333404541016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.091664508142918, "mean_inference_ms": 6.460860394133022, "mean_action_processing_ms": 0.21074353837029114, "mean_env_wait_ms": 232.4514909113409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03906935453414917, "StateBufferConnector_ms": 0.006864964962005615, "ViewRequirementAgentConnector_ms": 0.18671005964279175}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.02454033774274, "num_env_steps_trained_throughput_per_sec": 295.02454033774274, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14365.88, "sample_time_ms": 11242.785, "learn_time_ms": 2979.191, "learn_throughput": 1342.646, "synch_weights_time_ms": 143.193}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 512, "training_iteration": 20, "trial_id": "32397_00000", "date": "2025-03-21_08-42-05", "timestamp": 1742546525, "time_this_iter_s": 13.611927509307861, "time_total_s": 300.3829698562622, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ced900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 300.3829698562622, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 98.765, "ram_util_percent": 13.34}}
{"custom_metrics": {"num_batches_mean": 5.046296296296297, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.720458984375, "policy_loss": -0.012736032716929913, "vf_loss": 9.731708526611328, "vf_explained_var": 4.938493134432065e-07, "kl": 0.007433018181473017, "entropy": 0.6581135988235474, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 57899.26036453247, "episode_reward_min": 50181.79356050491, "episode_reward_mean": 54513.98473902875, "episode_len_mean": 134.07407407407408, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {"agent_0": 50181.79356050491}, "policy_reward_max": {"agent_0": 57899.26036453247}, "policy_reward_mean": {"agent_0": 54513.98473902875}, "custom_metrics": {"num_batches_mean": 5.046296296296297, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56837.360427856445, 55276.87348937988, 54895.25984954834, 54940.586866378784, 56119.106872558594, 54080.606773376465, 57386.086853027344, 57594.16664505005, 52676.24019908905, 53897.860052108765, 54908.10670375824, 55547.47361755371, 57899.26036453247, 52784.366680145264, 53101.13365364075, 56033.100257873535, 53465.293632507324, 54032.16676425934, 53038.38000583649, 55118.840324401855, 56957.12689590454, 54495.047019958496, 56160.62690734863, 54181.0334854126, 52859.0201587677, 55152.86018180847, 50181.79356050491, 55509.28024673462, 51188.07356452942, 57227.54676055908, 53238.03349685669, 53567.75999069214, 55791.606704711914, 53927.10682678223, 54132.96014857292, 55662.500244140625, 53776.20673751831, 57320.200340270996, 55432.88013076782, 55309.16650390625, 56700.90021896362, 51978.25360870361, 54248.84019470215, 54237.4468998909, 52948.126777648926, 53998.180236816406, 54337.76039123535, 53967.833658218384, 52866.86019897461, 52010.086864471436, 54169.43329620361, 55528.20690155029, 54345.76676940918, 54049.74020767212, 53837.83352470398, 54310.80697345734, 56455.60692214966, 55724.14009857178, 54776.61361312866, 55864.92015838623, 53426.34680175781, 54211.280197143555, 55455.43350696564, 51763.64037048817, 55413.820346832275, 53987.9068107605, 54938.16664123535, 53781.00019264221, 54867.00007605553, 53542.046827316284, 56244.27358818054, 56079.100036621094, 56022.82666873932, 55693.853588461876, 51437.90675663948, 54580.106969833374, 54710.95344924927, 54342.48677957058, 50258.13356208801, 54935.62699890137, 56055.42673778534, 52064.340030670166, 56657.100425720215, 55087.68003463745, 52890.600147247314, 57366.20030593872, 53443.393476486206, 51518.66694736481, 55322.973472595215, 55470.206645965576, 53770.033348083496, 54296.41351914406, 57284.620040893555, 51144.93360757828, 56035.95333099365, 52168.03368759155, 54423.033259391785, 54730.400354385376, 52349.94017410278, 54285.91346740723, 54911.95380401611, 54059.046699523926, 54007.3934173584, 53035.11352968216, 56071.133728027344, 53940.599992752075, 54006.266664505005, 57360.613342285156], "episode_lengths": [135, 135, 134, 135, 134, 134, 134, 136, 133, 133, 136, 134, 136, 134, 134, 135, 133, 134, 133, 134, 135, 134, 136, 134, 132, 134, 133, 134, 132, 135, 133, 134, 134, 134, 134, 135, 133, 135, 135, 133, 135, 134, 134, 133, 133, 134, 135, 134, 132, 133, 133, 134, 133, 134, 134, 135, 136, 135, 134, 135, 133, 134, 134, 134, 135, 134, 135, 134, 134, 134, 135, 134, 135, 135, 132, 135, 133, 134, 133, 134, 134, 133, 135, 133, 134, 135, 134, 133, 135, 135, 134, 135, 135, 133, 134, 133, 134, 135, 134, 134, 135, 134, 132, 134, 134, 134, 134, 135], "policy_agent_0_reward": [56837.360427856445, 55276.87348937988, 54895.25984954834, 54940.586866378784, 56119.106872558594, 54080.606773376465, 57386.086853027344, 57594.16664505005, 52676.24019908905, 53897.860052108765, 54908.10670375824, 55547.47361755371, 57899.26036453247, 52784.366680145264, 53101.13365364075, 56033.100257873535, 53465.293632507324, 54032.16676425934, 53038.38000583649, 55118.840324401855, 56957.12689590454, 54495.047019958496, 56160.62690734863, 54181.0334854126, 52859.0201587677, 55152.86018180847, 50181.79356050491, 55509.28024673462, 51188.07356452942, 57227.54676055908, 53238.03349685669, 53567.75999069214, 55791.606704711914, 53927.10682678223, 54132.96014857292, 55662.500244140625, 53776.20673751831, 57320.200340270996, 55432.88013076782, 55309.16650390625, 56700.90021896362, 51978.25360870361, 54248.84019470215, 54237.4468998909, 52948.126777648926, 53998.180236816406, 54337.76039123535, 53967.833658218384, 52866.86019897461, 52010.086864471436, 54169.43329620361, 55528.20690155029, 54345.76676940918, 54049.74020767212, 53837.83352470398, 54310.80697345734, 56455.60692214966, 55724.14009857178, 54776.61361312866, 55864.92015838623, 53426.34680175781, 54211.280197143555, 55455.43350696564, 51763.64037048817, 55413.820346832275, 53987.9068107605, 54938.16664123535, 53781.00019264221, 54867.00007605553, 53542.046827316284, 56244.27358818054, 56079.100036621094, 56022.82666873932, 55693.853588461876, 51437.90675663948, 54580.106969833374, 54710.95344924927, 54342.48677957058, 50258.13356208801, 54935.62699890137, 56055.42673778534, 52064.340030670166, 56657.100425720215, 55087.68003463745, 52890.600147247314, 57366.20030593872, 53443.393476486206, 51518.66694736481, 55322.973472595215, 55470.206645965576, 53770.033348083496, 54296.41351914406, 57284.620040893555, 51144.93360757828, 56035.95333099365, 52168.03368759155, 54423.033259391785, 54730.400354385376, 52349.94017410278, 54285.91346740723, 54911.95380401611, 54059.046699523926, 54007.3934173584, 53035.11352968216, 56071.133728027344, 53940.599992752075, 54006.266664505005, 57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.420665026002936, "mean_inference_ms": 6.714346056675659, "mean_action_processing_ms": 0.20352821014891112, "mean_env_wait_ms": 240.6250193916235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05076615898697465, "StateBufferConnector_ms": 0.01051977828696922, "ViewRequirementAgentConnector_ms": 0.21831437393471045}}, "episode_reward_max": 57899.26036453247, "episode_reward_min": 50181.79356050491, "episode_reward_mean": 54513.98473902875, "episode_len_mean": 134.07407407407408, "episodes_this_iter": 108, "policy_reward_min": {"agent_0": 50181.79356050491}, "policy_reward_max": {"agent_0": 57899.26036453247}, "policy_reward_mean": {"agent_0": 54513.98473902875}, "hist_stats": {"episode_reward": [56837.360427856445, 55276.87348937988, 54895.25984954834, 54940.586866378784, 56119.106872558594, 54080.606773376465, 57386.086853027344, 57594.16664505005, 52676.24019908905, 53897.860052108765, 54908.10670375824, 55547.47361755371, 57899.26036453247, 52784.366680145264, 53101.13365364075, 56033.100257873535, 53465.293632507324, 54032.16676425934, 53038.38000583649, 55118.840324401855, 56957.12689590454, 54495.047019958496, 56160.62690734863, 54181.0334854126, 52859.0201587677, 55152.86018180847, 50181.79356050491, 55509.28024673462, 51188.07356452942, 57227.54676055908, 53238.03349685669, 53567.75999069214, 55791.606704711914, 53927.10682678223, 54132.96014857292, 55662.500244140625, 53776.20673751831, 57320.200340270996, 55432.88013076782, 55309.16650390625, 56700.90021896362, 51978.25360870361, 54248.84019470215, 54237.4468998909, 52948.126777648926, 53998.180236816406, 54337.76039123535, 53967.833658218384, 52866.86019897461, 52010.086864471436, 54169.43329620361, 55528.20690155029, 54345.76676940918, 54049.74020767212, 53837.83352470398, 54310.80697345734, 56455.60692214966, 55724.14009857178, 54776.61361312866, 55864.92015838623, 53426.34680175781, 54211.280197143555, 55455.43350696564, 51763.64037048817, 55413.820346832275, 53987.9068107605, 54938.16664123535, 53781.00019264221, 54867.00007605553, 53542.046827316284, 56244.27358818054, 56079.100036621094, 56022.82666873932, 55693.853588461876, 51437.90675663948, 54580.106969833374, 54710.95344924927, 54342.48677957058, 50258.13356208801, 54935.62699890137, 56055.42673778534, 52064.340030670166, 56657.100425720215, 55087.68003463745, 52890.600147247314, 57366.20030593872, 53443.393476486206, 51518.66694736481, 55322.973472595215, 55470.206645965576, 53770.033348083496, 54296.41351914406, 57284.620040893555, 51144.93360757828, 56035.95333099365, 52168.03368759155, 54423.033259391785, 54730.400354385376, 52349.94017410278, 54285.91346740723, 54911.95380401611, 54059.046699523926, 54007.3934173584, 53035.11352968216, 56071.133728027344, 53940.599992752075, 54006.266664505005, 57360.613342285156], "episode_lengths": [135, 135, 134, 135, 134, 134, 134, 136, 133, 133, 136, 134, 136, 134, 134, 135, 133, 134, 133, 134, 135, 134, 136, 134, 132, 134, 133, 134, 132, 135, 133, 134, 134, 134, 134, 135, 133, 135, 135, 133, 135, 134, 134, 133, 133, 134, 135, 134, 132, 133, 133, 134, 133, 134, 134, 135, 136, 135, 134, 135, 133, 134, 134, 134, 135, 134, 135, 134, 134, 134, 135, 134, 135, 135, 132, 135, 133, 134, 133, 134, 134, 133, 135, 133, 134, 135, 134, 133, 135, 135, 134, 135, 135, 133, 134, 133, 134, 135, 134, 134, 135, 134, 132, 134, 134, 134, 134, 135], "policy_agent_0_reward": [56837.360427856445, 55276.87348937988, 54895.25984954834, 54940.586866378784, 56119.106872558594, 54080.606773376465, 57386.086853027344, 57594.16664505005, 52676.24019908905, 53897.860052108765, 54908.10670375824, 55547.47361755371, 57899.26036453247, 52784.366680145264, 53101.13365364075, 56033.100257873535, 53465.293632507324, 54032.16676425934, 53038.38000583649, 55118.840324401855, 56957.12689590454, 54495.047019958496, 56160.62690734863, 54181.0334854126, 52859.0201587677, 55152.86018180847, 50181.79356050491, 55509.28024673462, 51188.07356452942, 57227.54676055908, 53238.03349685669, 53567.75999069214, 55791.606704711914, 53927.10682678223, 54132.96014857292, 55662.500244140625, 53776.20673751831, 57320.200340270996, 55432.88013076782, 55309.16650390625, 56700.90021896362, 51978.25360870361, 54248.84019470215, 54237.4468998909, 52948.126777648926, 53998.180236816406, 54337.76039123535, 53967.833658218384, 52866.86019897461, 52010.086864471436, 54169.43329620361, 55528.20690155029, 54345.76676940918, 54049.74020767212, 53837.83352470398, 54310.80697345734, 56455.60692214966, 55724.14009857178, 54776.61361312866, 55864.92015838623, 53426.34680175781, 54211.280197143555, 55455.43350696564, 51763.64037048817, 55413.820346832275, 53987.9068107605, 54938.16664123535, 53781.00019264221, 54867.00007605553, 53542.046827316284, 56244.27358818054, 56079.100036621094, 56022.82666873932, 55693.853588461876, 51437.90675663948, 54580.106969833374, 54710.95344924927, 54342.48677957058, 50258.13356208801, 54935.62699890137, 56055.42673778534, 52064.340030670166, 56657.100425720215, 55087.68003463745, 52890.600147247314, 57366.20030593872, 53443.393476486206, 51518.66694736481, 55322.973472595215, 55470.206645965576, 53770.033348083496, 54296.41351914406, 57284.620040893555, 51144.93360757828, 56035.95333099365, 52168.03368759155, 54423.033259391785, 54730.400354385376, 52349.94017410278, 54285.91346740723, 54911.95380401611, 54059.046699523926, 54007.3934173584, 53035.11352968216, 56071.133728027344, 53940.599992752075, 54006.266664505005, 57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.420665026002936, "mean_inference_ms": 6.714346056675659, "mean_action_processing_ms": 0.20352821014891112, "mean_env_wait_ms": 240.6250193916235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05076615898697465, "StateBufferConnector_ms": 0.01051977828696922, "ViewRequirementAgentConnector_ms": 0.21831437393471045}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.52158524366322, "num_env_steps_trained_throughput_per_sec": 213.52158524366322, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14965.455, "sample_time_ms": 11783.278, "learn_time_ms": 3028.671, "learn_throughput": 1320.711, "synch_weights_time_ms": 152.795}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 620, "training_iteration": 21, "trial_id": "32397_00000", "date": "2025-03-21_08-42-23", "timestamp": 1742546543, "time_this_iter_s": 18.797848224639893, "time_total_s": 319.1808180809021, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbdea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 319.1808180809021, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 95.57199999999999, "ram_util_percent": 13.388000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.990144729614258, "policy_loss": -0.011027486994862556, "vf_loss": 10.0, "vf_explained_var": -2.9814739832545456e-07, "kl": 0.005858952645212412, "entropy": 0.6299548745155334, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 57360.613342285156, "episode_reward_min": 57360.613342285156, "episode_reward_mean": 57360.613342285156, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57360.613342285156}, "policy_reward_max": {"agent_0": 57360.613342285156}, "policy_reward_mean": {"agent_0": 57360.613342285156}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57360.613342285156], "episode_lengths": [135], "policy_agent_0_reward": [57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.576923724623704, "mean_inference_ms": 6.478578870753477, "mean_action_processing_ms": 0.20384292545857083, "mean_env_wait_ms": 253.88910051263636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04050731658935547, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1559734344482422}}, "episode_reward_max": 57360.613342285156, "episode_reward_min": 57360.613342285156, "episode_reward_mean": 57360.613342285156, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57360.613342285156}, "policy_reward_max": {"agent_0": 57360.613342285156}, "policy_reward_mean": {"agent_0": 57360.613342285156}, "hist_stats": {"episode_reward": [57360.613342285156], "episode_lengths": [135], "policy_agent_0_reward": [57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.576923724623704, "mean_inference_ms": 6.478578870753477, "mean_action_processing_ms": 0.20384292545857083, "mean_env_wait_ms": 253.88910051263636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04050731658935547, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1559734344482422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6919733482483, "num_env_steps_trained_throughput_per_sec": 300.6919733482483, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14894.601, "sample_time_ms": 11691.791, "learn_time_ms": 3042.945, "learn_throughput": 1314.516, "synch_weights_time_ms": 159.121}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 620, "training_iteration": 22, "trial_id": "32397_00000", "date": "2025-03-21_08-42-37", "timestamp": 1742546557, "time_this_iter_s": 13.381166934967041, "time_total_s": 332.56198501586914, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf5b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 332.56198501586914, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 99.64736842105263, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98769474029541, "policy_loss": -0.01118622999638319, "vf_loss": 9.99755859375, "vf_explained_var": -5.168840289115906e-07, "kl": 0.006611157674342394, "entropy": 0.6054952144622803, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 57360.613342285156, "episode_reward_min": 57360.613342285156, "episode_reward_mean": 57360.613342285156, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57360.613342285156}, "policy_reward_max": {"agent_0": 57360.613342285156}, "policy_reward_mean": {"agent_0": 57360.613342285156}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57360.613342285156], "episode_lengths": [135], "policy_agent_0_reward": [57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.576923724623704, "mean_inference_ms": 6.478578870753477, "mean_action_processing_ms": 0.20384292545857083, "mean_env_wait_ms": 253.88910051263636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04050731658935547, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1559734344482422}}, "episode_reward_max": 57360.613342285156, "episode_reward_min": 57360.613342285156, "episode_reward_mean": 57360.613342285156, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57360.613342285156}, "policy_reward_max": {"agent_0": 57360.613342285156}, "policy_reward_mean": {"agent_0": 57360.613342285156}, "hist_stats": {"episode_reward": [57360.613342285156], "episode_lengths": [135], "policy_agent_0_reward": [57360.613342285156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.576923724623704, "mean_inference_ms": 6.478578870753477, "mean_action_processing_ms": 0.20384292545857083, "mean_env_wait_ms": 253.88910051263636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04050731658935547, "StateBufferConnector_ms": 0.006508827209472656, "ViewRequirementAgentConnector_ms": 0.1559734344482422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3999014202629, "num_env_steps_trained_throughput_per_sec": 303.3999014202629, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14511.154, "sample_time_ms": 11301.804, "learn_time_ms": 3053.959, "learn_throughput": 1309.775, "synch_weights_time_ms": 154.64}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 620, "training_iteration": 23, "trial_id": "32397_00000", "date": "2025-03-21_08-42-50", "timestamp": 1742546570, "time_this_iter_s": 13.239269495010376, "time_total_s": 345.8012545108795, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 345.8012545108795, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 99.56842105263159, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984468460083008, "policy_loss": -0.011964001692831516, "vf_loss": 9.994873046875, "vf_explained_var": -5.103026978758862e-07, "kl": 0.007794881705194712, "entropy": 0.5801616907119751, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 56300.4002161026, "episode_reward_min": 54433.60008811951, "episode_reward_mean": 55367.00015211105, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 54433.60008811951}, "policy_reward_max": {"agent_0": 56300.4002161026}, "policy_reward_mean": {"agent_0": 55367.00015211105}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56300.4002161026, 54433.60008811951], "episode_lengths": [134, 134], "policy_agent_0_reward": [56300.4002161026, 54433.60008811951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725274126887472, "mean_inference_ms": 6.3438671083197775, "mean_action_processing_ms": 0.19767891714281272, "mean_env_wait_ms": 232.22270739484406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031232833862304688, "StateBufferConnector_ms": 0.005280971527099609, "ViewRequirementAgentConnector_ms": 0.47098398208618164}}, "episode_reward_max": 56300.4002161026, "episode_reward_min": 54433.60008811951, "episode_reward_mean": 55367.00015211105, "episode_len_mean": 134.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 54433.60008811951}, "policy_reward_max": {"agent_0": 56300.4002161026}, "policy_reward_mean": {"agent_0": 55367.00015211105}, "hist_stats": {"episode_reward": [56300.4002161026, 54433.60008811951], "episode_lengths": [134, 134], "policy_agent_0_reward": [56300.4002161026, 54433.60008811951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.725274126887472, "mean_inference_ms": 6.3438671083197775, "mean_action_processing_ms": 0.19767891714281272, "mean_env_wait_ms": 232.22270739484406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031232833862304688, "StateBufferConnector_ms": 0.005280971527099609, "ViewRequirementAgentConnector_ms": 0.47098398208618164}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1089713563478, "num_env_steps_trained_throughput_per_sec": 307.1089713563478, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14468.093, "sample_time_ms": 11300.252, "learn_time_ms": 3018.16, "learn_throughput": 1325.311, "synch_weights_time_ms": 148.931}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 622, "training_iteration": 24, "trial_id": "32397_00000", "date": "2025-03-21_08-43-03", "timestamp": 1742546583, "time_this_iter_s": 13.07341194152832, "time_total_s": 358.87466645240784, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 358.87466645240784, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 99.0578947368421, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.05, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.687155723571777, "policy_loss": -0.011753981932997704, "vf_loss": 9.697755813598633, "vf_explained_var": -3.973643103449831e-08, "kl": 0.005765020381659269, "entropy": 0.55372154712677, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 59522.44665527344, "episode_reward_min": 51617.94004249573, "episode_reward_mean": 55807.79346220891, "episode_len_mean": 134.80833333333334, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {"agent_0": 51617.94004249573}, "policy_reward_max": {"agent_0": 59522.44665527344}, "policy_reward_mean": {"agent_0": 55807.79346220891}, "custom_metrics": {"num_batches_mean": 5.05, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55293.160217285156, 54749.13994598389, 52868.62678909302, 53348.713455200195, 55088.17348241806, 53338.3998708725, 54228.11376953125, 51617.94004249573, 55464.48701095581, 57733.52013206482, 56142.413345336914, 53227.64673995972, 55706.26679420471, 55237.71357727051, 55102.99388694763, 58946.22009277344, 55846.90000915527, 53864.39366149902, 56466.08037567139, 56169.840156555176, 56255.81358718872, 56887.45349884033, 55696.9935131073, 54086.666811943054, 56629.21388339996, 54883.46069073677, 57755.36016082764, 56921.833718299866, 57474.846755981445, 57039.32035255432, 53411.26669692993, 56569.77355957031, 56136.806884765625, 58505.70034790039, 58104.94682312012, 57612.62690734863, 56715.21335411072, 55705.89352416992, 59235.46702194214, 55337.05356216431, 53074.10673522949, 55591.65333557129, 54815.72714614868, 55295.06699180603, 54485.806743621826, 55787.34659576416, 56169.02010536194, 54435.100187301636, 53591.3936252594, 55869.75354003906, 57018.32712554932, 53250.98684692383, 57239.24652862549, 56865.10697329044, 56698.51354980469, 58792.140060424805, 54225.92687416077, 52851.45334529877, 55798.866790771484, 55104.319984436035, 57770.813789367676, 55331.653549194336, 57204.70705795288, 59136.81357002258, 54996.44672393799, 55285.57356262207, 56808.58698272705, 54094.44005393982, 56862.82680130005, 56430.47359085083, 55173.186920166016, 51844.24676036835, 56682.76689147949, 53232.219955444336, 55322.72005081177, 57152.36022949219, 52713.65333366394, 56505.87348175049, 55213.373638153076, 57147.24021053314, 56490.85353088379, 53739.54043900967, 56763.166816711426, 57769.500036239624, 56041.320180892944, 57884.9602766037, 58383.32022857666, 58287.04032897949, 57518.52654647827, 52643.500173568726, 56340.14723777771, 56839.306816101074, 55947.760389328, 56157.47359132767, 58409.740234375, 54924.08695983887, 56911.80025482178, 52325.32656669617, 55291.013427734375, 57011.74662017822, 52628.80051803589, 56082.673199653625, 52887.2201795578, 55248.42007637024, 57108.70704650879, 55706.38012123108, 53831.22017478943, 55626.5671081543, 59522.44665527344, 56707.55349731445, 54259.63984584808, 56513.00005340576, 57007.133544921875, 56996.27360725403, 58311.56008148193, 58322.03340148926, 58018.19327926636, 54866.28005814552, 52592.88026428223, 55741.80684661865], "episode_lengths": [135, 134, 134, 134, 135, 134, 134, 134, 135, 136, 135, 134, 134, 134, 134, 136, 135, 134, 135, 135, 135, 135, 134, 135, 135, 134, 135, 134, 135, 136, 134, 135, 135, 136, 136, 136, 134, 134, 136, 135, 133, 135, 136, 135, 134, 134, 136, 135, 133, 134, 135, 132, 135, 135, 134, 136, 134, 134, 135, 135, 136, 134, 136, 136, 134, 133, 136, 135, 135, 134, 134, 134, 136, 134, 135, 135, 133, 135, 134, 136, 136, 135, 135, 136, 134, 136, 136, 135, 135, 134, 135, 136, 135, 136, 135, 134, 136, 133, 135, 135, 135, 135, 133, 136, 135, 134, 134, 136, 136, 135, 134, 134, 135, 135, 136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [55293.160217285156, 54749.13994598389, 52868.62678909302, 53348.713455200195, 55088.17348241806, 53338.3998708725, 54228.11376953125, 51617.94004249573, 55464.48701095581, 57733.52013206482, 56142.413345336914, 53227.64673995972, 55706.26679420471, 55237.71357727051, 55102.99388694763, 58946.22009277344, 55846.90000915527, 53864.39366149902, 56466.08037567139, 56169.840156555176, 56255.81358718872, 56887.45349884033, 55696.9935131073, 54086.666811943054, 56629.21388339996, 54883.46069073677, 57755.36016082764, 56921.833718299866, 57474.846755981445, 57039.32035255432, 53411.26669692993, 56569.77355957031, 56136.806884765625, 58505.70034790039, 58104.94682312012, 57612.62690734863, 56715.21335411072, 55705.89352416992, 59235.46702194214, 55337.05356216431, 53074.10673522949, 55591.65333557129, 54815.72714614868, 55295.06699180603, 54485.806743621826, 55787.34659576416, 56169.02010536194, 54435.100187301636, 53591.3936252594, 55869.75354003906, 57018.32712554932, 53250.98684692383, 57239.24652862549, 56865.10697329044, 56698.51354980469, 58792.140060424805, 54225.92687416077, 52851.45334529877, 55798.866790771484, 55104.319984436035, 57770.813789367676, 55331.653549194336, 57204.70705795288, 59136.81357002258, 54996.44672393799, 55285.57356262207, 56808.58698272705, 54094.44005393982, 56862.82680130005, 56430.47359085083, 55173.186920166016, 51844.24676036835, 56682.76689147949, 53232.219955444336, 55322.72005081177, 57152.36022949219, 52713.65333366394, 56505.87348175049, 55213.373638153076, 57147.24021053314, 56490.85353088379, 53739.54043900967, 56763.166816711426, 57769.500036239624, 56041.320180892944, 57884.9602766037, 58383.32022857666, 58287.04032897949, 57518.52654647827, 52643.500173568726, 56340.14723777771, 56839.306816101074, 55947.760389328, 56157.47359132767, 58409.740234375, 54924.08695983887, 56911.80025482178, 52325.32656669617, 55291.013427734375, 57011.74662017822, 52628.80051803589, 56082.673199653625, 52887.2201795578, 55248.42007637024, 57108.70704650879, 55706.38012123108, 53831.22017478943, 55626.5671081543, 59522.44665527344, 56707.55349731445, 54259.63984584808, 56513.00005340576, 57007.133544921875, 56996.27360725403, 58311.56008148193, 58322.03340148926, 58018.19327926636, 54866.28005814552, 52592.88026428223, 55741.80684661865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.207071640915025, "mean_inference_ms": 6.695432923496918, "mean_action_processing_ms": 0.20504117751166948, "mean_env_wait_ms": 238.04386666371346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07342437903086345, "StateBufferConnector_ms": 0.006671746571858724, "ViewRequirementAgentConnector_ms": 0.19051730632781982}}, "episode_reward_max": 59522.44665527344, "episode_reward_min": 51617.94004249573, "episode_reward_mean": 55807.79346220891, "episode_len_mean": 134.80833333333334, "episodes_this_iter": 120, "policy_reward_min": {"agent_0": 51617.94004249573}, "policy_reward_max": {"agent_0": 59522.44665527344}, "policy_reward_mean": {"agent_0": 55807.79346220891}, "hist_stats": {"episode_reward": [55293.160217285156, 54749.13994598389, 52868.62678909302, 53348.713455200195, 55088.17348241806, 53338.3998708725, 54228.11376953125, 51617.94004249573, 55464.48701095581, 57733.52013206482, 56142.413345336914, 53227.64673995972, 55706.26679420471, 55237.71357727051, 55102.99388694763, 58946.22009277344, 55846.90000915527, 53864.39366149902, 56466.08037567139, 56169.840156555176, 56255.81358718872, 56887.45349884033, 55696.9935131073, 54086.666811943054, 56629.21388339996, 54883.46069073677, 57755.36016082764, 56921.833718299866, 57474.846755981445, 57039.32035255432, 53411.26669692993, 56569.77355957031, 56136.806884765625, 58505.70034790039, 58104.94682312012, 57612.62690734863, 56715.21335411072, 55705.89352416992, 59235.46702194214, 55337.05356216431, 53074.10673522949, 55591.65333557129, 54815.72714614868, 55295.06699180603, 54485.806743621826, 55787.34659576416, 56169.02010536194, 54435.100187301636, 53591.3936252594, 55869.75354003906, 57018.32712554932, 53250.98684692383, 57239.24652862549, 56865.10697329044, 56698.51354980469, 58792.140060424805, 54225.92687416077, 52851.45334529877, 55798.866790771484, 55104.319984436035, 57770.813789367676, 55331.653549194336, 57204.70705795288, 59136.81357002258, 54996.44672393799, 55285.57356262207, 56808.58698272705, 54094.44005393982, 56862.82680130005, 56430.47359085083, 55173.186920166016, 51844.24676036835, 56682.76689147949, 53232.219955444336, 55322.72005081177, 57152.36022949219, 52713.65333366394, 56505.87348175049, 55213.373638153076, 57147.24021053314, 56490.85353088379, 53739.54043900967, 56763.166816711426, 57769.500036239624, 56041.320180892944, 57884.9602766037, 58383.32022857666, 58287.04032897949, 57518.52654647827, 52643.500173568726, 56340.14723777771, 56839.306816101074, 55947.760389328, 56157.47359132767, 58409.740234375, 54924.08695983887, 56911.80025482178, 52325.32656669617, 55291.013427734375, 57011.74662017822, 52628.80051803589, 56082.673199653625, 52887.2201795578, 55248.42007637024, 57108.70704650879, 55706.38012123108, 53831.22017478943, 55626.5671081543, 59522.44665527344, 56707.55349731445, 54259.63984584808, 56513.00005340576, 57007.133544921875, 56996.27360725403, 58311.56008148193, 58322.03340148926, 58018.19327926636, 54866.28005814552, 52592.88026428223, 55741.80684661865], "episode_lengths": [135, 134, 134, 134, 135, 134, 134, 134, 135, 136, 135, 134, 134, 134, 134, 136, 135, 134, 135, 135, 135, 135, 134, 135, 135, 134, 135, 134, 135, 136, 134, 135, 135, 136, 136, 136, 134, 134, 136, 135, 133, 135, 136, 135, 134, 134, 136, 135, 133, 134, 135, 132, 135, 135, 134, 136, 134, 134, 135, 135, 136, 134, 136, 136, 134, 133, 136, 135, 135, 134, 134, 134, 136, 134, 135, 135, 133, 135, 134, 136, 136, 135, 135, 136, 134, 136, 136, 135, 135, 134, 135, 136, 135, 136, 135, 134, 136, 133, 135, 135, 135, 135, 133, 136, 135, 134, 134, 136, 136, 135, 134, 134, 135, 135, 136, 136, 136, 135, 135, 135], "policy_agent_0_reward": [55293.160217285156, 54749.13994598389, 52868.62678909302, 53348.713455200195, 55088.17348241806, 53338.3998708725, 54228.11376953125, 51617.94004249573, 55464.48701095581, 57733.52013206482, 56142.413345336914, 53227.64673995972, 55706.26679420471, 55237.71357727051, 55102.99388694763, 58946.22009277344, 55846.90000915527, 53864.39366149902, 56466.08037567139, 56169.840156555176, 56255.81358718872, 56887.45349884033, 55696.9935131073, 54086.666811943054, 56629.21388339996, 54883.46069073677, 57755.36016082764, 56921.833718299866, 57474.846755981445, 57039.32035255432, 53411.26669692993, 56569.77355957031, 56136.806884765625, 58505.70034790039, 58104.94682312012, 57612.62690734863, 56715.21335411072, 55705.89352416992, 59235.46702194214, 55337.05356216431, 53074.10673522949, 55591.65333557129, 54815.72714614868, 55295.06699180603, 54485.806743621826, 55787.34659576416, 56169.02010536194, 54435.100187301636, 53591.3936252594, 55869.75354003906, 57018.32712554932, 53250.98684692383, 57239.24652862549, 56865.10697329044, 56698.51354980469, 58792.140060424805, 54225.92687416077, 52851.45334529877, 55798.866790771484, 55104.319984436035, 57770.813789367676, 55331.653549194336, 57204.70705795288, 59136.81357002258, 54996.44672393799, 55285.57356262207, 56808.58698272705, 54094.44005393982, 56862.82680130005, 56430.47359085083, 55173.186920166016, 51844.24676036835, 56682.76689147949, 53232.219955444336, 55322.72005081177, 57152.36022949219, 52713.65333366394, 56505.87348175049, 55213.373638153076, 57147.24021053314, 56490.85353088379, 53739.54043900967, 56763.166816711426, 57769.500036239624, 56041.320180892944, 57884.9602766037, 58383.32022857666, 58287.04032897949, 57518.52654647827, 52643.500173568726, 56340.14723777771, 56839.306816101074, 55947.760389328, 56157.47359132767, 58409.740234375, 54924.08695983887, 56911.80025482178, 52325.32656669617, 55291.013427734375, 57011.74662017822, 52628.80051803589, 56082.673199653625, 52887.2201795578, 55248.42007637024, 57108.70704650879, 55706.38012123108, 53831.22017478943, 55626.5671081543, 59522.44665527344, 56707.55349731445, 54259.63984584808, 56513.00005340576, 57007.133544921875, 56996.27360725403, 58311.56008148193, 58322.03340148926, 58018.19327926636, 54866.28005814552, 52592.88026428223, 55741.80684661865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.207071640915025, "mean_inference_ms": 6.695432923496918, "mean_action_processing_ms": 0.20504117751166948, "mean_env_wait_ms": 238.04386666371346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07342437903086345, "StateBufferConnector_ms": 0.006671746571858724, "ViewRequirementAgentConnector_ms": 0.19051730632781982}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.40811885434502, "num_env_steps_trained_throughput_per_sec": 215.40811885434502, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 15035.721, "sample_time_ms": 11872.922, "learn_time_ms": 3008.556, "learn_throughput": 1329.542, "synch_weights_time_ms": 153.484}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 742, "training_iteration": 25, "trial_id": "32397_00000", "date": "2025-03-21_08-43-22", "timestamp": 1742546602, "time_this_iter_s": 18.64081072807312, "time_total_s": 377.51547718048096, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cefa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 377.51547718048096, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 95.70434782608697, "ram_util_percent": 13.378260869565214}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983919143676758, "policy_loss": -0.012089880183339119, "vf_loss": 9.99462890625, "vf_explained_var": 1.4503797274301178e-07, "kl": 0.006900112610310316, "entropy": 0.5785082578659058, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 56629.273765563965, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56343.56700897217, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56629.273765563965}, "policy_reward_mean": {"agent_0": 56343.56700897217}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56629.273765563965, 56057.86025238037], "episode_lengths": [135, 135], "policy_agent_0_reward": [56629.273765563965, 56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.99515343628296, "mean_inference_ms": 7.035565548011807, "mean_action_processing_ms": 0.20717973468684348, "mean_env_wait_ms": 234.6655553987189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056111812591552734, "StateBufferConnector_ms": 0.007426738739013672, "ViewRequirementAgentConnector_ms": 0.15929937362670898}}, "episode_reward_max": 56629.273765563965, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56343.56700897217, "episode_len_mean": 135.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56629.273765563965}, "policy_reward_mean": {"agent_0": 56343.56700897217}, "hist_stats": {"episode_reward": [56629.273765563965, 56057.86025238037], "episode_lengths": [135, 135], "policy_agent_0_reward": [56629.273765563965, 56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.99515343628296, "mean_inference_ms": 7.035565548011807, "mean_action_processing_ms": 0.20717973468684348, "mean_env_wait_ms": 234.6655553987189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056111812591552734, "StateBufferConnector_ms": 0.007426738739013672, "ViewRequirementAgentConnector_ms": 0.15929937362670898}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.02035343525165, "num_env_steps_trained_throughput_per_sec": 286.02035343525165, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 15076.385, "sample_time_ms": 11782.859, "learn_time_ms": 3137.205, "learn_throughput": 1275.02, "synch_weights_time_ms": 155.574}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 744, "training_iteration": 26, "trial_id": "32397_00000", "date": "2025-03-21_08-43-36", "timestamp": 1742546616, "time_this_iter_s": 14.036728143692017, "time_total_s": 391.552205324173, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b1e757880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 391.552205324173, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 99.55263157894737, "ram_util_percent": 13.389473684210529}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989380836486816, "policy_loss": -0.011797335930168629, "vf_loss": 10.0, "vf_explained_var": -1.3286869204875984e-07, "kl": 0.005891889333724976, "entropy": 0.5811805725097656, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 56057.86025238037, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56057.86025238037, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56057.86025238037}, "policy_reward_mean": {"agent_0": 56057.86025238037}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56057.86025238037], "episode_lengths": [135], "policy_agent_0_reward": [56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538032827113998, "mean_inference_ms": 7.1015896058740875, "mean_action_processing_ms": 0.2084448128616681, "mean_env_wait_ms": 230.4361936997394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058770179748535156, "StateBufferConnector_ms": 0.008320808410644531, "ViewRequirementAgentConnector_ms": 0.1705169677734375}}, "episode_reward_max": 56057.86025238037, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56057.86025238037, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56057.86025238037}, "policy_reward_mean": {"agent_0": 56057.86025238037}, "hist_stats": {"episode_reward": [56057.86025238037], "episode_lengths": [135], "policy_agent_0_reward": [56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538032827113998, "mean_inference_ms": 7.1015896058740875, "mean_action_processing_ms": 0.2084448128616681, "mean_env_wait_ms": 230.4361936997394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058770179748535156, "StateBufferConnector_ms": 0.008320808410644531, "ViewRequirementAgentConnector_ms": 0.1705169677734375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.33338787122244, "num_env_steps_trained_throughput_per_sec": 297.33338787122244, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 14552.263, "sample_time_ms": 11255.45, "learn_time_ms": 3137.577, "learn_throughput": 1274.869, "synch_weights_time_ms": 158.482}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 744, "training_iteration": 27, "trial_id": "32397_00000", "date": "2025-03-21_08-43-50", "timestamp": 1742546630, "time_this_iter_s": 13.508557319641113, "time_total_s": 405.0607626438141, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf5b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 405.0607626438141, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 99.58500000000001, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989218711853027, "policy_loss": -0.012143968604505062, "vf_loss": 10.0, "vf_explained_var": 7.003545476891304e-08, "kl": 0.006811619736254215, "entropy": 0.5264780521392822, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 56057.86025238037, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56057.86025238037, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56057.86025238037}, "policy_reward_mean": {"agent_0": 56057.86025238037}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56057.86025238037], "episode_lengths": [135], "policy_agent_0_reward": [56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538032827113998, "mean_inference_ms": 7.1015896058740875, "mean_action_processing_ms": 0.2084448128616681, "mean_env_wait_ms": 230.4361936997394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058770179748535156, "StateBufferConnector_ms": 0.008320808410644531, "ViewRequirementAgentConnector_ms": 0.1705169677734375}}, "episode_reward_max": 56057.86025238037, "episode_reward_min": 56057.86025238037, "episode_reward_mean": 56057.86025238037, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56057.86025238037}, "policy_reward_max": {"agent_0": 56057.86025238037}, "policy_reward_mean": {"agent_0": 56057.86025238037}, "hist_stats": {"episode_reward": [56057.86025238037], "episode_lengths": [135], "policy_agent_0_reward": [56057.86025238037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538032827113998, "mean_inference_ms": 7.1015896058740875, "mean_action_processing_ms": 0.2084448128616681, "mean_env_wait_ms": 230.4361936997394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058770179748535156, "StateBufferConnector_ms": 0.008320808410644531, "ViewRequirementAgentConnector_ms": 0.1705169677734375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.630706705665, "num_env_steps_trained_throughput_per_sec": 302.630706705665, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 14491.304, "sample_time_ms": 11253.033, "learn_time_ms": 3078.306, "learn_throughput": 1299.416, "synch_weights_time_ms": 159.223}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 744, "training_iteration": 28, "trial_id": "32397_00000", "date": "2025-03-21_08-44-03", "timestamp": 1742546643, "time_this_iter_s": 13.270212173461914, "time_total_s": 418.330974817276, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 418.330974817276, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 99.56842105263159, "ram_util_percent": 13.300000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 9.876444816589355, "policy_loss": -0.007567886728793383, "vf_loss": 9.883056640625, "vf_explained_var": 6.556511067401516e-08, "kl": 0.004772148095071316, "entropy": 0.5521952509880066, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 59777.65352630615, "episode_reward_min": 50875.08667564392, "episode_reward_mean": 56301.1549927359, "episode_len_mean": 134.93478260869566, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {"agent_0": 50875.08667564392}, "policy_reward_max": {"agent_0": 59777.65352630615}, "policy_reward_mean": {"agent_0": 56301.1549927359}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59777.65352630615, 56611.280281066895, 55842.91354012489, 56763.20687866211, 55324.82020187378, 57570.16673660278, 57378.493352890015, 57114.56017303467, 59250.14667510986, 56726.22025299072, 52895.46682739258, 56022.480056762695, 53744.673645973206, 58127.16685295105, 52870.780128479004, 56094.166847229004, 56845.82698917389, 55395.26676940918, 54551.286891937256, 58013.8600692749, 58367.8869934082, 57844.98013305664, 56380.29353141785, 50875.08667564392, 56570.35380363464, 52910.0535030365, 59050.18031311035, 57129.213623046875, 55452.47350311279, 56984.27363586426, 57077.71371459961, 55254.70008850098, 55634.51351928711, 56832.72037887573, 57389.52690124512, 55999.886878967285, 58112.753341674805, 53722.933420181274, 55779.40037536621, 56610.01357841492, 56052.7866897583, 53733.12725639343, 57159.72688293457, 55709.16670227051, 59570.51388549805, 56728.41363930702], "episode_lengths": [137, 135, 135, 135, 134, 136, 135, 135, 136, 135, 134, 135, 133, 136, 134, 135, 136, 134, 133, 136, 136, 135, 135, 134, 135, 135, 136, 135, 134, 135, 136, 135, 134, 135, 136, 134, 136, 134, 134, 135, 134, 135, 135, 134, 136, 135], "policy_agent_0_reward": [59777.65352630615, 56611.280281066895, 55842.91354012489, 56763.20687866211, 55324.82020187378, 57570.16673660278, 57378.493352890015, 57114.56017303467, 59250.14667510986, 56726.22025299072, 52895.46682739258, 56022.480056762695, 53744.673645973206, 58127.16685295105, 52870.780128479004, 56094.166847229004, 56845.82698917389, 55395.26676940918, 54551.286891937256, 58013.8600692749, 58367.8869934082, 57844.98013305664, 56380.29353141785, 50875.08667564392, 56570.35380363464, 52910.0535030365, 59050.18031311035, 57129.213623046875, 55452.47350311279, 56984.27363586426, 57077.71371459961, 55254.70008850098, 55634.51351928711, 56832.72037887573, 57389.52690124512, 55999.886878967285, 58112.753341674805, 53722.933420181274, 55779.40037536621, 56610.01357841492, 56052.7866897583, 53733.12725639343, 57159.72688293457, 55709.16670227051, 59570.51388549805, 56728.41363930702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.62826594418765, "mean_inference_ms": 6.518049503537201, "mean_action_processing_ms": 0.20641502740844728, "mean_env_wait_ms": 230.8734696578928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04841711210167926, "StateBufferConnector_ms": 0.007154112276823625, "ViewRequirementAgentConnector_ms": 0.211520298667576}}, "episode_reward_max": 59777.65352630615, "episode_reward_min": 50875.08667564392, "episode_reward_mean": 56301.1549927359, "episode_len_mean": 134.93478260869566, "episodes_this_iter": 46, "policy_reward_min": {"agent_0": 50875.08667564392}, "policy_reward_max": {"agent_0": 59777.65352630615}, "policy_reward_mean": {"agent_0": 56301.1549927359}, "hist_stats": {"episode_reward": [59777.65352630615, 56611.280281066895, 55842.91354012489, 56763.20687866211, 55324.82020187378, 57570.16673660278, 57378.493352890015, 57114.56017303467, 59250.14667510986, 56726.22025299072, 52895.46682739258, 56022.480056762695, 53744.673645973206, 58127.16685295105, 52870.780128479004, 56094.166847229004, 56845.82698917389, 55395.26676940918, 54551.286891937256, 58013.8600692749, 58367.8869934082, 57844.98013305664, 56380.29353141785, 50875.08667564392, 56570.35380363464, 52910.0535030365, 59050.18031311035, 57129.213623046875, 55452.47350311279, 56984.27363586426, 57077.71371459961, 55254.70008850098, 55634.51351928711, 56832.72037887573, 57389.52690124512, 55999.886878967285, 58112.753341674805, 53722.933420181274, 55779.40037536621, 56610.01357841492, 56052.7866897583, 53733.12725639343, 57159.72688293457, 55709.16670227051, 59570.51388549805, 56728.41363930702], "episode_lengths": [137, 135, 135, 135, 134, 136, 135, 135, 136, 135, 134, 135, 133, 136, 134, 135, 136, 134, 133, 136, 136, 135, 135, 134, 135, 135, 136, 135, 134, 135, 136, 135, 134, 135, 136, 134, 136, 134, 134, 135, 134, 135, 135, 134, 136, 135], "policy_agent_0_reward": [59777.65352630615, 56611.280281066895, 55842.91354012489, 56763.20687866211, 55324.82020187378, 57570.16673660278, 57378.493352890015, 57114.56017303467, 59250.14667510986, 56726.22025299072, 52895.46682739258, 56022.480056762695, 53744.673645973206, 58127.16685295105, 52870.780128479004, 56094.166847229004, 56845.82698917389, 55395.26676940918, 54551.286891937256, 58013.8600692749, 58367.8869934082, 57844.98013305664, 56380.29353141785, 50875.08667564392, 56570.35380363464, 52910.0535030365, 59050.18031311035, 57129.213623046875, 55452.47350311279, 56984.27363586426, 57077.71371459961, 55254.70008850098, 55634.51351928711, 56832.72037887573, 57389.52690124512, 55999.886878967285, 58112.753341674805, 53722.933420181274, 55779.40037536621, 56610.01357841492, 56052.7866897583, 53733.12725639343, 57159.72688293457, 55709.16670227051, 59570.51388549805, 56728.41363930702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.62826594418765, "mean_inference_ms": 6.518049503537201, "mean_action_processing_ms": 0.20641502740844728, "mean_env_wait_ms": 230.8734696578928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04841711210167926, "StateBufferConnector_ms": 0.007154112276823625, "ViewRequirementAgentConnector_ms": 0.211520298667576}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.36750788167134, "num_env_steps_trained_throughput_per_sec": 253.36750788167134, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 14681.446, "sample_time_ms": 11550.742, "learn_time_ms": 2974.233, "learn_throughput": 1344.885, "synch_weights_time_ms": 154.588}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 790, "training_iteration": 29, "trial_id": "32397_00000", "date": "2025-03-21_08-44-19", "timestamp": 1742546659, "time_this_iter_s": 15.835531949996948, "time_total_s": 434.16650676727295, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f13010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 434.16650676727295, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 97.33500000000001, "ram_util_percent": 13.370000000000001}}
{"custom_metrics": {"num_batches_mean": 5.961538461538462, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.794857025146484, "policy_loss": -0.009431842714548111, "vf_loss": 9.8037109375, "vf_explained_var": 1.8142164037726616e-07, "kl": 0.005764216184616089, "entropy": 0.5110635161399841, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 59639.533615112305, "episode_reward_min": 53030.020367622375, "episode_reward_mean": 56657.552326780096, "episode_len_mean": 135.1153846153846, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {"agent_0": 53030.020367622375}, "policy_reward_max": {"agent_0": 59639.533615112305}, "policy_reward_mean": {"agent_0": 56657.552326780096}, "custom_metrics": {"num_batches_mean": 5.961538461538462, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56990.406745910645, 55030.66691970825, 55104.933364868164, 55928.03340911865, 57613.02666473389, 57302.646713256836, 58109.4336643219, 55981.79998397827, 58278.246673583984, 56240.753410339355, 56499.72685241699, 55581.166734695435, 57383.27355957031, 55520.54035949707, 58335.18020629883, 56523.96026611328, 57007.45361328125, 58159.86715698242, 55300.640087127686, 57023.613426208496, 57248.54023742676, 58207.7069644928, 56739.70026779175, 56045.07345581055, 54221.78045272827, 55383.65344238281, 57312.22679901123, 56194.613664627075, 59031.353454589844, 53030.020367622375, 57285.30014038086, 55613.90639877319, 57926.9602432251, 57397.6004486084, 58050.71362113953, 56094.06673812866, 55726.920124053955, 59183.733719825745, 57804.13996696472, 55891.16682243347, 55513.966873168945, 56485.133496284485, 54318.02013683319, 57353.54670715332, 55529.213523864746, 58589.046798706055, 55577.27351093292, 57945.33352661133, 54728.6803855896, 58169.54700469971, 56685.340270996094, 56131.04020500183, 55419.3203086853, 56225.547103881836, 56868.300384521484, 59639.533615112305, 57792.11989712715, 56408.23344993591, 55486.740100860596, 57117.240142822266, 56126.18701648712, 56705.0334815979, 54234.49349308014, 54377.253772735596, 58277.21355819702, 57069.873359680176, 56616.43354034424, 56930.68705749512, 58605.09349441528, 57604.64009857178, 55691.826751708984, 55660.760009765625, 58558.69360733032, 53507.43998527527, 59216.30699157715, 56667.106941223145, 56445.99358463287, 56706.32015991211], "episode_lengths": [135, 135, 134, 135, 136, 135, 135, 134, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 133, 134, 135, 135, 136, 133, 136, 134, 135, 135, 136, 135, 135, 137, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135, 135, 135, 137, 136, 135, 135, 135, 135, 135, 135, 135, 136, 134, 136, 135, 136, 136, 134, 134, 136, 134, 136, 135, 136, 135], "policy_agent_0_reward": [56990.406745910645, 55030.66691970825, 55104.933364868164, 55928.03340911865, 57613.02666473389, 57302.646713256836, 58109.4336643219, 55981.79998397827, 58278.246673583984, 56240.753410339355, 56499.72685241699, 55581.166734695435, 57383.27355957031, 55520.54035949707, 58335.18020629883, 56523.96026611328, 57007.45361328125, 58159.86715698242, 55300.640087127686, 57023.613426208496, 57248.54023742676, 58207.7069644928, 56739.70026779175, 56045.07345581055, 54221.78045272827, 55383.65344238281, 57312.22679901123, 56194.613664627075, 59031.353454589844, 53030.020367622375, 57285.30014038086, 55613.90639877319, 57926.9602432251, 57397.6004486084, 58050.71362113953, 56094.06673812866, 55726.920124053955, 59183.733719825745, 57804.13996696472, 55891.16682243347, 55513.966873168945, 56485.133496284485, 54318.02013683319, 57353.54670715332, 55529.213523864746, 58589.046798706055, 55577.27351093292, 57945.33352661133, 54728.6803855896, 58169.54700469971, 56685.340270996094, 56131.04020500183, 55419.3203086853, 56225.547103881836, 56868.300384521484, 59639.533615112305, 57792.11989712715, 56408.23344993591, 55486.740100860596, 57117.240142822266, 56126.18701648712, 56705.0334815979, 54234.49349308014, 54377.253772735596, 58277.21355819702, 57069.873359680176, 56616.43354034424, 56930.68705749512, 58605.09349441528, 57604.64009857178, 55691.826751708984, 55660.760009765625, 58558.69360733032, 53507.43998527527, 59216.30699157715, 56667.106941223145, 56445.99358463287, 56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58872327016007, "mean_inference_ms": 6.819580556705178, "mean_action_processing_ms": 0.20322390899621556, "mean_env_wait_ms": 240.58375702033052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0597535035549066, "StateBufferConnector_ms": 0.014522442450890174, "ViewRequirementAgentConnector_ms": 0.2402476775340545}}, "episode_reward_max": 59639.533615112305, "episode_reward_min": 53030.020367622375, "episode_reward_mean": 56657.552326780096, "episode_len_mean": 135.1153846153846, "episodes_this_iter": 78, "policy_reward_min": {"agent_0": 53030.020367622375}, "policy_reward_max": {"agent_0": 59639.533615112305}, "policy_reward_mean": {"agent_0": 56657.552326780096}, "hist_stats": {"episode_reward": [56990.406745910645, 55030.66691970825, 55104.933364868164, 55928.03340911865, 57613.02666473389, 57302.646713256836, 58109.4336643219, 55981.79998397827, 58278.246673583984, 56240.753410339355, 56499.72685241699, 55581.166734695435, 57383.27355957031, 55520.54035949707, 58335.18020629883, 56523.96026611328, 57007.45361328125, 58159.86715698242, 55300.640087127686, 57023.613426208496, 57248.54023742676, 58207.7069644928, 56739.70026779175, 56045.07345581055, 54221.78045272827, 55383.65344238281, 57312.22679901123, 56194.613664627075, 59031.353454589844, 53030.020367622375, 57285.30014038086, 55613.90639877319, 57926.9602432251, 57397.6004486084, 58050.71362113953, 56094.06673812866, 55726.920124053955, 59183.733719825745, 57804.13996696472, 55891.16682243347, 55513.966873168945, 56485.133496284485, 54318.02013683319, 57353.54670715332, 55529.213523864746, 58589.046798706055, 55577.27351093292, 57945.33352661133, 54728.6803855896, 58169.54700469971, 56685.340270996094, 56131.04020500183, 55419.3203086853, 56225.547103881836, 56868.300384521484, 59639.533615112305, 57792.11989712715, 56408.23344993591, 55486.740100860596, 57117.240142822266, 56126.18701648712, 56705.0334815979, 54234.49349308014, 54377.253772735596, 58277.21355819702, 57069.873359680176, 56616.43354034424, 56930.68705749512, 58605.09349441528, 57604.64009857178, 55691.826751708984, 55660.760009765625, 58558.69360733032, 53507.43998527527, 59216.30699157715, 56667.106941223145, 56445.99358463287, 56706.32015991211], "episode_lengths": [135, 135, 134, 135, 136, 135, 135, 134, 135, 135, 136, 135, 135, 135, 136, 135, 135, 135, 135, 135, 135, 136, 136, 135, 133, 134, 135, 135, 136, 133, 136, 134, 135, 135, 136, 135, 135, 137, 135, 135, 134, 135, 135, 135, 135, 135, 136, 135, 134, 136, 136, 135, 135, 135, 135, 137, 136, 135, 135, 135, 135, 135, 135, 135, 136, 134, 136, 135, 136, 136, 134, 134, 136, 134, 136, 135, 136, 135], "policy_agent_0_reward": [56990.406745910645, 55030.66691970825, 55104.933364868164, 55928.03340911865, 57613.02666473389, 57302.646713256836, 58109.4336643219, 55981.79998397827, 58278.246673583984, 56240.753410339355, 56499.72685241699, 55581.166734695435, 57383.27355957031, 55520.54035949707, 58335.18020629883, 56523.96026611328, 57007.45361328125, 58159.86715698242, 55300.640087127686, 57023.613426208496, 57248.54023742676, 58207.7069644928, 56739.70026779175, 56045.07345581055, 54221.78045272827, 55383.65344238281, 57312.22679901123, 56194.613664627075, 59031.353454589844, 53030.020367622375, 57285.30014038086, 55613.90639877319, 57926.9602432251, 57397.6004486084, 58050.71362113953, 56094.06673812866, 55726.920124053955, 59183.733719825745, 57804.13996696472, 55891.16682243347, 55513.966873168945, 56485.133496284485, 54318.02013683319, 57353.54670715332, 55529.213523864746, 58589.046798706055, 55577.27351093292, 57945.33352661133, 54728.6803855896, 58169.54700469971, 56685.340270996094, 56131.04020500183, 55419.3203086853, 56225.547103881836, 56868.300384521484, 59639.533615112305, 57792.11989712715, 56408.23344993591, 55486.740100860596, 57117.240142822266, 56126.18701648712, 56705.0334815979, 54234.49349308014, 54377.253772735596, 58277.21355819702, 57069.873359680176, 56616.43354034424, 56930.68705749512, 58605.09349441528, 57604.64009857178, 55691.826751708984, 55660.760009765625, 58558.69360733032, 53507.43998527527, 59216.30699157715, 56667.106941223145, 56445.99358463287, 56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58872327016007, "mean_inference_ms": 6.819580556705178, "mean_action_processing_ms": 0.20322390899621556, "mean_env_wait_ms": 240.58375702033052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0597535035549066, "StateBufferConnector_ms": 0.014522442450890174, "ViewRequirementAgentConnector_ms": 0.2402476775340545}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.4965857739579, "num_env_steps_trained_throughput_per_sec": 237.4965857739579, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 15009.863, "sample_time_ms": 11874.707, "learn_time_ms": 2979.534, "learn_throughput": 1342.492, "synch_weights_time_ms": 153.741}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 868, "training_iteration": 30, "trial_id": "32397_00000", "date": "2025-03-21_08-44-36", "timestamp": 1742546676, "time_this_iter_s": 16.90946650505066, "time_total_s": 451.0759732723236, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedcf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 451.0759732723236, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 98.18260869565219, "ram_util_percent": 13.399999999999997}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98913288116455, "policy_loss": -0.011485351249575615, "vf_loss": 10.0, "vf_explained_var": 6.506840577458206e-08, "kl": 0.006177693139761686, "entropy": 0.483366459608078, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 56706.32015991211, "episode_reward_min": 56706.32015991211, "episode_reward_mean": 56706.32015991211, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56706.32015991211}, "policy_reward_max": {"agent_0": 56706.32015991211}, "policy_reward_mean": {"agent_0": 56706.32015991211}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56706.32015991211], "episode_lengths": [135], "policy_agent_0_reward": [56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.474818867773713, "mean_inference_ms": 6.614935385697093, "mean_action_processing_ms": 0.19949978521785675, "mean_env_wait_ms": 248.33831008093412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03371238708496094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1407623291015625}}, "episode_reward_max": 56706.32015991211, "episode_reward_min": 56706.32015991211, "episode_reward_mean": 56706.32015991211, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56706.32015991211}, "policy_reward_max": {"agent_0": 56706.32015991211}, "policy_reward_mean": {"agent_0": 56706.32015991211}, "hist_stats": {"episode_reward": [56706.32015991211], "episode_lengths": [135], "policy_agent_0_reward": [56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.474818867773713, "mean_inference_ms": 6.614935385697093, "mean_action_processing_ms": 0.19949978521785675, "mean_env_wait_ms": 248.33831008093412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03371238708496094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1407623291015625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.3618016503334, "num_env_steps_trained_throughput_per_sec": 312.3618016503334, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 14417.084, "sample_time_ms": 11317.418, "learn_time_ms": 2951.12, "learn_throughput": 1355.418, "synch_weights_time_ms": 146.67}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 868, "training_iteration": 31, "trial_id": "32397_00000", "date": "2025-03-21_08-44-49", "timestamp": 1742546689, "time_this_iter_s": 12.859251976013184, "time_total_s": 463.9352252483368, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 463.9352252483368, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 99.63333333333334, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987329483032227, "policy_loss": -0.013590884394943714, "vf_loss": 10.0, "vf_explained_var": 1.5677262865665398e-07, "kl": 0.009194483049213886, "entropy": 0.4888245165348053, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 56706.32015991211, "episode_reward_min": 56706.32015991211, "episode_reward_mean": 56706.32015991211, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56706.32015991211}, "policy_reward_max": {"agent_0": 56706.32015991211}, "policy_reward_mean": {"agent_0": 56706.32015991211}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56706.32015991211], "episode_lengths": [135], "policy_agent_0_reward": [56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.474818867773713, "mean_inference_ms": 6.614935385697093, "mean_action_processing_ms": 0.19949978521785675, "mean_env_wait_ms": 248.33831008093412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03371238708496094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1407623291015625}}, "episode_reward_max": 56706.32015991211, "episode_reward_min": 56706.32015991211, "episode_reward_mean": 56706.32015991211, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56706.32015991211}, "policy_reward_max": {"agent_0": 56706.32015991211}, "policy_reward_mean": {"agent_0": 56706.32015991211}, "hist_stats": {"episode_reward": [56706.32015991211], "episode_lengths": [135], "policy_agent_0_reward": [56706.32015991211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.474818867773713, "mean_inference_ms": 6.614935385697093, "mean_action_processing_ms": 0.19949978521785675, "mean_env_wait_ms": 248.33831008093412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03371238708496094, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.1407623291015625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.91192347253013, "num_env_steps_trained_throughput_per_sec": 301.91192347253013, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 14411.719, "sample_time_ms": 11323.192, "learn_time_ms": 2945.184, "learn_throughput": 1358.15, "synch_weights_time_ms": 141.504}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 868, "training_iteration": 32, "trial_id": "32397_00000", "date": "2025-03-21_08-45-02", "timestamp": 1742546702, "time_this_iter_s": 13.299148082733154, "time_total_s": 477.23437333106995, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 477.23437333106995, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 99.58421052631581, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.911782264709473, "policy_loss": -0.009490943513810635, "vf_loss": 9.920654296875, "vf_explained_var": -1.5522042540183634e-09, "kl": 0.006184407044202089, "entropy": 0.47640857100486755, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 59635.98684513569, "episode_reward_min": 53683.68664932251, "episode_reward_mean": 57164.51250844821, "episode_len_mean": 135.375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 53683.68664932251}, "policy_reward_max": {"agent_0": 59635.98684513569}, "policy_reward_mean": {"agent_0": 57164.51250844821}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55491.41352844238, 56190.01353573799, 59059.607025146484, 58749.45372009277, 57945.28022003174, 58028.73361206055, 56553.8669128418, 59635.98684513569, 58814.53367614746, 56234.76043891907, 57802.393409729004, 58724.31994819641, 56773.333950042725, 53683.68664932251, 55696.86666870117, 56518.90693664551, 56382.41339492798, 58585.226623535156, 56990.273571014404, 57274.220069885254, 56945.55352783203, 56897.29365539551, 58359.59369277954, 57621.92002534866, 58922.30702209473, 54069.74033355713, 57704.806765556335, 56734.540298461914, 55686.35354614258, 55925.32020378113, 58058.91351032257, 57202.76695251465], "episode_lengths": [134, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 135, 134, 134, 135, 136, 136, 135, 136, 135, 136, 136, 135, 137, 134, 136, 135, 135, 134, 136, 136], "policy_agent_0_reward": [55491.41352844238, 56190.01353573799, 59059.607025146484, 58749.45372009277, 57945.28022003174, 58028.73361206055, 56553.8669128418, 59635.98684513569, 58814.53367614746, 56234.76043891907, 57802.393409729004, 58724.31994819641, 56773.333950042725, 53683.68664932251, 55696.86666870117, 56518.90693664551, 56382.41339492798, 58585.226623535156, 56990.273571014404, 57274.220069885254, 56945.55352783203, 56897.29365539551, 58359.59369277954, 57621.92002534866, 58922.30702209473, 54069.74033355713, 57704.806765556335, 56734.540298461914, 55686.35354614258, 55925.32020378113, 58058.91351032257, 57202.76695251465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.58601360938965, "mean_inference_ms": 6.368174588461535, "mean_action_processing_ms": 0.20692034052052627, "mean_env_wait_ms": 225.32192767349954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06434693932533264, "StateBufferConnector_ms": 0.006779283285140991, "ViewRequirementAgentConnector_ms": 0.4258066415786743}}, "episode_reward_max": 59635.98684513569, "episode_reward_min": 53683.68664932251, "episode_reward_mean": 57164.51250844821, "episode_len_mean": 135.375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 53683.68664932251}, "policy_reward_max": {"agent_0": 59635.98684513569}, "policy_reward_mean": {"agent_0": 57164.51250844821}, "hist_stats": {"episode_reward": [55491.41352844238, 56190.01353573799, 59059.607025146484, 58749.45372009277, 57945.28022003174, 58028.73361206055, 56553.8669128418, 59635.98684513569, 58814.53367614746, 56234.76043891907, 57802.393409729004, 58724.31994819641, 56773.333950042725, 53683.68664932251, 55696.86666870117, 56518.90693664551, 56382.41339492798, 58585.226623535156, 56990.273571014404, 57274.220069885254, 56945.55352783203, 56897.29365539551, 58359.59369277954, 57621.92002534866, 58922.30702209473, 54069.74033355713, 57704.806765556335, 56734.540298461914, 55686.35354614258, 55925.32020378113, 58058.91351032257, 57202.76695251465], "episode_lengths": [134, 135, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 135, 134, 134, 135, 136, 136, 135, 136, 135, 136, 136, 135, 137, 134, 136, 135, 135, 134, 136, 136], "policy_agent_0_reward": [55491.41352844238, 56190.01353573799, 59059.607025146484, 58749.45372009277, 57945.28022003174, 58028.73361206055, 56553.8669128418, 59635.98684513569, 58814.53367614746, 56234.76043891907, 57802.393409729004, 58724.31994819641, 56773.333950042725, 53683.68664932251, 55696.86666870117, 56518.90693664551, 56382.41339492798, 58585.226623535156, 56990.273571014404, 57274.220069885254, 56945.55352783203, 56897.29365539551, 58359.59369277954, 57621.92002534866, 58922.30702209473, 54069.74033355713, 57704.806765556335, 56734.540298461914, 55686.35354614258, 55925.32020378113, 58058.91351032257, 57202.76695251465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.58601360938965, "mean_inference_ms": 6.368174588461535, "mean_action_processing_ms": 0.20692034052052627, "mean_env_wait_ms": 225.32192767349954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06434693932533264, "StateBufferConnector_ms": 0.006779283285140991, "ViewRequirementAgentConnector_ms": 0.4258066415786743}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.96446677622137, "num_env_steps_trained_throughput_per_sec": 236.96446677622137, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 14781.345, "sample_time_ms": 11703.165, "learn_time_ms": 2937.861, "learn_throughput": 1361.535, "synch_weights_time_ms": 138.489}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 900, "training_iteration": 33, "trial_id": "32397_00000", "date": "2025-03-21_08-45-19", "timestamp": 1742546719, "time_this_iter_s": 16.93419861793518, "time_total_s": 494.1685719490051, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f130a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 494.1685719490051, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 99.22608695652175, "ram_util_percent": 13.399999999999997}}
{"custom_metrics": {"num_batches_mean": 5.076086956521739, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.748804092407227, "policy_loss": -0.011288479901850224, "vf_loss": 9.759403228759766, "vf_explained_var": -1.5864769693507697e-06, "kl": 0.006883958354592323, "entropy": 0.46880003809928894, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 61845.640144348145, "episode_reward_min": 54159.48682785034, "episode_reward_mean": 57212.1285273044, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 54159.48682785034}, "policy_reward_max": {"agent_0": 61845.640144348145}, "policy_reward_mean": {"agent_0": 57212.1285273044}, "custom_metrics": {"num_batches_mean": 5.076086956521739, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54953.5998840332, 57137.68671417236, 59250.160095214844, 56373.67330956459, 57652.58010864258, 54159.48682785034, 58114.49374961853, 55901.3268737793, 56280.84668254852, 57024.15365242958, 58186.70004463196, 58144.09353637695, 56051.120262145996, 58783.266693115234, 59185.97350311279, 55434.39348602295, 55239.22678375244, 56435.75354003906, 56639.94009590149, 59432.660331726074, 57144.073333740234, 57978.093688964844, 58837.70021820068, 55247.59331893921, 57569.32027053833, 58127.10004425049, 55299.47373962402, 56466.2399597168, 58272.72018432617, 58576.45369720459, 57018.65365600586, 57082.06001281738, 58067.68021059036, 57895.800216674805, 56559.36672592163, 56905.220167160034, 56618.03342568874, 56775.2000579834, 57139.25318527222, 57801.10023498535, 58607.24712181091, 57280.86689376831, 55848.2600069046, 54968.26029205322, 58128.7003326416, 56071.28002166748, 54310.820446014404, 55357.24038505554, 58498.21356201172, 58302.420097351074, 58034.47333526611, 61845.640144348145, 55289.953704833984, 57400.480335235596, 57728.293365478516, 54500.89345550537, 55026.5604095459, 56418.333362579346, 59147.693256378174, 55750.25375878811, 58180.61364746094, 57580.020248413086, 58680.50038146973, 56147.140144348145, 55672.63362121582, 57685.440002441406, 55945.32027435303, 58014.54692077637, 58364.60030293465, 56319.01348876953, 55081.333684921265, 59359.9201965332, 58281.27356815338, 56104.80017089844, 58842.47351074219, 58901.88014984131, 57547.88047790527, 56983.96696090698, 56367.44010543823, 57929.56042480469, 56624.153663635254, 58059.58714103699, 59154.440311431885, 55401.37353515625, 56284.166883945465, 57275.78003692627, 57298.126708984375, 57728.18022251129, 58485.94691467285, 56860.14041137695, 57447.673751831055, 60627.739837646484], "episode_lengths": [134, 136, 136, 136, 135, 135, 136, 135, 135, 135, 137, 137, 134, 136, 136, 134, 135, 135, 136, 136, 136, 136, 135, 135, 136, 137, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 138, 135, 135, 134, 135, 134, 135, 135, 135, 136, 135, 138, 135, 136, 135, 134, 136, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 136, 137, 134, 136, 137, 136, 135, 137, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 134, 135, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54953.5998840332, 57137.68671417236, 59250.160095214844, 56373.67330956459, 57652.58010864258, 54159.48682785034, 58114.49374961853, 55901.3268737793, 56280.84668254852, 57024.15365242958, 58186.70004463196, 58144.09353637695, 56051.120262145996, 58783.266693115234, 59185.97350311279, 55434.39348602295, 55239.22678375244, 56435.75354003906, 56639.94009590149, 59432.660331726074, 57144.073333740234, 57978.093688964844, 58837.70021820068, 55247.59331893921, 57569.32027053833, 58127.10004425049, 55299.47373962402, 56466.2399597168, 58272.72018432617, 58576.45369720459, 57018.65365600586, 57082.06001281738, 58067.68021059036, 57895.800216674805, 56559.36672592163, 56905.220167160034, 56618.03342568874, 56775.2000579834, 57139.25318527222, 57801.10023498535, 58607.24712181091, 57280.86689376831, 55848.2600069046, 54968.26029205322, 58128.7003326416, 56071.28002166748, 54310.820446014404, 55357.24038505554, 58498.21356201172, 58302.420097351074, 58034.47333526611, 61845.640144348145, 55289.953704833984, 57400.480335235596, 57728.293365478516, 54500.89345550537, 55026.5604095459, 56418.333362579346, 59147.693256378174, 55750.25375878811, 58180.61364746094, 57580.020248413086, 58680.50038146973, 56147.140144348145, 55672.63362121582, 57685.440002441406, 55945.32027435303, 58014.54692077637, 58364.60030293465, 56319.01348876953, 55081.333684921265, 59359.9201965332, 58281.27356815338, 56104.80017089844, 58842.47351074219, 58901.88014984131, 57547.88047790527, 56983.96696090698, 56367.44010543823, 57929.56042480469, 56624.153663635254, 58059.58714103699, 59154.440311431885, 55401.37353515625, 56284.166883945465, 57275.78003692627, 57298.126708984375, 57728.18022251129, 58485.94691467285, 56860.14041137695, 57447.673751831055, 60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538401001460276, "mean_inference_ms": 6.77787313091211, "mean_action_processing_ms": 0.2021210400288218, "mean_env_wait_ms": 239.98882808899288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04303714503412661, "StateBufferConnector_ms": 0.00647772913393767, "ViewRequirementAgentConnector_ms": 0.2201409443565037}}, "episode_reward_max": 61845.640144348145, "episode_reward_min": 54159.48682785034, "episode_reward_mean": 57212.1285273044, "episode_len_mean": 135.5, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 54159.48682785034}, "policy_reward_max": {"agent_0": 61845.640144348145}, "policy_reward_mean": {"agent_0": 57212.1285273044}, "hist_stats": {"episode_reward": [54953.5998840332, 57137.68671417236, 59250.160095214844, 56373.67330956459, 57652.58010864258, 54159.48682785034, 58114.49374961853, 55901.3268737793, 56280.84668254852, 57024.15365242958, 58186.70004463196, 58144.09353637695, 56051.120262145996, 58783.266693115234, 59185.97350311279, 55434.39348602295, 55239.22678375244, 56435.75354003906, 56639.94009590149, 59432.660331726074, 57144.073333740234, 57978.093688964844, 58837.70021820068, 55247.59331893921, 57569.32027053833, 58127.10004425049, 55299.47373962402, 56466.2399597168, 58272.72018432617, 58576.45369720459, 57018.65365600586, 57082.06001281738, 58067.68021059036, 57895.800216674805, 56559.36672592163, 56905.220167160034, 56618.03342568874, 56775.2000579834, 57139.25318527222, 57801.10023498535, 58607.24712181091, 57280.86689376831, 55848.2600069046, 54968.26029205322, 58128.7003326416, 56071.28002166748, 54310.820446014404, 55357.24038505554, 58498.21356201172, 58302.420097351074, 58034.47333526611, 61845.640144348145, 55289.953704833984, 57400.480335235596, 57728.293365478516, 54500.89345550537, 55026.5604095459, 56418.333362579346, 59147.693256378174, 55750.25375878811, 58180.61364746094, 57580.020248413086, 58680.50038146973, 56147.140144348145, 55672.63362121582, 57685.440002441406, 55945.32027435303, 58014.54692077637, 58364.60030293465, 56319.01348876953, 55081.333684921265, 59359.9201965332, 58281.27356815338, 56104.80017089844, 58842.47351074219, 58901.88014984131, 57547.88047790527, 56983.96696090698, 56367.44010543823, 57929.56042480469, 56624.153663635254, 58059.58714103699, 59154.440311431885, 55401.37353515625, 56284.166883945465, 57275.78003692627, 57298.126708984375, 57728.18022251129, 58485.94691467285, 56860.14041137695, 57447.673751831055, 60627.739837646484], "episode_lengths": [134, 136, 136, 136, 135, 135, 136, 135, 135, 135, 137, 137, 134, 136, 136, 134, 135, 135, 136, 136, 136, 136, 135, 135, 136, 137, 135, 135, 136, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 135, 138, 135, 135, 134, 135, 134, 135, 135, 135, 136, 135, 138, 135, 136, 135, 134, 136, 135, 136, 135, 136, 135, 136, 136, 136, 136, 135, 136, 137, 134, 136, 137, 136, 135, 137, 136, 136, 135, 135, 135, 135, 136, 136, 135, 136, 134, 135, 136, 136, 135, 135, 136], "policy_agent_0_reward": [54953.5998840332, 57137.68671417236, 59250.160095214844, 56373.67330956459, 57652.58010864258, 54159.48682785034, 58114.49374961853, 55901.3268737793, 56280.84668254852, 57024.15365242958, 58186.70004463196, 58144.09353637695, 56051.120262145996, 58783.266693115234, 59185.97350311279, 55434.39348602295, 55239.22678375244, 56435.75354003906, 56639.94009590149, 59432.660331726074, 57144.073333740234, 57978.093688964844, 58837.70021820068, 55247.59331893921, 57569.32027053833, 58127.10004425049, 55299.47373962402, 56466.2399597168, 58272.72018432617, 58576.45369720459, 57018.65365600586, 57082.06001281738, 58067.68021059036, 57895.800216674805, 56559.36672592163, 56905.220167160034, 56618.03342568874, 56775.2000579834, 57139.25318527222, 57801.10023498535, 58607.24712181091, 57280.86689376831, 55848.2600069046, 54968.26029205322, 58128.7003326416, 56071.28002166748, 54310.820446014404, 55357.24038505554, 58498.21356201172, 58302.420097351074, 58034.47333526611, 61845.640144348145, 55289.953704833984, 57400.480335235596, 57728.293365478516, 54500.89345550537, 55026.5604095459, 56418.333362579346, 59147.693256378174, 55750.25375878811, 58180.61364746094, 57580.020248413086, 58680.50038146973, 56147.140144348145, 55672.63362121582, 57685.440002441406, 55945.32027435303, 58014.54692077637, 58364.60030293465, 56319.01348876953, 55081.333684921265, 59359.9201965332, 58281.27356815338, 56104.80017089844, 58842.47351074219, 58901.88014984131, 57547.88047790527, 56983.96696090698, 56367.44010543823, 57929.56042480469, 56624.153663635254, 58059.58714103699, 59154.440311431885, 55401.37353515625, 56284.166883945465, 57275.78003692627, 57298.126708984375, 57728.18022251129, 58485.94691467285, 56860.14041137695, 57447.673751831055, 60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.538401001460276, "mean_inference_ms": 6.77787313091211, "mean_action_processing_ms": 0.2021210400288218, "mean_env_wait_ms": 239.98882808899288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04303714503412661, "StateBufferConnector_ms": 0.00647772913393767, "ViewRequirementAgentConnector_ms": 0.2201409443565037}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.82319452599486, "num_env_steps_trained_throughput_per_sec": 246.82319452599486, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 15099.467, "sample_time_ms": 11993.02, "learn_time_ms": 2961.09, "learn_throughput": 1350.854, "synch_weights_time_ms": 143.518}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 992, "training_iteration": 34, "trial_id": "32397_00000", "date": "2025-03-21_08-45-35", "timestamp": 1742546735, "time_this_iter_s": 16.262757778167725, "time_total_s": 510.43132972717285, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cefa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 510.43132972717285, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 96.67826086956521, "ram_util_percent": 13.399999999999997}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993353843688965, "policy_loss": -0.007172901649028063, "vf_loss": 10.0, "vf_explained_var": -6.550301918650803e-07, "kl": 0.00527119729667902, "entropy": 0.44082096219062805, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 60627.739837646484, "episode_reward_min": 60627.739837646484, "episode_reward_mean": 60627.739837646484, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60627.739837646484}, "policy_reward_max": {"agent_0": 60627.739837646484}, "policy_reward_mean": {"agent_0": 60627.739837646484}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60627.739837646484], "episode_lengths": [136], "policy_agent_0_reward": [60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.433009356944467, "mean_inference_ms": 6.517679566522603, "mean_action_processing_ms": 0.1973987610872127, "mean_env_wait_ms": 245.64865294457357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.17180442810058594}}, "episode_reward_max": 60627.739837646484, "episode_reward_min": 60627.739837646484, "episode_reward_mean": 60627.739837646484, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60627.739837646484}, "policy_reward_max": {"agent_0": 60627.739837646484}, "policy_reward_mean": {"agent_0": 60627.739837646484}, "hist_stats": {"episode_reward": [60627.739837646484], "episode_lengths": [136], "policy_agent_0_reward": [60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.433009356944467, "mean_inference_ms": 6.517679566522603, "mean_action_processing_ms": 0.1973987610872127, "mean_env_wait_ms": 245.64865294457357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.17180442810058594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2696724802631, "num_env_steps_trained_throughput_per_sec": 297.2696724802631, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 14588.108, "sample_time_ms": 11430.666, "learn_time_ms": 3008.39, "learn_throughput": 1329.615, "synch_weights_time_ms": 147.226}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 992, "training_iteration": 35, "trial_id": "32397_00000", "date": "2025-03-21_08-45-49", "timestamp": 1742546749, "time_this_iter_s": 13.51130986213684, "time_total_s": 523.9426395893097, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 523.9426395893097, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 99.53684210526316, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.991633415222168, "policy_loss": -0.008874376304447651, "vf_loss": 10.0, "vf_explained_var": -3.892307347541646e-07, "kl": 0.005075747612863779, "entropy": 0.45436763763427734, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 60627.739837646484, "episode_reward_min": 60627.739837646484, "episode_reward_mean": 60627.739837646484, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60627.739837646484}, "policy_reward_max": {"agent_0": 60627.739837646484}, "policy_reward_mean": {"agent_0": 60627.739837646484}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60627.739837646484], "episode_lengths": [136], "policy_agent_0_reward": [60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.433009356944467, "mean_inference_ms": 6.517679566522603, "mean_action_processing_ms": 0.1973987610872127, "mean_env_wait_ms": 245.64865294457357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.17180442810058594}}, "episode_reward_max": 60627.739837646484, "episode_reward_min": 60627.739837646484, "episode_reward_mean": 60627.739837646484, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60627.739837646484}, "policy_reward_max": {"agent_0": 60627.739837646484}, "policy_reward_mean": {"agent_0": 60627.739837646484}, "hist_stats": {"episode_reward": [60627.739837646484], "episode_lengths": [136], "policy_agent_0_reward": [60627.739837646484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.433009356944467, "mean_inference_ms": 6.517679566522603, "mean_action_processing_ms": 0.1973987610872127, "mean_env_wait_ms": 245.64865294457357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04012584686279297, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.17180442810058594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.41671109748387, "num_env_steps_trained_throughput_per_sec": 297.41671109748387, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14534.518, "sample_time_ms": 11415.516, "learn_time_ms": 2972.012, "learn_throughput": 1345.89, "synch_weights_time_ms": 145.14}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 992, "training_iteration": 36, "trial_id": "32397_00000", "date": "2025-03-21_08-46-02", "timestamp": 1742546762, "time_this_iter_s": 13.499727487564087, "time_total_s": 537.4423670768738, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedcf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 537.4423670768738, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 99.55263157894738, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909421920776367, "policy_loss": -0.010931241326034069, "vf_loss": 9.919679641723633, "vf_explained_var": 1.4435499906539917e-07, "kl": 0.006731285713613033, "entropy": 0.4317801296710968, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 60147.08679199219, "episode_reward_min": 55396.5069732666, "episode_reward_mean": 58140.75898988359, "episode_len_mean": 135.78125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 55396.5069732666}, "policy_reward_max": {"agent_0": 60147.08679199219}, "policy_reward_mean": {"agent_0": 58140.75898988359}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58291.97364807129, 58164.09359741211, 58036.48664754629, 58736.42692565918, 59702.4938659668, 55396.5069732666, 59809.43366622925, 60015.28730201721, 60147.08679199219, 59213.77355957031, 57591.413513183594, 58320.52030944824, 58962.013771533966, 58543.61349487305, 57571.600189208984, 55653.60691642761, 57942.60701751709, 57805.273425102234, 57151.3601436615, 56825.25357055664, 58382.82001495361, 58805.22693634033, 56381.74012756348, 57218.80676269531, 59863.50016784668, 59301.773529052734, 59466.74708747864, 58343.20701599121, 55826.15345001221, 58202.33352279663, 57488.927028656006, 57342.2267036438], "episode_lengths": [135, 136, 135, 136, 136, 135, 137, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [58291.97364807129, 58164.09359741211, 58036.48664754629, 58736.42692565918, 59702.4938659668, 55396.5069732666, 59809.43366622925, 60015.28730201721, 60147.08679199219, 59213.77355957031, 57591.413513183594, 58320.52030944824, 58962.013771533966, 58543.61349487305, 57571.600189208984, 55653.60691642761, 57942.60701751709, 57805.273425102234, 57151.3601436615, 56825.25357055664, 58382.82001495361, 58805.22693634033, 56381.74012756348, 57218.80676269531, 59863.50016784668, 59301.773529052734, 59466.74708747864, 58343.20701599121, 55826.15345001221, 58202.33352279663, 57488.927028656006, 57342.2267036438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.35700846108594, "mean_inference_ms": 6.359074020883261, "mean_action_processing_ms": 0.20519357461195725, "mean_env_wait_ms": 223.06205004258553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06743669509887695, "StateBufferConnector_ms": 0.007256865501403809, "ViewRequirementAgentConnector_ms": 0.28369277715682983}}, "episode_reward_max": 60147.08679199219, "episode_reward_min": 55396.5069732666, "episode_reward_mean": 58140.75898988359, "episode_len_mean": 135.78125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 55396.5069732666}, "policy_reward_max": {"agent_0": 60147.08679199219}, "policy_reward_mean": {"agent_0": 58140.75898988359}, "hist_stats": {"episode_reward": [58291.97364807129, 58164.09359741211, 58036.48664754629, 58736.42692565918, 59702.4938659668, 55396.5069732666, 59809.43366622925, 60015.28730201721, 60147.08679199219, 59213.77355957031, 57591.413513183594, 58320.52030944824, 58962.013771533966, 58543.61349487305, 57571.600189208984, 55653.60691642761, 57942.60701751709, 57805.273425102234, 57151.3601436615, 56825.25357055664, 58382.82001495361, 58805.22693634033, 56381.74012756348, 57218.80676269531, 59863.50016784668, 59301.773529052734, 59466.74708747864, 58343.20701599121, 55826.15345001221, 58202.33352279663, 57488.927028656006, 57342.2267036438], "episode_lengths": [135, 136, 135, 136, 136, 135, 137, 136, 136, 136, 136, 136, 136, 136, 136, 135, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 135, 135], "policy_agent_0_reward": [58291.97364807129, 58164.09359741211, 58036.48664754629, 58736.42692565918, 59702.4938659668, 55396.5069732666, 59809.43366622925, 60015.28730201721, 60147.08679199219, 59213.77355957031, 57591.413513183594, 58320.52030944824, 58962.013771533966, 58543.61349487305, 57571.600189208984, 55653.60691642761, 57942.60701751709, 57805.273425102234, 57151.3601436615, 56825.25357055664, 58382.82001495361, 58805.22693634033, 56381.74012756348, 57218.80676269531, 59863.50016784668, 59301.773529052734, 59466.74708747864, 58343.20701599121, 55826.15345001221, 58202.33352279663, 57488.927028656006, 57342.2267036438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.35700846108594, "mean_inference_ms": 6.359074020883261, "mean_action_processing_ms": 0.20519357461195725, "mean_env_wait_ms": 223.06205004258553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06743669509887695, "StateBufferConnector_ms": 0.007256865501403809, "ViewRequirementAgentConnector_ms": 0.28369277715682983}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.2036754234184, "num_env_steps_trained_throughput_per_sec": 237.2036754234184, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 14875.544, "sample_time_ms": 11715.393, "learn_time_ms": 3016.843, "learn_throughput": 1325.889, "synch_weights_time_ms": 141.46}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 1024, "training_iteration": 37, "trial_id": "32397_00000", "date": "2025-03-21_08-46-19", "timestamp": 1742546779, "time_this_iter_s": 16.91371488571167, "time_total_s": 554.3560819625854, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef9a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 554.3560819625854, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 99.22727272727273, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.760730743408203, "policy_loss": -0.010059569031000137, "vf_loss": 9.770263671875, "vf_explained_var": 5.727013103751233e-07, "kl": 0.005257454700767994, "entropy": 0.39215436577796936, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 61199.933670043945, "episode_reward_min": 52541.553409576416, "episode_reward_mean": 57699.18746869719, "episode_len_mean": 135.7173913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 52541.553409576416}, "policy_reward_max": {"agent_0": 61199.933670043945}, "policy_reward_mean": {"agent_0": 57699.18746869719}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55945.81352996826, 53423.866916656494, 58235.90003967285, 59490.93380737305, 55374.753732681274, 58577.25337982178, 57075.01354980469, 58232.320026397705, 57200.56657409668, 58094.493408203125, 57839.68007659912, 57307.38013267517, 58362.8005027771, 54849.76698589325, 55158.08024406433, 58377.486951828, 57807.353578567505, 59335.286880493164, 55602.946841955185, 57699.11353302002, 58989.773666381836, 53863.04012775421, 55190.066747665405, 57125.56692504883, 57552.5936088562, 55292.57341003418, 59043.97367858887, 60026.88038635254, 56247.64001464844, 58702.42057800293, 59578.18681526184, 58425.047119140625, 61199.933670043945, 57442.53380584717, 57279.63372039795, 55274.05345916748, 59160.86688232422, 59548.03363800049, 57173.420181274414, 58139.15351867676, 58376.540130615234, 56864.8734664917, 58140.64708137512, 58040.353439331055, 57653.76020526886, 59814.92025709152, 56795.620178222656, 58577.153633117676, 61146.36670303345, 58470.826889038086, 58327.566833496094, 55213.41316986084, 57766.60014343262, 58124.0334777832, 58188.64033508301, 58108.34694290161, 57801.35338592529, 59771.67353820801, 59012.92688751221, 58110.693588256836, 60095.960388183594, 57132.58682632446, 56448.12691497803, 56862.83338928223, 52541.553409576416, 57232.44027328491, 61129.5338973999, 55792.10018157959, 60032.06027984619, 58058.906913757324, 56677.10690307617, 58031.38011550903, 58998.75347137451, 57669.28697013855, 57303.966857910156, 57141.78689575195, 56595.4202747345, 59240.220558166504, 57691.533630371094, 54025.10682106018, 58117.08703613281, 57297.50682449341, 57763.61359024048, 57852.2333984375, 58529.51345825195, 59751.99363708496, 59296.55348968506, 56696.6669921875, 58571.340103149414, 56539.52702713013, 57181.82015800476, 58474.21350097656], "episode_lengths": [135, 135, 136, 137, 135, 136, 136, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 137, 136, 137, 136, 136, 134, 136, 137, 136, 136, 135, 135, 136, 135, 134, 137, 135, 136, 139, 135, 137, 135, 135, 136, 135, 136, 136, 136, 136, 136, 137, 135, 135, 135, 134, 136, 137, 135, 137, 136, 135, 136, 136, 135, 136, 135, 135, 137, 136, 135, 135, 136, 135, 136, 135, 137, 137, 136, 136, 135, 136, 136], "policy_agent_0_reward": [55945.81352996826, 53423.866916656494, 58235.90003967285, 59490.93380737305, 55374.753732681274, 58577.25337982178, 57075.01354980469, 58232.320026397705, 57200.56657409668, 58094.493408203125, 57839.68007659912, 57307.38013267517, 58362.8005027771, 54849.76698589325, 55158.08024406433, 58377.486951828, 57807.353578567505, 59335.286880493164, 55602.946841955185, 57699.11353302002, 58989.773666381836, 53863.04012775421, 55190.066747665405, 57125.56692504883, 57552.5936088562, 55292.57341003418, 59043.97367858887, 60026.88038635254, 56247.64001464844, 58702.42057800293, 59578.18681526184, 58425.047119140625, 61199.933670043945, 57442.53380584717, 57279.63372039795, 55274.05345916748, 59160.86688232422, 59548.03363800049, 57173.420181274414, 58139.15351867676, 58376.540130615234, 56864.8734664917, 58140.64708137512, 58040.353439331055, 57653.76020526886, 59814.92025709152, 56795.620178222656, 58577.153633117676, 61146.36670303345, 58470.826889038086, 58327.566833496094, 55213.41316986084, 57766.60014343262, 58124.0334777832, 58188.64033508301, 58108.34694290161, 57801.35338592529, 59771.67353820801, 59012.92688751221, 58110.693588256836, 60095.960388183594, 57132.58682632446, 56448.12691497803, 56862.83338928223, 52541.553409576416, 57232.44027328491, 61129.5338973999, 55792.10018157959, 60032.06027984619, 58058.906913757324, 56677.10690307617, 58031.38011550903, 58998.75347137451, 57669.28697013855, 57303.966857910156, 57141.78689575195, 56595.4202747345, 59240.220558166504, 57691.533630371094, 54025.10682106018, 58117.08703613281, 57297.50682449341, 57763.61359024048, 57852.2333984375, 58529.51345825195, 59751.99363708496, 59296.55348968506, 56696.6669921875, 58571.340103149414, 56539.52702713013, 57181.82015800476, 58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.12163173735433, "mean_inference_ms": 6.804463279144644, "mean_action_processing_ms": 0.20123395602601138, "mean_env_wait_ms": 239.21395754840555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10960153911424719, "StateBufferConnector_ms": 0.011504992194797682, "ViewRequirementAgentConnector_ms": 0.27042264523713483}}, "episode_reward_max": 61199.933670043945, "episode_reward_min": 52541.553409576416, "episode_reward_mean": 57699.18746869719, "episode_len_mean": 135.7173913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 52541.553409576416}, "policy_reward_max": {"agent_0": 61199.933670043945}, "policy_reward_mean": {"agent_0": 57699.18746869719}, "hist_stats": {"episode_reward": [55945.81352996826, 53423.866916656494, 58235.90003967285, 59490.93380737305, 55374.753732681274, 58577.25337982178, 57075.01354980469, 58232.320026397705, 57200.56657409668, 58094.493408203125, 57839.68007659912, 57307.38013267517, 58362.8005027771, 54849.76698589325, 55158.08024406433, 58377.486951828, 57807.353578567505, 59335.286880493164, 55602.946841955185, 57699.11353302002, 58989.773666381836, 53863.04012775421, 55190.066747665405, 57125.56692504883, 57552.5936088562, 55292.57341003418, 59043.97367858887, 60026.88038635254, 56247.64001464844, 58702.42057800293, 59578.18681526184, 58425.047119140625, 61199.933670043945, 57442.53380584717, 57279.63372039795, 55274.05345916748, 59160.86688232422, 59548.03363800049, 57173.420181274414, 58139.15351867676, 58376.540130615234, 56864.8734664917, 58140.64708137512, 58040.353439331055, 57653.76020526886, 59814.92025709152, 56795.620178222656, 58577.153633117676, 61146.36670303345, 58470.826889038086, 58327.566833496094, 55213.41316986084, 57766.60014343262, 58124.0334777832, 58188.64033508301, 58108.34694290161, 57801.35338592529, 59771.67353820801, 59012.92688751221, 58110.693588256836, 60095.960388183594, 57132.58682632446, 56448.12691497803, 56862.83338928223, 52541.553409576416, 57232.44027328491, 61129.5338973999, 55792.10018157959, 60032.06027984619, 58058.906913757324, 56677.10690307617, 58031.38011550903, 58998.75347137451, 57669.28697013855, 57303.966857910156, 57141.78689575195, 56595.4202747345, 59240.220558166504, 57691.533630371094, 54025.10682106018, 58117.08703613281, 57297.50682449341, 57763.61359024048, 57852.2333984375, 58529.51345825195, 59751.99363708496, 59296.55348968506, 56696.6669921875, 58571.340103149414, 56539.52702713013, 57181.82015800476, 58474.21350097656], "episode_lengths": [135, 135, 136, 137, 135, 136, 136, 136, 136, 135, 136, 136, 136, 135, 136, 136, 136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 136, 136, 135, 136, 137, 136, 137, 136, 136, 134, 136, 137, 136, 136, 135, 135, 136, 135, 134, 137, 135, 136, 139, 135, 137, 135, 135, 136, 135, 136, 136, 136, 136, 136, 137, 135, 135, 135, 134, 136, 137, 135, 137, 136, 135, 136, 136, 135, 136, 135, 135, 137, 136, 135, 135, 136, 135, 136, 135, 137, 137, 136, 136, 135, 136, 136], "policy_agent_0_reward": [55945.81352996826, 53423.866916656494, 58235.90003967285, 59490.93380737305, 55374.753732681274, 58577.25337982178, 57075.01354980469, 58232.320026397705, 57200.56657409668, 58094.493408203125, 57839.68007659912, 57307.38013267517, 58362.8005027771, 54849.76698589325, 55158.08024406433, 58377.486951828, 57807.353578567505, 59335.286880493164, 55602.946841955185, 57699.11353302002, 58989.773666381836, 53863.04012775421, 55190.066747665405, 57125.56692504883, 57552.5936088562, 55292.57341003418, 59043.97367858887, 60026.88038635254, 56247.64001464844, 58702.42057800293, 59578.18681526184, 58425.047119140625, 61199.933670043945, 57442.53380584717, 57279.63372039795, 55274.05345916748, 59160.86688232422, 59548.03363800049, 57173.420181274414, 58139.15351867676, 58376.540130615234, 56864.8734664917, 58140.64708137512, 58040.353439331055, 57653.76020526886, 59814.92025709152, 56795.620178222656, 58577.153633117676, 61146.36670303345, 58470.826889038086, 58327.566833496094, 55213.41316986084, 57766.60014343262, 58124.0334777832, 58188.64033508301, 58108.34694290161, 57801.35338592529, 59771.67353820801, 59012.92688751221, 58110.693588256836, 60095.960388183594, 57132.58682632446, 56448.12691497803, 56862.83338928223, 52541.553409576416, 57232.44027328491, 61129.5338973999, 55792.10018157959, 60032.06027984619, 58058.906913757324, 56677.10690307617, 58031.38011550903, 58998.75347137451, 57669.28697013855, 57303.966857910156, 57141.78689575195, 56595.4202747345, 59240.220558166504, 57691.533630371094, 54025.10682106018, 58117.08703613281, 57297.50682449341, 57763.61359024048, 57852.2333984375, 58529.51345825195, 59751.99363708496, 59296.55348968506, 56696.6669921875, 58571.340103149414, 56539.52702713013, 57181.82015800476, 58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.12163173735433, "mean_inference_ms": 6.804463279144644, "mean_action_processing_ms": 0.20123395602601138, "mean_env_wait_ms": 239.21395754840555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10960153911424719, "StateBufferConnector_ms": 0.011504992194797682, "ViewRequirementAgentConnector_ms": 0.27042264523713483}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.88701841418998, "num_env_steps_trained_throughput_per_sec": 245.88701841418998, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 15180.564, "sample_time_ms": 12007.495, "learn_time_ms": 3029.277, "learn_throughput": 1320.447, "synch_weights_time_ms": 141.956}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 1116, "training_iteration": 38, "trial_id": "32397_00000", "date": "2025-03-21_08-46-36", "timestamp": 1742546796, "time_this_iter_s": 16.329360723495483, "time_total_s": 570.6854426860809, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 570.6854426860809, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 97.21739130434783, "ram_util_percent": 13.399999999999997}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986838340759277, "policy_loss": -0.00919856783002615, "vf_loss": 9.995532035827637, "vf_explained_var": -4.8362958295911085e-06, "kl": 0.005054509732872248, "entropy": 0.436094731092453, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 58474.21350097656, "episode_reward_min": 58474.21350097656, "episode_reward_mean": 58474.21350097656, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58474.21350097656}, "policy_reward_max": {"agent_0": 58474.21350097656}, "policy_reward_mean": {"agent_0": 58474.21350097656}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58474.21350097656], "episode_lengths": [136], "policy_agent_0_reward": [58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.05594334723818, "mean_inference_ms": 6.580377467460287, "mean_action_processing_ms": 0.19631291767957273, "mean_env_wait_ms": 247.897312302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039267539978027344, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.16887187957763672}}, "episode_reward_max": 58474.21350097656, "episode_reward_min": 58474.21350097656, "episode_reward_mean": 58474.21350097656, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58474.21350097656}, "policy_reward_max": {"agent_0": 58474.21350097656}, "policy_reward_mean": {"agent_0": 58474.21350097656}, "hist_stats": {"episode_reward": [58474.21350097656], "episode_lengths": [136], "policy_agent_0_reward": [58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.05594334723818, "mean_inference_ms": 6.580377467460287, "mean_action_processing_ms": 0.19631291767957273, "mean_env_wait_ms": 247.897312302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039267539978027344, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.16887187957763672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.9983385175084, "num_env_steps_trained_throughput_per_sec": 301.9983385175084, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 14926.319, "sample_time_ms": 11633.865, "learn_time_ms": 3143.758, "learn_throughput": 1272.363, "synch_weights_time_ms": 148.004}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 1116, "training_iteration": 39, "trial_id": "32397_00000", "date": "2025-03-21_08-46-49", "timestamp": 1742546809, "time_this_iter_s": 13.313988208770752, "time_total_s": 583.9994308948517, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 583.9994308948517, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 99.52631578947371, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989541053771973, "policy_loss": -0.01104071643203497, "vf_loss": 10.0, "vf_explained_var": -1.4956543964217417e-05, "kl": 0.0058172596618533134, "entropy": 0.39199298620224, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 58474.21350097656, "episode_reward_min": 58474.21350097656, "episode_reward_mean": 58474.21350097656, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58474.21350097656}, "policy_reward_max": {"agent_0": 58474.21350097656}, "policy_reward_mean": {"agent_0": 58474.21350097656}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58474.21350097656], "episode_lengths": [136], "policy_agent_0_reward": [58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.05594334723818, "mean_inference_ms": 6.580377467460287, "mean_action_processing_ms": 0.19631291767957273, "mean_env_wait_ms": 247.897312302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039267539978027344, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.16887187957763672}}, "episode_reward_max": 58474.21350097656, "episode_reward_min": 58474.21350097656, "episode_reward_mean": 58474.21350097656, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58474.21350097656}, "policy_reward_max": {"agent_0": 58474.21350097656}, "policy_reward_mean": {"agent_0": 58474.21350097656}, "hist_stats": {"episode_reward": [58474.21350097656], "episode_lengths": [136], "policy_agent_0_reward": [58474.21350097656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.05594334723818, "mean_inference_ms": 6.580377467460287, "mean_action_processing_ms": 0.19631291767957273, "mean_env_wait_ms": 247.897312302225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039267539978027344, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.16887187957763672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.44195533863996, "num_env_steps_trained_throughput_per_sec": 318.44195533863996, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14498.2, "sample_time_ms": 11201.13, "learn_time_ms": 3149.881, "learn_throughput": 1269.889, "synch_weights_time_ms": 146.49}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 1116, "training_iteration": 40, "trial_id": "32397_00000", "date": "2025-03-21_08-47-02", "timestamp": 1742546822, "time_this_iter_s": 12.621663331985474, "time_total_s": 596.6210942268372, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19c71750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 596.6210942268372, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 99.59444444444446, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.90809440612793, "policy_loss": -0.010321148671209812, "vf_loss": 9.917820930480957, "vf_explained_var": -6.951578143343795e-06, "kl": 0.005929962266236544, "entropy": 0.3640035092830658, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 60646.34704589844, "episode_reward_min": 52416.56690073013, "episode_reward_mean": 57889.32547655702, "episode_len_mean": 135.9375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52416.56690073013}, "policy_reward_max": {"agent_0": 60646.34704589844}, "policy_reward_mean": {"agent_0": 57889.32547655702}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58930.85340881348, 58246.680252075195, 59670.48025512695, 57849.58023071289, 57644.48036146164, 52416.56690073013, 60646.34704589844, 60570.82028198242, 54985.90684509277, 58816.34053039551, 55432.18682670593, 58358.54684448242, 55682.29330635071, 59950.2137298584, 59316.1339263916, 56309.19369697571, 59541.180236816406, 57696.6534576416, 59808.353607177734, 52742.70034980774, 58112.92688751221, 57401.98048400879, 58683.48026371002, 60057.30020904541, 57574.480279922485, 59424.12030029297, 59986.82699584961, 57191.30040359497, 57737.54035949707, 58645.68004989624, 58274.82679748535, 54752.44012451172], "episode_lengths": [136, 136, 137, 136, 136, 134, 137, 136, 135, 136, 135, 136, 135, 136, 137, 136, 136, 136, 137, 134, 136, 136, 136, 137, 136, 137, 137, 136, 135, 136, 136, 135], "policy_agent_0_reward": [58930.85340881348, 58246.680252075195, 59670.48025512695, 57849.58023071289, 57644.48036146164, 52416.56690073013, 60646.34704589844, 60570.82028198242, 54985.90684509277, 58816.34053039551, 55432.18682670593, 58358.54684448242, 55682.29330635071, 59950.2137298584, 59316.1339263916, 56309.19369697571, 59541.180236816406, 57696.6534576416, 59808.353607177734, 52742.70034980774, 58112.92688751221, 57401.98048400879, 58683.48026371002, 60057.30020904541, 57574.480279922485, 59424.12030029297, 59986.82699584961, 57191.30040359497, 57737.54035949707, 58645.68004989624, 58274.82679748535, 54752.44012451172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.412161934543043, "mean_inference_ms": 6.407454439288933, "mean_action_processing_ms": 0.20465955820534396, "mean_env_wait_ms": 221.134698593458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05432814359664917, "StateBufferConnector_ms": 0.006620585918426514, "ViewRequirementAgentConnector_ms": 0.24000555276870728}}, "episode_reward_max": 60646.34704589844, "episode_reward_min": 52416.56690073013, "episode_reward_mean": 57889.32547655702, "episode_len_mean": 135.9375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52416.56690073013}, "policy_reward_max": {"agent_0": 60646.34704589844}, "policy_reward_mean": {"agent_0": 57889.32547655702}, "hist_stats": {"episode_reward": [58930.85340881348, 58246.680252075195, 59670.48025512695, 57849.58023071289, 57644.48036146164, 52416.56690073013, 60646.34704589844, 60570.82028198242, 54985.90684509277, 58816.34053039551, 55432.18682670593, 58358.54684448242, 55682.29330635071, 59950.2137298584, 59316.1339263916, 56309.19369697571, 59541.180236816406, 57696.6534576416, 59808.353607177734, 52742.70034980774, 58112.92688751221, 57401.98048400879, 58683.48026371002, 60057.30020904541, 57574.480279922485, 59424.12030029297, 59986.82699584961, 57191.30040359497, 57737.54035949707, 58645.68004989624, 58274.82679748535, 54752.44012451172], "episode_lengths": [136, 136, 137, 136, 136, 134, 137, 136, 135, 136, 135, 136, 135, 136, 137, 136, 136, 136, 137, 134, 136, 136, 136, 137, 136, 137, 137, 136, 135, 136, 136, 135], "policy_agent_0_reward": [58930.85340881348, 58246.680252075195, 59670.48025512695, 57849.58023071289, 57644.48036146164, 52416.56690073013, 60646.34704589844, 60570.82028198242, 54985.90684509277, 58816.34053039551, 55432.18682670593, 58358.54684448242, 55682.29330635071, 59950.2137298584, 59316.1339263916, 56309.19369697571, 59541.180236816406, 57696.6534576416, 59808.353607177734, 52742.70034980774, 58112.92688751221, 57401.98048400879, 58683.48026371002, 60057.30020904541, 57574.480279922485, 59424.12030029297, 59986.82699584961, 57191.30040359497, 57737.54035949707, 58645.68004989624, 58274.82679748535, 54752.44012451172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.412161934543043, "mean_inference_ms": 6.407454439288933, "mean_action_processing_ms": 0.20465955820534396, "mean_env_wait_ms": 221.134698593458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05432814359664917, "StateBufferConnector_ms": 0.006620585918426514, "ViewRequirementAgentConnector_ms": 0.24000555276870728}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.7312268865254, "num_env_steps_trained_throughput_per_sec": 248.7312268865254, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 14825.795, "sample_time_ms": 11524.001, "learn_time_ms": 3158.153, "learn_throughput": 1266.563, "synch_weights_time_ms": 142.941}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 1148, "training_iteration": 41, "trial_id": "32397_00000", "date": "2025-03-21_08-47-18", "timestamp": 1742546838, "time_this_iter_s": 16.131407737731934, "time_total_s": 612.7525019645691, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 612.7525019645691, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 99.24545454545455, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 4.999999873689376e-05, "total_loss": 9.767935752868652, "policy_loss": -0.008613922633230686, "vf_loss": 9.776066780090332, "vf_explained_var": -2.300739197380608e-06, "kl": 0.00483075063675642, "entropy": 0.34543752670288086, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 61487.50701904297, "episode_reward_min": 48869.15337431431, "episode_reward_mean": 57361.07184228401, "episode_len_mean": 135.85555555555555, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 48869.15337431431}, "policy_reward_max": {"agent_0": 61487.50701904297}, "policy_reward_mean": {"agent_0": 57361.07184228401}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57324.40670776367, 60666.44692993164, 57985.78003311157, 56115.69351631403, 56967.89350891113, 52671.146956682205, 59541.186878204346, 59813.65362548828, 57348.587257385254, 55844.89336204529, 58746.5470123291, 58052.7601852417, 58177.833599090576, 56850.02023887634, 59782.47381210327, 57935.70673370361, 59083.23352050781, 59758.92679977417, 57804.113510131836, 56483.90698838234, 56826.21342468262, 58545.41375732422, 59662.7135925293, 57564.00678253174, 57901.840087890625, 55416.60691666603, 54921.44028568268, 58389.913650512695, 58250.25351333618, 48869.15337431431, 55689.89356851578, 58925.560050964355, 54861.83386802673, 56513.460372924805, 55715.900643348694, 55442.84682846069, 57751.02006530762, 56200.56679677963, 57946.833587646484, 56002.41989326477, 56690.63324737549, 56535.146797180176, 58702.219985961914, 53776.29358100891, 57626.26042175293, 59085.666900634766, 57041.13350868225, 55965.573793411255, 56648.280334472656, 57061.07332611084, 58483.760122299194, 60275.64694976807, 55963.226687431335, 59500.427001953125, 58209.986797332764, 53541.353486061096, 57608.707107543945, 55153.24705886841, 58902.760177612305, 56477.80031585693, 59189.533725738525, 58024.44016265869, 57598.50026512146, 58098.42028808594, 59148.31342315674, 54131.50033065677, 60228.55319213867, 57727.57327270508, 55930.686794638634, 58803.18682861328, 59614.12715911865, 52953.673464775085, 55793.49346923828, 58536.75341796875, 59420.88038635254, 53274.64013671875, 55930.139877319336, 61487.50701904297, 60174.80693054199, 57329.68682861328, 58225.27997970581, 54972.73357439041, 56793.34693336487, 58002.00698375702, 60017.94689941406, 57547.21353530884, 58513.93367767334, 58910.19359970093, 57557.967041015625, 56957.12677001953], "episode_lengths": [135, 137, 136, 135, 136, 136, 137, 138, 135, 135, 136, 136, 137, 136, 136, 136, 137, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 137, 136, 134, 136, 136, 137, 135, 135, 136, 137, 137, 135, 136, 136, 135, 137, 135, 136, 136, 137, 136, 136, 135, 136, 135, 137, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 136, 136, 136], "policy_agent_0_reward": [57324.40670776367, 60666.44692993164, 57985.78003311157, 56115.69351631403, 56967.89350891113, 52671.146956682205, 59541.186878204346, 59813.65362548828, 57348.587257385254, 55844.89336204529, 58746.5470123291, 58052.7601852417, 58177.833599090576, 56850.02023887634, 59782.47381210327, 57935.70673370361, 59083.23352050781, 59758.92679977417, 57804.113510131836, 56483.90698838234, 56826.21342468262, 58545.41375732422, 59662.7135925293, 57564.00678253174, 57901.840087890625, 55416.60691666603, 54921.44028568268, 58389.913650512695, 58250.25351333618, 48869.15337431431, 55689.89356851578, 58925.560050964355, 54861.83386802673, 56513.460372924805, 55715.900643348694, 55442.84682846069, 57751.02006530762, 56200.56679677963, 57946.833587646484, 56002.41989326477, 56690.63324737549, 56535.146797180176, 58702.219985961914, 53776.29358100891, 57626.26042175293, 59085.666900634766, 57041.13350868225, 55965.573793411255, 56648.280334472656, 57061.07332611084, 58483.760122299194, 60275.64694976807, 55963.226687431335, 59500.427001953125, 58209.986797332764, 53541.353486061096, 57608.707107543945, 55153.24705886841, 58902.760177612305, 56477.80031585693, 59189.533725738525, 58024.44016265869, 57598.50026512146, 58098.42028808594, 59148.31342315674, 54131.50033065677, 60228.55319213867, 57727.57327270508, 55930.686794638634, 58803.18682861328, 59614.12715911865, 52953.673464775085, 55793.49346923828, 58536.75341796875, 59420.88038635254, 53274.64013671875, 55930.139877319336, 61487.50701904297, 60174.80693054199, 57329.68682861328, 58225.27997970581, 54972.73357439041, 56793.34693336487, 58002.00698375702, 60017.94689941406, 57547.21353530884, 58513.93367767334, 58910.19359970093, 57557.967041015625, 56957.12677001953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.697142029044947, "mean_inference_ms": 6.794727015032447, "mean_action_processing_ms": 0.20136603930921212, "mean_env_wait_ms": 238.39427325411407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05958477656046549, "StateBufferConnector_ms": 0.017336739434136286, "ViewRequirementAgentConnector_ms": 0.1977796024746365}}, "episode_reward_max": 61487.50701904297, "episode_reward_min": 48869.15337431431, "episode_reward_mean": 57361.07184228401, "episode_len_mean": 135.85555555555555, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 48869.15337431431}, "policy_reward_max": {"agent_0": 61487.50701904297}, "policy_reward_mean": {"agent_0": 57361.07184228401}, "hist_stats": {"episode_reward": [57324.40670776367, 60666.44692993164, 57985.78003311157, 56115.69351631403, 56967.89350891113, 52671.146956682205, 59541.186878204346, 59813.65362548828, 57348.587257385254, 55844.89336204529, 58746.5470123291, 58052.7601852417, 58177.833599090576, 56850.02023887634, 59782.47381210327, 57935.70673370361, 59083.23352050781, 59758.92679977417, 57804.113510131836, 56483.90698838234, 56826.21342468262, 58545.41375732422, 59662.7135925293, 57564.00678253174, 57901.840087890625, 55416.60691666603, 54921.44028568268, 58389.913650512695, 58250.25351333618, 48869.15337431431, 55689.89356851578, 58925.560050964355, 54861.83386802673, 56513.460372924805, 55715.900643348694, 55442.84682846069, 57751.02006530762, 56200.56679677963, 57946.833587646484, 56002.41989326477, 56690.63324737549, 56535.146797180176, 58702.219985961914, 53776.29358100891, 57626.26042175293, 59085.666900634766, 57041.13350868225, 55965.573793411255, 56648.280334472656, 57061.07332611084, 58483.760122299194, 60275.64694976807, 55963.226687431335, 59500.427001953125, 58209.986797332764, 53541.353486061096, 57608.707107543945, 55153.24705886841, 58902.760177612305, 56477.80031585693, 59189.533725738525, 58024.44016265869, 57598.50026512146, 58098.42028808594, 59148.31342315674, 54131.50033065677, 60228.55319213867, 57727.57327270508, 55930.686794638634, 58803.18682861328, 59614.12715911865, 52953.673464775085, 55793.49346923828, 58536.75341796875, 59420.88038635254, 53274.64013671875, 55930.139877319336, 61487.50701904297, 60174.80693054199, 57329.68682861328, 58225.27997970581, 54972.73357439041, 56793.34693336487, 58002.00698375702, 60017.94689941406, 57547.21353530884, 58513.93367767334, 58910.19359970093, 57557.967041015625, 56957.12677001953], "episode_lengths": [135, 137, 136, 135, 136, 136, 137, 138, 135, 135, 136, 136, 137, 136, 136, 136, 137, 136, 136, 136, 135, 136, 136, 136, 136, 136, 135, 136, 136, 135, 136, 136, 135, 135, 135, 135, 135, 136, 136, 135, 135, 137, 136, 134, 136, 136, 137, 135, 135, 136, 137, 137, 135, 136, 136, 135, 137, 135, 136, 136, 137, 136, 136, 135, 136, 135, 137, 135, 136, 136, 136, 135, 135, 135, 136, 135, 135, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 136, 136, 136], "policy_agent_0_reward": [57324.40670776367, 60666.44692993164, 57985.78003311157, 56115.69351631403, 56967.89350891113, 52671.146956682205, 59541.186878204346, 59813.65362548828, 57348.587257385254, 55844.89336204529, 58746.5470123291, 58052.7601852417, 58177.833599090576, 56850.02023887634, 59782.47381210327, 57935.70673370361, 59083.23352050781, 59758.92679977417, 57804.113510131836, 56483.90698838234, 56826.21342468262, 58545.41375732422, 59662.7135925293, 57564.00678253174, 57901.840087890625, 55416.60691666603, 54921.44028568268, 58389.913650512695, 58250.25351333618, 48869.15337431431, 55689.89356851578, 58925.560050964355, 54861.83386802673, 56513.460372924805, 55715.900643348694, 55442.84682846069, 57751.02006530762, 56200.56679677963, 57946.833587646484, 56002.41989326477, 56690.63324737549, 56535.146797180176, 58702.219985961914, 53776.29358100891, 57626.26042175293, 59085.666900634766, 57041.13350868225, 55965.573793411255, 56648.280334472656, 57061.07332611084, 58483.760122299194, 60275.64694976807, 55963.226687431335, 59500.427001953125, 58209.986797332764, 53541.353486061096, 57608.707107543945, 55153.24705886841, 58902.760177612305, 56477.80031585693, 59189.533725738525, 58024.44016265869, 57598.50026512146, 58098.42028808594, 59148.31342315674, 54131.50033065677, 60228.55319213867, 57727.57327270508, 55930.686794638634, 58803.18682861328, 59614.12715911865, 52953.673464775085, 55793.49346923828, 58536.75341796875, 59420.88038635254, 53274.64013671875, 55930.139877319336, 61487.50701904297, 60174.80693054199, 57329.68682861328, 58225.27997970581, 54972.73357439041, 56793.34693336487, 58002.00698375702, 60017.94689941406, 57547.21353530884, 58513.93367767334, 58910.19359970093, 57557.967041015625, 56957.12677001953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.697142029044947, "mean_inference_ms": 6.794727015032447, "mean_action_processing_ms": 0.20136603930921212, "mean_env_wait_ms": 238.39427325411407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05958477656046549, "StateBufferConnector_ms": 0.017336739434136286, "ViewRequirementAgentConnector_ms": 0.1977796024746365}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.82198195462453, "num_env_steps_trained_throughput_per_sec": 250.82198195462453, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 15095.662, "sample_time_ms": 11833.488, "learn_time_ms": 3116.85, "learn_throughput": 1283.347, "synch_weights_time_ms": 144.395}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 1238, "training_iteration": 42, "trial_id": "32397_00000", "date": "2025-03-21_08-47-34", "timestamp": 1742546854, "time_this_iter_s": 16.00392436981201, "time_total_s": 628.7564263343811, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 628.7564263343811, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 96.01904761904761, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.975781440734863, "policy_loss": -0.009385003708302975, "vf_loss": 9.984872817993164, "vf_explained_var": 3.313024876661075e-07, "kl": 0.005871651694178581, "entropy": 0.3381923735141754, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 60783.40704345703, "episode_reward_min": 58042.31997680664, "episode_reward_mean": 59412.863510131836, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 58042.31997680664}, "policy_reward_max": {"agent_0": 60783.40704345703}, "policy_reward_mean": {"agent_0": 59412.863510131836}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58042.31997680664, 60783.40704345703], "episode_lengths": [136, 138], "policy_agent_0_reward": [58042.31997680664, 60783.40704345703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.8920185910504, "mean_inference_ms": 6.828639328955911, "mean_action_processing_ms": 0.20249078649494556, "mean_env_wait_ms": 231.95352827887996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042057037353515625, "StateBufferConnector_ms": 0.007021427154541016, "ViewRequirementAgentConnector_ms": 0.1935720443725586}}, "episode_reward_max": 60783.40704345703, "episode_reward_min": 58042.31997680664, "episode_reward_mean": 59412.863510131836, "episode_len_mean": 137.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 58042.31997680664}, "policy_reward_max": {"agent_0": 60783.40704345703}, "policy_reward_mean": {"agent_0": 59412.863510131836}, "hist_stats": {"episode_reward": [58042.31997680664, 60783.40704345703], "episode_lengths": [136, 138], "policy_agent_0_reward": [58042.31997680664, 60783.40704345703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.8920185910504, "mean_inference_ms": 6.828639328955911, "mean_action_processing_ms": 0.20249078649494556, "mean_env_wait_ms": 231.95352827887996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042057037353515625, "StateBufferConnector_ms": 0.007021427154541016, "ViewRequirementAgentConnector_ms": 0.1935720443725586}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.71888451039604, "num_env_steps_trained_throughput_per_sec": 304.71888451039604, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 14720.331, "sample_time_ms": 11441.264, "learn_time_ms": 3136.949, "learn_throughput": 1275.124, "synch_weights_time_ms": 141.181}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 1240, "training_iteration": 43, "trial_id": "32397_00000", "date": "2025-03-21_08-47-47", "timestamp": 1742546867, "time_this_iter_s": 13.189635753631592, "time_total_s": 641.9460620880127, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf5b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 641.9460620880127, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 99.52631578947368, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.992142677307129, "policy_loss": -0.008138615638017654, "vf_loss": 10.0, "vf_explained_var": 2.1978592030791333e-06, "kl": 0.00563142541795969, "entropy": 0.33046817779541016, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 60783.40704345703, "episode_reward_min": 60783.40704345703, "episode_reward_mean": 60783.40704345703, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60783.40704345703}, "policy_reward_max": {"agent_0": 60783.40704345703}, "policy_reward_mean": {"agent_0": 60783.40704345703}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60783.40704345703], "episode_lengths": [138], "policy_agent_0_reward": [60783.40704345703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.540706563878942, "mean_inference_ms": 6.7270503324620865, "mean_action_processing_ms": 0.20068957481855226, "mean_env_wait_ms": 239.4624954561609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03352165222167969, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1636505126953125}}, "episode_reward_max": 60783.40704345703, "episode_reward_min": 60783.40704345703, "episode_reward_mean": 60783.40704345703, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60783.40704345703}, "policy_reward_max": {"agent_0": 60783.40704345703}, "policy_reward_mean": {"agent_0": 60783.40704345703}, "hist_stats": {"episode_reward": [60783.40704345703], "episode_lengths": [138], "policy_agent_0_reward": [60783.40704345703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.540706563878942, "mean_inference_ms": 6.7270503324620865, "mean_action_processing_ms": 0.20068957481855226, "mean_env_wait_ms": 239.4624954561609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03352165222167969, "StateBufferConnector_ms": 0.005507469177246094, "ViewRequirementAgentConnector_ms": 0.1636505126953125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5174598516078, "num_env_steps_trained_throughput_per_sec": 306.5174598516078, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14404.719, "sample_time_ms": 11117.584, "learn_time_ms": 3141.484, "learn_throughput": 1273.283, "synch_weights_time_ms": 144.721}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 1240, "training_iteration": 44, "trial_id": "32397_00000", "date": "2025-03-21_08-48-00", "timestamp": 1742546880, "time_this_iter_s": 13.104243278503418, "time_total_s": 655.0503053665161, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 655.0503053665161, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 99.57777777777778, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910329818725586, "policy_loss": -0.008183436468243599, "vf_loss": 9.918212890625, "vf_explained_var": -1.7386551007803064e-06, "kl": 0.005997749511152506, "entropy": 0.3041117787361145, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 61685.42712402344, "episode_reward_min": 52651.86687254906, "episode_reward_mean": 58143.61794523895, "episode_len_mean": 136.375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52651.86687254906}, "policy_reward_max": {"agent_0": 61685.42712402344}, "policy_reward_mean": {"agent_0": 58143.61794523895}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56250.326959609985, 57289.093502521515, 52651.86687254906, 55010.30700016022, 56803.65350818634, 58286.406995773315, 58957.227098584175, 59017.50672912598, 57293.17348897457, 60261.68688964844, 59061.81398010254, 54302.120145082474, 58723.60721588135, 61685.42712402344, 58815.386573791504, 56222.913568496704, 60354.46026611328, 59761.23358917236, 57615.96015930176, 59365.907135009766, 56593.04020500183, 58655.42017364502, 59746.20016479492, 59717.6134185791, 56808.81996536255, 58511.633378982544, 60669.93379211426, 57684.6868057251, 58372.91365623474, 57191.073503017426, 58818.51333618164, 60095.84704589844], "episode_lengths": [136, 136, 135, 135, 137, 136, 137, 135, 137, 136, 137, 136, 136, 138, 137, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 136, 137, 137], "policy_agent_0_reward": [56250.326959609985, 57289.093502521515, 52651.86687254906, 55010.30700016022, 56803.65350818634, 58286.406995773315, 58957.227098584175, 59017.50672912598, 57293.17348897457, 60261.68688964844, 59061.81398010254, 54302.120145082474, 58723.60721588135, 61685.42712402344, 58815.386573791504, 56222.913568496704, 60354.46026611328, 59761.23358917236, 57615.96015930176, 59365.907135009766, 56593.04020500183, 58655.42017364502, 59746.20016479492, 59717.6134185791, 56808.81996536255, 58511.633378982544, 60669.93379211426, 57684.6868057251, 58372.91365623474, 57191.073503017426, 58818.51333618164, 60095.84704589844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.581435534426213, "mean_inference_ms": 6.457488612844678, "mean_action_processing_ms": 0.2040407629144625, "mean_env_wait_ms": 220.4783823777336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0604093074798584, "StateBufferConnector_ms": 0.020188838243484497, "ViewRequirementAgentConnector_ms": 0.4040628671646118}}, "episode_reward_max": 61685.42712402344, "episode_reward_min": 52651.86687254906, "episode_reward_mean": 58143.61794523895, "episode_len_mean": 136.375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52651.86687254906}, "policy_reward_max": {"agent_0": 61685.42712402344}, "policy_reward_mean": {"agent_0": 58143.61794523895}, "hist_stats": {"episode_reward": [56250.326959609985, 57289.093502521515, 52651.86687254906, 55010.30700016022, 56803.65350818634, 58286.406995773315, 58957.227098584175, 59017.50672912598, 57293.17348897457, 60261.68688964844, 59061.81398010254, 54302.120145082474, 58723.60721588135, 61685.42712402344, 58815.386573791504, 56222.913568496704, 60354.46026611328, 59761.23358917236, 57615.96015930176, 59365.907135009766, 56593.04020500183, 58655.42017364502, 59746.20016479492, 59717.6134185791, 56808.81996536255, 58511.633378982544, 60669.93379211426, 57684.6868057251, 58372.91365623474, 57191.073503017426, 58818.51333618164, 60095.84704589844], "episode_lengths": [136, 136, 135, 135, 137, 136, 137, 135, 137, 136, 137, 136, 136, 138, 137, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 136, 137, 137], "policy_agent_0_reward": [56250.326959609985, 57289.093502521515, 52651.86687254906, 55010.30700016022, 56803.65350818634, 58286.406995773315, 58957.227098584175, 59017.50672912598, 57293.17348897457, 60261.68688964844, 59061.81398010254, 54302.120145082474, 58723.60721588135, 61685.42712402344, 58815.386573791504, 56222.913568496704, 60354.46026611328, 59761.23358917236, 57615.96015930176, 59365.907135009766, 56593.04020500183, 58655.42017364502, 59746.20016479492, 59717.6134185791, 56808.81996536255, 58511.633378982544, 60669.93379211426, 57684.6868057251, 58372.91365623474, 57191.073503017426, 58818.51333618164, 60095.84704589844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.581435534426213, "mean_inference_ms": 6.457488612844678, "mean_action_processing_ms": 0.2040407629144625, "mean_env_wait_ms": 220.4783823777336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0604093074798584, "StateBufferConnector_ms": 0.020188838243484497, "ViewRequirementAgentConnector_ms": 0.4040628671646118}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.7976368395419, "num_env_steps_trained_throughput_per_sec": 274.7976368395419, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 14514.757, "sample_time_ms": 11257.67, "learn_time_ms": 3111.18, "learn_throughput": 1285.686, "synch_weights_time_ms": 144.98}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 1272, "training_iteration": 45, "trial_id": "32397_00000", "date": "2025-03-21_08-48-15", "timestamp": 1742546895, "time_this_iter_s": 14.608358383178711, "time_total_s": 669.6586637496948, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cefa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 669.6586637496948, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 99.45238095238098, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9425048828125, "policy_loss": -0.009947380982339382, "vf_loss": 9.9521484375, "vf_explained_var": -5.904585123062134e-07, "kl": 0.006051084026694298, "entropy": 0.29891565442085266, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 60231.27378845215, "episode_reward_min": 54030.146839141846, "episode_reward_mean": 58171.58933734894, "episode_len_mean": 136.26315789473685, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 54030.146839141846}, "policy_reward_max": {"agent_0": 60231.27378845215}, "policy_reward_mean": {"agent_0": 58171.58933734894}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60231.27378845215, 59176.96019744873, 59153.500091552734, 59420.08670043945, 55209.92027926445, 58161.34696006775, 58163.27990722656, 59453.71350479126, 59460.453773498535, 59195.827087402344, 59389.46011352539, 57805.333557128906, 59699.333435058594, 58851.0735168457, 56843.92041134834, 56657.7934551239, 54030.146839141846, 59404.58022689819, 54952.19356441498], "episode_lengths": [137, 137, 137, 136, 136, 137, 136, 137, 137, 136, 136, 135, 137, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [60231.27378845215, 59176.96019744873, 59153.500091552734, 59420.08670043945, 55209.92027926445, 58161.34696006775, 58163.27990722656, 59453.71350479126, 59460.453773498535, 59195.827087402344, 59389.46011352539, 57805.333557128906, 59699.333435058594, 58851.0735168457, 56843.92041134834, 56657.7934551239, 54030.146839141846, 59404.58022689819, 54952.19356441498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.75824052635725, "mean_inference_ms": 6.848493266234288, "mean_action_processing_ms": 0.20342556896217215, "mean_env_wait_ms": 235.89778554721948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038204695049085115, "StateBufferConnector_ms": 0.005942896792763158, "ViewRequirementAgentConnector_ms": 0.21161907597592003}}, "episode_reward_max": 60231.27378845215, "episode_reward_min": 54030.146839141846, "episode_reward_mean": 58171.58933734894, "episode_len_mean": 136.26315789473685, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 54030.146839141846}, "policy_reward_max": {"agent_0": 60231.27378845215}, "policy_reward_mean": {"agent_0": 58171.58933734894}, "hist_stats": {"episode_reward": [60231.27378845215, 59176.96019744873, 59153.500091552734, 59420.08670043945, 55209.92027926445, 58161.34696006775, 58163.27990722656, 59453.71350479126, 59460.453773498535, 59195.827087402344, 59389.46011352539, 57805.333557128906, 59699.333435058594, 58851.0735168457, 56843.92041134834, 56657.7934551239, 54030.146839141846, 59404.58022689819, 54952.19356441498], "episode_lengths": [137, 137, 137, 136, 136, 137, 136, 137, 137, 136, 136, 135, 137, 136, 136, 136, 135, 136, 136], "policy_agent_0_reward": [60231.27378845215, 59176.96019744873, 59153.500091552734, 59420.08670043945, 55209.92027926445, 58161.34696006775, 58163.27990722656, 59453.71350479126, 59460.453773498535, 59195.827087402344, 59389.46011352539, 57805.333557128906, 59699.333435058594, 58851.0735168457, 56843.92041134834, 56657.7934551239, 54030.146839141846, 59404.58022689819, 54952.19356441498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.75824052635725, "mean_inference_ms": 6.848493266234288, "mean_action_processing_ms": 0.20342556896217215, "mean_env_wait_ms": 235.89778554721948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038204695049085115, "StateBufferConnector_ms": 0.005942896792763158, "ViewRequirementAgentConnector_ms": 0.21161907597592003}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.72623410807864, "num_env_steps_trained_throughput_per_sec": 337.72623410807864, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 14354.233, "sample_time_ms": 11222.672, "learn_time_ms": 2988.807, "learn_throughput": 1338.327, "synch_weights_time_ms": 141.844}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 1291, "training_iteration": 46, "trial_id": "32397_00000", "date": "2025-03-21_08-48-27", "timestamp": 1742546907, "time_this_iter_s": 11.889537572860718, "time_total_s": 681.5482013225555, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 681.5482013225555, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 96.57058823529411, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.958904109589041, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.806721687316895, "policy_loss": -0.011212838813662529, "vf_loss": 9.817628860473633, "vf_explained_var": -3.488113407001947e-07, "kl": 0.006111363414674997, "entropy": 0.33097317814826965, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 61145.92022705078, "episode_reward_min": 52140.30020046234, "episode_reward_mean": 58704.42115518655, "episode_len_mean": 136.54794520547946, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 52140.30020046234}, "policy_reward_max": {"agent_0": 61145.92022705078}, "policy_reward_mean": {"agent_0": 58704.42115518655}, "custom_metrics": {"num_batches_mean": 5.958904109589041, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61087.04043197632, 57894.74003601074, 59806.28042984009, 60148.57347869873, 58358.18734741211, 59594.086990356445, 59567.366691589355, 59941.72003173828, 59208.56027984619, 60266.07350921631, 59213.33358001709, 57815.233516693115, 60748.46025085449, 58563.01364135742, 58807.82696533203, 61145.92022705078, 59094.153564453125, 59960.67362976074, 59261.120178222656, 58691.73994445801, 60333.01390838623, 60532.713775634766, 58169.206787109375, 59248.193811416626, 58852.86001586914, 58273.9271774292, 59152.07359313965, 60192.47359371185, 59507.120025634766, 58051.74018967152, 59116.133467674255, 59199.10679626465, 58810.46040344238, 58049.58044052124, 58882.4268245697, 60219.120346069336, 57670.54007720947, 54903.30021381378, 60962.647064208984, 57061.18027496338, 59628.053634643555, 58787.50688171387, 60552.620208740234, 59373.053619384766, 58092.640228271484, 57801.99360656738, 60945.68701171875, 59034.42696380615, 59612.10705757141, 59027.46676635742, 55166.68016052246, 56456.27333831787, 60969.42697143555, 60056.2670249939, 58283.613582611084, 57709.747091293335, 52140.30020046234, 59059.90023803711, 57153.67352294922, 56930.40041732788, 52636.093554496765, 58392.306787490845, 59702.29342651367, 58540.36011505127, 55137.106596946716, 59206.66696166992, 59227.01351928711, 58640.686935424805, 60418.800201416016, 56294.67346096039, 57918.60021972656, 57957.80688858032, 58206.57362270355], "episode_lengths": [137, 136, 137, 137, 136, 137, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 137, 136, 136, 137, 137, 136, 138, 137, 137, 136, 137, 137, 136, 137, 136, 136, 136, 137, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 138, 136, 137, 136, 135, 136, 138, 138, 136, 136, 136, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 138, 136, 136, 136, 136], "policy_agent_0_reward": [61087.04043197632, 57894.74003601074, 59806.28042984009, 60148.57347869873, 58358.18734741211, 59594.086990356445, 59567.366691589355, 59941.72003173828, 59208.56027984619, 60266.07350921631, 59213.33358001709, 57815.233516693115, 60748.46025085449, 58563.01364135742, 58807.82696533203, 61145.92022705078, 59094.153564453125, 59960.67362976074, 59261.120178222656, 58691.73994445801, 60333.01390838623, 60532.713775634766, 58169.206787109375, 59248.193811416626, 58852.86001586914, 58273.9271774292, 59152.07359313965, 60192.47359371185, 59507.120025634766, 58051.74018967152, 59116.133467674255, 59199.10679626465, 58810.46040344238, 58049.58044052124, 58882.4268245697, 60219.120346069336, 57670.54007720947, 54903.30021381378, 60962.647064208984, 57061.18027496338, 59628.053634643555, 58787.50688171387, 60552.620208740234, 59373.053619384766, 58092.640228271484, 57801.99360656738, 60945.68701171875, 59034.42696380615, 59612.10705757141, 59027.46676635742, 55166.68016052246, 56456.27333831787, 60969.42697143555, 60056.2670249939, 58283.613582611084, 57709.747091293335, 52140.30020046234, 59059.90023803711, 57153.67352294922, 56930.40041732788, 52636.093554496765, 58392.306787490845, 59702.29342651367, 58540.36011505127, 55137.106596946716, 59206.66696166992, 59227.01351928711, 58640.686935424805, 60418.800201416016, 56294.67346096039, 57918.60021972656, 57957.80688858032, 58206.57362270355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.959210196033126, "mean_inference_ms": 6.7927215181039164, "mean_action_processing_ms": 0.19997136157650444, "mean_env_wait_ms": 235.9517254219824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038213599218081123, "StateBufferConnector_ms": 0.005907228548232823, "ViewRequirementAgentConnector_ms": 0.22014265191065122}}, "episode_reward_max": 61145.92022705078, "episode_reward_min": 52140.30020046234, "episode_reward_mean": 58704.42115518655, "episode_len_mean": 136.54794520547946, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 52140.30020046234}, "policy_reward_max": {"agent_0": 61145.92022705078}, "policy_reward_mean": {"agent_0": 58704.42115518655}, "hist_stats": {"episode_reward": [61087.04043197632, 57894.74003601074, 59806.28042984009, 60148.57347869873, 58358.18734741211, 59594.086990356445, 59567.366691589355, 59941.72003173828, 59208.56027984619, 60266.07350921631, 59213.33358001709, 57815.233516693115, 60748.46025085449, 58563.01364135742, 58807.82696533203, 61145.92022705078, 59094.153564453125, 59960.67362976074, 59261.120178222656, 58691.73994445801, 60333.01390838623, 60532.713775634766, 58169.206787109375, 59248.193811416626, 58852.86001586914, 58273.9271774292, 59152.07359313965, 60192.47359371185, 59507.120025634766, 58051.74018967152, 59116.133467674255, 59199.10679626465, 58810.46040344238, 58049.58044052124, 58882.4268245697, 60219.120346069336, 57670.54007720947, 54903.30021381378, 60962.647064208984, 57061.18027496338, 59628.053634643555, 58787.50688171387, 60552.620208740234, 59373.053619384766, 58092.640228271484, 57801.99360656738, 60945.68701171875, 59034.42696380615, 59612.10705757141, 59027.46676635742, 55166.68016052246, 56456.27333831787, 60969.42697143555, 60056.2670249939, 58283.613582611084, 57709.747091293335, 52140.30020046234, 59059.90023803711, 57153.67352294922, 56930.40041732788, 52636.093554496765, 58392.306787490845, 59702.29342651367, 58540.36011505127, 55137.106596946716, 59206.66696166992, 59227.01351928711, 58640.686935424805, 60418.800201416016, 56294.67346096039, 57918.60021972656, 57957.80688858032, 58206.57362270355], "episode_lengths": [137, 136, 137, 137, 136, 137, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 137, 136, 136, 137, 137, 136, 138, 137, 137, 136, 137, 137, 136, 137, 136, 136, 136, 137, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 138, 136, 137, 136, 135, 136, 138, 138, 136, 136, 136, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 138, 136, 136, 136, 136], "policy_agent_0_reward": [61087.04043197632, 57894.74003601074, 59806.28042984009, 60148.57347869873, 58358.18734741211, 59594.086990356445, 59567.366691589355, 59941.72003173828, 59208.56027984619, 60266.07350921631, 59213.33358001709, 57815.233516693115, 60748.46025085449, 58563.01364135742, 58807.82696533203, 61145.92022705078, 59094.153564453125, 59960.67362976074, 59261.120178222656, 58691.73994445801, 60333.01390838623, 60532.713775634766, 58169.206787109375, 59248.193811416626, 58852.86001586914, 58273.9271774292, 59152.07359313965, 60192.47359371185, 59507.120025634766, 58051.74018967152, 59116.133467674255, 59199.10679626465, 58810.46040344238, 58049.58044052124, 58882.4268245697, 60219.120346069336, 57670.54007720947, 54903.30021381378, 60962.647064208984, 57061.18027496338, 59628.053634643555, 58787.50688171387, 60552.620208740234, 59373.053619384766, 58092.640228271484, 57801.99360656738, 60945.68701171875, 59034.42696380615, 59612.10705757141, 59027.46676635742, 55166.68016052246, 56456.27333831787, 60969.42697143555, 60056.2670249939, 58283.613582611084, 57709.747091293335, 52140.30020046234, 59059.90023803711, 57153.67352294922, 56930.40041732788, 52636.093554496765, 58392.306787490845, 59702.29342651367, 58540.36011505127, 55137.106596946716, 59206.66696166992, 59227.01351928711, 58640.686935424805, 60418.800201416016, 56294.67346096039, 57918.60021972656, 57957.80688858032, 58206.57362270355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.959210196033126, "mean_inference_ms": 6.7927215181039164, "mean_action_processing_ms": 0.19997136157650444, "mean_env_wait_ms": 235.9517254219824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038213599218081123, "StateBufferConnector_ms": 0.005907228548232823, "ViewRequirementAgentConnector_ms": 0.22014265191065122}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.61913555156156, "num_env_steps_trained_throughput_per_sec": 234.61913555156156, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 14372.807, "sample_time_ms": 11325.389, "learn_time_ms": 2903.277, "learn_throughput": 1377.753, "synch_weights_time_ms": 143.22}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 1364, "training_iteration": 47, "trial_id": "32397_00000", "date": "2025-03-21_08-48-44", "timestamp": 1742546924, "time_this_iter_s": 17.09807848930359, "time_total_s": 698.6462798118591, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19c71630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 698.6462798118591, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 98.52083333333333, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988178253173828, "policy_loss": -0.009678376838564873, "vf_loss": 9.99755859375, "vf_explained_var": -2.85382066067541e-06, "kl": 0.005951132159680128, "entropy": 0.30685803294181824, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 58206.57362270355, "episode_reward_min": 58206.57362270355, "episode_reward_mean": 58206.57362270355, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58206.57362270355}, "policy_reward_max": {"agent_0": 58206.57362270355}, "policy_reward_mean": {"agent_0": 58206.57362270355}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58206.57362270355], "episode_lengths": [136], "policy_agent_0_reward": [58206.57362270355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.38535782823531, "mean_inference_ms": 6.68376292105133, "mean_action_processing_ms": 0.2000800794937286, "mean_env_wait_ms": 241.47842350196206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03542900085449219, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1564502716064453}}, "episode_reward_max": 58206.57362270355, "episode_reward_min": 58206.57362270355, "episode_reward_mean": 58206.57362270355, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58206.57362270355}, "policy_reward_max": {"agent_0": 58206.57362270355}, "policy_reward_mean": {"agent_0": 58206.57362270355}, "hist_stats": {"episode_reward": [58206.57362270355], "episode_lengths": [136], "policy_agent_0_reward": [58206.57362270355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.38535782823531, "mean_inference_ms": 6.68376292105133, "mean_action_processing_ms": 0.2000800794937286, "mean_env_wait_ms": 241.47842350196206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03542900085449219, "StateBufferConnector_ms": 0.0056743621826171875, "ViewRequirementAgentConnector_ms": 0.1564502716064453}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.4441490034175, "num_env_steps_trained_throughput_per_sec": 296.4441490034175, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14095.369, "sample_time_ms": 11026.184, "learn_time_ms": 2921.072, "learn_throughput": 1369.36, "synch_weights_time_ms": 147.194}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 1364, "training_iteration": 48, "trial_id": "32397_00000", "date": "2025-03-21_08-48-58", "timestamp": 1742546938, "time_this_iter_s": 13.540542840957642, "time_total_s": 712.1868226528168, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cefa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 712.1868226528168, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 99.58947368421055, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 4.999999873689376e-05, "total_loss": 9.912470817565918, "policy_loss": -0.008653688244521618, "vf_loss": 9.9208984375, "vf_explained_var": -4.0605664253234863e-07, "kl": 0.004498547408729792, "entropy": 0.295860230922699, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 60628.77310180664, "episode_reward_min": 55250.55346488953, "episode_reward_mean": 58759.30334242433, "episode_len_mean": 136.4375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 55250.55346488953}, "policy_reward_max": {"agent_0": 60628.77310180664}, "policy_reward_mean": {"agent_0": 58759.30334242433}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56148.80683708191, 60054.70715332031, 58778.80014038086, 60104.94059562683, 59462.38687133789, 55250.55346488953, 59862.42712402344, 59493.68698120117, 56932.06679344177, 57025.000062942505, 59190.34684753418, 58440.846923828125, 59025.00704956055, 59189.51345825195, 58485.913497924805, 55431.1801803112, 59820.19348144531, 59513.32702636719, 58533.0535736084, 59362.12698364258, 59906.19333648682, 57889.64694213867, 59939.65347290039, 60007.1001625061, 60628.77310180664, 58097.64024353027, 58926.17350769043, 58690.84706115723, 58411.113357543945, 60261.72699737549, 58530.87357330322, 58903.080154418945], "episode_lengths": [136, 137, 136, 137, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [56148.80683708191, 60054.70715332031, 58778.80014038086, 60104.94059562683, 59462.38687133789, 55250.55346488953, 59862.42712402344, 59493.68698120117, 56932.06679344177, 57025.000062942505, 59190.34684753418, 58440.846923828125, 59025.00704956055, 59189.51345825195, 58485.913497924805, 55431.1801803112, 59820.19348144531, 59513.32702636719, 58533.0535736084, 59362.12698364258, 59906.19333648682, 57889.64694213867, 59939.65347290039, 60007.1001625061, 60628.77310180664, 58097.64024353027, 58926.17350769043, 58690.84706115723, 58411.113357543945, 60261.72699737549, 58530.87357330322, 58903.080154418945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13023756763107, "mean_inference_ms": 6.395903083280521, "mean_action_processing_ms": 0.20367142425479348, "mean_env_wait_ms": 220.12035210233537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039933621883392334, "StateBufferConnector_ms": 0.006315857172012329, "ViewRequirementAgentConnector_ms": 0.3059215843677521}}, "episode_reward_max": 60628.77310180664, "episode_reward_min": 55250.55346488953, "episode_reward_mean": 58759.30334242433, "episode_len_mean": 136.4375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 55250.55346488953}, "policy_reward_max": {"agent_0": 60628.77310180664}, "policy_reward_mean": {"agent_0": 58759.30334242433}, "hist_stats": {"episode_reward": [56148.80683708191, 60054.70715332031, 58778.80014038086, 60104.94059562683, 59462.38687133789, 55250.55346488953, 59862.42712402344, 59493.68698120117, 56932.06679344177, 57025.000062942505, 59190.34684753418, 58440.846923828125, 59025.00704956055, 59189.51345825195, 58485.913497924805, 55431.1801803112, 59820.19348144531, 59513.32702636719, 58533.0535736084, 59362.12698364258, 59906.19333648682, 57889.64694213867, 59939.65347290039, 60007.1001625061, 60628.77310180664, 58097.64024353027, 58926.17350769043, 58690.84706115723, 58411.113357543945, 60261.72699737549, 58530.87357330322, 58903.080154418945], "episode_lengths": [136, 137, 136, 137, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [56148.80683708191, 60054.70715332031, 58778.80014038086, 60104.94059562683, 59462.38687133789, 55250.55346488953, 59862.42712402344, 59493.68698120117, 56932.06679344177, 57025.000062942505, 59190.34684753418, 58440.846923828125, 59025.00704956055, 59189.51345825195, 58485.913497924805, 55431.1801803112, 59820.19348144531, 59513.32702636719, 58533.0535736084, 59362.12698364258, 59906.19333648682, 57889.64694213867, 59939.65347290039, 60007.1001625061, 60628.77310180664, 58097.64024353027, 58926.17350769043, 58690.84706115723, 58411.113357543945, 60261.72699737549, 58530.87357330322, 58903.080154418945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.13023756763107, "mean_inference_ms": 6.395903083280521, "mean_action_processing_ms": 0.20367142425479348, "mean_env_wait_ms": 220.12035210233537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039933621883392334, "StateBufferConnector_ms": 0.006315857172012329, "ViewRequirementAgentConnector_ms": 0.3059215843677521}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.0194052386952, "num_env_steps_trained_throughput_per_sec": 272.0194052386952, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 14241.363, "sample_time_ms": 11189.06, "learn_time_ms": 2903.804, "learn_throughput": 1377.503, "synch_weights_time_ms": 147.524}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 1396, "training_iteration": 49, "trial_id": "32397_00000", "date": "2025-03-21_08-49-13", "timestamp": 1742546953, "time_this_iter_s": 14.751250743865967, "time_total_s": 726.9380733966827, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ceea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 726.9380733966827, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 99.305, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982461929321289, "policy_loss": -0.007418307475745678, "vf_loss": 9.989748001098633, "vf_explained_var": -1.377177682115871e-06, "kl": 0.005264776758849621, "entropy": 0.2952294647693634, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 58903.080154418945, "episode_reward_min": 58903.080154418945, "episode_reward_mean": 58903.080154418945, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58903.080154418945}, "policy_reward_max": {"agent_0": 58903.080154418945}, "policy_reward_mean": {"agent_0": 58903.080154418945}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58903.080154418945], "episode_lengths": [136], "policy_agent_0_reward": [58903.080154418945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.110671412370113, "mean_inference_ms": 6.020606963979299, "mean_action_processing_ms": 0.1957977952709599, "mean_env_wait_ms": 227.67527200677634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0370025634765625, "StateBufferConnector_ms": 0.005412101745605469, "ViewRequirementAgentConnector_ms": 0.15354156494140625}}, "episode_reward_max": 58903.080154418945, "episode_reward_min": 58903.080154418945, "episode_reward_mean": 58903.080154418945, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58903.080154418945}, "policy_reward_max": {"agent_0": 58903.080154418945}, "policy_reward_mean": {"agent_0": 58903.080154418945}, "hist_stats": {"episode_reward": [58903.080154418945], "episode_lengths": [136], "policy_agent_0_reward": [58903.080154418945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.110671412370113, "mean_inference_ms": 6.020606963979299, "mean_action_processing_ms": 0.1957977952709599, "mean_env_wait_ms": 227.67527200677634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0370025634765625, "StateBufferConnector_ms": 0.005412101745605469, "ViewRequirementAgentConnector_ms": 0.15354156494140625}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.04437091603717, "num_env_steps_trained_throughput_per_sec": 329.04437091603717, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 14200.891, "sample_time_ms": 11170.712, "learn_time_ms": 2883.631, "learn_throughput": 1387.14, "synch_weights_time_ms": 145.589}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 1396, "training_iteration": 50, "trial_id": "32397_00000", "date": "2025-03-21_08-49-25", "timestamp": 1742546965, "time_this_iter_s": 12.206655025482178, "time_total_s": 739.1447284221649, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19b93130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 739.1447284221649, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 99.42777777777778, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.119565217391305, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.763785362243652, "policy_loss": -0.007871530018746853, "vf_loss": 9.771484375, "vf_explained_var": -9.601315014151623e-07, "kl": 0.006890138145536184, "entropy": 0.302734375, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 61095.38687133789, "episode_reward_min": 51715.02011299133, "episode_reward_mean": 58424.852414326175, "episode_len_mean": 136.40217391304347, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 51715.02011299133}, "policy_reward_max": {"agent_0": 61095.38687133789}, "policy_reward_mean": {"agent_0": 58424.852414326175}, "custom_metrics": {"num_batches_mean": 5.119565217391305, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53521.58017921448, 60284.9264831543, 58032.086837768555, 58396.080627441406, 54331.89347267151, 60733.060302734375, 58895.900287628174, 60558.26704406738, 58039.14011001587, 59224.067123413086, 57587.58680725098, 60438.720123291016, 60217.38021850586, 59800.82009887695, 59179.906967163086, 60543.09359741211, 59601.69340515137, 60001.23408508301, 58700.87339782715, 60003.54706573486, 59359.58679199219, 59314.99352264404, 56948.98676156998, 56275.793659210205, 59523.71348571777, 60016.97346496582, 55362.56027793884, 60595.466705322266, 58710.74034118652, 59216.453521728516, 56781.50700187683, 58794.30660247803, 58752.40000915527, 51715.02011299133, 57913.62718963623, 59016.50720024109, 59794.87385559082, 59723.77338409424, 58744.94698524475, 60576.22018432617, 58883.34683227539, 57500.48697590828, 55981.31336545944, 60105.60023498535, 52184.86694979668, 57894.54019165039, 59151.533599853516, 59289.96710205078, 59149.346603393555, 60706.68048095703, 60137.24688720703, 57523.62696838379, 54074.50020265579, 57109.67334318161, 59083.100021362305, 59239.80017089844, 59800.19392776489, 57081.55335998535, 58113.813537597656, 55043.28001785278, 56408.933690071106, 57993.14688014984, 59485.79343032837, 61095.38687133789, 60781.60009765625, 58552.87364196777, 58096.00672149658, 59969.83353424072, 55335.69345164299, 59987.02045440674, 57430.48033905029, 52183.26036310196, 58046.86700439453, 58790.573568344116, 58741.14715576172, 56760.073654174805, 60039.80702972412, 57082.400396347046, 59879.140075683594, 59540.7400970459, 58158.3071975708, 55018.06025123596, 59819.32730102539, 57965.386795043945, 58416.16709423065, 61013.60690307617, 58798.600340902805, 59353.88023376465, 59481.2470664978, 60202.460052490234, 58701.18035650253, 58672.640003204346], "episode_lengths": [136, 137, 136, 137, 136, 137, 136, 137, 137, 137, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 136, 136, 135, 136, 137, 134, 135, 137, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 136, 136, 137, 138, 137, 136, 136, 137, 136, 137, 136, 135, 136, 136, 136, 136, 137, 136, 137, 137, 137, 136, 137, 135, 136, 137, 138, 136, 137, 137, 136, 136], "policy_agent_0_reward": [53521.58017921448, 60284.9264831543, 58032.086837768555, 58396.080627441406, 54331.89347267151, 60733.060302734375, 58895.900287628174, 60558.26704406738, 58039.14011001587, 59224.067123413086, 57587.58680725098, 60438.720123291016, 60217.38021850586, 59800.82009887695, 59179.906967163086, 60543.09359741211, 59601.69340515137, 60001.23408508301, 58700.87339782715, 60003.54706573486, 59359.58679199219, 59314.99352264404, 56948.98676156998, 56275.793659210205, 59523.71348571777, 60016.97346496582, 55362.56027793884, 60595.466705322266, 58710.74034118652, 59216.453521728516, 56781.50700187683, 58794.30660247803, 58752.40000915527, 51715.02011299133, 57913.62718963623, 59016.50720024109, 59794.87385559082, 59723.77338409424, 58744.94698524475, 60576.22018432617, 58883.34683227539, 57500.48697590828, 55981.31336545944, 60105.60023498535, 52184.86694979668, 57894.54019165039, 59151.533599853516, 59289.96710205078, 59149.346603393555, 60706.68048095703, 60137.24688720703, 57523.62696838379, 54074.50020265579, 57109.67334318161, 59083.100021362305, 59239.80017089844, 59800.19392776489, 57081.55335998535, 58113.813537597656, 55043.28001785278, 56408.933690071106, 57993.14688014984, 59485.79343032837, 61095.38687133789, 60781.60009765625, 58552.87364196777, 58096.00672149658, 59969.83353424072, 55335.69345164299, 59987.02045440674, 57430.48033905029, 52183.26036310196, 58046.86700439453, 58790.573568344116, 58741.14715576172, 56760.073654174805, 60039.80702972412, 57082.400396347046, 59879.140075683594, 59540.7400970459, 58158.3071975708, 55018.06025123596, 59819.32730102539, 57965.386795043945, 58416.16709423065, 61013.60690307617, 58798.600340902805, 59353.88023376465, 59481.2470664978, 60202.460052490234, 58701.18035650253, 58672.640003204346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.80839458093745, "mean_inference_ms": 6.771507841852825, "mean_action_processing_ms": 0.20001188133619802, "mean_env_wait_ms": 235.1421591775918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04407841226328974, "StateBufferConnector_ms": 0.00641942024230957, "ViewRequirementAgentConnector_ms": 0.2912518770798393}}, "episode_reward_max": 61095.38687133789, "episode_reward_min": 51715.02011299133, "episode_reward_mean": 58424.852414326175, "episode_len_mean": 136.40217391304347, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 51715.02011299133}, "policy_reward_max": {"agent_0": 61095.38687133789}, "policy_reward_mean": {"agent_0": 58424.852414326175}, "hist_stats": {"episode_reward": [53521.58017921448, 60284.9264831543, 58032.086837768555, 58396.080627441406, 54331.89347267151, 60733.060302734375, 58895.900287628174, 60558.26704406738, 58039.14011001587, 59224.067123413086, 57587.58680725098, 60438.720123291016, 60217.38021850586, 59800.82009887695, 59179.906967163086, 60543.09359741211, 59601.69340515137, 60001.23408508301, 58700.87339782715, 60003.54706573486, 59359.58679199219, 59314.99352264404, 56948.98676156998, 56275.793659210205, 59523.71348571777, 60016.97346496582, 55362.56027793884, 60595.466705322266, 58710.74034118652, 59216.453521728516, 56781.50700187683, 58794.30660247803, 58752.40000915527, 51715.02011299133, 57913.62718963623, 59016.50720024109, 59794.87385559082, 59723.77338409424, 58744.94698524475, 60576.22018432617, 58883.34683227539, 57500.48697590828, 55981.31336545944, 60105.60023498535, 52184.86694979668, 57894.54019165039, 59151.533599853516, 59289.96710205078, 59149.346603393555, 60706.68048095703, 60137.24688720703, 57523.62696838379, 54074.50020265579, 57109.67334318161, 59083.100021362305, 59239.80017089844, 59800.19392776489, 57081.55335998535, 58113.813537597656, 55043.28001785278, 56408.933690071106, 57993.14688014984, 59485.79343032837, 61095.38687133789, 60781.60009765625, 58552.87364196777, 58096.00672149658, 59969.83353424072, 55335.69345164299, 59987.02045440674, 57430.48033905029, 52183.26036310196, 58046.86700439453, 58790.573568344116, 58741.14715576172, 56760.073654174805, 60039.80702972412, 57082.400396347046, 59879.140075683594, 59540.7400970459, 58158.3071975708, 55018.06025123596, 59819.32730102539, 57965.386795043945, 58416.16709423065, 61013.60690307617, 58798.600340902805, 59353.88023376465, 59481.2470664978, 60202.460052490234, 58701.18035650253, 58672.640003204346], "episode_lengths": [136, 137, 136, 137, 136, 137, 136, 137, 137, 137, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 136, 136, 135, 136, 137, 134, 135, 137, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 136, 136, 137, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 136, 136, 137, 138, 137, 136, 136, 137, 136, 137, 136, 135, 136, 136, 136, 136, 137, 136, 137, 137, 137, 136, 137, 135, 136, 137, 138, 136, 137, 137, 136, 136], "policy_agent_0_reward": [53521.58017921448, 60284.9264831543, 58032.086837768555, 58396.080627441406, 54331.89347267151, 60733.060302734375, 58895.900287628174, 60558.26704406738, 58039.14011001587, 59224.067123413086, 57587.58680725098, 60438.720123291016, 60217.38021850586, 59800.82009887695, 59179.906967163086, 60543.09359741211, 59601.69340515137, 60001.23408508301, 58700.87339782715, 60003.54706573486, 59359.58679199219, 59314.99352264404, 56948.98676156998, 56275.793659210205, 59523.71348571777, 60016.97346496582, 55362.56027793884, 60595.466705322266, 58710.74034118652, 59216.453521728516, 56781.50700187683, 58794.30660247803, 58752.40000915527, 51715.02011299133, 57913.62718963623, 59016.50720024109, 59794.87385559082, 59723.77338409424, 58744.94698524475, 60576.22018432617, 58883.34683227539, 57500.48697590828, 55981.31336545944, 60105.60023498535, 52184.86694979668, 57894.54019165039, 59151.533599853516, 59289.96710205078, 59149.346603393555, 60706.68048095703, 60137.24688720703, 57523.62696838379, 54074.50020265579, 57109.67334318161, 59083.100021362305, 59239.80017089844, 59800.19392776489, 57081.55335998535, 58113.813537597656, 55043.28001785278, 56408.933690071106, 57993.14688014984, 59485.79343032837, 61095.38687133789, 60781.60009765625, 58552.87364196777, 58096.00672149658, 59969.83353424072, 55335.69345164299, 59987.02045440674, 57430.48033905029, 52183.26036310196, 58046.86700439453, 58790.573568344116, 58741.14715576172, 56760.073654174805, 60039.80702972412, 57082.400396347046, 59879.140075683594, 59540.7400970459, 58158.3071975708, 55018.06025123596, 59819.32730102539, 57965.386795043945, 58416.16709423065, 61013.60690307617, 58798.600340902805, 59353.88023376465, 59481.2470664978, 60202.460052490234, 58701.18035650253, 58672.640003204346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.80839458093745, "mean_inference_ms": 6.771507841852825, "mean_action_processing_ms": 0.20001188133619802, "mean_env_wait_ms": 235.1421591775918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04407841226328974, "StateBufferConnector_ms": 0.00641942024230957, "ViewRequirementAgentConnector_ms": 0.2912518770798393}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.71440049585638, "num_env_steps_trained_throughput_per_sec": 240.71440049585638, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 14254.447, "sample_time_ms": 11283.841, "learn_time_ms": 2822.765, "learn_throughput": 1417.05, "synch_weights_time_ms": 146.838}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 1488, "training_iteration": 51, "trial_id": "32397_00000", "date": "2025-03-21_08-49-42", "timestamp": 1742546982, "time_this_iter_s": 16.674692630767822, "time_total_s": 755.8194210529327, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42dd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 755.8194210529327, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 95.75454545454545, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99374771118164, "policy_loss": -0.006379363127052784, "vf_loss": 10.0, "vf_explained_var": -5.853052016391302e-07, "kl": 0.005070611834526062, "entropy": 0.31192609667778015, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 58672.640003204346, "episode_reward_min": 58672.640003204346, "episode_reward_mean": 58672.640003204346, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58672.640003204346}, "policy_reward_max": {"agent_0": 58672.640003204346}, "policy_reward_mean": {"agent_0": 58672.640003204346}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58672.640003204346], "episode_lengths": [136], "policy_agent_0_reward": [58672.640003204346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.09035826809773, "mean_inference_ms": 6.641215221033605, "mean_action_processing_ms": 0.1994164823682777, "mean_env_wait_ms": 240.4895204017298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04286766052246094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.4789113998413086}}, "episode_reward_max": 58672.640003204346, "episode_reward_min": 58672.640003204346, "episode_reward_mean": 58672.640003204346, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58672.640003204346}, "policy_reward_max": {"agent_0": 58672.640003204346}, "policy_reward_mean": {"agent_0": 58672.640003204346}, "hist_stats": {"episode_reward": [58672.640003204346], "episode_lengths": [136], "policy_agent_0_reward": [58672.640003204346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.09035826809773, "mean_inference_ms": 6.641215221033605, "mean_action_processing_ms": 0.1994164823682777, "mean_env_wait_ms": 240.4895204017298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04286766052246094, "StateBufferConnector_ms": 0.006771087646484375, "ViewRequirementAgentConnector_ms": 0.4789113998413086}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.62383824928634, "num_env_steps_trained_throughput_per_sec": 299.62383824928634, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 13994.699, "sample_time_ms": 11013.782, "learn_time_ms": 2839.43, "learn_throughput": 1408.733, "synch_weights_time_ms": 140.696}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 1488, "training_iteration": 52, "trial_id": "32397_00000", "date": "2025-03-21_08-49-55", "timestamp": 1742546995, "time_this_iter_s": 13.416742086410522, "time_total_s": 769.2361631393433, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19b92f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 769.2361631393433, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 99.57894736842104, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.919979095458984, "policy_loss": -0.0073832920752465725, "vf_loss": 9.927254676818848, "vf_explained_var": -2.587835012946016e-07, "kl": 0.004320329520851374, "entropy": 0.2886718809604645, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 61437.760314941406, "episode_reward_min": 55730.079907894135, "episode_reward_mean": 58464.95092339175, "episode_len_mean": 136.32142857142858, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 55730.079907894135}, "policy_reward_max": {"agent_0": 61437.760314941406}, "policy_reward_mean": {"agent_0": 58464.95092339175}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58899.853591918945, 57583.880195617676, 59555.93341064453, 57816.00685882568, 59793.26721191406, 55730.079907894135, 57610.62014770508, 58323.273487091064, 56142.506930828094, 59293.46701049805, 61437.760314941406, 57699.82699012756, 56644.22689771652, 58978.98025512695, 58010.36674499512, 58055.63368797302, 58343.75991821289, 59776.073501586914, 60125.01350402832, 60613.92681121826, 59118.36012840271, 59988.29390716553, 57846.05355834961, 56800.95359802246, 58789.32678222656, 59893.393493652344, 56295.47335243225, 57852.31365585327], "episode_lengths": [136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 138, 136, 137, 136, 135, 137, 136, 137, 137, 137, 137, 137, 136, 135, 136, 137, 134, 137], "policy_agent_0_reward": [58899.853591918945, 57583.880195617676, 59555.93341064453, 57816.00685882568, 59793.26721191406, 55730.079907894135, 57610.62014770508, 58323.273487091064, 56142.506930828094, 59293.46701049805, 61437.760314941406, 57699.82699012756, 56644.22689771652, 58978.98025512695, 58010.36674499512, 58055.63368797302, 58343.75991821289, 59776.073501586914, 60125.01350402832, 60613.92681121826, 59118.36012840271, 59988.29390716553, 57846.05355834961, 56800.95359802246, 58789.32678222656, 59893.393493652344, 56295.47335243225, 57852.31365585327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.694311477700058, "mean_inference_ms": 6.353365124488362, "mean_action_processing_ms": 0.20384082988816868, "mean_env_wait_ms": 219.08315035275047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039008685520717075, "StateBufferConnector_ms": 0.006107773099626813, "ViewRequirementAgentConnector_ms": 0.21116648401532853}}, "episode_reward_max": 61437.760314941406, "episode_reward_min": 55730.079907894135, "episode_reward_mean": 58464.95092339175, "episode_len_mean": 136.32142857142858, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 55730.079907894135}, "policy_reward_max": {"agent_0": 61437.760314941406}, "policy_reward_mean": {"agent_0": 58464.95092339175}, "hist_stats": {"episode_reward": [58899.853591918945, 57583.880195617676, 59555.93341064453, 57816.00685882568, 59793.26721191406, 55730.079907894135, 57610.62014770508, 58323.273487091064, 56142.506930828094, 59293.46701049805, 61437.760314941406, 57699.82699012756, 56644.22689771652, 58978.98025512695, 58010.36674499512, 58055.63368797302, 58343.75991821289, 59776.073501586914, 60125.01350402832, 60613.92681121826, 59118.36012840271, 59988.29390716553, 57846.05355834961, 56800.95359802246, 58789.32678222656, 59893.393493652344, 56295.47335243225, 57852.31365585327], "episode_lengths": [136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 138, 136, 137, 136, 135, 137, 136, 137, 137, 137, 137, 137, 136, 135, 136, 137, 134, 137], "policy_agent_0_reward": [58899.853591918945, 57583.880195617676, 59555.93341064453, 57816.00685882568, 59793.26721191406, 55730.079907894135, 57610.62014770508, 58323.273487091064, 56142.506930828094, 59293.46701049805, 61437.760314941406, 57699.82699012756, 56644.22689771652, 58978.98025512695, 58010.36674499512, 58055.63368797302, 58343.75991821289, 59776.073501586914, 60125.01350402832, 60613.92681121826, 59118.36012840271, 59988.29390716553, 57846.05355834961, 56800.95359802246, 58789.32678222656, 59893.393493652344, 56295.47335243225, 57852.31365585327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.694311477700058, "mean_inference_ms": 6.353365124488362, "mean_action_processing_ms": 0.20384082988816868, "mean_env_wait_ms": 219.08315035275047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039008685520717075, "StateBufferConnector_ms": 0.006107773099626813, "ViewRequirementAgentConnector_ms": 0.21116648401532853}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.2875156919682, "num_env_steps_trained_throughput_per_sec": 318.2875156919682, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 13938.737, "sample_time_ms": 11025.372, "learn_time_ms": 2768.953, "learn_throughput": 1444.59, "synch_weights_time_ms": 143.544}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 1516, "training_iteration": 53, "trial_id": "32397_00000", "date": "2025-03-21_08-50-08", "timestamp": 1742547008, "time_this_iter_s": 12.621542692184448, "time_total_s": 781.8577058315277, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19c71630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 781.8577058315277, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 99.4611111111111, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982961654663086, "policy_loss": -0.007337905932217836, "vf_loss": 9.990234375, "vf_explained_var": 4.872059093941061e-07, "kl": 0.0052850013598799706, "entropy": 0.29365986585617065, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 61239.527252197266, "episode_reward_min": 58539.22018432617, "episode_reward_mean": 59391.85862350464, "episode_len_mean": 136.5, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 58539.22018432617}, "policy_reward_max": {"agent_0": 61239.527252197266}, "policy_reward_mean": {"agent_0": 59391.85862350464}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61239.527252197266, 58795.98014831543, 58992.70690917969, 58539.22018432617], "episode_lengths": [137, 136, 136, 137], "policy_agent_0_reward": [61239.527252197266, 58795.98014831543, 58992.70690917969, 58539.22018432617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.772327508407567, "mean_inference_ms": 6.310788387003336, "mean_action_processing_ms": 0.1992037038220092, "mean_env_wait_ms": 219.79774826373938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03279447555541992, "StateBufferConnector_ms": 0.005233287811279297, "ViewRequirementAgentConnector_ms": 0.14638900756835938}}, "episode_reward_max": 61239.527252197266, "episode_reward_min": 58539.22018432617, "episode_reward_mean": 59391.85862350464, "episode_len_mean": 136.5, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 58539.22018432617}, "policy_reward_max": {"agent_0": 61239.527252197266}, "policy_reward_mean": {"agent_0": 59391.85862350464}, "hist_stats": {"episode_reward": [61239.527252197266, 58795.98014831543, 58992.70690917969, 58539.22018432617], "episode_lengths": [137, 136, 136, 137], "policy_agent_0_reward": [61239.527252197266, 58795.98014831543, 58992.70690917969, 58539.22018432617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.772327508407567, "mean_inference_ms": 6.310788387003336, "mean_action_processing_ms": 0.1992037038220092, "mean_env_wait_ms": 219.79774826373938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03279447555541992, "StateBufferConnector_ms": 0.005233287811279297, "ViewRequirementAgentConnector_ms": 0.14638900756835938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1752928551738, "num_env_steps_trained_throughput_per_sec": 311.1752928551738, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 13919.203, "sample_time_ms": 10994.563, "learn_time_ms": 2786.714, "learn_throughput": 1435.383, "synch_weights_time_ms": 137.046}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 1520, "training_iteration": 54, "trial_id": "32397_00000", "date": "2025-03-21_08-50-21", "timestamp": 1742547021, "time_this_iter_s": 12.904496669769287, "time_total_s": 794.762202501297, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 794.762202501297, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 99.51052631578949, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.762102127075195, "policy_loss": -0.007254782132804394, "vf_loss": 9.769288063049316, "vf_explained_var": -7.798895467203693e-07, "kl": 0.005522753577679396, "entropy": 0.2752944827079773, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 61940.97381591797, "episode_reward_min": 51941.466811180115, "episode_reward_mean": 58517.41797017014, "episode_len_mean": 136.42391304347825, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 51941.466811180115}, "policy_reward_max": {"agent_0": 61940.97381591797}, "policy_reward_mean": {"agent_0": 58517.41797017014}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57330.16022825241, 59936.64682006836, 57452.93356513977, 56801.64682888985, 59760.66020202637, 55983.08676528931, 57808.95373916626, 56874.46677207947, 52970.233717918396, 59314.09376525879, 58212.540115356445, 60693.360107421875, 59245.32683181763, 57817.68692779541, 60277.67349243164, 57611.43360900879, 58687.75344848633, 59521.013763427734, 60225.10708618164, 60244.42004394531, 59794.453552246094, 57846.707038879395, 60479.77363586426, 57763.46692276001, 56846.62004852295, 52846.6534409523, 59961.13345336914, 57637.46022796631, 60567.033432006836, 59365.926834106445, 58596.81372833252, 59886.95347595215, 59879.91349411011, 59542.42672729492, 56256.766859054565, 58686.90703392029, 58690.61338043213, 55791.07983207703, 58073.10682678223, 59054.91357421875, 60454.993072509766, 59411.22018432617, 57950.14669036865, 52342.68022727966, 58076.060297966, 59793.68701171875, 60607.14706039429, 58714.34685897827, 55052.30024909973, 59309.98037338257, 57771.52007293701, 57477.726724386215, 56926.99358558655, 57117.833431720734, 61241.40042114258, 60973.89373779297, 59988.56671142578, 60233.013580322266, 61940.97381591797, 59294.23350715637, 58256.99363708496, 58921.833435058594, 56763.3600769043, 59497.10678100586, 61007.48684692383, 59926.94039916992, 59415.77354431152, 59776.0671081543, 56917.38689804077, 59685.26686191559, 56573.60043668747, 56397.52668762207, 61071.48031616211, 60469.56050109863, 58924.68698120117, 51941.466811180115, 59760.233657836914, 58426.78675079346, 60166.213386535645, 60975.82711791992, 60438.093505859375, 57685.36030578613, 58740.233459472656, 57576.08015918732, 60045.32696533203, 54329.45360445976, 57187.31367516518, 59901.37355041504, 56945.14663314819, 60672.60705566406, 57664.23352050781, 58524.99362182617], "episode_lengths": [136, 137, 137, 137, 136, 136, 136, 136, 135, 138, 136, 137, 136, 136, 137, 135, 137, 137, 137, 137, 137, 136, 137, 136, 136, 135, 136, 136, 136, 136, 137, 137, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 135, 136, 136, 137, 137, 137, 137, 137, 137, 137, 138, 137, 136, 136, 136, 136, 137, 136, 136, 136, 136, 136, 136, 135, 138, 138, 136, 135, 137, 136, 137, 138, 137, 137, 136, 136, 136, 135, 137, 137, 136, 136, 136, 137], "policy_agent_0_reward": [57330.16022825241, 59936.64682006836, 57452.93356513977, 56801.64682888985, 59760.66020202637, 55983.08676528931, 57808.95373916626, 56874.46677207947, 52970.233717918396, 59314.09376525879, 58212.540115356445, 60693.360107421875, 59245.32683181763, 57817.68692779541, 60277.67349243164, 57611.43360900879, 58687.75344848633, 59521.013763427734, 60225.10708618164, 60244.42004394531, 59794.453552246094, 57846.707038879395, 60479.77363586426, 57763.46692276001, 56846.62004852295, 52846.6534409523, 59961.13345336914, 57637.46022796631, 60567.033432006836, 59365.926834106445, 58596.81372833252, 59886.95347595215, 59879.91349411011, 59542.42672729492, 56256.766859054565, 58686.90703392029, 58690.61338043213, 55791.07983207703, 58073.10682678223, 59054.91357421875, 60454.993072509766, 59411.22018432617, 57950.14669036865, 52342.68022727966, 58076.060297966, 59793.68701171875, 60607.14706039429, 58714.34685897827, 55052.30024909973, 59309.98037338257, 57771.52007293701, 57477.726724386215, 56926.99358558655, 57117.833431720734, 61241.40042114258, 60973.89373779297, 59988.56671142578, 60233.013580322266, 61940.97381591797, 59294.23350715637, 58256.99363708496, 58921.833435058594, 56763.3600769043, 59497.10678100586, 61007.48684692383, 59926.94039916992, 59415.77354431152, 59776.0671081543, 56917.38689804077, 59685.26686191559, 56573.60043668747, 56397.52668762207, 61071.48031616211, 60469.56050109863, 58924.68698120117, 51941.466811180115, 59760.233657836914, 58426.78675079346, 60166.213386535645, 60975.82711791992, 60438.093505859375, 57685.36030578613, 58740.233459472656, 57576.08015918732, 60045.32696533203, 54329.45360445976, 57187.31367516518, 59901.37355041504, 56945.14663314819, 60672.60705566406, 57664.23352050781, 58524.99362182617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.800886782022758, "mean_inference_ms": 6.759964565940808, "mean_action_processing_ms": 0.19997445882975204, "mean_env_wait_ms": 233.788488943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05281178847603176, "StateBufferConnector_ms": 0.006130726441093113, "ViewRequirementAgentConnector_ms": 0.21741442058397376}}, "episode_reward_max": 61940.97381591797, "episode_reward_min": 51941.466811180115, "episode_reward_mean": 58517.41797017014, "episode_len_mean": 136.42391304347825, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 51941.466811180115}, "policy_reward_max": {"agent_0": 61940.97381591797}, "policy_reward_mean": {"agent_0": 58517.41797017014}, "hist_stats": {"episode_reward": [57330.16022825241, 59936.64682006836, 57452.93356513977, 56801.64682888985, 59760.66020202637, 55983.08676528931, 57808.95373916626, 56874.46677207947, 52970.233717918396, 59314.09376525879, 58212.540115356445, 60693.360107421875, 59245.32683181763, 57817.68692779541, 60277.67349243164, 57611.43360900879, 58687.75344848633, 59521.013763427734, 60225.10708618164, 60244.42004394531, 59794.453552246094, 57846.707038879395, 60479.77363586426, 57763.46692276001, 56846.62004852295, 52846.6534409523, 59961.13345336914, 57637.46022796631, 60567.033432006836, 59365.926834106445, 58596.81372833252, 59886.95347595215, 59879.91349411011, 59542.42672729492, 56256.766859054565, 58686.90703392029, 58690.61338043213, 55791.07983207703, 58073.10682678223, 59054.91357421875, 60454.993072509766, 59411.22018432617, 57950.14669036865, 52342.68022727966, 58076.060297966, 59793.68701171875, 60607.14706039429, 58714.34685897827, 55052.30024909973, 59309.98037338257, 57771.52007293701, 57477.726724386215, 56926.99358558655, 57117.833431720734, 61241.40042114258, 60973.89373779297, 59988.56671142578, 60233.013580322266, 61940.97381591797, 59294.23350715637, 58256.99363708496, 58921.833435058594, 56763.3600769043, 59497.10678100586, 61007.48684692383, 59926.94039916992, 59415.77354431152, 59776.0671081543, 56917.38689804077, 59685.26686191559, 56573.60043668747, 56397.52668762207, 61071.48031616211, 60469.56050109863, 58924.68698120117, 51941.466811180115, 59760.233657836914, 58426.78675079346, 60166.213386535645, 60975.82711791992, 60438.093505859375, 57685.36030578613, 58740.233459472656, 57576.08015918732, 60045.32696533203, 54329.45360445976, 57187.31367516518, 59901.37355041504, 56945.14663314819, 60672.60705566406, 57664.23352050781, 58524.99362182617], "episode_lengths": [136, 137, 137, 137, 136, 136, 136, 136, 135, 138, 136, 137, 136, 136, 137, 135, 137, 137, 137, 137, 137, 136, 137, 136, 136, 135, 136, 136, 136, 136, 137, 137, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 135, 136, 136, 137, 137, 137, 137, 137, 137, 137, 138, 137, 136, 136, 136, 136, 137, 136, 136, 136, 136, 136, 136, 135, 138, 138, 136, 135, 137, 136, 137, 138, 137, 137, 136, 136, 136, 135, 137, 137, 136, 136, 136, 137], "policy_agent_0_reward": [57330.16022825241, 59936.64682006836, 57452.93356513977, 56801.64682888985, 59760.66020202637, 55983.08676528931, 57808.95373916626, 56874.46677207947, 52970.233717918396, 59314.09376525879, 58212.540115356445, 60693.360107421875, 59245.32683181763, 57817.68692779541, 60277.67349243164, 57611.43360900879, 58687.75344848633, 59521.013763427734, 60225.10708618164, 60244.42004394531, 59794.453552246094, 57846.707038879395, 60479.77363586426, 57763.46692276001, 56846.62004852295, 52846.6534409523, 59961.13345336914, 57637.46022796631, 60567.033432006836, 59365.926834106445, 58596.81372833252, 59886.95347595215, 59879.91349411011, 59542.42672729492, 56256.766859054565, 58686.90703392029, 58690.61338043213, 55791.07983207703, 58073.10682678223, 59054.91357421875, 60454.993072509766, 59411.22018432617, 57950.14669036865, 52342.68022727966, 58076.060297966, 59793.68701171875, 60607.14706039429, 58714.34685897827, 55052.30024909973, 59309.98037338257, 57771.52007293701, 57477.726724386215, 56926.99358558655, 57117.833431720734, 61241.40042114258, 60973.89373779297, 59988.56671142578, 60233.013580322266, 61940.97381591797, 59294.23350715637, 58256.99363708496, 58921.833435058594, 56763.3600769043, 59497.10678100586, 61007.48684692383, 59926.94039916992, 59415.77354431152, 59776.0671081543, 56917.38689804077, 59685.26686191559, 56573.60043668747, 56397.52668762207, 61071.48031616211, 60469.56050109863, 58924.68698120117, 51941.466811180115, 59760.233657836914, 58426.78675079346, 60166.213386535645, 60975.82711791992, 60438.093505859375, 57685.36030578613, 58740.233459472656, 57576.08015918732, 60045.32696533203, 54329.45360445976, 57187.31367516518, 59901.37355041504, 56945.14663314819, 60672.60705566406, 57664.23352050781, 58524.99362182617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.800886782022758, "mean_inference_ms": 6.759964565940808, "mean_action_processing_ms": 0.19997445882975204, "mean_env_wait_ms": 233.788488943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05281178847603176, "StateBufferConnector_ms": 0.006130726441093113, "ViewRequirementAgentConnector_ms": 0.21741442058397376}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.58829615773993, "num_env_steps_trained_throughput_per_sec": 243.58829615773993, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 14105.701, "sample_time_ms": 11163.257, "learn_time_ms": 2802.859, "learn_throughput": 1427.114, "synch_weights_time_ms": 138.697}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 1612, "training_iteration": 55, "trial_id": "32397_00000", "date": "2025-03-21_08-50-37", "timestamp": 1742547037, "time_this_iter_s": 16.474119186401367, "time_total_s": 811.2363216876984, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ceea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 811.2363216876984, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 95.85909090909091, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.991585731506348, "policy_loss": -0.008482396602630615, "vf_loss": 10.0, "vf_explained_var": 4.3747326117227203e-07, "kl": 0.0053876060992479324, "entropy": 0.2819157540798187, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 58524.99362182617, "episode_reward_min": 58524.99362182617, "episode_reward_mean": 58524.99362182617, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58524.99362182617}, "policy_reward_max": {"agent_0": 58524.99362182617}, "policy_reward_mean": {"agent_0": 58524.99362182617}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58524.99362182617], "episode_lengths": [137], "policy_agent_0_reward": [58524.99362182617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.08860041213807, "mean_inference_ms": 6.668569959069706, "mean_action_processing_ms": 0.19965207014890776, "mean_env_wait_ms": 240.20828271981736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04382133483886719, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.18088817596435547}}, "episode_reward_max": 58524.99362182617, "episode_reward_min": 58524.99362182617, "episode_reward_mean": 58524.99362182617, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58524.99362182617}, "policy_reward_max": {"agent_0": 58524.99362182617}, "policy_reward_mean": {"agent_0": 58524.99362182617}, "hist_stats": {"episode_reward": [58524.99362182617], "episode_lengths": [137], "policy_agent_0_reward": [58524.99362182617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.08860041213807, "mean_inference_ms": 6.668569959069706, "mean_action_processing_ms": 0.19965207014890776, "mean_env_wait_ms": 240.20828271981736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04382133483886719, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.18088817596435547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.99517387226086, "num_env_steps_trained_throughput_per_sec": 311.99517387226086, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 14203.383, "sample_time_ms": 11180.675, "learn_time_ms": 2876.291, "learn_throughput": 1390.68, "synch_weights_time_ms": 145.53}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 1612, "training_iteration": 56, "trial_id": "32397_00000", "date": "2025-03-21_08-50-50", "timestamp": 1742547050, "time_this_iter_s": 12.875612258911133, "time_total_s": 824.1119339466095, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cefa30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 824.1119339466095, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 99.56111111111112, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.964624404907227, "policy_loss": -0.008099590428173542, "vf_loss": 9.972660064697266, "vf_explained_var": -2.47564162236813e-06, "kl": 0.005051229614764452, "entropy": 0.2700982689857483, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 61205.43347167969, "episode_reward_min": 55489.50031661987, "episode_reward_mean": 58927.828828811646, "episode_len_mean": 136.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 55489.50031661987}, "policy_reward_max": {"agent_0": 61205.43347167969}, "policy_reward_mean": {"agent_0": 58927.828828811646}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57822.633361816406, 58759.05310058594, 58815.32026672363, 61205.43347167969, 58650.446701049805, 59325.14041137695, 58803.15342712402, 59547.78712463379, 55489.50031661987, 60859.82010650635], "episode_lengths": [136, 135, 137, 137, 136, 137, 137, 136, 135, 137], "policy_agent_0_reward": [57822.633361816406, 58759.05310058594, 58815.32026672363, 61205.43347167969, 58650.446701049805, 59325.14041137695, 58803.15342712402, 59547.78712463379, 55489.50031661987, 60859.82010650635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.454784582829248, "mean_inference_ms": 6.477587661378314, "mean_action_processing_ms": 0.19921016237054184, "mean_env_wait_ms": 217.51448021178288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07662296295166016, "StateBufferConnector_ms": 0.005724430084228516, "ViewRequirementAgentConnector_ms": 0.16286134719848633}}, "episode_reward_max": 61205.43347167969, "episode_reward_min": 55489.50031661987, "episode_reward_mean": 58927.828828811646, "episode_len_mean": 136.3, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 55489.50031661987}, "policy_reward_max": {"agent_0": 61205.43347167969}, "policy_reward_mean": {"agent_0": 58927.828828811646}, "hist_stats": {"episode_reward": [57822.633361816406, 58759.05310058594, 58815.32026672363, 61205.43347167969, 58650.446701049805, 59325.14041137695, 58803.15342712402, 59547.78712463379, 55489.50031661987, 60859.82010650635], "episode_lengths": [136, 135, 137, 137, 136, 137, 137, 136, 135, 137], "policy_agent_0_reward": [57822.633361816406, 58759.05310058594, 58815.32026672363, 61205.43347167969, 58650.446701049805, 59325.14041137695, 58803.15342712402, 59547.78712463379, 55489.50031661987, 60859.82010650635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.454784582829248, "mean_inference_ms": 6.477587661378314, "mean_action_processing_ms": 0.19921016237054184, "mean_env_wait_ms": 217.51448021178288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07662296295166016, "StateBufferConnector_ms": 0.005724430084228516, "ViewRequirementAgentConnector_ms": 0.16286134719848633}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.506166642343, "num_env_steps_trained_throughput_per_sec": 309.506166642343, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 13790.874, "sample_time_ms": 10788.02, "learn_time_ms": 2858.338, "learn_throughput": 1399.414, "synch_weights_time_ms": 143.64}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 1622, "training_iteration": 57, "trial_id": "32397_00000", "date": "2025-03-21_08-51-03", "timestamp": 1742547063, "time_this_iter_s": 12.96658706665039, "time_total_s": 837.0785210132599, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 837.0785210132599, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 99.1263157894737, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.590909090909091, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.933734893798828, "policy_loss": -0.010420442558825016, "vf_loss": 9.944091796875, "vf_explained_var": 5.949909223090799e-07, "kl": 0.005051312502473593, "entropy": 0.27029722929000854, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 60728.98013305664, "episode_reward_min": 56438.82695102692, "episode_reward_mean": 59060.50962764567, "episode_len_mean": 136.63636363636363, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 56438.82695102692}, "policy_reward_max": {"agent_0": 60728.98013305664}, "policy_reward_mean": {"agent_0": 59060.50962764567}, "custom_metrics": {"num_batches_mean": 5.590909090909091, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59922.80714416504, 59514.42043304443, 59049.1936340332, 59984.840393066406, 58995.88022994995, 59806.420206069946, 59608.746841430664, 60728.98013305664, 56941.953384399414, 59843.47994995117, 59416.860107421875, 56438.82695102692, 57941.07327270508, 56481.81359100342, 60505.380378723145, 59031.61340045929, 60274.84691619873, 60269.23342895508, 58781.78012084961, 58090.28031158447, 58214.653851509094, 59488.127128601074], "episode_lengths": [137, 137, 136, 137, 136, 136, 137, 137, 136, 137, 136, 137, 136, 137, 137, 137, 138, 136, 136, 137, 136, 137], "policy_agent_0_reward": [59922.80714416504, 59514.42043304443, 59049.1936340332, 59984.840393066406, 58995.88022994995, 59806.420206069946, 59608.746841430664, 60728.98013305664, 56941.953384399414, 59843.47994995117, 59416.860107421875, 56438.82695102692, 57941.07327270508, 56481.81359100342, 60505.380378723145, 59031.61340045929, 60274.84691619873, 60269.23342895508, 58781.78012084961, 58090.28031158447, 58214.653851509094, 59488.127128601074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.660353725323795, "mean_inference_ms": 6.25814756021742, "mean_action_processing_ms": 0.20392155551072857, "mean_env_wait_ms": 218.32437464326742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05739493803544478, "StateBufferConnector_ms": 0.006282329559326172, "ViewRequirementAgentConnector_ms": 0.22709152915261008}}, "episode_reward_max": 60728.98013305664, "episode_reward_min": 56438.82695102692, "episode_reward_mean": 59060.50962764567, "episode_len_mean": 136.63636363636363, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 56438.82695102692}, "policy_reward_max": {"agent_0": 60728.98013305664}, "policy_reward_mean": {"agent_0": 59060.50962764567}, "hist_stats": {"episode_reward": [59922.80714416504, 59514.42043304443, 59049.1936340332, 59984.840393066406, 58995.88022994995, 59806.420206069946, 59608.746841430664, 60728.98013305664, 56941.953384399414, 59843.47994995117, 59416.860107421875, 56438.82695102692, 57941.07327270508, 56481.81359100342, 60505.380378723145, 59031.61340045929, 60274.84691619873, 60269.23342895508, 58781.78012084961, 58090.28031158447, 58214.653851509094, 59488.127128601074], "episode_lengths": [137, 137, 136, 137, 136, 136, 137, 137, 136, 137, 136, 137, 136, 137, 137, 137, 138, 136, 136, 137, 136, 137], "policy_agent_0_reward": [59922.80714416504, 59514.42043304443, 59049.1936340332, 59984.840393066406, 58995.88022994995, 59806.420206069946, 59608.746841430664, 60728.98013305664, 56941.953384399414, 59843.47994995117, 59416.860107421875, 56438.82695102692, 57941.07327270508, 56481.81359100342, 60505.380378723145, 59031.61340045929, 60274.84691619873, 60269.23342895508, 58781.78012084961, 58090.28031158447, 58214.653851509094, 59488.127128601074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.660353725323795, "mean_inference_ms": 6.25814756021742, "mean_action_processing_ms": 0.20392155551072857, "mean_env_wait_ms": 218.32437464326742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05739493803544478, "StateBufferConnector_ms": 0.006282329559326172, "ViewRequirementAgentConnector_ms": 0.22709152915261008}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.01191777177084, "num_env_steps_trained_throughput_per_sec": 250.01191777177084, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 14041.472, "sample_time_ms": 11048.874, "learn_time_ms": 2850.482, "learn_throughput": 1403.271, "synch_weights_time_ms": 141.236}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 1644, "training_iteration": 58, "trial_id": "32397_00000", "date": "2025-03-21_08-51-19", "timestamp": 1742547079, "time_this_iter_s": 16.063339948654175, "time_total_s": 853.1418609619141, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f13010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 853.1418609619141, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 99.27619047619046, "ram_util_percent": 13.423809523809522}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.767572402954102, "policy_loss": -0.007651626132428646, "vf_loss": 9.775150299072266, "vf_explained_var": 6.947666264522923e-08, "kl": 0.00587358046323061, "entropy": 0.25409996509552, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 61804.32034301758, "episode_reward_min": 53804.220582962036, "episode_reward_mean": 58946.081129451595, "episode_len_mean": 136.62222222222223, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 53804.220582962036}, "policy_reward_max": {"agent_0": 61804.32034301758}, "policy_reward_mean": {"agent_0": 58946.081129451595}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56952.45386886597, 59844.84022521973, 60836.546966552734, 60477.5403137207, 55569.80699920654, 57686.4002494812, 59732.08687591553, 60710.273361206055, 58420.886863708496, 60598.52700805664, 61668.80685424805, 60990.373596191406, 59153.56021118164, 60568.90669250488, 60101.280181884766, 61150.10690307617, 56444.9934387207, 59910.040130615234, 60589.65364074707, 60097.32679748535, 56821.660192489624, 55384.94694519043, 58074.48690032959, 59480.406871795654, 55161.33359861374, 58627.08025550842, 60342.52697753906, 56786.39373397827, 58017.25337219238, 59333.97356414795, 60894.57376098633, 57888.907051086426, 60342.5334777832, 56442.44688415527, 56616.30679321289, 60312.12023925781, 60148.7403717041, 59508.773498535156, 57973.76658630371, 59613.82681274414, 60595.600341796875, 61804.32034301758, 61225.88003540039, 61115.04666137695, 58049.64025878906, 56054.17356109619, 58405.0602722168, 56831.58711743355, 54553.106983184814, 59756.7004699707, 57373.700202941895, 59184.12013244629, 60235.41361999512, 58718.40033340454, 53804.220582962036, 58318.933685302734, 61071.14697265625, 59182.540298461914, 59543.493392944336, 60197.380294799805, 59720.406829833984, 58828.333455085754, 58166.23365020752, 57425.40012931824, 59953.14012145996, 59516.353607177734, 59023.62693023682, 61751.166748046875, 59896.333671569824, 60556.58027648926, 55595.51372718811, 61533.47378540039, 60804.86688232422, 58859.75344657898, 57628.84667015076, 54590.36040306091, 59340.960189819336, 60217.6801071167, 57217.486699938774, 60163.180320739746, 58282.75358581543, 59610.66015625, 58812.98017883301, 60307.56701660156, 58831.95383453369, 60012.787109375, 57105.75377655029, 58671.78022766113, 58846.63330078125, 58577.80018615723], "episode_lengths": [137, 138, 138, 137, 135, 136, 137, 137, 136, 137, 137, 137, 137, 137, 137, 137, 136, 136, 137, 137, 135, 136, 137, 137, 137, 136, 137, 136, 136, 137, 137, 136, 137, 136, 135, 136, 137, 137, 136, 137, 137, 138, 138, 137, 137, 135, 136, 136, 136, 136, 136, 136, 137, 136, 136, 136, 138, 138, 137, 137, 137, 137, 136, 137, 137, 137, 137, 137, 136, 137, 136, 138, 138, 137, 137, 136, 136, 137, 136, 137, 136, 137, 136, 137, 136, 137, 136, 136, 136, 136], "policy_agent_0_reward": [56952.45386886597, 59844.84022521973, 60836.546966552734, 60477.5403137207, 55569.80699920654, 57686.4002494812, 59732.08687591553, 60710.273361206055, 58420.886863708496, 60598.52700805664, 61668.80685424805, 60990.373596191406, 59153.56021118164, 60568.90669250488, 60101.280181884766, 61150.10690307617, 56444.9934387207, 59910.040130615234, 60589.65364074707, 60097.32679748535, 56821.660192489624, 55384.94694519043, 58074.48690032959, 59480.406871795654, 55161.33359861374, 58627.08025550842, 60342.52697753906, 56786.39373397827, 58017.25337219238, 59333.97356414795, 60894.57376098633, 57888.907051086426, 60342.5334777832, 56442.44688415527, 56616.30679321289, 60312.12023925781, 60148.7403717041, 59508.773498535156, 57973.76658630371, 59613.82681274414, 60595.600341796875, 61804.32034301758, 61225.88003540039, 61115.04666137695, 58049.64025878906, 56054.17356109619, 58405.0602722168, 56831.58711743355, 54553.106983184814, 59756.7004699707, 57373.700202941895, 59184.12013244629, 60235.41361999512, 58718.40033340454, 53804.220582962036, 58318.933685302734, 61071.14697265625, 59182.540298461914, 59543.493392944336, 60197.380294799805, 59720.406829833984, 58828.333455085754, 58166.23365020752, 57425.40012931824, 59953.14012145996, 59516.353607177734, 59023.62693023682, 61751.166748046875, 59896.333671569824, 60556.58027648926, 55595.51372718811, 61533.47378540039, 60804.86688232422, 58859.75344657898, 57628.84667015076, 54590.36040306091, 59340.960189819336, 60217.6801071167, 57217.486699938774, 60163.180320739746, 58282.75358581543, 59610.66015625, 58812.98017883301, 60307.56701660156, 58831.95383453369, 60012.787109375, 57105.75377655029, 58671.78022766113, 58846.63330078125, 58577.80018615723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.09658900368011, "mean_inference_ms": 6.775423885969462, "mean_action_processing_ms": 0.19979032374334282, "mean_env_wait_ms": 234.02331031060882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04042042626274957, "StateBufferConnector_ms": 0.006168948279486762, "ViewRequirementAgentConnector_ms": 0.2497469054328071}}, "episode_reward_max": 61804.32034301758, "episode_reward_min": 53804.220582962036, "episode_reward_mean": 58946.081129451595, "episode_len_mean": 136.62222222222223, "episodes_this_iter": 90, "policy_reward_min": {"agent_0": 53804.220582962036}, "policy_reward_max": {"agent_0": 61804.32034301758}, "policy_reward_mean": {"agent_0": 58946.081129451595}, "hist_stats": {"episode_reward": [56952.45386886597, 59844.84022521973, 60836.546966552734, 60477.5403137207, 55569.80699920654, 57686.4002494812, 59732.08687591553, 60710.273361206055, 58420.886863708496, 60598.52700805664, 61668.80685424805, 60990.373596191406, 59153.56021118164, 60568.90669250488, 60101.280181884766, 61150.10690307617, 56444.9934387207, 59910.040130615234, 60589.65364074707, 60097.32679748535, 56821.660192489624, 55384.94694519043, 58074.48690032959, 59480.406871795654, 55161.33359861374, 58627.08025550842, 60342.52697753906, 56786.39373397827, 58017.25337219238, 59333.97356414795, 60894.57376098633, 57888.907051086426, 60342.5334777832, 56442.44688415527, 56616.30679321289, 60312.12023925781, 60148.7403717041, 59508.773498535156, 57973.76658630371, 59613.82681274414, 60595.600341796875, 61804.32034301758, 61225.88003540039, 61115.04666137695, 58049.64025878906, 56054.17356109619, 58405.0602722168, 56831.58711743355, 54553.106983184814, 59756.7004699707, 57373.700202941895, 59184.12013244629, 60235.41361999512, 58718.40033340454, 53804.220582962036, 58318.933685302734, 61071.14697265625, 59182.540298461914, 59543.493392944336, 60197.380294799805, 59720.406829833984, 58828.333455085754, 58166.23365020752, 57425.40012931824, 59953.14012145996, 59516.353607177734, 59023.62693023682, 61751.166748046875, 59896.333671569824, 60556.58027648926, 55595.51372718811, 61533.47378540039, 60804.86688232422, 58859.75344657898, 57628.84667015076, 54590.36040306091, 59340.960189819336, 60217.6801071167, 57217.486699938774, 60163.180320739746, 58282.75358581543, 59610.66015625, 58812.98017883301, 60307.56701660156, 58831.95383453369, 60012.787109375, 57105.75377655029, 58671.78022766113, 58846.63330078125, 58577.80018615723], "episode_lengths": [137, 138, 138, 137, 135, 136, 137, 137, 136, 137, 137, 137, 137, 137, 137, 137, 136, 136, 137, 137, 135, 136, 137, 137, 137, 136, 137, 136, 136, 137, 137, 136, 137, 136, 135, 136, 137, 137, 136, 137, 137, 138, 138, 137, 137, 135, 136, 136, 136, 136, 136, 136, 137, 136, 136, 136, 138, 138, 137, 137, 137, 137, 136, 137, 137, 137, 137, 137, 136, 137, 136, 138, 138, 137, 137, 136, 136, 137, 136, 137, 136, 137, 136, 137, 136, 137, 136, 136, 136, 136], "policy_agent_0_reward": [56952.45386886597, 59844.84022521973, 60836.546966552734, 60477.5403137207, 55569.80699920654, 57686.4002494812, 59732.08687591553, 60710.273361206055, 58420.886863708496, 60598.52700805664, 61668.80685424805, 60990.373596191406, 59153.56021118164, 60568.90669250488, 60101.280181884766, 61150.10690307617, 56444.9934387207, 59910.040130615234, 60589.65364074707, 60097.32679748535, 56821.660192489624, 55384.94694519043, 58074.48690032959, 59480.406871795654, 55161.33359861374, 58627.08025550842, 60342.52697753906, 56786.39373397827, 58017.25337219238, 59333.97356414795, 60894.57376098633, 57888.907051086426, 60342.5334777832, 56442.44688415527, 56616.30679321289, 60312.12023925781, 60148.7403717041, 59508.773498535156, 57973.76658630371, 59613.82681274414, 60595.600341796875, 61804.32034301758, 61225.88003540039, 61115.04666137695, 58049.64025878906, 56054.17356109619, 58405.0602722168, 56831.58711743355, 54553.106983184814, 59756.7004699707, 57373.700202941895, 59184.12013244629, 60235.41361999512, 58718.40033340454, 53804.220582962036, 58318.933685302734, 61071.14697265625, 59182.540298461914, 59543.493392944336, 60197.380294799805, 59720.406829833984, 58828.333455085754, 58166.23365020752, 57425.40012931824, 59953.14012145996, 59516.353607177734, 59023.62693023682, 61751.166748046875, 59896.333671569824, 60556.58027648926, 55595.51372718811, 61533.47378540039, 60804.86688232422, 58859.75344657898, 57628.84667015076, 54590.36040306091, 59340.960189819336, 60217.6801071167, 57217.486699938774, 60163.180320739746, 58282.75358581543, 59610.66015625, 58812.98017883301, 60307.56701660156, 58831.95383453369, 60012.787109375, 57105.75377655029, 58671.78022766113, 58846.63330078125, 58577.80018615723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.09658900368011, "mean_inference_ms": 6.775423885969462, "mean_action_processing_ms": 0.19979032374334282, "mean_env_wait_ms": 234.02331031060882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04042042626274957, "StateBufferConnector_ms": 0.006168948279486762, "ViewRequirementAgentConnector_ms": 0.2497469054328071}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.70956045598535, "num_env_steps_trained_throughput_per_sec": 267.70956045598535, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 14065.144, "sample_time_ms": 11103.252, "learn_time_ms": 2825.183, "learn_throughput": 1415.838, "synch_weights_time_ms": 135.895}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 1734, "training_iteration": 59, "trial_id": "32397_00000", "date": "2025-03-21_08-51-34", "timestamp": 1742547094, "time_this_iter_s": 15.010061264038086, "time_total_s": 868.1519222259521, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f130a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 868.1519222259521, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 96.81904761904764, "ram_util_percent": 13.457142857142859}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986181259155273, "policy_loss": -0.008767735213041306, "vf_loss": 9.994873046875, "vf_explained_var": 3.75136721686431e-07, "kl": 0.006137469317764044, "entropy": 0.2771601974964142, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 58787.9602355957, "episode_reward_min": 56893.340119719505, "episode_reward_mean": 57840.650177657604, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56893.340119719505}, "policy_reward_max": {"agent_0": 58787.9602355957}, "policy_reward_mean": {"agent_0": 57840.650177657604}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56893.340119719505, 58787.9602355957], "episode_lengths": [136, 136], "policy_agent_0_reward": [56893.340119719505, 58787.9602355957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.003119855421026, "mean_inference_ms": 6.833487721174599, "mean_action_processing_ms": 0.20107467121161998, "mean_env_wait_ms": 229.10462531616514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05398988723754883, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.15003681182861328}}, "episode_reward_max": 58787.9602355957, "episode_reward_min": 56893.340119719505, "episode_reward_mean": 57840.650177657604, "episode_len_mean": 136.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56893.340119719505}, "policy_reward_max": {"agent_0": 58787.9602355957}, "policy_reward_mean": {"agent_0": 57840.650177657604}, "hist_stats": {"episode_reward": [56893.340119719505, 58787.9602355957], "episode_lengths": [136, 136], "policy_agent_0_reward": [56893.340119719505, 58787.9602355957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.003119855421026, "mean_inference_ms": 6.833487721174599, "mean_action_processing_ms": 0.20107467121161998, "mean_env_wait_ms": 229.10462531616514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05398988723754883, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.15003681182861328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.32808025297703, "num_env_steps_trained_throughput_per_sec": 307.32808025297703, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 14151.041, "sample_time_ms": 11172.283, "learn_time_ms": 2841.979, "learn_throughput": 1407.47, "synch_weights_time_ms": 135.951}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 1736, "training_iteration": 60, "trial_id": "32397_00000", "date": "2025-03-21_08-51-47", "timestamp": 1742547107, "time_this_iter_s": 13.068066596984863, "time_total_s": 881.219988822937, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 881.219988822937, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 99.60555555555555, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.990744590759277, "policy_loss": -0.009344695135951042, "vf_loss": 10.0, "vf_explained_var": -2.669791276943556e-09, "kl": 0.007242020685225725, "entropy": 0.28006744384765625, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 58787.9602355957, "episode_reward_min": 58787.9602355957, "episode_reward_mean": 58787.9602355957, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58787.9602355957}, "policy_reward_max": {"agent_0": 58787.9602355957}, "policy_reward_mean": {"agent_0": 58787.9602355957}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58787.9602355957], "episode_lengths": [136], "policy_agent_0_reward": [58787.9602355957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.251513910566626, "mean_inference_ms": 6.856892023280162, "mean_action_processing_ms": 0.2020861195252005, "mean_env_wait_ms": 235.8025278292988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06413459777832031, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17554759979248047}}, "episode_reward_max": 58787.9602355957, "episode_reward_min": 58787.9602355957, "episode_reward_mean": 58787.9602355957, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58787.9602355957}, "policy_reward_max": {"agent_0": 58787.9602355957}, "policy_reward_mean": {"agent_0": 58787.9602355957}, "hist_stats": {"episode_reward": [58787.9602355957], "episode_lengths": [136], "policy_agent_0_reward": [58787.9602355957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.251513910566626, "mean_inference_ms": 6.856892023280162, "mean_action_processing_ms": 0.2020861195252005, "mean_env_wait_ms": 235.8025278292988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06413459777832031, "StateBufferConnector_ms": 0.00667572021484375, "ViewRequirementAgentConnector_ms": 0.17554759979248047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.99691447448436, "num_env_steps_trained_throughput_per_sec": 311.99691447448436, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 13771.387, "sample_time_ms": 10755.089, "learn_time_ms": 2876.664, "learn_throughput": 1390.499, "synch_weights_time_ms": 138.852}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 1736, "training_iteration": 61, "trial_id": "32397_00000", "date": "2025-03-21_08-52-00", "timestamp": 1742547120, "time_this_iter_s": 12.870506525039673, "time_total_s": 894.0904953479767, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19c71750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 894.0904953479767, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 99.07894736842107, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910266876220703, "policy_loss": -0.009980452246963978, "vf_loss": 9.920166015625, "vf_explained_var": -6.507461307592166e-07, "kl": 0.00644514849409461, "entropy": 0.2968696653842926, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 62006.786712646484, "episode_reward_min": 56791.03360939026, "episode_reward_mean": 59330.5916878432, "episode_len_mean": 136.625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 56791.03360939026}, "policy_reward_max": {"agent_0": 62006.786712646484}, "policy_reward_mean": {"agent_0": 59330.5916878432}, "custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61236.920150756836, 57997.606994628906, 59684.4001159668, 57023.72686481476, 59279.43344116211, 59580.76697540283, 60812.586822509766, 59461.76053094864, 58432.90685272217, 60407.14694213867, 61021.09359741211, 58236.060379981995, 60579.80017089844, 59022.45317840576, 58790.98667907715, 62006.786712646484, 59290.20683288574, 57926.3935546875, 57277.69361305237, 60247.16679382324, 60832.08709716797, 61369.27346801758, 58122.56714344025, 60853.60693359375, 59665.833908081055, 57988.71339035034, 59232.960052490234, 59079.193618774414, 58823.16682052612, 56886.30700302124, 56791.03360939026, 60618.29376220703], "episode_lengths": [138, 136, 137, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 136, 137, 137], "policy_agent_0_reward": [61236.920150756836, 57997.606994628906, 59684.4001159668, 57023.72686481476, 59279.43344116211, 59580.76697540283, 60812.586822509766, 59461.76053094864, 58432.90685272217, 60407.14694213867, 61021.09359741211, 58236.060379981995, 60579.80017089844, 59022.45317840576, 58790.98667907715, 62006.786712646484, 59290.20683288574, 57926.3935546875, 57277.69361305237, 60247.16679382324, 60832.08709716797, 61369.27346801758, 58122.56714344025, 60853.60693359375, 59665.833908081055, 57988.71339035034, 59232.960052490234, 59079.193618774414, 58823.16682052612, 56886.30700302124, 56791.03360939026, 60618.29376220703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.049573030364648, "mean_inference_ms": 6.373817775385754, "mean_action_processing_ms": 0.2021807458380926, "mean_env_wait_ms": 217.90744492017063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04263967275619507, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.2104334533214569}}, "episode_reward_max": 62006.786712646484, "episode_reward_min": 56791.03360939026, "episode_reward_mean": 59330.5916878432, "episode_len_mean": 136.625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 56791.03360939026}, "policy_reward_max": {"agent_0": 62006.786712646484}, "policy_reward_mean": {"agent_0": 59330.5916878432}, "hist_stats": {"episode_reward": [61236.920150756836, 57997.606994628906, 59684.4001159668, 57023.72686481476, 59279.43344116211, 59580.76697540283, 60812.586822509766, 59461.76053094864, 58432.90685272217, 60407.14694213867, 61021.09359741211, 58236.060379981995, 60579.80017089844, 59022.45317840576, 58790.98667907715, 62006.786712646484, 59290.20683288574, 57926.3935546875, 57277.69361305237, 60247.16679382324, 60832.08709716797, 61369.27346801758, 58122.56714344025, 60853.60693359375, 59665.833908081055, 57988.71339035034, 59232.960052490234, 59079.193618774414, 58823.16682052612, 56886.30700302124, 56791.03360939026, 60618.29376220703], "episode_lengths": [138, 136, 137, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 136, 137, 137], "policy_agent_0_reward": [61236.920150756836, 57997.606994628906, 59684.4001159668, 57023.72686481476, 59279.43344116211, 59580.76697540283, 60812.586822509766, 59461.76053094864, 58432.90685272217, 60407.14694213867, 61021.09359741211, 58236.060379981995, 60579.80017089844, 59022.45317840576, 58790.98667907715, 62006.786712646484, 59290.20683288574, 57926.3935546875, 57277.69361305237, 60247.16679382324, 60832.08709716797, 61369.27346801758, 58122.56714344025, 60853.60693359375, 59665.833908081055, 57988.71339035034, 59232.960052490234, 59079.193618774414, 58823.16682052612, 56886.30700302124, 56791.03360939026, 60618.29376220703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.049573030364648, "mean_inference_ms": 6.373817775385754, "mean_action_processing_ms": 0.2021807458380926, "mean_env_wait_ms": 217.90744492017063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04263967275619507, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.2104334533214569}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.0030084609665, "num_env_steps_trained_throughput_per_sec": 242.0030084609665, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 14089.252, "sample_time_ms": 11080.536, "learn_time_ms": 2847.941, "learn_throughput": 1404.524, "synch_weights_time_ms": 160.007}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 1768, "training_iteration": 62, "trial_id": "32397_00000", "date": "2025-03-21_08-52-17", "timestamp": 1742547137, "time_this_iter_s": 16.588348627090454, "time_total_s": 910.6788439750671, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbf5b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 910.6788439750671, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 99.20869565217392, "ram_util_percent": 13.469565217391303}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 4.999999873689376e-05, "total_loss": 9.975080490112305, "policy_loss": -0.010088413022458553, "vf_loss": 9.985107421875, "vf_explained_var": -9.519358741272299e-07, "kl": 0.004911999683827162, "entropy": 0.2606714367866516, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 61948.11361694336, "episode_reward_min": 57543.907079696655, "episode_reward_mean": 59826.046933054924, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 57543.907079696655}, "policy_reward_max": {"agent_0": 61948.11361694336}, "policy_reward_mean": {"agent_0": 59826.046933054924}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [61948.11361694336, 59692.88705444336, 60344.55358886719, 60941.95343017578, 57543.907079696655, 58484.8668282032], "episode_lengths": [138, 137, 137, 137, 136, 137], "policy_agent_0_reward": [61948.11361694336, 59692.88705444336, 60344.55358886719, 60941.95343017578, 57543.907079696655, 58484.8668282032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.050972044438378, "mean_inference_ms": 6.886339349168289, "mean_action_processing_ms": 0.20598770271468966, "mean_env_wait_ms": 232.84867660523722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03638664881388346, "StateBufferConnector_ms": 0.00574191411336263, "ViewRequirementAgentConnector_ms": 0.45090119043986004}}, "episode_reward_max": 61948.11361694336, "episode_reward_min": 57543.907079696655, "episode_reward_mean": 59826.046933054924, "episode_len_mean": 137.0, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 57543.907079696655}, "policy_reward_max": {"agent_0": 61948.11361694336}, "policy_reward_mean": {"agent_0": 59826.046933054924}, "hist_stats": {"episode_reward": [61948.11361694336, 59692.88705444336, 60344.55358886719, 60941.95343017578, 57543.907079696655, 58484.8668282032], "episode_lengths": [138, 137, 137, 137, 136, 137], "policy_agent_0_reward": [61948.11361694336, 59692.88705444336, 60344.55358886719, 60941.95343017578, 57543.907079696655, 58484.8668282032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.050972044438378, "mean_inference_ms": 6.886339349168289, "mean_action_processing_ms": 0.20598770271468966, "mean_env_wait_ms": 232.84867660523722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03638664881388346, "StateBufferConnector_ms": 0.00574191411336263, "ViewRequirementAgentConnector_ms": 0.45090119043986004}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.2071804945039, "num_env_steps_trained_throughput_per_sec": 325.2071804945039, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 14062.512, "sample_time_ms": 11062.116, "learn_time_ms": 2838.771, "learn_throughput": 1409.06, "synch_weights_time_ms": 160.882}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 1774, "training_iteration": 63, "trial_id": "32397_00000", "date": "2025-03-21_08-52-29", "timestamp": 1742547149, "time_this_iter_s": 12.342384576797485, "time_total_s": 923.0212285518646, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e42680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 923.0212285518646, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 98.71666666666667, "ram_util_percent": 13.444444444444445}}
{"custom_metrics": {"num_batches_mean": 5.906976744186046, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.772954940795898, "policy_loss": -0.01053972914814949, "vf_loss": 9.783449172973633, "vf_explained_var": 4.0388354705100937e-07, "kl": 0.007171138189733028, "entropy": 0.27500826120376587, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 61803.526763916016, "episode_reward_min": 52521.20687389374, "episode_reward_mean": 58719.378885335704, "episode_len_mean": 136.47674418604652, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 52521.20687389374}, "policy_reward_max": {"agent_0": 61803.526763916016}, "policy_reward_mean": {"agent_0": 58719.378885335704}, "custom_metrics": {"num_batches_mean": 5.906976744186046, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61146.42010498047, 55715.266969680786, 58863.606941223145, 59327.5266418457, 58962.96680879593, 60304.52697753906, 57026.00665187836, 52521.20687389374, 58479.739990234375, 59064.94659423828, 59138.653633117676, 56050.4668636322, 58167.659954071045, 54118.353611946106, 59567.30687904358, 59666.03356933594, 59153.920166015625, 59344.34711456299, 55387.20010662079, 60211.2869720459, 60619.94041442871, 58830.573749542236, 59920.046630859375, 57785.640197753906, 57701.62690734863, 56038.41375923157, 58641.64004898071, 59955.433532714844, 57926.71351623535, 58326.653579711914, 58323.0602722168, 59829.85363769531, 58164.87359571457, 59827.09353637695, 58201.24002075195, 54414.82684326172, 61744.26675415039, 54666.42001724243, 60120.63346862793, 61803.526763916016, 59470.93354225159, 59182.33349609375, 59174.42671966553, 60518.85366821289, 58940.54673576355, 59572.88706970215, 59365.86678695679, 59845.20039367676, 57432.44004821777, 61424.553771972656, 60398.43344116211, 58151.6600189209, 57457.1667175293, 59975.55367279053, 54871.61359786987, 56153.613489151, 57295.333641052246, 57629.80004119873, 56370.920320510864, 57846.18702507019, 59446.653564453125, 61302.66033935547, 60033.807357788086, 60541.70669555664, 61470.580505371094, 59487.020416259766, 57408.479988098145, 59017.486501693726, 60598.020111083984, 61297.559997558594, 60184.30027770996, 56163.253690719604, 60153.64712524414, 59561.220123291016, 59228.42678833008, 59514.56716156006, 58240.5803527832, 59720.706939697266, 60657.5735168457, 59245.726654052734, 59086.79339790344, 58241.23368835449, 59706.22006225586, 54971.707136154175, 57706.64665412903, 60741.76022338867], "episode_lengths": [137, 135, 137, 137, 136, 136, 136, 136, 136, 137, 137, 135, 136, 136, 136, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 137, 135, 137, 138, 137, 137, 137, 137, 136, 136, 137, 137, 136, 137, 137, 136, 136, 137, 135, 136, 136, 136, 135, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 138, 137, 137, 137, 138, 137, 136, 136, 137, 137, 137, 137, 136, 137, 135, 136, 137], "policy_agent_0_reward": [61146.42010498047, 55715.266969680786, 58863.606941223145, 59327.5266418457, 58962.96680879593, 60304.52697753906, 57026.00665187836, 52521.20687389374, 58479.739990234375, 59064.94659423828, 59138.653633117676, 56050.4668636322, 58167.659954071045, 54118.353611946106, 59567.30687904358, 59666.03356933594, 59153.920166015625, 59344.34711456299, 55387.20010662079, 60211.2869720459, 60619.94041442871, 58830.573749542236, 59920.046630859375, 57785.640197753906, 57701.62690734863, 56038.41375923157, 58641.64004898071, 59955.433532714844, 57926.71351623535, 58326.653579711914, 58323.0602722168, 59829.85363769531, 58164.87359571457, 59827.09353637695, 58201.24002075195, 54414.82684326172, 61744.26675415039, 54666.42001724243, 60120.63346862793, 61803.526763916016, 59470.93354225159, 59182.33349609375, 59174.42671966553, 60518.85366821289, 58940.54673576355, 59572.88706970215, 59365.86678695679, 59845.20039367676, 57432.44004821777, 61424.553771972656, 60398.43344116211, 58151.6600189209, 57457.1667175293, 59975.55367279053, 54871.61359786987, 56153.613489151, 57295.333641052246, 57629.80004119873, 56370.920320510864, 57846.18702507019, 59446.653564453125, 61302.66033935547, 60033.807357788086, 60541.70669555664, 61470.580505371094, 59487.020416259766, 57408.479988098145, 59017.486501693726, 60598.020111083984, 61297.559997558594, 60184.30027770996, 56163.253690719604, 60153.64712524414, 59561.220123291016, 59228.42678833008, 59514.56716156006, 58240.5803527832, 59720.706939697266, 60657.5735168457, 59245.726654052734, 59086.79339790344, 58241.23368835449, 59706.22006225586, 54971.707136154175, 57706.64665412903, 60741.76022338867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.372488316979048, "mean_inference_ms": 6.780635441000508, "mean_action_processing_ms": 0.1987720632574207, "mean_env_wait_ms": 233.83293178834407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07989600647327512, "StateBufferConnector_ms": 0.005954365397608558, "ViewRequirementAgentConnector_ms": 0.192134324894395}}, "episode_reward_max": 61803.526763916016, "episode_reward_min": 52521.20687389374, "episode_reward_mean": 58719.378885335704, "episode_len_mean": 136.47674418604652, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 52521.20687389374}, "policy_reward_max": {"agent_0": 61803.526763916016}, "policy_reward_mean": {"agent_0": 58719.378885335704}, "hist_stats": {"episode_reward": [61146.42010498047, 55715.266969680786, 58863.606941223145, 59327.5266418457, 58962.96680879593, 60304.52697753906, 57026.00665187836, 52521.20687389374, 58479.739990234375, 59064.94659423828, 59138.653633117676, 56050.4668636322, 58167.659954071045, 54118.353611946106, 59567.30687904358, 59666.03356933594, 59153.920166015625, 59344.34711456299, 55387.20010662079, 60211.2869720459, 60619.94041442871, 58830.573749542236, 59920.046630859375, 57785.640197753906, 57701.62690734863, 56038.41375923157, 58641.64004898071, 59955.433532714844, 57926.71351623535, 58326.653579711914, 58323.0602722168, 59829.85363769531, 58164.87359571457, 59827.09353637695, 58201.24002075195, 54414.82684326172, 61744.26675415039, 54666.42001724243, 60120.63346862793, 61803.526763916016, 59470.93354225159, 59182.33349609375, 59174.42671966553, 60518.85366821289, 58940.54673576355, 59572.88706970215, 59365.86678695679, 59845.20039367676, 57432.44004821777, 61424.553771972656, 60398.43344116211, 58151.6600189209, 57457.1667175293, 59975.55367279053, 54871.61359786987, 56153.613489151, 57295.333641052246, 57629.80004119873, 56370.920320510864, 57846.18702507019, 59446.653564453125, 61302.66033935547, 60033.807357788086, 60541.70669555664, 61470.580505371094, 59487.020416259766, 57408.479988098145, 59017.486501693726, 60598.020111083984, 61297.559997558594, 60184.30027770996, 56163.253690719604, 60153.64712524414, 59561.220123291016, 59228.42678833008, 59514.56716156006, 58240.5803527832, 59720.706939697266, 60657.5735168457, 59245.726654052734, 59086.79339790344, 58241.23368835449, 59706.22006225586, 54971.707136154175, 57706.64665412903, 60741.76022338867], "episode_lengths": [137, 135, 137, 137, 136, 136, 136, 136, 136, 137, 137, 135, 136, 136, 136, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 137, 135, 137, 138, 137, 137, 137, 137, 136, 136, 137, 137, 136, 137, 137, 136, 136, 137, 135, 136, 136, 136, 135, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 138, 137, 137, 137, 138, 137, 136, 136, 137, 137, 137, 137, 136, 137, 135, 136, 137], "policy_agent_0_reward": [61146.42010498047, 55715.266969680786, 58863.606941223145, 59327.5266418457, 58962.96680879593, 60304.52697753906, 57026.00665187836, 52521.20687389374, 58479.739990234375, 59064.94659423828, 59138.653633117676, 56050.4668636322, 58167.659954071045, 54118.353611946106, 59567.30687904358, 59666.03356933594, 59153.920166015625, 59344.34711456299, 55387.20010662079, 60211.2869720459, 60619.94041442871, 58830.573749542236, 59920.046630859375, 57785.640197753906, 57701.62690734863, 56038.41375923157, 58641.64004898071, 59955.433532714844, 57926.71351623535, 58326.653579711914, 58323.0602722168, 59829.85363769531, 58164.87359571457, 59827.09353637695, 58201.24002075195, 54414.82684326172, 61744.26675415039, 54666.42001724243, 60120.63346862793, 61803.526763916016, 59470.93354225159, 59182.33349609375, 59174.42671966553, 60518.85366821289, 58940.54673576355, 59572.88706970215, 59365.86678695679, 59845.20039367676, 57432.44004821777, 61424.553771972656, 60398.43344116211, 58151.6600189209, 57457.1667175293, 59975.55367279053, 54871.61359786987, 56153.613489151, 57295.333641052246, 57629.80004119873, 56370.920320510864, 57846.18702507019, 59446.653564453125, 61302.66033935547, 60033.807357788086, 60541.70669555664, 61470.580505371094, 59487.020416259766, 57408.479988098145, 59017.486501693726, 60598.020111083984, 61297.559997558594, 60184.30027770996, 56163.253690719604, 60153.64712524414, 59561.220123291016, 59228.42678833008, 59514.56716156006, 58240.5803527832, 59720.706939697266, 60657.5735168457, 59245.726654052734, 59086.79339790344, 58241.23368835449, 59706.22006225586, 54971.707136154175, 57706.64665412903, 60741.76022338867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.372488316979048, "mean_inference_ms": 6.780635441000508, "mean_action_processing_ms": 0.1987720632574207, "mean_env_wait_ms": 233.83293178834407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07989600647327512, "StateBufferConnector_ms": 0.005954365397608558, "ViewRequirementAgentConnector_ms": 0.192134324894395}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.09555995968634, "num_env_steps_trained_throughput_per_sec": 251.09555995968634, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 14370.084, "sample_time_ms": 11432.882, "learn_time_ms": 2774.68, "learn_throughput": 1441.607, "synch_weights_time_ms": 161.787}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 1860, "training_iteration": 64, "trial_id": "32397_00000", "date": "2025-03-21_08-52-45", "timestamp": 1742547165, "time_this_iter_s": 15.990642786026001, "time_total_s": 939.0118713378906, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ceea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 939.0118713378906, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 97.13181818181819, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99050521850586, "policy_loss": -0.009530567564070225, "vf_loss": 10.0, "vf_explained_var": 2.5729337949087494e-07, "kl": 0.005724094808101654, "entropy": 0.26011794805526733, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 60741.76022338867, "episode_reward_min": 60741.76022338867, "episode_reward_mean": 60741.76022338867, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60741.76022338867}, "policy_reward_max": {"agent_0": 60741.76022338867}, "policy_reward_mean": {"agent_0": 60741.76022338867}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60741.76022338867], "episode_lengths": [137], "policy_agent_0_reward": [60741.76022338867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.47404262622779, "mean_inference_ms": 6.578861765305318, "mean_action_processing_ms": 0.19993521400403255, "mean_env_wait_ms": 237.53657708696298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03466606140136719, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.1524209976196289}}, "episode_reward_max": 60741.76022338867, "episode_reward_min": 60741.76022338867, "episode_reward_mean": 60741.76022338867, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60741.76022338867}, "policy_reward_max": {"agent_0": 60741.76022338867}, "policy_reward_mean": {"agent_0": 60741.76022338867}, "hist_stats": {"episode_reward": [60741.76022338867], "episode_lengths": [137], "policy_agent_0_reward": [60741.76022338867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.47404262622779, "mean_inference_ms": 6.578861765305318, "mean_action_processing_ms": 0.19993521400403255, "mean_env_wait_ms": 237.53657708696298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03466606140136719, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.1524209976196289}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.4334316364624, "num_env_steps_trained_throughput_per_sec": 301.4334316364624, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 14054.962, "sample_time_ms": 11153.136, "learn_time_ms": 2748.83, "learn_throughput": 1455.164, "synch_weights_time_ms": 152.263}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 1860, "training_iteration": 65, "trial_id": "32397_00000", "date": "2025-03-21_08-52-59", "timestamp": 1742547179, "time_this_iter_s": 13.326109886169434, "time_total_s": 952.3379812240601, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba48e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 952.3379812240601, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 99.54444444444442, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.911274909973145, "policy_loss": -0.01015798095613718, "vf_loss": 9.92138671875, "vf_explained_var": -9.505698983502953e-08, "kl": 0.007399141788482666, "entropy": 0.26861169934272766, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 60933.66720581055, "episode_reward_min": 52612.473486185074, "episode_reward_mean": 58675.46202547103, "episode_len_mean": 136.53125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52612.473486185074}, "policy_reward_max": {"agent_0": 60933.66720581055}, "policy_reward_mean": {"agent_0": 58675.46202547103}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52612.473486185074, 59744.9334564209, 56190.58024406433, 59674.22685241699, 57581.70010757446, 59654.613342285156, 58001.540058135986, 56637.88671875, 60488.48698425293, 60270.77365112305, 58273.94664001465, 58366.94021606445, 58658.399841308594, 59942.46014404297, 60820.38009643555, 52905.606974601746, 60453.219970703125, 60933.66720581055, 60364.96667480469, 60074.16049194336, 60871.92028808594, 56820.159962654114, 58855.9602355957, 58993.35372924805, 59801.10688209534, 60142.25994873047, 59417.34020996094, 59765.88691711426, 59593.27992248535, 59107.6801776886, 57974.50003051758, 54620.37335395813], "episode_lengths": [135, 136, 136, 137, 136, 137, 135, 136, 137, 137, 136, 137, 136, 137, 137, 136, 137, 137, 137, 137, 137, 137, 136, 137, 137, 137, 137, 137, 137, 137, 137, 134], "policy_agent_0_reward": [52612.473486185074, 59744.9334564209, 56190.58024406433, 59674.22685241699, 57581.70010757446, 59654.613342285156, 58001.540058135986, 56637.88671875, 60488.48698425293, 60270.77365112305, 58273.94664001465, 58366.94021606445, 58658.399841308594, 59942.46014404297, 60820.38009643555, 52905.606974601746, 60453.219970703125, 60933.66720581055, 60364.96667480469, 60074.16049194336, 60871.92028808594, 56820.159962654114, 58855.9602355957, 58993.35372924805, 59801.10688209534, 60142.25994873047, 59417.34020996094, 59765.88691711426, 59593.27992248535, 59107.6801776886, 57974.50003051758, 54620.37335395813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.65805076464101, "mean_inference_ms": 6.327028286708719, "mean_action_processing_ms": 0.20176228674358598, "mean_env_wait_ms": 217.40114619804118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056722015142440796, "StateBufferConnector_ms": 0.006384402513504028, "ViewRequirementAgentConnector_ms": 0.28543993830680847}}, "episode_reward_max": 60933.66720581055, "episode_reward_min": 52612.473486185074, "episode_reward_mean": 58675.46202547103, "episode_len_mean": 136.53125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 52612.473486185074}, "policy_reward_max": {"agent_0": 60933.66720581055}, "policy_reward_mean": {"agent_0": 58675.46202547103}, "hist_stats": {"episode_reward": [52612.473486185074, 59744.9334564209, 56190.58024406433, 59674.22685241699, 57581.70010757446, 59654.613342285156, 58001.540058135986, 56637.88671875, 60488.48698425293, 60270.77365112305, 58273.94664001465, 58366.94021606445, 58658.399841308594, 59942.46014404297, 60820.38009643555, 52905.606974601746, 60453.219970703125, 60933.66720581055, 60364.96667480469, 60074.16049194336, 60871.92028808594, 56820.159962654114, 58855.9602355957, 58993.35372924805, 59801.10688209534, 60142.25994873047, 59417.34020996094, 59765.88691711426, 59593.27992248535, 59107.6801776886, 57974.50003051758, 54620.37335395813], "episode_lengths": [135, 136, 136, 137, 136, 137, 135, 136, 137, 137, 136, 137, 136, 137, 137, 136, 137, 137, 137, 137, 137, 137, 136, 137, 137, 137, 137, 137, 137, 137, 137, 134], "policy_agent_0_reward": [52612.473486185074, 59744.9334564209, 56190.58024406433, 59674.22685241699, 57581.70010757446, 59654.613342285156, 58001.540058135986, 56637.88671875, 60488.48698425293, 60270.77365112305, 58273.94664001465, 58366.94021606445, 58658.399841308594, 59942.46014404297, 60820.38009643555, 52905.606974601746, 60453.219970703125, 60933.66720581055, 60364.96667480469, 60074.16049194336, 60871.92028808594, 56820.159962654114, 58855.9602355957, 58993.35372924805, 59801.10688209534, 60142.25994873047, 59417.34020996094, 59765.88691711426, 59593.27992248535, 59107.6801776886, 57974.50003051758, 54620.37335395813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.65805076464101, "mean_inference_ms": 6.327028286708719, "mean_action_processing_ms": 0.20176228674358598, "mean_env_wait_ms": 217.40114619804118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056722015142440796, "StateBufferConnector_ms": 0.006384402513504028, "ViewRequirementAgentConnector_ms": 0.28543993830680847}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.98372500049393, "num_env_steps_trained_throughput_per_sec": 238.98372500049393, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 14446.645, "sample_time_ms": 11510.292, "learn_time_ms": 2781.104, "learn_throughput": 1438.278, "synch_weights_time_ms": 154.524}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 1892, "training_iteration": 66, "trial_id": "32397_00000", "date": "2025-03-21_08-53-16", "timestamp": 1742547196, "time_this_iter_s": 16.79823064804077, "time_total_s": 969.1362118721008, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 969.1362118721008, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 99.2695652173913, "ram_util_percent": 13.399999999999997}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98597526550293, "policy_loss": -0.011632736772298813, "vf_loss": 9.99755859375, "vf_explained_var": -1.7794469897580711e-07, "kl": 0.007753678131848574, "entropy": 0.30240824818611145, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 54620.37335395813, "episode_reward_min": 54620.37335395813, "episode_reward_mean": 54620.37335395813, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54620.37335395813}, "policy_reward_max": {"agent_0": 54620.37335395813}, "policy_reward_mean": {"agent_0": 54620.37335395813}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54620.37335395813], "episode_lengths": [134], "policy_agent_0_reward": [54620.37335395813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.56922290936803, "mean_inference_ms": 6.109205283610959, "mean_action_processing_ms": 0.196279545014142, "mean_env_wait_ms": 222.93996055939152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04413127899169922, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.18513202667236328}}, "episode_reward_max": 54620.37335395813, "episode_reward_min": 54620.37335395813, "episode_reward_mean": 54620.37335395813, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54620.37335395813}, "policy_reward_max": {"agent_0": 54620.37335395813}, "policy_reward_mean": {"agent_0": 54620.37335395813}, "hist_stats": {"episode_reward": [54620.37335395813], "episode_lengths": [134], "policy_agent_0_reward": [54620.37335395813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.56922290936803, "mean_inference_ms": 6.109205283610959, "mean_action_processing_ms": 0.196279545014142, "mean_env_wait_ms": 222.93996055939152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04413127899169922, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 0.18513202667236328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.74537107578305, "num_env_steps_trained_throughput_per_sec": 287.74537107578305, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 14544.385, "sample_time_ms": 11515.013, "learn_time_ms": 2870.215, "learn_throughput": 1393.624, "synch_weights_time_ms": 158.437}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 1892, "training_iteration": 67, "trial_id": "32397_00000", "date": "2025-03-21_08-53-30", "timestamp": 1742547210, "time_this_iter_s": 13.948258399963379, "time_total_s": 983.0844702720642, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 983.0844702720642, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 99.51500000000001, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.021739130434782, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.762775421142578, "policy_loss": -0.007765380199998617, "vf_loss": 9.7705078125, "vf_explained_var": 6.206333864611224e-07, "kl": 0.005262032151222229, "entropy": 0.24033528566360474, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 61817.1067199707, "episode_reward_min": 52631.399909973145, "episode_reward_mean": 58299.416691783976, "episode_len_mean": 136.5326086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 52631.399909973145}, "policy_reward_max": {"agent_0": 61817.1067199707}, "policy_reward_mean": {"agent_0": 58299.416691783976}, "custom_metrics": {"num_batches_mean": 5.021739130434782, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59195.37350463867, 58760.88700962067, 55891.08675289154, 56011.1533164978, 58989.646797180176, 58115.52001571655, 53304.8934135437, 56889.053451538086, 59603.40031814575, 56992.58011865616, 60263.32693481445, 59701.20034790039, 59693.33337402344, 61817.1067199707, 55437.9935131073, 55859.00681638718, 59382.54672241211, 59137.4133605957, 60358.39367675781, 60132.267013549805, 59896.60037231445, 60660.16012573242, 57947.84690093994, 59570.26664352417, 55210.34725379944, 60881.340087890625, 56372.5602722168, 53986.77350139618, 54155.80690860748, 61180.5598449707, 60655.246894836426, 54814.16678619385, 61060.646881103516, 60487.799896240234, 59662.45330810547, 61228.00018310547, 59378.72032165527, 58889.16014099121, 54280.89353466034, 58271.640197753906, 55258.713428497314, 56288.11992454529, 56682.84686899185, 59493.353515625, 54140.94696998596, 59834.70031738281, 53796.453541755676, 57649.10012817383, 57881.19342803955, 56891.71349334717, 59844.44021606445, 56886.28712964058, 52631.399909973145, 56675.42701435089, 58635.173652648926, 57968.38687133789, 60221.940368652344, 55255.64035606384, 53573.119950413704, 60343.16064453125, 59907.720165252686, 58922.03356933594, 60091.880043029785, 58433.83359527588, 59151.74005126953, 56736.313475608826, 54848.4335064888, 56449.3134765625, 58052.10035228729, 56510.43383216858, 58104.000180244446, 60281.86018371582, 60362.900022506714, 59825.200134277344, 58265.873324394226, 58158.42029571533, 56976.50666809082, 60716.80031585693, 58376.40693092346, 60960.68681335449, 59084.73342895508, 61153.96008300781, 59602.4469909668, 61422.453353881836, 59262.56661224365, 56816.05350494385, 59665.7802734375, 59695.16668701172, 60257.32655906677, 60788.79995727539, 59954.01345825195, 60631.2868347168], "episode_lengths": [137, 136, 136, 137, 137, 136, 136, 137, 137, 136, 137, 137, 136, 138, 135, 136, 137, 137, 137, 136, 137, 137, 136, 137, 136, 137, 135, 136, 136, 137, 137, 135, 137, 137, 137, 138, 136, 136, 135, 137, 136, 136, 136, 137, 136, 137, 136, 137, 136, 136, 137, 137, 136, 136, 136, 137, 137, 136, 135, 137, 137, 136, 137, 136, 138, 136, 135, 136, 137, 136, 137, 137, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 137, 137, 137, 136, 137, 137, 137, 137, 136, 137], "policy_agent_0_reward": [59195.37350463867, 58760.88700962067, 55891.08675289154, 56011.1533164978, 58989.646797180176, 58115.52001571655, 53304.8934135437, 56889.053451538086, 59603.40031814575, 56992.58011865616, 60263.32693481445, 59701.20034790039, 59693.33337402344, 61817.1067199707, 55437.9935131073, 55859.00681638718, 59382.54672241211, 59137.4133605957, 60358.39367675781, 60132.267013549805, 59896.60037231445, 60660.16012573242, 57947.84690093994, 59570.26664352417, 55210.34725379944, 60881.340087890625, 56372.5602722168, 53986.77350139618, 54155.80690860748, 61180.5598449707, 60655.246894836426, 54814.16678619385, 61060.646881103516, 60487.799896240234, 59662.45330810547, 61228.00018310547, 59378.72032165527, 58889.16014099121, 54280.89353466034, 58271.640197753906, 55258.713428497314, 56288.11992454529, 56682.84686899185, 59493.353515625, 54140.94696998596, 59834.70031738281, 53796.453541755676, 57649.10012817383, 57881.19342803955, 56891.71349334717, 59844.44021606445, 56886.28712964058, 52631.399909973145, 56675.42701435089, 58635.173652648926, 57968.38687133789, 60221.940368652344, 55255.64035606384, 53573.119950413704, 60343.16064453125, 59907.720165252686, 58922.03356933594, 60091.880043029785, 58433.83359527588, 59151.74005126953, 56736.313475608826, 54848.4335064888, 56449.3134765625, 58052.10035228729, 56510.43383216858, 58104.000180244446, 60281.86018371582, 60362.900022506714, 59825.200134277344, 58265.873324394226, 58158.42029571533, 56976.50666809082, 60716.80031585693, 58376.40693092346, 60960.68681335449, 59084.73342895508, 61153.96008300781, 59602.4469909668, 61422.453353881836, 59262.56661224365, 56816.05350494385, 59665.7802734375, 59695.16668701172, 60257.32655906677, 60788.79995727539, 59954.01345825195, 60631.2868347168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.357422990759535, "mean_inference_ms": 6.763199604863933, "mean_action_processing_ms": 0.19909023431493514, "mean_env_wait_ms": 233.59364615666428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06404778231745181, "StateBufferConnector_ms": 0.006192145140274712, "ViewRequirementAgentConnector_ms": 0.24656264678291653}}, "episode_reward_max": 61817.1067199707, "episode_reward_min": 52631.399909973145, "episode_reward_mean": 58299.416691783976, "episode_len_mean": 136.5326086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 52631.399909973145}, "policy_reward_max": {"agent_0": 61817.1067199707}, "policy_reward_mean": {"agent_0": 58299.416691783976}, "hist_stats": {"episode_reward": [59195.37350463867, 58760.88700962067, 55891.08675289154, 56011.1533164978, 58989.646797180176, 58115.52001571655, 53304.8934135437, 56889.053451538086, 59603.40031814575, 56992.58011865616, 60263.32693481445, 59701.20034790039, 59693.33337402344, 61817.1067199707, 55437.9935131073, 55859.00681638718, 59382.54672241211, 59137.4133605957, 60358.39367675781, 60132.267013549805, 59896.60037231445, 60660.16012573242, 57947.84690093994, 59570.26664352417, 55210.34725379944, 60881.340087890625, 56372.5602722168, 53986.77350139618, 54155.80690860748, 61180.5598449707, 60655.246894836426, 54814.16678619385, 61060.646881103516, 60487.799896240234, 59662.45330810547, 61228.00018310547, 59378.72032165527, 58889.16014099121, 54280.89353466034, 58271.640197753906, 55258.713428497314, 56288.11992454529, 56682.84686899185, 59493.353515625, 54140.94696998596, 59834.70031738281, 53796.453541755676, 57649.10012817383, 57881.19342803955, 56891.71349334717, 59844.44021606445, 56886.28712964058, 52631.399909973145, 56675.42701435089, 58635.173652648926, 57968.38687133789, 60221.940368652344, 55255.64035606384, 53573.119950413704, 60343.16064453125, 59907.720165252686, 58922.03356933594, 60091.880043029785, 58433.83359527588, 59151.74005126953, 56736.313475608826, 54848.4335064888, 56449.3134765625, 58052.10035228729, 56510.43383216858, 58104.000180244446, 60281.86018371582, 60362.900022506714, 59825.200134277344, 58265.873324394226, 58158.42029571533, 56976.50666809082, 60716.80031585693, 58376.40693092346, 60960.68681335449, 59084.73342895508, 61153.96008300781, 59602.4469909668, 61422.453353881836, 59262.56661224365, 56816.05350494385, 59665.7802734375, 59695.16668701172, 60257.32655906677, 60788.79995727539, 59954.01345825195, 60631.2868347168], "episode_lengths": [137, 136, 136, 137, 137, 136, 136, 137, 137, 136, 137, 137, 136, 138, 135, 136, 137, 137, 137, 136, 137, 137, 136, 137, 136, 137, 135, 136, 136, 137, 137, 135, 137, 137, 137, 138, 136, 136, 135, 137, 136, 136, 136, 137, 136, 137, 136, 137, 136, 136, 137, 137, 136, 136, 136, 137, 137, 136, 135, 137, 137, 136, 137, 136, 138, 136, 135, 136, 137, 136, 137, 137, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 137, 137, 137, 136, 137, 137, 137, 137, 136, 137], "policy_agent_0_reward": [59195.37350463867, 58760.88700962067, 55891.08675289154, 56011.1533164978, 58989.646797180176, 58115.52001571655, 53304.8934135437, 56889.053451538086, 59603.40031814575, 56992.58011865616, 60263.32693481445, 59701.20034790039, 59693.33337402344, 61817.1067199707, 55437.9935131073, 55859.00681638718, 59382.54672241211, 59137.4133605957, 60358.39367675781, 60132.267013549805, 59896.60037231445, 60660.16012573242, 57947.84690093994, 59570.26664352417, 55210.34725379944, 60881.340087890625, 56372.5602722168, 53986.77350139618, 54155.80690860748, 61180.5598449707, 60655.246894836426, 54814.16678619385, 61060.646881103516, 60487.799896240234, 59662.45330810547, 61228.00018310547, 59378.72032165527, 58889.16014099121, 54280.89353466034, 58271.640197753906, 55258.713428497314, 56288.11992454529, 56682.84686899185, 59493.353515625, 54140.94696998596, 59834.70031738281, 53796.453541755676, 57649.10012817383, 57881.19342803955, 56891.71349334717, 59844.44021606445, 56886.28712964058, 52631.399909973145, 56675.42701435089, 58635.173652648926, 57968.38687133789, 60221.940368652344, 55255.64035606384, 53573.119950413704, 60343.16064453125, 59907.720165252686, 58922.03356933594, 60091.880043029785, 58433.83359527588, 59151.74005126953, 56736.313475608826, 54848.4335064888, 56449.3134765625, 58052.10035228729, 56510.43383216858, 58104.000180244446, 60281.86018371582, 60362.900022506714, 59825.200134277344, 58265.873324394226, 58158.42029571533, 56976.50666809082, 60716.80031585693, 58376.40693092346, 60960.68681335449, 59084.73342895508, 61153.96008300781, 59602.4469909668, 61422.453353881836, 59262.56661224365, 56816.05350494385, 59665.7802734375, 59695.16668701172, 60257.32655906677, 60788.79995727539, 59954.01345825195, 60631.2868347168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.357422990759535, "mean_inference_ms": 6.763199604863933, "mean_action_processing_ms": 0.19909023431493514, "mean_env_wait_ms": 233.59364615666428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06404778231745181, "StateBufferConnector_ms": 0.006192145140274712, "ViewRequirementAgentConnector_ms": 0.24656264678291653}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.50193715028612, "num_env_steps_trained_throughput_per_sec": 240.50193715028612, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 14607.649, "sample_time_ms": 11650.843, "learn_time_ms": 2798.94, "learn_throughput": 1429.112, "synch_weights_time_ms": 157.154}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 1984, "training_iteration": 68, "trial_id": "32397_00000", "date": "2025-03-21_08-53-46", "timestamp": 1742547226, "time_this_iter_s": 16.680426597595215, "time_total_s": 999.7648968696594, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba4b490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 999.7648968696594, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 96.54347826086959, "ram_util_percent": 13.395652173913042}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988720893859863, "policy_loss": -0.011319980956614017, "vf_loss": 10.0, "vf_explained_var": -1.7639248994782974e-07, "kl": 0.006573115009814501, "entropy": 0.25794127583503723, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 60631.2868347168, "episode_reward_min": 60631.2868347168, "episode_reward_mean": 60631.2868347168, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60631.2868347168}, "policy_reward_max": {"agent_0": 60631.2868347168}, "policy_reward_mean": {"agent_0": 60631.2868347168}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60631.2868347168], "episode_lengths": [137], "policy_agent_0_reward": [60631.2868347168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.244071358543614, "mean_inference_ms": 6.643024452465305, "mean_action_processing_ms": 0.19957398295019219, "mean_env_wait_ms": 237.638857148906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055909156799316406, "StateBufferConnector_ms": 0.008845329284667969, "ViewRequirementAgentConnector_ms": 0.23398399353027344}}, "episode_reward_max": 60631.2868347168, "episode_reward_min": 60631.2868347168, "episode_reward_mean": 60631.2868347168, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60631.2868347168}, "policy_reward_max": {"agent_0": 60631.2868347168}, "policy_reward_mean": {"agent_0": 60631.2868347168}, "hist_stats": {"episode_reward": [60631.2868347168], "episode_lengths": [137], "policy_agent_0_reward": [60631.2868347168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.244071358543614, "mean_inference_ms": 6.643024452465305, "mean_action_processing_ms": 0.19957398295019219, "mean_env_wait_ms": 237.638857148906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055909156799316406, "StateBufferConnector_ms": 0.008845329284667969, "ViewRequirementAgentConnector_ms": 0.23398399353027344}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.86546442276557, "num_env_steps_trained_throughput_per_sec": 304.86546442276557, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 14425.548, "sample_time_ms": 11479.076, "learn_time_ms": 2784.597, "learn_throughput": 1436.473, "synch_weights_time_ms": 161.118}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1984, "training_iteration": 69, "trial_id": "32397_00000", "date": "2025-03-21_08-54-00", "timestamp": 1742547240, "time_this_iter_s": 13.178550004959106, "time_total_s": 1012.9434468746185, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19c72f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1012.9434468746185, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 99.44736842105263, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906567573547363, "policy_loss": -0.011468482203781605, "vf_loss": 9.91796875, "vf_explained_var": -2.9367704712512932e-08, "kl": 0.010548471473157406, "entropy": 0.291251003742218, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 61045.420318603516, "episode_reward_min": 48966.860125899315, "episode_reward_mean": 58399.661491395906, "episode_len_mean": 136.375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48966.860125899315}, "policy_reward_max": {"agent_0": 61045.420318603516}, "policy_reward_mean": {"agent_0": 58399.661491395906}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [48966.860125899315, 57631.87355041504, 56415.00012588501, 55484.33333683014, 59698.280265808105, 60713.93356323242, 57446.21350097656, 59044.78024291992, 60619.48684692383, 61045.420318603516, 57399.3932813406, 60750.12023925781, 59153.36016845703, 59546.54693222046, 56494.67346858978, 60633.94705200195, 59206.98684692383, 59327.246978759766, 58045.780418395996, 59483.96022796631, 57016.767081320286, 59634.16696166992, 55293.92679333687, 53085.45360946655, 59989.220275878906, 60516.660079956055, 59633.826986312866, 60762.84706115723, 60760.11376953125, 55463.89346790314, 60784.16702270508, 58739.92712402344], "episode_lengths": [135, 136, 135, 136, 137, 137, 136, 136, 137, 137, 136, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 136, 136, 137, 136], "policy_agent_0_reward": [48966.860125899315, 57631.87355041504, 56415.00012588501, 55484.33333683014, 59698.280265808105, 60713.93356323242, 57446.21350097656, 59044.78024291992, 60619.48684692383, 61045.420318603516, 57399.3932813406, 60750.12023925781, 59153.36016845703, 59546.54693222046, 56494.67346858978, 60633.94705200195, 59206.98684692383, 59327.246978759766, 58045.780418395996, 59483.96022796631, 57016.767081320286, 59634.16696166992, 55293.92679333687, 53085.45360946655, 59989.220275878906, 60516.660079956055, 59633.826986312866, 60762.84706115723, 60760.11376953125, 55463.89346790314, 60784.16702270508, 58739.92712402344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.71556849089705, "mean_inference_ms": 6.333114738100177, "mean_action_processing_ms": 0.20142394786580514, "mean_env_wait_ms": 216.95550869020326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05140379071235657, "StateBufferConnector_ms": 0.006585568189620972, "ViewRequirementAgentConnector_ms": 0.28808414936065674}}, "episode_reward_max": 61045.420318603516, "episode_reward_min": 48966.860125899315, "episode_reward_mean": 58399.661491395906, "episode_len_mean": 136.375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48966.860125899315}, "policy_reward_max": {"agent_0": 61045.420318603516}, "policy_reward_mean": {"agent_0": 58399.661491395906}, "hist_stats": {"episode_reward": [48966.860125899315, 57631.87355041504, 56415.00012588501, 55484.33333683014, 59698.280265808105, 60713.93356323242, 57446.21350097656, 59044.78024291992, 60619.48684692383, 61045.420318603516, 57399.3932813406, 60750.12023925781, 59153.36016845703, 59546.54693222046, 56494.67346858978, 60633.94705200195, 59206.98684692383, 59327.246978759766, 58045.780418395996, 59483.96022796631, 57016.767081320286, 59634.16696166992, 55293.92679333687, 53085.45360946655, 59989.220275878906, 60516.660079956055, 59633.826986312866, 60762.84706115723, 60760.11376953125, 55463.89346790314, 60784.16702270508, 58739.92712402344], "episode_lengths": [135, 136, 135, 136, 137, 137, 136, 136, 137, 137, 136, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 137, 136, 136, 137, 136], "policy_agent_0_reward": [48966.860125899315, 57631.87355041504, 56415.00012588501, 55484.33333683014, 59698.280265808105, 60713.93356323242, 57446.21350097656, 59044.78024291992, 60619.48684692383, 61045.420318603516, 57399.3932813406, 60750.12023925781, 59153.36016845703, 59546.54693222046, 56494.67346858978, 60633.94705200195, 59206.98684692383, 59327.246978759766, 58045.780418395996, 59483.96022796631, 57016.767081320286, 59634.16696166992, 55293.92679333687, 53085.45360946655, 59989.220275878906, 60516.660079956055, 59633.826986312866, 60762.84706115723, 60760.11376953125, 55463.89346790314, 60784.16702270508, 58739.92712402344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.71556849089705, "mean_inference_ms": 6.333114738100177, "mean_action_processing_ms": 0.20142394786580514, "mean_env_wait_ms": 216.95550869020326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05140379071235657, "StateBufferConnector_ms": 0.006585568189620972, "ViewRequirementAgentConnector_ms": 0.28808414936065674}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.99899417566616, "num_env_steps_trained_throughput_per_sec": 249.99899417566616, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 14724.016, "sample_time_ms": 11748.233, "learn_time_ms": 2815.126, "learn_throughput": 1420.895, "synch_weights_time_ms": 159.913}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 2016, "training_iteration": 70, "trial_id": "32397_00000", "date": "2025-03-21_08-54-16", "timestamp": 1742547256, "time_this_iter_s": 16.0549259185791, "time_total_s": 1028.9983727931976, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba4b490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1028.9983727931976, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 99.43181818181819, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.99029541015625, "policy_loss": -0.009746963158249855, "vf_loss": 10.0, "vf_explained_var": -1.3367584017487388e-07, "kl": 0.006796954665333033, "entropy": 0.2693224847316742, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 58739.92712402344, "episode_reward_min": 58739.92712402344, "episode_reward_mean": 58739.92712402344, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58739.92712402344}, "policy_reward_max": {"agent_0": 58739.92712402344}, "policy_reward_mean": {"agent_0": 58739.92712402344}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58739.92712402344], "episode_lengths": [136], "policy_agent_0_reward": [58739.92712402344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47485538253223, "mean_inference_ms": 6.246046089393553, "mean_action_processing_ms": 0.19595943865245785, "mean_env_wait_ms": 223.28229272381046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04124641418457031, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1658916473388672}}, "episode_reward_max": 58739.92712402344, "episode_reward_min": 58739.92712402344, "episode_reward_mean": 58739.92712402344, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58739.92712402344}, "policy_reward_max": {"agent_0": 58739.92712402344}, "policy_reward_mean": {"agent_0": 58739.92712402344}, "hist_stats": {"episode_reward": [58739.92712402344], "episode_lengths": [136], "policy_agent_0_reward": [58739.92712402344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47485538253223, "mean_inference_ms": 6.246046089393553, "mean_action_processing_ms": 0.19595943865245785, "mean_env_wait_ms": 223.28229272381046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04124641418457031, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1658916473388672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.560551861409, "num_env_steps_trained_throughput_per_sec": 315.560551861409, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 14709.538, "sample_time_ms": 11734.029, "learn_time_ms": 2813.325, "learn_throughput": 1421.805, "synch_weights_time_ms": 161.447}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 2016, "training_iteration": 71, "trial_id": "32397_00000", "date": "2025-03-21_08-54-28", "timestamp": 1742547268, "time_this_iter_s": 12.729534387588501, "time_total_s": 1041.7279071807861, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1041.7279071807861, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 99.6111111111111, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.761162757873535, "policy_loss": -0.009878216311335564, "vf_loss": 9.77099609375, "vf_explained_var": 4.944702141074231e-07, "kl": 0.006994945462793112, "entropy": 0.28285256028175354, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 61826.706939697266, "episode_reward_min": 49608.69332790375, "episode_reward_mean": 58289.858395272626, "episode_len_mean": 136.52173913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 49608.69332790375}, "policy_reward_max": {"agent_0": 61826.706939697266}, "policy_reward_mean": {"agent_0": 58289.858395272626}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60904.15350341797, 56147.90035247803, 61215.88023376465, 58634.08688354492, 56500.040256500244, 56192.35331726074, 56276.620346069336, 53425.98021316528, 49608.69332790375, 59453.49368286133, 61760.346771240234, 59800.92690658569, 55032.23343920708, 55831.880363464355, 58387.2467956543, 59761.74008178711, 55230.480209350586, 59968.64008331299, 59142.33364868164, 55561.540407180786, 60117.60678100586, 59817.58683013916, 55657.03343582153, 57615.660274505615, 53990.04048228264, 60922.573638916016, 55135.90689301491, 60745.69372558594, 60060.17329406738, 59490.293518066406, 60715.10678100586, 61622.25338745117, 60027.860290527344, 59609.54667663574, 60160.72674560547, 53245.64002275467, 58814.24012565613, 60711.97346496582, 58806.0735168457, 59814.81318664551, 58807.26022720337, 61255.19387817383, 57758.18028259277, 58275.54040527344, 55502.679874420166, 59874.5202331543, 52723.78023087978, 60626.56719970703, 50315.160161972046, 61694.57336425781, 58917.91342163086, 59082.2135925293, 57273.10706329346, 55573.89351940155, 60827.746978759766, 57019.52685838938, 55409.88724422455, 59875.46028137207, 59717.240367889404, 58775.113342285156, 60982.71368408203, 60124.61331176758, 58591.42687988281, 59434.133712768555, 60833.69351196289, 59605.760009765625, 58827.026916503906, 57521.139986515045, 58785.47366333008, 58238.3932800293, 53533.18025159836, 57934.58706665039, 57927.98693847656, 61695.91369628906, 59380.673583984375, 59478.72035217285, 61826.706939697266, 55070.79321861267, 59434.22010803223, 61154.660217285156, 57310.82709121704, 54889.660064697266, 58190.586879730225, 57994.780212402344, 57509.213150024414, 59857.78042602539, 58287.70031261444, 59166.67351722717, 52186.55344963074, 60314.940002441406, 60500.44714355469, 60853.06036376953], "episode_lengths": [137, 136, 138, 136, 137, 136, 136, 136, 135, 137, 138, 138, 136, 137, 138, 137, 136, 136, 137, 136, 138, 136, 136, 136, 135, 137, 136, 137, 137, 136, 137, 138, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 137, 136, 136, 136, 136, 137, 135, 137, 135, 136, 136, 136, 137, 135, 136, 137, 137, 136, 137, 137, 136, 136, 137, 137, 137, 137, 136, 136, 136, 136, 137, 138, 136, 137, 139, 136, 136, 137, 136, 136, 136, 137, 136, 137, 136, 137, 135, 137, 136, 137], "policy_agent_0_reward": [60904.15350341797, 56147.90035247803, 61215.88023376465, 58634.08688354492, 56500.040256500244, 56192.35331726074, 56276.620346069336, 53425.98021316528, 49608.69332790375, 59453.49368286133, 61760.346771240234, 59800.92690658569, 55032.23343920708, 55831.880363464355, 58387.2467956543, 59761.74008178711, 55230.480209350586, 59968.64008331299, 59142.33364868164, 55561.540407180786, 60117.60678100586, 59817.58683013916, 55657.03343582153, 57615.660274505615, 53990.04048228264, 60922.573638916016, 55135.90689301491, 60745.69372558594, 60060.17329406738, 59490.293518066406, 60715.10678100586, 61622.25338745117, 60027.860290527344, 59609.54667663574, 60160.72674560547, 53245.64002275467, 58814.24012565613, 60711.97346496582, 58806.0735168457, 59814.81318664551, 58807.26022720337, 61255.19387817383, 57758.18028259277, 58275.54040527344, 55502.679874420166, 59874.5202331543, 52723.78023087978, 60626.56719970703, 50315.160161972046, 61694.57336425781, 58917.91342163086, 59082.2135925293, 57273.10706329346, 55573.89351940155, 60827.746978759766, 57019.52685838938, 55409.88724422455, 59875.46028137207, 59717.240367889404, 58775.113342285156, 60982.71368408203, 60124.61331176758, 58591.42687988281, 59434.133712768555, 60833.69351196289, 59605.760009765625, 58827.026916503906, 57521.139986515045, 58785.47366333008, 58238.3932800293, 53533.18025159836, 57934.58706665039, 57927.98693847656, 61695.91369628906, 59380.673583984375, 59478.72035217285, 61826.706939697266, 55070.79321861267, 59434.22010803223, 61154.660217285156, 57310.82709121704, 54889.660064697266, 58190.586879730225, 57994.780212402344, 57509.213150024414, 59857.78042602539, 58287.70031261444, 59166.67351722717, 52186.55344963074, 60314.940002441406, 60500.44714355469, 60853.06036376953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.272456795317286, "mean_inference_ms": 6.754817623558287, "mean_action_processing_ms": 0.19901756361994014, "mean_env_wait_ms": 233.60476817295907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05753843680672024, "StateBufferConnector_ms": 0.006198105604752251, "ViewRequirementAgentConnector_ms": 0.19755207973977792}}, "episode_reward_max": 61826.706939697266, "episode_reward_min": 49608.69332790375, "episode_reward_mean": 58289.858395272626, "episode_len_mean": 136.52173913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 49608.69332790375}, "policy_reward_max": {"agent_0": 61826.706939697266}, "policy_reward_mean": {"agent_0": 58289.858395272626}, "hist_stats": {"episode_reward": [60904.15350341797, 56147.90035247803, 61215.88023376465, 58634.08688354492, 56500.040256500244, 56192.35331726074, 56276.620346069336, 53425.98021316528, 49608.69332790375, 59453.49368286133, 61760.346771240234, 59800.92690658569, 55032.23343920708, 55831.880363464355, 58387.2467956543, 59761.74008178711, 55230.480209350586, 59968.64008331299, 59142.33364868164, 55561.540407180786, 60117.60678100586, 59817.58683013916, 55657.03343582153, 57615.660274505615, 53990.04048228264, 60922.573638916016, 55135.90689301491, 60745.69372558594, 60060.17329406738, 59490.293518066406, 60715.10678100586, 61622.25338745117, 60027.860290527344, 59609.54667663574, 60160.72674560547, 53245.64002275467, 58814.24012565613, 60711.97346496582, 58806.0735168457, 59814.81318664551, 58807.26022720337, 61255.19387817383, 57758.18028259277, 58275.54040527344, 55502.679874420166, 59874.5202331543, 52723.78023087978, 60626.56719970703, 50315.160161972046, 61694.57336425781, 58917.91342163086, 59082.2135925293, 57273.10706329346, 55573.89351940155, 60827.746978759766, 57019.52685838938, 55409.88724422455, 59875.46028137207, 59717.240367889404, 58775.113342285156, 60982.71368408203, 60124.61331176758, 58591.42687988281, 59434.133712768555, 60833.69351196289, 59605.760009765625, 58827.026916503906, 57521.139986515045, 58785.47366333008, 58238.3932800293, 53533.18025159836, 57934.58706665039, 57927.98693847656, 61695.91369628906, 59380.673583984375, 59478.72035217285, 61826.706939697266, 55070.79321861267, 59434.22010803223, 61154.660217285156, 57310.82709121704, 54889.660064697266, 58190.586879730225, 57994.780212402344, 57509.213150024414, 59857.78042602539, 58287.70031261444, 59166.67351722717, 52186.55344963074, 60314.940002441406, 60500.44714355469, 60853.06036376953], "episode_lengths": [137, 136, 138, 136, 137, 136, 136, 136, 135, 137, 138, 138, 136, 137, 138, 137, 136, 136, 137, 136, 138, 136, 136, 136, 135, 137, 136, 137, 137, 136, 137, 138, 137, 137, 137, 136, 137, 137, 137, 136, 136, 137, 137, 136, 136, 136, 136, 137, 135, 137, 135, 136, 136, 136, 137, 135, 136, 137, 137, 136, 137, 137, 136, 136, 137, 137, 137, 137, 136, 136, 136, 136, 137, 138, 136, 137, 139, 136, 136, 137, 136, 136, 136, 137, 136, 137, 136, 137, 135, 137, 136, 137], "policy_agent_0_reward": [60904.15350341797, 56147.90035247803, 61215.88023376465, 58634.08688354492, 56500.040256500244, 56192.35331726074, 56276.620346069336, 53425.98021316528, 49608.69332790375, 59453.49368286133, 61760.346771240234, 59800.92690658569, 55032.23343920708, 55831.880363464355, 58387.2467956543, 59761.74008178711, 55230.480209350586, 59968.64008331299, 59142.33364868164, 55561.540407180786, 60117.60678100586, 59817.58683013916, 55657.03343582153, 57615.660274505615, 53990.04048228264, 60922.573638916016, 55135.90689301491, 60745.69372558594, 60060.17329406738, 59490.293518066406, 60715.10678100586, 61622.25338745117, 60027.860290527344, 59609.54667663574, 60160.72674560547, 53245.64002275467, 58814.24012565613, 60711.97346496582, 58806.0735168457, 59814.81318664551, 58807.26022720337, 61255.19387817383, 57758.18028259277, 58275.54040527344, 55502.679874420166, 59874.5202331543, 52723.78023087978, 60626.56719970703, 50315.160161972046, 61694.57336425781, 58917.91342163086, 59082.2135925293, 57273.10706329346, 55573.89351940155, 60827.746978759766, 57019.52685838938, 55409.88724422455, 59875.46028137207, 59717.240367889404, 58775.113342285156, 60982.71368408203, 60124.61331176758, 58591.42687988281, 59434.133712768555, 60833.69351196289, 59605.760009765625, 58827.026916503906, 57521.139986515045, 58785.47366333008, 58238.3932800293, 53533.18025159836, 57934.58706665039, 57927.98693847656, 61695.91369628906, 59380.673583984375, 59478.72035217285, 61826.706939697266, 55070.79321861267, 59434.22010803223, 61154.660217285156, 57310.82709121704, 54889.660064697266, 58190.586879730225, 57994.780212402344, 57509.213150024414, 59857.78042602539, 58287.70031261444, 59166.67351722717, 52186.55344963074, 60314.940002441406, 60500.44714355469, 60853.06036376953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.272456795317286, "mean_inference_ms": 6.754817623558287, "mean_action_processing_ms": 0.19901756361994014, "mean_env_wait_ms": 233.60476817295907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05753843680672024, "StateBufferConnector_ms": 0.006198105604752251, "ViewRequirementAgentConnector_ms": 0.19755207973977792}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.44301532628145, "num_env_steps_trained_throughput_per_sec": 256.44301532628145, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 14616.466, "sample_time_ms": 11617.541, "learn_time_ms": 2855.105, "learn_throughput": 1400.999, "synch_weights_time_ms": 143.08}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 2108, "training_iteration": 72, "trial_id": "32397_00000", "date": "2025-03-21_08-54-44", "timestamp": 1742547284, "time_this_iter_s": 15.652721643447876, "time_total_s": 1057.380628824234, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f13370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1057.380628824234, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 96.23333333333332, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.972947120666504, "policy_loss": -0.010014605708420277, "vf_loss": 9.982911109924316, "vf_explained_var": 5.889684189241962e-07, "kl": 0.008085187524557114, "entropy": 0.2700744569301605, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 60853.06036376953, "episode_reward_min": 60853.06036376953, "episode_reward_mean": 60853.06036376953, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60853.06036376953}, "policy_reward_max": {"agent_0": 60853.06036376953}, "policy_reward_mean": {"agent_0": 60853.06036376953}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60853.06036376953], "episode_lengths": [137], "policy_agent_0_reward": [60853.06036376953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.91337187843571, "mean_inference_ms": 6.579058496140089, "mean_action_processing_ms": 0.19888846838034674, "mean_env_wait_ms": 238.52190278357384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041985511779785156, "StateBufferConnector_ms": 0.0064373016357421875, "ViewRequirementAgentConnector_ms": 0.17936229705810547}}, "episode_reward_max": 60853.06036376953, "episode_reward_min": 60853.06036376953, "episode_reward_mean": 60853.06036376953, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60853.06036376953}, "policy_reward_max": {"agent_0": 60853.06036376953}, "policy_reward_mean": {"agent_0": 60853.06036376953}, "hist_stats": {"episode_reward": [60853.06036376953], "episode_lengths": [137], "policy_agent_0_reward": [60853.06036376953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.91337187843571, "mean_inference_ms": 6.579058496140089, "mean_action_processing_ms": 0.19888846838034674, "mean_env_wait_ms": 238.52190278357384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041985511779785156, "StateBufferConnector_ms": 0.0064373016357421875, "ViewRequirementAgentConnector_ms": 0.17936229705810547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.5984771957349, "num_env_steps_trained_throughput_per_sec": 281.5984771957349, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 14806.944, "sample_time_ms": 11690.108, "learn_time_ms": 2966.376, "learn_throughput": 1348.447, "synch_weights_time_ms": 149.78}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 2108, "training_iteration": 73, "trial_id": "32397_00000", "date": "2025-03-21_08-54-58", "timestamp": 1742547298, "time_this_iter_s": 14.276767015457153, "time_total_s": 1071.6573958396912, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbc670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1071.6573958396912, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 99.54, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.909841537475586, "policy_loss": -0.009660243056714535, "vf_loss": 9.91943359375, "vf_explained_var": 5.371868496695242e-07, "kl": 0.010913120582699776, "entropy": 0.2737177908420563, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 61026.76055908203, "episode_reward_min": 50172.69332695007, "episode_reward_mean": 58142.40169402957, "episode_len_mean": 136.59375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 50172.69332695007}, "policy_reward_max": {"agent_0": 61026.76055908203}, "policy_reward_mean": {"agent_0": 58142.40169402957}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59267.566802978516, 58767.94647216797, 58065.2936706543, 59283.566955566406, 59415.89352416992, 58076.24703979492, 54755.82019805908, 55123.35369491577, 61026.76055908203, 52162.33348751068, 59586.506927490234, 58061.01362609863, 58899.76689147949, 54019.98680496216, 60504.8869934082, 58535.13377380371, 60108.280014038086, 60865.73388671875, 60517.933349609375, 60471.88690185547, 53808.57367897034, 59152.079986572266, 55987.88703727722, 56616.24026489258, 50172.69332695007, 60683.60656738281, 60025.52682495117, 58362.94694709778, 60555.10037231445, 59749.86682128906, 58604.19366455078, 59322.227142333984], "episode_lengths": [137, 136, 135, 137, 137, 137, 137, 137, 137, 135, 136, 136, 137, 136, 137, 137, 137, 137, 137, 137, 136, 136, 137, 136, 135, 137, 137, 137, 137, 137, 137, 137], "policy_agent_0_reward": [59267.566802978516, 58767.94647216797, 58065.2936706543, 59283.566955566406, 59415.89352416992, 58076.24703979492, 54755.82019805908, 55123.35369491577, 61026.76055908203, 52162.33348751068, 59586.506927490234, 58061.01362609863, 58899.76689147949, 54019.98680496216, 60504.8869934082, 58535.13377380371, 60108.280014038086, 60865.73388671875, 60517.933349609375, 60471.88690185547, 53808.57367897034, 59152.079986572266, 55987.88703727722, 56616.24026489258, 50172.69332695007, 60683.60656738281, 60025.52682495117, 58362.94694709778, 60555.10037231445, 59749.86682128906, 58604.19366455078, 59322.227142333984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.732637069335592, "mean_inference_ms": 6.328026504483421, "mean_action_processing_ms": 0.20096932907256737, "mean_env_wait_ms": 216.84079713329544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04108548164367676, "StateBufferConnector_ms": 0.006441026926040649, "ViewRequirementAgentConnector_ms": 0.24198368191719055}}, "episode_reward_max": 61026.76055908203, "episode_reward_min": 50172.69332695007, "episode_reward_mean": 58142.40169402957, "episode_len_mean": 136.59375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 50172.69332695007}, "policy_reward_max": {"agent_0": 61026.76055908203}, "policy_reward_mean": {"agent_0": 58142.40169402957}, "hist_stats": {"episode_reward": [59267.566802978516, 58767.94647216797, 58065.2936706543, 59283.566955566406, 59415.89352416992, 58076.24703979492, 54755.82019805908, 55123.35369491577, 61026.76055908203, 52162.33348751068, 59586.506927490234, 58061.01362609863, 58899.76689147949, 54019.98680496216, 60504.8869934082, 58535.13377380371, 60108.280014038086, 60865.73388671875, 60517.933349609375, 60471.88690185547, 53808.57367897034, 59152.079986572266, 55987.88703727722, 56616.24026489258, 50172.69332695007, 60683.60656738281, 60025.52682495117, 58362.94694709778, 60555.10037231445, 59749.86682128906, 58604.19366455078, 59322.227142333984], "episode_lengths": [137, 136, 135, 137, 137, 137, 137, 137, 137, 135, 136, 136, 137, 136, 137, 137, 137, 137, 137, 137, 136, 136, 137, 136, 135, 137, 137, 137, 137, 137, 137, 137], "policy_agent_0_reward": [59267.566802978516, 58767.94647216797, 58065.2936706543, 59283.566955566406, 59415.89352416992, 58076.24703979492, 54755.82019805908, 55123.35369491577, 61026.76055908203, 52162.33348751068, 59586.506927490234, 58061.01362609863, 58899.76689147949, 54019.98680496216, 60504.8869934082, 58535.13377380371, 60108.280014038086, 60865.73388671875, 60517.933349609375, 60471.88690185547, 53808.57367897034, 59152.079986572266, 55987.88703727722, 56616.24026489258, 50172.69332695007, 60683.60656738281, 60025.52682495117, 58362.94694709778, 60555.10037231445, 59749.86682128906, 58604.19366455078, 59322.227142333984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.732637069335592, "mean_inference_ms": 6.328026504483421, "mean_action_processing_ms": 0.20096932907256737, "mean_env_wait_ms": 216.84079713329544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04108548164367676, "StateBufferConnector_ms": 0.006441026926040649, "ViewRequirementAgentConnector_ms": 0.24198368191719055}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.4066606675019, "num_env_steps_trained_throughput_per_sec": 265.4066606675019, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 14721.045, "sample_time_ms": 11527.735, "learn_time_ms": 3041.313, "learn_throughput": 1315.221, "synch_weights_time_ms": 151.31}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 2140, "training_iteration": 74, "trial_id": "32397_00000", "date": "2025-03-21_08-55-14", "timestamp": 1742547314, "time_this_iter_s": 15.139432191848755, "time_total_s": 1086.79682803154, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba4b490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1086.79682803154, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 99.39000000000001, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993292808532715, "policy_loss": -0.006752911489456892, "vf_loss": 10.0, "vf_explained_var": 2.404053986992949e-07, "kl": 0.0073671117424964905, "entropy": 0.29178178310394287, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 59322.227142333984, "episode_reward_min": 59322.227142333984, "episode_reward_mean": 59322.227142333984, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59322.227142333984}, "policy_reward_max": {"agent_0": 59322.227142333984}, "policy_reward_mean": {"agent_0": 59322.227142333984}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59322.227142333984], "episode_lengths": [137], "policy_agent_0_reward": [59322.227142333984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.462408870739182, "mean_inference_ms": 6.271686995073367, "mean_action_processing_ms": 0.1954965985704532, "mean_env_wait_ms": 223.7201525547248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03521442413330078, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.9510517120361328}}, "episode_reward_max": 59322.227142333984, "episode_reward_min": 59322.227142333984, "episode_reward_mean": 59322.227142333984, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59322.227142333984}, "policy_reward_max": {"agent_0": 59322.227142333984}, "policy_reward_mean": {"agent_0": 59322.227142333984}, "hist_stats": {"episode_reward": [59322.227142333984], "episode_lengths": [137], "policy_agent_0_reward": [59322.227142333984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.462408870739182, "mean_inference_ms": 6.271686995073367, "mean_action_processing_ms": 0.1954965985704532, "mean_env_wait_ms": 223.7201525547248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03521442413330078, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.9510517120361328}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.3549525361588, "num_env_steps_trained_throughput_per_sec": 299.3549525361588, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 14730.255, "sample_time_ms": 11505.475, "learn_time_ms": 3068.378, "learn_throughput": 1303.62, "synch_weights_time_ms": 155.7}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 2140, "training_iteration": 75, "trial_id": "32397_00000", "date": "2025-03-21_08-55-27", "timestamp": 1742547327, "time_this_iter_s": 13.423467636108398, "time_total_s": 1100.2202956676483, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba48670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1100.2202956676483, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 99.46000000000001, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.805607795715332, "policy_loss": -0.010850775055587292, "vf_loss": 9.81640625, "vf_explained_var": 3.0857822963525905e-08, "kl": 0.008287636563181877, "entropy": 0.299740731716156, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 61739.980560302734, "episode_reward_min": 50685.29350280762, "episode_reward_mean": 57896.283769736554, "episode_len_mean": 136.3835616438356, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 50685.29350280762}, "policy_reward_max": {"agent_0": 61739.980560302734}, "policy_reward_mean": {"agent_0": 57896.283769736554}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58934.46664428711, 50851.0733499527, 60206.70666503906, 54712.30020713806, 58488.3466758728, 61009.56707763672, 57276.48022651672, 53238.56681442261, 59734.733642578125, 56686.12696838379, 59334.64685058594, 59368.28680419922, 60767.340240478516, 60766.9469909668, 56406.32695198059, 58735.853424072266, 59357.2932472229, 60399.36019897461, 59582.47360229492, 59355.566833496094, 61294.88034057617, 60298.453536987305, 54638.5201625824, 58689.28022766113, 59688.70016479492, 55204.9201785326, 59463.67370605469, 60025.93359375, 60138.01356506348, 55711.98010253906, 58165.03384399414, 61067.91329956055, 55785.04706454277, 61321.54699707031, 61739.980560302734, 52514.74667263031, 59733.08038330078, 53736.91362762451, 55213.72658479214, 51583.25353336334, 55376.72048377991, 56217.23341655731, 56816.84027957916, 60209.52005004883, 60510.49336242676, 50685.29350280762, 60233.20687866211, 60528.66702270508, 59492.18682861328, 61562.2067565918, 58720.4201965332, 60214.480434417725, 59504.880279541016, 59380.79360961914, 60659.58702850342, 59541.266845703125, 55132.58674907684, 55242.753558158875, 55892.86044692993, 56643.90687942505, 59974.2200012207, 59538.89338684082, 56315.220212101936, 52379.106925964355, 50797.34000205994, 57469.7268371582, 59944.72692871094, 55359.40016746521, 59482.58038330078, 58343.75332021713, 54789.020325660706, 57770.1669921875, 60470.59353637695], "episode_lengths": [137, 136, 137, 135, 137, 137, 136, 135, 137, 136, 137, 137, 137, 137, 136, 136, 137, 137, 136, 137, 138, 137, 136, 137, 137, 136, 136, 136, 137, 135, 136, 137, 136, 137, 137, 135, 137, 135, 136, 135, 136, 136, 136, 137, 137, 136, 137, 137, 136, 138, 137, 137, 136, 137, 137, 136, 136, 136, 136, 136, 137, 137, 137, 135, 135, 136, 137, 136, 136, 137, 136, 135, 136], "policy_agent_0_reward": [58934.46664428711, 50851.0733499527, 60206.70666503906, 54712.30020713806, 58488.3466758728, 61009.56707763672, 57276.48022651672, 53238.56681442261, 59734.733642578125, 56686.12696838379, 59334.64685058594, 59368.28680419922, 60767.340240478516, 60766.9469909668, 56406.32695198059, 58735.853424072266, 59357.2932472229, 60399.36019897461, 59582.47360229492, 59355.566833496094, 61294.88034057617, 60298.453536987305, 54638.5201625824, 58689.28022766113, 59688.70016479492, 55204.9201785326, 59463.67370605469, 60025.93359375, 60138.01356506348, 55711.98010253906, 58165.03384399414, 61067.91329956055, 55785.04706454277, 61321.54699707031, 61739.980560302734, 52514.74667263031, 59733.08038330078, 53736.91362762451, 55213.72658479214, 51583.25353336334, 55376.72048377991, 56217.23341655731, 56816.84027957916, 60209.52005004883, 60510.49336242676, 50685.29350280762, 60233.20687866211, 60528.66702270508, 59492.18682861328, 61562.2067565918, 58720.4201965332, 60214.480434417725, 59504.880279541016, 59380.79360961914, 60659.58702850342, 59541.266845703125, 55132.58674907684, 55242.753558158875, 55892.86044692993, 56643.90687942505, 59974.2200012207, 59538.89338684082, 56315.220212101936, 52379.106925964355, 50797.34000205994, 57469.7268371582, 59944.72692871094, 55359.40016746521, 59482.58038330078, 58343.75332021713, 54789.020325660706, 57770.1669921875, 60470.59353637695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.142903955686613, "mean_inference_ms": 6.764868574048651, "mean_action_processing_ms": 0.1991033729928788, "mean_env_wait_ms": 233.6782405368233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08100091594539277, "StateBufferConnector_ms": 0.005933683212489298, "ViewRequirementAgentConnector_ms": 0.21586810072807416}}, "episode_reward_max": 61739.980560302734, "episode_reward_min": 50685.29350280762, "episode_reward_mean": 57896.283769736554, "episode_len_mean": 136.3835616438356, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 50685.29350280762}, "policy_reward_max": {"agent_0": 61739.980560302734}, "policy_reward_mean": {"agent_0": 57896.283769736554}, "hist_stats": {"episode_reward": [58934.46664428711, 50851.0733499527, 60206.70666503906, 54712.30020713806, 58488.3466758728, 61009.56707763672, 57276.48022651672, 53238.56681442261, 59734.733642578125, 56686.12696838379, 59334.64685058594, 59368.28680419922, 60767.340240478516, 60766.9469909668, 56406.32695198059, 58735.853424072266, 59357.2932472229, 60399.36019897461, 59582.47360229492, 59355.566833496094, 61294.88034057617, 60298.453536987305, 54638.5201625824, 58689.28022766113, 59688.70016479492, 55204.9201785326, 59463.67370605469, 60025.93359375, 60138.01356506348, 55711.98010253906, 58165.03384399414, 61067.91329956055, 55785.04706454277, 61321.54699707031, 61739.980560302734, 52514.74667263031, 59733.08038330078, 53736.91362762451, 55213.72658479214, 51583.25353336334, 55376.72048377991, 56217.23341655731, 56816.84027957916, 60209.52005004883, 60510.49336242676, 50685.29350280762, 60233.20687866211, 60528.66702270508, 59492.18682861328, 61562.2067565918, 58720.4201965332, 60214.480434417725, 59504.880279541016, 59380.79360961914, 60659.58702850342, 59541.266845703125, 55132.58674907684, 55242.753558158875, 55892.86044692993, 56643.90687942505, 59974.2200012207, 59538.89338684082, 56315.220212101936, 52379.106925964355, 50797.34000205994, 57469.7268371582, 59944.72692871094, 55359.40016746521, 59482.58038330078, 58343.75332021713, 54789.020325660706, 57770.1669921875, 60470.59353637695], "episode_lengths": [137, 136, 137, 135, 137, 137, 136, 135, 137, 136, 137, 137, 137, 137, 136, 136, 137, 137, 136, 137, 138, 137, 136, 137, 137, 136, 136, 136, 137, 135, 136, 137, 136, 137, 137, 135, 137, 135, 136, 135, 136, 136, 136, 137, 137, 136, 137, 137, 136, 138, 137, 137, 136, 137, 137, 136, 136, 136, 136, 136, 137, 137, 137, 135, 135, 136, 137, 136, 136, 137, 136, 135, 136], "policy_agent_0_reward": [58934.46664428711, 50851.0733499527, 60206.70666503906, 54712.30020713806, 58488.3466758728, 61009.56707763672, 57276.48022651672, 53238.56681442261, 59734.733642578125, 56686.12696838379, 59334.64685058594, 59368.28680419922, 60767.340240478516, 60766.9469909668, 56406.32695198059, 58735.853424072266, 59357.2932472229, 60399.36019897461, 59582.47360229492, 59355.566833496094, 61294.88034057617, 60298.453536987305, 54638.5201625824, 58689.28022766113, 59688.70016479492, 55204.9201785326, 59463.67370605469, 60025.93359375, 60138.01356506348, 55711.98010253906, 58165.03384399414, 61067.91329956055, 55785.04706454277, 61321.54699707031, 61739.980560302734, 52514.74667263031, 59733.08038330078, 53736.91362762451, 55213.72658479214, 51583.25353336334, 55376.72048377991, 56217.23341655731, 56816.84027957916, 60209.52005004883, 60510.49336242676, 50685.29350280762, 60233.20687866211, 60528.66702270508, 59492.18682861328, 61562.2067565918, 58720.4201965332, 60214.480434417725, 59504.880279541016, 59380.79360961914, 60659.58702850342, 59541.266845703125, 55132.58674907684, 55242.753558158875, 55892.86044692993, 56643.90687942505, 59974.2200012207, 59538.89338684082, 56315.220212101936, 52379.106925964355, 50797.34000205994, 57469.7268371582, 59944.72692871094, 55359.40016746521, 59482.58038330078, 58343.75332021713, 54789.020325660706, 57770.1669921875, 60470.59353637695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.142903955686613, "mean_inference_ms": 6.764868574048651, "mean_action_processing_ms": 0.1991033729928788, "mean_env_wait_ms": 233.6782405368233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08100091594539277, "StateBufferConnector_ms": 0.005933683212489298, "ViewRequirementAgentConnector_ms": 0.21586810072807416}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.9748590281971, "num_env_steps_trained_throughput_per_sec": 303.9748590281971, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 14372.399, "sample_time_ms": 11249.338, "learn_time_ms": 2972.894, "learn_throughput": 1345.491, "synch_weights_time_ms": 149.469}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 2213, "training_iteration": 76, "trial_id": "32397_00000", "date": "2025-03-21_08-55-40", "timestamp": 1742547340, "time_this_iter_s": 13.209558010101318, "time_total_s": 1113.4298536777496, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19ceea70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1113.4298536777496, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 96.8111111111111, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.943819046020508, "policy_loss": -0.008860599249601364, "vf_loss": 9.95263671875, "vf_explained_var": 3.476937706636818e-07, "kl": 0.006777196191251278, "entropy": 0.3048821687698364, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 61745.940368652344, "episode_reward_min": 54006.920333862305, "episode_reward_mean": 58878.40930739202, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 54006.920333862305}, "policy_reward_max": {"agent_0": 61745.940368652344}, "policy_reward_mean": {"agent_0": 58878.40930739202}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59825.64709472656, 55487.85352730751, 55116.520067214966, 59993.94696044922, 58069.78685379028, 60063.44673156738, 60019.46686935425, 54006.920333862305, 61745.940368652344, 55185.80679702759, 60312.39367675781, 59699.44664764404, 56877.880086898804, 60147.72024536133, 60699.646728515625, 60657.933685302734, 60028.59353637695, 60633.77990722656, 60117.04672241211], "episode_lengths": [137, 135, 137, 137, 136, 138, 138, 136, 138, 137, 137, 137, 136, 137, 138, 137, 137, 138, 137], "policy_agent_0_reward": [59825.64709472656, 55487.85352730751, 55116.520067214966, 59993.94696044922, 58069.78685379028, 60063.44673156738, 60019.46686935425, 54006.920333862305, 61745.940368652344, 55185.80679702759, 60312.39367675781, 59699.44664764404, 56877.880086898804, 60147.72024536133, 60699.646728515625, 60657.933685302734, 60028.59353637695, 60633.77990722656, 60117.04672241211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.1134982806992, "mean_inference_ms": 6.731470435256444, "mean_action_processing_ms": 0.197724923388075, "mean_env_wait_ms": 231.7473337746257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03736521068372225, "StateBufferConnector_ms": 0.005779768291272615, "ViewRequirementAgentConnector_ms": 0.18835318715948807}}, "episode_reward_max": 61745.940368652344, "episode_reward_min": 54006.920333862305, "episode_reward_mean": 58878.40930739202, "episode_len_mean": 137.0, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 54006.920333862305}, "policy_reward_max": {"agent_0": 61745.940368652344}, "policy_reward_mean": {"agent_0": 58878.40930739202}, "hist_stats": {"episode_reward": [59825.64709472656, 55487.85352730751, 55116.520067214966, 59993.94696044922, 58069.78685379028, 60063.44673156738, 60019.46686935425, 54006.920333862305, 61745.940368652344, 55185.80679702759, 60312.39367675781, 59699.44664764404, 56877.880086898804, 60147.72024536133, 60699.646728515625, 60657.933685302734, 60028.59353637695, 60633.77990722656, 60117.04672241211], "episode_lengths": [137, 135, 137, 137, 136, 138, 138, 136, 138, 137, 137, 137, 136, 137, 138, 137, 137, 138, 137], "policy_agent_0_reward": [59825.64709472656, 55487.85352730751, 55116.520067214966, 59993.94696044922, 58069.78685379028, 60063.44673156738, 60019.46686935425, 54006.920333862305, 61745.940368652344, 55185.80679702759, 60312.39367675781, 59699.44664764404, 56877.880086898804, 60147.72024536133, 60699.646728515625, 60657.933685302734, 60028.59353637695, 60633.77990722656, 60117.04672241211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.1134982806992, "mean_inference_ms": 6.731470435256444, "mean_action_processing_ms": 0.197724923388075, "mean_env_wait_ms": 231.7473337746257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03736521068372225, "StateBufferConnector_ms": 0.005779768291272615, "ViewRequirementAgentConnector_ms": 0.18835318715948807}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.9265026767428, "num_env_steps_trained_throughput_per_sec": 251.9265026767428, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 14570.043, "sample_time_ms": 11497.25, "learn_time_ms": 2920.1, "learn_throughput": 1369.816, "synch_weights_time_ms": 151.986}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 2232, "training_iteration": 77, "trial_id": "32397_00000", "date": "2025-03-21_08-55-56", "timestamp": 1742547356, "time_this_iter_s": 15.930284261703491, "time_total_s": 1129.3601379394531, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb943490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1129.3601379394531, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 99.17272727272729, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91305923461914, "policy_loss": -0.007884723134338856, "vf_loss": 9.9208984375, "vf_explained_var": -2.0420799273779267e-07, "kl": 0.007221949752420187, "entropy": 0.2820253074169159, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 61591.69396972656, "episode_reward_min": 46545.90697786212, "episode_reward_mean": 57515.49389796518, "episode_len_mean": 136.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46545.90697786212}, "policy_reward_max": {"agent_0": 61591.69396972656}, "policy_reward_mean": {"agent_0": 57515.49389796518}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [61579.07342529297, 59646.73351287842, 59106.7601146698, 55572.67991280556, 59813.27326965332, 58852.406814575195, 61591.69396972656, 55934.52671813965, 54204.22688573599, 56948.393387794495, 59302.74006271362, 60115.52027130127, 59004.30019378662, 53056.60697746277, 60977.566749572754, 54936.4403360188, 58006.140228271484, 60739.87336730957, 51426.0401058197, 59260.2067565918, 54292.86711406708, 59417.539978027344, 53584.726840019226, 46545.90697786212, 59396.34683227539, 53489.29998064041, 57055.779888153076, 59872.98046875, 60596.09362792969, 55558.793380737305, 61274.30679321289, 59335.95979309082], "episode_lengths": [138, 137, 137, 136, 137, 137, 137, 136, 135, 136, 137, 137, 137, 135, 137, 136, 137, 137, 136, 137, 136, 137, 136, 135, 136, 135, 136, 137, 138, 136, 137, 137], "policy_agent_0_reward": [61579.07342529297, 59646.73351287842, 59106.7601146698, 55572.67991280556, 59813.27326965332, 58852.406814575195, 61591.69396972656, 55934.52671813965, 54204.22688573599, 56948.393387794495, 59302.74006271362, 60115.52027130127, 59004.30019378662, 53056.60697746277, 60977.566749572754, 54936.4403360188, 58006.140228271484, 60739.87336730957, 51426.0401058197, 59260.2067565918, 54292.86711406708, 59417.539978027344, 53584.726840019226, 46545.90697786212, 59396.34683227539, 53489.29998064041, 57055.779888153076, 59872.98046875, 60596.09362792969, 55558.793380737305, 61274.30679321289, 59335.95979309082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.356994996950462, "mean_inference_ms": 6.3392529065169185, "mean_action_processing_ms": 0.20102627358390288, "mean_env_wait_ms": 217.68558246128765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06580278277397156, "StateBufferConnector_ms": 0.00624433159828186, "ViewRequirementAgentConnector_ms": 0.2840064465999603}}, "episode_reward_max": 61591.69396972656, "episode_reward_min": 46545.90697786212, "episode_reward_mean": 57515.49389796518, "episode_len_mean": 136.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46545.90697786212}, "policy_reward_max": {"agent_0": 61591.69396972656}, "policy_reward_mean": {"agent_0": 57515.49389796518}, "hist_stats": {"episode_reward": [61579.07342529297, 59646.73351287842, 59106.7601146698, 55572.67991280556, 59813.27326965332, 58852.406814575195, 61591.69396972656, 55934.52671813965, 54204.22688573599, 56948.393387794495, 59302.74006271362, 60115.52027130127, 59004.30019378662, 53056.60697746277, 60977.566749572754, 54936.4403360188, 58006.140228271484, 60739.87336730957, 51426.0401058197, 59260.2067565918, 54292.86711406708, 59417.539978027344, 53584.726840019226, 46545.90697786212, 59396.34683227539, 53489.29998064041, 57055.779888153076, 59872.98046875, 60596.09362792969, 55558.793380737305, 61274.30679321289, 59335.95979309082], "episode_lengths": [138, 137, 137, 136, 137, 137, 137, 136, 135, 136, 137, 137, 137, 135, 137, 136, 137, 137, 136, 137, 136, 137, 136, 135, 136, 135, 136, 137, 138, 136, 137, 137], "policy_agent_0_reward": [61579.07342529297, 59646.73351287842, 59106.7601146698, 55572.67991280556, 59813.27326965332, 58852.406814575195, 61591.69396972656, 55934.52671813965, 54204.22688573599, 56948.393387794495, 59302.74006271362, 60115.52027130127, 59004.30019378662, 53056.60697746277, 60977.566749572754, 54936.4403360188, 58006.140228271484, 60739.87336730957, 51426.0401058197, 59260.2067565918, 54292.86711406708, 59417.539978027344, 53584.726840019226, 46545.90697786212, 59396.34683227539, 53489.29998064041, 57055.779888153076, 59872.98046875, 60596.09362792969, 55558.793380737305, 61274.30679321289, 59335.95979309082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.356994996950462, "mean_inference_ms": 6.3392529065169185, "mean_action_processing_ms": 0.20102627358390288, "mean_env_wait_ms": 217.68558246128765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06580278277397156, "StateBufferConnector_ms": 0.00624433159828186, "ViewRequirementAgentConnector_ms": 0.2840064465999603}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.15092699883627, "num_env_steps_trained_throughput_per_sec": 289.15092699883627, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 14290.216, "sample_time_ms": 11181.431, "learn_time_ms": 2952.831, "learn_throughput": 1354.632, "synch_weights_time_ms": 155.246}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 2264, "training_iteration": 78, "trial_id": "32397_00000", "date": "2025-03-21_08-56-10", "timestamp": 1742547370, "time_this_iter_s": 13.885725021362305, "time_total_s": 1143.2458629608154, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942b90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1143.2458629608154, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 99.42631578947369, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989065170288086, "policy_loss": -0.010979644022881985, "vf_loss": 10.0, "vf_explained_var": -1.638506859080735e-07, "kl": 0.00729881739243865, "entropy": 0.3068377673625946, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 59335.95979309082, "episode_reward_min": 59335.95979309082, "episode_reward_mean": 59335.95979309082, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59335.95979309082}, "policy_reward_max": {"agent_0": 59335.95979309082}, "policy_reward_mean": {"agent_0": 59335.95979309082}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59335.95979309082], "episode_lengths": [137], "policy_agent_0_reward": [59335.95979309082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.238819974140057, "mean_inference_ms": 6.257733743167618, "mean_action_processing_ms": 0.1953266662301369, "mean_env_wait_ms": 225.00647535601865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03998279571533203, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.16450881958007812}}, "episode_reward_max": 59335.95979309082, "episode_reward_min": 59335.95979309082, "episode_reward_mean": 59335.95979309082, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59335.95979309082}, "policy_reward_max": {"agent_0": 59335.95979309082}, "policy_reward_mean": {"agent_0": 59335.95979309082}, "hist_stats": {"episode_reward": [59335.95979309082], "episode_lengths": [137], "policy_agent_0_reward": [59335.95979309082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.238819974140057, "mean_inference_ms": 6.257733743167618, "mean_action_processing_ms": 0.1953266662301369, "mean_env_wait_ms": 225.00647535601865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03998279571533203, "StateBufferConnector_ms": 0.0054836273193359375, "ViewRequirementAgentConnector_ms": 0.16450881958007812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.2230362651675, "num_env_steps_trained_throughput_per_sec": 305.2230362651675, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 14288.679, "sample_time_ms": 11143.465, "learn_time_ms": 2986.644, "learn_throughput": 1339.296, "synch_weights_time_ms": 157.909}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 2264, "training_iteration": 79, "trial_id": "32397_00000", "date": "2025-03-21_08-56-24", "timestamp": 1742547384, "time_this_iter_s": 13.161218643188477, "time_total_s": 1156.407081604004, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942e60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1156.407081604004, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 99.49473684210527, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989749908447266, "policy_loss": -0.007843571715056896, "vf_loss": 9.99755859375, "vf_explained_var": -1.4218191068948727e-08, "kl": 0.0056339045986533165, "entropy": 0.2755790650844574, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 56908.54013252258, "episode_reward_min": 56908.54013252258, "episode_reward_mean": 56908.54013252258, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56908.54013252258}, "policy_reward_max": {"agent_0": 56908.54013252258}, "policy_reward_mean": {"agent_0": 56908.54013252258}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56908.54013252258], "episode_lengths": [136], "policy_agent_0_reward": [56908.54013252258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.817746082352084, "mean_inference_ms": 6.639324469009631, "mean_action_processing_ms": 0.21119715412442266, "mean_env_wait_ms": 229.0106853066548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045990943908691406, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18453598022460938}}, "episode_reward_max": 56908.54013252258, "episode_reward_min": 56908.54013252258, "episode_reward_mean": 56908.54013252258, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56908.54013252258}, "policy_reward_max": {"agent_0": 56908.54013252258}, "policy_reward_mean": {"agent_0": 56908.54013252258}, "hist_stats": {"episode_reward": [56908.54013252258], "episode_lengths": [136], "policy_agent_0_reward": [56908.54013252258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.817746082352084, "mean_inference_ms": 6.639324469009631, "mean_action_processing_ms": 0.21119715412442266, "mean_env_wait_ms": 229.0106853066548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045990943908691406, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18453598022460938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.4478563946919, "num_env_steps_trained_throughput_per_sec": 316.4478563946919, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 13952.703, "sample_time_ms": 10813.046, "learn_time_ms": 2971.418, "learn_throughput": 1346.159, "synch_weights_time_ms": 167.565}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 2265, "training_iteration": 80, "trial_id": "32397_00000", "date": "2025-03-21_08-56-36", "timestamp": 1742547396, "time_this_iter_s": 12.691713571548462, "time_total_s": 1169.0987951755524, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb943be0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1169.0987951755524, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 99.51666666666668, "ram_util_percent": 13.4}}
{"custom_metrics": {"num_batches_mean": 5.725274725274725, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.76181697845459, "policy_loss": -0.010206939652562141, "vf_loss": 9.77197265625, "vf_explained_var": 1.1033068147980885e-07, "kl": 0.00812571495771408, "entropy": 0.29611411690711975, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 62020.466705322266, "episode_reward_min": 49471.46693611145, "episode_reward_mean": 57833.310963867785, "episode_len_mean": 136.43956043956044, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 49471.46693611145}, "policy_reward_max": {"agent_0": 62020.466705322266}, "policy_reward_mean": {"agent_0": 57833.310963867785}, "custom_metrics": {"num_batches_mean": 5.725274725274725, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59971.107177734375, 60347.486724853516, 59267.760162353516, 57170.973669052124, 49471.46693611145, 60060.966857910156, 60364.986956357956, 60244.96015930176, 54240.09364128113, 57743.4603767395, 57463.307067871094, 58289.76692008972, 58189.906856536865, 59731.940032958984, 57511.953704833984, 61250.17364501953, 58829.85339355469, 53683.34030532837, 56027.69354248047, 61190.73348236084, 59089.046875, 51928.826707839966, 58734.70013809204, 56958.573318481445, 60521.24685668945, 60068.353649139404, 56720.69364929199, 60134.76678466797, 59249.54656982422, 55432.06029510498, 60295.42678833008, 57952.993408203125, 53050.0466966629, 62020.466705322266, 61315.647216796875, 58349.246852874756, 56007.533390045166, 60519.05368041992, 58190.53348350525, 60094.733516693115, 60897.90670776367, 57835.25339508057, 54984.35998916626, 60059.320068359375, 55928.126764297485, 60013.02014160156, 57843.5470161438, 59902.340087890625, 59131.67370605469, 55961.00020980835, 55287.927176475525, 59949.40683746338, 58879.553131103516, 55207.746841430664, 58369.6399230957, 49677.83339262009, 55064.25327920914, 58542.77362060547, 59459.96694946289, 59253.99377441406, 60694.26036834717, 60005.740478515625, 59377.56671142578, 57553.80014228821, 60500.266845703125, 60472.72710418701, 57043.06023979187, 60166.98699951172, 53273.860332489014, 56174.093547821045, 55658.00693702698, 60470.62683105469, 57978.713439941406, 61122.860412597656, 58214.60023498535, 58911.16677856445, 52290.233503341675, 55207.366976737976, 56687.95333611965, 57407.733292102814, 55996.080169677734, 57003.38000488281, 59082.82691192627, 59593.146743774414, 61193.6337890625, 60323.2003326416, 61514.653717041016, 49945.513414382935, 52400.4402179718, 55978.526472091675, 50653.20021820068], "episode_lengths": [137, 137, 137, 136, 135, 137, 138, 137, 137, 136, 136, 137, 137, 137, 136, 137, 136, 136, 135, 138, 136, 136, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 136, 138, 138, 136, 135, 137, 137, 137, 137, 136, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 135, 136, 134, 136, 137, 137, 136, 137, 137, 137, 136, 137, 137, 136, 138, 136, 136, 135, 137, 136, 137, 136, 136, 135, 136, 137, 137, 135, 137, 136, 137, 138, 137, 137, 135, 136, 136, 135], "policy_agent_0_reward": [59971.107177734375, 60347.486724853516, 59267.760162353516, 57170.973669052124, 49471.46693611145, 60060.966857910156, 60364.986956357956, 60244.96015930176, 54240.09364128113, 57743.4603767395, 57463.307067871094, 58289.76692008972, 58189.906856536865, 59731.940032958984, 57511.953704833984, 61250.17364501953, 58829.85339355469, 53683.34030532837, 56027.69354248047, 61190.73348236084, 59089.046875, 51928.826707839966, 58734.70013809204, 56958.573318481445, 60521.24685668945, 60068.353649139404, 56720.69364929199, 60134.76678466797, 59249.54656982422, 55432.06029510498, 60295.42678833008, 57952.993408203125, 53050.0466966629, 62020.466705322266, 61315.647216796875, 58349.246852874756, 56007.533390045166, 60519.05368041992, 58190.53348350525, 60094.733516693115, 60897.90670776367, 57835.25339508057, 54984.35998916626, 60059.320068359375, 55928.126764297485, 60013.02014160156, 57843.5470161438, 59902.340087890625, 59131.67370605469, 55961.00020980835, 55287.927176475525, 59949.40683746338, 58879.553131103516, 55207.746841430664, 58369.6399230957, 49677.83339262009, 55064.25327920914, 58542.77362060547, 59459.96694946289, 59253.99377441406, 60694.26036834717, 60005.740478515625, 59377.56671142578, 57553.80014228821, 60500.266845703125, 60472.72710418701, 57043.06023979187, 60166.98699951172, 53273.860332489014, 56174.093547821045, 55658.00693702698, 60470.62683105469, 57978.713439941406, 61122.860412597656, 58214.60023498535, 58911.16677856445, 52290.233503341675, 55207.366976737976, 56687.95333611965, 57407.733292102814, 55996.080169677734, 57003.38000488281, 59082.82691192627, 59593.146743774414, 61193.6337890625, 60323.2003326416, 61514.653717041016, 49945.513414382935, 52400.4402179718, 55978.526472091675, 50653.20021820068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.879971195338197, "mean_inference_ms": 6.762360829106604, "mean_action_processing_ms": 0.19840540763282136, "mean_env_wait_ms": 233.21499817673364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03993249201512599, "StateBufferConnector_ms": 0.00607102781861693, "ViewRequirementAgentConnector_ms": 0.23693121396578276}}, "episode_reward_max": 62020.466705322266, "episode_reward_min": 49471.46693611145, "episode_reward_mean": 57833.310963867785, "episode_len_mean": 136.43956043956044, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 49471.46693611145}, "policy_reward_max": {"agent_0": 62020.466705322266}, "policy_reward_mean": {"agent_0": 57833.310963867785}, "hist_stats": {"episode_reward": [59971.107177734375, 60347.486724853516, 59267.760162353516, 57170.973669052124, 49471.46693611145, 60060.966857910156, 60364.986956357956, 60244.96015930176, 54240.09364128113, 57743.4603767395, 57463.307067871094, 58289.76692008972, 58189.906856536865, 59731.940032958984, 57511.953704833984, 61250.17364501953, 58829.85339355469, 53683.34030532837, 56027.69354248047, 61190.73348236084, 59089.046875, 51928.826707839966, 58734.70013809204, 56958.573318481445, 60521.24685668945, 60068.353649139404, 56720.69364929199, 60134.76678466797, 59249.54656982422, 55432.06029510498, 60295.42678833008, 57952.993408203125, 53050.0466966629, 62020.466705322266, 61315.647216796875, 58349.246852874756, 56007.533390045166, 60519.05368041992, 58190.53348350525, 60094.733516693115, 60897.90670776367, 57835.25339508057, 54984.35998916626, 60059.320068359375, 55928.126764297485, 60013.02014160156, 57843.5470161438, 59902.340087890625, 59131.67370605469, 55961.00020980835, 55287.927176475525, 59949.40683746338, 58879.553131103516, 55207.746841430664, 58369.6399230957, 49677.83339262009, 55064.25327920914, 58542.77362060547, 59459.96694946289, 59253.99377441406, 60694.26036834717, 60005.740478515625, 59377.56671142578, 57553.80014228821, 60500.266845703125, 60472.72710418701, 57043.06023979187, 60166.98699951172, 53273.860332489014, 56174.093547821045, 55658.00693702698, 60470.62683105469, 57978.713439941406, 61122.860412597656, 58214.60023498535, 58911.16677856445, 52290.233503341675, 55207.366976737976, 56687.95333611965, 57407.733292102814, 55996.080169677734, 57003.38000488281, 59082.82691192627, 59593.146743774414, 61193.6337890625, 60323.2003326416, 61514.653717041016, 49945.513414382935, 52400.4402179718, 55978.526472091675, 50653.20021820068], "episode_lengths": [137, 137, 137, 136, 135, 137, 138, 137, 137, 136, 136, 137, 137, 137, 136, 137, 136, 136, 135, 138, 136, 136, 137, 136, 137, 137, 136, 137, 136, 136, 137, 136, 136, 138, 138, 136, 135, 137, 137, 137, 137, 136, 136, 137, 137, 136, 136, 137, 137, 136, 136, 137, 136, 135, 136, 134, 136, 137, 137, 136, 137, 137, 137, 136, 137, 137, 136, 138, 136, 136, 135, 137, 136, 137, 136, 136, 135, 136, 137, 137, 135, 137, 136, 137, 138, 137, 137, 135, 136, 136, 135], "policy_agent_0_reward": [59971.107177734375, 60347.486724853516, 59267.760162353516, 57170.973669052124, 49471.46693611145, 60060.966857910156, 60364.986956357956, 60244.96015930176, 54240.09364128113, 57743.4603767395, 57463.307067871094, 58289.76692008972, 58189.906856536865, 59731.940032958984, 57511.953704833984, 61250.17364501953, 58829.85339355469, 53683.34030532837, 56027.69354248047, 61190.73348236084, 59089.046875, 51928.826707839966, 58734.70013809204, 56958.573318481445, 60521.24685668945, 60068.353649139404, 56720.69364929199, 60134.76678466797, 59249.54656982422, 55432.06029510498, 60295.42678833008, 57952.993408203125, 53050.0466966629, 62020.466705322266, 61315.647216796875, 58349.246852874756, 56007.533390045166, 60519.05368041992, 58190.53348350525, 60094.733516693115, 60897.90670776367, 57835.25339508057, 54984.35998916626, 60059.320068359375, 55928.126764297485, 60013.02014160156, 57843.5470161438, 59902.340087890625, 59131.67370605469, 55961.00020980835, 55287.927176475525, 59949.40683746338, 58879.553131103516, 55207.746841430664, 58369.6399230957, 49677.83339262009, 55064.25327920914, 58542.77362060547, 59459.96694946289, 59253.99377441406, 60694.26036834717, 60005.740478515625, 59377.56671142578, 57553.80014228821, 60500.266845703125, 60472.72710418701, 57043.06023979187, 60166.98699951172, 53273.860332489014, 56174.093547821045, 55658.00693702698, 60470.62683105469, 57978.713439941406, 61122.860412597656, 58214.60023498535, 58911.16677856445, 52290.233503341675, 55207.366976737976, 56687.95333611965, 57407.733292102814, 55996.080169677734, 57003.38000488281, 59082.82691192627, 59593.146743774414, 61193.6337890625, 60323.2003326416, 61514.653717041016, 49945.513414382935, 52400.4402179718, 55978.526472091675, 50653.20021820068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.879971195338197, "mean_inference_ms": 6.762360829106604, "mean_action_processing_ms": 0.19840540763282136, "mean_env_wait_ms": 233.21499817673364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03993249201512599, "StateBufferConnector_ms": 0.00607102781861693, "ViewRequirementAgentConnector_ms": 0.23693121396578276}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.98546116185835, "num_env_steps_trained_throughput_per_sec": 238.98546116185835, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 14358.858, "sample_time_ms": 11243.558, "learn_time_ms": 2950.503, "learn_throughput": 1355.701, "synch_weights_time_ms": 164.115}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 2356, "training_iteration": 81, "trial_id": "32397_00000", "date": "2025-03-21_08-56-53", "timestamp": 1742547413, "time_this_iter_s": 16.796337366104126, "time_total_s": 1185.8951325416565, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f13370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1185.8951325416565, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 96.16521739130435, "ram_util_percent": 13.460869565217392}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.915287017822266, "policy_loss": -0.009811297059059143, "vf_loss": 9.925048828125, "vf_explained_var": -3.578141445359506e-07, "kl": 0.008042966015636921, "entropy": 0.3215058147907257, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 61500.847076416016, "episode_reward_min": 50515.50014781952, "episode_reward_mean": 57755.51418682734, "episode_len_mean": 136.4, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 50515.50014781952}, "policy_reward_max": {"agent_0": 61500.847076416016}, "policy_reward_mean": {"agent_0": 57755.51418682734}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59597.27354431152, 59482.92022705078, 56231.619956970215, 60523.87356567383, 55940.10004234314, 61500.847076416016, 59409.91342163086, 58423.4401473999, 56463.62008571625, 59195.500427246094, 56917.8802986145, 59912.50025177002, 52652.233368873596, 56976.18683242798, 61153.307189941406, 58410.14040374756, 56357.200092315674, 60986.246978759766, 57508.17335510254, 55959.8535194397, 59299.826820373535, 57203.99998855591, 54389.913343429565, 60071.52682495117, 57974.55349731445, 56555.260204315186, 50515.50014781952, 59999.38708496094, 57646.266860961914, 55406.36004638672], "episode_lengths": [138, 136, 136, 137, 136, 138, 137, 136, 137, 136, 137, 137, 136, 136, 137, 136, 135, 137, 135, 136, 137, 136, 136, 137, 136, 136, 136, 137, 137, 135], "policy_agent_0_reward": [59597.27354431152, 59482.92022705078, 56231.619956970215, 60523.87356567383, 55940.10004234314, 61500.847076416016, 59409.91342163086, 58423.4401473999, 56463.62008571625, 59195.500427246094, 56917.8802986145, 59912.50025177002, 52652.233368873596, 56976.18683242798, 61153.307189941406, 58410.14040374756, 56357.200092315674, 60986.246978759766, 57508.17335510254, 55959.8535194397, 59299.826820373535, 57203.99998855591, 54389.913343429565, 60071.52682495117, 57974.55349731445, 56555.260204315186, 50515.50014781952, 59999.38708496094, 57646.266860961914, 55406.36004638672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.504243652363478, "mean_inference_ms": 6.325522756183136, "mean_action_processing_ms": 0.2011203895045566, "mean_env_wait_ms": 217.07010021968338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03949324289957682, "StateBufferConnector_ms": 0.006134510040283203, "ViewRequirementAgentConnector_ms": 0.2524995803833008}}, "episode_reward_max": 61500.847076416016, "episode_reward_min": 50515.50014781952, "episode_reward_mean": 57755.51418682734, "episode_len_mean": 136.4, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 50515.50014781952}, "policy_reward_max": {"agent_0": 61500.847076416016}, "policy_reward_mean": {"agent_0": 57755.51418682734}, "hist_stats": {"episode_reward": [59597.27354431152, 59482.92022705078, 56231.619956970215, 60523.87356567383, 55940.10004234314, 61500.847076416016, 59409.91342163086, 58423.4401473999, 56463.62008571625, 59195.500427246094, 56917.8802986145, 59912.50025177002, 52652.233368873596, 56976.18683242798, 61153.307189941406, 58410.14040374756, 56357.200092315674, 60986.246978759766, 57508.17335510254, 55959.8535194397, 59299.826820373535, 57203.99998855591, 54389.913343429565, 60071.52682495117, 57974.55349731445, 56555.260204315186, 50515.50014781952, 59999.38708496094, 57646.266860961914, 55406.36004638672], "episode_lengths": [138, 136, 136, 137, 136, 138, 137, 136, 137, 136, 137, 137, 136, 136, 137, 136, 135, 137, 135, 136, 137, 136, 136, 137, 136, 136, 136, 137, 137, 135], "policy_agent_0_reward": [59597.27354431152, 59482.92022705078, 56231.619956970215, 60523.87356567383, 55940.10004234314, 61500.847076416016, 59409.91342163086, 58423.4401473999, 56463.62008571625, 59195.500427246094, 56917.8802986145, 59912.50025177002, 52652.233368873596, 56976.18683242798, 61153.307189941406, 58410.14040374756, 56357.200092315674, 60986.246978759766, 57508.17335510254, 55959.8535194397, 59299.826820373535, 57203.99998855591, 54389.913343429565, 60071.52682495117, 57974.55349731445, 56555.260204315186, 50515.50014781952, 59999.38708496094, 57646.266860961914, 55406.36004638672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.504243652363478, "mean_inference_ms": 6.325522756183136, "mean_action_processing_ms": 0.2011203895045566, "mean_env_wait_ms": 217.07010021968338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03949324289957682, "StateBufferConnector_ms": 0.006134510040283203, "ViewRequirementAgentConnector_ms": 0.2524995803833008}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.0713840196062, "num_env_steps_trained_throughput_per_sec": 312.0713840196062, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 14080.815, "sample_time_ms": 11011.642, "learn_time_ms": 2908.52, "learn_throughput": 1375.27, "synch_weights_time_ms": 159.969}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 2386, "training_iteration": 82, "trial_id": "32397_00000", "date": "2025-03-21_08-57-06", "timestamp": 1742547426, "time_this_iter_s": 12.873510837554932, "time_total_s": 1198.7686433792114, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19f130a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1198.7686433792114, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 99.34444444444443, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985546112060547, "policy_loss": -0.009376278147101402, "vf_loss": 9.994873046875, "vf_explained_var": 3.440305533786159e-07, "kl": 0.00788020994514227, "entropy": 0.33622339367866516, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 61199.947021484375, "episode_reward_min": 60605.95361328125, "episode_reward_mean": 60902.95031738281, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 60605.95361328125}, "policy_reward_max": {"agent_0": 61199.947021484375}, "policy_reward_mean": {"agent_0": 60902.95031738281}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61199.947021484375, 60605.95361328125], "episode_lengths": [137, 137], "policy_agent_0_reward": [61199.947021484375, 60605.95361328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.43313876729812, "mean_inference_ms": 6.200699432052835, "mean_action_processing_ms": 0.20123924652155298, "mean_env_wait_ms": 216.15337242175193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.246429443359375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18440485000610352}}, "episode_reward_max": 61199.947021484375, "episode_reward_min": 60605.95361328125, "episode_reward_mean": 60902.95031738281, "episode_len_mean": 137.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 60605.95361328125}, "policy_reward_max": {"agent_0": 61199.947021484375}, "policy_reward_mean": {"agent_0": 60902.95031738281}, "hist_stats": {"episode_reward": [61199.947021484375, 60605.95361328125], "episode_lengths": [137, 137], "policy_agent_0_reward": [61199.947021484375, 60605.95361328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.43313876729812, "mean_inference_ms": 6.200699432052835, "mean_action_processing_ms": 0.20123924652155298, "mean_env_wait_ms": 216.15337242175193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.246429443359375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.18440485000610352}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.49769843426463, "num_env_steps_trained_throughput_per_sec": 301.49769843426463, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 13987.063, "sample_time_ms": 10972.185, "learn_time_ms": 2862.445, "learn_throughput": 1397.407, "synch_weights_time_ms": 151.741}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 2388, "training_iteration": 83, "trial_id": "32397_00000", "date": "2025-03-21_08-57-19", "timestamp": 1742547439, "time_this_iter_s": 13.32571005821228, "time_total_s": 1212.0943534374237, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef9a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1212.0943534374237, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 99.52631578947368, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989009857177734, "policy_loss": -0.008346660993993282, "vf_loss": 9.997314453125, "vf_explained_var": 5.2464503852434063e-08, "kl": 0.006576409097760916, "entropy": 0.3292231261730194, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 60605.95361328125, "episode_reward_min": 60605.95361328125, "episode_reward_mean": 60605.95361328125, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60605.95361328125}, "policy_reward_max": {"agent_0": 60605.95361328125}, "policy_reward_mean": {"agent_0": 60605.95361328125}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60605.95361328125], "episode_lengths": [137], "policy_agent_0_reward": [60605.95361328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.48365792044758, "mean_inference_ms": 6.074138279378849, "mean_action_processing_ms": 0.20650268471153982, "mean_env_wait_ms": 218.35880940848023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038552284240722656, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.16329288482666016}}, "episode_reward_max": 60605.95361328125, "episode_reward_min": 60605.95361328125, "episode_reward_mean": 60605.95361328125, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60605.95361328125}, "policy_reward_max": {"agent_0": 60605.95361328125}, "policy_reward_mean": {"agent_0": 60605.95361328125}, "hist_stats": {"episode_reward": [60605.95361328125], "episode_lengths": [137], "policy_agent_0_reward": [60605.95361328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.48365792044758, "mean_inference_ms": 6.074138279378849, "mean_action_processing_ms": 0.20650268471153982, "mean_env_wait_ms": 218.35880940848023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038552284240722656, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.16329288482666016}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.9170951032473, "num_env_steps_trained_throughput_per_sec": 317.9170951032473, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 13738.134, "sample_time_ms": 10779.703, "learn_time_ms": 2807.203, "learn_throughput": 1424.906, "synch_weights_time_ms": 150.548}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 2388, "training_iteration": 84, "trial_id": "32397_00000", "date": "2025-03-21_08-57-32", "timestamp": 1742547452, "time_this_iter_s": 12.639084100723267, "time_total_s": 1224.733437538147, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1224.733437538147, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 99.52222222222223, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.75847339630127, "policy_loss": -0.011850867420434952, "vf_loss": 9.770264625549316, "vf_explained_var": 8.884196631697705e-07, "kl": 0.009628351777791977, "entropy": 0.3155260682106018, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 61684.99365234375, "episode_reward_min": 50440.906785964966, "episode_reward_mean": 58091.25411365991, "episode_len_mean": 136.3586956521739, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50440.906785964966}, "policy_reward_max": {"agent_0": 61684.99365234375}, "policy_reward_mean": {"agent_0": 58091.25411365991}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58754.73388290405, 59701.00700378418, 58067.95359802246, 57520.993562698364, 59369.85348510742, 60064.26693725586, 60206.61357116699, 61249.40675354004, 60244.04029083252, 59609.10006713867, 57524.59362792969, 57464.52684879303, 51036.26683425903, 58762.64665222168, 57006.326988220215, 57177.70032501221, 59441.56703186035, 50440.906785964966, 57457.24692153931, 57788.43370437622, 58883.69349479675, 58748.14027404785, 58776.78059387207, 52323.973346710205, 58748.00668334961, 59382.90007019043, 60952.58044433594, 58920.39324951172, 59580.41360473633, 55171.88690328598, 58242.79341125488, 56330.820068359375, 61049.37371826172, 57980.319885253906, 58823.50700378418, 56896.18028831482, 55436.44007062912, 58347.44688415527, 55423.573612213135, 55959.580121040344, 59650.26693725586, 59904.27359008789, 61244.2802734375, 59572.3935546875, 56121.866859436035, 60377.059997558594, 56104.740268707275, 54424.44030380249, 59917.41369628906, 57719.08674621582, 58526.36678314209, 60547.54005432129, 59381.36681365967, 59673.38029098511, 61405.72692871094, 58341.54726409912, 58804.246643066406, 57923.63353252411, 58287.83370780945, 58054.81330871582, 58891.06018066406, 56375.51339149475, 58537.866775512695, 58760.86016845703, 60225.800148010254, 53428.61334609985, 59781.006927490234, 55626.30020904541, 54075.646841049194, 59261.09356689453, 61349.27394104004, 61102.04020690918, 59484.39352416992, 60489.686880111694, 58019.84696960449, 58193.80662536621, 59603.23323059082, 55570.48697197437, 59803.93341064453, 55728.60697364807, 57929.113204956055, 57800.86709022522, 56268.41360807419, 60787.24676513672, 53094.92016029358, 55456.48679924011, 52797.56012916565, 59094.18029022217, 56442.72036552429, 59248.11996459961, 61684.99365234375, 58632.419982910156], "episode_lengths": [136, 137, 137, 136, 136, 138, 137, 137, 137, 136, 135, 135, 134, 138, 137, 136, 137, 134, 136, 137, 137, 137, 137, 135, 137, 137, 137, 136, 136, 135, 136, 136, 137, 136, 136, 137, 136, 137, 136, 136, 137, 137, 137, 137, 136, 137, 136, 135, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 135, 137, 135, 134, 136, 137, 137, 136, 138, 135, 136, 136, 137, 136, 136, 136, 136, 137, 138, 136, 136, 136, 137, 136, 137, 138, 137], "policy_agent_0_reward": [58754.73388290405, 59701.00700378418, 58067.95359802246, 57520.993562698364, 59369.85348510742, 60064.26693725586, 60206.61357116699, 61249.40675354004, 60244.04029083252, 59609.10006713867, 57524.59362792969, 57464.52684879303, 51036.26683425903, 58762.64665222168, 57006.326988220215, 57177.70032501221, 59441.56703186035, 50440.906785964966, 57457.24692153931, 57788.43370437622, 58883.69349479675, 58748.14027404785, 58776.78059387207, 52323.973346710205, 58748.00668334961, 59382.90007019043, 60952.58044433594, 58920.39324951172, 59580.41360473633, 55171.88690328598, 58242.79341125488, 56330.820068359375, 61049.37371826172, 57980.319885253906, 58823.50700378418, 56896.18028831482, 55436.44007062912, 58347.44688415527, 55423.573612213135, 55959.580121040344, 59650.26693725586, 59904.27359008789, 61244.2802734375, 59572.3935546875, 56121.866859436035, 60377.059997558594, 56104.740268707275, 54424.44030380249, 59917.41369628906, 57719.08674621582, 58526.36678314209, 60547.54005432129, 59381.36681365967, 59673.38029098511, 61405.72692871094, 58341.54726409912, 58804.246643066406, 57923.63353252411, 58287.83370780945, 58054.81330871582, 58891.06018066406, 56375.51339149475, 58537.866775512695, 58760.86016845703, 60225.800148010254, 53428.61334609985, 59781.006927490234, 55626.30020904541, 54075.646841049194, 59261.09356689453, 61349.27394104004, 61102.04020690918, 59484.39352416992, 60489.686880111694, 58019.84696960449, 58193.80662536621, 59603.23323059082, 55570.48697197437, 59803.93341064453, 55728.60697364807, 57929.113204956055, 57800.86709022522, 56268.41360807419, 60787.24676513672, 53094.92016029358, 55456.48679924011, 52797.56012916565, 59094.18029022217, 56442.72036552429, 59248.11996459961, 61684.99365234375, 58632.419982910156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.972251026966752, "mean_inference_ms": 6.766107922849295, "mean_action_processing_ms": 0.19836576547676474, "mean_env_wait_ms": 232.4849398314087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04946278489154318, "StateBufferConnector_ms": 0.010518924049709154, "ViewRequirementAgentConnector_ms": 0.22933742274408755}}, "episode_reward_max": 61684.99365234375, "episode_reward_min": 50440.906785964966, "episode_reward_mean": 58091.25411365991, "episode_len_mean": 136.3586956521739, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50440.906785964966}, "policy_reward_max": {"agent_0": 61684.99365234375}, "policy_reward_mean": {"agent_0": 58091.25411365991}, "hist_stats": {"episode_reward": [58754.73388290405, 59701.00700378418, 58067.95359802246, 57520.993562698364, 59369.85348510742, 60064.26693725586, 60206.61357116699, 61249.40675354004, 60244.04029083252, 59609.10006713867, 57524.59362792969, 57464.52684879303, 51036.26683425903, 58762.64665222168, 57006.326988220215, 57177.70032501221, 59441.56703186035, 50440.906785964966, 57457.24692153931, 57788.43370437622, 58883.69349479675, 58748.14027404785, 58776.78059387207, 52323.973346710205, 58748.00668334961, 59382.90007019043, 60952.58044433594, 58920.39324951172, 59580.41360473633, 55171.88690328598, 58242.79341125488, 56330.820068359375, 61049.37371826172, 57980.319885253906, 58823.50700378418, 56896.18028831482, 55436.44007062912, 58347.44688415527, 55423.573612213135, 55959.580121040344, 59650.26693725586, 59904.27359008789, 61244.2802734375, 59572.3935546875, 56121.866859436035, 60377.059997558594, 56104.740268707275, 54424.44030380249, 59917.41369628906, 57719.08674621582, 58526.36678314209, 60547.54005432129, 59381.36681365967, 59673.38029098511, 61405.72692871094, 58341.54726409912, 58804.246643066406, 57923.63353252411, 58287.83370780945, 58054.81330871582, 58891.06018066406, 56375.51339149475, 58537.866775512695, 58760.86016845703, 60225.800148010254, 53428.61334609985, 59781.006927490234, 55626.30020904541, 54075.646841049194, 59261.09356689453, 61349.27394104004, 61102.04020690918, 59484.39352416992, 60489.686880111694, 58019.84696960449, 58193.80662536621, 59603.23323059082, 55570.48697197437, 59803.93341064453, 55728.60697364807, 57929.113204956055, 57800.86709022522, 56268.41360807419, 60787.24676513672, 53094.92016029358, 55456.48679924011, 52797.56012916565, 59094.18029022217, 56442.72036552429, 59248.11996459961, 61684.99365234375, 58632.419982910156], "episode_lengths": [136, 137, 137, 136, 136, 138, 137, 137, 137, 136, 135, 135, 134, 138, 137, 136, 137, 134, 136, 137, 137, 137, 137, 135, 137, 137, 137, 136, 136, 135, 136, 136, 137, 136, 136, 137, 136, 137, 136, 136, 137, 137, 137, 137, 136, 137, 136, 135, 137, 137, 136, 137, 136, 137, 137, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 135, 137, 135, 134, 136, 137, 137, 136, 138, 135, 136, 136, 137, 136, 136, 136, 136, 137, 138, 136, 136, 136, 137, 136, 137, 138, 137], "policy_agent_0_reward": [58754.73388290405, 59701.00700378418, 58067.95359802246, 57520.993562698364, 59369.85348510742, 60064.26693725586, 60206.61357116699, 61249.40675354004, 60244.04029083252, 59609.10006713867, 57524.59362792969, 57464.52684879303, 51036.26683425903, 58762.64665222168, 57006.326988220215, 57177.70032501221, 59441.56703186035, 50440.906785964966, 57457.24692153931, 57788.43370437622, 58883.69349479675, 58748.14027404785, 58776.78059387207, 52323.973346710205, 58748.00668334961, 59382.90007019043, 60952.58044433594, 58920.39324951172, 59580.41360473633, 55171.88690328598, 58242.79341125488, 56330.820068359375, 61049.37371826172, 57980.319885253906, 58823.50700378418, 56896.18028831482, 55436.44007062912, 58347.44688415527, 55423.573612213135, 55959.580121040344, 59650.26693725586, 59904.27359008789, 61244.2802734375, 59572.3935546875, 56121.866859436035, 60377.059997558594, 56104.740268707275, 54424.44030380249, 59917.41369628906, 57719.08674621582, 58526.36678314209, 60547.54005432129, 59381.36681365967, 59673.38029098511, 61405.72692871094, 58341.54726409912, 58804.246643066406, 57923.63353252411, 58287.83370780945, 58054.81330871582, 58891.06018066406, 56375.51339149475, 58537.866775512695, 58760.86016845703, 60225.800148010254, 53428.61334609985, 59781.006927490234, 55626.30020904541, 54075.646841049194, 59261.09356689453, 61349.27394104004, 61102.04020690918, 59484.39352416992, 60489.686880111694, 58019.84696960449, 58193.80662536621, 59603.23323059082, 55570.48697197437, 59803.93341064453, 55728.60697364807, 57929.113204956055, 57800.86709022522, 56268.41360807419, 60787.24676513672, 53094.92016029358, 55456.48679924011, 52797.56012916565, 59094.18029022217, 56442.72036552429, 59248.11996459961, 61684.99365234375, 58632.419982910156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.972251026966752, "mean_inference_ms": 6.766107922849295, "mean_action_processing_ms": 0.19836576547676474, "mean_env_wait_ms": 232.4849398314087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04946278489154318, "StateBufferConnector_ms": 0.010518924049709154, "ViewRequirementAgentConnector_ms": 0.22933742274408755}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.30023055888046, "num_env_steps_trained_throughput_per_sec": 237.30023055888046, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 14087.559, "sample_time_ms": 11180.954, "learn_time_ms": 2757.921, "learn_throughput": 1450.368, "synch_weights_time_ms": 148.032}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 2480, "training_iteration": 85, "trial_id": "32397_00000", "date": "2025-03-21_08-57-49", "timestamp": 1742547469, "time_this_iter_s": 16.908451557159424, "time_total_s": 1241.6418890953064, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1241.6418890953064, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 96.0181818181818, "ram_util_percent": 13.454545454545455}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.951047897338867, "policy_loss": -0.008959010243415833, "vf_loss": 9.9599609375, "vf_explained_var": -6.643434602437992e-08, "kl": 0.007355682086199522, "entropy": 0.3267337679862976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 60061.28017807007, "episode_reward_min": 51022.23991513252, "episode_reward_mean": 56768.57434217632, "episode_len_mean": 135.8125, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51022.23991513252}, "policy_reward_max": {"agent_0": 60061.28017807007}, "policy_reward_mean": {"agent_0": 56768.57434217632}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59620.120376586914, 59893.10040283203, 54292.253611564636, 58792.90673828125, 59010.8533782959, 51022.23991513252, 51663.74694061279, 57514.139976501465, 54980.67372131348, 58055.82015991211, 59436.16677856445, 60061.28017807007, 58045.14666748047, 58229.206928253174, 54893.793432712555, 52785.740268707275], "episode_lengths": [136, 136, 135, 136, 136, 135, 135, 136, 135, 135, 137, 137, 136, 136, 137, 135], "policy_agent_0_reward": [59620.120376586914, 59893.10040283203, 54292.253611564636, 58792.90673828125, 59010.8533782959, 51022.23991513252, 51663.74694061279, 57514.139976501465, 54980.67372131348, 58055.82015991211, 59436.16677856445, 60061.28017807007, 58045.14666748047, 58229.206928253174, 54893.793432712555, 52785.740268707275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.32234687887476, "mean_inference_ms": 6.3606079834454, "mean_action_processing_ms": 0.20078112748190735, "mean_env_wait_ms": 217.38262881313926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764331340789795, "StateBufferConnector_ms": 0.0059410929679870605, "ViewRequirementAgentConnector_ms": 0.230523943901062}}, "episode_reward_max": 60061.28017807007, "episode_reward_min": 51022.23991513252, "episode_reward_mean": 56768.57434217632, "episode_len_mean": 135.8125, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51022.23991513252}, "policy_reward_max": {"agent_0": 60061.28017807007}, "policy_reward_mean": {"agent_0": 56768.57434217632}, "hist_stats": {"episode_reward": [59620.120376586914, 59893.10040283203, 54292.253611564636, 58792.90673828125, 59010.8533782959, 51022.23991513252, 51663.74694061279, 57514.139976501465, 54980.67372131348, 58055.82015991211, 59436.16677856445, 60061.28017807007, 58045.14666748047, 58229.206928253174, 54893.793432712555, 52785.740268707275], "episode_lengths": [136, 136, 135, 136, 136, 135, 135, 136, 135, 135, 137, 137, 136, 136, 137, 135], "policy_agent_0_reward": [59620.120376586914, 59893.10040283203, 54292.253611564636, 58792.90673828125, 59010.8533782959, 51022.23991513252, 51663.74694061279, 57514.139976501465, 54980.67372131348, 58055.82015991211, 59436.16677856445, 60061.28017807007, 58045.14666748047, 58229.206928253174, 54893.793432712555, 52785.740268707275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.32234687887476, "mean_inference_ms": 6.3606079834454, "mean_action_processing_ms": 0.20078112748190735, "mean_env_wait_ms": 217.38262881313926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03764331340789795, "StateBufferConnector_ms": 0.0059410929679870605, "ViewRequirementAgentConnector_ms": 0.230523943901062}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.86260752932276, "num_env_steps_trained_throughput_per_sec": 283.86260752932276, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 14180.793, "sample_time_ms": 11236.943, "learn_time_ms": 2799.234, "learn_throughput": 1428.962, "synch_weights_time_ms": 143.959}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 2496, "training_iteration": 86, "trial_id": "32397_00000", "date": "2025-03-21_08-58-03", "timestamp": 1742547483, "time_this_iter_s": 14.137258052825928, "time_total_s": 1255.7791471481323, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cef9a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1255.7791471481323, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 98.97, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.942000389099121, "policy_loss": -0.011664674617350101, "vf_loss": 9.95361328125, "vf_explained_var": 3.1044086745701804e-10, "kl": 0.008274555206298828, "entropy": 0.32934531569480896, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 60914.613525390625, "episode_reward_min": 49172.37344741821, "episode_reward_mean": 57353.38273509592, "episode_len_mean": 136.4375, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 49172.37344741821}, "policy_reward_max": {"agent_0": 60914.613525390625}, "policy_reward_mean": {"agent_0": 57353.38273509592}, "custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60914.613525390625, 49172.37344741821, 60087.56018257141, 57822.933502197266, 58074.16012573242, 59275.26025009155, 50904.13335132599, 60173.50680541992, 58448.80701255798, 54798.96696126461, 54697.78689956665, 57839.847005844116, 59557.786865234375, 60016.42053222656, 60537.773666381836, 55332.19362831116], "episode_lengths": [137, 135, 137, 137, 136, 136, 135, 137, 137, 136, 136, 137, 137, 137, 137, 136], "policy_agent_0_reward": [60914.613525390625, 49172.37344741821, 60087.56018257141, 57822.933502197266, 58074.16012573242, 59275.26025009155, 50904.13335132599, 60173.50680541992, 58448.80701255798, 54798.96696126461, 54697.78689956665, 57839.847005844116, 59557.786865234375, 60016.42053222656, 60537.773666381836, 55332.19362831116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.81414902143824, "mean_inference_ms": 6.343798276068108, "mean_action_processing_ms": 0.20128575187373626, "mean_env_wait_ms": 216.43397040291586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039921700954437256, "StateBufferConnector_ms": 0.006407499313354492, "ViewRequirementAgentConnector_ms": 0.2503320574760437}}, "episode_reward_max": 60914.613525390625, "episode_reward_min": 49172.37344741821, "episode_reward_mean": 57353.38273509592, "episode_len_mean": 136.4375, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 49172.37344741821}, "policy_reward_max": {"agent_0": 60914.613525390625}, "policy_reward_mean": {"agent_0": 57353.38273509592}, "hist_stats": {"episode_reward": [60914.613525390625, 49172.37344741821, 60087.56018257141, 57822.933502197266, 58074.16012573242, 59275.26025009155, 50904.13335132599, 60173.50680541992, 58448.80701255798, 54798.96696126461, 54697.78689956665, 57839.847005844116, 59557.786865234375, 60016.42053222656, 60537.773666381836, 55332.19362831116], "episode_lengths": [137, 135, 137, 137, 136, 136, 135, 137, 137, 136, 136, 137, 137, 137, 137, 136], "policy_agent_0_reward": [60914.613525390625, 49172.37344741821, 60087.56018257141, 57822.933502197266, 58074.16012573242, 59275.26025009155, 50904.13335132599, 60173.50680541992, 58448.80701255798, 54798.96696126461, 54697.78689956665, 57839.847005844116, 59557.786865234375, 60016.42053222656, 60537.773666381836, 55332.19362831116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.81414902143824, "mean_inference_ms": 6.343798276068108, "mean_action_processing_ms": 0.20128575187373626, "mean_env_wait_ms": 216.43397040291586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039921700954437256, "StateBufferConnector_ms": 0.006407499313354492, "ViewRequirementAgentConnector_ms": 0.2503320574760437}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.23206815147165, "num_env_steps_trained_throughput_per_sec": 274.23206815147165, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 14051.649, "sample_time_ms": 11081.668, "learn_time_ms": 2831.489, "learn_throughput": 1412.684, "synch_weights_time_ms": 137.83}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 2512, "training_iteration": 87, "trial_id": "32397_00000", "date": "2025-03-21_08-58-18", "timestamp": 1742547498, "time_this_iter_s": 14.637261152267456, "time_total_s": 1270.4164083003998, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19dbc670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1270.4164083003998, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 99.41904761904763, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982844352722168, "policy_loss": -0.014533834531903267, "vf_loss": 9.997314453125, "vf_explained_var": 9.226302211118309e-08, "kl": 0.01008974015712738, "entropy": 0.3095760643482208, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 55332.19362831116, "episode_reward_min": 55332.19362831116, "episode_reward_mean": 55332.19362831116, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55332.19362831116}, "policy_reward_max": {"agent_0": 55332.19362831116}, "policy_reward_mean": {"agent_0": 55332.19362831116}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55332.19362831116], "episode_lengths": [136], "policy_agent_0_reward": [55332.19362831116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.43971226939252, "mean_inference_ms": 6.158733766391085, "mean_action_processing_ms": 0.20576038068383518, "mean_env_wait_ms": 217.4149267686775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039839744567871094, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.16472339630126953}}, "episode_reward_max": 55332.19362831116, "episode_reward_min": 55332.19362831116, "episode_reward_mean": 55332.19362831116, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55332.19362831116}, "policy_reward_max": {"agent_0": 55332.19362831116}, "policy_reward_mean": {"agent_0": 55332.19362831116}, "hist_stats": {"episode_reward": [55332.19362831116], "episode_lengths": [136], "policy_agent_0_reward": [55332.19362831116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.43971226939252, "mean_inference_ms": 6.158733766391085, "mean_action_processing_ms": 0.20576038068383518, "mean_env_wait_ms": 217.4149267686775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039839744567871094, "StateBufferConnector_ms": 0.006127357482910156, "ViewRequirementAgentConnector_ms": 0.16472339630126953}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.9913368640747, "num_env_steps_trained_throughput_per_sec": 314.9913368640747, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 13938.164, "sample_time_ms": 10942.022, "learn_time_ms": 2858.277, "learn_throughput": 1399.444, "synch_weights_time_ms": 137.202}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 2512, "training_iteration": 88, "trial_id": "32397_00000", "date": "2025-03-21_08-58-31", "timestamp": 1742547511, "time_this_iter_s": 12.754873275756836, "time_total_s": 1283.1712815761566, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb85e5f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1283.1712815761566, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 99.58333333333334, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.761627197265625, "policy_loss": -0.010877585038542747, "vf_loss": 9.7724609375, "vf_explained_var": -3.530954302277678e-07, "kl": 0.007049395237118006, "entropy": 0.29148733615875244, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 62321.03366088867, "episode_reward_min": 48167.59372615814, "episode_reward_mean": 57441.35594928394, "episode_len_mean": 136.2826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 48167.59372615814}, "policy_reward_max": {"agent_0": 62321.03366088867}, "policy_reward_mean": {"agent_0": 57441.35594928394}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59575.60012817383, 56467.74697113037, 59857.473571777344, 57007.38687133789, 54706.33340072632, 58575.06721496582, 58592.26016616821, 57778.133544921875, 55782.60009765625, 58622.06041908264, 56847.7600402832, 50837.50019836426, 57165.95378112793, 59267.22706604004, 60607.780364990234, 58546.973571777344, 58211.233476638794, 54857.35345077515, 62321.03366088867, 55975.64018058777, 60643.080078125, 58937.560150146484, 61193.87365913391, 60553.600381851196, 55220.79334640503, 59514.160400390625, 58857.060470581055, 57314.84704589844, 58279.23352050781, 57334.426696777344, 59392.90692138672, 58187.65351867676, 50878.046636104584, 57408.68014526367, 57967.17354774475, 59967.526947021484, 54886.75354003906, 55867.35350418091, 58743.120277404785, 56177.686866760254, 55588.42668914795, 53122.19368350506, 59743.12053108215, 59146.28028869629, 57915.153593063354, 58937.333435058594, 49473.686700582504, 59118.08674621582, 62140.83364868164, 59719.63348388672, 57737.40009689331, 57950.79360771179, 60981.66711425781, 59640.95999145508, 54175.8468875885, 58127.62672042847, 59277.04684448242, 57611.053367614746, 58420.8335609436, 58984.10032081604, 56898.10654449463, 58581.766845703125, 59529.60678100586, 60318.9137878418, 57338.97384643555, 48696.300090789795, 56252.08037185669, 53229.66008853912, 59477.860092163086, 54653.873556137085, 58728.900161743164, 57300.42007064819, 56386.93359375, 54891.87361049652, 60457.3203125, 60137.800354003906, 58813.87355041504, 59327.78030395508, 56889.38006591797, 52472.22015571594, 58524.687019348145, 60035.10696411133, 56996.04689788818, 57105.460372924805, 57639.18697929382, 57807.8934173584, 60938.920486450195, 54071.14050245285, 52970.85333156586, 48167.59372615814, 56055.98678588867, 57167.49352264404], "episode_lengths": [137, 137, 137, 135, 136, 137, 136, 136, 135, 136, 136, 135, 136, 137, 137, 136, 137, 136, 138, 136, 138, 137, 137, 137, 135, 136, 137, 136, 136, 136, 137, 136, 135, 136, 136, 138, 136, 136, 137, 136, 136, 135, 137, 137, 137, 136, 135, 136, 137, 137, 138, 136, 138, 136, 135, 137, 136, 137, 136, 138, 135, 137, 137, 137, 137, 135, 136, 135, 137, 135, 137, 137, 136, 136, 137, 137, 137, 136, 135, 135, 135, 136, 136, 137, 136, 136, 138, 135, 136, 135, 134, 136], "policy_agent_0_reward": [59575.60012817383, 56467.74697113037, 59857.473571777344, 57007.38687133789, 54706.33340072632, 58575.06721496582, 58592.26016616821, 57778.133544921875, 55782.60009765625, 58622.06041908264, 56847.7600402832, 50837.50019836426, 57165.95378112793, 59267.22706604004, 60607.780364990234, 58546.973571777344, 58211.233476638794, 54857.35345077515, 62321.03366088867, 55975.64018058777, 60643.080078125, 58937.560150146484, 61193.87365913391, 60553.600381851196, 55220.79334640503, 59514.160400390625, 58857.060470581055, 57314.84704589844, 58279.23352050781, 57334.426696777344, 59392.90692138672, 58187.65351867676, 50878.046636104584, 57408.68014526367, 57967.17354774475, 59967.526947021484, 54886.75354003906, 55867.35350418091, 58743.120277404785, 56177.686866760254, 55588.42668914795, 53122.19368350506, 59743.12053108215, 59146.28028869629, 57915.153593063354, 58937.333435058594, 49473.686700582504, 59118.08674621582, 62140.83364868164, 59719.63348388672, 57737.40009689331, 57950.79360771179, 60981.66711425781, 59640.95999145508, 54175.8468875885, 58127.62672042847, 59277.04684448242, 57611.053367614746, 58420.8335609436, 58984.10032081604, 56898.10654449463, 58581.766845703125, 59529.60678100586, 60318.9137878418, 57338.97384643555, 48696.300090789795, 56252.08037185669, 53229.66008853912, 59477.860092163086, 54653.873556137085, 58728.900161743164, 57300.42007064819, 56386.93359375, 54891.87361049652, 60457.3203125, 60137.800354003906, 58813.87355041504, 59327.78030395508, 56889.38006591797, 52472.22015571594, 58524.687019348145, 60035.10696411133, 56996.04689788818, 57105.460372924805, 57639.18697929382, 57807.8934173584, 60938.920486450195, 54071.14050245285, 52970.85333156586, 48167.59372615814, 56055.98678588867, 57167.49352264404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.936804235220762, "mean_inference_ms": 6.781946431712337, "mean_action_processing_ms": 0.1983211154635896, "mean_env_wait_ms": 232.39228396587666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03871036612469217, "StateBufferConnector_ms": 0.00610507052877675, "ViewRequirementAgentConnector_ms": 0.21374795747839886}}, "episode_reward_max": 62321.03366088867, "episode_reward_min": 48167.59372615814, "episode_reward_mean": 57441.35594928394, "episode_len_mean": 136.2826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 48167.59372615814}, "policy_reward_max": {"agent_0": 62321.03366088867}, "policy_reward_mean": {"agent_0": 57441.35594928394}, "hist_stats": {"episode_reward": [59575.60012817383, 56467.74697113037, 59857.473571777344, 57007.38687133789, 54706.33340072632, 58575.06721496582, 58592.26016616821, 57778.133544921875, 55782.60009765625, 58622.06041908264, 56847.7600402832, 50837.50019836426, 57165.95378112793, 59267.22706604004, 60607.780364990234, 58546.973571777344, 58211.233476638794, 54857.35345077515, 62321.03366088867, 55975.64018058777, 60643.080078125, 58937.560150146484, 61193.87365913391, 60553.600381851196, 55220.79334640503, 59514.160400390625, 58857.060470581055, 57314.84704589844, 58279.23352050781, 57334.426696777344, 59392.90692138672, 58187.65351867676, 50878.046636104584, 57408.68014526367, 57967.17354774475, 59967.526947021484, 54886.75354003906, 55867.35350418091, 58743.120277404785, 56177.686866760254, 55588.42668914795, 53122.19368350506, 59743.12053108215, 59146.28028869629, 57915.153593063354, 58937.333435058594, 49473.686700582504, 59118.08674621582, 62140.83364868164, 59719.63348388672, 57737.40009689331, 57950.79360771179, 60981.66711425781, 59640.95999145508, 54175.8468875885, 58127.62672042847, 59277.04684448242, 57611.053367614746, 58420.8335609436, 58984.10032081604, 56898.10654449463, 58581.766845703125, 59529.60678100586, 60318.9137878418, 57338.97384643555, 48696.300090789795, 56252.08037185669, 53229.66008853912, 59477.860092163086, 54653.873556137085, 58728.900161743164, 57300.42007064819, 56386.93359375, 54891.87361049652, 60457.3203125, 60137.800354003906, 58813.87355041504, 59327.78030395508, 56889.38006591797, 52472.22015571594, 58524.687019348145, 60035.10696411133, 56996.04689788818, 57105.460372924805, 57639.18697929382, 57807.8934173584, 60938.920486450195, 54071.14050245285, 52970.85333156586, 48167.59372615814, 56055.98678588867, 57167.49352264404], "episode_lengths": [137, 137, 137, 135, 136, 137, 136, 136, 135, 136, 136, 135, 136, 137, 137, 136, 137, 136, 138, 136, 138, 137, 137, 137, 135, 136, 137, 136, 136, 136, 137, 136, 135, 136, 136, 138, 136, 136, 137, 136, 136, 135, 137, 137, 137, 136, 135, 136, 137, 137, 138, 136, 138, 136, 135, 137, 136, 137, 136, 138, 135, 137, 137, 137, 137, 135, 136, 135, 137, 135, 137, 137, 136, 136, 137, 137, 137, 136, 135, 135, 135, 136, 136, 137, 136, 136, 138, 135, 136, 135, 134, 136], "policy_agent_0_reward": [59575.60012817383, 56467.74697113037, 59857.473571777344, 57007.38687133789, 54706.33340072632, 58575.06721496582, 58592.26016616821, 57778.133544921875, 55782.60009765625, 58622.06041908264, 56847.7600402832, 50837.50019836426, 57165.95378112793, 59267.22706604004, 60607.780364990234, 58546.973571777344, 58211.233476638794, 54857.35345077515, 62321.03366088867, 55975.64018058777, 60643.080078125, 58937.560150146484, 61193.87365913391, 60553.600381851196, 55220.79334640503, 59514.160400390625, 58857.060470581055, 57314.84704589844, 58279.23352050781, 57334.426696777344, 59392.90692138672, 58187.65351867676, 50878.046636104584, 57408.68014526367, 57967.17354774475, 59967.526947021484, 54886.75354003906, 55867.35350418091, 58743.120277404785, 56177.686866760254, 55588.42668914795, 53122.19368350506, 59743.12053108215, 59146.28028869629, 57915.153593063354, 58937.333435058594, 49473.686700582504, 59118.08674621582, 62140.83364868164, 59719.63348388672, 57737.40009689331, 57950.79360771179, 60981.66711425781, 59640.95999145508, 54175.8468875885, 58127.62672042847, 59277.04684448242, 57611.053367614746, 58420.8335609436, 58984.10032081604, 56898.10654449463, 58581.766845703125, 59529.60678100586, 60318.9137878418, 57338.97384643555, 48696.300090789795, 56252.08037185669, 53229.66008853912, 59477.860092163086, 54653.873556137085, 58728.900161743164, 57300.42007064819, 56386.93359375, 54891.87361049652, 60457.3203125, 60137.800354003906, 58813.87355041504, 59327.78030395508, 56889.38006591797, 52472.22015571594, 58524.687019348145, 60035.10696411133, 56996.04689788818, 57105.460372924805, 57639.18697929382, 57807.8934173584, 60938.920486450195, 54071.14050245285, 52970.85333156586, 48167.59372615814, 56055.98678588867, 57167.49352264404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.936804235220762, "mean_inference_ms": 6.781946431712337, "mean_action_processing_ms": 0.1983211154635896, "mean_env_wait_ms": 232.39228396587666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03871036612469217, "StateBufferConnector_ms": 0.00610507052877675, "ViewRequirementAgentConnector_ms": 0.21374795747839886}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.28420898159166, "num_env_steps_trained_throughput_per_sec": 243.28420898159166, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 14271.813, "sample_time_ms": 11292.825, "learn_time_ms": 2841.925, "learn_throughput": 1407.497, "synch_weights_time_ms": 136.39}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 2604, "training_iteration": 89, "trial_id": "32397_00000", "date": "2025-03-21_08-58-47", "timestamp": 1742547527, "time_this_iter_s": 16.5080509185791, "time_total_s": 1299.6793324947357, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb85fd00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1299.6793324947357, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 96.72727272727273, "ram_util_percent": 13.481818181818182}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983168601989746, "policy_loss": -0.00955226831138134, "vf_loss": 9.99267578125, "vf_explained_var": 4.5013923255510235e-08, "kl": 0.007228275761008263, "entropy": 0.28798359632492065, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 61710.966857910156, "episode_reward_min": 53424.40684509277, "episode_reward_mean": 57963.80911763509, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 53424.40684509277}, "policy_reward_max": {"agent_0": 61710.966857910156}, "policy_reward_mean": {"agent_0": 57963.80911763509}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [61710.966857910156, 53424.40684509277, 58756.053649902344], "episode_lengths": [137, 135, 136], "policy_agent_0_reward": [61710.966857910156, 53424.40684509277, 58756.053649902344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.467797000627789, "mean_inference_ms": 6.477363446900223, "mean_action_processing_ms": 0.1996041521217691, "mean_env_wait_ms": 218.24239004638665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035190582275390625, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.1567681630452474}}, "episode_reward_max": 61710.966857910156, "episode_reward_min": 53424.40684509277, "episode_reward_mean": 57963.80911763509, "episode_len_mean": 136.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 53424.40684509277}, "policy_reward_max": {"agent_0": 61710.966857910156}, "policy_reward_mean": {"agent_0": 57963.80911763509}, "hist_stats": {"episode_reward": [61710.966857910156, 53424.40684509277, 58756.053649902344], "episode_lengths": [137, 135, 136], "policy_agent_0_reward": [61710.966857910156, 53424.40684509277, 58756.053649902344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.467797000627789, "mean_inference_ms": 6.477363446900223, "mean_action_processing_ms": 0.1996041521217691, "mean_env_wait_ms": 218.24239004638665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035190582275390625, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.1567681630452474}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.9167042100946, "num_env_steps_trained_throughput_per_sec": 347.9167042100946, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 14157.482, "sample_time_ms": 11232.854, "learn_time_ms": 2792.463, "learn_throughput": 1432.427, "synch_weights_time_ms": 131.507}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 2607, "training_iteration": 90, "trial_id": "32397_00000", "date": "2025-03-21_08-58-59", "timestamp": 1742547539, "time_this_iter_s": 11.550178527832031, "time_total_s": 1311.2295110225677, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19cedd80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1311.2295110225677, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 99.37647058823529, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.310344827586207, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.915997505187988, "policy_loss": -0.006902581546455622, "vf_loss": 9.9228515625, "vf_explained_var": 6.339202229810326e-08, "kl": 0.007532587740570307, "entropy": 0.30854830145835876, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 61066.83354187012, "episode_reward_min": 50712.32685756683, "episode_reward_mean": 57372.63358222616, "episode_len_mean": 136.51724137931035, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 50712.32685756683}, "policy_reward_max": {"agent_0": 61066.83354187012}, "policy_reward_mean": {"agent_0": 57372.63358222616}, "custom_metrics": {"num_batches_mean": 5.310344827586207, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59789.76040649414, 57918.11344909668, 54942.3537902832, 59060.92691040039, 58030.28027057648, 58590.54031038284, 57276.92025756836, 60538.16678237915, 60253.37367248535, 59063.67346191406, 50712.32685756683, 58965.12672328949, 56096.140312194824, 60676.113342285156, 57815.63349914551, 59675.95376586914, 51792.77369213104, 53484.613679885864, 61066.83354187012, 56872.259947776794, 56788.000259399414, 59698.27359008789, 54274.84024143219, 60462.50033569336, 54394.51390838623, 59894.506927490234, 55446.46034049988, 56646.433406829834, 53578.96020114422], "episode_lengths": [137, 137, 136, 137, 137, 136, 136, 138, 137, 137, 136, 137, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 137, 136, 136, 136], "policy_agent_0_reward": [59789.76040649414, 57918.11344909668, 54942.3537902832, 59060.92691040039, 58030.28027057648, 58590.54031038284, 57276.92025756836, 60538.16678237915, 60253.37367248535, 59063.67346191406, 50712.32685756683, 58965.12672328949, 56096.140312194824, 60676.113342285156, 57815.63349914551, 59675.95376586914, 51792.77369213104, 53484.613679885864, 61066.83354187012, 56872.259947776794, 56788.000259399414, 59698.27359008789, 54274.84024143219, 60462.50033569336, 54394.51390838623, 59894.506927490234, 55446.46034049988, 56646.433406829834, 53578.96020114422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.805796450155107, "mean_inference_ms": 6.371055261738138, "mean_action_processing_ms": 0.2009333222741852, "mean_env_wait_ms": 216.84499958876356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07359734896955819, "StateBufferConnector_ms": 0.006182440396012931, "ViewRequirementAgentConnector_ms": 0.1790646849007442}}, "episode_reward_max": 61066.83354187012, "episode_reward_min": 50712.32685756683, "episode_reward_mean": 57372.63358222616, "episode_len_mean": 136.51724137931035, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 50712.32685756683}, "policy_reward_max": {"agent_0": 61066.83354187012}, "policy_reward_mean": {"agent_0": 57372.63358222616}, "hist_stats": {"episode_reward": [59789.76040649414, 57918.11344909668, 54942.3537902832, 59060.92691040039, 58030.28027057648, 58590.54031038284, 57276.92025756836, 60538.16678237915, 60253.37367248535, 59063.67346191406, 50712.32685756683, 58965.12672328949, 56096.140312194824, 60676.113342285156, 57815.63349914551, 59675.95376586914, 51792.77369213104, 53484.613679885864, 61066.83354187012, 56872.259947776794, 56788.000259399414, 59698.27359008789, 54274.84024143219, 60462.50033569336, 54394.51390838623, 59894.506927490234, 55446.46034049988, 56646.433406829834, 53578.96020114422], "episode_lengths": [137, 137, 136, 137, 137, 136, 136, 138, 137, 137, 136, 137, 137, 137, 136, 137, 136, 136, 137, 136, 136, 136, 136, 137, 136, 137, 136, 136, 136], "policy_agent_0_reward": [59789.76040649414, 57918.11344909668, 54942.3537902832, 59060.92691040039, 58030.28027057648, 58590.54031038284, 57276.92025756836, 60538.16678237915, 60253.37367248535, 59063.67346191406, 50712.32685756683, 58965.12672328949, 56096.140312194824, 60676.113342285156, 57815.63349914551, 59675.95376586914, 51792.77369213104, 53484.613679885864, 61066.83354187012, 56872.259947776794, 56788.000259399414, 59698.27359008789, 54274.84024143219, 60462.50033569336, 54394.51390838623, 59894.506927490234, 55446.46034049988, 56646.433406829834, 53578.96020114422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.805796450155107, "mean_inference_ms": 6.371055261738138, "mean_action_processing_ms": 0.2009333222741852, "mean_env_wait_ms": 216.84499958876356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07359734896955819, "StateBufferConnector_ms": 0.006182440396012931, "ViewRequirementAgentConnector_ms": 0.1790646849007442}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.83678177439776, "num_env_steps_trained_throughput_per_sec": 258.83678177439776, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 14029.108, "sample_time_ms": 11068.335, "learn_time_ms": 2823.77, "learn_throughput": 1416.546, "synch_weights_time_ms": 136.333}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 2636, "training_iteration": 91, "trial_id": "32397_00000", "date": "2025-03-21_08-59-14", "timestamp": 1742547554, "time_this_iter_s": 15.506304502487183, "time_total_s": 1326.735815525055, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1326.735815525055, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 99.34285714285713, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988972663879395, "policy_loss": -0.008643491193652153, "vf_loss": 9.99756908416748, "vf_explained_var": -4.12575900554657e-07, "kl": 0.007621794007718563, "entropy": 0.34177982807159424, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 53578.96020114422, "episode_reward_min": 53578.96020114422, "episode_reward_mean": 53578.96020114422, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53578.96020114422}, "policy_reward_max": {"agent_0": 53578.96020114422}, "policy_reward_mean": {"agent_0": 53578.96020114422}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53578.96020114422], "episode_lengths": [136], "policy_agent_0_reward": [53578.96020114422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.47835044124314, "mean_inference_ms": 6.074622848856148, "mean_action_processing_ms": 0.19356667916085846, "mean_env_wait_ms": 224.06010145194998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03895759582519531, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.170135498046875}}, "episode_reward_max": 53578.96020114422, "episode_reward_min": 53578.96020114422, "episode_reward_mean": 53578.96020114422, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53578.96020114422}, "policy_reward_max": {"agent_0": 53578.96020114422}, "policy_reward_mean": {"agent_0": 53578.96020114422}, "hist_stats": {"episode_reward": [53578.96020114422], "episode_lengths": [136], "policy_agent_0_reward": [53578.96020114422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.47835044124314, "mean_inference_ms": 6.074622848856148, "mean_action_processing_ms": 0.19356667916085846, "mean_env_wait_ms": 224.06010145194998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03895759582519531, "StateBufferConnector_ms": 0.006031990051269531, "ViewRequirementAgentConnector_ms": 0.170135498046875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.7519704378968, "num_env_steps_trained_throughput_per_sec": 320.7519704378968, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 13994.42, "sample_time_ms": 11020.99, "learn_time_ms": 2837.405, "learn_throughput": 1409.739, "synch_weights_time_ms": 135.358}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 2636, "training_iteration": 92, "trial_id": "32397_00000", "date": "2025-03-21_08-59-27", "timestamp": 1742547567, "time_this_iter_s": 12.509573698043823, "time_total_s": 1339.2453892230988, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942a70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1339.2453892230988, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 99.53888888888889, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.83470630645752, "policy_loss": -0.01013481616973877, "vf_loss": 9.844781875610352, "vf_explained_var": -5.067636834610312e-07, "kl": 0.00954035297036171, "entropy": 0.3248628079891205, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 62122.76678466797, "episode_reward_min": 50726.426681518555, "episode_reward_mean": 57169.84987196326, "episode_len_mean": 136.29032258064515, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {"agent_0": 50726.426681518555}, "policy_reward_max": {"agent_0": 62122.76678466797}, "policy_reward_mean": {"agent_0": 57169.84987196326}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56631.760457992554, 59963.780364990234, 55019.7467880249, 60103.719955444336, 51977.86014032364, 55371.78009033203, 52743.71336746216, 59856.68717956543, 51212.92675065994, 59459.10708618164, 56934.280197143555, 57446.26025617123, 62122.76678466797, 58491.9802570343, 60516.18032836914, 52985.500186920166, 58891.766845703125, 54111.173526763916, 52736.20013999939, 59131.367179870605, 54114.75344085693, 60116.38021850586, 57714.80011367798, 53576.4468255043, 58233.8200378418, 56379.82033443451, 57084.20674133301, 57129.40684509277, 52650.56692123413, 58802.647033691406, 58143.21354675293, 57723.5202331543, 61606.39357757568, 58666.953411102295, 55900.84674966335, 58540.52042675018, 59849.846950531006, 60027.246810913086, 59387.313232421875, 56148.93353945017, 59356.62728881836, 58053.16668319702, 54335.40685081482, 57660.493476867676, 54135.97342157364, 51862.42695426941, 56351.353355407715, 60775.26022338867, 58766.82697868347, 50726.426681518555, 57611.8798828125, 60613.073417663574, 57734.96688556671, 59776.793533325195, 57095.30701446533, 60659.04682159424, 56601.40677833557, 59256.99349975586, 54775.40036392212, 58261.38013410568, 56101.11344528198, 56513.17349624634], "episode_lengths": [137, 136, 135, 137, 134, 135, 135, 137, 135, 137, 136, 136, 138, 137, 137, 135, 137, 135, 135, 137, 135, 137, 136, 135, 137, 137, 137, 136, 135, 136, 136, 136, 139, 137, 136, 137, 137, 138, 136, 137, 135, 137, 136, 136, 136, 136, 135, 137, 137, 134, 136, 138, 136, 137, 137, 138, 137, 137, 135, 137, 136, 136], "policy_agent_0_reward": [56631.760457992554, 59963.780364990234, 55019.7467880249, 60103.719955444336, 51977.86014032364, 55371.78009033203, 52743.71336746216, 59856.68717956543, 51212.92675065994, 59459.10708618164, 56934.280197143555, 57446.26025617123, 62122.76678466797, 58491.9802570343, 60516.18032836914, 52985.500186920166, 58891.766845703125, 54111.173526763916, 52736.20013999939, 59131.367179870605, 54114.75344085693, 60116.38021850586, 57714.80011367798, 53576.4468255043, 58233.8200378418, 56379.82033443451, 57084.20674133301, 57129.40684509277, 52650.56692123413, 58802.647033691406, 58143.21354675293, 57723.5202331543, 61606.39357757568, 58666.953411102295, 55900.84674966335, 58540.52042675018, 59849.846950531006, 60027.246810913086, 59387.313232421875, 56148.93353945017, 59356.62728881836, 58053.16668319702, 54335.40685081482, 57660.493476867676, 54135.97342157364, 51862.42695426941, 56351.353355407715, 60775.26022338867, 58766.82697868347, 50726.426681518555, 57611.8798828125, 60613.073417663574, 57734.96688556671, 59776.793533325195, 57095.30701446533, 60659.04682159424, 56601.40677833557, 59256.99349975586, 54775.40036392212, 58261.38013410568, 56101.11344528198, 56513.17349624634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.23588038255028, "mean_inference_ms": 6.7843216963712445, "mean_action_processing_ms": 0.19815344207354288, "mean_env_wait_ms": 233.05649389734904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043346804957236015, "StateBufferConnector_ms": 0.018759312168244394, "ViewRequirementAgentConnector_ms": 0.17056042148220923}}, "episode_reward_max": 62122.76678466797, "episode_reward_min": 50726.426681518555, "episode_reward_mean": 57169.84987196326, "episode_len_mean": 136.29032258064515, "episodes_this_iter": 62, "policy_reward_min": {"agent_0": 50726.426681518555}, "policy_reward_max": {"agent_0": 62122.76678466797}, "policy_reward_mean": {"agent_0": 57169.84987196326}, "hist_stats": {"episode_reward": [56631.760457992554, 59963.780364990234, 55019.7467880249, 60103.719955444336, 51977.86014032364, 55371.78009033203, 52743.71336746216, 59856.68717956543, 51212.92675065994, 59459.10708618164, 56934.280197143555, 57446.26025617123, 62122.76678466797, 58491.9802570343, 60516.18032836914, 52985.500186920166, 58891.766845703125, 54111.173526763916, 52736.20013999939, 59131.367179870605, 54114.75344085693, 60116.38021850586, 57714.80011367798, 53576.4468255043, 58233.8200378418, 56379.82033443451, 57084.20674133301, 57129.40684509277, 52650.56692123413, 58802.647033691406, 58143.21354675293, 57723.5202331543, 61606.39357757568, 58666.953411102295, 55900.84674966335, 58540.52042675018, 59849.846950531006, 60027.246810913086, 59387.313232421875, 56148.93353945017, 59356.62728881836, 58053.16668319702, 54335.40685081482, 57660.493476867676, 54135.97342157364, 51862.42695426941, 56351.353355407715, 60775.26022338867, 58766.82697868347, 50726.426681518555, 57611.8798828125, 60613.073417663574, 57734.96688556671, 59776.793533325195, 57095.30701446533, 60659.04682159424, 56601.40677833557, 59256.99349975586, 54775.40036392212, 58261.38013410568, 56101.11344528198, 56513.17349624634], "episode_lengths": [137, 136, 135, 137, 134, 135, 135, 137, 135, 137, 136, 136, 138, 137, 137, 135, 137, 135, 135, 137, 135, 137, 136, 135, 137, 137, 137, 136, 135, 136, 136, 136, 139, 137, 136, 137, 137, 138, 136, 137, 135, 137, 136, 136, 136, 136, 135, 137, 137, 134, 136, 138, 136, 137, 137, 138, 137, 137, 135, 137, 136, 136], "policy_agent_0_reward": [56631.760457992554, 59963.780364990234, 55019.7467880249, 60103.719955444336, 51977.86014032364, 55371.78009033203, 52743.71336746216, 59856.68717956543, 51212.92675065994, 59459.10708618164, 56934.280197143555, 57446.26025617123, 62122.76678466797, 58491.9802570343, 60516.18032836914, 52985.500186920166, 58891.766845703125, 54111.173526763916, 52736.20013999939, 59131.367179870605, 54114.75344085693, 60116.38021850586, 57714.80011367798, 53576.4468255043, 58233.8200378418, 56379.82033443451, 57084.20674133301, 57129.40684509277, 52650.56692123413, 58802.647033691406, 58143.21354675293, 57723.5202331543, 61606.39357757568, 58666.953411102295, 55900.84674966335, 58540.52042675018, 59849.846950531006, 60027.246810913086, 59387.313232421875, 56148.93353945017, 59356.62728881836, 58053.16668319702, 54335.40685081482, 57660.493476867676, 54135.97342157364, 51862.42695426941, 56351.353355407715, 60775.26022338867, 58766.82697868347, 50726.426681518555, 57611.8798828125, 60613.073417663574, 57734.96688556671, 59776.793533325195, 57095.30701446533, 60659.04682159424, 56601.40677833557, 59256.99349975586, 54775.40036392212, 58261.38013410568, 56101.11344528198, 56513.17349624634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.23588038255028, "mean_inference_ms": 6.7843216963712445, "mean_action_processing_ms": 0.19815344207354288, "mean_env_wait_ms": 233.05649389734904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043346804957236015, "StateBufferConnector_ms": 0.018759312168244394, "ViewRequirementAgentConnector_ms": 0.17056042148220923}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.1765403778577, "num_env_steps_trained_throughput_per_sec": 297.1765403778577, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 14013.711, "sample_time_ms": 11105.753, "learn_time_ms": 2770.18, "learn_throughput": 1443.95, "synch_weights_time_ms": 137.118}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 2698, "training_iteration": 93, "trial_id": "32397_00000", "date": "2025-03-21_08-59-41", "timestamp": 1742547581, "time_this_iter_s": 13.51190996170044, "time_total_s": 1352.7572991847992, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb85eef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1352.7572991847992, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 97.67368421052633, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.935483870967742, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.913751602172852, "policy_loss": -0.008669819682836533, "vf_loss": 9.92236328125, "vf_explained_var": -4.734843912501674e-07, "kl": 0.00916318129748106, "entropy": 0.32508379220962524, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 61740.58694458008, "episode_reward_min": 50408.466829776764, "episode_reward_mean": 57051.359775181736, "episode_len_mean": 136.25806451612902, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 50408.466829776764}, "policy_reward_max": {"agent_0": 61740.58694458008}, "policy_reward_mean": {"agent_0": 57051.359775181736}, "custom_metrics": {"num_batches_mean": 5.935483870967742, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53382.073479413986, 56437.95339012146, 58597.91362512112, 57086.17335510254, 57276.07359313965, 53405.42708969116, 60994.707260131836, 54961.62008476257, 55369.567034721375, 60773.09371948242, 59157.153606414795, 58012.47359466553, 58519.20671081543, 54235.14686393738, 58319.4133605957, 57763.7601442337, 53845.1535936594, 57822.65352630615, 61740.58694458008, 57379.38659667969, 59481.21354675293, 58008.646881103516, 59647.653564453125, 59683.45339488983, 53047.35374832153, 56533.533588409424, 56402.64032173157, 56172.493295669556, 50408.466829776764, 58636.05333709717, 55491.10694885254], "episode_lengths": [134, 136, 137, 136, 137, 135, 137, 135, 137, 137, 138, 137, 136, 136, 137, 136, 136, 137, 138, 136, 136, 136, 137, 137, 136, 136, 136, 137, 134, 136, 135], "policy_agent_0_reward": [53382.073479413986, 56437.95339012146, 58597.91362512112, 57086.17335510254, 57276.07359313965, 53405.42708969116, 60994.707260131836, 54961.62008476257, 55369.567034721375, 60773.09371948242, 59157.153606414795, 58012.47359466553, 58519.20671081543, 54235.14686393738, 58319.4133605957, 57763.7601442337, 53845.1535936594, 57822.65352630615, 61740.58694458008, 57379.38659667969, 59481.21354675293, 58008.646881103516, 59647.653564453125, 59683.45339488983, 53047.35374832153, 56533.533588409424, 56402.64032173157, 56172.493295669556, 50408.466829776764, 58636.05333709717, 55491.10694885254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.904103635738768, "mean_inference_ms": 6.770174447978618, "mean_action_processing_ms": 0.19824664354671082, "mean_env_wait_ms": 231.04090138973618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0480574946249685, "StateBufferConnector_ms": 0.006100439256237399, "ViewRequirementAgentConnector_ms": 0.19031878440610825}}, "episode_reward_max": 61740.58694458008, "episode_reward_min": 50408.466829776764, "episode_reward_mean": 57051.359775181736, "episode_len_mean": 136.25806451612902, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 50408.466829776764}, "policy_reward_max": {"agent_0": 61740.58694458008}, "policy_reward_mean": {"agent_0": 57051.359775181736}, "hist_stats": {"episode_reward": [53382.073479413986, 56437.95339012146, 58597.91362512112, 57086.17335510254, 57276.07359313965, 53405.42708969116, 60994.707260131836, 54961.62008476257, 55369.567034721375, 60773.09371948242, 59157.153606414795, 58012.47359466553, 58519.20671081543, 54235.14686393738, 58319.4133605957, 57763.7601442337, 53845.1535936594, 57822.65352630615, 61740.58694458008, 57379.38659667969, 59481.21354675293, 58008.646881103516, 59647.653564453125, 59683.45339488983, 53047.35374832153, 56533.533588409424, 56402.64032173157, 56172.493295669556, 50408.466829776764, 58636.05333709717, 55491.10694885254], "episode_lengths": [134, 136, 137, 136, 137, 135, 137, 135, 137, 137, 138, 137, 136, 136, 137, 136, 136, 137, 138, 136, 136, 136, 137, 137, 136, 136, 136, 137, 134, 136, 135], "policy_agent_0_reward": [53382.073479413986, 56437.95339012146, 58597.91362512112, 57086.17335510254, 57276.07359313965, 53405.42708969116, 60994.707260131836, 54961.62008476257, 55369.567034721375, 60773.09371948242, 59157.153606414795, 58012.47359466553, 58519.20671081543, 54235.14686393738, 58319.4133605957, 57763.7601442337, 53845.1535936594, 57822.65352630615, 61740.58694458008, 57379.38659667969, 59481.21354675293, 58008.646881103516, 59647.653564453125, 59683.45339488983, 53047.35374832153, 56533.533588409424, 56402.64032173157, 56172.493295669556, 50408.466829776764, 58636.05333709717, 55491.10694885254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.904103635738768, "mean_inference_ms": 6.770174447978618, "mean_action_processing_ms": 0.19824664354671082, "mean_env_wait_ms": 231.04090138973618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0480574946249685, "StateBufferConnector_ms": 0.006100439256237399, "ViewRequirementAgentConnector_ms": 0.19031878440610825}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.93445842086805, "num_env_steps_trained_throughput_per_sec": 251.93445842086805, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 14343.236, "sample_time_ms": 11442.418, "learn_time_ms": 2767.935, "learn_throughput": 1445.121, "synch_weights_time_ms": 132.232}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 2729, "training_iteration": 94, "trial_id": "32397_00000", "date": "2025-03-21_08-59-56", "timestamp": 1742547596, "time_this_iter_s": 15.922365427017212, "time_total_s": 1368.6796646118164, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1368.6796646118164, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 99.22380952380954, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.032258064516129, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.912015914916992, "policy_loss": -0.009916977025568485, "vf_loss": 9.921875, "vf_explained_var": -1.903002413428112e-07, "kl": 0.0091315982863307, "entropy": 0.27857348322868347, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 62013.76022338867, "episode_reward_min": 50165.346757888794, "episode_reward_mean": 57673.67087985623, "episode_len_mean": 136.61290322580646, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 50165.346757888794}, "policy_reward_max": {"agent_0": 62013.76022338867}, "policy_reward_mean": {"agent_0": 57673.67087985623}, "custom_metrics": {"num_batches_mean": 5.032258064516129, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61066.7869720459, 52688.54667568207, 58087.21998119354, 57399.22019433975, 56265.413414001465, 59799.26675462723, 57703.146900177, 60281.17353820801, 61475.83984375, 59887.63346862793, 57866.02684020996, 55696.9934425354, 55705.92669630051, 61873.0068359375, 51813.4800658226, 60922.813415527344, 58855.43363952637, 54753.72692966461, 59709.09335708618, 58736.160064697266, 50165.346757888794, 54155.60020160675, 58845.0869140625, 50325.30018615723, 62013.76022338867, 59236.27350234985, 61238.7268371582, 59880.119941711426, 55683.09343910217, 57331.33986854553, 58422.24037361145], "episode_lengths": [137, 136, 137, 136, 136, 137, 136, 137, 138, 138, 136, 136, 136, 138, 135, 138, 137, 136, 137, 137, 134, 136, 136, 136, 138, 137, 137, 137, 137, 136, 137], "policy_agent_0_reward": [61066.7869720459, 52688.54667568207, 58087.21998119354, 57399.22019433975, 56265.413414001465, 59799.26675462723, 57703.146900177, 60281.17353820801, 61475.83984375, 59887.63346862793, 57866.02684020996, 55696.9934425354, 55705.92669630051, 61873.0068359375, 51813.4800658226, 60922.813415527344, 58855.43363952637, 54753.72692966461, 59709.09335708618, 58736.160064697266, 50165.346757888794, 54155.60020160675, 58845.0869140625, 50325.30018615723, 62013.76022338867, 59236.27350234985, 61238.7268371582, 59880.119941711426, 55683.09343910217, 57331.33986854553, 58422.24037361145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.476853913563193, "mean_inference_ms": 6.36914167418301, "mean_action_processing_ms": 0.20092969283294804, "mean_env_wait_ms": 217.98671307220044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.00633270509781376, "ViewRequirementAgentConnector_ms": 0.2957159473050025}}, "episode_reward_max": 62013.76022338867, "episode_reward_min": 50165.346757888794, "episode_reward_mean": 57673.67087985623, "episode_len_mean": 136.61290322580646, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 50165.346757888794}, "policy_reward_max": {"agent_0": 62013.76022338867}, "policy_reward_mean": {"agent_0": 57673.67087985623}, "hist_stats": {"episode_reward": [61066.7869720459, 52688.54667568207, 58087.21998119354, 57399.22019433975, 56265.413414001465, 59799.26675462723, 57703.146900177, 60281.17353820801, 61475.83984375, 59887.63346862793, 57866.02684020996, 55696.9934425354, 55705.92669630051, 61873.0068359375, 51813.4800658226, 60922.813415527344, 58855.43363952637, 54753.72692966461, 59709.09335708618, 58736.160064697266, 50165.346757888794, 54155.60020160675, 58845.0869140625, 50325.30018615723, 62013.76022338867, 59236.27350234985, 61238.7268371582, 59880.119941711426, 55683.09343910217, 57331.33986854553, 58422.24037361145], "episode_lengths": [137, 136, 137, 136, 136, 137, 136, 137, 138, 138, 136, 136, 136, 138, 135, 138, 137, 136, 137, 137, 134, 136, 136, 136, 138, 137, 137, 137, 137, 136, 137], "policy_agent_0_reward": [61066.7869720459, 52688.54667568207, 58087.21998119354, 57399.22019433975, 56265.413414001465, 59799.26675462723, 57703.146900177, 60281.17353820801, 61475.83984375, 59887.63346862793, 57866.02684020996, 55696.9934425354, 55705.92669630051, 61873.0068359375, 51813.4800658226, 60922.813415527344, 58855.43363952637, 54753.72692966461, 59709.09335708618, 58736.160064697266, 50165.346757888794, 54155.60020160675, 58845.0869140625, 50325.30018615723, 62013.76022338867, 59236.27350234985, 61238.7268371582, 59880.119941711426, 55683.09343910217, 57331.33986854553, 58422.24037361145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.476853913563193, "mean_inference_ms": 6.36914167418301, "mean_action_processing_ms": 0.20092969283294804, "mean_env_wait_ms": 217.98671307220044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.00633270509781376, "ViewRequirementAgentConnector_ms": 0.2957159473050025}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.92035874835904, "num_env_steps_trained_throughput_per_sec": 267.92035874835904, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 14150.589, "sample_time_ms": 11270.254, "learn_time_ms": 2747.27, "learn_throughput": 1455.991, "synch_weights_time_ms": 132.38}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 2760, "training_iteration": 95, "trial_id": "32397_00000", "date": "2025-03-21_09-00-12", "timestamp": 1742547612, "time_this_iter_s": 14.987304210662842, "time_total_s": 1383.6669688224792, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb85d630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1383.6669688224792, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 99.33333333333333, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987913131713867, "policy_loss": -0.009445959702134132, "vf_loss": 9.997314453125, "vf_explained_var": -1.9532939177224762e-07, "kl": 0.007045092061161995, "entropy": 0.27970176935195923, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 58422.24037361145, "episode_reward_min": 58422.24037361145, "episode_reward_mean": 58422.24037361145, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58422.24037361145}, "policy_reward_max": {"agent_0": 58422.24037361145}, "policy_reward_mean": {"agent_0": 58422.24037361145}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58422.24037361145], "episode_lengths": [137], "policy_agent_0_reward": [58422.24037361145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.031704764585104, "mean_inference_ms": 6.076979393861731, "mean_action_processing_ms": 0.1933582279146934, "mean_env_wait_ms": 226.1841503941283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039649009704589844, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.1633167266845703}}, "episode_reward_max": 58422.24037361145, "episode_reward_min": 58422.24037361145, "episode_reward_mean": 58422.24037361145, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58422.24037361145}, "policy_reward_max": {"agent_0": 58422.24037361145}, "policy_reward_mean": {"agent_0": 58422.24037361145}, "hist_stats": {"episode_reward": [58422.24037361145], "episode_lengths": [137], "policy_agent_0_reward": [58422.24037361145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.031704764585104, "mean_inference_ms": 6.076979393861731, "mean_action_processing_ms": 0.1933582279146934, "mean_env_wait_ms": 226.1841503941283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039649009704589844, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.1633167266845703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.4039729266377, "num_env_steps_trained_throughput_per_sec": 314.4039729266377, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 14013.705, "sample_time_ms": 11109.517, "learn_time_ms": 2769.706, "learn_throughput": 1444.197, "synch_weights_time_ms": 133.802}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 2760, "training_iteration": 96, "trial_id": "32397_00000", "date": "2025-03-21_09-00-24", "timestamp": 1742547624, "time_this_iter_s": 12.762370347976685, "time_total_s": 1396.429339170456, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1396.429339170456, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 99.58333333333333, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98091983795166, "policy_loss": -0.011812213808298111, "vf_loss": 9.99267578125, "vf_explained_var": 2.498427988939511e-07, "kl": 0.008902539499104023, "entropy": 0.2802782654762268, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 56528.31333732605, "episode_reward_min": 49761.4135723114, "episode_reward_mean": 53250.51122760773, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 49761.4135723114}, "policy_reward_max": {"agent_0": 56528.31333732605}, "policy_reward_mean": {"agent_0": 53250.51122760773}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [49761.4135723114, 53461.80677318573, 56528.31333732605], "episode_lengths": [134, 136, 135], "policy_agent_0_reward": [49761.4135723114, 53461.80677318573, 56528.31333732605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.22774706383386, "mean_inference_ms": 6.479392100327513, "mean_action_processing_ms": 0.19888386442273517, "mean_env_wait_ms": 230.19253310501992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03743966420491537, "StateBufferConnector_ms": 0.0055472056070963545, "ViewRequirementAgentConnector_ms": 0.1455386479695638}}, "episode_reward_max": 56528.31333732605, "episode_reward_min": 49761.4135723114, "episode_reward_mean": 53250.51122760773, "episode_len_mean": 135.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 49761.4135723114}, "policy_reward_max": {"agent_0": 56528.31333732605}, "policy_reward_mean": {"agent_0": 53250.51122760773}, "hist_stats": {"episode_reward": [49761.4135723114, 53461.80677318573, 56528.31333732605], "episode_lengths": [134, 136, 135], "policy_agent_0_reward": [49761.4135723114, 53461.80677318573, 56528.31333732605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.22774706383386, "mean_inference_ms": 6.479392100327513, "mean_action_processing_ms": 0.19888386442273517, "mean_env_wait_ms": 230.19253310501992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03743966420491537, "StateBufferConnector_ms": 0.0055472056070963545, "ViewRequirementAgentConnector_ms": 0.1455386479695638}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3552852965973, "num_env_steps_trained_throughput_per_sec": 309.3552852965973, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 13848.098, "sample_time_ms": 10974.689, "learn_time_ms": 2735.974, "learn_throughput": 1462.002, "synch_weights_time_ms": 136.757}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 2763, "training_iteration": 97, "trial_id": "32397_00000", "date": "2025-03-21_09-00-37", "timestamp": 1742547637, "time_this_iter_s": 12.9783616065979, "time_total_s": 1409.4077007770538, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1409.4077007770538, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 99.34444444444443, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.53932584269663, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.76364517211914, "policy_loss": -0.01180384960025549, "vf_loss": 9.775390625, "vf_explained_var": 2.2885700445840484e-07, "kl": 0.009349675849080086, "entropy": 0.28968411684036255, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 62834.466888427734, "episode_reward_min": 49574.41343784332, "episode_reward_mean": 58379.78840728121, "episode_len_mean": 136.57303370786516, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 49574.41343784332}, "policy_reward_max": {"agent_0": 62834.466888427734}, "policy_reward_mean": {"agent_0": 58379.78840728121}, "custom_metrics": {"num_batches_mean": 5.53932584269663, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56073.2399930954, 53115.72678565979, 61114.30013656616, 61000.240295410156, 60709.806884765625, 58765.3069152832, 55674.72013282776, 56749.26681137085, 60327.05349731445, 61468.95349121094, 57181.586669921875, 55761.9535484314, 58084.96004250646, 56975.5602645874, 59893.56677246094, 59881.38018798828, 57569.00021934509, 56627.860038757324, 57506.38690948486, 61721.57312011719, 55814.56019973755, 58955.63363647461, 60720.42694091797, 62027.953521728516, 56551.35352897644, 60340.85355758667, 55792.28012561798, 56471.540243148804, 61330.220153808594, 55402.360013246536, 61053.19372558594, 56348.10683917999, 58088.720351696014, 61319.96676635742, 59485.033306121826, 55776.29339790344, 61397.11331176758, 62834.466888427734, 59820.393463134766, 53992.00008773804, 56806.66000366211, 61403.60043334961, 56833.127177238464, 59523.473571777344, 56117.51342964172, 59666.26671600342, 61181.766998291016, 55598.22695159912, 57157.346700668335, 57727.93339538574, 58491.63333940506, 60177.253662109375, 57030.34666824341, 58013.10668563843, 55594.54671382904, 57142.40674781799, 58014.41373825073, 55726.93362045288, 56472.946811676025, 60199.97360229492, 58565.28691291809, 56797.993434906006, 59032.23356628418, 50979.120062828064, 60511.20669555664, 58921.45347213745, 57927.38024902344, 61210.38024902344, 57858.44016176462, 59807.82688140869, 59950.953632354736, 59672.54016113281, 56157.19352722168, 60933.620208740234, 59560.633699417114, 49574.41343784332, 62047.27355957031, 60344.48012161255, 59292.7666721344, 57925.0866394043, 56179.50009918213, 61180.60028076172, 60405.333684921265, 59235.25358581543, 57444.347047805786, 56111.800174713135, 60211.93328857422, 60316.76689147949, 59040.960105895996], "episode_lengths": [136, 135, 137, 137, 138, 137, 137, 136, 137, 138, 135, 135, 137, 136, 137, 138, 138, 136, 137, 138, 136, 137, 137, 138, 136, 138, 136, 136, 137, 135, 138, 136, 137, 137, 136, 136, 137, 139, 137, 135, 137, 137, 137, 136, 135, 137, 138, 135, 136, 137, 136, 137, 136, 136, 135, 137, 136, 136, 135, 136, 136, 137, 137, 135, 137, 136, 135, 138, 137, 137, 137, 138, 135, 138, 137, 134, 138, 138, 137, 136, 135, 138, 137, 136, 136, 136, 137, 137, 136], "policy_agent_0_reward": [56073.2399930954, 53115.72678565979, 61114.30013656616, 61000.240295410156, 60709.806884765625, 58765.3069152832, 55674.72013282776, 56749.26681137085, 60327.05349731445, 61468.95349121094, 57181.586669921875, 55761.9535484314, 58084.96004250646, 56975.5602645874, 59893.56677246094, 59881.38018798828, 57569.00021934509, 56627.860038757324, 57506.38690948486, 61721.57312011719, 55814.56019973755, 58955.63363647461, 60720.42694091797, 62027.953521728516, 56551.35352897644, 60340.85355758667, 55792.28012561798, 56471.540243148804, 61330.220153808594, 55402.360013246536, 61053.19372558594, 56348.10683917999, 58088.720351696014, 61319.96676635742, 59485.033306121826, 55776.29339790344, 61397.11331176758, 62834.466888427734, 59820.393463134766, 53992.00008773804, 56806.66000366211, 61403.60043334961, 56833.127177238464, 59523.473571777344, 56117.51342964172, 59666.26671600342, 61181.766998291016, 55598.22695159912, 57157.346700668335, 57727.93339538574, 58491.63333940506, 60177.253662109375, 57030.34666824341, 58013.10668563843, 55594.54671382904, 57142.40674781799, 58014.41373825073, 55726.93362045288, 56472.946811676025, 60199.97360229492, 58565.28691291809, 56797.993434906006, 59032.23356628418, 50979.120062828064, 60511.20669555664, 58921.45347213745, 57927.38024902344, 61210.38024902344, 57858.44016176462, 59807.82688140869, 59950.953632354736, 59672.54016113281, 56157.19352722168, 60933.620208740234, 59560.633699417114, 49574.41343784332, 62047.27355957031, 60344.48012161255, 59292.7666721344, 57925.0866394043, 56179.50009918213, 61180.60028076172, 60405.333684921265, 59235.25358581543, 57444.347047805786, 56111.800174713135, 60211.93328857422, 60316.76689147949, 59040.960105895996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.91129103937733, "mean_inference_ms": 6.778111067754617, "mean_action_processing_ms": 0.19790577814963145, "mean_env_wait_ms": 232.87871613536166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05683711405550496, "StateBufferConnector_ms": 0.006007612421271506, "ViewRequirementAgentConnector_ms": 0.21010597100418604}}, "episode_reward_max": 62834.466888427734, "episode_reward_min": 49574.41343784332, "episode_reward_mean": 58379.78840728121, "episode_len_mean": 136.57303370786516, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 49574.41343784332}, "policy_reward_max": {"agent_0": 62834.466888427734}, "policy_reward_mean": {"agent_0": 58379.78840728121}, "hist_stats": {"episode_reward": [56073.2399930954, 53115.72678565979, 61114.30013656616, 61000.240295410156, 60709.806884765625, 58765.3069152832, 55674.72013282776, 56749.26681137085, 60327.05349731445, 61468.95349121094, 57181.586669921875, 55761.9535484314, 58084.96004250646, 56975.5602645874, 59893.56677246094, 59881.38018798828, 57569.00021934509, 56627.860038757324, 57506.38690948486, 61721.57312011719, 55814.56019973755, 58955.63363647461, 60720.42694091797, 62027.953521728516, 56551.35352897644, 60340.85355758667, 55792.28012561798, 56471.540243148804, 61330.220153808594, 55402.360013246536, 61053.19372558594, 56348.10683917999, 58088.720351696014, 61319.96676635742, 59485.033306121826, 55776.29339790344, 61397.11331176758, 62834.466888427734, 59820.393463134766, 53992.00008773804, 56806.66000366211, 61403.60043334961, 56833.127177238464, 59523.473571777344, 56117.51342964172, 59666.26671600342, 61181.766998291016, 55598.22695159912, 57157.346700668335, 57727.93339538574, 58491.63333940506, 60177.253662109375, 57030.34666824341, 58013.10668563843, 55594.54671382904, 57142.40674781799, 58014.41373825073, 55726.93362045288, 56472.946811676025, 60199.97360229492, 58565.28691291809, 56797.993434906006, 59032.23356628418, 50979.120062828064, 60511.20669555664, 58921.45347213745, 57927.38024902344, 61210.38024902344, 57858.44016176462, 59807.82688140869, 59950.953632354736, 59672.54016113281, 56157.19352722168, 60933.620208740234, 59560.633699417114, 49574.41343784332, 62047.27355957031, 60344.48012161255, 59292.7666721344, 57925.0866394043, 56179.50009918213, 61180.60028076172, 60405.333684921265, 59235.25358581543, 57444.347047805786, 56111.800174713135, 60211.93328857422, 60316.76689147949, 59040.960105895996], "episode_lengths": [136, 135, 137, 137, 138, 137, 137, 136, 137, 138, 135, 135, 137, 136, 137, 138, 138, 136, 137, 138, 136, 137, 137, 138, 136, 138, 136, 136, 137, 135, 138, 136, 137, 137, 136, 136, 137, 139, 137, 135, 137, 137, 137, 136, 135, 137, 138, 135, 136, 137, 136, 137, 136, 136, 135, 137, 136, 136, 135, 136, 136, 137, 137, 135, 137, 136, 135, 138, 137, 137, 137, 138, 135, 138, 137, 134, 138, 138, 137, 136, 135, 138, 137, 136, 136, 136, 137, 137, 136], "policy_agent_0_reward": [56073.2399930954, 53115.72678565979, 61114.30013656616, 61000.240295410156, 60709.806884765625, 58765.3069152832, 55674.72013282776, 56749.26681137085, 60327.05349731445, 61468.95349121094, 57181.586669921875, 55761.9535484314, 58084.96004250646, 56975.5602645874, 59893.56677246094, 59881.38018798828, 57569.00021934509, 56627.860038757324, 57506.38690948486, 61721.57312011719, 55814.56019973755, 58955.63363647461, 60720.42694091797, 62027.953521728516, 56551.35352897644, 60340.85355758667, 55792.28012561798, 56471.540243148804, 61330.220153808594, 55402.360013246536, 61053.19372558594, 56348.10683917999, 58088.720351696014, 61319.96676635742, 59485.033306121826, 55776.29339790344, 61397.11331176758, 62834.466888427734, 59820.393463134766, 53992.00008773804, 56806.66000366211, 61403.60043334961, 56833.127177238464, 59523.473571777344, 56117.51342964172, 59666.26671600342, 61181.766998291016, 55598.22695159912, 57157.346700668335, 57727.93339538574, 58491.63333940506, 60177.253662109375, 57030.34666824341, 58013.10668563843, 55594.54671382904, 57142.40674781799, 58014.41373825073, 55726.93362045288, 56472.946811676025, 60199.97360229492, 58565.28691291809, 56797.993434906006, 59032.23356628418, 50979.120062828064, 60511.20669555664, 58921.45347213745, 57927.38024902344, 61210.38024902344, 57858.44016176462, 59807.82688140869, 59950.953632354736, 59672.54016113281, 56157.19352722168, 60933.620208740234, 59560.633699417114, 49574.41343784332, 62047.27355957031, 60344.48012161255, 59292.7666721344, 57925.0866394043, 56179.50009918213, 61180.60028076172, 60405.333684921265, 59235.25358581543, 57444.347047805786, 56111.800174713135, 60211.93328857422, 60316.76689147949, 59040.960105895996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.91129103937733, "mean_inference_ms": 6.778111067754617, "mean_action_processing_ms": 0.19790577814963145, "mean_env_wait_ms": 232.87871613536166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05683711405550496, "StateBufferConnector_ms": 0.006007612421271506, "ViewRequirementAgentConnector_ms": 0.21010597100418604}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.02504273048177, "num_env_steps_trained_throughput_per_sec": 246.02504273048177, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 14204.074, "sample_time_ms": 11402.235, "learn_time_ms": 2666.044, "learn_throughput": 1500.35, "synch_weights_time_ms": 135.114}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 2852, "training_iteration": 98, "trial_id": "32397_00000", "date": "2025-03-21_09-00-54", "timestamp": 1742547654, "time_this_iter_s": 16.31589961051941, "time_total_s": 1425.7236003875732, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7025f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1425.7236003875732, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 97.4090909090909, "ram_util_percent": 13.47272727272727}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.90776538848877, "policy_loss": -0.011986772529780865, "vf_loss": 9.919677734375, "vf_explained_var": -1.6633421751066635e-07, "kl": 0.012030857615172863, "entropy": 0.29219892621040344, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 61663.413482666016, "episode_reward_min": 50122.60703754425, "episode_reward_mean": 57165.62685550004, "episode_len_mean": 136.25, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 50122.60703754425}, "policy_reward_max": {"agent_0": 61663.413482666016}, "policy_reward_mean": {"agent_0": 57165.62685550004}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59181.306884765625, 55761.486682891846, 59434.90695762634, 54238.49352931976, 56982.79388046265, 58508.54006958008, 50790.546637535095, 59486.75346374512, 57828.4869184494, 56887.20019721985, 54657.7067565918, 50122.60703754425, 57479.60005187988, 59256.70040130615, 59452.40015411377, 57235.06002807617, 59770.200119018555, 58914.72696685791, 58441.39339065552, 52284.70707845688, 59509.92691040039, 53995.50016784668, 57834.2806224823, 61375.06024169922, 53829.02021980286, 56948.4534406662, 58270.813331604004, 59188.819896698, 61663.413482666016, 55294.90687918663, 57652.8867893219, 57021.36018753052], "episode_lengths": [136, 136, 137, 136, 136, 136, 135, 137, 137, 136, 135, 133, 136, 137, 137, 136, 137, 137, 136, 136, 136, 136, 136, 138, 136, 136, 136, 137, 138, 137, 136, 136], "policy_agent_0_reward": [59181.306884765625, 55761.486682891846, 59434.90695762634, 54238.49352931976, 56982.79388046265, 58508.54006958008, 50790.546637535095, 59486.75346374512, 57828.4869184494, 56887.20019721985, 54657.7067565918, 50122.60703754425, 57479.60005187988, 59256.70040130615, 59452.40015411377, 57235.06002807617, 59770.200119018555, 58914.72696685791, 58441.39339065552, 52284.70707845688, 59509.92691040039, 53995.50016784668, 57834.2806224823, 61375.06024169922, 53829.02021980286, 56948.4534406662, 58270.813331604004, 59188.819896698, 61663.413482666016, 55294.90687918663, 57652.8867893219, 57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.4798151876782, "mean_inference_ms": 6.362563972629269, "mean_action_processing_ms": 0.20046311919662915, "mean_env_wait_ms": 217.72886267344546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04190504550933838, "StateBufferConnector_ms": 0.00624731183052063, "ViewRequirementAgentConnector_ms": 0.25823861360549927}}, "episode_reward_max": 61663.413482666016, "episode_reward_min": 50122.60703754425, "episode_reward_mean": 57165.62685550004, "episode_len_mean": 136.25, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 50122.60703754425}, "policy_reward_max": {"agent_0": 61663.413482666016}, "policy_reward_mean": {"agent_0": 57165.62685550004}, "hist_stats": {"episode_reward": [59181.306884765625, 55761.486682891846, 59434.90695762634, 54238.49352931976, 56982.79388046265, 58508.54006958008, 50790.546637535095, 59486.75346374512, 57828.4869184494, 56887.20019721985, 54657.7067565918, 50122.60703754425, 57479.60005187988, 59256.70040130615, 59452.40015411377, 57235.06002807617, 59770.200119018555, 58914.72696685791, 58441.39339065552, 52284.70707845688, 59509.92691040039, 53995.50016784668, 57834.2806224823, 61375.06024169922, 53829.02021980286, 56948.4534406662, 58270.813331604004, 59188.819896698, 61663.413482666016, 55294.90687918663, 57652.8867893219, 57021.36018753052], "episode_lengths": [136, 136, 137, 136, 136, 136, 135, 137, 137, 136, 135, 133, 136, 137, 137, 136, 137, 137, 136, 136, 136, 136, 136, 138, 136, 136, 136, 137, 138, 137, 136, 136], "policy_agent_0_reward": [59181.306884765625, 55761.486682891846, 59434.90695762634, 54238.49352931976, 56982.79388046265, 58508.54006958008, 50790.546637535095, 59486.75346374512, 57828.4869184494, 56887.20019721985, 54657.7067565918, 50122.60703754425, 57479.60005187988, 59256.70040130615, 59452.40015411377, 57235.06002807617, 59770.200119018555, 58914.72696685791, 58441.39339065552, 52284.70707845688, 59509.92691040039, 53995.50016784668, 57834.2806224823, 61375.06024169922, 53829.02021980286, 56948.4534406662, 58270.813331604004, 59188.819896698, 61663.413482666016, 55294.90687918663, 57652.8867893219, 57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.4798151876782, "mean_inference_ms": 6.362563972629269, "mean_action_processing_ms": 0.20046311919662915, "mean_env_wait_ms": 217.72886267344546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04190504550933838, "StateBufferConnector_ms": 0.00624731183052063, "ViewRequirementAgentConnector_ms": 0.25823861360549927}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.45874119630471, "num_env_steps_trained_throughput_per_sec": 253.45874119630471, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 14138.075, "sample_time_ms": 11334.814, "learn_time_ms": 2671.005, "learn_throughput": 1497.563, "synch_weights_time_ms": 131.586}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 2884, "training_iteration": 99, "trial_id": "32397_00000", "date": "2025-03-21_09-01-10", "timestamp": 1742547670, "time_this_iter_s": 15.830378770828247, "time_total_s": 1441.5539791584015, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1441.5539791584015, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 99.35000000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98859691619873, "policy_loss": -0.01146403793245554, "vf_loss": 10.0, "vf_explained_var": -2.669791321352477e-08, "kl": 0.009740137495100498, "entropy": 0.33373603224754333, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 57021.36018753052, "episode_reward_min": 57021.36018753052, "episode_reward_mean": 57021.36018753052, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57021.36018753052}, "policy_reward_max": {"agent_0": 57021.36018753052}, "policy_reward_mean": {"agent_0": 57021.36018753052}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57021.36018753052], "episode_lengths": [136], "policy_agent_0_reward": [57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.699248427130748, "mean_inference_ms": 6.056574012541566, "mean_action_processing_ms": 0.19713101801411176, "mean_env_wait_ms": 226.30686530868456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742145538330078, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 1.2405157089233398}}, "episode_reward_max": 57021.36018753052, "episode_reward_min": 57021.36018753052, "episode_reward_mean": 57021.36018753052, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57021.36018753052}, "policy_reward_max": {"agent_0": 57021.36018753052}, "policy_reward_mean": {"agent_0": 57021.36018753052}, "hist_stats": {"episode_reward": [57021.36018753052], "episode_lengths": [136], "policy_agent_0_reward": [57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.699248427130748, "mean_inference_ms": 6.056574012541566, "mean_action_processing_ms": 0.19713101801411176, "mean_env_wait_ms": 226.30686530868456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742145538330078, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 1.2405157089233398}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.7368467665271, "num_env_steps_trained_throughput_per_sec": 315.7368467665271, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14255.251, "sample_time_ms": 11393.502, "learn_time_ms": 2725.695, "learn_throughput": 1467.516, "synch_weights_time_ms": 135.376}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 2884, "training_iteration": 100, "trial_id": "32397_00000", "date": "2025-03-21_09-01-22", "timestamp": 1742547682, "time_this_iter_s": 12.719473838806152, "time_total_s": 1454.2734529972076, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1454.2734529972076, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 99.56315789473685, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987351417541504, "policy_loss": -0.010261815041303635, "vf_loss": 9.99755859375, "vf_explained_var": -5.966673199964134e-08, "kl": 0.008697280660271645, "entropy": 0.3119250535964966, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 57021.36018753052, "episode_reward_min": 57021.36018753052, "episode_reward_mean": 57021.36018753052, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57021.36018753052}, "policy_reward_max": {"agent_0": 57021.36018753052}, "policy_reward_mean": {"agent_0": 57021.36018753052}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57021.36018753052], "episode_lengths": [136], "policy_agent_0_reward": [57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.699248427130748, "mean_inference_ms": 6.056574012541566, "mean_action_processing_ms": 0.19713101801411176, "mean_env_wait_ms": 226.30686530868456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742145538330078, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 1.2405157089233398}}, "episode_reward_max": 57021.36018753052, "episode_reward_min": 57021.36018753052, "episode_reward_mean": 57021.36018753052, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57021.36018753052}, "policy_reward_max": {"agent_0": 57021.36018753052}, "policy_reward_mean": {"agent_0": 57021.36018753052}, "hist_stats": {"episode_reward": [57021.36018753052], "episode_lengths": [136], "policy_agent_0_reward": [57021.36018753052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.699248427130748, "mean_inference_ms": 6.056574012541566, "mean_action_processing_ms": 0.19713101801411176, "mean_env_wait_ms": 226.30686530868456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04742145538330078, "StateBufferConnector_ms": 0.0064849853515625, "ViewRequirementAgentConnector_ms": 1.2405157089233398}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.4682716014137, "num_env_steps_trained_throughput_per_sec": 286.4682716014137, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 14106.2, "sample_time_ms": 11173.24, "learn_time_ms": 2799.867, "learn_throughput": 1428.639, "synch_weights_time_ms": 132.42}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 2884, "training_iteration": 101, "trial_id": "32397_00000", "date": "2025-03-21_09-01-36", "timestamp": 1742547696, "time_this_iter_s": 14.016782522201538, "time_total_s": 1468.2902355194092, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb943d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1468.2902355194092, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 99.61578947368422, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.021739130434782, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.762068748474121, "policy_loss": -0.009965630248188972, "vf_loss": 9.77197265625, "vf_explained_var": 6.953874986947994e-08, "kl": 0.009943115524947643, "entropy": 0.3501370847225189, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 62373.080474853516, "episode_reward_min": 50418.64654922485, "episode_reward_mean": 58199.21252471273, "episode_len_mean": 136.44565217391303, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50418.64654922485}, "policy_reward_max": {"agent_0": 62373.080474853516}, "policy_reward_mean": {"agent_0": 58199.21252471273}, "custom_metrics": {"num_batches_mean": 5.021739130434782, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60325.13375854492, 51022.31344985962, 58590.38034820557, 60900.01997375488, 59407.02005004883, 59731.68031311035, 60967.84671020508, 61767.96036529541, 58618.44682312012, 58303.10673522949, 60109.593811035156, 58430.48028564453, 60381.02703857422, 52062.7400701046, 55441.79352760315, 58019.60012435913, 56218.566747665405, 60041.64031982422, 56320.846839904785, 54879.16686916351, 55261.24682426453, 57234.96031951904, 60460.89356994629, 60420.83352661133, 58554.146713256836, 57713.940163612366, 50418.64654922485, 59388.75347518921, 59689.54040527344, 57484.21353530884, 59196.093521118164, 55467.02020072937, 57998.8733215332, 59563.79343032837, 58738.44038391113, 55229.713572502136, 59581.513244628906, 53210.29375362396, 57390.92682647705, 59789.62706756592, 58328.13376522064, 60475.58680725098, 58574.87380218506, 59863.66694498062, 58108.253814697266, 60599.266662597656, 57918.64026260376, 55141.95334625244, 60070.513595581055, 57720.44004058838, 58071.580169677734, 60399.76675415039, 57794.146883010864, 57977.37344741821, 57861.946685791016, 56692.60013580322, 60739.640197753906, 58582.260192871094, 57289.14692783356, 58164.8669052124, 58811.12008666992, 59057.133529663086, 56074.42018890381, 56291.440524578094, 61369.593826293945, 58849.38012313843, 54366.946994781494, 57741.780230522156, 58273.68681335449, 60651.946868896484, 57573.96031951904, 55774.6535692215, 52390.81362634897, 60839.80676269531, 59449.04684448242, 60109.553466796875, 62373.080474853516, 59791.166732788086, 57728.28677368164, 58304.06009864807, 56716.18013381958, 58541.94009399414, 60566.84671020508, 57062.91361999512, 59969.56678390503, 60525.2668762207, 51136.98021316528, 59986.133392333984, 60640.300201416016, 59922.27373504639, 57764.62056350708, 60965.16018676758], "episode_lengths": [137, 135, 136, 138, 137, 137, 137, 138, 136, 136, 136, 137, 137, 135, 137, 136, 136, 137, 136, 135, 136, 136, 137, 137, 137, 136, 134, 137, 137, 135, 137, 136, 136, 137, 136, 135, 136, 136, 136, 137, 136, 138, 136, 137, 136, 137, 137, 135, 137, 137, 137, 137, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 136, 137, 137, 137, 135, 137, 136, 137, 136, 135, 136, 137, 137, 137, 138, 136, 136, 137, 136, 136, 138, 137, 136, 137, 135, 137, 137, 137, 136, 137], "policy_agent_0_reward": [60325.13375854492, 51022.31344985962, 58590.38034820557, 60900.01997375488, 59407.02005004883, 59731.68031311035, 60967.84671020508, 61767.96036529541, 58618.44682312012, 58303.10673522949, 60109.593811035156, 58430.48028564453, 60381.02703857422, 52062.7400701046, 55441.79352760315, 58019.60012435913, 56218.566747665405, 60041.64031982422, 56320.846839904785, 54879.16686916351, 55261.24682426453, 57234.96031951904, 60460.89356994629, 60420.83352661133, 58554.146713256836, 57713.940163612366, 50418.64654922485, 59388.75347518921, 59689.54040527344, 57484.21353530884, 59196.093521118164, 55467.02020072937, 57998.8733215332, 59563.79343032837, 58738.44038391113, 55229.713572502136, 59581.513244628906, 53210.29375362396, 57390.92682647705, 59789.62706756592, 58328.13376522064, 60475.58680725098, 58574.87380218506, 59863.66694498062, 58108.253814697266, 60599.266662597656, 57918.64026260376, 55141.95334625244, 60070.513595581055, 57720.44004058838, 58071.580169677734, 60399.76675415039, 57794.146883010864, 57977.37344741821, 57861.946685791016, 56692.60013580322, 60739.640197753906, 58582.260192871094, 57289.14692783356, 58164.8669052124, 58811.12008666992, 59057.133529663086, 56074.42018890381, 56291.440524578094, 61369.593826293945, 58849.38012313843, 54366.946994781494, 57741.780230522156, 58273.68681335449, 60651.946868896484, 57573.96031951904, 55774.6535692215, 52390.81362634897, 60839.80676269531, 59449.04684448242, 60109.553466796875, 62373.080474853516, 59791.166732788086, 57728.28677368164, 58304.06009864807, 56716.18013381958, 58541.94009399414, 60566.84671020508, 57062.91361999512, 59969.56678390503, 60525.2668762207, 51136.98021316528, 59986.133392333984, 60640.300201416016, 59922.27373504639, 57764.62056350708, 60965.16018676758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.74584632917095, "mean_inference_ms": 6.7672103252508675, "mean_action_processing_ms": 0.19767316618473046, "mean_env_wait_ms": 232.71773955310672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06728172302246094, "StateBufferConnector_ms": 0.00614575717760169, "ViewRequirementAgentConnector_ms": 0.20912730175515878}}, "episode_reward_max": 62373.080474853516, "episode_reward_min": 50418.64654922485, "episode_reward_mean": 58199.21252471273, "episode_len_mean": 136.44565217391303, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50418.64654922485}, "policy_reward_max": {"agent_0": 62373.080474853516}, "policy_reward_mean": {"agent_0": 58199.21252471273}, "hist_stats": {"episode_reward": [60325.13375854492, 51022.31344985962, 58590.38034820557, 60900.01997375488, 59407.02005004883, 59731.68031311035, 60967.84671020508, 61767.96036529541, 58618.44682312012, 58303.10673522949, 60109.593811035156, 58430.48028564453, 60381.02703857422, 52062.7400701046, 55441.79352760315, 58019.60012435913, 56218.566747665405, 60041.64031982422, 56320.846839904785, 54879.16686916351, 55261.24682426453, 57234.96031951904, 60460.89356994629, 60420.83352661133, 58554.146713256836, 57713.940163612366, 50418.64654922485, 59388.75347518921, 59689.54040527344, 57484.21353530884, 59196.093521118164, 55467.02020072937, 57998.8733215332, 59563.79343032837, 58738.44038391113, 55229.713572502136, 59581.513244628906, 53210.29375362396, 57390.92682647705, 59789.62706756592, 58328.13376522064, 60475.58680725098, 58574.87380218506, 59863.66694498062, 58108.253814697266, 60599.266662597656, 57918.64026260376, 55141.95334625244, 60070.513595581055, 57720.44004058838, 58071.580169677734, 60399.76675415039, 57794.146883010864, 57977.37344741821, 57861.946685791016, 56692.60013580322, 60739.640197753906, 58582.260192871094, 57289.14692783356, 58164.8669052124, 58811.12008666992, 59057.133529663086, 56074.42018890381, 56291.440524578094, 61369.593826293945, 58849.38012313843, 54366.946994781494, 57741.780230522156, 58273.68681335449, 60651.946868896484, 57573.96031951904, 55774.6535692215, 52390.81362634897, 60839.80676269531, 59449.04684448242, 60109.553466796875, 62373.080474853516, 59791.166732788086, 57728.28677368164, 58304.06009864807, 56716.18013381958, 58541.94009399414, 60566.84671020508, 57062.91361999512, 59969.56678390503, 60525.2668762207, 51136.98021316528, 59986.133392333984, 60640.300201416016, 59922.27373504639, 57764.62056350708, 60965.16018676758], "episode_lengths": [137, 135, 136, 138, 137, 137, 137, 138, 136, 136, 136, 137, 137, 135, 137, 136, 136, 137, 136, 135, 136, 136, 137, 137, 137, 136, 134, 137, 137, 135, 137, 136, 136, 137, 136, 135, 136, 136, 136, 137, 136, 138, 136, 137, 136, 137, 137, 135, 137, 137, 137, 137, 137, 136, 136, 136, 137, 136, 136, 136, 137, 137, 136, 137, 137, 137, 135, 137, 136, 137, 136, 135, 136, 137, 137, 137, 138, 136, 136, 137, 136, 136, 138, 137, 136, 137, 135, 137, 137, 137, 136, 137], "policy_agent_0_reward": [60325.13375854492, 51022.31344985962, 58590.38034820557, 60900.01997375488, 59407.02005004883, 59731.68031311035, 60967.84671020508, 61767.96036529541, 58618.44682312012, 58303.10673522949, 60109.593811035156, 58430.48028564453, 60381.02703857422, 52062.7400701046, 55441.79352760315, 58019.60012435913, 56218.566747665405, 60041.64031982422, 56320.846839904785, 54879.16686916351, 55261.24682426453, 57234.96031951904, 60460.89356994629, 60420.83352661133, 58554.146713256836, 57713.940163612366, 50418.64654922485, 59388.75347518921, 59689.54040527344, 57484.21353530884, 59196.093521118164, 55467.02020072937, 57998.8733215332, 59563.79343032837, 58738.44038391113, 55229.713572502136, 59581.513244628906, 53210.29375362396, 57390.92682647705, 59789.62706756592, 58328.13376522064, 60475.58680725098, 58574.87380218506, 59863.66694498062, 58108.253814697266, 60599.266662597656, 57918.64026260376, 55141.95334625244, 60070.513595581055, 57720.44004058838, 58071.580169677734, 60399.76675415039, 57794.146883010864, 57977.37344741821, 57861.946685791016, 56692.60013580322, 60739.640197753906, 58582.260192871094, 57289.14692783356, 58164.8669052124, 58811.12008666992, 59057.133529663086, 56074.42018890381, 56291.440524578094, 61369.593826293945, 58849.38012313843, 54366.946994781494, 57741.780230522156, 58273.68681335449, 60651.946868896484, 57573.96031951904, 55774.6535692215, 52390.81362634897, 60839.80676269531, 59449.04684448242, 60109.553466796875, 62373.080474853516, 59791.166732788086, 57728.28677368164, 58304.06009864807, 56716.18013381958, 58541.94009399414, 60566.84671020508, 57062.91361999512, 59969.56678390503, 60525.2668762207, 51136.98021316528, 59986.133392333984, 60640.300201416016, 59922.27373504639, 57764.62056350708, 60965.16018676758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.74584632917095, "mean_inference_ms": 6.7672103252508675, "mean_action_processing_ms": 0.19767316618473046, "mean_env_wait_ms": 232.71773955310672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06728172302246094, "StateBufferConnector_ms": 0.00614575717760169, "ViewRequirementAgentConnector_ms": 0.20912730175515878}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.72770530334546, "num_env_steps_trained_throughput_per_sec": 248.72770530334546, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 14467.312, "sample_time_ms": 11557.08, "learn_time_ms": 2774.544, "learn_throughput": 1441.678, "synch_weights_time_ms": 135.003}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 2976, "training_iteration": 102, "trial_id": "32397_00000", "date": "2025-03-21_09-01-53", "timestamp": 1742547713, "time_this_iter_s": 16.135612964630127, "time_total_s": 1484.4258484840393, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb702560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1484.4258484840393, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 96.64782608695654, "ram_util_percent": 13.465217391304348}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.902831077575684, "policy_loss": -0.01255829818546772, "vf_loss": 9.915328025817871, "vf_explained_var": -5.533235707844142e-06, "kl": 0.009668481536209583, "entropy": 0.33408674597740173, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 62173.48715209961, "episode_reward_min": 49248.646981716156, "episode_reward_mean": 58197.16291066259, "episode_len_mean": 136.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 49248.646981716156}, "policy_reward_max": {"agent_0": 62173.48715209961}, "policy_reward_mean": {"agent_0": 58197.16291066259}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57540.91382789612, 53557.653354644775, 58913.26689910889, 58985.42665100098, 62173.48715209961, 58614.63345336914, 57978.72686958313, 61423.43370056152, 60584.29364013672, 60681.840087890625, 58003.206787109375, 60217.67352294922, 57212.80010986328, 58324.74666595459, 60194.79348754883, 58571.72677540779, 58470.32689666748, 52115.6734957695, 60375.820068359375, 52696.54035139084, 59999.12716674805, 49248.646981716156, 55284.49344921112, 58998.566663742065, 58549.659982681274, 59181.753479003906, 60832.35369873047, 59521.833557128906, 61564.01998901367, 58266.79375457764, 56556.58040237427, 57668.40021896362], "episode_lengths": [136, 135, 137, 137, 138, 137, 137, 137, 138, 137, 136, 137, 135, 137, 137, 137, 136, 135, 137, 135, 137, 135, 136, 136, 137, 136, 137, 136, 138, 137, 136, 136], "policy_agent_0_reward": [57540.91382789612, 53557.653354644775, 58913.26689910889, 58985.42665100098, 62173.48715209961, 58614.63345336914, 57978.72686958313, 61423.43370056152, 60584.29364013672, 60681.840087890625, 58003.206787109375, 60217.67352294922, 57212.80010986328, 58324.74666595459, 60194.79348754883, 58571.72677540779, 58470.32689666748, 52115.6734957695, 60375.820068359375, 52696.54035139084, 59999.12716674805, 49248.646981716156, 55284.49344921112, 58998.566663742065, 58549.659982681274, 59181.753479003906, 60832.35369873047, 59521.833557128906, 61564.01998901367, 58266.79375457764, 56556.58040237427, 57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.543154425042516, "mean_inference_ms": 6.369780133313992, "mean_action_processing_ms": 0.20029164850711823, "mean_env_wait_ms": 217.5587169365848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05319565534591675, "StateBufferConnector_ms": 0.006349384784698486, "ViewRequirementAgentConnector_ms": 0.23267120122909546}}, "episode_reward_max": 62173.48715209961, "episode_reward_min": 49248.646981716156, "episode_reward_mean": 58197.16291066259, "episode_len_mean": 136.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 49248.646981716156}, "policy_reward_max": {"agent_0": 62173.48715209961}, "policy_reward_mean": {"agent_0": 58197.16291066259}, "hist_stats": {"episode_reward": [57540.91382789612, 53557.653354644775, 58913.26689910889, 58985.42665100098, 62173.48715209961, 58614.63345336914, 57978.72686958313, 61423.43370056152, 60584.29364013672, 60681.840087890625, 58003.206787109375, 60217.67352294922, 57212.80010986328, 58324.74666595459, 60194.79348754883, 58571.72677540779, 58470.32689666748, 52115.6734957695, 60375.820068359375, 52696.54035139084, 59999.12716674805, 49248.646981716156, 55284.49344921112, 58998.566663742065, 58549.659982681274, 59181.753479003906, 60832.35369873047, 59521.833557128906, 61564.01998901367, 58266.79375457764, 56556.58040237427, 57668.40021896362], "episode_lengths": [136, 135, 137, 137, 138, 137, 137, 137, 138, 137, 136, 137, 135, 137, 137, 137, 136, 135, 137, 135, 137, 135, 136, 136, 137, 136, 137, 136, 138, 137, 136, 136], "policy_agent_0_reward": [57540.91382789612, 53557.653354644775, 58913.26689910889, 58985.42665100098, 62173.48715209961, 58614.63345336914, 57978.72686958313, 61423.43370056152, 60584.29364013672, 60681.840087890625, 58003.206787109375, 60217.67352294922, 57212.80010986328, 58324.74666595459, 60194.79348754883, 58571.72677540779, 58470.32689666748, 52115.6734957695, 60375.820068359375, 52696.54035139084, 59999.12716674805, 49248.646981716156, 55284.49344921112, 58998.566663742065, 58549.659982681274, 59181.753479003906, 60832.35369873047, 59521.833557128906, 61564.01998901367, 58266.79375457764, 56556.58040237427, 57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.543154425042516, "mean_inference_ms": 6.369780133313992, "mean_action_processing_ms": 0.20029164850711823, "mean_env_wait_ms": 217.5587169365848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05319565534591675, "StateBufferConnector_ms": 0.006349384784698486, "ViewRequirementAgentConnector_ms": 0.23267120122909546}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.8778908534275, "num_env_steps_trained_throughput_per_sec": 256.8778908534275, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 14678.471, "sample_time_ms": 11712.064, "learn_time_ms": 2831.74, "learn_throughput": 1412.559, "synch_weights_time_ms": 133.974}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 3008, "training_iteration": 103, "trial_id": "32397_00000", "date": "2025-03-21_09-02-08", "timestamp": 1742547728, "time_this_iter_s": 15.620126485824585, "time_total_s": 1500.045974969864, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1500.045974969864, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 99.3380952380952, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987226486206055, "policy_loss": -0.012822198681533337, "vf_loss": 10.0, "vf_explained_var": -3.800975719059352e-06, "kl": 0.007778330706059933, "entropy": 0.3019132912158966, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 57668.40021896362, "episode_reward_min": 57668.40021896362, "episode_reward_mean": 57668.40021896362, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57668.40021896362}, "policy_reward_max": {"agent_0": 57668.40021896362}, "policy_reward_mean": {"agent_0": 57668.40021896362}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57668.40021896362], "episode_lengths": [136], "policy_agent_0_reward": [57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.590815025217392, "mean_inference_ms": 6.051711475147921, "mean_action_processing_ms": 0.19687764784869027, "mean_env_wait_ms": 225.12136774904587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667572021484375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.19745826721191406}}, "episode_reward_max": 57668.40021896362, "episode_reward_min": 57668.40021896362, "episode_reward_mean": 57668.40021896362, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57668.40021896362}, "policy_reward_max": {"agent_0": 57668.40021896362}, "policy_reward_mean": {"agent_0": 57668.40021896362}, "hist_stats": {"episode_reward": [57668.40021896362], "episode_lengths": [136], "policy_agent_0_reward": [57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.590815025217392, "mean_inference_ms": 6.051711475147921, "mean_action_processing_ms": 0.19687764784869027, "mean_env_wait_ms": 225.12136774904587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667572021484375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.19745826721191406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4042728061536, "num_env_steps_trained_throughput_per_sec": 294.4042728061536, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14449.433, "sample_time_ms": 11486.608, "learn_time_ms": 2825.981, "learn_throughput": 1415.438, "synch_weights_time_ms": 136.134}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 3008, "training_iteration": 104, "trial_id": "32397_00000", "date": "2025-03-21_09-02-22", "timestamp": 1742547742, "time_this_iter_s": 13.635772943496704, "time_total_s": 1513.6817479133606, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7025f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1513.6817479133606, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 99.50500000000002, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987056732177734, "policy_loss": -0.013000491075217724, "vf_loss": 10.0, "vf_explained_var": -1.2313947081565857e-05, "kl": 0.009161563590168953, "entropy": 0.2777943015098572, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 57668.40021896362, "episode_reward_min": 57668.40021896362, "episode_reward_mean": 57668.40021896362, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57668.40021896362}, "policy_reward_max": {"agent_0": 57668.40021896362}, "policy_reward_mean": {"agent_0": 57668.40021896362}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57668.40021896362], "episode_lengths": [136], "policy_agent_0_reward": [57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.590815025217392, "mean_inference_ms": 6.051711475147921, "mean_action_processing_ms": 0.19687764784869027, "mean_env_wait_ms": 225.12136774904587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667572021484375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.19745826721191406}}, "episode_reward_max": 57668.40021896362, "episode_reward_min": 57668.40021896362, "episode_reward_mean": 57668.40021896362, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57668.40021896362}, "policy_reward_max": {"agent_0": 57668.40021896362}, "policy_reward_mean": {"agent_0": 57668.40021896362}, "hist_stats": {"episode_reward": [57668.40021896362], "episode_lengths": [136], "policy_agent_0_reward": [57668.40021896362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.590815025217392, "mean_inference_ms": 6.051711475147921, "mean_action_processing_ms": 0.19687764784869027, "mean_env_wait_ms": 225.12136774904587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0667572021484375, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.19745826721191406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.85318432746556, "num_env_steps_trained_throughput_per_sec": 302.85318432746556, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 14277.223, "sample_time_ms": 11243.641, "learn_time_ms": 2889.515, "learn_throughput": 1384.315, "synch_weights_time_ms": 143.379}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 3008, "training_iteration": 105, "trial_id": "32397_00000", "date": "2025-03-21_09-02-35", "timestamp": 1742547755, "time_this_iter_s": 13.268152952194214, "time_total_s": 1526.9499008655548, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7176d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1526.9499008655548, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 99.55263157894737, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.757464408874512, "policy_loss": -0.013141174800693989, "vf_loss": 9.770547866821289, "vf_explained_var": -5.532676823349902e-07, "kl": 0.009315814822912216, "entropy": 0.31177863478660583, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 61695.16688537598, "episode_reward_min": 50745.720123291016, "episode_reward_mean": 57802.89069652298, "episode_len_mean": 136.2826086956522, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50745.720123291016}, "policy_reward_max": {"agent_0": 61695.16688537598}, "policy_reward_mean": {"agent_0": 57802.89069652298}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59654.293632507324, 55159.233560562134, 57062.08705329895, 60126.220153808594, 58348.506744384766, 54858.193608760834, 58899.18685913086, 59024.89387702942, 56936.760457992554, 57198.97360229492, 50745.720123291016, 59745.66665649414, 54910.18676376343, 58862.593688964844, 60629.400482177734, 61075.98680114746, 58287.3134765625, 60197.40670776367, 56636.30013847351, 57858.26014709473, 58295.28693819046, 58174.13376235962, 53725.12685108185, 54471.38682556152, 56803.9998922348, 58979.26022338867, 61074.35336303711, 58439.7668838501, 58776.34672546387, 60223.80015563965, 53654.73343086243, 53463.47333598137, 56510.13363838196, 53610.11355161667, 57669.76671600342, 57025.413635253906, 60655.04021072388, 60747.526916503906, 57370.59991455078, 59737.19354248047, 52898.173664569855, 57559.70669937134, 59229.773456573486, 52912.06003570557, 54741.513566970825, 60230.20703125, 55409.45993804932, 59750.63348388672, 59428.453716278076, 60431.913314819336, 54079.42686653137, 56714.07365274429, 57164.62012863159, 58860.33335876465, 53850.70031833649, 56826.58718299866, 59225.380043029785, 56020.5335521698, 59235.72677612305, 57723.95337677002, 60769.43397521973, 58079.22045326233, 57058.19350814819, 60496.82012939453, 58259.066749572754, 57437.513551712036, 53990.35345888138, 59408.07336425781, 60006.68020629883, 59868.333435058594, 60580.36680603027, 57465.73318481445, 59072.426877975464, 54861.546741485596, 56816.96018600464, 58620.127044677734, 59954.013732910156, 53992.60016441345, 60659.66030502319, 56977.17339706421, 54725.36680793762, 61695.16688537598, 59174.94690704346, 60431.626918792725, 60006.333404541016, 57398.800090789795, 59741.32685852051, 61514.133697509766, 60887.31335449219, 60305.38706970215, 54475.48686027527, 55217.88674068451], "episode_lengths": [136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 135, 137, 136, 136, 137, 137, 136, 136, 137, 136, 136, 137, 135, 135, 136, 136, 138, 137, 136, 138, 135, 136, 136, 135, 136, 136, 137, 137, 137, 137, 134, 136, 136, 135, 136, 137, 137, 137, 137, 137, 135, 137, 136, 136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 137, 135, 137, 134, 136, 137, 137, 137, 136, 137, 135, 136, 136, 136, 136, 137, 136, 136, 138, 137, 137, 137, 137, 137, 137, 138, 137, 136, 135], "policy_agent_0_reward": [59654.293632507324, 55159.233560562134, 57062.08705329895, 60126.220153808594, 58348.506744384766, 54858.193608760834, 58899.18685913086, 59024.89387702942, 56936.760457992554, 57198.97360229492, 50745.720123291016, 59745.66665649414, 54910.18676376343, 58862.593688964844, 60629.400482177734, 61075.98680114746, 58287.3134765625, 60197.40670776367, 56636.30013847351, 57858.26014709473, 58295.28693819046, 58174.13376235962, 53725.12685108185, 54471.38682556152, 56803.9998922348, 58979.26022338867, 61074.35336303711, 58439.7668838501, 58776.34672546387, 60223.80015563965, 53654.73343086243, 53463.47333598137, 56510.13363838196, 53610.11355161667, 57669.76671600342, 57025.413635253906, 60655.04021072388, 60747.526916503906, 57370.59991455078, 59737.19354248047, 52898.173664569855, 57559.70669937134, 59229.773456573486, 52912.06003570557, 54741.513566970825, 60230.20703125, 55409.45993804932, 59750.63348388672, 59428.453716278076, 60431.913314819336, 54079.42686653137, 56714.07365274429, 57164.62012863159, 58860.33335876465, 53850.70031833649, 56826.58718299866, 59225.380043029785, 56020.5335521698, 59235.72677612305, 57723.95337677002, 60769.43397521973, 58079.22045326233, 57058.19350814819, 60496.82012939453, 58259.066749572754, 57437.513551712036, 53990.35345888138, 59408.07336425781, 60006.68020629883, 59868.333435058594, 60580.36680603027, 57465.73318481445, 59072.426877975464, 54861.546741485596, 56816.96018600464, 58620.127044677734, 59954.013732910156, 53992.60016441345, 60659.66030502319, 56977.17339706421, 54725.36680793762, 61695.16688537598, 59174.94690704346, 60431.626918792725, 60006.333404541016, 57398.800090789795, 59741.32685852051, 61514.133697509766, 60887.31335449219, 60305.38706970215, 54475.48686027527, 55217.88674068451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.558374448406035, "mean_inference_ms": 6.755006298964908, "mean_action_processing_ms": 0.19790289331404215, "mean_env_wait_ms": 232.7213342001991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07267127866330354, "StateBufferConnector_ms": 0.006133577098017154, "ViewRequirementAgentConnector_ms": 0.19326572832853897}}, "episode_reward_max": 61695.16688537598, "episode_reward_min": 50745.720123291016, "episode_reward_mean": 57802.89069652298, "episode_len_mean": 136.2826086956522, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50745.720123291016}, "policy_reward_max": {"agent_0": 61695.16688537598}, "policy_reward_mean": {"agent_0": 57802.89069652298}, "hist_stats": {"episode_reward": [59654.293632507324, 55159.233560562134, 57062.08705329895, 60126.220153808594, 58348.506744384766, 54858.193608760834, 58899.18685913086, 59024.89387702942, 56936.760457992554, 57198.97360229492, 50745.720123291016, 59745.66665649414, 54910.18676376343, 58862.593688964844, 60629.400482177734, 61075.98680114746, 58287.3134765625, 60197.40670776367, 56636.30013847351, 57858.26014709473, 58295.28693819046, 58174.13376235962, 53725.12685108185, 54471.38682556152, 56803.9998922348, 58979.26022338867, 61074.35336303711, 58439.7668838501, 58776.34672546387, 60223.80015563965, 53654.73343086243, 53463.47333598137, 56510.13363838196, 53610.11355161667, 57669.76671600342, 57025.413635253906, 60655.04021072388, 60747.526916503906, 57370.59991455078, 59737.19354248047, 52898.173664569855, 57559.70669937134, 59229.773456573486, 52912.06003570557, 54741.513566970825, 60230.20703125, 55409.45993804932, 59750.63348388672, 59428.453716278076, 60431.913314819336, 54079.42686653137, 56714.07365274429, 57164.62012863159, 58860.33335876465, 53850.70031833649, 56826.58718299866, 59225.380043029785, 56020.5335521698, 59235.72677612305, 57723.95337677002, 60769.43397521973, 58079.22045326233, 57058.19350814819, 60496.82012939453, 58259.066749572754, 57437.513551712036, 53990.35345888138, 59408.07336425781, 60006.68020629883, 59868.333435058594, 60580.36680603027, 57465.73318481445, 59072.426877975464, 54861.546741485596, 56816.96018600464, 58620.127044677734, 59954.013732910156, 53992.60016441345, 60659.66030502319, 56977.17339706421, 54725.36680793762, 61695.16688537598, 59174.94690704346, 60431.626918792725, 60006.333404541016, 57398.800090789795, 59741.32685852051, 61514.133697509766, 60887.31335449219, 60305.38706970215, 54475.48686027527, 55217.88674068451], "episode_lengths": [136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 135, 137, 136, 136, 137, 137, 136, 136, 137, 136, 136, 137, 135, 135, 136, 136, 138, 137, 136, 138, 135, 136, 136, 135, 136, 136, 137, 137, 137, 137, 134, 136, 136, 135, 136, 137, 137, 137, 137, 137, 135, 137, 136, 136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 137, 135, 137, 134, 136, 137, 137, 137, 136, 137, 135, 136, 136, 136, 136, 137, 136, 136, 138, 137, 137, 137, 137, 137, 137, 138, 137, 136, 135], "policy_agent_0_reward": [59654.293632507324, 55159.233560562134, 57062.08705329895, 60126.220153808594, 58348.506744384766, 54858.193608760834, 58899.18685913086, 59024.89387702942, 56936.760457992554, 57198.97360229492, 50745.720123291016, 59745.66665649414, 54910.18676376343, 58862.593688964844, 60629.400482177734, 61075.98680114746, 58287.3134765625, 60197.40670776367, 56636.30013847351, 57858.26014709473, 58295.28693819046, 58174.13376235962, 53725.12685108185, 54471.38682556152, 56803.9998922348, 58979.26022338867, 61074.35336303711, 58439.7668838501, 58776.34672546387, 60223.80015563965, 53654.73343086243, 53463.47333598137, 56510.13363838196, 53610.11355161667, 57669.76671600342, 57025.413635253906, 60655.04021072388, 60747.526916503906, 57370.59991455078, 59737.19354248047, 52898.173664569855, 57559.70669937134, 59229.773456573486, 52912.06003570557, 54741.513566970825, 60230.20703125, 55409.45993804932, 59750.63348388672, 59428.453716278076, 60431.913314819336, 54079.42686653137, 56714.07365274429, 57164.62012863159, 58860.33335876465, 53850.70031833649, 56826.58718299866, 59225.380043029785, 56020.5335521698, 59235.72677612305, 57723.95337677002, 60769.43397521973, 58079.22045326233, 57058.19350814819, 60496.82012939453, 58259.066749572754, 57437.513551712036, 53990.35345888138, 59408.07336425781, 60006.68020629883, 59868.333435058594, 60580.36680603027, 57465.73318481445, 59072.426877975464, 54861.546741485596, 56816.96018600464, 58620.127044677734, 59954.013732910156, 53992.60016441345, 60659.66030502319, 56977.17339706421, 54725.36680793762, 61695.16688537598, 59174.94690704346, 60431.626918792725, 60006.333404541016, 57398.800090789795, 59741.32685852051, 61514.133697509766, 60887.31335449219, 60305.38706970215, 54475.48686027527, 55217.88674068451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.558374448406035, "mean_inference_ms": 6.755006298964908, "mean_action_processing_ms": 0.19790289331404215, "mean_env_wait_ms": 232.7213342001991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07267127866330354, "StateBufferConnector_ms": 0.006133577098017154, "ViewRequirementAgentConnector_ms": 0.19326572832853897}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.1279125238716, "num_env_steps_trained_throughput_per_sec": 257.1279125238716, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 14560.617, "sample_time_ms": 11533.69, "learn_time_ms": 2883.595, "learn_throughput": 1387.157, "synch_weights_time_ms": 142.632}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 3100, "training_iteration": 106, "trial_id": "32397_00000", "date": "2025-03-21_09-02-51", "timestamp": 1742547771, "time_this_iter_s": 15.622397661209106, "time_total_s": 1542.572298526764, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19e41ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1542.572298526764, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 96.28999999999999, "ram_util_percent": 13.485}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.910097122192383, "policy_loss": -0.01039742399007082, "vf_loss": 9.920411109924316, "vf_explained_var": -4.1685999008223007e-07, "kl": 0.013207570649683475, "entropy": 0.27934810519218445, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 61462.88671875, "episode_reward_min": 48793.12026953697, "episode_reward_mean": 57409.100790793076, "episode_len_mean": 136.3125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48793.12026953697}, "policy_reward_max": {"agent_0": 61462.88671875}, "policy_reward_mean": {"agent_0": 57409.100790793076}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57920.22002983093, 54038.08011627197, 56434.080196380615, 59384.33335876465, 61462.88671875, 57457.813484191895, 55273.9334564209, 59415.82692527771, 59410.21994018555, 58743.54677581787, 50877.56697654724, 59530.78005981445, 60574.12698364258, 59098.42063051462, 56489.48670196533, 48793.12026953697, 49856.660183906555, 60159.32669067383, 56012.393399477005, 58075.28038787842, 57452.739879608154, 58324.10698699951, 56165.8401889801, 59103.526876449585, 58882.68035507202, 61354.90707397461, 59910.626708984375, 58914.45327758789, 58924.873458862305, 55400.46025252342, 58162.353534698486, 55486.55342578888], "episode_lengths": [136, 136, 135, 137, 137, 136, 135, 138, 137, 137, 135, 138, 137, 137, 136, 135, 135, 137, 137, 137, 136, 136, 136, 137, 136, 137, 136, 136, 137, 135, 136, 136], "policy_agent_0_reward": [57920.22002983093, 54038.08011627197, 56434.080196380615, 59384.33335876465, 61462.88671875, 57457.813484191895, 55273.9334564209, 59415.82692527771, 59410.21994018555, 58743.54677581787, 50877.56697654724, 59530.78005981445, 60574.12698364258, 59098.42063051462, 56489.48670196533, 48793.12026953697, 49856.660183906555, 60159.32669067383, 56012.393399477005, 58075.28038787842, 57452.739879608154, 58324.10698699951, 56165.8401889801, 59103.526876449585, 58882.68035507202, 61354.90707397461, 59910.626708984375, 58914.45327758789, 58924.873458862305, 55400.46025252342, 58162.353534698486, 55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34278820382509, "mean_inference_ms": 6.3699679544125924, "mean_action_processing_ms": 0.20022143104608306, "mean_env_wait_ms": 217.58147278887094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0902026891708374, "StateBufferConnector_ms": 0.01893267035484314, "ViewRequirementAgentConnector_ms": 0.25371015071868896}}, "episode_reward_max": 61462.88671875, "episode_reward_min": 48793.12026953697, "episode_reward_mean": 57409.100790793076, "episode_len_mean": 136.3125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48793.12026953697}, "policy_reward_max": {"agent_0": 61462.88671875}, "policy_reward_mean": {"agent_0": 57409.100790793076}, "hist_stats": {"episode_reward": [57920.22002983093, 54038.08011627197, 56434.080196380615, 59384.33335876465, 61462.88671875, 57457.813484191895, 55273.9334564209, 59415.82692527771, 59410.21994018555, 58743.54677581787, 50877.56697654724, 59530.78005981445, 60574.12698364258, 59098.42063051462, 56489.48670196533, 48793.12026953697, 49856.660183906555, 60159.32669067383, 56012.393399477005, 58075.28038787842, 57452.739879608154, 58324.10698699951, 56165.8401889801, 59103.526876449585, 58882.68035507202, 61354.90707397461, 59910.626708984375, 58914.45327758789, 58924.873458862305, 55400.46025252342, 58162.353534698486, 55486.55342578888], "episode_lengths": [136, 136, 135, 137, 137, 136, 135, 138, 137, 137, 135, 138, 137, 137, 136, 135, 135, 137, 137, 137, 136, 136, 136, 137, 136, 137, 136, 136, 137, 135, 136, 136], "policy_agent_0_reward": [57920.22002983093, 54038.08011627197, 56434.080196380615, 59384.33335876465, 61462.88671875, 57457.813484191895, 55273.9334564209, 59415.82692527771, 59410.21994018555, 58743.54677581787, 50877.56697654724, 59530.78005981445, 60574.12698364258, 59098.42063051462, 56489.48670196533, 48793.12026953697, 49856.660183906555, 60159.32669067383, 56012.393399477005, 58075.28038787842, 57452.739879608154, 58324.10698699951, 56165.8401889801, 59103.526876449585, 58882.68035507202, 61354.90707397461, 59910.626708984375, 58914.45327758789, 58924.873458862305, 55400.46025252342, 58162.353534698486, 55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34278820382509, "mean_inference_ms": 6.3699679544125924, "mean_action_processing_ms": 0.20022143104608306, "mean_env_wait_ms": 217.58147278887094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0902026891708374, "StateBufferConnector_ms": 0.01893267035484314, "ViewRequirementAgentConnector_ms": 0.25371015071868896}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.0794475850007, "num_env_steps_trained_throughput_per_sec": 280.0794475850007, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 14695.772, "sample_time_ms": 11667.347, "learn_time_ms": 2887.914, "learn_throughput": 1385.083, "synch_weights_time_ms": 139.819}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 3132, "training_iteration": 107, "trial_id": "32397_00000", "date": "2025-03-21_09-03-05", "timestamp": 1742547785, "time_this_iter_s": 14.335463047027588, "time_total_s": 1556.9077615737915, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb717a30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1556.9077615737915, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 99.44500000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98712158203125, "policy_loss": -0.012954278849065304, "vf_loss": 10.0, "vf_explained_var": -1.7819305142552366e-08, "kl": 0.012228548526763916, "entropy": 0.24709324538707733, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 55486.55342578888, "episode_reward_min": 55486.55342578888, "episode_reward_mean": 55486.55342578888, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55486.55342578888}, "policy_reward_max": {"agent_0": 55486.55342578888}, "policy_reward_mean": {"agent_0": 55486.55342578888}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55486.55342578888], "episode_lengths": [136], "policy_agent_0_reward": [55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.057182484817936, "mean_inference_ms": 6.029991844367333, "mean_action_processing_ms": 0.19650146078280387, "mean_env_wait_ms": 224.70830284725636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.18355846405029297}}, "episode_reward_max": 55486.55342578888, "episode_reward_min": 55486.55342578888, "episode_reward_mean": 55486.55342578888, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55486.55342578888}, "policy_reward_max": {"agent_0": 55486.55342578888}, "policy_reward_mean": {"agent_0": 55486.55342578888}, "hist_stats": {"episode_reward": [55486.55342578888], "episode_lengths": [136], "policy_agent_0_reward": [55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.057182484817936, "mean_inference_ms": 6.029991844367333, "mean_action_processing_ms": 0.19650146078280387, "mean_env_wait_ms": 224.70830284725636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.18355846405029297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.27045365553846, "num_env_steps_trained_throughput_per_sec": 321.27045365553846, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14314.978, "sample_time_ms": 11255.547, "learn_time_ms": 2921.423, "learn_throughput": 1369.196, "synch_weights_time_ms": 137.32}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 3132, "training_iteration": 108, "trial_id": "32397_00000", "date": "2025-03-21_09-03-18", "timestamp": 1742547798, "time_this_iter_s": 12.495848417282104, "time_total_s": 1569.4036099910736, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb942ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1569.4036099910736, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 99.6388888888889, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98780345916748, "policy_loss": -0.012252827174961567, "vf_loss": 10.0, "vf_explained_var": -2.257525864024501e-07, "kl": 0.009058473631739616, "entropy": 0.2759232819080353, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 55486.55342578888, "episode_reward_min": 55486.55342578888, "episode_reward_mean": 55486.55342578888, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55486.55342578888}, "policy_reward_max": {"agent_0": 55486.55342578888}, "policy_reward_mean": {"agent_0": 55486.55342578888}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55486.55342578888], "episode_lengths": [136], "policy_agent_0_reward": [55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.057182484817936, "mean_inference_ms": 6.029991844367333, "mean_action_processing_ms": 0.19650146078280387, "mean_env_wait_ms": 224.70830284725636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.18355846405029297}}, "episode_reward_max": 55486.55342578888, "episode_reward_min": 55486.55342578888, "episode_reward_mean": 55486.55342578888, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55486.55342578888}, "policy_reward_max": {"agent_0": 55486.55342578888}, "policy_reward_mean": {"agent_0": 55486.55342578888}, "hist_stats": {"episode_reward": [55486.55342578888], "episode_lengths": [136], "policy_agent_0_reward": [55486.55342578888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.057182484817936, "mean_inference_ms": 6.029991844367333, "mean_action_processing_ms": 0.19650146078280387, "mean_env_wait_ms": 224.70830284725636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04343986511230469, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.18355846405029297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.73010245541684, "num_env_steps_trained_throughput_per_sec": 302.73010245541684, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 14058.121, "sample_time_ms": 10988.169, "learn_time_ms": 2930.191, "learn_throughput": 1365.099, "synch_weights_time_ms": 139.072}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 3132, "training_iteration": 109, "trial_id": "32397_00000", "date": "2025-03-21_09-03-31", "timestamp": 1742547811, "time_this_iter_s": 13.268234968185425, "time_total_s": 1582.671844959259, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb717a30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1582.671844959259, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 99.48947368421052, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.879613876342773, "policy_loss": -0.007157435175031424, "vf_loss": 9.88671875, "vf_explained_var": -8.593623874730838e-07, "kl": 0.008413133211433887, "entropy": 0.2845149040222168, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 62657.040130615234, "episode_reward_min": 53181.46018791199, "episode_reward_mean": 58409.270440779794, "episode_len_mean": 136.42222222222222, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {"agent_0": 53181.46018791199}, "policy_reward_max": {"agent_0": 62657.040130615234}, "policy_reward_mean": {"agent_0": 58409.270440779794}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60474.22035217285, 59890.32012939453, 59644.473403930664, 61170.44697570801, 59498.12026977539, 58679.26036834717, 59171.0136756897, 57430.693367004395, 58830.69341850281, 53181.46018791199, 59509.12042236328, 58957.28691101074, 62657.040130615234, 59317.23344421387, 58774.27333068848, 60638.89372253418, 56886.66023826599, 60249.2936706543, 59076.980463027954, 59591.553771972656, 58095.07997131348, 53910.533641815186, 61133.680099487305, 59388.540100097656, 57950.48706150055, 53497.66038894653, 53905.08013725281, 56500.43332672119, 56311.24009132385, 55049.64012336731, 60275.673416137695, 58821.15351486206, 59291.74694824219, 58997.48027038574, 59359.09359741211, 55507.29343986511, 55061.99330711365, 57843.96012878418, 59574.773918151855, 59518.67364501953, 57820.14016151428, 60332.16030883789, 59969.04008483887, 57573.646896362305, 59098.927001953125], "episode_lengths": [137, 136, 137, 139, 137, 137, 137, 137, 136, 135, 137, 136, 138, 137, 136, 137, 135, 137, 137, 136, 136, 135, 137, 136, 136, 136, 136, 136, 136, 136, 137, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 137, 136, 137], "policy_agent_0_reward": [60474.22035217285, 59890.32012939453, 59644.473403930664, 61170.44697570801, 59498.12026977539, 58679.26036834717, 59171.0136756897, 57430.693367004395, 58830.69341850281, 53181.46018791199, 59509.12042236328, 58957.28691101074, 62657.040130615234, 59317.23344421387, 58774.27333068848, 60638.89372253418, 56886.66023826599, 60249.2936706543, 59076.980463027954, 59591.553771972656, 58095.07997131348, 53910.533641815186, 61133.680099487305, 59388.540100097656, 57950.48706150055, 53497.66038894653, 53905.08013725281, 56500.43332672119, 56311.24009132385, 55049.64012336731, 60275.673416137695, 58821.15351486206, 59291.74694824219, 58997.48027038574, 59359.09359741211, 55507.29343986511, 55061.99330711365, 57843.96012878418, 59574.773918151855, 59518.67364501953, 57820.14016151428, 60332.16030883789, 59969.04008483887, 57573.646896362305, 59098.927001953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.454684215464876, "mean_inference_ms": 6.750030083310071, "mean_action_processing_ms": 0.19710690432956043, "mean_env_wait_ms": 233.8712376927362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03913985358344184, "StateBufferConnector_ms": 0.006419817606608073, "ViewRequirementAgentConnector_ms": 0.20286136203342015}}, "episode_reward_max": 62657.040130615234, "episode_reward_min": 53181.46018791199, "episode_reward_mean": 58409.270440779794, "episode_len_mean": 136.42222222222222, "episodes_this_iter": 45, "policy_reward_min": {"agent_0": 53181.46018791199}, "policy_reward_max": {"agent_0": 62657.040130615234}, "policy_reward_mean": {"agent_0": 58409.270440779794}, "hist_stats": {"episode_reward": [60474.22035217285, 59890.32012939453, 59644.473403930664, 61170.44697570801, 59498.12026977539, 58679.26036834717, 59171.0136756897, 57430.693367004395, 58830.69341850281, 53181.46018791199, 59509.12042236328, 58957.28691101074, 62657.040130615234, 59317.23344421387, 58774.27333068848, 60638.89372253418, 56886.66023826599, 60249.2936706543, 59076.980463027954, 59591.553771972656, 58095.07997131348, 53910.533641815186, 61133.680099487305, 59388.540100097656, 57950.48706150055, 53497.66038894653, 53905.08013725281, 56500.43332672119, 56311.24009132385, 55049.64012336731, 60275.673416137695, 58821.15351486206, 59291.74694824219, 58997.48027038574, 59359.09359741211, 55507.29343986511, 55061.99330711365, 57843.96012878418, 59574.773918151855, 59518.67364501953, 57820.14016151428, 60332.16030883789, 59969.04008483887, 57573.646896362305, 59098.927001953125], "episode_lengths": [137, 136, 137, 139, 137, 137, 137, 137, 136, 135, 137, 136, 138, 137, 136, 137, 135, 137, 137, 136, 136, 135, 137, 136, 136, 136, 136, 136, 136, 136, 137, 136, 136, 137, 137, 136, 136, 136, 136, 136, 136, 136, 137, 136, 137], "policy_agent_0_reward": [60474.22035217285, 59890.32012939453, 59644.473403930664, 61170.44697570801, 59498.12026977539, 58679.26036834717, 59171.0136756897, 57430.693367004395, 58830.69341850281, 53181.46018791199, 59509.12042236328, 58957.28691101074, 62657.040130615234, 59317.23344421387, 58774.27333068848, 60638.89372253418, 56886.66023826599, 60249.2936706543, 59076.980463027954, 59591.553771972656, 58095.07997131348, 53910.533641815186, 61133.680099487305, 59388.540100097656, 57950.48706150055, 53497.66038894653, 53905.08013725281, 56500.43332672119, 56311.24009132385, 55049.64012336731, 60275.673416137695, 58821.15351486206, 59291.74694824219, 58997.48027038574, 59359.09359741211, 55507.29343986511, 55061.99330711365, 57843.96012878418, 59574.773918151855, 59518.67364501953, 57820.14016151428, 60332.16030883789, 59969.04008483887, 57573.646896362305, 59098.927001953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.454684215464876, "mean_inference_ms": 6.750030083310071, "mean_action_processing_ms": 0.19710690432956043, "mean_env_wait_ms": 233.8712376927362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03913985358344184, "StateBufferConnector_ms": 0.006419817606608073, "ViewRequirementAgentConnector_ms": 0.20286136203342015}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.1310274230534, "num_env_steps_trained_throughput_per_sec": 296.1310274230534, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 14141.997, "sample_time_ms": 11162.218, "learn_time_ms": 2845.974, "learn_throughput": 1405.494, "synch_weights_time_ms": 133.123}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 3177, "training_iteration": 110, "trial_id": "32397_00000", "date": "2025-03-21_09-03-45", "timestamp": 1742547825, "time_this_iter_s": 13.550622701644897, "time_total_s": 1596.222467660904, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1596.222467660904, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 97.97222222222223, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.6103896103896105, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.793508529663086, "policy_loss": -0.015452849678695202, "vf_loss": 9.808838844299316, "vf_explained_var": 9.81924472398532e-07, "kl": 0.019580455496907234, "entropy": 0.26313865184783936, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 62335.6201171875, "episode_reward_min": 51880.3466796875, "episode_reward_mean": 58875.850028767985, "episode_len_mean": 136.75324675324674, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 51880.3466796875}, "policy_reward_max": {"agent_0": 62335.6201171875}, "policy_reward_mean": {"agent_0": 58875.850028767985}, "custom_metrics": {"num_batches_mean": 5.6103896103896105, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60099.21376037598, 59083.880058288574, 58724.273537158966, 55422.59342956543, 61572.36014556885, 58654.193744659424, 56533.54662322998, 60064.13362121582, 61427.03381347656, 59048.54699707031, 60193.473556518555, 56442.81339120865, 60250.12677001953, 58950.326862335205, 60986.60703277588, 58914.713609695435, 56770.460431456566, 61484.113677978516, 61158.80052947998, 59751.26036071777, 53546.16003990173, 60067.54022216797, 59908.35367202759, 60968.81369018555, 61736.987060546875, 52537.27359676361, 53488.29338169098, 59933.273418426514, 58442.20688247681, 58527.44691467285, 59743.180295944214, 59587.96682739258, 55008.35345077515, 51880.3466796875, 61266.013427734375, 60241.48031616211, 59289.42000579834, 58917.52012634277, 61354.82711791992, 57344.08050727844, 58335.9801864624, 60052.320373535156, 59872.64010620117, 59263.92710876465, 59015.406829833984, 57008.96700668335, 60515.286865234375, 58111.65342140198, 58497.34060961008, 56538.10670852661, 59889.07371520996, 62335.6201171875, 59600.74019241333, 61709.73361206055, 59577.34023475647, 59074.900390625, 60367.10021972656, 60017.526947021484, 56355.00037574768, 59999.22695207596, 59600.02674865723, 58199.20016479492, 57504.10693359375, 57181.16686248779, 59765.020305633545, 59953.98667907715, 57002.287046432495, 59346.50703430176, 58772.02020263672, 58997.96701049805, 59277.50033569336, 59369.120178222656, 58039.47314453125, 60339.33352661133, 59380.55383300781, 58791.906829833984, 56460.373819351196], "episode_lengths": [137, 137, 136, 135, 137, 136, 136, 137, 138, 137, 136, 136, 137, 137, 137, 137, 137, 138, 137, 137, 136, 137, 137, 137, 137, 136, 136, 137, 137, 137, 137, 137, 136, 136, 137, 137, 137, 137, 137, 137, 137, 137, 137, 136, 136, 136, 137, 136, 137, 136, 137, 138, 136, 138, 138, 136, 138, 137, 136, 136, 137, 136, 137, 136, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 137, 137, 137], "policy_agent_0_reward": [60099.21376037598, 59083.880058288574, 58724.273537158966, 55422.59342956543, 61572.36014556885, 58654.193744659424, 56533.54662322998, 60064.13362121582, 61427.03381347656, 59048.54699707031, 60193.473556518555, 56442.81339120865, 60250.12677001953, 58950.326862335205, 60986.60703277588, 58914.713609695435, 56770.460431456566, 61484.113677978516, 61158.80052947998, 59751.26036071777, 53546.16003990173, 60067.54022216797, 59908.35367202759, 60968.81369018555, 61736.987060546875, 52537.27359676361, 53488.29338169098, 59933.273418426514, 58442.20688247681, 58527.44691467285, 59743.180295944214, 59587.96682739258, 55008.35345077515, 51880.3466796875, 61266.013427734375, 60241.48031616211, 59289.42000579834, 58917.52012634277, 61354.82711791992, 57344.08050727844, 58335.9801864624, 60052.320373535156, 59872.64010620117, 59263.92710876465, 59015.406829833984, 57008.96700668335, 60515.286865234375, 58111.65342140198, 58497.34060961008, 56538.10670852661, 59889.07371520996, 62335.6201171875, 59600.74019241333, 61709.73361206055, 59577.34023475647, 59074.900390625, 60367.10021972656, 60017.526947021484, 56355.00037574768, 59999.22695207596, 59600.02674865723, 58199.20016479492, 57504.10693359375, 57181.16686248779, 59765.020305633545, 59953.98667907715, 57002.287046432495, 59346.50703430176, 58772.02020263672, 58997.96701049805, 59277.50033569336, 59369.120178222656, 58039.47314453125, 60339.33352661133, 59380.55383300781, 58791.906829833984, 56460.373819351196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.703375212072817, "mean_inference_ms": 6.596683308041623, "mean_action_processing_ms": 0.19933870120890132, "mean_env_wait_ms": 226.53544144114318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03758188966032747, "StateBufferConnector_ms": 0.0058217482133345174, "ViewRequirementAgentConnector_ms": 0.1734105023470792}}, "episode_reward_max": 62335.6201171875, "episode_reward_min": 51880.3466796875, "episode_reward_mean": 58875.850028767985, "episode_len_mean": 136.75324675324674, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 51880.3466796875}, "policy_reward_max": {"agent_0": 62335.6201171875}, "policy_reward_mean": {"agent_0": 58875.850028767985}, "hist_stats": {"episode_reward": [60099.21376037598, 59083.880058288574, 58724.273537158966, 55422.59342956543, 61572.36014556885, 58654.193744659424, 56533.54662322998, 60064.13362121582, 61427.03381347656, 59048.54699707031, 60193.473556518555, 56442.81339120865, 60250.12677001953, 58950.326862335205, 60986.60703277588, 58914.713609695435, 56770.460431456566, 61484.113677978516, 61158.80052947998, 59751.26036071777, 53546.16003990173, 60067.54022216797, 59908.35367202759, 60968.81369018555, 61736.987060546875, 52537.27359676361, 53488.29338169098, 59933.273418426514, 58442.20688247681, 58527.44691467285, 59743.180295944214, 59587.96682739258, 55008.35345077515, 51880.3466796875, 61266.013427734375, 60241.48031616211, 59289.42000579834, 58917.52012634277, 61354.82711791992, 57344.08050727844, 58335.9801864624, 60052.320373535156, 59872.64010620117, 59263.92710876465, 59015.406829833984, 57008.96700668335, 60515.286865234375, 58111.65342140198, 58497.34060961008, 56538.10670852661, 59889.07371520996, 62335.6201171875, 59600.74019241333, 61709.73361206055, 59577.34023475647, 59074.900390625, 60367.10021972656, 60017.526947021484, 56355.00037574768, 59999.22695207596, 59600.02674865723, 58199.20016479492, 57504.10693359375, 57181.16686248779, 59765.020305633545, 59953.98667907715, 57002.287046432495, 59346.50703430176, 58772.02020263672, 58997.96701049805, 59277.50033569336, 59369.120178222656, 58039.47314453125, 60339.33352661133, 59380.55383300781, 58791.906829833984, 56460.373819351196], "episode_lengths": [137, 137, 136, 135, 137, 136, 136, 137, 138, 137, 136, 136, 137, 137, 137, 137, 137, 138, 137, 137, 136, 137, 137, 137, 137, 136, 136, 137, 137, 137, 137, 137, 136, 136, 137, 137, 137, 137, 137, 137, 137, 137, 137, 136, 136, 136, 137, 136, 137, 136, 137, 138, 136, 138, 138, 136, 138, 137, 136, 136, 137, 136, 137, 136, 137, 137, 137, 137, 137, 136, 137, 137, 136, 137, 137, 137, 137], "policy_agent_0_reward": [60099.21376037598, 59083.880058288574, 58724.273537158966, 55422.59342956543, 61572.36014556885, 58654.193744659424, 56533.54662322998, 60064.13362121582, 61427.03381347656, 59048.54699707031, 60193.473556518555, 56442.81339120865, 60250.12677001953, 58950.326862335205, 60986.60703277588, 58914.713609695435, 56770.460431456566, 61484.113677978516, 61158.80052947998, 59751.26036071777, 53546.16003990173, 60067.54022216797, 59908.35367202759, 60968.81369018555, 61736.987060546875, 52537.27359676361, 53488.29338169098, 59933.273418426514, 58442.20688247681, 58527.44691467285, 59743.180295944214, 59587.96682739258, 55008.35345077515, 51880.3466796875, 61266.013427734375, 60241.48031616211, 59289.42000579834, 58917.52012634277, 61354.82711791992, 57344.08050727844, 58335.9801864624, 60052.320373535156, 59872.64010620117, 59263.92710876465, 59015.406829833984, 57008.96700668335, 60515.286865234375, 58111.65342140198, 58497.34060961008, 56538.10670852661, 59889.07371520996, 62335.6201171875, 59600.74019241333, 61709.73361206055, 59577.34023475647, 59074.900390625, 60367.10021972656, 60017.526947021484, 56355.00037574768, 59999.22695207596, 59600.02674865723, 58199.20016479492, 57504.10693359375, 57181.16686248779, 59765.020305633545, 59953.98667907715, 57002.287046432495, 59346.50703430176, 58772.02020263672, 58997.96701049805, 59277.50033569336, 59369.120178222656, 58039.47314453125, 60339.33352661133, 59380.55383300781, 58791.906829833984, 56460.373819351196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.703375212072817, "mean_inference_ms": 6.596683308041623, "mean_action_processing_ms": 0.19933870120890132, "mean_env_wait_ms": 226.53544144114318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03758188966032747, "StateBufferConnector_ms": 0.0058217482133345174, "ViewRequirementAgentConnector_ms": 0.1734105023470792}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.26808013439418, "num_env_steps_trained_throughput_per_sec": 204.26808013439418, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 14703.883, "sample_time_ms": 11832.948, "learn_time_ms": 2738.294, "learn_throughput": 1460.764, "synch_weights_time_ms": 131.963}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 3254, "training_iteration": 111, "trial_id": "32397_00000", "date": "2025-03-21_09-04-05", "timestamp": 1742547845, "time_this_iter_s": 19.644758701324463, "time_total_s": 1615.8672263622284, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7015a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1615.8672263622284, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 98.544, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986096382141113, "policy_loss": -0.009090048260986805, "vf_loss": 9.9951171875, "vf_explained_var": 1.5404074815705826e-07, "kl": 0.011035224422812462, "entropy": 0.3728538751602173, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 60918.0535736084, "episode_reward_min": 57404.16682624817, "episode_reward_mean": 59161.110199928284, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 57404.16682624817}, "policy_reward_max": {"agent_0": 60918.0535736084}, "policy_reward_mean": {"agent_0": 59161.110199928284}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60918.0535736084, 57404.16682624817], "episode_lengths": [138, 136], "policy_agent_0_reward": [60918.0535736084, 57404.16682624817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.88666012753401, "mean_inference_ms": 6.576478626394646, "mean_action_processing_ms": 0.1973986851385487, "mean_env_wait_ms": 218.29666448406897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035059452056884766, "StateBufferConnector_ms": 0.005412101745605469, "ViewRequirementAgentConnector_ms": 0.15113353729248047}}, "episode_reward_max": 60918.0535736084, "episode_reward_min": 57404.16682624817, "episode_reward_mean": 59161.110199928284, "episode_len_mean": 137.0, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 57404.16682624817}, "policy_reward_max": {"agent_0": 60918.0535736084}, "policy_reward_mean": {"agent_0": 59161.110199928284}, "hist_stats": {"episode_reward": [60918.0535736084, 57404.16682624817], "episode_lengths": [138, 136], "policy_agent_0_reward": [60918.0535736084, 57404.16682624817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.88666012753401, "mean_inference_ms": 6.576478626394646, "mean_action_processing_ms": 0.1973986851385487, "mean_env_wait_ms": 218.29666448406897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035059452056884766, "StateBufferConnector_ms": 0.005412101745605469, "ViewRequirementAgentConnector_ms": 0.15113353729248047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2660310649888, "num_env_steps_trained_throughput_per_sec": 307.2660310649888, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14397.504, "sample_time_ms": 11481.526, "learn_time_ms": 2781.35, "learn_throughput": 1438.15, "synch_weights_time_ms": 133.962}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 3256, "training_iteration": 112, "trial_id": "32397_00000", "date": "2025-03-21_09-04-18", "timestamp": 1742547858, "time_this_iter_s": 13.075851202011108, "time_total_s": 1628.9430775642395, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1628.9430775642395, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 99.54736842105264, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985296249389648, "policy_loss": -0.014774837531149387, "vf_loss": 10.0, "vf_explained_var": 1.1324882365215672e-07, "kl": 0.011403932236135006, "entropy": 0.3840586245059967, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 57404.16682624817, "episode_reward_min": 57404.16682624817, "episode_reward_mean": 57404.16682624817, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57404.16682624817}, "policy_reward_max": {"agent_0": 57404.16682624817}, "policy_reward_mean": {"agent_0": 57404.16682624817}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57404.16682624817], "episode_lengths": [136], "policy_agent_0_reward": [57404.16682624817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.412094337539738, "mean_inference_ms": 6.684042293702328, "mean_action_processing_ms": 0.19598355446759516, "mean_env_wait_ms": 222.67664326891438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034499168395996094, "StateBufferConnector_ms": 0.0052928924560546875, "ViewRequirementAgentConnector_ms": 0.1480579376220703}}, "episode_reward_max": 57404.16682624817, "episode_reward_min": 57404.16682624817, "episode_reward_mean": 57404.16682624817, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57404.16682624817}, "policy_reward_max": {"agent_0": 57404.16682624817}, "policy_reward_mean": {"agent_0": 57404.16682624817}, "hist_stats": {"episode_reward": [57404.16682624817], "episode_lengths": [136], "policy_agent_0_reward": [57404.16682624817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.412094337539738, "mean_inference_ms": 6.684042293702328, "mean_action_processing_ms": 0.19598355446759516, "mean_env_wait_ms": 222.67664326891438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034499168395996094, "StateBufferConnector_ms": 0.0052928924560546875, "ViewRequirementAgentConnector_ms": 0.1480579376220703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.78956265205915, "num_env_steps_trained_throughput_per_sec": 296.78956265205915, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 14188.101, "sample_time_ms": 11238.913, "learn_time_ms": 2809.453, "learn_throughput": 1423.765, "synch_weights_time_ms": 139.079}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 3256, "training_iteration": 113, "trial_id": "32397_00000", "date": "2025-03-21_09-04-31", "timestamp": 1742547871, "time_this_iter_s": 13.535520792007446, "time_total_s": 1642.478598356247, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fba484c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1642.478598356247, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 99.56315789473686, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984663963317871, "policy_loss": -0.012969885021448135, "vf_loss": 9.99755859375, "vf_explained_var": -3.433475725955759e-08, "kl": 0.011876515112817287, "entropy": 0.3908105194568634, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 56709.73349380493, "episode_reward_min": 56709.73349380493, "episode_reward_mean": 56709.73349380493, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56709.73349380493}, "policy_reward_max": {"agent_0": 56709.73349380493}, "policy_reward_mean": {"agent_0": 56709.73349380493}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56709.73349380493], "episode_lengths": [135], "policy_agent_0_reward": [56709.73349380493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.185314822438713, "mean_inference_ms": 6.438716858110875, "mean_action_processing_ms": 0.19307409648733226, "mean_env_wait_ms": 231.1251312453442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03826618194580078, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.16527175903320312}}, "episode_reward_max": 56709.73349380493, "episode_reward_min": 56709.73349380493, "episode_reward_mean": 56709.73349380493, "episode_len_mean": 135.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56709.73349380493}, "policy_reward_max": {"agent_0": 56709.73349380493}, "policy_reward_mean": {"agent_0": 56709.73349380493}, "hist_stats": {"episode_reward": [56709.73349380493], "episode_lengths": [135], "policy_agent_0_reward": [56709.73349380493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.185314822438713, "mean_inference_ms": 6.438716858110875, "mean_action_processing_ms": 0.19307409648733226, "mean_env_wait_ms": 231.1251312453442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03826618194580078, "StateBufferConnector_ms": 0.006318092346191406, "ViewRequirementAgentConnector_ms": 0.16527175903320312}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.2494494247831, "num_env_steps_trained_throughput_per_sec": 312.2494494247831, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 14110.451, "sample_time_ms": 11160.232, "learn_time_ms": 2805.301, "learn_throughput": 1425.872, "synch_weights_time_ms": 144.275}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 3257, "training_iteration": 114, "trial_id": "32397_00000", "date": "2025-03-21_09-04-44", "timestamp": 1742547884, "time_this_iter_s": 12.85407018661499, "time_total_s": 1655.332668542862, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb701510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1655.332668542862, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 99.47222222222223, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.254385964912281, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.701558113098145, "policy_loss": -0.014830727130174637, "vf_loss": 9.716310501098633, "vf_explained_var": 2.9491880937371207e-08, "kl": 0.012790418229997158, "entropy": 0.39394721388816833, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 62088.00695800781, "episode_reward_min": 46298.706897735596, "episode_reward_mean": 57684.9613797398, "episode_len_mean": 136.140350877193, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {"agent_0": 46298.706897735596}, "policy_reward_max": {"agent_0": 62088.00695800781}, "policy_reward_mean": {"agent_0": 57684.9613797398}, "custom_metrics": {"num_batches_mean": 5.254385964912281, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60264.5467376709, 55790.97378826141, 46298.706897735596, 59768.68682861328, 56768.75347328186, 58078.4199886322, 59166.24678039551, 58205.69348907471, 53372.90676039457, 59016.213607788086, 50526.27998304367, 51088.406953811646, 58740.55354309082, 59586.6600189209, 54658.46692657471, 55010.160157203674, 57796.47371864319, 51186.17350566387, 59629.933532714844, 56325.446645736694, 59477.286865234375, 55069.68675804138, 58114.94041442871, 55328.240026474, 60307.61349487305, 59800.100189208984, 57906.426918029785, 57912.480306625366, 61157.88668823242, 59167.16017150879, 59233.33343887329, 54785.23379230499, 60207.706928253174, 56536.607358932495, 56744.04016876221, 55509.66699028015, 52132.66021537781, 60655.027030944824, 55907.966817855835, 60302.30667114258, 59598.97341156006, 56727.573680877686, 58901.20684814453, 58080.413555145264, 58898.453521728516, 58666.46699523926, 59444.74024963379, 61454.17385864258, 56821.98673629761, 51224.03339385986, 57040.066930770874, 58978.793365478516, 57719.35376358032, 60140.48683166504, 59692.006896972656, 58744.160568237305, 59598.360427856445, 61063.90685272217, 56420.693408966064, 57573.31365966797, 59918.32702636719, 61263.3935546875, 55523.90010070801, 61150.02053833008, 52479.466893196106, 61373.42691040039, 60155.42051696777, 57261.46698760986, 57217.77358627319, 58641.49387359619, 57565.08020591736, 59258.247131347656, 54331.54007148743, 59155.74701499939, 60063.893615722656, 62088.00695800781, 56015.50691986084, 51663.84017944336, 58587.093688964844, 59909.38676452637, 52941.14015710354, 56389.20017242432, 61064.086822509766, 58370.520332336426, 60757.46697998047, 59976.30054473877, 59428.7003326416, 58121.40686035156, 57530.09317779541, 55372.67337799072, 59291.22689819336, 54996.42033004761, 57648.55334472656, 57992.179931640625, 57557.4133682251, 55256.65997314453, 55329.64012467861, 53557.940103530884, 59107.133560180664, 61816.49353027344, 57713.76010417938, 57445.5933303833, 58206.653411865234, 59464.933532714844, 60191.879943847656, 56516.606872558594, 58412.90037536621, 59447.61343383789, 55950.68688964844, 59000.05342102051, 59357.11373901367, 59328.23332977295, 57959.19337463379, 56636.85353088379], "episode_lengths": [137, 136, 135, 136, 137, 136, 137, 137, 135, 136, 134, 135, 136, 137, 136, 136, 137, 135, 136, 135, 136, 135, 136, 135, 136, 136, 136, 137, 138, 136, 137, 136, 137, 136, 136, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 138, 137, 135, 136, 136, 136, 138, 137, 136, 136, 137, 136, 136, 137, 138, 136, 137, 135, 137, 136, 135, 136, 137, 136, 136, 134, 137, 137, 137, 136, 134, 136, 137, 135, 135, 137, 136, 137, 136, 137, 135, 136, 136, 136, 135, 136, 136, 135, 136, 136, 135, 136, 138, 136, 136, 136, 137, 137, 135, 135, 137, 136, 137, 136, 137, 136, 135], "policy_agent_0_reward": [60264.5467376709, 55790.97378826141, 46298.706897735596, 59768.68682861328, 56768.75347328186, 58078.4199886322, 59166.24678039551, 58205.69348907471, 53372.90676039457, 59016.213607788086, 50526.27998304367, 51088.406953811646, 58740.55354309082, 59586.6600189209, 54658.46692657471, 55010.160157203674, 57796.47371864319, 51186.17350566387, 59629.933532714844, 56325.446645736694, 59477.286865234375, 55069.68675804138, 58114.94041442871, 55328.240026474, 60307.61349487305, 59800.100189208984, 57906.426918029785, 57912.480306625366, 61157.88668823242, 59167.16017150879, 59233.33343887329, 54785.23379230499, 60207.706928253174, 56536.607358932495, 56744.04016876221, 55509.66699028015, 52132.66021537781, 60655.027030944824, 55907.966817855835, 60302.30667114258, 59598.97341156006, 56727.573680877686, 58901.20684814453, 58080.413555145264, 58898.453521728516, 58666.46699523926, 59444.74024963379, 61454.17385864258, 56821.98673629761, 51224.03339385986, 57040.066930770874, 58978.793365478516, 57719.35376358032, 60140.48683166504, 59692.006896972656, 58744.160568237305, 59598.360427856445, 61063.90685272217, 56420.693408966064, 57573.31365966797, 59918.32702636719, 61263.3935546875, 55523.90010070801, 61150.02053833008, 52479.466893196106, 61373.42691040039, 60155.42051696777, 57261.46698760986, 57217.77358627319, 58641.49387359619, 57565.08020591736, 59258.247131347656, 54331.54007148743, 59155.74701499939, 60063.893615722656, 62088.00695800781, 56015.50691986084, 51663.84017944336, 58587.093688964844, 59909.38676452637, 52941.14015710354, 56389.20017242432, 61064.086822509766, 58370.520332336426, 60757.46697998047, 59976.30054473877, 59428.7003326416, 58121.40686035156, 57530.09317779541, 55372.67337799072, 59291.22689819336, 54996.42033004761, 57648.55334472656, 57992.179931640625, 57557.4133682251, 55256.65997314453, 55329.64012467861, 53557.940103530884, 59107.133560180664, 61816.49353027344, 57713.76010417938, 57445.5933303833, 58206.653411865234, 59464.933532714844, 60191.879943847656, 56516.606872558594, 58412.90037536621, 59447.61343383789, 55950.68688964844, 59000.05342102051, 59357.11373901367, 59328.23332977295, 57959.19337463379, 56636.85353088379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.00523625821628, "mean_inference_ms": 6.661129163985742, "mean_action_processing_ms": 0.19859784514411538, "mean_env_wait_ms": 229.69807546491774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03859662173087137, "StateBufferConnector_ms": 0.005877227113957991, "ViewRequirementAgentConnector_ms": 0.22126059783132454}}, "episode_reward_max": 62088.00695800781, "episode_reward_min": 46298.706897735596, "episode_reward_mean": 57684.9613797398, "episode_len_mean": 136.140350877193, "episodes_this_iter": 114, "policy_reward_min": {"agent_0": 46298.706897735596}, "policy_reward_max": {"agent_0": 62088.00695800781}, "policy_reward_mean": {"agent_0": 57684.9613797398}, "hist_stats": {"episode_reward": [60264.5467376709, 55790.97378826141, 46298.706897735596, 59768.68682861328, 56768.75347328186, 58078.4199886322, 59166.24678039551, 58205.69348907471, 53372.90676039457, 59016.213607788086, 50526.27998304367, 51088.406953811646, 58740.55354309082, 59586.6600189209, 54658.46692657471, 55010.160157203674, 57796.47371864319, 51186.17350566387, 59629.933532714844, 56325.446645736694, 59477.286865234375, 55069.68675804138, 58114.94041442871, 55328.240026474, 60307.61349487305, 59800.100189208984, 57906.426918029785, 57912.480306625366, 61157.88668823242, 59167.16017150879, 59233.33343887329, 54785.23379230499, 60207.706928253174, 56536.607358932495, 56744.04016876221, 55509.66699028015, 52132.66021537781, 60655.027030944824, 55907.966817855835, 60302.30667114258, 59598.97341156006, 56727.573680877686, 58901.20684814453, 58080.413555145264, 58898.453521728516, 58666.46699523926, 59444.74024963379, 61454.17385864258, 56821.98673629761, 51224.03339385986, 57040.066930770874, 58978.793365478516, 57719.35376358032, 60140.48683166504, 59692.006896972656, 58744.160568237305, 59598.360427856445, 61063.90685272217, 56420.693408966064, 57573.31365966797, 59918.32702636719, 61263.3935546875, 55523.90010070801, 61150.02053833008, 52479.466893196106, 61373.42691040039, 60155.42051696777, 57261.46698760986, 57217.77358627319, 58641.49387359619, 57565.08020591736, 59258.247131347656, 54331.54007148743, 59155.74701499939, 60063.893615722656, 62088.00695800781, 56015.50691986084, 51663.84017944336, 58587.093688964844, 59909.38676452637, 52941.14015710354, 56389.20017242432, 61064.086822509766, 58370.520332336426, 60757.46697998047, 59976.30054473877, 59428.7003326416, 58121.40686035156, 57530.09317779541, 55372.67337799072, 59291.22689819336, 54996.42033004761, 57648.55334472656, 57992.179931640625, 57557.4133682251, 55256.65997314453, 55329.64012467861, 53557.940103530884, 59107.133560180664, 61816.49353027344, 57713.76010417938, 57445.5933303833, 58206.653411865234, 59464.933532714844, 60191.879943847656, 56516.606872558594, 58412.90037536621, 59447.61343383789, 55950.68688964844, 59000.05342102051, 59357.11373901367, 59328.23332977295, 57959.19337463379, 56636.85353088379], "episode_lengths": [137, 136, 135, 136, 137, 136, 137, 137, 135, 136, 134, 135, 136, 137, 136, 136, 137, 135, 136, 135, 136, 135, 136, 135, 136, 136, 136, 137, 138, 136, 137, 136, 137, 136, 136, 136, 136, 136, 136, 137, 137, 136, 136, 136, 136, 136, 137, 138, 137, 135, 136, 136, 136, 138, 137, 136, 136, 137, 136, 136, 137, 138, 136, 137, 135, 137, 136, 135, 136, 137, 136, 136, 134, 137, 137, 137, 136, 134, 136, 137, 135, 135, 137, 136, 137, 136, 137, 135, 136, 136, 136, 135, 136, 136, 135, 136, 136, 135, 136, 138, 136, 136, 136, 137, 137, 135, 135, 137, 136, 137, 136, 137, 136, 135], "policy_agent_0_reward": [60264.5467376709, 55790.97378826141, 46298.706897735596, 59768.68682861328, 56768.75347328186, 58078.4199886322, 59166.24678039551, 58205.69348907471, 53372.90676039457, 59016.213607788086, 50526.27998304367, 51088.406953811646, 58740.55354309082, 59586.6600189209, 54658.46692657471, 55010.160157203674, 57796.47371864319, 51186.17350566387, 59629.933532714844, 56325.446645736694, 59477.286865234375, 55069.68675804138, 58114.94041442871, 55328.240026474, 60307.61349487305, 59800.100189208984, 57906.426918029785, 57912.480306625366, 61157.88668823242, 59167.16017150879, 59233.33343887329, 54785.23379230499, 60207.706928253174, 56536.607358932495, 56744.04016876221, 55509.66699028015, 52132.66021537781, 60655.027030944824, 55907.966817855835, 60302.30667114258, 59598.97341156006, 56727.573680877686, 58901.20684814453, 58080.413555145264, 58898.453521728516, 58666.46699523926, 59444.74024963379, 61454.17385864258, 56821.98673629761, 51224.03339385986, 57040.066930770874, 58978.793365478516, 57719.35376358032, 60140.48683166504, 59692.006896972656, 58744.160568237305, 59598.360427856445, 61063.90685272217, 56420.693408966064, 57573.31365966797, 59918.32702636719, 61263.3935546875, 55523.90010070801, 61150.02053833008, 52479.466893196106, 61373.42691040039, 60155.42051696777, 57261.46698760986, 57217.77358627319, 58641.49387359619, 57565.08020591736, 59258.247131347656, 54331.54007148743, 59155.74701499939, 60063.893615722656, 62088.00695800781, 56015.50691986084, 51663.84017944336, 58587.093688964844, 59909.38676452637, 52941.14015710354, 56389.20017242432, 61064.086822509766, 58370.520332336426, 60757.46697998047, 59976.30054473877, 59428.7003326416, 58121.40686035156, 57530.09317779541, 55372.67337799072, 59291.22689819336, 54996.42033004761, 57648.55334472656, 57992.179931640625, 57557.4133682251, 55256.65997314453, 55329.64012467861, 53557.940103530884, 59107.133560180664, 61816.49353027344, 57713.76010417938, 57445.5933303833, 58206.653411865234, 59464.933532714844, 60191.879943847656, 56516.606872558594, 58412.90037536621, 59447.61343383789, 55950.68688964844, 59000.05342102051, 59357.11373901367, 59328.23332977295, 57959.19337463379, 56636.85353088379]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.00523625821628, "mean_inference_ms": 6.661129163985742, "mean_action_processing_ms": 0.19859784514411538, "mean_env_wait_ms": 229.69807546491774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03859662173087137, "StateBufferConnector_ms": 0.005877227113957991, "ViewRequirementAgentConnector_ms": 0.22126059783132454}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.4954281597695, "num_env_steps_trained_throughput_per_sec": 234.4954281597695, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 14495.47, "sample_time_ms": 11619.988, "learn_time_ms": 2741.52, "learn_throughput": 1459.045, "synch_weights_time_ms": 133.331}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 3371, "training_iteration": 115, "trial_id": "32397_00000", "date": "2025-03-21_09-05-01", "timestamp": 1742547901, "time_this_iter_s": 17.1155903339386, "time_total_s": 1672.4482588768005, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19b908b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1672.4482588768005, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 95.94782608695651, "ram_util_percent": 13.452173913043477}}
{"custom_metrics": {"num_batches_mean": 5.777777777777778, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.963028907775879, "policy_loss": -0.00870647095143795, "vf_loss": 9.9716796875, "vf_explained_var": 9.611248685814644e-08, "kl": 0.008910893462598324, "entropy": 0.3587890565395355, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 60857.5002746582, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 57970.906863742406, "episode_len_mean": 136.11111111111111, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 60857.5002746582}, "policy_reward_mean": {"agent_0": 57970.906863742406}, "custom_metrics": {"num_batches_mean": 5.777777777777778, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59570.69999694824, 57352.0067691803, 60695.14059448242, 59198.79362487793, 60857.5002746582, 60668.200134277344, 59081.31359863281, 52248.64022254944, 52065.86655807495], "episode_lengths": [137, 136, 137, 136, 137, 137, 136, 135, 134], "policy_agent_0_reward": [59570.69999694824, 57352.0067691803, 60695.14059448242, 59198.79362487793, 60857.5002746582, 60668.200134277344, 59081.31359863281, 52248.64022254944, 52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.82520795515349, "mean_inference_ms": 6.399736723777107, "mean_action_processing_ms": 0.19874638756437943, "mean_env_wait_ms": 216.56530114633804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0365999009874132, "StateBufferConnector_ms": 0.005655818515353733, "ViewRequirementAgentConnector_ms": 0.19031365712483725}}, "episode_reward_max": 60857.5002746582, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 57970.906863742406, "episode_len_mean": 136.11111111111111, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 60857.5002746582}, "policy_reward_mean": {"agent_0": 57970.906863742406}, "hist_stats": {"episode_reward": [59570.69999694824, 57352.0067691803, 60695.14059448242, 59198.79362487793, 60857.5002746582, 60668.200134277344, 59081.31359863281, 52248.64022254944, 52065.86655807495], "episode_lengths": [137, 136, 137, 136, 137, 137, 136, 135, 134], "policy_agent_0_reward": [59570.69999694824, 57352.0067691803, 60695.14059448242, 59198.79362487793, 60857.5002746582, 60668.200134277344, 59081.31359863281, 52248.64022254944, 52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.82520795515349, "mean_inference_ms": 6.399736723777107, "mean_action_processing_ms": 0.19874638756437943, "mean_env_wait_ms": 216.56530114633804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0365999009874132, "StateBufferConnector_ms": 0.005655818515353733, "ViewRequirementAgentConnector_ms": 0.19031365712483725}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.36548001492565, "num_env_steps_trained_throughput_per_sec": 294.36548001492565, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14298.681, "sample_time_ms": 11408.12, "learn_time_ms": 2745.248, "learn_throughput": 1457.063, "synch_weights_time_ms": 144.683}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 3380, "training_iteration": 116, "trial_id": "32397_00000", "date": "2025-03-21_09-05-15", "timestamp": 1742547915, "time_this_iter_s": 13.644706964492798, "time_total_s": 1686.0929658412933, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb701510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1686.0929658412933, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 99.345, "ram_util_percent": 13.475}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987103462219238, "policy_loss": -0.01296266634017229, "vf_loss": 10.0, "vf_explained_var": 2.792104965010367e-07, "kl": 0.010626370087265968, "entropy": 0.36367759108543396, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 52065.86655807495, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 52065.86655807495, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 52065.86655807495}, "policy_reward_mean": {"agent_0": 52065.86655807495}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52065.86655807495], "episode_lengths": [134], "policy_agent_0_reward": [52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.255909911021455, "mean_inference_ms": 6.706263322249876, "mean_action_processing_ms": 0.1957985650593321, "mean_env_wait_ms": 221.61433920283702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162788391113281, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1786947250366211}}, "episode_reward_max": 52065.86655807495, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 52065.86655807495, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 52065.86655807495}, "policy_reward_mean": {"agent_0": 52065.86655807495}, "hist_stats": {"episode_reward": [52065.86655807495], "episode_lengths": [134], "policy_agent_0_reward": [52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.255909911021455, "mean_inference_ms": 6.706263322249876, "mean_action_processing_ms": 0.1957985650593321, "mean_env_wait_ms": 221.61433920283702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162788391113281, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1786947250366211}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.0522031230347, "num_env_steps_trained_throughput_per_sec": 315.0522031230347, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 14140.146, "sample_time_ms": 11232.12, "learn_time_ms": 2758.725, "learn_throughput": 1449.945, "synch_weights_time_ms": 148.665}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 3380, "training_iteration": 117, "trial_id": "32397_00000", "date": "2025-03-21_09-05-28", "timestamp": 1742547928, "time_this_iter_s": 12.747262477874756, "time_total_s": 1698.840228319168, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb701ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1698.840228319168, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 99.65555555555555, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987651824951172, "policy_loss": -0.012405789457261562, "vf_loss": 10.0, "vf_explained_var": 1.2926757619879936e-07, "kl": 0.009133861400187016, "entropy": 0.39070433378219604, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 52065.86655807495, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 52065.86655807495, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 52065.86655807495}, "policy_reward_mean": {"agent_0": 52065.86655807495}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52065.86655807495], "episode_lengths": [134], "policy_agent_0_reward": [52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.255909911021455, "mean_inference_ms": 6.706263322249876, "mean_action_processing_ms": 0.1957985650593321, "mean_env_wait_ms": 221.61433920283702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162788391113281, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1786947250366211}}, "episode_reward_max": 52065.86655807495, "episode_reward_min": 52065.86655807495, "episode_reward_mean": 52065.86655807495, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52065.86655807495}, "policy_reward_max": {"agent_0": 52065.86655807495}, "policy_reward_mean": {"agent_0": 52065.86655807495}, "hist_stats": {"episode_reward": [52065.86655807495], "episode_lengths": [134], "policy_agent_0_reward": [52065.86655807495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.255909911021455, "mean_inference_ms": 6.706263322249876, "mean_action_processing_ms": 0.1957985650593321, "mean_env_wait_ms": 221.61433920283702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04162788391113281, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.1786947250366211}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2846742748497, "num_env_steps_trained_throughput_per_sec": 297.2846742748497, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 14240.601, "sample_time_ms": 11278.872, "learn_time_ms": 2807.364, "learn_throughput": 1424.824, "synch_weights_time_ms": 153.732}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 3380, "training_iteration": 118, "trial_id": "32397_00000", "date": "2025-03-21_09-05-41", "timestamp": 1742547941, "time_this_iter_s": 13.519996881484985, "time_total_s": 1712.360225200653, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7037f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1712.360225200653, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 99.57894736842107, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.009803921568627, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.727282524108887, "policy_loss": -0.012779269367456436, "vf_loss": 9.739992141723633, "vf_explained_var": 5.407879655194847e-08, "kl": 0.011190295219421387, "entropy": 0.3576350808143616, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 61492.75358581543, "episode_reward_min": 50394.87337255478, "episode_reward_mean": 57488.3620350057, "episode_len_mean": 135.92156862745097, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {"agent_0": 50394.87337255478}, "policy_reward_max": {"agent_0": 61492.75358581543}, "policy_reward_mean": {"agent_0": 57488.3620350057}, "custom_metrics": {"num_batches_mean": 5.009803921568627, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59138.00694274902, 56518.73363947868, 57318.060234069824, 56832.480209350586, 54962.720081329346, 60259.24011230469, 56986.326889038086, 58619.820083618164, 59069.17355108261, 60645.993225097656, 58543.22689819336, 58322.99365234375, 60063.680267333984, 58505.06703186035, 61492.75358581543, 54195.92700386047, 55236.41375160217, 55646.66019153595, 57887.34671020508, 57530.98696899414, 56978.100187301636, 58542.987060546875, 57926.11338806152, 50394.87337255478, 61227.860527038574, 58699.14009094238, 55798.620193481445, 58093.29993438721, 54823.44020652771, 59438.02028274536, 51789.32014274597, 59319.14694976807, 58643.16027832031, 59666.96723175049, 58647.866928100586, 57466.040267944336, 53348.553506851196, 56337.74695777893, 58206.95347595215, 55427.726957798004, 55223.49331283569, 52947.88689613342, 58935.2802734375, 53819.24681663513, 57063.7204284668, 60494.9736328125, 58843.52714538574, 59393.306869506836, 58173.84021759033, 56054.76013469696, 58668.32010269165, 59688.50012207031, 56154.10682582855, 54260.33338356018, 53462.72039270401, 59888.03342437744, 58633.726770401, 59126.74008178711, 56443.200244903564, 56350.55371594429, 55667.05319786072, 61358.32693481445, 58339.213748931885, 54921.18687438965, 57990.83342552185, 59386.10009765625, 54823.20004081726, 57862.83322715759, 59170.273681640625, 57070.813495635986, 57900.013469696045, 52911.653745651245, 57732.440088272095, 58676.520446777344, 57856.43340301514, 59624.11357879639, 58257.32706451416, 59403.886842012405, 54619.02011680603, 54056.53343009949, 55999.52039337158, 58483.37363433838, 59725.72671508789, 57658.77342224121, 54252.26682853699, 59778.653732299805, 59440.793518066406, 60498.18716430664, 58189.046659469604, 59246.22024536133, 57749.63359832764, 54469.65334320068, 57485.593841552734, 59234.36017990112, 58203.87355041504, 51441.54001045227, 58055.51318359375, 58812.180114746094, 58453.73345756531, 59858.57368469238, 58079.97341918945, 58890.1402015686], "episode_lengths": [137, 136, 136, 135, 134, 137, 135, 135, 136, 136, 136, 137, 136, 137, 137, 134, 135, 135, 136, 137, 135, 136, 136, 134, 138, 136, 135, 136, 135, 137, 135, 137, 135, 137, 137, 135, 134, 136, 136, 135, 135, 136, 136, 135, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 136, 137, 136, 136, 135, 137, 136, 134, 137, 137, 135, 135, 136, 136, 136, 134, 137, 136, 137, 137, 136, 136, 136, 135, 135, 137, 137, 135, 135, 136, 136, 137, 137, 136, 137, 135, 136, 136, 136, 134, 135, 136, 137, 137, 137, 137], "policy_agent_0_reward": [59138.00694274902, 56518.73363947868, 57318.060234069824, 56832.480209350586, 54962.720081329346, 60259.24011230469, 56986.326889038086, 58619.820083618164, 59069.17355108261, 60645.993225097656, 58543.22689819336, 58322.99365234375, 60063.680267333984, 58505.06703186035, 61492.75358581543, 54195.92700386047, 55236.41375160217, 55646.66019153595, 57887.34671020508, 57530.98696899414, 56978.100187301636, 58542.987060546875, 57926.11338806152, 50394.87337255478, 61227.860527038574, 58699.14009094238, 55798.620193481445, 58093.29993438721, 54823.44020652771, 59438.02028274536, 51789.32014274597, 59319.14694976807, 58643.16027832031, 59666.96723175049, 58647.866928100586, 57466.040267944336, 53348.553506851196, 56337.74695777893, 58206.95347595215, 55427.726957798004, 55223.49331283569, 52947.88689613342, 58935.2802734375, 53819.24681663513, 57063.7204284668, 60494.9736328125, 58843.52714538574, 59393.306869506836, 58173.84021759033, 56054.76013469696, 58668.32010269165, 59688.50012207031, 56154.10682582855, 54260.33338356018, 53462.72039270401, 59888.03342437744, 58633.726770401, 59126.74008178711, 56443.200244903564, 56350.55371594429, 55667.05319786072, 61358.32693481445, 58339.213748931885, 54921.18687438965, 57990.83342552185, 59386.10009765625, 54823.20004081726, 57862.83322715759, 59170.273681640625, 57070.813495635986, 57900.013469696045, 52911.653745651245, 57732.440088272095, 58676.520446777344, 57856.43340301514, 59624.11357879639, 58257.32706451416, 59403.886842012405, 54619.02011680603, 54056.53343009949, 55999.52039337158, 58483.37363433838, 59725.72671508789, 57658.77342224121, 54252.26682853699, 59778.653732299805, 59440.793518066406, 60498.18716430664, 58189.046659469604, 59246.22024536133, 57749.63359832764, 54469.65334320068, 57485.593841552734, 59234.36017990112, 58203.87355041504, 51441.54001045227, 58055.51318359375, 58812.180114746094, 58453.73345756531, 59858.57368469238, 58079.97341918945, 58890.1402015686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.647706791345787, "mean_inference_ms": 6.715010160459665, "mean_action_processing_ms": 0.19817387626382493, "mean_env_wait_ms": 230.88461671344368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038956193362965304, "StateBufferConnector_ms": 0.006015861735624426, "ViewRequirementAgentConnector_ms": 0.20721028832828298}}, "episode_reward_max": 61492.75358581543, "episode_reward_min": 50394.87337255478, "episode_reward_mean": 57488.3620350057, "episode_len_mean": 135.92156862745097, "episodes_this_iter": 102, "policy_reward_min": {"agent_0": 50394.87337255478}, "policy_reward_max": {"agent_0": 61492.75358581543}, "policy_reward_mean": {"agent_0": 57488.3620350057}, "hist_stats": {"episode_reward": [59138.00694274902, 56518.73363947868, 57318.060234069824, 56832.480209350586, 54962.720081329346, 60259.24011230469, 56986.326889038086, 58619.820083618164, 59069.17355108261, 60645.993225097656, 58543.22689819336, 58322.99365234375, 60063.680267333984, 58505.06703186035, 61492.75358581543, 54195.92700386047, 55236.41375160217, 55646.66019153595, 57887.34671020508, 57530.98696899414, 56978.100187301636, 58542.987060546875, 57926.11338806152, 50394.87337255478, 61227.860527038574, 58699.14009094238, 55798.620193481445, 58093.29993438721, 54823.44020652771, 59438.02028274536, 51789.32014274597, 59319.14694976807, 58643.16027832031, 59666.96723175049, 58647.866928100586, 57466.040267944336, 53348.553506851196, 56337.74695777893, 58206.95347595215, 55427.726957798004, 55223.49331283569, 52947.88689613342, 58935.2802734375, 53819.24681663513, 57063.7204284668, 60494.9736328125, 58843.52714538574, 59393.306869506836, 58173.84021759033, 56054.76013469696, 58668.32010269165, 59688.50012207031, 56154.10682582855, 54260.33338356018, 53462.72039270401, 59888.03342437744, 58633.726770401, 59126.74008178711, 56443.200244903564, 56350.55371594429, 55667.05319786072, 61358.32693481445, 58339.213748931885, 54921.18687438965, 57990.83342552185, 59386.10009765625, 54823.20004081726, 57862.83322715759, 59170.273681640625, 57070.813495635986, 57900.013469696045, 52911.653745651245, 57732.440088272095, 58676.520446777344, 57856.43340301514, 59624.11357879639, 58257.32706451416, 59403.886842012405, 54619.02011680603, 54056.53343009949, 55999.52039337158, 58483.37363433838, 59725.72671508789, 57658.77342224121, 54252.26682853699, 59778.653732299805, 59440.793518066406, 60498.18716430664, 58189.046659469604, 59246.22024536133, 57749.63359832764, 54469.65334320068, 57485.593841552734, 59234.36017990112, 58203.87355041504, 51441.54001045227, 58055.51318359375, 58812.180114746094, 58453.73345756531, 59858.57368469238, 58079.97341918945, 58890.1402015686], "episode_lengths": [137, 136, 136, 135, 134, 137, 135, 135, 136, 136, 136, 137, 136, 137, 137, 134, 135, 135, 136, 137, 135, 136, 136, 134, 138, 136, 135, 136, 135, 137, 135, 137, 135, 137, 137, 135, 134, 136, 136, 135, 135, 136, 136, 135, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 136, 137, 136, 136, 135, 137, 136, 134, 137, 137, 135, 135, 136, 136, 136, 134, 137, 136, 137, 137, 136, 136, 136, 135, 135, 137, 137, 135, 135, 136, 136, 137, 137, 136, 137, 135, 136, 136, 136, 134, 135, 136, 137, 137, 137, 137], "policy_agent_0_reward": [59138.00694274902, 56518.73363947868, 57318.060234069824, 56832.480209350586, 54962.720081329346, 60259.24011230469, 56986.326889038086, 58619.820083618164, 59069.17355108261, 60645.993225097656, 58543.22689819336, 58322.99365234375, 60063.680267333984, 58505.06703186035, 61492.75358581543, 54195.92700386047, 55236.41375160217, 55646.66019153595, 57887.34671020508, 57530.98696899414, 56978.100187301636, 58542.987060546875, 57926.11338806152, 50394.87337255478, 61227.860527038574, 58699.14009094238, 55798.620193481445, 58093.29993438721, 54823.44020652771, 59438.02028274536, 51789.32014274597, 59319.14694976807, 58643.16027832031, 59666.96723175049, 58647.866928100586, 57466.040267944336, 53348.553506851196, 56337.74695777893, 58206.95347595215, 55427.726957798004, 55223.49331283569, 52947.88689613342, 58935.2802734375, 53819.24681663513, 57063.7204284668, 60494.9736328125, 58843.52714538574, 59393.306869506836, 58173.84021759033, 56054.76013469696, 58668.32010269165, 59688.50012207031, 56154.10682582855, 54260.33338356018, 53462.72039270401, 59888.03342437744, 58633.726770401, 59126.74008178711, 56443.200244903564, 56350.55371594429, 55667.05319786072, 61358.32693481445, 58339.213748931885, 54921.18687438965, 57990.83342552185, 59386.10009765625, 54823.20004081726, 57862.83322715759, 59170.273681640625, 57070.813495635986, 57900.013469696045, 52911.653745651245, 57732.440088272095, 58676.520446777344, 57856.43340301514, 59624.11357879639, 58257.32706451416, 59403.886842012405, 54619.02011680603, 54056.53343009949, 55999.52039337158, 58483.37363433838, 59725.72671508789, 57658.77342224121, 54252.26682853699, 59778.653732299805, 59440.793518066406, 60498.18716430664, 58189.046659469604, 59246.22024536133, 57749.63359832764, 54469.65334320068, 57485.593841552734, 59234.36017990112, 58203.87355041504, 51441.54001045227, 58055.51318359375, 58812.180114746094, 58453.73345756531, 59858.57368469238, 58079.97341918945, 58890.1402015686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.647706791345787, "mean_inference_ms": 6.715010160459665, "mean_action_processing_ms": 0.19817387626382493, "mean_env_wait_ms": 230.88461671344368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038956193362965304, "StateBufferConnector_ms": 0.006015861735624426, "ViewRequirementAgentConnector_ms": 0.20721028832828298}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.3880835346666, "num_env_steps_trained_throughput_per_sec": 257.3880835346666, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 14473.362, "sample_time_ms": 11593.355, "learn_time_ms": 2725.74, "learn_throughput": 1467.491, "synch_weights_time_ms": 153.63}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 3482, "training_iteration": 119, "trial_id": "32397_00000", "date": "2025-03-21_09-05-57", "timestamp": 1742547957, "time_this_iter_s": 15.594415664672852, "time_total_s": 1727.954640865326, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb716cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1727.954640865326, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 95.64285714285715, "ram_util_percent": 13.452380952380953}}
{"custom_metrics": {"num_batches_mean": 5.409090909090909, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.934370994567871, "policy_loss": -0.008054130710661411, "vf_loss": 9.9423828125, "vf_explained_var": 2.8188029688180904e-08, "kl": 0.00686945766210556, "entropy": 0.35532432794570923, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 61726.940059661865, "episode_reward_min": 50341.3400015831, "episode_reward_mean": 57779.00500994379, "episode_len_mean": 136.13636363636363, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 50341.3400015831}, "policy_reward_max": {"agent_0": 61726.940059661865}, "policy_reward_mean": {"agent_0": 57779.00500994379}, "custom_metrics": {"num_batches_mean": 5.409090909090909, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57214.68014717102, 61726.940059661865, 60066.26020812988, 55466.90678310394, 59853.25352478027, 58123.36682128906, 57834.62020778656, 58324.06033325195, 50341.3400015831, 53301.47358632088, 60237.07376098633, 61200.506896972656, 57473.520000457764, 56135.44006919861, 59480.5401763916, 61365.166748046875, 57693.360219955444, 54972.82667732239, 58923.36682319641, 58244.84031677246, 55819.84004974365, 57338.726806640625], "episode_lengths": [136, 137, 137, 136, 137, 136, 136, 137, 134, 135, 137, 137, 136, 135, 136, 137, 136, 135, 137, 136, 136, 136], "policy_agent_0_reward": [57214.68014717102, 61726.940059661865, 60066.26020812988, 55466.90678310394, 59853.25352478027, 58123.36682128906, 57834.62020778656, 58324.06033325195, 50341.3400015831, 53301.47358632088, 60237.07376098633, 61200.506896972656, 57473.520000457764, 56135.44006919861, 59480.5401763916, 61365.166748046875, 57693.360219955444, 54972.82667732239, 58923.36682319641, 58244.84031677246, 55819.84004974365, 57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.184964213108955, "mean_inference_ms": 6.326955450576768, "mean_action_processing_ms": 0.19976312223167725, "mean_env_wait_ms": 217.6325239118176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07484284314242276, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16779682853005148}}, "episode_reward_max": 61726.940059661865, "episode_reward_min": 50341.3400015831, "episode_reward_mean": 57779.00500994379, "episode_len_mean": 136.13636363636363, "episodes_this_iter": 22, "policy_reward_min": {"agent_0": 50341.3400015831}, "policy_reward_max": {"agent_0": 61726.940059661865}, "policy_reward_mean": {"agent_0": 57779.00500994379}, "hist_stats": {"episode_reward": [57214.68014717102, 61726.940059661865, 60066.26020812988, 55466.90678310394, 59853.25352478027, 58123.36682128906, 57834.62020778656, 58324.06033325195, 50341.3400015831, 53301.47358632088, 60237.07376098633, 61200.506896972656, 57473.520000457764, 56135.44006919861, 59480.5401763916, 61365.166748046875, 57693.360219955444, 54972.82667732239, 58923.36682319641, 58244.84031677246, 55819.84004974365, 57338.726806640625], "episode_lengths": [136, 137, 137, 136, 137, 136, 136, 137, 134, 135, 137, 137, 136, 135, 136, 137, 136, 135, 137, 136, 136, 136], "policy_agent_0_reward": [57214.68014717102, 61726.940059661865, 60066.26020812988, 55466.90678310394, 59853.25352478027, 58123.36682128906, 57834.62020778656, 58324.06033325195, 50341.3400015831, 53301.47358632088, 60237.07376098633, 61200.506896972656, 57473.520000457764, 56135.44006919861, 59480.5401763916, 61365.166748046875, 57693.360219955444, 54972.82667732239, 58923.36682319641, 58244.84031677246, 55819.84004974365, 57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.184964213108955, "mean_inference_ms": 6.326955450576768, "mean_action_processing_ms": 0.19976312223167725, "mean_env_wait_ms": 217.6325239118176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07484284314242276, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16779682853005148}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.98069252246634, "num_env_steps_trained_throughput_per_sec": 250.98069252246634, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14716.358, "sample_time_ms": 11730.239, "learn_time_ms": 2832.146, "learn_throughput": 1412.356, "synch_weights_time_ms": 153.332}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 3504, "training_iteration": 120, "trial_id": "32397_00000", "date": "2025-03-21_09-06-13", "timestamp": 1742547973, "time_this_iter_s": 15.993802309036255, "time_total_s": 1743.9484431743622, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb700790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1743.9484431743622, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 99.26363636363635, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988245964050293, "policy_loss": -0.011804390698671341, "vf_loss": 10.0, "vf_explained_var": -5.1967798953000965e-08, "kl": 0.007996981963515282, "entropy": 0.34272342920303345, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 57338.726806640625, "episode_reward_min": 57338.726806640625, "episode_reward_mean": 57338.726806640625, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57338.726806640625}, "policy_reward_max": {"agent_0": 57338.726806640625}, "policy_reward_mean": {"agent_0": 57338.726806640625}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57338.726806640625], "episode_lengths": [136], "policy_agent_0_reward": [57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.81569298684251, "mean_inference_ms": 6.062474704637458, "mean_action_processing_ms": 0.1981109719299301, "mean_env_wait_ms": 224.56525016751925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02677440643310547, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12547969818115234}}, "episode_reward_max": 57338.726806640625, "episode_reward_min": 57338.726806640625, "episode_reward_mean": 57338.726806640625, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57338.726806640625}, "policy_reward_max": {"agent_0": 57338.726806640625}, "policy_reward_mean": {"agent_0": 57338.726806640625}, "hist_stats": {"episode_reward": [57338.726806640625], "episode_lengths": [136], "policy_agent_0_reward": [57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.81569298684251, "mean_inference_ms": 6.062474704637458, "mean_action_processing_ms": 0.1981109719299301, "mean_env_wait_ms": 224.56525016751925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02677440643310547, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12547969818115234}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.06828285882733, "num_env_steps_trained_throughput_per_sec": 308.06828285882733, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 14056.571, "sample_time_ms": 11002.728, "learn_time_ms": 2904.412, "learn_throughput": 1377.215, "synch_weights_time_ms": 148.798}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 3504, "training_iteration": 121, "trial_id": "32397_00000", "date": "2025-03-21_09-06-26", "timestamp": 1742547986, "time_this_iter_s": 13.050103664398193, "time_total_s": 1756.9985468387604, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb701510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1756.9985468387604, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 99.64444444444446, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987676620483398, "policy_loss": -0.012383667752146721, "vf_loss": 10.0, "vf_explained_var": 2.6387473539557504e-08, "kl": 0.009752168320119381, "entropy": 0.3556459844112396, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 57338.726806640625, "episode_reward_min": 57338.726806640625, "episode_reward_mean": 57338.726806640625, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57338.726806640625}, "policy_reward_max": {"agent_0": 57338.726806640625}, "policy_reward_mean": {"agent_0": 57338.726806640625}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57338.726806640625], "episode_lengths": [136], "policy_agent_0_reward": [57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.81569298684251, "mean_inference_ms": 6.062474704637458, "mean_action_processing_ms": 0.1981109719299301, "mean_env_wait_ms": 224.56525016751925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02677440643310547, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12547969818115234}}, "episode_reward_max": 57338.726806640625, "episode_reward_min": 57338.726806640625, "episode_reward_mean": 57338.726806640625, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57338.726806640625}, "policy_reward_max": {"agent_0": 57338.726806640625}, "policy_reward_mean": {"agent_0": 57338.726806640625}, "hist_stats": {"episode_reward": [57338.726806640625], "episode_lengths": [136], "policy_agent_0_reward": [57338.726806640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.81569298684251, "mean_inference_ms": 6.062474704637458, "mean_action_processing_ms": 0.1981109719299301, "mean_env_wait_ms": 224.56525016751925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02677440643310547, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12547969818115234}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.7635138961816, "num_env_steps_trained_throughput_per_sec": 312.7635138961816, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 14033.687, "sample_time_ms": 10970.11, "learn_time_ms": 2916.866, "learn_throughput": 1371.335, "synch_weights_time_ms": 146.064}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 3504, "training_iteration": 122, "trial_id": "32397_00000", "date": "2025-03-21_09-06-39", "timestamp": 1742547999, "time_this_iter_s": 12.84172010421753, "time_total_s": 1769.840266942978, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19b92830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1769.840266942978, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 99.57894736842107, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.756178855895996, "policy_loss": -0.00900190882384777, "vf_loss": 9.76513671875, "vf_explained_var": -7.140139590688932e-09, "kl": 0.006851912476122379, "entropy": 0.3085533678531647, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 61408.95359802246, "episode_reward_min": 51317.60672855377, "episode_reward_mean": 57734.37084708904, "episode_len_mean": 135.94736842105263, "episode_media": {}, "episodes_this_iter": 95, "policy_reward_min": {"agent_0": 51317.60672855377}, "policy_reward_max": {"agent_0": 61408.95359802246}, "policy_reward_mean": {"agent_0": 57734.37084708904}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56753.05345535278, 59495.460063934326, 59488.86022949219, 58654.333599090576, 58209.26024246216, 59067.173625946045, 57298.75994873047, 59630.38708496094, 55345.206983566284, 58307.67337036133, 60207.36032104492, 58886.38674926758, 54219.09365272522, 57348.30046081543, 55868.713423252106, 59187.47362327576, 54399.033515930176, 57475.68688964844, 59528.006744384766, 59816.860275268555, 59279.5800743103, 53052.42008113861, 59147.30039978027, 55877.46691894531, 55049.89324569702, 58184.807067871094, 57826.13998794556, 51787.2000772953, 59358.75360107422, 59312.63375663757, 60176.57345581055, 56783.586844444275, 58836.5135345459, 58366.133628845215, 53097.459926605225, 58077.16009140015, 56160.28012084961, 56391.89349746704, 58907.340072631836, 58388.46675872803, 59704.326919555664, 57876.59998321533, 57645.84688568115, 60987.44030761719, 57817.92672729492, 59632.33380126953, 59426.813537597656, 57271.56002807617, 59352.95333862305, 59468.00665283203, 56595.37364959717, 60579.72705078125, 58802.17361450195, 56989.94696235657, 54726.66664028168, 59993.90686035156, 61408.95359802246, 60137.686920166016, 58550.73355102539, 57098.76674556732, 57772.63345336914, 56907.58028793335, 59047.840507507324, 60817.14685058594, 58694.92043495178, 57653.63345336914, 61244.78665161133, 57929.246921777725, 58919.38691711426, 60020.11357116699, 51643.18655771017, 56877.44032526016, 52007.45359039307, 58326.733406066895, 58882.166748046875, 54381.200061798096, 59012.27995300293, 54119.78701591492, 60310.586990356445, 57948.76675701141, 57785.13993835449, 51317.60672855377, 53255.01339817047, 59575.14031982422, 52988.753231048584, 60347.02703857422, 57707.220175266266, 57456.380350112915, 59071.44013977051, 58810.14018249512, 55985.71351623535, 58044.073276519775, 58676.08692932129, 60120.96032714844, 53791.21329116821], "episode_lengths": [135, 137, 136, 136, 136, 137, 136, 137, 136, 137, 138, 136, 135, 136, 136, 136, 134, 135, 137, 136, 136, 135, 136, 134, 135, 136, 136, 134, 136, 137, 137, 135, 136, 137, 135, 136, 136, 137, 137, 136, 137, 136, 136, 137, 136, 137, 136, 136, 136, 137, 134, 137, 135, 136, 136, 136, 137, 136, 136, 136, 135, 136, 136, 137, 136, 136, 137, 136, 136, 137, 135, 136, 133, 136, 137, 134, 137, 136, 137, 136, 135, 134, 135, 137, 134, 137, 136, 137, 136, 136, 135, 136, 135, 136, 135], "policy_agent_0_reward": [56753.05345535278, 59495.460063934326, 59488.86022949219, 58654.333599090576, 58209.26024246216, 59067.173625946045, 57298.75994873047, 59630.38708496094, 55345.206983566284, 58307.67337036133, 60207.36032104492, 58886.38674926758, 54219.09365272522, 57348.30046081543, 55868.713423252106, 59187.47362327576, 54399.033515930176, 57475.68688964844, 59528.006744384766, 59816.860275268555, 59279.5800743103, 53052.42008113861, 59147.30039978027, 55877.46691894531, 55049.89324569702, 58184.807067871094, 57826.13998794556, 51787.2000772953, 59358.75360107422, 59312.63375663757, 60176.57345581055, 56783.586844444275, 58836.5135345459, 58366.133628845215, 53097.459926605225, 58077.16009140015, 56160.28012084961, 56391.89349746704, 58907.340072631836, 58388.46675872803, 59704.326919555664, 57876.59998321533, 57645.84688568115, 60987.44030761719, 57817.92672729492, 59632.33380126953, 59426.813537597656, 57271.56002807617, 59352.95333862305, 59468.00665283203, 56595.37364959717, 60579.72705078125, 58802.17361450195, 56989.94696235657, 54726.66664028168, 59993.90686035156, 61408.95359802246, 60137.686920166016, 58550.73355102539, 57098.76674556732, 57772.63345336914, 56907.58028793335, 59047.840507507324, 60817.14685058594, 58694.92043495178, 57653.63345336914, 61244.78665161133, 57929.246921777725, 58919.38691711426, 60020.11357116699, 51643.18655771017, 56877.44032526016, 52007.45359039307, 58326.733406066895, 58882.166748046875, 54381.200061798096, 59012.27995300293, 54119.78701591492, 60310.586990356445, 57948.76675701141, 57785.13993835449, 51317.60672855377, 53255.01339817047, 59575.14031982422, 52988.753231048584, 60347.02703857422, 57707.220175266266, 57456.380350112915, 59071.44013977051, 58810.14018249512, 55985.71351623535, 58044.073276519775, 58676.08692932129, 60120.96032714844, 53791.21329116821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.94534834580138, "mean_inference_ms": 6.741765723714328, "mean_action_processing_ms": 0.1977084203525878, "mean_env_wait_ms": 232.00982397769653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05116763867829975, "StateBufferConnector_ms": 0.010151361164293791, "ViewRequirementAgentConnector_ms": 0.2407392702604595}}, "episode_reward_max": 61408.95359802246, "episode_reward_min": 51317.60672855377, "episode_reward_mean": 57734.37084708904, "episode_len_mean": 135.94736842105263, "episodes_this_iter": 95, "policy_reward_min": {"agent_0": 51317.60672855377}, "policy_reward_max": {"agent_0": 61408.95359802246}, "policy_reward_mean": {"agent_0": 57734.37084708904}, "hist_stats": {"episode_reward": [56753.05345535278, 59495.460063934326, 59488.86022949219, 58654.333599090576, 58209.26024246216, 59067.173625946045, 57298.75994873047, 59630.38708496094, 55345.206983566284, 58307.67337036133, 60207.36032104492, 58886.38674926758, 54219.09365272522, 57348.30046081543, 55868.713423252106, 59187.47362327576, 54399.033515930176, 57475.68688964844, 59528.006744384766, 59816.860275268555, 59279.5800743103, 53052.42008113861, 59147.30039978027, 55877.46691894531, 55049.89324569702, 58184.807067871094, 57826.13998794556, 51787.2000772953, 59358.75360107422, 59312.63375663757, 60176.57345581055, 56783.586844444275, 58836.5135345459, 58366.133628845215, 53097.459926605225, 58077.16009140015, 56160.28012084961, 56391.89349746704, 58907.340072631836, 58388.46675872803, 59704.326919555664, 57876.59998321533, 57645.84688568115, 60987.44030761719, 57817.92672729492, 59632.33380126953, 59426.813537597656, 57271.56002807617, 59352.95333862305, 59468.00665283203, 56595.37364959717, 60579.72705078125, 58802.17361450195, 56989.94696235657, 54726.66664028168, 59993.90686035156, 61408.95359802246, 60137.686920166016, 58550.73355102539, 57098.76674556732, 57772.63345336914, 56907.58028793335, 59047.840507507324, 60817.14685058594, 58694.92043495178, 57653.63345336914, 61244.78665161133, 57929.246921777725, 58919.38691711426, 60020.11357116699, 51643.18655771017, 56877.44032526016, 52007.45359039307, 58326.733406066895, 58882.166748046875, 54381.200061798096, 59012.27995300293, 54119.78701591492, 60310.586990356445, 57948.76675701141, 57785.13993835449, 51317.60672855377, 53255.01339817047, 59575.14031982422, 52988.753231048584, 60347.02703857422, 57707.220175266266, 57456.380350112915, 59071.44013977051, 58810.14018249512, 55985.71351623535, 58044.073276519775, 58676.08692932129, 60120.96032714844, 53791.21329116821], "episode_lengths": [135, 137, 136, 136, 136, 137, 136, 137, 136, 137, 138, 136, 135, 136, 136, 136, 134, 135, 137, 136, 136, 135, 136, 134, 135, 136, 136, 134, 136, 137, 137, 135, 136, 137, 135, 136, 136, 137, 137, 136, 137, 136, 136, 137, 136, 137, 136, 136, 136, 137, 134, 137, 135, 136, 136, 136, 137, 136, 136, 136, 135, 136, 136, 137, 136, 136, 137, 136, 136, 137, 135, 136, 133, 136, 137, 134, 137, 136, 137, 136, 135, 134, 135, 137, 134, 137, 136, 137, 136, 136, 135, 136, 135, 136, 135], "policy_agent_0_reward": [56753.05345535278, 59495.460063934326, 59488.86022949219, 58654.333599090576, 58209.26024246216, 59067.173625946045, 57298.75994873047, 59630.38708496094, 55345.206983566284, 58307.67337036133, 60207.36032104492, 58886.38674926758, 54219.09365272522, 57348.30046081543, 55868.713423252106, 59187.47362327576, 54399.033515930176, 57475.68688964844, 59528.006744384766, 59816.860275268555, 59279.5800743103, 53052.42008113861, 59147.30039978027, 55877.46691894531, 55049.89324569702, 58184.807067871094, 57826.13998794556, 51787.2000772953, 59358.75360107422, 59312.63375663757, 60176.57345581055, 56783.586844444275, 58836.5135345459, 58366.133628845215, 53097.459926605225, 58077.16009140015, 56160.28012084961, 56391.89349746704, 58907.340072631836, 58388.46675872803, 59704.326919555664, 57876.59998321533, 57645.84688568115, 60987.44030761719, 57817.92672729492, 59632.33380126953, 59426.813537597656, 57271.56002807617, 59352.95333862305, 59468.00665283203, 56595.37364959717, 60579.72705078125, 58802.17361450195, 56989.94696235657, 54726.66664028168, 59993.90686035156, 61408.95359802246, 60137.686920166016, 58550.73355102539, 57098.76674556732, 57772.63345336914, 56907.58028793335, 59047.840507507324, 60817.14685058594, 58694.92043495178, 57653.63345336914, 61244.78665161133, 57929.246921777725, 58919.38691711426, 60020.11357116699, 51643.18655771017, 56877.44032526016, 52007.45359039307, 58326.733406066895, 58882.166748046875, 54381.200061798096, 59012.27995300293, 54119.78701591492, 60310.586990356445, 57948.76675701141, 57785.13993835449, 51317.60672855377, 53255.01339817047, 59575.14031982422, 52988.753231048584, 60347.02703857422, 57707.220175266266, 57456.380350112915, 59071.44013977051, 58810.14018249512, 55985.71351623535, 58044.073276519775, 58676.08692932129, 60120.96032714844, 53791.21329116821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.94534834580138, "mean_inference_ms": 6.741765723714328, "mean_action_processing_ms": 0.1977084203525878, "mean_env_wait_ms": 232.00982397769653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05116763867829975, "StateBufferConnector_ms": 0.010151361164293791, "ViewRequirementAgentConnector_ms": 0.2407392702604595}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.38398815471055, "num_env_steps_trained_throughput_per_sec": 266.38398815471055, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 14187.522, "sample_time_ms": 11199.94, "learn_time_ms": 2847.845, "learn_throughput": 1404.571, "synch_weights_time_ms": 139.086}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 3599, "training_iteration": 123, "trial_id": "32397_00000", "date": "2025-03-21_09-06-54", "timestamp": 1742548014, "time_this_iter_s": 15.083912134170532, "time_total_s": 1784.9241790771484, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1784.9241790771484, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 96.08500000000001, "ram_util_percent": 13.48}}
{"custom_metrics": {"num_batches_mean": 5.137931034482759, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.918732643127441, "policy_loss": -0.009548602625727654, "vf_loss": 9.92822265625, "vf_explained_var": 5.7617821624944554e-08, "kl": 0.00935675110667944, "entropy": 0.3353576958179474, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 61450.840423583984, "episode_reward_min": 52229.760190963745, "episode_reward_mean": 57456.30869547252, "episode_len_mean": 135.82758620689654, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 52229.760190963745}, "policy_reward_max": {"agent_0": 61450.840423583984}, "policy_reward_mean": {"agent_0": 57456.30869547252}, "custom_metrics": {"num_batches_mean": 5.137931034482759, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55259.95349121094, 59755.50668334961, 56016.033559799194, 52347.3134059906, 59646.87373352051, 57951.59343624115, 58586.13368225098, 57662.893714904785, 52947.02676987648, 52940.973397254944, 59249.41373825073, 60297.40005493164, 55217.45348548889, 58795.27343940735, 54893.106870651245, 54774.07338428497, 58880.62028884888, 52229.760190963745, 57776.12661743164, 60687.78002166748, 59181.20001220703, 53556.47336959839, 60798.040618896484, 57478.473640441895, 61450.840423583984, 60510.21365356445, 59079.46683502197, 58392.333459854126, 59870.600189208984], "episode_lengths": [136, 137, 136, 135, 136, 136, 136, 135, 134, 135, 137, 136, 135, 136, 135, 135, 136, 134, 136, 137, 136, 134, 137, 135, 137, 137, 137, 136, 137], "policy_agent_0_reward": [55259.95349121094, 59755.50668334961, 56016.033559799194, 52347.3134059906, 59646.87373352051, 57951.59343624115, 58586.13368225098, 57662.893714904785, 52947.02676987648, 52940.973397254944, 59249.41373825073, 60297.40005493164, 55217.45348548889, 58795.27343940735, 54893.106870651245, 54774.07338428497, 58880.62028884888, 52229.760190963745, 57776.12661743164, 60687.78002166748, 59181.20001220703, 53556.47336959839, 60798.040618896484, 57478.473640441895, 61450.840423583984, 60510.21365356445, 59079.46683502197, 58392.333459854126, 59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.906314891118846, "mean_inference_ms": 6.361423792585519, "mean_action_processing_ms": 0.20100583571942263, "mean_env_wait_ms": 217.87456631860317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042401511093665814, "StateBufferConnector_ms": 0.006168464134479391, "ViewRequirementAgentConnector_ms": 0.2697755550516063}}, "episode_reward_max": 61450.840423583984, "episode_reward_min": 52229.760190963745, "episode_reward_mean": 57456.30869547252, "episode_len_mean": 135.82758620689654, "episodes_this_iter": 29, "policy_reward_min": {"agent_0": 52229.760190963745}, "policy_reward_max": {"agent_0": 61450.840423583984}, "policy_reward_mean": {"agent_0": 57456.30869547252}, "hist_stats": {"episode_reward": [55259.95349121094, 59755.50668334961, 56016.033559799194, 52347.3134059906, 59646.87373352051, 57951.59343624115, 58586.13368225098, 57662.893714904785, 52947.02676987648, 52940.973397254944, 59249.41373825073, 60297.40005493164, 55217.45348548889, 58795.27343940735, 54893.106870651245, 54774.07338428497, 58880.62028884888, 52229.760190963745, 57776.12661743164, 60687.78002166748, 59181.20001220703, 53556.47336959839, 60798.040618896484, 57478.473640441895, 61450.840423583984, 60510.21365356445, 59079.46683502197, 58392.333459854126, 59870.600189208984], "episode_lengths": [136, 137, 136, 135, 136, 136, 136, 135, 134, 135, 137, 136, 135, 136, 135, 135, 136, 134, 136, 137, 136, 134, 137, 135, 137, 137, 137, 136, 137], "policy_agent_0_reward": [55259.95349121094, 59755.50668334961, 56016.033559799194, 52347.3134059906, 59646.87373352051, 57951.59343624115, 58586.13368225098, 57662.893714904785, 52947.02676987648, 52940.973397254944, 59249.41373825073, 60297.40005493164, 55217.45348548889, 58795.27343940735, 54893.106870651245, 54774.07338428497, 58880.62028884888, 52229.760190963745, 57776.12661743164, 60687.78002166748, 59181.20001220703, 53556.47336959839, 60798.040618896484, 57478.473640441895, 61450.840423583984, 60510.21365356445, 59079.46683502197, 58392.333459854126, 59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.906314891118846, "mean_inference_ms": 6.361423792585519, "mean_action_processing_ms": 0.20100583571942263, "mean_env_wait_ms": 217.87456631860317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042401511093665814, "StateBufferConnector_ms": 0.006168464134479391, "ViewRequirementAgentConnector_ms": 0.2697755550516063}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.533903689741, "num_env_steps_trained_throughput_per_sec": 269.533903689741, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 14390.531, "sample_time_ms": 11412.246, "learn_time_ms": 2845.158, "learn_throughput": 1405.897, "synch_weights_time_ms": 132.473}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 3628, "training_iteration": 124, "trial_id": "32397_00000", "date": "2025-03-21_09-07-09", "timestamp": 1742548029, "time_this_iter_s": 14.889030456542969, "time_total_s": 1799.8132095336914, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1799.8132095336914, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 99.3904761904762, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986720085144043, "policy_loss": -0.010648873634636402, "vf_loss": 9.997314453125, "vf_explained_var": 3.333513802772359e-07, "kl": 0.008589071221649647, "entropy": 0.3146224319934845, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 59870.600189208984, "episode_reward_min": 59870.600189208984, "episode_reward_mean": 59870.600189208984, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59870.600189208984}, "policy_reward_max": {"agent_0": 59870.600189208984}, "policy_reward_mean": {"agent_0": 59870.600189208984}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59870.600189208984], "episode_lengths": [137], "policy_agent_0_reward": [59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.464236189327057, "mean_inference_ms": 6.0754214351345555, "mean_action_processing_ms": 0.19794194295823997, "mean_env_wait_ms": 224.4648064898303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.16760826110839844}}, "episode_reward_max": 59870.600189208984, "episode_reward_min": 59870.600189208984, "episode_reward_mean": 59870.600189208984, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59870.600189208984}, "policy_reward_max": {"agent_0": 59870.600189208984}, "policy_reward_mean": {"agent_0": 59870.600189208984}, "hist_stats": {"episode_reward": [59870.600189208984], "episode_lengths": [137], "policy_agent_0_reward": [59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.464236189327057, "mean_inference_ms": 6.0754214351345555, "mean_action_processing_ms": 0.19794194295823997, "mean_env_wait_ms": 224.4648064898303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.16760826110839844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6371483027883, "num_env_steps_trained_throughput_per_sec": 300.6371483027883, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 14015.247, "sample_time_ms": 10963.789, "learn_time_ms": 2907.683, "learn_throughput": 1375.666, "synch_weights_time_ms": 143.107}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 3628, "training_iteration": 125, "trial_id": "32397_00000", "date": "2025-03-21_09-07-23", "timestamp": 1742548043, "time_this_iter_s": 13.357478618621826, "time_total_s": 1813.1706881523132, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1813.1706881523132, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 99.61578947368423, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987101554870605, "policy_loss": -0.012963922694325447, "vf_loss": 10.0, "vf_explained_var": 1.4634181866313156e-07, "kl": 0.010503511875867844, "entropy": 0.3453759551048279, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 59870.600189208984, "episode_reward_min": 59870.600189208984, "episode_reward_mean": 59870.600189208984, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59870.600189208984}, "policy_reward_max": {"agent_0": 59870.600189208984}, "policy_reward_mean": {"agent_0": 59870.600189208984}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59870.600189208984], "episode_lengths": [137], "policy_agent_0_reward": [59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.464236189327057, "mean_inference_ms": 6.0754214351345555, "mean_action_processing_ms": 0.19794194295823997, "mean_env_wait_ms": 224.4648064898303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.16760826110839844}}, "episode_reward_max": 59870.600189208984, "episode_reward_min": 59870.600189208984, "episode_reward_mean": 59870.600189208984, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59870.600189208984}, "policy_reward_max": {"agent_0": 59870.600189208984}, "policy_reward_mean": {"agent_0": 59870.600189208984}, "hist_stats": {"episode_reward": [59870.600189208984], "episode_lengths": [137], "policy_agent_0_reward": [59870.600189208984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.464236189327057, "mean_inference_ms": 6.0754214351345555, "mean_action_processing_ms": 0.19794194295823997, "mean_env_wait_ms": 224.4648064898303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04086494445800781, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.16760826110839844}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6028276554636, "num_env_steps_trained_throughput_per_sec": 288.6028276554636, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 14042.382, "sample_time_ms": 10898.236, "learn_time_ms": 3003.92, "learn_throughput": 1331.593, "synch_weights_time_ms": 139.555}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 3628, "training_iteration": 126, "trial_id": "32397_00000", "date": "2025-03-21_09-07-37", "timestamp": 1742548057, "time_this_iter_s": 13.916091442108154, "time_total_s": 1827.0867795944214, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1827.0867795944214, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 99.61500000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.884871482849121, "policy_loss": -0.009958946146070957, "vf_loss": 9.894775390625, "vf_explained_var": 8.145968166672901e-08, "kl": 0.008811172097921371, "entropy": 0.30811628699302673, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 61610.42036437988, "episode_reward_min": 51181.726771354675, "episode_reward_mean": 57421.303203550124, "episode_len_mean": 135.88095238095238, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {"agent_0": 51181.726771354675}, "policy_reward_max": {"agent_0": 61610.42036437988}, "policy_reward_mean": {"agent_0": 57421.303203550124}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58537.20687866211, 53228.606842041016, 57899.74020385742, 58482.84672546387, 58893.18034362793, 61610.42036437988, 55313.91365432739, 53225.873472213745, 55725.77336502075, 55888.660323143005, 56214.44685035944, 55245.3867521286, 54223.72007751465, 57453.933685302734, 59157.193908691406, 59011.34686279297, 61219.38659667969, 55525.427017211914, 58946.85363769531, 53827.420110702515, 58791.33320617676, 55445.88681602478, 61269.74725341797, 59589.853424072266, 52297.71337389946, 60035.98696899414, 59584.32009887695, 58616.186935424805, 57632.59346008301, 60206.680156707764, 51181.726771354675, 58688.326694488525, 59574.49363708496, 54997.400053977966, 60022.893478393555, 54382.12042307854, 59208.06698989868, 59129.06018066406, 58398.346660614014, 54581.46673631668, 57776.353439331055, 60652.8401184082], "episode_lengths": [135, 134, 136, 136, 136, 137, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 138, 135, 136, 135, 136, 136, 137, 136, 135, 137, 136, 136, 136, 137, 133, 137, 136, 135, 137, 137, 136, 136, 136, 135, 136, 137], "policy_agent_0_reward": [58537.20687866211, 53228.606842041016, 57899.74020385742, 58482.84672546387, 58893.18034362793, 61610.42036437988, 55313.91365432739, 53225.873472213745, 55725.77336502075, 55888.660323143005, 56214.44685035944, 55245.3867521286, 54223.72007751465, 57453.933685302734, 59157.193908691406, 59011.34686279297, 61219.38659667969, 55525.427017211914, 58946.85363769531, 53827.420110702515, 58791.33320617676, 55445.88681602478, 61269.74725341797, 59589.853424072266, 52297.71337389946, 60035.98696899414, 59584.32009887695, 58616.186935424805, 57632.59346008301, 60206.680156707764, 51181.726771354675, 58688.326694488525, 59574.49363708496, 54997.400053977966, 60022.893478393555, 54382.12042307854, 59208.06698989868, 59129.06018066406, 58398.346660614014, 54581.46673631668, 57776.353439331055, 60652.8401184082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.214770440870865, "mean_inference_ms": 6.709813676332573, "mean_action_processing_ms": 0.19689478527560061, "mean_env_wait_ms": 232.65169660892712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04713024411882673, "StateBufferConnector_ms": 0.006029719398135231, "ViewRequirementAgentConnector_ms": 0.1847431773231143}}, "episode_reward_max": 61610.42036437988, "episode_reward_min": 51181.726771354675, "episode_reward_mean": 57421.303203550124, "episode_len_mean": 135.88095238095238, "episodes_this_iter": 42, "policy_reward_min": {"agent_0": 51181.726771354675}, "policy_reward_max": {"agent_0": 61610.42036437988}, "policy_reward_mean": {"agent_0": 57421.303203550124}, "hist_stats": {"episode_reward": [58537.20687866211, 53228.606842041016, 57899.74020385742, 58482.84672546387, 58893.18034362793, 61610.42036437988, 55313.91365432739, 53225.873472213745, 55725.77336502075, 55888.660323143005, 56214.44685035944, 55245.3867521286, 54223.72007751465, 57453.933685302734, 59157.193908691406, 59011.34686279297, 61219.38659667969, 55525.427017211914, 58946.85363769531, 53827.420110702515, 58791.33320617676, 55445.88681602478, 61269.74725341797, 59589.853424072266, 52297.71337389946, 60035.98696899414, 59584.32009887695, 58616.186935424805, 57632.59346008301, 60206.680156707764, 51181.726771354675, 58688.326694488525, 59574.49363708496, 54997.400053977966, 60022.893478393555, 54382.12042307854, 59208.06698989868, 59129.06018066406, 58398.346660614014, 54581.46673631668, 57776.353439331055, 60652.8401184082], "episode_lengths": [135, 134, 136, 136, 136, 137, 136, 135, 136, 135, 135, 136, 135, 136, 136, 136, 138, 135, 136, 135, 136, 136, 137, 136, 135, 137, 136, 136, 136, 137, 133, 137, 136, 135, 137, 137, 136, 136, 136, 135, 136, 137], "policy_agent_0_reward": [58537.20687866211, 53228.606842041016, 57899.74020385742, 58482.84672546387, 58893.18034362793, 61610.42036437988, 55313.91365432739, 53225.873472213745, 55725.77336502075, 55888.660323143005, 56214.44685035944, 55245.3867521286, 54223.72007751465, 57453.933685302734, 59157.193908691406, 59011.34686279297, 61219.38659667969, 55525.427017211914, 58946.85363769531, 53827.420110702515, 58791.33320617676, 55445.88681602478, 61269.74725341797, 59589.853424072266, 52297.71337389946, 60035.98696899414, 59584.32009887695, 58616.186935424805, 57632.59346008301, 60206.680156707764, 51181.726771354675, 58688.326694488525, 59574.49363708496, 54997.400053977966, 60022.893478393555, 54382.12042307854, 59208.06698989868, 59129.06018066406, 58398.346660614014, 54581.46673631668, 57776.353439331055, 60652.8401184082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.214770440870865, "mean_inference_ms": 6.709813676332573, "mean_action_processing_ms": 0.19689478527560061, "mean_env_wait_ms": 232.65169660892712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04713024411882673, "StateBufferConnector_ms": 0.006029719398135231, "ViewRequirementAgentConnector_ms": 0.1847431773231143}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.319957480807, "num_env_steps_trained_throughput_per_sec": 309.319957480807, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 14065.911, "sample_time_ms": 10997.479, "learn_time_ms": 2932.64, "learn_throughput": 1363.959, "synch_weights_time_ms": 135.127}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 3670, "training_iteration": 127, "trial_id": "32397_00000", "date": "2025-03-21_09-07-50", "timestamp": 1742548070, "time_this_iter_s": 12.977030515670776, "time_total_s": 1840.0638101100922, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb700790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1840.0638101100922, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 98.52777777777777, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.573170731707317, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.783459663391113, "policy_loss": -0.009814268909394741, "vf_loss": 9.793213844299316, "vf_explained_var": -3.471970444479666e-07, "kl": 0.00961272045969963, "entropy": 0.35404399037361145, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 61866.24040222168, "episode_reward_min": 48046.08678030968, "episode_reward_mean": 58244.07110213942, "episode_len_mean": 136.2439024390244, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 48046.08678030968}, "policy_reward_max": {"agent_0": 61866.24040222168}, "policy_reward_mean": {"agent_0": 58244.07110213942}, "custom_metrics": {"num_batches_mean": 5.573170731707317, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53535.120208740234, 56628.200464487076, 58654.65348815918, 59985.52029418945, 57690.41352844238, 53242.600127220154, 54931.18722367287, 59142.486822128296, 56456.44009399414, 55884.613379478455, 60019.42025756836, 58355.860023498535, 59665.93347167969, 52365.60696601868, 57607.91339111328, 59841.73336791992, 59863.78687286377, 48046.08678030968, 60140.02039337158, 59965.14697265625, 61310.613624572754, 59458.806785583496, 59875.96694946289, 54344.89371228218, 61479.993896484375, 60099.420333862305, 53122.02012300491, 58098.633573532104, 59881.9734954834, 59311.10681152344, 55983.2865524292, 60295.58703613281, 58735.80697631836, 59651.43360900879, 58291.66677856445, 60878.32669067383, 60261.726623535156, 59222.486587524414, 56406.2135925293, 57738.80051231384, 60012.54670715332, 59563.94715881348, 61478.660064697266, 59484.893615722656, 58746.16683578491, 56215.40696454048, 60688.31365966797, 59421.873474121094, 61866.24040222168, 59498.4003944397, 60303.220123291016, 59569.320083618164, 59260.12681388855, 58156.82035827637, 53056.46683216095, 58709.3466796875, 60781.83361816406, 58207.140135765076, 58910.933546066284, 59898.220138549805, 57172.86032867432, 53448.133195877075, 59174.133728027344, 59589.93342590332, 60055.96710205078, 56240.360176086426, 56647.90009689331, 53125.92686891556, 59425.940284729004, 58528.200103759766, 59722.01364135742, 60170.04689788818, 54924.553634643555, 60612.69366455078, 60595.113525390625, 58939.47329330444, 60697.00679016113, 59039.10711669922, 52468.35352516174, 58299.306549072266, 57585.09346199036, 59250.32696533203], "episode_lengths": [135, 136, 137, 137, 136, 135, 135, 137, 135, 136, 137, 136, 137, 135, 134, 137, 137, 135, 137, 136, 138, 137, 135, 134, 137, 136, 136, 136, 137, 136, 135, 137, 135, 137, 136, 137, 136, 136, 135, 136, 137, 137, 137, 136, 137, 136, 137, 137, 138, 136, 137, 137, 137, 136, 135, 136, 137, 137, 137, 137, 136, 135, 137, 136, 137, 136, 136, 135, 137, 136, 136, 137, 135, 137, 137, 137, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [53535.120208740234, 56628.200464487076, 58654.65348815918, 59985.52029418945, 57690.41352844238, 53242.600127220154, 54931.18722367287, 59142.486822128296, 56456.44009399414, 55884.613379478455, 60019.42025756836, 58355.860023498535, 59665.93347167969, 52365.60696601868, 57607.91339111328, 59841.73336791992, 59863.78687286377, 48046.08678030968, 60140.02039337158, 59965.14697265625, 61310.613624572754, 59458.806785583496, 59875.96694946289, 54344.89371228218, 61479.993896484375, 60099.420333862305, 53122.02012300491, 58098.633573532104, 59881.9734954834, 59311.10681152344, 55983.2865524292, 60295.58703613281, 58735.80697631836, 59651.43360900879, 58291.66677856445, 60878.32669067383, 60261.726623535156, 59222.486587524414, 56406.2135925293, 57738.80051231384, 60012.54670715332, 59563.94715881348, 61478.660064697266, 59484.893615722656, 58746.16683578491, 56215.40696454048, 60688.31365966797, 59421.873474121094, 61866.24040222168, 59498.4003944397, 60303.220123291016, 59569.320083618164, 59260.12681388855, 58156.82035827637, 53056.46683216095, 58709.3466796875, 60781.83361816406, 58207.140135765076, 58910.933546066284, 59898.220138549805, 57172.86032867432, 53448.133195877075, 59174.133728027344, 59589.93342590332, 60055.96710205078, 56240.360176086426, 56647.90009689331, 53125.92686891556, 59425.940284729004, 58528.200103759766, 59722.01364135742, 60170.04689788818, 54924.553634643555, 60612.69366455078, 60595.113525390625, 58939.47329330444, 60697.00679016113, 59039.10711669922, 52468.35352516174, 58299.306549072266, 57585.09346199036, 59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.20692834362508, "mean_inference_ms": 6.633615370841351, "mean_action_processing_ms": 0.1991930489195187, "mean_env_wait_ms": 226.58941268978413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049737604652963036, "StateBufferConnector_ms": 0.006042457208400819, "ViewRequirementAgentConnector_ms": 0.18352415503525152}}, "episode_reward_max": 61866.24040222168, "episode_reward_min": 48046.08678030968, "episode_reward_mean": 58244.07110213942, "episode_len_mean": 136.2439024390244, "episodes_this_iter": 82, "policy_reward_min": {"agent_0": 48046.08678030968}, "policy_reward_max": {"agent_0": 61866.24040222168}, "policy_reward_mean": {"agent_0": 58244.07110213942}, "hist_stats": {"episode_reward": [53535.120208740234, 56628.200464487076, 58654.65348815918, 59985.52029418945, 57690.41352844238, 53242.600127220154, 54931.18722367287, 59142.486822128296, 56456.44009399414, 55884.613379478455, 60019.42025756836, 58355.860023498535, 59665.93347167969, 52365.60696601868, 57607.91339111328, 59841.73336791992, 59863.78687286377, 48046.08678030968, 60140.02039337158, 59965.14697265625, 61310.613624572754, 59458.806785583496, 59875.96694946289, 54344.89371228218, 61479.993896484375, 60099.420333862305, 53122.02012300491, 58098.633573532104, 59881.9734954834, 59311.10681152344, 55983.2865524292, 60295.58703613281, 58735.80697631836, 59651.43360900879, 58291.66677856445, 60878.32669067383, 60261.726623535156, 59222.486587524414, 56406.2135925293, 57738.80051231384, 60012.54670715332, 59563.94715881348, 61478.660064697266, 59484.893615722656, 58746.16683578491, 56215.40696454048, 60688.31365966797, 59421.873474121094, 61866.24040222168, 59498.4003944397, 60303.220123291016, 59569.320083618164, 59260.12681388855, 58156.82035827637, 53056.46683216095, 58709.3466796875, 60781.83361816406, 58207.140135765076, 58910.933546066284, 59898.220138549805, 57172.86032867432, 53448.133195877075, 59174.133728027344, 59589.93342590332, 60055.96710205078, 56240.360176086426, 56647.90009689331, 53125.92686891556, 59425.940284729004, 58528.200103759766, 59722.01364135742, 60170.04689788818, 54924.553634643555, 60612.69366455078, 60595.113525390625, 58939.47329330444, 60697.00679016113, 59039.10711669922, 52468.35352516174, 58299.306549072266, 57585.09346199036, 59250.32696533203], "episode_lengths": [135, 136, 137, 137, 136, 135, 135, 137, 135, 136, 137, 136, 137, 135, 134, 137, 137, 135, 137, 136, 138, 137, 135, 134, 137, 136, 136, 136, 137, 136, 135, 137, 135, 137, 136, 137, 136, 136, 135, 136, 137, 137, 137, 136, 137, 136, 137, 137, 138, 136, 137, 137, 137, 136, 135, 136, 137, 137, 137, 137, 136, 135, 137, 136, 137, 136, 136, 135, 137, 136, 136, 137, 135, 137, 137, 137, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [53535.120208740234, 56628.200464487076, 58654.65348815918, 59985.52029418945, 57690.41352844238, 53242.600127220154, 54931.18722367287, 59142.486822128296, 56456.44009399414, 55884.613379478455, 60019.42025756836, 58355.860023498535, 59665.93347167969, 52365.60696601868, 57607.91339111328, 59841.73336791992, 59863.78687286377, 48046.08678030968, 60140.02039337158, 59965.14697265625, 61310.613624572754, 59458.806785583496, 59875.96694946289, 54344.89371228218, 61479.993896484375, 60099.420333862305, 53122.02012300491, 58098.633573532104, 59881.9734954834, 59311.10681152344, 55983.2865524292, 60295.58703613281, 58735.80697631836, 59651.43360900879, 58291.66677856445, 60878.32669067383, 60261.726623535156, 59222.486587524414, 56406.2135925293, 57738.80051231384, 60012.54670715332, 59563.94715881348, 61478.660064697266, 59484.893615722656, 58746.16683578491, 56215.40696454048, 60688.31365966797, 59421.873474121094, 61866.24040222168, 59498.4003944397, 60303.220123291016, 59569.320083618164, 59260.12681388855, 58156.82035827637, 53056.46683216095, 58709.3466796875, 60781.83361816406, 58207.140135765076, 58910.933546066284, 59898.220138549805, 57172.86032867432, 53448.133195877075, 59174.133728027344, 59589.93342590332, 60055.96710205078, 56240.360176086426, 56647.90009689331, 53125.92686891556, 59425.940284729004, 58528.200103759766, 59722.01364135742, 60170.04689788818, 54924.553634643555, 60612.69366455078, 60595.113525390625, 58939.47329330444, 60697.00679016113, 59039.10711669922, 52468.35352516174, 58299.306549072266, 57585.09346199036, 59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.20692834362508, "mean_inference_ms": 6.633615370841351, "mean_action_processing_ms": 0.1991930489195187, "mean_env_wait_ms": 226.58941268978413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049737604652963036, "StateBufferConnector_ms": 0.006042457208400819, "ViewRequirementAgentConnector_ms": 0.18352415503525152}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.9465631930636, "num_env_steps_trained_throughput_per_sec": 226.9465631930636, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14482.926, "sample_time_ms": 11468.604, "learn_time_ms": 2884.12, "learn_throughput": 1386.905, "synch_weights_time_ms": 129.53}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 3752, "training_iteration": 128, "trial_id": "32397_00000", "date": "2025-03-21_09-08-07", "timestamp": 1742548087, "time_this_iter_s": 17.681137084960938, "time_total_s": 1857.744947195053, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1857.744947195053, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 98.13333333333333, "ram_util_percent": 13.491666666666667}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986868858337402, "policy_loss": -0.010505110025405884, "vf_loss": 9.997314453125, "vf_explained_var": -9.828557523405834e-08, "kl": 0.00952056609094143, "entropy": 0.361383318901062, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 59250.32696533203, "episode_reward_min": 59250.32696533203, "episode_reward_mean": 59250.32696533203, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59250.32696533203}, "policy_reward_max": {"agent_0": 59250.32696533203}, "policy_reward_mean": {"agent_0": 59250.32696533203}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59250.32696533203], "episode_lengths": [136], "policy_agent_0_reward": [59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.0141066392224, "mean_inference_ms": 6.668232230404572, "mean_action_processing_ms": 0.2036518313869023, "mean_env_wait_ms": 234.48653601715557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059533119201660156, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.18427371978759766}}, "episode_reward_max": 59250.32696533203, "episode_reward_min": 59250.32696533203, "episode_reward_mean": 59250.32696533203, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59250.32696533203}, "policy_reward_max": {"agent_0": 59250.32696533203}, "policy_reward_mean": {"agent_0": 59250.32696533203}, "hist_stats": {"episode_reward": [59250.32696533203], "episode_lengths": [136], "policy_agent_0_reward": [59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.0141066392224, "mean_inference_ms": 6.668232230404572, "mean_action_processing_ms": 0.2036518313869023, "mean_env_wait_ms": 234.48653601715557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059533119201660156, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.18427371978759766}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.06002409032527, "num_env_steps_trained_throughput_per_sec": 308.06002409032527, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 14227.303, "sample_time_ms": 11145.492, "learn_time_ms": 2954.727, "learn_throughput": 1353.763, "synch_weights_time_ms": 126.399}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 3752, "training_iteration": 129, "trial_id": "32397_00000", "date": "2025-03-21_09-08-20", "timestamp": 1742548100, "time_this_iter_s": 13.036657333374023, "time_total_s": 1870.7816045284271, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f7b19b92830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1870.7816045284271, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 99.49473684210527, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987984657287598, "policy_loss": -0.009628008119761944, "vf_loss": 9.99755859375, "vf_explained_var": 9.387731836341118e-08, "kl": 0.008474328555166721, "entropy": 0.3144816756248474, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 59250.32696533203, "episode_reward_min": 59250.32696533203, "episode_reward_mean": 59250.32696533203, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59250.32696533203}, "policy_reward_max": {"agent_0": 59250.32696533203}, "policy_reward_mean": {"agent_0": 59250.32696533203}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59250.32696533203], "episode_lengths": [136], "policy_agent_0_reward": [59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.0141066392224, "mean_inference_ms": 6.668232230404572, "mean_action_processing_ms": 0.2036518313869023, "mean_env_wait_ms": 234.48653601715557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059533119201660156, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.18427371978759766}}, "episode_reward_max": 59250.32696533203, "episode_reward_min": 59250.32696533203, "episode_reward_mean": 59250.32696533203, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59250.32696533203}, "policy_reward_max": {"agent_0": 59250.32696533203}, "policy_reward_mean": {"agent_0": 59250.32696533203}, "hist_stats": {"episode_reward": [59250.32696533203], "episode_lengths": [136], "policy_agent_0_reward": [59250.32696533203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.0141066392224, "mean_inference_ms": 6.668232230404572, "mean_action_processing_ms": 0.2036518313869023, "mean_env_wait_ms": 234.48653601715557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059533119201660156, "StateBufferConnector_ms": 0.006079673767089844, "ViewRequirementAgentConnector_ms": 0.18427371978759766}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.40478455961255, "num_env_steps_trained_throughput_per_sec": 323.40478455961255, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 13870.393, "sample_time_ms": 10820.34, "learn_time_ms": 2924.365, "learn_throughput": 1367.819, "synch_weights_time_ms": 125.001}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 3752, "training_iteration": 130, "trial_id": "32397_00000", "date": "2025-03-21_09-08-33", "timestamp": 1742548113, "time_this_iter_s": 12.416452407836914, "time_total_s": 1883.198056936264, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1883.198056936264, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 99.59411764705882, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98320484161377, "policy_loss": -0.009530069306492805, "vf_loss": 9.99267578125, "vf_explained_var": -4.4858703063255234e-07, "kl": 0.009424099698662758, "entropy": 0.31791070103645325, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 60683.86683654785, "episode_reward_min": 53685.80004990101, "episode_reward_mean": 57272.557902375855, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 53685.80004990101}, "policy_reward_max": {"agent_0": 60683.86683654785}, "policy_reward_mean": {"agent_0": 57272.557902375855}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53685.80004990101, 60683.86683654785, 57448.00682067871], "episode_lengths": [134, 137, 137], "policy_agent_0_reward": [53685.80004990101, 60683.86683654785, 57448.00682067871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.8972904667186, "mean_inference_ms": 6.404252070881753, "mean_action_processing_ms": 0.19271740123780015, "mean_env_wait_ms": 232.58972213457628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030763943990071613, "StateBufferConnector_ms": 0.004919370015462239, "ViewRequirementAgentConnector_ms": 0.13541380564371744}}, "episode_reward_max": 60683.86683654785, "episode_reward_min": 53685.80004990101, "episode_reward_mean": 57272.557902375855, "episode_len_mean": 136.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 53685.80004990101}, "policy_reward_max": {"agent_0": 60683.86683654785}, "policy_reward_mean": {"agent_0": 57272.557902375855}, "hist_stats": {"episode_reward": [53685.80004990101, 60683.86683654785, 57448.00682067871], "episode_lengths": [134, 137, 137], "policy_agent_0_reward": [53685.80004990101, 60683.86683654785, 57448.00682067871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.8972904667186, "mean_inference_ms": 6.404252070881753, "mean_action_processing_ms": 0.19271740123780015, "mean_env_wait_ms": 232.58972213457628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030763943990071613, "StateBufferConnector_ms": 0.004919370015462239, "ViewRequirementAgentConnector_ms": 0.13541380564371744}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.04714617390607, "num_env_steps_trained_throughput_per_sec": 284.04714617390607, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 13980.196, "sample_time_ms": 10937.171, "learn_time_ms": 2910.004, "learn_throughput": 1374.568, "synch_weights_time_ms": 132.328}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 3755, "training_iteration": 131, "trial_id": "32397_00000", "date": "2025-03-21_09-08-47", "timestamp": 1742548127, "time_this_iter_s": 14.132861137390137, "time_total_s": 1897.3309180736542, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1897.3309180736542, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 99.43809523809526, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.264462809917355, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.688014030456543, "policy_loss": -0.010770877823233604, "vf_loss": 9.69873046875, "vf_explained_var": 8.748223194743332e-07, "kl": 0.008733754977583885, "entropy": 0.30813470482826233, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 62515.10043334961, "episode_reward_min": 49631.78709292412, "episode_reward_mean": 57589.58458863654, "episode_len_mean": 136.08264462809916, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 49631.78709292412}, "policy_reward_max": {"agent_0": 62515.10043334961}, "policy_reward_mean": {"agent_0": 57589.58458863654}, "custom_metrics": {"num_batches_mean": 5.264462809917355, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57232.466705322266, 58286.52713012695, 55188.826835632324, 57703.34020355344, 58028.773529052734, 52660.88037490845, 57453.30011367798, 59111.926849365234, 59841.53340148926, 57368.58006668091, 49631.78709292412, 55661.620245456696, 56854.13364028931, 58981.42001724243, 58553.22036743164, 58206.00704956055, 58228.980197906494, 59152.893379211426, 59569.42036437988, 56381.06008338928, 59412.906982421875, 50499.04669189453, 53980.5800409317, 55319.95345687866, 58306.71361541748, 58816.380058288574, 56546.6000289917, 57997.40659713745, 55245.77377319336, 57219.49327087402, 60738.44030761719, 51950.753432273865, 59540.85350036621, 58411.25372314453, 58479.36688232422, 55241.60013511777, 60490.38034057617, 56453.47312927246, 55010.24027442932, 55456.053548812866, 53114.26033973694, 57673.713342666626, 58294.36651611328, 61458.48693847656, 58358.56700134277, 55982.346855163574, 61000.00012207031, 59406.826988220215, 58040.54025268555, 55277.81986999512, 56100.12689971924, 57196.193939208984, 57883.55325317383, 58848.68667602539, 57073.453313827515, 60415.18037414551, 56529.5333814621, 57905.91362762451, 60599.28715515137, 61163.4333190918, 59612.739837646484, 56761.48718833923, 57286.306869506836, 59570.36665534973, 55657.813301086426, 55101.52658510208, 57633.233837127686, 57632.91338920593, 57331.28012275696, 60424.21368408203, 61851.14694213867, 59095.466735839844, 51155.51995611191, 55192.64684677124, 59604.30043029785, 61139.70007324219, 55786.986865997314, 58985.52685546875, 56558.28675842285, 57923.81352233887, 56647.57363128662, 55297.12038040161, 54833.14673042297, 54976.366930007935, 59323.28689575195, 58161.060510635376, 58676.02684020996, 55001.57344818115, 59657.9001159668, 57127.400131225586, 58181.63998413086, 53516.83343887329, 60000.473693847656, 54926.560205459595, 57474.32009124756, 60362.446838378906, 61214.8203125, 54802.51350545883, 56255.820137023926, 57451.36004638672, 60483.960498809814, 59972.25331878662, 59990.733337402344, 60356.01345825195, 57264.153633117676, 61675.11349487305, 56708.82022476196, 59482.76704978943, 57620.34700965881, 59240.96676635742, 58588.99327945709, 62515.10043334961, 59368.76010131836, 58131.306900024414, 57055.52028656006, 57174.473598480225, 58924.59365272522, 53428.593311309814, 55988.713150024414, 56962.50046157837, 57676.27333068848], "episode_lengths": [136, 136, 135, 136, 136, 135, 136, 136, 137, 136, 135, 136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 133, 135, 136, 135, 136, 136, 136, 135, 136, 137, 134, 137, 136, 136, 136, 137, 135, 135, 135, 136, 136, 137, 138, 137, 136, 138, 137, 136, 135, 136, 135, 136, 136, 136, 137, 135, 137, 137, 137, 136, 136, 136, 137, 135, 134, 136, 137, 136, 137, 138, 137, 135, 135, 137, 137, 135, 136, 136, 136, 135, 136, 135, 136, 136, 137, 137, 136, 137, 136, 136, 134, 137, 135, 136, 137, 138, 134, 136, 136, 138, 137, 137, 137, 135, 138, 136, 137, 136, 136, 137, 139, 136, 136, 136, 136, 137, 134, 134, 136, 136], "policy_agent_0_reward": [57232.466705322266, 58286.52713012695, 55188.826835632324, 57703.34020355344, 58028.773529052734, 52660.88037490845, 57453.30011367798, 59111.926849365234, 59841.53340148926, 57368.58006668091, 49631.78709292412, 55661.620245456696, 56854.13364028931, 58981.42001724243, 58553.22036743164, 58206.00704956055, 58228.980197906494, 59152.893379211426, 59569.42036437988, 56381.06008338928, 59412.906982421875, 50499.04669189453, 53980.5800409317, 55319.95345687866, 58306.71361541748, 58816.380058288574, 56546.6000289917, 57997.40659713745, 55245.77377319336, 57219.49327087402, 60738.44030761719, 51950.753432273865, 59540.85350036621, 58411.25372314453, 58479.36688232422, 55241.60013511777, 60490.38034057617, 56453.47312927246, 55010.24027442932, 55456.053548812866, 53114.26033973694, 57673.713342666626, 58294.36651611328, 61458.48693847656, 58358.56700134277, 55982.346855163574, 61000.00012207031, 59406.826988220215, 58040.54025268555, 55277.81986999512, 56100.12689971924, 57196.193939208984, 57883.55325317383, 58848.68667602539, 57073.453313827515, 60415.18037414551, 56529.5333814621, 57905.91362762451, 60599.28715515137, 61163.4333190918, 59612.739837646484, 56761.48718833923, 57286.306869506836, 59570.36665534973, 55657.813301086426, 55101.52658510208, 57633.233837127686, 57632.91338920593, 57331.28012275696, 60424.21368408203, 61851.14694213867, 59095.466735839844, 51155.51995611191, 55192.64684677124, 59604.30043029785, 61139.70007324219, 55786.986865997314, 58985.52685546875, 56558.28675842285, 57923.81352233887, 56647.57363128662, 55297.12038040161, 54833.14673042297, 54976.366930007935, 59323.28689575195, 58161.060510635376, 58676.02684020996, 55001.57344818115, 59657.9001159668, 57127.400131225586, 58181.63998413086, 53516.83343887329, 60000.473693847656, 54926.560205459595, 57474.32009124756, 60362.446838378906, 61214.8203125, 54802.51350545883, 56255.820137023926, 57451.36004638672, 60483.960498809814, 59972.25331878662, 59990.733337402344, 60356.01345825195, 57264.153633117676, 61675.11349487305, 56708.82022476196, 59482.76704978943, 57620.34700965881, 59240.96676635742, 58588.99327945709, 62515.10043334961, 59368.76010131836, 58131.306900024414, 57055.52028656006, 57174.473598480225, 58924.59365272522, 53428.593311309814, 55988.713150024414, 56962.50046157837, 57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.718261667850335, "mean_inference_ms": 6.665783930948973, "mean_action_processing_ms": 0.19840886586608503, "mean_env_wait_ms": 228.38395517210836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04878162352506779, "StateBufferConnector_ms": 0.006005980751731179, "ViewRequirementAgentConnector_ms": 0.1895096676408752}}, "episode_reward_max": 62515.10043334961, "episode_reward_min": 49631.78709292412, "episode_reward_mean": 57589.58458863654, "episode_len_mean": 136.08264462809916, "episodes_this_iter": 121, "policy_reward_min": {"agent_0": 49631.78709292412}, "policy_reward_max": {"agent_0": 62515.10043334961}, "policy_reward_mean": {"agent_0": 57589.58458863654}, "hist_stats": {"episode_reward": [57232.466705322266, 58286.52713012695, 55188.826835632324, 57703.34020355344, 58028.773529052734, 52660.88037490845, 57453.30011367798, 59111.926849365234, 59841.53340148926, 57368.58006668091, 49631.78709292412, 55661.620245456696, 56854.13364028931, 58981.42001724243, 58553.22036743164, 58206.00704956055, 58228.980197906494, 59152.893379211426, 59569.42036437988, 56381.06008338928, 59412.906982421875, 50499.04669189453, 53980.5800409317, 55319.95345687866, 58306.71361541748, 58816.380058288574, 56546.6000289917, 57997.40659713745, 55245.77377319336, 57219.49327087402, 60738.44030761719, 51950.753432273865, 59540.85350036621, 58411.25372314453, 58479.36688232422, 55241.60013511777, 60490.38034057617, 56453.47312927246, 55010.24027442932, 55456.053548812866, 53114.26033973694, 57673.713342666626, 58294.36651611328, 61458.48693847656, 58358.56700134277, 55982.346855163574, 61000.00012207031, 59406.826988220215, 58040.54025268555, 55277.81986999512, 56100.12689971924, 57196.193939208984, 57883.55325317383, 58848.68667602539, 57073.453313827515, 60415.18037414551, 56529.5333814621, 57905.91362762451, 60599.28715515137, 61163.4333190918, 59612.739837646484, 56761.48718833923, 57286.306869506836, 59570.36665534973, 55657.813301086426, 55101.52658510208, 57633.233837127686, 57632.91338920593, 57331.28012275696, 60424.21368408203, 61851.14694213867, 59095.466735839844, 51155.51995611191, 55192.64684677124, 59604.30043029785, 61139.70007324219, 55786.986865997314, 58985.52685546875, 56558.28675842285, 57923.81352233887, 56647.57363128662, 55297.12038040161, 54833.14673042297, 54976.366930007935, 59323.28689575195, 58161.060510635376, 58676.02684020996, 55001.57344818115, 59657.9001159668, 57127.400131225586, 58181.63998413086, 53516.83343887329, 60000.473693847656, 54926.560205459595, 57474.32009124756, 60362.446838378906, 61214.8203125, 54802.51350545883, 56255.820137023926, 57451.36004638672, 60483.960498809814, 59972.25331878662, 59990.733337402344, 60356.01345825195, 57264.153633117676, 61675.11349487305, 56708.82022476196, 59482.76704978943, 57620.34700965881, 59240.96676635742, 58588.99327945709, 62515.10043334961, 59368.76010131836, 58131.306900024414, 57055.52028656006, 57174.473598480225, 58924.59365272522, 53428.593311309814, 55988.713150024414, 56962.50046157837, 57676.27333068848], "episode_lengths": [136, 136, 135, 136, 136, 135, 136, 136, 137, 136, 135, 136, 136, 137, 136, 136, 136, 136, 137, 136, 136, 133, 135, 136, 135, 136, 136, 136, 135, 136, 137, 134, 137, 136, 136, 136, 137, 135, 135, 135, 136, 136, 137, 138, 137, 136, 138, 137, 136, 135, 136, 135, 136, 136, 136, 137, 135, 137, 137, 137, 136, 136, 136, 137, 135, 134, 136, 137, 136, 137, 138, 137, 135, 135, 137, 137, 135, 136, 136, 136, 135, 136, 135, 136, 136, 137, 137, 136, 137, 136, 136, 134, 137, 135, 136, 137, 138, 134, 136, 136, 138, 137, 137, 137, 135, 138, 136, 137, 136, 136, 137, 139, 136, 136, 136, 136, 137, 134, 134, 136, 136], "policy_agent_0_reward": [57232.466705322266, 58286.52713012695, 55188.826835632324, 57703.34020355344, 58028.773529052734, 52660.88037490845, 57453.30011367798, 59111.926849365234, 59841.53340148926, 57368.58006668091, 49631.78709292412, 55661.620245456696, 56854.13364028931, 58981.42001724243, 58553.22036743164, 58206.00704956055, 58228.980197906494, 59152.893379211426, 59569.42036437988, 56381.06008338928, 59412.906982421875, 50499.04669189453, 53980.5800409317, 55319.95345687866, 58306.71361541748, 58816.380058288574, 56546.6000289917, 57997.40659713745, 55245.77377319336, 57219.49327087402, 60738.44030761719, 51950.753432273865, 59540.85350036621, 58411.25372314453, 58479.36688232422, 55241.60013511777, 60490.38034057617, 56453.47312927246, 55010.24027442932, 55456.053548812866, 53114.26033973694, 57673.713342666626, 58294.36651611328, 61458.48693847656, 58358.56700134277, 55982.346855163574, 61000.00012207031, 59406.826988220215, 58040.54025268555, 55277.81986999512, 56100.12689971924, 57196.193939208984, 57883.55325317383, 58848.68667602539, 57073.453313827515, 60415.18037414551, 56529.5333814621, 57905.91362762451, 60599.28715515137, 61163.4333190918, 59612.739837646484, 56761.48718833923, 57286.306869506836, 59570.36665534973, 55657.813301086426, 55101.52658510208, 57633.233837127686, 57632.91338920593, 57331.28012275696, 60424.21368408203, 61851.14694213867, 59095.466735839844, 51155.51995611191, 55192.64684677124, 59604.30043029785, 61139.70007324219, 55786.986865997314, 58985.52685546875, 56558.28675842285, 57923.81352233887, 56647.57363128662, 55297.12038040161, 54833.14673042297, 54976.366930007935, 59323.28689575195, 58161.060510635376, 58676.02684020996, 55001.57344818115, 59657.9001159668, 57127.400131225586, 58181.63998413086, 53516.83343887329, 60000.473693847656, 54926.560205459595, 57474.32009124756, 60362.446838378906, 61214.8203125, 54802.51350545883, 56255.820137023926, 57451.36004638672, 60483.960498809814, 59972.25331878662, 59990.733337402344, 60356.01345825195, 57264.153633117676, 61675.11349487305, 56708.82022476196, 59482.76704978943, 57620.34700965881, 59240.96676635742, 58588.99327945709, 62515.10043334961, 59368.76010131836, 58131.306900024414, 57055.52028656006, 57174.473598480225, 58924.59365272522, 53428.593311309814, 55988.713150024414, 56962.50046157837, 57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.718261667850335, "mean_inference_ms": 6.665783930948973, "mean_action_processing_ms": 0.19840886586608503, "mean_env_wait_ms": 228.38395517210836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04878162352506779, "StateBufferConnector_ms": 0.006005980751731179, "ViewRequirementAgentConnector_ms": 0.1895096676408752}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.07232997893945, "num_env_steps_trained_throughput_per_sec": 226.07232997893945, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 14470.614, "sample_time_ms": 11462.895, "learn_time_ms": 2871.186, "learn_throughput": 1393.152, "synch_weights_time_ms": 135.847}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 3876, "training_iteration": 132, "trial_id": "32397_00000", "date": "2025-03-21_09-09-05", "timestamp": 1742548145, "time_this_iter_s": 17.75348973274231, "time_total_s": 1915.0844078063965, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1915.0844078063965, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 92.27826086956522, "ram_util_percent": 13.482608695652175}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985048294067383, "policy_loss": -0.0150291221216321, "vf_loss": 10.0, "vf_explained_var": -2.3202349552775559e-07, "kl": 0.012275648303329945, "entropy": 0.3177066147327423, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}}, "episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.65973031063, "num_env_steps_trained_throughput_per_sec": 308.65973031063, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 14264.948, "sample_time_ms": 11200.236, "learn_time_ms": 2919.236, "learn_throughput": 1370.222, "synch_weights_time_ms": 144.796}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 3876, "training_iteration": 133, "trial_id": "32397_00000", "date": "2025-03-21_09-09-18", "timestamp": 1742548158, "time_this_iter_s": 13.020935535430908, "time_total_s": 1928.1053433418274, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d1ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1928.1053433418274, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 99.50000000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987929344177246, "policy_loss": -0.012129374779760838, "vf_loss": 10.0, "vf_explained_var": 2.825011868878846e-08, "kl": 0.009363583289086819, "entropy": 0.3104110658168793, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}}, "episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.56575771214864, "num_env_steps_trained_throughput_per_sec": 322.56575771214864, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 14020.969, "sample_time_ms": 10909.796, "learn_time_ms": 2959.21, "learn_throughput": 1351.712, "synch_weights_time_ms": 151.285}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 3876, "training_iteration": 134, "trial_id": "32397_00000", "date": "2025-03-21_09-09-31", "timestamp": 1742548171, "time_this_iter_s": 12.460569620132446, "time_total_s": 1940.5659129619598, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1940.5659129619598, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 99.64117647058823, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988842010498047, "policy_loss": -0.011240128427743912, "vf_loss": 10.0, "vf_explained_var": -4.358589578146166e-08, "kl": 0.013108165003359318, "entropy": 0.2852995991706848, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}}, "episode_reward_max": 57676.27333068848, "episode_reward_min": 57676.27333068848, "episode_reward_mean": 57676.27333068848, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57676.27333068848}, "policy_reward_max": {"agent_0": 57676.27333068848}, "policy_reward_mean": {"agent_0": 57676.27333068848}, "hist_stats": {"episode_reward": [57676.27333068848], "episode_lengths": [136], "policy_agent_0_reward": [57676.27333068848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.2712975225505, "mean_inference_ms": 6.693339827498035, "mean_action_processing_ms": 0.19361354895597377, "mean_env_wait_ms": 232.99311778954498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03361701965332031, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14493465423583984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6865970384854, "num_env_steps_trained_throughput_per_sec": 307.6865970384854, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 13990.486, "sample_time_ms": 10883.196, "learn_time_ms": 2959.695, "learn_throughput": 1351.491, "synch_weights_time_ms": 146.915}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 3876, "training_iteration": 135, "trial_id": "32397_00000", "date": "2025-03-21_09-09-44", "timestamp": 1742548184, "time_this_iter_s": 13.054128408432007, "time_total_s": 1953.6200413703918, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1953.6200413703918, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 99.56315789473686, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.008064516129032, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.679827690124512, "policy_loss": -0.008224664255976677, "vf_loss": 9.68798828125, "vf_explained_var": 3.263354244609218e-07, "kl": 0.01014215312898159, "entropy": 0.32108911871910095, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 62566.67333984375, "episode_reward_min": 52246.82695770264, "episode_reward_mean": 58233.86225787334, "episode_len_mean": 136.32258064516128, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 52246.82695770264}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 58233.86225787334}, "custom_metrics": {"num_batches_mean": 5.008064516129032, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58263.4600982666, 58939.29351043701, 59492.5535736084, 58018.2335395813, 59153.607009887695, 60762.286781311035, 58137.753604888916, 60018.54029083252, 58635.233489990234, 57648.04697036743, 54835.83999919891, 59659.246883392334, 53864.94013404846, 57727.7801361084, 60667.02673339844, 59079.04738044739, 57309.36685752869, 58687.1001663208, 59360.90686035156, 59976.57325744629, 54158.61367607117, 59588.473556518555, 58670.49336242676, 57249.29365539551, 56021.33354759216, 58135.07356786728, 57794.08716583252, 57259.893429756165, 59820.033782958984, 55911.39364337921, 57680.66687011719, 59910.7801361084, 56577.63363647461, 53546.52682971954, 59860.93374633789, 58697.06005859375, 56472.18695831299, 54790.08718109131, 59034.55335998535, 60150.760314941406, 55321.62014007568, 61201.666748046875, 58011.526779174805, 57777.393421173096, 58874.30032348633, 55073.040316581726, 55751.68034172058, 54216.04677772522, 58334.80679321289, 58310.67366218567, 61384.8869934082, 57091.47995185852, 56224.253507614136, 57415.59346008301, 55839.92657852173, 60084.50680541992, 59751.80679321289, 56062.57360458374, 61371.360443115234, 60057.5002746582, 59772.553482055664, 56929.80008125305, 57937.07381439209, 62036.48681640625, 60427.18061828613, 61158.13369560242, 59313.80694580078, 57814.3868560791, 53815.02685505152, 57572.193561553955, 55197.67337036133, 55912.45358276367, 56508.966888427734, 61762.11395263672, 60997.13357543945, 57573.98717880249, 59180.29359817505, 58358.487117767334, 56038.43352890015, 59682.38023376465, 60345.42025756836, 59960.53350830078, 52246.82695770264, 59601.10680294037, 57735.27346801758, 59525.54670715332, 59829.24691772461, 57512.90020751953, 58495.273345947266, 56739.51369857788, 60161.60012817383, 56694.32701873779, 61999.240173339844, 56339.70035362244, 57977.9599943161, 57993.820320129395, 54305.0934009552, 58842.53352355957, 60349.060302734375, 55658.98012924194, 60451.27365112305, 60045.77345275879, 57137.67360305786, 55359.99345207214, 60593.07356262207, 56199.42024230957, 59195.73342704773, 58544.2001953125, 55004.4332447052, 56048.5002784729, 57664.473667144775, 59903.02015686035, 59269.646770477295, 55992.893401145935, 60191.6135559082, 57231.34680175781, 59470.17367553711, 58909.706634521484, 61322.08026123047, 59625.30666351318, 58974.64041137695, 60192.82011413574, 61078.566970825195, 62566.67333984375], "episode_lengths": [137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 137, 137, 135, 137, 135, 136, 136, 136, 136, 135, 137, 135, 136, 137, 136, 135, 137, 136, 135, 135, 136, 137, 135, 137, 137, 136, 136, 135, 136, 135, 136, 137, 137, 137, 136, 136, 135, 136, 137, 135, 137, 137, 137, 136, 136, 138, 137, 137, 136, 136, 135, 136, 135, 135, 136, 138, 137, 136, 137, 136, 135, 136, 138, 137, 135, 137, 135, 137, 137, 136, 137, 136, 137, 136, 138, 136, 136, 136, 136, 136, 136, 135, 137, 137, 136, 135, 137, 135, 137, 136, 136, 136, 137, 137, 137, 136, 137, 136, 137, 136, 138, 137, 137, 137, 138, 139], "policy_agent_0_reward": [58263.4600982666, 58939.29351043701, 59492.5535736084, 58018.2335395813, 59153.607009887695, 60762.286781311035, 58137.753604888916, 60018.54029083252, 58635.233489990234, 57648.04697036743, 54835.83999919891, 59659.246883392334, 53864.94013404846, 57727.7801361084, 60667.02673339844, 59079.04738044739, 57309.36685752869, 58687.1001663208, 59360.90686035156, 59976.57325744629, 54158.61367607117, 59588.473556518555, 58670.49336242676, 57249.29365539551, 56021.33354759216, 58135.07356786728, 57794.08716583252, 57259.893429756165, 59820.033782958984, 55911.39364337921, 57680.66687011719, 59910.7801361084, 56577.63363647461, 53546.52682971954, 59860.93374633789, 58697.06005859375, 56472.18695831299, 54790.08718109131, 59034.55335998535, 60150.760314941406, 55321.62014007568, 61201.666748046875, 58011.526779174805, 57777.393421173096, 58874.30032348633, 55073.040316581726, 55751.68034172058, 54216.04677772522, 58334.80679321289, 58310.67366218567, 61384.8869934082, 57091.47995185852, 56224.253507614136, 57415.59346008301, 55839.92657852173, 60084.50680541992, 59751.80679321289, 56062.57360458374, 61371.360443115234, 60057.5002746582, 59772.553482055664, 56929.80008125305, 57937.07381439209, 62036.48681640625, 60427.18061828613, 61158.13369560242, 59313.80694580078, 57814.3868560791, 53815.02685505152, 57572.193561553955, 55197.67337036133, 55912.45358276367, 56508.966888427734, 61762.11395263672, 60997.13357543945, 57573.98717880249, 59180.29359817505, 58358.487117767334, 56038.43352890015, 59682.38023376465, 60345.42025756836, 59960.53350830078, 52246.82695770264, 59601.10680294037, 57735.27346801758, 59525.54670715332, 59829.24691772461, 57512.90020751953, 58495.273345947266, 56739.51369857788, 60161.60012817383, 56694.32701873779, 61999.240173339844, 56339.70035362244, 57977.9599943161, 57993.820320129395, 54305.0934009552, 58842.53352355957, 60349.060302734375, 55658.98012924194, 60451.27365112305, 60045.77345275879, 57137.67360305786, 55359.99345207214, 60593.07356262207, 56199.42024230957, 59195.73342704773, 58544.2001953125, 55004.4332447052, 56048.5002784729, 57664.473667144775, 59903.02015686035, 59269.646770477295, 55992.893401145935, 60191.6135559082, 57231.34680175781, 59470.17367553711, 58909.706634521484, 61322.08026123047, 59625.30666351318, 58974.64041137695, 60192.82011413574, 61078.566970825195, 62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.730911985320798, "mean_inference_ms": 6.6715189200462115, "mean_action_processing_ms": 0.19836561619561383, "mean_env_wait_ms": 228.3555714621482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04881408906752063, "StateBufferConnector_ms": 0.005992574076498708, "ViewRequirementAgentConnector_ms": 0.18909131326983053}}, "episode_reward_max": 62566.67333984375, "episode_reward_min": 52246.82695770264, "episode_reward_mean": 58233.86225787334, "episode_len_mean": 136.32258064516128, "episodes_this_iter": 124, "policy_reward_min": {"agent_0": 52246.82695770264}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 58233.86225787334}, "hist_stats": {"episode_reward": [58263.4600982666, 58939.29351043701, 59492.5535736084, 58018.2335395813, 59153.607009887695, 60762.286781311035, 58137.753604888916, 60018.54029083252, 58635.233489990234, 57648.04697036743, 54835.83999919891, 59659.246883392334, 53864.94013404846, 57727.7801361084, 60667.02673339844, 59079.04738044739, 57309.36685752869, 58687.1001663208, 59360.90686035156, 59976.57325744629, 54158.61367607117, 59588.473556518555, 58670.49336242676, 57249.29365539551, 56021.33354759216, 58135.07356786728, 57794.08716583252, 57259.893429756165, 59820.033782958984, 55911.39364337921, 57680.66687011719, 59910.7801361084, 56577.63363647461, 53546.52682971954, 59860.93374633789, 58697.06005859375, 56472.18695831299, 54790.08718109131, 59034.55335998535, 60150.760314941406, 55321.62014007568, 61201.666748046875, 58011.526779174805, 57777.393421173096, 58874.30032348633, 55073.040316581726, 55751.68034172058, 54216.04677772522, 58334.80679321289, 58310.67366218567, 61384.8869934082, 57091.47995185852, 56224.253507614136, 57415.59346008301, 55839.92657852173, 60084.50680541992, 59751.80679321289, 56062.57360458374, 61371.360443115234, 60057.5002746582, 59772.553482055664, 56929.80008125305, 57937.07381439209, 62036.48681640625, 60427.18061828613, 61158.13369560242, 59313.80694580078, 57814.3868560791, 53815.02685505152, 57572.193561553955, 55197.67337036133, 55912.45358276367, 56508.966888427734, 61762.11395263672, 60997.13357543945, 57573.98717880249, 59180.29359817505, 58358.487117767334, 56038.43352890015, 59682.38023376465, 60345.42025756836, 59960.53350830078, 52246.82695770264, 59601.10680294037, 57735.27346801758, 59525.54670715332, 59829.24691772461, 57512.90020751953, 58495.273345947266, 56739.51369857788, 60161.60012817383, 56694.32701873779, 61999.240173339844, 56339.70035362244, 57977.9599943161, 57993.820320129395, 54305.0934009552, 58842.53352355957, 60349.060302734375, 55658.98012924194, 60451.27365112305, 60045.77345275879, 57137.67360305786, 55359.99345207214, 60593.07356262207, 56199.42024230957, 59195.73342704773, 58544.2001953125, 55004.4332447052, 56048.5002784729, 57664.473667144775, 59903.02015686035, 59269.646770477295, 55992.893401145935, 60191.6135559082, 57231.34680175781, 59470.17367553711, 58909.706634521484, 61322.08026123047, 59625.30666351318, 58974.64041137695, 60192.82011413574, 61078.566970825195, 62566.67333984375], "episode_lengths": [137, 137, 137, 137, 137, 137, 136, 136, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 137, 137, 135, 137, 135, 136, 136, 136, 136, 135, 137, 135, 136, 137, 136, 135, 137, 136, 135, 135, 136, 137, 135, 137, 137, 136, 136, 135, 136, 135, 136, 137, 137, 137, 136, 136, 135, 136, 137, 135, 137, 137, 137, 136, 136, 138, 137, 137, 136, 136, 135, 136, 135, 135, 136, 138, 137, 136, 137, 136, 135, 136, 138, 137, 135, 137, 135, 137, 137, 136, 137, 136, 137, 136, 138, 136, 136, 136, 136, 136, 136, 135, 137, 137, 136, 135, 137, 135, 137, 136, 136, 136, 137, 137, 137, 136, 137, 136, 137, 136, 138, 137, 137, 137, 138, 139], "policy_agent_0_reward": [58263.4600982666, 58939.29351043701, 59492.5535736084, 58018.2335395813, 59153.607009887695, 60762.286781311035, 58137.753604888916, 60018.54029083252, 58635.233489990234, 57648.04697036743, 54835.83999919891, 59659.246883392334, 53864.94013404846, 57727.7801361084, 60667.02673339844, 59079.04738044739, 57309.36685752869, 58687.1001663208, 59360.90686035156, 59976.57325744629, 54158.61367607117, 59588.473556518555, 58670.49336242676, 57249.29365539551, 56021.33354759216, 58135.07356786728, 57794.08716583252, 57259.893429756165, 59820.033782958984, 55911.39364337921, 57680.66687011719, 59910.7801361084, 56577.63363647461, 53546.52682971954, 59860.93374633789, 58697.06005859375, 56472.18695831299, 54790.08718109131, 59034.55335998535, 60150.760314941406, 55321.62014007568, 61201.666748046875, 58011.526779174805, 57777.393421173096, 58874.30032348633, 55073.040316581726, 55751.68034172058, 54216.04677772522, 58334.80679321289, 58310.67366218567, 61384.8869934082, 57091.47995185852, 56224.253507614136, 57415.59346008301, 55839.92657852173, 60084.50680541992, 59751.80679321289, 56062.57360458374, 61371.360443115234, 60057.5002746582, 59772.553482055664, 56929.80008125305, 57937.07381439209, 62036.48681640625, 60427.18061828613, 61158.13369560242, 59313.80694580078, 57814.3868560791, 53815.02685505152, 57572.193561553955, 55197.67337036133, 55912.45358276367, 56508.966888427734, 61762.11395263672, 60997.13357543945, 57573.98717880249, 59180.29359817505, 58358.487117767334, 56038.43352890015, 59682.38023376465, 60345.42025756836, 59960.53350830078, 52246.82695770264, 59601.10680294037, 57735.27346801758, 59525.54670715332, 59829.24691772461, 57512.90020751953, 58495.273345947266, 56739.51369857788, 60161.60012817383, 56694.32701873779, 61999.240173339844, 56339.70035362244, 57977.9599943161, 57993.820320129395, 54305.0934009552, 58842.53352355957, 60349.060302734375, 55658.98012924194, 60451.27365112305, 60045.77345275879, 57137.67360305786, 55359.99345207214, 60593.07356262207, 56199.42024230957, 59195.73342704773, 58544.2001953125, 55004.4332447052, 56048.5002784729, 57664.473667144775, 59903.02015686035, 59269.646770477295, 55992.893401145935, 60191.6135559082, 57231.34680175781, 59470.17367553711, 58909.706634521484, 61322.08026123047, 59625.30666351318, 58974.64041137695, 60192.82011413574, 61078.566970825195, 62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.730911985320798, "mean_inference_ms": 6.6715189200462115, "mean_action_processing_ms": 0.19836561619561383, "mean_env_wait_ms": 228.3555714621482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04881408906752063, "StateBufferConnector_ms": 0.005992574076498708, "ViewRequirementAgentConnector_ms": 0.18909131326983053}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.32109406276513, "num_env_steps_trained_throughput_per_sec": 234.32109406276513, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 14311.552, "sample_time_ms": 11317.126, "learn_time_ms": 2853.69, "learn_throughput": 1401.694, "synch_weights_time_ms": 140.046}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 4000, "training_iteration": 136, "trial_id": "32397_00000", "date": "2025-03-21_09-10-01", "timestamp": 1742548201, "time_this_iter_s": 17.123436212539673, "time_total_s": 1970.7434775829315, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7015a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1970.7434775829315, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 92.99583333333334, "ram_util_percent": 13.475}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98819637298584, "policy_loss": -0.011872153729200363, "vf_loss": 10.0, "vf_explained_var": -3.2410024886075917e-08, "kl": 0.011051362380385399, "entropy": 0.3555072546005249, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}}, "episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3224465981399, "num_env_steps_trained_throughput_per_sec": 317.3224465981399, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 14278.94, "sample_time_ms": 11225.774, "learn_time_ms": 2908.677, "learn_throughput": 1375.196, "synch_weights_time_ms": 143.8}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 4000, "training_iteration": 137, "trial_id": "32397_00000", "date": "2025-03-21_09-10-14", "timestamp": 1742548214, "time_this_iter_s": 12.655553817749023, "time_total_s": 1983.3990314006805, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb701510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1983.3990314006805, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 99.61111111111113, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.993213653564453, "policy_loss": -0.006833496503531933, "vf_loss": 10.0, "vf_explained_var": -4.0978194171259474e-09, "kl": 0.007528842892497778, "entropy": 0.29276150465011597, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}}, "episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.9316020747986, "num_env_steps_trained_throughput_per_sec": 315.9316020747986, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 13782.509, "sample_time_ms": 10729.595, "learn_time_ms": 2907.306, "learn_throughput": 1375.844, "synch_weights_time_ms": 144.914}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 4000, "training_iteration": 138, "trial_id": "32397_00000", "date": "2025-03-21_09-10-27", "timestamp": 1742548227, "time_this_iter_s": 12.721045732498169, "time_total_s": 1996.1200771331787, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 1996.1200771331787, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 99.65555555555557, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988256454467773, "policy_loss": -0.011824509128928185, "vf_loss": 10.0, "vf_explained_var": -1.5211602644171762e-08, "kl": 0.01300774421542883, "entropy": 0.29592445492744446, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}}, "episode_reward_max": 62566.67333984375, "episode_reward_min": 62566.67333984375, "episode_reward_mean": 62566.67333984375, "episode_len_mean": 139.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 62566.67333984375}, "policy_reward_max": {"agent_0": 62566.67333984375}, "policy_reward_mean": {"agent_0": 62566.67333984375}, "hist_stats": {"episode_reward": [62566.67333984375], "episode_lengths": [139], "policy_agent_0_reward": [62566.67333984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.54863901530467, "mean_inference_ms": 6.741990994892257, "mean_action_processing_ms": 0.1936488498799039, "mean_env_wait_ms": 232.33821143946264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.838160514831543, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.14903545379638672}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8925076728651, "num_env_steps_trained_throughput_per_sec": 302.8925076728651, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 13804.654, "sample_time_ms": 10740.448, "learn_time_ms": 2914.908, "learn_throughput": 1372.256, "synch_weights_time_ms": 148.622}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 4000, "training_iteration": 139, "trial_id": "32397_00000", "date": "2025-03-21_09-10-40", "timestamp": 1742548240, "time_this_iter_s": 13.257202625274658, "time_total_s": 2009.3772797584534, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb700790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2009.3772797584534, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 99.57368421052632, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.69949722290039, "policy_loss": -0.008815537206828594, "vf_loss": 9.708251953125, "vf_explained_var": -2.40219122815688e-07, "kl": 0.009649758227169514, "entropy": 0.32083505392074585, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 61375.746826171875, "episode_reward_min": 48584.70000743866, "episode_reward_mean": 57571.52513465718, "episode_len_mean": 136.17948717948718, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {"agent_0": 48584.70000743866}, "policy_reward_max": {"agent_0": 61375.746826171875}, "policy_reward_mean": {"agent_0": 57571.52513465718}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56361.54002380371, 57665.19352531433, 52297.79333472252, 61278.4736328125, 60228.573669433594, 58102.300048828125, 49446.44009780884, 59903.22033691406, 55705.93338394165, 57630.920181274414, 60743.89339065552, 58810.753509521484, 59134.45324707031, 56673.56034851074, 57624.08026313782, 60424.94723510742, 48584.70000743866, 57872.62028503418, 55990.34669303894, 55441.99345779419, 52845.84028291702, 55580.779903411865, 60187.43362426758, 59897.07385253906, 58596.48014831543, 59644.853801727295, 54778.4469871521, 57189.000091552734, 56818.56015634537, 58395.91355895996, 57124.413414001465, 59619.92025756836, 57541.726654052734, 59356.19331359863, 56652.35341644287, 59945.30712890625, 55671.55368614197, 58206.70022583008, 59194.92706298828, 56689.03345870972, 57414.420276641846, 59965.71994018555, 59682.29337692261, 59897.213470458984, 55159.27375793457, 56257.0801525116, 60432.2604598999, 55836.746574401855, 59154.26664733887, 57907.52031707764, 56284.60697174072, 60007.02001953125, 58151.80030822754, 54010.63349342346, 53472.18675708771, 58707.81336975098, 54540.560094833374, 58915.43992614746, 60641.67361450195, 56991.886737823486, 57573.34672164917, 54249.54683303833, 57560.83988952637, 56256.72008895874, 58497.673767089844, 59815.08724975586, 57735.81342411041, 53278.799973249435, 55222.43349504471, 56648.880208969116, 57170.42028808594, 61313.36701965332, 58497.186920166016, 60160.3071937561, 58814.73342895508, 56930.21343612671, 60549.03359222412, 57847.30693054199, 53712.646671295166, 58098.53340148926, 55557.40026855469, 56358.62691497803, 58166.366644859314, 55182.50671195984, 59923.413497924805, 59808.63338470459, 59074.69323730469, 57703.433250427246, 59374.513412475586, 54754.813519477844, 59993.980392456055, 57939.32681655884, 57062.91345024109, 60358.22702026367, 57255.26706695557, 61375.746826171875, 58572.8069152832, 56703.626821517944, 57790.36011123657, 60709.80685424805, 56521.70704650879, 60779.04705810547, 54624.50684738159, 58760.10674953461, 57613.919917583466, 56146.053401470184, 56073.40033340454, 55267.313497543335, 58130.32011413574, 58909.813400268555, 60474.366790771484, 57917.806743621826, 51312.946866989136, 56569.266830444336, 58810.02018737793, 58744.58020782471, 58325.247146606445], "episode_lengths": [136, 135, 135, 138, 137, 136, 135, 137, 135, 136, 138, 136, 138, 135, 136, 137, 134, 136, 135, 135, 135, 136, 137, 137, 136, 137, 135, 136, 137, 137, 137, 137, 136, 137, 136, 137, 136, 136, 136, 136, 136, 137, 137, 137, 136, 135, 137, 135, 137, 136, 136, 137, 136, 135, 135, 137, 134, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 134, 136, 136, 135, 137, 136, 137, 136, 136, 137, 136, 135, 137, 134, 136, 137, 135, 137, 137, 137, 135, 136, 136, 137, 137, 136, 136, 136, 138, 137, 136, 136, 137, 135, 137, 135, 137, 136, 136, 136, 136, 137, 138, 137, 136, 135, 136, 136, 137, 137], "policy_agent_0_reward": [56361.54002380371, 57665.19352531433, 52297.79333472252, 61278.4736328125, 60228.573669433594, 58102.300048828125, 49446.44009780884, 59903.22033691406, 55705.93338394165, 57630.920181274414, 60743.89339065552, 58810.753509521484, 59134.45324707031, 56673.56034851074, 57624.08026313782, 60424.94723510742, 48584.70000743866, 57872.62028503418, 55990.34669303894, 55441.99345779419, 52845.84028291702, 55580.779903411865, 60187.43362426758, 59897.07385253906, 58596.48014831543, 59644.853801727295, 54778.4469871521, 57189.000091552734, 56818.56015634537, 58395.91355895996, 57124.413414001465, 59619.92025756836, 57541.726654052734, 59356.19331359863, 56652.35341644287, 59945.30712890625, 55671.55368614197, 58206.70022583008, 59194.92706298828, 56689.03345870972, 57414.420276641846, 59965.71994018555, 59682.29337692261, 59897.213470458984, 55159.27375793457, 56257.0801525116, 60432.2604598999, 55836.746574401855, 59154.26664733887, 57907.52031707764, 56284.60697174072, 60007.02001953125, 58151.80030822754, 54010.63349342346, 53472.18675708771, 58707.81336975098, 54540.560094833374, 58915.43992614746, 60641.67361450195, 56991.886737823486, 57573.34672164917, 54249.54683303833, 57560.83988952637, 56256.72008895874, 58497.673767089844, 59815.08724975586, 57735.81342411041, 53278.799973249435, 55222.43349504471, 56648.880208969116, 57170.42028808594, 61313.36701965332, 58497.186920166016, 60160.3071937561, 58814.73342895508, 56930.21343612671, 60549.03359222412, 57847.30693054199, 53712.646671295166, 58098.53340148926, 55557.40026855469, 56358.62691497803, 58166.366644859314, 55182.50671195984, 59923.413497924805, 59808.63338470459, 59074.69323730469, 57703.433250427246, 59374.513412475586, 54754.813519477844, 59993.980392456055, 57939.32681655884, 57062.91345024109, 60358.22702026367, 57255.26706695557, 61375.746826171875, 58572.8069152832, 56703.626821517944, 57790.36011123657, 60709.80685424805, 56521.70704650879, 60779.04705810547, 54624.50684738159, 58760.10674953461, 57613.919917583466, 56146.053401470184, 56073.40033340454, 55267.313497543335, 58130.32011413574, 58909.813400268555, 60474.366790771484, 57917.806743621826, 51312.946866989136, 56569.266830444336, 58810.02018737793, 58744.58020782471, 58325.247146606445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.425617947590094, "mean_inference_ms": 6.680821397814189, "mean_action_processing_ms": 0.19837946883013455, "mean_env_wait_ms": 227.9369576156507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05789679339808276, "StateBufferConnector_ms": 0.011198133484930055, "ViewRequirementAgentConnector_ms": 0.21266224037887704}}, "episode_reward_max": 61375.746826171875, "episode_reward_min": 48584.70000743866, "episode_reward_mean": 57571.52513465718, "episode_len_mean": 136.17948717948718, "episodes_this_iter": 117, "policy_reward_min": {"agent_0": 48584.70000743866}, "policy_reward_max": {"agent_0": 61375.746826171875}, "policy_reward_mean": {"agent_0": 57571.52513465718}, "hist_stats": {"episode_reward": [56361.54002380371, 57665.19352531433, 52297.79333472252, 61278.4736328125, 60228.573669433594, 58102.300048828125, 49446.44009780884, 59903.22033691406, 55705.93338394165, 57630.920181274414, 60743.89339065552, 58810.753509521484, 59134.45324707031, 56673.56034851074, 57624.08026313782, 60424.94723510742, 48584.70000743866, 57872.62028503418, 55990.34669303894, 55441.99345779419, 52845.84028291702, 55580.779903411865, 60187.43362426758, 59897.07385253906, 58596.48014831543, 59644.853801727295, 54778.4469871521, 57189.000091552734, 56818.56015634537, 58395.91355895996, 57124.413414001465, 59619.92025756836, 57541.726654052734, 59356.19331359863, 56652.35341644287, 59945.30712890625, 55671.55368614197, 58206.70022583008, 59194.92706298828, 56689.03345870972, 57414.420276641846, 59965.71994018555, 59682.29337692261, 59897.213470458984, 55159.27375793457, 56257.0801525116, 60432.2604598999, 55836.746574401855, 59154.26664733887, 57907.52031707764, 56284.60697174072, 60007.02001953125, 58151.80030822754, 54010.63349342346, 53472.18675708771, 58707.81336975098, 54540.560094833374, 58915.43992614746, 60641.67361450195, 56991.886737823486, 57573.34672164917, 54249.54683303833, 57560.83988952637, 56256.72008895874, 58497.673767089844, 59815.08724975586, 57735.81342411041, 53278.799973249435, 55222.43349504471, 56648.880208969116, 57170.42028808594, 61313.36701965332, 58497.186920166016, 60160.3071937561, 58814.73342895508, 56930.21343612671, 60549.03359222412, 57847.30693054199, 53712.646671295166, 58098.53340148926, 55557.40026855469, 56358.62691497803, 58166.366644859314, 55182.50671195984, 59923.413497924805, 59808.63338470459, 59074.69323730469, 57703.433250427246, 59374.513412475586, 54754.813519477844, 59993.980392456055, 57939.32681655884, 57062.91345024109, 60358.22702026367, 57255.26706695557, 61375.746826171875, 58572.8069152832, 56703.626821517944, 57790.36011123657, 60709.80685424805, 56521.70704650879, 60779.04705810547, 54624.50684738159, 58760.10674953461, 57613.919917583466, 56146.053401470184, 56073.40033340454, 55267.313497543335, 58130.32011413574, 58909.813400268555, 60474.366790771484, 57917.806743621826, 51312.946866989136, 56569.266830444336, 58810.02018737793, 58744.58020782471, 58325.247146606445], "episode_lengths": [136, 135, 135, 138, 137, 136, 135, 137, 135, 136, 138, 136, 138, 135, 136, 137, 134, 136, 135, 135, 135, 136, 137, 137, 136, 137, 135, 136, 137, 137, 137, 137, 136, 137, 136, 137, 136, 136, 136, 136, 136, 137, 137, 137, 136, 135, 137, 135, 137, 136, 136, 137, 136, 135, 135, 137, 134, 136, 137, 136, 136, 136, 136, 136, 136, 137, 136, 134, 136, 136, 135, 137, 136, 137, 136, 136, 137, 136, 135, 137, 134, 136, 137, 135, 137, 137, 137, 135, 136, 136, 137, 137, 136, 136, 136, 138, 137, 136, 136, 137, 135, 137, 135, 137, 136, 136, 136, 136, 137, 138, 137, 136, 135, 136, 136, 137, 137], "policy_agent_0_reward": [56361.54002380371, 57665.19352531433, 52297.79333472252, 61278.4736328125, 60228.573669433594, 58102.300048828125, 49446.44009780884, 59903.22033691406, 55705.93338394165, 57630.920181274414, 60743.89339065552, 58810.753509521484, 59134.45324707031, 56673.56034851074, 57624.08026313782, 60424.94723510742, 48584.70000743866, 57872.62028503418, 55990.34669303894, 55441.99345779419, 52845.84028291702, 55580.779903411865, 60187.43362426758, 59897.07385253906, 58596.48014831543, 59644.853801727295, 54778.4469871521, 57189.000091552734, 56818.56015634537, 58395.91355895996, 57124.413414001465, 59619.92025756836, 57541.726654052734, 59356.19331359863, 56652.35341644287, 59945.30712890625, 55671.55368614197, 58206.70022583008, 59194.92706298828, 56689.03345870972, 57414.420276641846, 59965.71994018555, 59682.29337692261, 59897.213470458984, 55159.27375793457, 56257.0801525116, 60432.2604598999, 55836.746574401855, 59154.26664733887, 57907.52031707764, 56284.60697174072, 60007.02001953125, 58151.80030822754, 54010.63349342346, 53472.18675708771, 58707.81336975098, 54540.560094833374, 58915.43992614746, 60641.67361450195, 56991.886737823486, 57573.34672164917, 54249.54683303833, 57560.83988952637, 56256.72008895874, 58497.673767089844, 59815.08724975586, 57735.81342411041, 53278.799973249435, 55222.43349504471, 56648.880208969116, 57170.42028808594, 61313.36701965332, 58497.186920166016, 60160.3071937561, 58814.73342895508, 56930.21343612671, 60549.03359222412, 57847.30693054199, 53712.646671295166, 58098.53340148926, 55557.40026855469, 56358.62691497803, 58166.366644859314, 55182.50671195984, 59923.413497924805, 59808.63338470459, 59074.69323730469, 57703.433250427246, 59374.513412475586, 54754.813519477844, 59993.980392456055, 57939.32681655884, 57062.91345024109, 60358.22702026367, 57255.26706695557, 61375.746826171875, 58572.8069152832, 56703.626821517944, 57790.36011123657, 60709.80685424805, 56521.70704650879, 60779.04705810547, 54624.50684738159, 58760.10674953461, 57613.919917583466, 56146.053401470184, 56073.40033340454, 55267.313497543335, 58130.32011413574, 58909.813400268555, 60474.366790771484, 57917.806743621826, 51312.946866989136, 56569.266830444336, 58810.02018737793, 58744.58020782471, 58325.247146606445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.425617947590094, "mean_inference_ms": 6.680821397814189, "mean_action_processing_ms": 0.19837946883013455, "mean_env_wait_ms": 227.9369576156507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05789679339808276, "StateBufferConnector_ms": 0.011198133484930055, "ViewRequirementAgentConnector_ms": 0.21266224037887704}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.77068555380757, "num_env_steps_trained_throughput_per_sec": 253.77068555380757, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 14144.041, "sample_time_ms": 11127.38, "learn_time_ms": 2860.506, "learn_throughput": 1398.354, "synch_weights_time_ms": 155.483}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 4117, "training_iteration": 140, "trial_id": "32397_00000", "date": "2025-03-21_09-10-56", "timestamp": 1742548256, "time_this_iter_s": 15.810445308685303, "time_total_s": 2025.1877250671387, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2025.1877250671387, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 93.53636363636365, "ram_util_percent": 13.468181818181817}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.975255012512207, "policy_loss": -0.007214321289211512, "vf_loss": 9.982421875, "vf_explained_var": 3.2472112110326634e-08, "kl": 0.007657815236598253, "entropy": 0.3148917555809021, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 61783.38009643555, "episode_reward_min": 56015.313846588135, "episode_reward_mean": 58878.56496647426, "episode_len_mean": 136.71428571428572, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"agent_0": 56015.313846588135}, "policy_reward_max": {"agent_0": 61783.38009643555}, "policy_reward_mean": {"agent_0": 58878.56496647426}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56015.313846588135, 59251.1533203125, 61783.38009643555, 60516.70711135864, 58355.20013809204, 59233.26028442383, 56994.93996810913], "episode_lengths": [136, 137, 138, 137, 136, 137, 136], "policy_agent_0_reward": [56015.313846588135, 59251.1533203125, 61783.38009643555, 60516.70711135864, 58355.20013809204, 59233.26028442383, 56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.12219610471135, "mean_inference_ms": 6.750776483131788, "mean_action_processing_ms": 0.19722614890282086, "mean_env_wait_ms": 230.1645269194981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032714435032435825, "StateBufferConnector_ms": 0.005217960902622768, "ViewRequirementAgentConnector_ms": 0.1399993896484375}}, "episode_reward_max": 61783.38009643555, "episode_reward_min": 56015.313846588135, "episode_reward_mean": 58878.56496647426, "episode_len_mean": 136.71428571428572, "episodes_this_iter": 7, "policy_reward_min": {"agent_0": 56015.313846588135}, "policy_reward_max": {"agent_0": 61783.38009643555}, "policy_reward_mean": {"agent_0": 58878.56496647426}, "hist_stats": {"episode_reward": [56015.313846588135, 59251.1533203125, 61783.38009643555, 60516.70711135864, 58355.20013809204, 59233.26028442383, 56994.93996810913], "episode_lengths": [136, 137, 138, 137, 136, 137, 136], "policy_agent_0_reward": [56015.313846588135, 59251.1533203125, 61783.38009643555, 60516.70711135864, 58355.20013809204, 59233.26028442383, 56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.12219610471135, "mean_inference_ms": 6.750776483131788, "mean_action_processing_ms": 0.19722614890282086, "mean_env_wait_ms": 230.1645269194981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032714435032435825, "StateBufferConnector_ms": 0.005217960902622768, "ViewRequirementAgentConnector_ms": 0.1399993896484375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.5143493130193, "num_env_steps_trained_throughput_per_sec": 298.5143493130193, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 14075.793, "sample_time_ms": 11050.225, "learn_time_ms": 2870.19, "learn_throughput": 1393.636, "synch_weights_time_ms": 154.708}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 4124, "training_iteration": 141, "trial_id": "32397_00000", "date": "2025-03-21_09-11-09", "timestamp": 1742548269, "time_this_iter_s": 13.451555013656616, "time_total_s": 2038.6392800807953, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb703880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2038.6392800807953, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 99.54210526315791, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.991925239562988, "policy_loss": -0.008127449080348015, "vf_loss": 10.0, "vf_explained_var": -1.0859221077907932e-07, "kl": 0.008447780273854733, "entropy": 0.30713218450546265, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 56994.93996810913, "episode_reward_min": 56994.93996810913, "episode_reward_mean": 56994.93996810913, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56994.93996810913}, "policy_reward_max": {"agent_0": 56994.93996810913}, "policy_reward_mean": {"agent_0": 56994.93996810913}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56994.93996810913], "episode_lengths": [136], "policy_agent_0_reward": [56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.404860498422853, "mean_inference_ms": 7.277258425627425, "mean_action_processing_ms": 0.2081850112316589, "mean_env_wait_ms": 229.72323280096109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03147125244140625, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.14019012451171875}}, "episode_reward_max": 56994.93996810913, "episode_reward_min": 56994.93996810913, "episode_reward_mean": 56994.93996810913, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56994.93996810913}, "policy_reward_max": {"agent_0": 56994.93996810913}, "policy_reward_mean": {"agent_0": 56994.93996810913}, "hist_stats": {"episode_reward": [56994.93996810913], "episode_lengths": [136], "policy_agent_0_reward": [56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.404860498422853, "mean_inference_ms": 7.277258425627425, "mean_action_processing_ms": 0.2081850112316589, "mean_env_wait_ms": 229.72323280096109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03147125244140625, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.14019012451171875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.4879393241707, "num_env_steps_trained_throughput_per_sec": 306.4879393241707, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 13611.562, "sample_time_ms": 10551.085, "learn_time_ms": 2906.821, "learn_throughput": 1376.074, "synch_weights_time_ms": 152.988}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 4124, "training_iteration": 142, "trial_id": "32397_00000", "date": "2025-03-21_09-11-23", "timestamp": 1742548283, "time_this_iter_s": 13.102692365646362, "time_total_s": 2051.7419724464417, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2051.7419724464417, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 99.56315789473685, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986751556396484, "policy_loss": -0.013309970498085022, "vf_loss": 10.0, "vf_explained_var": -1.2603899257612738e-08, "kl": 0.009832268580794334, "entropy": 0.3002709746360779, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 56994.93996810913, "episode_reward_min": 56994.93996810913, "episode_reward_mean": 56994.93996810913, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56994.93996810913}, "policy_reward_max": {"agent_0": 56994.93996810913}, "policy_reward_mean": {"agent_0": 56994.93996810913}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56994.93996810913], "episode_lengths": [136], "policy_agent_0_reward": [56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.404860498422853, "mean_inference_ms": 7.277258425627425, "mean_action_processing_ms": 0.2081850112316589, "mean_env_wait_ms": 229.72323280096109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03147125244140625, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.14019012451171875}}, "episode_reward_max": 56994.93996810913, "episode_reward_min": 56994.93996810913, "episode_reward_mean": 56994.93996810913, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56994.93996810913}, "policy_reward_max": {"agent_0": 56994.93996810913}, "policy_reward_mean": {"agent_0": 56994.93996810913}, "hist_stats": {"episode_reward": [56994.93996810913], "episode_lengths": [136], "policy_agent_0_reward": [56994.93996810913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.404860498422853, "mean_inference_ms": 7.277258425627425, "mean_action_processing_ms": 0.2081850112316589, "mean_env_wait_ms": 229.72323280096109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03147125244140625, "StateBufferConnector_ms": 0.005030632019042969, "ViewRequirementAgentConnector_ms": 0.14019012451171875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.9444907926675, "num_env_steps_trained_throughput_per_sec": 295.9444907926675, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 13667.242, "sample_time_ms": 10606.006, "learn_time_ms": 2914.509, "learn_throughput": 1372.444, "synch_weights_time_ms": 146.061}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 4124, "training_iteration": 143, "trial_id": "32397_00000", "date": "2025-03-21_09-11-36", "timestamp": 1742548296, "time_this_iter_s": 13.5724036693573, "time_total_s": 2065.314376115799, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2065.314376115799, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 99.5684210526316, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.829473495483398, "policy_loss": -0.010185747407376766, "vf_loss": 9.839599609375, "vf_explained_var": -4.960844890433691e-08, "kl": 0.009507701732218266, "entropy": 0.3028770387172699, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 61930.720306396484, "episode_reward_min": 50450.27343940735, "episode_reward_mean": 57820.408412775025, "episode_len_mean": 136.125, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {"agent_0": 50450.27343940735}, "policy_reward_max": {"agent_0": 61930.720306396484}, "policy_reward_mean": {"agent_0": 57820.408412775025}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52366.57347822189, 61930.720306396484, 56423.56664657593, 58752.14700317383, 57135.460189819336, 58838.800285339355, 59244.6135559082, 57401.906997680664, 58331.18670654297, 57337.51996457577, 59211.64027404785, 56332.83332777023, 58658.880279541016, 60956.7805557251, 57826.22032928467, 57124.44006347656, 55677.58665084839, 59474.66026306152, 52958.26693725586, 59718.233322143555, 56373.43361854553, 54229.566683769226, 58624.927017211914, 60967.133560180664, 57351.00001144409, 58352.38677215576, 59892.00654602051, 55402.313665390015, 56941.24694061279, 60961.57345581055, 60576.81352233887, 58221.7268371582, 57831.50679016113, 59445.50038146973, 61103.06019592285, 58878.44024658203, 59227.30702209473, 56118.50695991516, 59470.0071105957, 57737.57345581055, 60709.52015686035, 55798.95320034027, 59133.36698913574, 56845.88674926758, 58163.26007080078, 57089.65343475342, 58435.833587646484, 58536.97355365753, 60577.52003479004, 56357.59334945679, 59107.126876831055, 60474.440490722656, 55120.173412323, 60229.82038497925, 56004.593479156494, 54587.193415641785, 58503.306884765625, 53761.76004219055, 56524.253410339355, 57563.84669494629, 59703.800201416016, 58279.61359024048, 50450.27343940735, 55139.307037353516], "episode_lengths": [134, 138, 135, 137, 136, 137, 136, 136, 136, 135, 136, 136, 136, 137, 136, 137, 137, 136, 134, 137, 136, 135, 137, 138, 135, 137, 136, 135, 136, 137, 137, 136, 136, 137, 137, 137, 137, 135, 137, 136, 136, 136, 137, 136, 136, 135, 137, 137, 138, 136, 136, 137, 136, 137, 135, 136, 136, 134, 136, 135, 136, 136, 133, 136], "policy_agent_0_reward": [52366.57347822189, 61930.720306396484, 56423.56664657593, 58752.14700317383, 57135.460189819336, 58838.800285339355, 59244.6135559082, 57401.906997680664, 58331.18670654297, 57337.51996457577, 59211.64027404785, 56332.83332777023, 58658.880279541016, 60956.7805557251, 57826.22032928467, 57124.44006347656, 55677.58665084839, 59474.66026306152, 52958.26693725586, 59718.233322143555, 56373.43361854553, 54229.566683769226, 58624.927017211914, 60967.133560180664, 57351.00001144409, 58352.38677215576, 59892.00654602051, 55402.313665390015, 56941.24694061279, 60961.57345581055, 60576.81352233887, 58221.7268371582, 57831.50679016113, 59445.50038146973, 61103.06019592285, 58878.44024658203, 59227.30702209473, 56118.50695991516, 59470.0071105957, 57737.57345581055, 60709.52015686035, 55798.95320034027, 59133.36698913574, 56845.88674926758, 58163.26007080078, 57089.65343475342, 58435.833587646484, 58536.97355365753, 60577.52003479004, 56357.59334945679, 59107.126876831055, 60474.440490722656, 55120.173412323, 60229.82038497925, 56004.593479156494, 54587.193415641785, 58503.306884765625, 53761.76004219055, 56524.253410339355, 57563.84669494629, 59703.800201416016, 58279.61359024048, 50450.27343940735, 55139.307037353516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.632926597845874, "mean_inference_ms": 6.572570498751579, "mean_action_processing_ms": 0.19873703802923523, "mean_env_wait_ms": 225.4856123288029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05137324333190918, "StateBufferConnector_ms": 0.005869939923286438, "ViewRequirementAgentConnector_ms": 0.18693134188652039}}, "episode_reward_max": 61930.720306396484, "episode_reward_min": 50450.27343940735, "episode_reward_mean": 57820.408412775025, "episode_len_mean": 136.125, "episodes_this_iter": 64, "policy_reward_min": {"agent_0": 50450.27343940735}, "policy_reward_max": {"agent_0": 61930.720306396484}, "policy_reward_mean": {"agent_0": 57820.408412775025}, "hist_stats": {"episode_reward": [52366.57347822189, 61930.720306396484, 56423.56664657593, 58752.14700317383, 57135.460189819336, 58838.800285339355, 59244.6135559082, 57401.906997680664, 58331.18670654297, 57337.51996457577, 59211.64027404785, 56332.83332777023, 58658.880279541016, 60956.7805557251, 57826.22032928467, 57124.44006347656, 55677.58665084839, 59474.66026306152, 52958.26693725586, 59718.233322143555, 56373.43361854553, 54229.566683769226, 58624.927017211914, 60967.133560180664, 57351.00001144409, 58352.38677215576, 59892.00654602051, 55402.313665390015, 56941.24694061279, 60961.57345581055, 60576.81352233887, 58221.7268371582, 57831.50679016113, 59445.50038146973, 61103.06019592285, 58878.44024658203, 59227.30702209473, 56118.50695991516, 59470.0071105957, 57737.57345581055, 60709.52015686035, 55798.95320034027, 59133.36698913574, 56845.88674926758, 58163.26007080078, 57089.65343475342, 58435.833587646484, 58536.97355365753, 60577.52003479004, 56357.59334945679, 59107.126876831055, 60474.440490722656, 55120.173412323, 60229.82038497925, 56004.593479156494, 54587.193415641785, 58503.306884765625, 53761.76004219055, 56524.253410339355, 57563.84669494629, 59703.800201416016, 58279.61359024048, 50450.27343940735, 55139.307037353516], "episode_lengths": [134, 138, 135, 137, 136, 137, 136, 136, 136, 135, 136, 136, 136, 137, 136, 137, 137, 136, 134, 137, 136, 135, 137, 138, 135, 137, 136, 135, 136, 137, 137, 136, 136, 137, 137, 137, 137, 135, 137, 136, 136, 136, 137, 136, 136, 135, 137, 137, 138, 136, 136, 137, 136, 137, 135, 136, 136, 134, 136, 135, 136, 136, 133, 136], "policy_agent_0_reward": [52366.57347822189, 61930.720306396484, 56423.56664657593, 58752.14700317383, 57135.460189819336, 58838.800285339355, 59244.6135559082, 57401.906997680664, 58331.18670654297, 57337.51996457577, 59211.64027404785, 56332.83332777023, 58658.880279541016, 60956.7805557251, 57826.22032928467, 57124.44006347656, 55677.58665084839, 59474.66026306152, 52958.26693725586, 59718.233322143555, 56373.43361854553, 54229.566683769226, 58624.927017211914, 60967.133560180664, 57351.00001144409, 58352.38677215576, 59892.00654602051, 55402.313665390015, 56941.24694061279, 60961.57345581055, 60576.81352233887, 58221.7268371582, 57831.50679016113, 59445.50038146973, 61103.06019592285, 58878.44024658203, 59227.30702209473, 56118.50695991516, 59470.0071105957, 57737.57345581055, 60709.52015686035, 55798.95320034027, 59133.36698913574, 56845.88674926758, 58163.26007080078, 57089.65343475342, 58435.833587646484, 58536.97355365753, 60577.52003479004, 56357.59334945679, 59107.126876831055, 60474.440490722656, 55120.173412323, 60229.82038497925, 56004.593479156494, 54587.193415641785, 58503.306884765625, 53761.76004219055, 56524.253410339355, 57563.84669494629, 59703.800201416016, 58279.61359024048, 50450.27343940735, 55139.307037353516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.632926597845874, "mean_inference_ms": 6.572570498751579, "mean_action_processing_ms": 0.19873703802923523, "mean_env_wait_ms": 225.4856123288029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05137324333190918, "StateBufferConnector_ms": 0.005869939923286438, "ViewRequirementAgentConnector_ms": 0.18693134188652039}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.4921419173321, "num_env_steps_trained_throughput_per_sec": 273.4921419173321, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 13889.746, "sample_time_ms": 10897.776, "learn_time_ms": 2849.539, "learn_throughput": 1403.736, "synch_weights_time_ms": 141.763}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 4188, "training_iteration": 144, "trial_id": "32397_00000", "date": "2025-03-21_09-11-51", "timestamp": 1742548311, "time_this_iter_s": 14.67226266860962, "time_total_s": 2079.9866387844086, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2079.9866387844086, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 96.885, "ram_util_percent": 13.48}}
{"custom_metrics": {"num_batches_mean": 5.783333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.838258743286133, "policy_loss": -0.011161087080836296, "vf_loss": 9.849365234375, "vf_explained_var": 1.5422702404066513e-07, "kl": 0.008883257396519184, "entropy": 0.29200419783592224, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 61716.760135650635, "episode_reward_min": 53657.98688352108, "episode_reward_mean": 58327.581633963186, "episode_len_mean": 136.41666666666666, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {"agent_0": 53657.98688352108}, "policy_reward_max": {"agent_0": 61716.760135650635}, "policy_reward_mean": {"agent_0": 58327.581633963186}, "custom_metrics": {"num_batches_mean": 5.783333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61243.98043823242, 59122.47351074219, 54998.600158691406, 59737.620178222656, 58882.57357597351, 59485.953369140625, 55826.4001159668, 59361.826721191406, 60026.980182647705, 57935.33337402344, 56437.39992523193, 61716.760135650635, 61016.12010192871, 59790.54008483887, 57222.96011161804, 61285.100357055664, 60195.86671447754, 57477.7537689209, 57340.04675292969, 61550.8472366333, 56068.89351272583, 60198.26026916504, 59633.89349937439, 57039.76697349548, 57040.38032531738, 60700.0133972168, 56909.37365722656, 61182.62036323547, 54575.5002412796, 59216.566818237305, 57884.23337173462, 59202.13363265991, 59209.12683105469, 59089.62679672241, 56053.58010673523, 55621.02677536011, 57330.76685523987, 60794.02716064453, 59088.15370178223, 59562.386768341064, 56640.360191345215, 60439.48031616211, 53657.98688352108, 59848.920471191406, 60482.15344238281, 54056.10671567917, 58403.62683105469, 57120.666732788086, 58527.8337059021, 58931.86682891846, 57920.90010070801, 55839.52019882202, 55029.06004333496, 57435.72010040283, 58688.10661315918, 59932.90691757202, 57763.42012023926, 57142.680252075195, 58895.44012069702, 55842.67358016968], "episode_lengths": [137, 137, 135, 137, 136, 136, 135, 137, 137, 137, 136, 138, 138, 137, 136, 138, 137, 135, 136, 138, 136, 137, 137, 136, 135, 137, 136, 138, 136, 137, 136, 137, 137, 137, 136, 136, 136, 137, 137, 138, 136, 137, 136, 137, 137, 135, 136, 135, 137, 137, 135, 135, 135, 135, 136, 137, 136, 136, 137, 135], "policy_agent_0_reward": [61243.98043823242, 59122.47351074219, 54998.600158691406, 59737.620178222656, 58882.57357597351, 59485.953369140625, 55826.4001159668, 59361.826721191406, 60026.980182647705, 57935.33337402344, 56437.39992523193, 61716.760135650635, 61016.12010192871, 59790.54008483887, 57222.96011161804, 61285.100357055664, 60195.86671447754, 57477.7537689209, 57340.04675292969, 61550.8472366333, 56068.89351272583, 60198.26026916504, 59633.89349937439, 57039.76697349548, 57040.38032531738, 60700.0133972168, 56909.37365722656, 61182.62036323547, 54575.5002412796, 59216.566818237305, 57884.23337173462, 59202.13363265991, 59209.12683105469, 59089.62679672241, 56053.58010673523, 55621.02677536011, 57330.76685523987, 60794.02716064453, 59088.15370178223, 59562.386768341064, 56640.360191345215, 60439.48031616211, 53657.98688352108, 59848.920471191406, 60482.15344238281, 54056.10671567917, 58403.62683105469, 57120.666732788086, 58527.8337059021, 58931.86682891846, 57920.90010070801, 55839.52019882202, 55029.06004333496, 57435.72010040283, 58688.10661315918, 59932.90691757202, 57763.42012023926, 57142.680252075195, 58895.44012069702, 55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.159936295738646, "mean_inference_ms": 6.814848274487677, "mean_action_processing_ms": 0.19757278707726297, "mean_env_wait_ms": 230.40112529770929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03976623217264811, "StateBufferConnector_ms": 0.0063550472259521484, "ViewRequirementAgentConnector_ms": 0.18737991650899252}}, "episode_reward_max": 61716.760135650635, "episode_reward_min": 53657.98688352108, "episode_reward_mean": 58327.581633963186, "episode_len_mean": 136.41666666666666, "episodes_this_iter": 60, "policy_reward_min": {"agent_0": 53657.98688352108}, "policy_reward_max": {"agent_0": 61716.760135650635}, "policy_reward_mean": {"agent_0": 58327.581633963186}, "hist_stats": {"episode_reward": [61243.98043823242, 59122.47351074219, 54998.600158691406, 59737.620178222656, 58882.57357597351, 59485.953369140625, 55826.4001159668, 59361.826721191406, 60026.980182647705, 57935.33337402344, 56437.39992523193, 61716.760135650635, 61016.12010192871, 59790.54008483887, 57222.96011161804, 61285.100357055664, 60195.86671447754, 57477.7537689209, 57340.04675292969, 61550.8472366333, 56068.89351272583, 60198.26026916504, 59633.89349937439, 57039.76697349548, 57040.38032531738, 60700.0133972168, 56909.37365722656, 61182.62036323547, 54575.5002412796, 59216.566818237305, 57884.23337173462, 59202.13363265991, 59209.12683105469, 59089.62679672241, 56053.58010673523, 55621.02677536011, 57330.76685523987, 60794.02716064453, 59088.15370178223, 59562.386768341064, 56640.360191345215, 60439.48031616211, 53657.98688352108, 59848.920471191406, 60482.15344238281, 54056.10671567917, 58403.62683105469, 57120.666732788086, 58527.8337059021, 58931.86682891846, 57920.90010070801, 55839.52019882202, 55029.06004333496, 57435.72010040283, 58688.10661315918, 59932.90691757202, 57763.42012023926, 57142.680252075195, 58895.44012069702, 55842.67358016968], "episode_lengths": [137, 137, 135, 137, 136, 136, 135, 137, 137, 137, 136, 138, 138, 137, 136, 138, 137, 135, 136, 138, 136, 137, 137, 136, 135, 137, 136, 138, 136, 137, 136, 137, 137, 137, 136, 136, 136, 137, 137, 138, 136, 137, 136, 137, 137, 135, 136, 135, 137, 137, 135, 135, 135, 135, 136, 137, 136, 136, 137, 135], "policy_agent_0_reward": [61243.98043823242, 59122.47351074219, 54998.600158691406, 59737.620178222656, 58882.57357597351, 59485.953369140625, 55826.4001159668, 59361.826721191406, 60026.980182647705, 57935.33337402344, 56437.39992523193, 61716.760135650635, 61016.12010192871, 59790.54008483887, 57222.96011161804, 61285.100357055664, 60195.86671447754, 57477.7537689209, 57340.04675292969, 61550.8472366333, 56068.89351272583, 60198.26026916504, 59633.89349937439, 57039.76697349548, 57040.38032531738, 60700.0133972168, 56909.37365722656, 61182.62036323547, 54575.5002412796, 59216.566818237305, 57884.23337173462, 59202.13363265991, 59209.12683105469, 59089.62679672241, 56053.58010673523, 55621.02677536011, 57330.76685523987, 60794.02716064453, 59088.15370178223, 59562.386768341064, 56640.360191345215, 60439.48031616211, 53657.98688352108, 59848.920471191406, 60482.15344238281, 54056.10671567917, 58403.62683105469, 57120.666732788086, 58527.8337059021, 58931.86682891846, 57920.90010070801, 55839.52019882202, 55029.06004333496, 57435.72010040283, 58688.10661315918, 59932.90691757202, 57763.42012023926, 57142.680252075195, 58895.44012069702, 55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.159936295738646, "mean_inference_ms": 6.814848274487677, "mean_action_processing_ms": 0.19757278707726297, "mean_env_wait_ms": 230.40112529770929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03976623217264811, "StateBufferConnector_ms": 0.0063550472259521484, "ViewRequirementAgentConnector_ms": 0.18737991650899252}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.38479317472974, "num_env_steps_trained_throughput_per_sec": 219.38479317472974, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 14413.002, "sample_time_ms": 11396.737, "learn_time_ms": 2868.938, "learn_throughput": 1394.244, "synch_weights_time_ms": 146.669}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 4248, "training_iteration": 145, "trial_id": "32397_00000", "date": "2025-03-21_09-12-09", "timestamp": 1742548329, "time_this_iter_s": 18.290226221084595, "time_total_s": 2098.276865005493, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2098.276865005493, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 98.7375, "ram_util_percent": 13.491666666666667}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988590240478516, "policy_loss": -0.01147204264998436, "vf_loss": 10.0, "vf_explained_var": 5.047768425470167e-08, "kl": 0.00993743073195219, "entropy": 0.27945277094841003, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 55842.67358016968, "episode_reward_min": 55842.67358016968, "episode_reward_mean": 55842.67358016968, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55842.67358016968}, "policy_reward_max": {"agent_0": 55842.67358016968}, "policy_reward_mean": {"agent_0": 55842.67358016968}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55842.67358016968], "episode_lengths": [135], "policy_agent_0_reward": [55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.31997835150671, "mean_inference_ms": 6.732207694667035, "mean_action_processing_ms": 0.19340293208629608, "mean_env_wait_ms": 229.4170918636244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.17063617706298828}}, "episode_reward_max": 55842.67358016968, "episode_reward_min": 55842.67358016968, "episode_reward_mean": 55842.67358016968, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55842.67358016968}, "policy_reward_max": {"agent_0": 55842.67358016968}, "policy_reward_mean": {"agent_0": 55842.67358016968}, "hist_stats": {"episode_reward": [55842.67358016968], "episode_lengths": [135], "policy_agent_0_reward": [55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.31997835150671, "mean_inference_ms": 6.732207694667035, "mean_action_processing_ms": 0.19340293208629608, "mean_env_wait_ms": 229.4170918636244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.17063617706298828}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.1256361954155, "num_env_steps_trained_throughput_per_sec": 299.1256361954155, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 14043.179, "sample_time_ms": 10978.513, "learn_time_ms": 2911.145, "learn_throughput": 1374.03, "synch_weights_time_ms": 152.886}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 4248, "training_iteration": 146, "trial_id": "32397_00000", "date": "2025-03-21_09-12-23", "timestamp": 1742548343, "time_this_iter_s": 13.422758102416992, "time_total_s": 2111.69962310791, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2111.69962310791, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 99.55, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986776351928711, "policy_loss": -0.013293922878801823, "vf_loss": 10.0, "vf_explained_var": 8.208056101466354e-08, "kl": 0.011311580426990986, "entropy": 0.3255469501018524, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 55842.67358016968, "episode_reward_min": 55842.67358016968, "episode_reward_mean": 55842.67358016968, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55842.67358016968}, "policy_reward_max": {"agent_0": 55842.67358016968}, "policy_reward_mean": {"agent_0": 55842.67358016968}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55842.67358016968], "episode_lengths": [135], "policy_agent_0_reward": [55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.31997835150671, "mean_inference_ms": 6.732207694667035, "mean_action_processing_ms": 0.19340293208629608, "mean_env_wait_ms": 229.4170918636244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.17063617706298828}}, "episode_reward_max": 55842.67358016968, "episode_reward_min": 55842.67358016968, "episode_reward_mean": 55842.67358016968, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55842.67358016968}, "policy_reward_max": {"agent_0": 55842.67358016968}, "policy_reward_mean": {"agent_0": 55842.67358016968}, "hist_stats": {"episode_reward": [55842.67358016968], "episode_lengths": [135], "policy_agent_0_reward": [55842.67358016968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.31997835150671, "mean_inference_ms": 6.732207694667035, "mean_action_processing_ms": 0.19340293208629608, "mean_env_wait_ms": 229.4170918636244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408172607421875, "StateBufferConnector_ms": 0.0057220458984375, "ViewRequirementAgentConnector_ms": 0.17063617706298828}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.53929415450176, "num_env_steps_trained_throughput_per_sec": 289.53929415450176, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 14164.137, "sample_time_ms": 11029.187, "learn_time_ms": 2978.236, "learn_throughput": 1343.077, "synch_weights_time_ms": 156.069}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 4248, "training_iteration": 147, "trial_id": "32397_00000", "date": "2025-03-21_09-12-37", "timestamp": 1742548357, "time_this_iter_s": 13.874673843383789, "time_total_s": 2125.574296951294, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2125.574296951294, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 99.58947368421055, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.930741310119629, "policy_loss": -0.011704337783157825, "vf_loss": 9.942384719848633, "vf_explained_var": -1.862645149230957e-08, "kl": 0.009727299213409424, "entropy": 0.3114452660083771, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 61297.16683959961, "episode_reward_min": 51171.806565761566, "episode_reward_mean": 58023.96512933399, "episode_len_mean": 136.6086956521739, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 51171.806565761566}, "policy_reward_max": {"agent_0": 61297.16683959961}, "policy_reward_mean": {"agent_0": 58023.96512933399}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56313.13359642029, 59478.77365875244, 57863.1399230957, 61297.16683959961, 61161.513916015625, 58695.49359893799, 60892.31344604492, 57011.8468170166, 59144.060066223145, 57650.28022003174, 57207.886669158936, 57653.39344787598, 61290.69357299805, 58385.42038345337, 55857.79358673096, 60199.5602722168, 51171.806565761566, 58763.86705207825, 59245.10028076172, 57580.180267333984, 53222.453565597534, 58777.00680541992, 55688.31342315674], "episode_lengths": [136, 137, 136, 138, 137, 136, 137, 136, 137, 136, 137, 136, 138, 137, 137, 137, 135, 136, 137, 136, 137, 137, 136], "policy_agent_0_reward": [56313.13359642029, 59478.77365875244, 57863.1399230957, 61297.16683959961, 61161.513916015625, 58695.49359893799, 60892.31344604492, 57011.8468170166, 59144.060066223145, 57650.28022003174, 57207.886669158936, 57653.39344787598, 61290.69357299805, 58385.42038345337, 55857.79358673096, 60199.5602722168, 51171.806565761566, 58763.86705207825, 59245.10028076172, 57580.180267333984, 53222.453565597534, 58777.00680541992, 55688.31342315674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.49467234085967, "mean_inference_ms": 6.455504923372877, "mean_action_processing_ms": 0.2003350316709692, "mean_env_wait_ms": 219.19579856674991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054958592290463654, "StateBufferConnector_ms": 0.006139796713124151, "ViewRequirementAgentConnector_ms": 0.2892297247181768}}, "episode_reward_max": 61297.16683959961, "episode_reward_min": 51171.806565761566, "episode_reward_mean": 58023.96512933399, "episode_len_mean": 136.6086956521739, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 51171.806565761566}, "policy_reward_max": {"agent_0": 61297.16683959961}, "policy_reward_mean": {"agent_0": 58023.96512933399}, "hist_stats": {"episode_reward": [56313.13359642029, 59478.77365875244, 57863.1399230957, 61297.16683959961, 61161.513916015625, 58695.49359893799, 60892.31344604492, 57011.8468170166, 59144.060066223145, 57650.28022003174, 57207.886669158936, 57653.39344787598, 61290.69357299805, 58385.42038345337, 55857.79358673096, 60199.5602722168, 51171.806565761566, 58763.86705207825, 59245.10028076172, 57580.180267333984, 53222.453565597534, 58777.00680541992, 55688.31342315674], "episode_lengths": [136, 137, 136, 138, 137, 136, 137, 136, 137, 136, 137, 136, 138, 137, 137, 137, 135, 136, 137, 136, 137, 137, 136], "policy_agent_0_reward": [56313.13359642029, 59478.77365875244, 57863.1399230957, 61297.16683959961, 61161.513916015625, 58695.49359893799, 60892.31344604492, 57011.8468170166, 59144.060066223145, 57650.28022003174, 57207.886669158936, 57653.39344787598, 61290.69357299805, 58385.42038345337, 55857.79358673096, 60199.5602722168, 51171.806565761566, 58763.86705207825, 59245.10028076172, 57580.180267333984, 53222.453565597534, 58777.00680541992, 55688.31342315674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.49467234085967, "mean_inference_ms": 6.455504923372877, "mean_action_processing_ms": 0.2003350316709692, "mean_env_wait_ms": 219.19579856674991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054958592290463654, "StateBufferConnector_ms": 0.006139796713124151, "ViewRequirementAgentConnector_ms": 0.2892297247181768}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.5713858804956, "num_env_steps_trained_throughput_per_sec": 312.5713858804956, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 14177.748, "sample_time_ms": 11065.683, "learn_time_ms": 2952.063, "learn_throughput": 1354.985, "synch_weights_time_ms": 159.369}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 4271, "training_iteration": 148, "trial_id": "32397_00000", "date": "2025-03-21_09-12-50", "timestamp": 1742548370, "time_this_iter_s": 12.841692447662354, "time_total_s": 2138.4159893989563, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2138.4159893989563, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 98.9157894736842, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.336633663366337, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.733259201049805, "policy_loss": -0.011191672645509243, "vf_loss": 9.744384765625, "vf_explained_var": 4.6566128730773926e-08, "kl": 0.010566426441073418, "entropy": 0.28410664200782776, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 61898.0666809082, "episode_reward_min": 49554.98040485382, "episode_reward_mean": 57696.478262501776, "episode_len_mean": 136.31683168316832, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {"agent_0": 49554.98040485382}, "policy_reward_max": {"agent_0": 61898.0666809082}, "policy_reward_mean": {"agent_0": 57696.478262501776}, "custom_metrics": {"num_batches_mean": 5.336633663366337, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60642.147048950195, 59081.24026489258, 58131.35350942612, 61293.006912231445, 58039.32678985596, 61269.76058959961, 58294.30019760132, 60209.7737121582, 58712.74697494507, 59778.36700439453, 54066.88695716858, 58009.04030609131, 53239.78010940552, 57575.05352783203, 57004.68014717102, 60891.75338745117, 60344.426849365234, 57091.38006591797, 57252.2467956543, 58913.760078430176, 55635.32012748718, 54670.460317611694, 59468.0269203186, 57931.45336341858, 57262.800022125244, 55126.406732559204, 55690.14009475708, 56432.160053253174, 57991.773513793945, 61898.0666809082, 57846.12673187256, 57627.19337463379, 59994.36698913574, 58050.380043029785, 54081.02028465271, 59508.17385864258, 54059.84704589844, 59176.1338634491, 57791.12680244446, 53740.713530540466, 59709.43344116211, 51267.113343179226, 57117.61333465576, 60355.17994308472, 60617.58020019531, 56566.360050201416, 60576.58709716797, 54445.840242385864, 58449.36657714844, 55629.18010044098, 53289.04672765732, 56853.873722076416, 58499.7670173645, 59263.30005073547, 60904.43339538574, 61679.00695800781, 60415.21334838867, 59548.55304336548, 56879.81315612793, 61554.153411865234, 58809.326751708984, 52436.88660812378, 60133.13360595703, 60191.34683227539, 59247.42025756836, 55532.726840019226, 56012.36015319824, 51551.06008148193, 57851.753640174866, 59775.98693847656, 51862.18021774292, 57685.9204120636, 54658.58020019531, 57148.147082567215, 60276.64687538147, 56594.027084350586, 58781.53355407715, 56754.440490722656, 58027.54690170288, 60270.553482055664, 58508.26022338867, 59542.626682281494, 52523.50702095032, 59373.32666015625, 59477.12007904053, 54728.12000465393, 56395.233585357666, 49554.98040485382, 55043.97352409363, 59242.500076293945, 61182.74691772461, 52538.173432826996, 57718.75361633301, 60154.586738586426, 58235.00673675537, 60054.54043006897, 58286.14013671875, 57880.653445243835, 59698.50686645508, 56549.306661605835, 59610.52651977539], "episode_lengths": [138, 136, 137, 138, 137, 137, 136, 137, 137, 138, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 135, 137, 136, 138, 135, 136, 137, 135, 135, 138, 136, 138, 136, 135, 137, 135, 135, 137, 138, 136, 137, 136, 136, 135, 136, 136, 137, 136, 137, 137, 137, 137, 136, 138, 136, 134, 137, 137, 136, 135, 136, 134, 136, 137, 136, 137, 135, 136, 137, 136, 136, 136, 136, 137, 137, 137, 135, 136, 137, 135, 137, 134, 135, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 135, 137], "policy_agent_0_reward": [60642.147048950195, 59081.24026489258, 58131.35350942612, 61293.006912231445, 58039.32678985596, 61269.76058959961, 58294.30019760132, 60209.7737121582, 58712.74697494507, 59778.36700439453, 54066.88695716858, 58009.04030609131, 53239.78010940552, 57575.05352783203, 57004.68014717102, 60891.75338745117, 60344.426849365234, 57091.38006591797, 57252.2467956543, 58913.760078430176, 55635.32012748718, 54670.460317611694, 59468.0269203186, 57931.45336341858, 57262.800022125244, 55126.406732559204, 55690.14009475708, 56432.160053253174, 57991.773513793945, 61898.0666809082, 57846.12673187256, 57627.19337463379, 59994.36698913574, 58050.380043029785, 54081.02028465271, 59508.17385864258, 54059.84704589844, 59176.1338634491, 57791.12680244446, 53740.713530540466, 59709.43344116211, 51267.113343179226, 57117.61333465576, 60355.17994308472, 60617.58020019531, 56566.360050201416, 60576.58709716797, 54445.840242385864, 58449.36657714844, 55629.18010044098, 53289.04672765732, 56853.873722076416, 58499.7670173645, 59263.30005073547, 60904.43339538574, 61679.00695800781, 60415.21334838867, 59548.55304336548, 56879.81315612793, 61554.153411865234, 58809.326751708984, 52436.88660812378, 60133.13360595703, 60191.34683227539, 59247.42025756836, 55532.726840019226, 56012.36015319824, 51551.06008148193, 57851.753640174866, 59775.98693847656, 51862.18021774292, 57685.9204120636, 54658.58020019531, 57148.147082567215, 60276.64687538147, 56594.027084350586, 58781.53355407715, 56754.440490722656, 58027.54690170288, 60270.553482055664, 58508.26022338867, 59542.626682281494, 52523.50702095032, 59373.32666015625, 59477.12007904053, 54728.12000465393, 56395.233585357666, 49554.98040485382, 55043.97352409363, 59242.500076293945, 61182.74691772461, 52538.173432826996, 57718.75361633301, 60154.586738586426, 58235.00673675537, 60054.54043006897, 58286.14013671875, 57880.653445243835, 59698.50686645508, 56549.306661605835, 59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.030208620747143, "mean_inference_ms": 6.735658194244707, "mean_action_processing_ms": 0.19758867155958754, "mean_env_wait_ms": 229.67877334662137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06976245653511275, "StateBufferConnector_ms": 0.006013813585338026, "ViewRequirementAgentConnector_ms": 0.24145404891212388}}, "episode_reward_max": 61898.0666809082, "episode_reward_min": 49554.98040485382, "episode_reward_mean": 57696.478262501776, "episode_len_mean": 136.31683168316832, "episodes_this_iter": 101, "policy_reward_min": {"agent_0": 49554.98040485382}, "policy_reward_max": {"agent_0": 61898.0666809082}, "policy_reward_mean": {"agent_0": 57696.478262501776}, "hist_stats": {"episode_reward": [60642.147048950195, 59081.24026489258, 58131.35350942612, 61293.006912231445, 58039.32678985596, 61269.76058959961, 58294.30019760132, 60209.7737121582, 58712.74697494507, 59778.36700439453, 54066.88695716858, 58009.04030609131, 53239.78010940552, 57575.05352783203, 57004.68014717102, 60891.75338745117, 60344.426849365234, 57091.38006591797, 57252.2467956543, 58913.760078430176, 55635.32012748718, 54670.460317611694, 59468.0269203186, 57931.45336341858, 57262.800022125244, 55126.406732559204, 55690.14009475708, 56432.160053253174, 57991.773513793945, 61898.0666809082, 57846.12673187256, 57627.19337463379, 59994.36698913574, 58050.380043029785, 54081.02028465271, 59508.17385864258, 54059.84704589844, 59176.1338634491, 57791.12680244446, 53740.713530540466, 59709.43344116211, 51267.113343179226, 57117.61333465576, 60355.17994308472, 60617.58020019531, 56566.360050201416, 60576.58709716797, 54445.840242385864, 58449.36657714844, 55629.18010044098, 53289.04672765732, 56853.873722076416, 58499.7670173645, 59263.30005073547, 60904.43339538574, 61679.00695800781, 60415.21334838867, 59548.55304336548, 56879.81315612793, 61554.153411865234, 58809.326751708984, 52436.88660812378, 60133.13360595703, 60191.34683227539, 59247.42025756836, 55532.726840019226, 56012.36015319824, 51551.06008148193, 57851.753640174866, 59775.98693847656, 51862.18021774292, 57685.9204120636, 54658.58020019531, 57148.147082567215, 60276.64687538147, 56594.027084350586, 58781.53355407715, 56754.440490722656, 58027.54690170288, 60270.553482055664, 58508.26022338867, 59542.626682281494, 52523.50702095032, 59373.32666015625, 59477.12007904053, 54728.12000465393, 56395.233585357666, 49554.98040485382, 55043.97352409363, 59242.500076293945, 61182.74691772461, 52538.173432826996, 57718.75361633301, 60154.586738586426, 58235.00673675537, 60054.54043006897, 58286.14013671875, 57880.653445243835, 59698.50686645508, 56549.306661605835, 59610.52651977539], "episode_lengths": [138, 136, 137, 138, 137, 137, 136, 137, 137, 138, 136, 136, 135, 137, 136, 137, 137, 136, 136, 136, 136, 137, 137, 136, 136, 136, 135, 137, 136, 138, 135, 136, 137, 135, 135, 138, 136, 138, 136, 135, 137, 135, 135, 137, 138, 136, 137, 136, 136, 135, 136, 136, 137, 136, 137, 137, 137, 137, 136, 138, 136, 134, 137, 137, 136, 135, 136, 134, 136, 137, 136, 137, 135, 136, 137, 136, 136, 136, 136, 137, 137, 137, 135, 136, 137, 135, 137, 134, 135, 137, 137, 136, 137, 137, 136, 137, 136, 136, 137, 135, 137], "policy_agent_0_reward": [60642.147048950195, 59081.24026489258, 58131.35350942612, 61293.006912231445, 58039.32678985596, 61269.76058959961, 58294.30019760132, 60209.7737121582, 58712.74697494507, 59778.36700439453, 54066.88695716858, 58009.04030609131, 53239.78010940552, 57575.05352783203, 57004.68014717102, 60891.75338745117, 60344.426849365234, 57091.38006591797, 57252.2467956543, 58913.760078430176, 55635.32012748718, 54670.460317611694, 59468.0269203186, 57931.45336341858, 57262.800022125244, 55126.406732559204, 55690.14009475708, 56432.160053253174, 57991.773513793945, 61898.0666809082, 57846.12673187256, 57627.19337463379, 59994.36698913574, 58050.380043029785, 54081.02028465271, 59508.17385864258, 54059.84704589844, 59176.1338634491, 57791.12680244446, 53740.713530540466, 59709.43344116211, 51267.113343179226, 57117.61333465576, 60355.17994308472, 60617.58020019531, 56566.360050201416, 60576.58709716797, 54445.840242385864, 58449.36657714844, 55629.18010044098, 53289.04672765732, 56853.873722076416, 58499.7670173645, 59263.30005073547, 60904.43339538574, 61679.00695800781, 60415.21334838867, 59548.55304336548, 56879.81315612793, 61554.153411865234, 58809.326751708984, 52436.88660812378, 60133.13360595703, 60191.34683227539, 59247.42025756836, 55532.726840019226, 56012.36015319824, 51551.06008148193, 57851.753640174866, 59775.98693847656, 51862.18021774292, 57685.9204120636, 54658.58020019531, 57148.147082567215, 60276.64687538147, 56594.027084350586, 58781.53355407715, 56754.440490722656, 58027.54690170288, 60270.553482055664, 58508.26022338867, 59542.626682281494, 52523.50702095032, 59373.32666015625, 59477.12007904053, 54728.12000465393, 56395.233585357666, 49554.98040485382, 55043.97352409363, 59242.500076293945, 61182.74691772461, 52538.173432826996, 57718.75361633301, 60154.586738586426, 58235.00673675537, 60054.54043006897, 58286.14013671875, 57880.653445243835, 59698.50686645508, 56549.306661605835, 59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.030208620747143, "mean_inference_ms": 6.735658194244707, "mean_action_processing_ms": 0.19758867155958754, "mean_env_wait_ms": 229.67877334662137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06976245653511275, "StateBufferConnector_ms": 0.006013813585338026, "ViewRequirementAgentConnector_ms": 0.24145404891212388}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.29379478661906, "num_env_steps_trained_throughput_per_sec": 221.29379478661906, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 14664.707, "sample_time_ms": 11593.343, "learn_time_ms": 2916.291, "learn_throughput": 1371.605, "synch_weights_time_ms": 154.431}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 4372, "training_iteration": 149, "trial_id": "32397_00000", "date": "2025-03-21_09-13-08", "timestamp": 1742548388, "time_this_iter_s": 18.14103364944458, "time_total_s": 2156.557023048401, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb7015a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2156.557023048401, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 96.32173913043476, "ram_util_percent": 13.495652173913042}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98782730102539, "policy_loss": -0.012241723015904427, "vf_loss": 10.0, "vf_explained_var": -2.1917124115589104e-08, "kl": 0.011183440685272217, "entropy": 0.2958897352218628, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 59610.52651977539, "episode_reward_min": 59610.52651977539, "episode_reward_mean": 59610.52651977539, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59610.52651977539}, "policy_reward_max": {"agent_0": 59610.52651977539}, "policy_reward_mean": {"agent_0": 59610.52651977539}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59610.52651977539], "episode_lengths": [137], "policy_agent_0_reward": [59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58005431373806, "mean_inference_ms": 6.752247879354678, "mean_action_processing_ms": 0.19335506796761864, "mean_env_wait_ms": 228.37499303371808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04227161407470703, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1772165298461914}}, "episode_reward_max": 59610.52651977539, "episode_reward_min": 59610.52651977539, "episode_reward_mean": 59610.52651977539, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59610.52651977539}, "policy_reward_max": {"agent_0": 59610.52651977539}, "policy_reward_mean": {"agent_0": 59610.52651977539}, "hist_stats": {"episode_reward": [59610.52651977539], "episode_lengths": [137], "policy_agent_0_reward": [59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58005431373806, "mean_inference_ms": 6.752247879354678, "mean_action_processing_ms": 0.19335506796761864, "mean_env_wait_ms": 228.37499303371808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04227161407470703, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1772165298461914}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.36750440897316, "num_env_steps_trained_throughput_per_sec": 307.36750440897316, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 14389.852, "sample_time_ms": 11266.916, "learn_time_ms": 2966.978, "learn_throughput": 1348.173, "synch_weights_time_ms": 155.315}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 4372, "training_iteration": 150, "trial_id": "32397_00000", "date": "2025-03-21_09-13-21", "timestamp": 1742548401, "time_this_iter_s": 13.073334455490112, "time_total_s": 2169.630357503891, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb338550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2169.630357503891, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 99.55263157894737, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.989044189453125, "policy_loss": -0.01102507021278143, "vf_loss": 10.0, "vf_explained_var": -3.23479376618252e-08, "kl": 0.0111080352216959, "entropy": 0.2990393340587616, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": 59610.52651977539, "episode_reward_min": 59610.52651977539, "episode_reward_mean": 59610.52651977539, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59610.52651977539}, "policy_reward_max": {"agent_0": 59610.52651977539}, "policy_reward_mean": {"agent_0": 59610.52651977539}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59610.52651977539], "episode_lengths": [137], "policy_agent_0_reward": [59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58005431373806, "mean_inference_ms": 6.752247879354678, "mean_action_processing_ms": 0.19335506796761864, "mean_env_wait_ms": 228.37499303371808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04227161407470703, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1772165298461914}}, "episode_reward_max": 59610.52651977539, "episode_reward_min": 59610.52651977539, "episode_reward_mean": 59610.52651977539, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59610.52651977539}, "policy_reward_max": {"agent_0": 59610.52651977539}, "policy_reward_mean": {"agent_0": 59610.52651977539}, "hist_stats": {"episode_reward": [59610.52651977539], "episode_lengths": [137], "policy_agent_0_reward": [59610.52651977539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.58005431373806, "mean_inference_ms": 6.752247879354678, "mean_action_processing_ms": 0.19335506796761864, "mean_env_wait_ms": 228.37499303371808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04227161407470703, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.1772165298461914}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.61000696386634, "num_env_steps_trained_throughput_per_sec": 318.61000696386634, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 14305.337, "sample_time_ms": 11196.916, "learn_time_ms": 2954.201, "learn_throughput": 1354.004, "synch_weights_time_ms": 153.549}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 4372, "training_iteration": 151, "trial_id": "32397_00000", "date": "2025-03-21_09-13-34", "timestamp": 1742548414, "time_this_iter_s": 12.609858512878418, "time_total_s": 2182.2402160167694, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb6d2170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2182.2402160167694, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 99.67647058823529, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.964517593383789, "policy_loss": -0.010643597692251205, "vf_loss": 9.97509765625, "vf_explained_var": 2.5704503414658575e-08, "kl": 0.009987294673919678, "entropy": 0.26212844252586365, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": 62061.34689331055, "episode_reward_min": 52449.14676475525, "episode_reward_mean": 57079.05021839142, "episode_len_mean": 136.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 52449.14676475525}, "policy_reward_max": {"agent_0": 62061.34689331055}, "policy_reward_mean": {"agent_0": 57079.05021839142}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57032.62696647644, 62061.34689331055, 60195.913970947266, 57268.813537597656, 52449.14676475525, 53126.74668884277, 58293.120208740234, 54378.873505592346, 58781.96688365936, 57201.94676399231], "episode_lengths": [135, 138, 137, 136, 135, 135, 136, 136, 137, 136], "policy_agent_0_reward": [57032.62696647644, 62061.34689331055, 60195.913970947266, 57268.813537597656, 52449.14676475525, 53126.74668884277, 58293.120208740234, 54378.873505592346, 58781.96688365936, 57201.94676399231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.05254408893581, "mean_inference_ms": 6.463945589147291, "mean_action_processing_ms": 0.1992849992855103, "mean_env_wait_ms": 217.58902038690553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08851766586303711, "StateBufferConnector_ms": 0.006239414215087891, "ViewRequirementAgentConnector_ms": 0.24913549423217773}}, "episode_reward_max": 62061.34689331055, "episode_reward_min": 52449.14676475525, "episode_reward_mean": 57079.05021839142, "episode_len_mean": 136.1, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 52449.14676475525}, "policy_reward_max": {"agent_0": 62061.34689331055}, "policy_reward_mean": {"agent_0": 57079.05021839142}, "hist_stats": {"episode_reward": [57032.62696647644, 62061.34689331055, 60195.913970947266, 57268.813537597656, 52449.14676475525, 53126.74668884277, 58293.120208740234, 54378.873505592346, 58781.96688365936, 57201.94676399231], "episode_lengths": [135, 138, 137, 136, 135, 135, 136, 136, 137, 136], "policy_agent_0_reward": [57032.62696647644, 62061.34689331055, 60195.913970947266, 57268.813537597656, 52449.14676475525, 53126.74668884277, 58293.120208740234, 54378.873505592346, 58781.96688365936, 57201.94676399231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.05254408893581, "mean_inference_ms": 6.463945589147291, "mean_action_processing_ms": 0.1992849992855103, "mean_env_wait_ms": 217.58902038690553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08851766586303711, "StateBufferConnector_ms": 0.006239414215087891, "ViewRequirementAgentConnector_ms": 0.24913549423217773}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.01666043654325, "num_env_steps_trained_throughput_per_sec": 305.01666043654325, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 14311.634, "sample_time_ms": 11246.933, "learn_time_ms": 2912.652, "learn_throughput": 1373.319, "synch_weights_time_ms": 151.379}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 4382, "training_iteration": 152, "trial_id": "32397_00000", "date": "2025-03-21_09-13-47", "timestamp": 1742548427, "time_this_iter_s": 13.163748502731323, "time_total_s": 2195.4039645195007, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2195.4039645195007, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 99.3, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0701754385964914, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.703627586364746, "policy_loss": -0.01201915368437767, "vf_loss": 9.715576171875, "vf_explained_var": 1.7806887342430855e-07, "kl": 0.011205676943063736, "entropy": 0.27399155497550964, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 62400.18719482422, "episode_reward_min": 52214.886779785156, "episode_reward_mean": 57969.37401809765, "episode_len_mean": 136.42105263157896, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {"agent_0": 52214.886779785156}, "policy_reward_max": {"agent_0": 62400.18719482422}, "policy_reward_mean": {"agent_0": 57969.37401809765}, "custom_metrics": {"num_batches_mean": 5.0701754385964914, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59042.1867980957, 59238.706954956055, 60788.693450927734, 58674.373516082764, 58711.8069152832, 57058.14706802368, 55913.48669433594, 58817.48020553589, 57508.97360229492, 59018.56684231758, 56503.253257751465, 57206.83353805542, 55480.66023826599, 60072.7737121582, 56826.93359422684, 57285.34671783447, 59921.880197525024, 60164.6203918457, 58990.94013977051, 58760.96686553955, 60483.880432128906, 60453.98678588867, 53520.26024436951, 60582.193420410156, 55760.96010494232, 58186.227127075195, 58734.287033081055, 56653.47378921509, 54663.42686533928, 56493.00024795532, 60563.28704071045, 60222.01998901367, 61818.38021850586, 54575.680278778076, 58141.38687133789, 56604.28040981293, 59528.586990356445, 55795.16011810303, 54125.746643066406, 59207.03999328613, 61614.786682128906, 58228.62688446045, 56524.733406066895, 57785.24701690674, 60063.059997558594, 56906.127002716064, 57099.326652526855, 61072.29345703125, 58178.72003173828, 53904.660161972046, 54642.97331285477, 56688.48675823212, 57951.17367553711, 60158.52028656006, 56385.253695487976, 54030.226989746094, 55520.04034900665, 56206.80702972412, 54232.9334564209, 58310.66680908203, 56580.933576881886, 59325.780223846436, 58782.84680175781, 52710.72681045532, 56549.54699707031, 57989.37345504761, 57005.860074043274, 58311.533824920654, 56918.380321502686, 59309.38681411743, 62400.18719482422, 52214.886779785156, 56897.32670211792, 57842.46023821831, 60616.6936340332, 55096.85998535156, 59225.106872558594, 55550.26022481918, 58412.72686767578, 56346.3935174942, 57958.426736831665, 55031.52685165405, 59759.667167663574, 59697.70684051514, 57407.33359146118, 59265.8936920166, 58119.753509521484, 52312.36674118042, 60488.026947021484, 58275.593421936035, 58756.72009277344, 59716.36693096161, 60086.5133972168, 61745.01348876953, 57482.77383995056, 54565.6669921875, 60656.08712768555, 60303.053802490234, 59827.82676696777, 61073.96692276001, 57819.806732177734, 59247.96705055237, 58274.20671463013, 61468.69357299805, 57501.353342175484, 56913.09359741211, 58931.613540649414, 55427.073738098145, 57353.7737197876, 60369.440200805664, 56162.51368904114, 60803.06709289551, 61671.333587646484, 58342.58674621582], "episode_lengths": [136, 136, 138, 137, 137, 136, 136, 137, 135, 136, 136, 136, 136, 138, 136, 136, 137, 137, 137, 137, 137, 137, 134, 138, 137, 137, 137, 136, 136, 136, 137, 137, 137, 135, 136, 136, 137, 137, 136, 136, 138, 136, 137, 136, 137, 136, 136, 138, 137, 135, 135, 136, 136, 137, 136, 135, 136, 137, 135, 136, 135, 138, 137, 136, 136, 136, 136, 136, 136, 137, 138, 135, 137, 136, 137, 135, 136, 136, 137, 136, 137, 135, 137, 137, 136, 136, 136, 135, 138, 137, 136, 137, 137, 138, 137, 135, 137, 137, 137, 137, 135, 137, 136, 138, 136, 137, 137, 135, 136, 137, 136, 137, 137, 136], "policy_agent_0_reward": [59042.1867980957, 59238.706954956055, 60788.693450927734, 58674.373516082764, 58711.8069152832, 57058.14706802368, 55913.48669433594, 58817.48020553589, 57508.97360229492, 59018.56684231758, 56503.253257751465, 57206.83353805542, 55480.66023826599, 60072.7737121582, 56826.93359422684, 57285.34671783447, 59921.880197525024, 60164.6203918457, 58990.94013977051, 58760.96686553955, 60483.880432128906, 60453.98678588867, 53520.26024436951, 60582.193420410156, 55760.96010494232, 58186.227127075195, 58734.287033081055, 56653.47378921509, 54663.42686533928, 56493.00024795532, 60563.28704071045, 60222.01998901367, 61818.38021850586, 54575.680278778076, 58141.38687133789, 56604.28040981293, 59528.586990356445, 55795.16011810303, 54125.746643066406, 59207.03999328613, 61614.786682128906, 58228.62688446045, 56524.733406066895, 57785.24701690674, 60063.059997558594, 56906.127002716064, 57099.326652526855, 61072.29345703125, 58178.72003173828, 53904.660161972046, 54642.97331285477, 56688.48675823212, 57951.17367553711, 60158.52028656006, 56385.253695487976, 54030.226989746094, 55520.04034900665, 56206.80702972412, 54232.9334564209, 58310.66680908203, 56580.933576881886, 59325.780223846436, 58782.84680175781, 52710.72681045532, 56549.54699707031, 57989.37345504761, 57005.860074043274, 58311.533824920654, 56918.380321502686, 59309.38681411743, 62400.18719482422, 52214.886779785156, 56897.32670211792, 57842.46023821831, 60616.6936340332, 55096.85998535156, 59225.106872558594, 55550.26022481918, 58412.72686767578, 56346.3935174942, 57958.426736831665, 55031.52685165405, 59759.667167663574, 59697.70684051514, 57407.33359146118, 59265.8936920166, 58119.753509521484, 52312.36674118042, 60488.026947021484, 58275.593421936035, 58756.72009277344, 59716.36693096161, 60086.5133972168, 61745.01348876953, 57482.77383995056, 54565.6669921875, 60656.08712768555, 60303.053802490234, 59827.82676696777, 61073.96692276001, 57819.806732177734, 59247.96705055237, 58274.20671463013, 61468.69357299805, 57501.353342175484, 56913.09359741211, 58931.613540649414, 55427.073738098145, 57353.7737197876, 60369.440200805664, 56162.51368904114, 60803.06709289551, 61671.333587646484, 58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.474287069641857, "mean_inference_ms": 6.710393648499842, "mean_action_processing_ms": 0.19796705063981496, "mean_env_wait_ms": 228.5030477887572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04147751289501525, "StateBufferConnector_ms": 0.0058337261802271796, "ViewRequirementAgentConnector_ms": 0.19775608129668654}}, "episode_reward_max": 62400.18719482422, "episode_reward_min": 52214.886779785156, "episode_reward_mean": 57969.37401809765, "episode_len_mean": 136.42105263157896, "episodes_this_iter": 114, "policy_reward_min": {"agent_0": 52214.886779785156}, "policy_reward_max": {"agent_0": 62400.18719482422}, "policy_reward_mean": {"agent_0": 57969.37401809765}, "hist_stats": {"episode_reward": [59042.1867980957, 59238.706954956055, 60788.693450927734, 58674.373516082764, 58711.8069152832, 57058.14706802368, 55913.48669433594, 58817.48020553589, 57508.97360229492, 59018.56684231758, 56503.253257751465, 57206.83353805542, 55480.66023826599, 60072.7737121582, 56826.93359422684, 57285.34671783447, 59921.880197525024, 60164.6203918457, 58990.94013977051, 58760.96686553955, 60483.880432128906, 60453.98678588867, 53520.26024436951, 60582.193420410156, 55760.96010494232, 58186.227127075195, 58734.287033081055, 56653.47378921509, 54663.42686533928, 56493.00024795532, 60563.28704071045, 60222.01998901367, 61818.38021850586, 54575.680278778076, 58141.38687133789, 56604.28040981293, 59528.586990356445, 55795.16011810303, 54125.746643066406, 59207.03999328613, 61614.786682128906, 58228.62688446045, 56524.733406066895, 57785.24701690674, 60063.059997558594, 56906.127002716064, 57099.326652526855, 61072.29345703125, 58178.72003173828, 53904.660161972046, 54642.97331285477, 56688.48675823212, 57951.17367553711, 60158.52028656006, 56385.253695487976, 54030.226989746094, 55520.04034900665, 56206.80702972412, 54232.9334564209, 58310.66680908203, 56580.933576881886, 59325.780223846436, 58782.84680175781, 52710.72681045532, 56549.54699707031, 57989.37345504761, 57005.860074043274, 58311.533824920654, 56918.380321502686, 59309.38681411743, 62400.18719482422, 52214.886779785156, 56897.32670211792, 57842.46023821831, 60616.6936340332, 55096.85998535156, 59225.106872558594, 55550.26022481918, 58412.72686767578, 56346.3935174942, 57958.426736831665, 55031.52685165405, 59759.667167663574, 59697.70684051514, 57407.33359146118, 59265.8936920166, 58119.753509521484, 52312.36674118042, 60488.026947021484, 58275.593421936035, 58756.72009277344, 59716.36693096161, 60086.5133972168, 61745.01348876953, 57482.77383995056, 54565.6669921875, 60656.08712768555, 60303.053802490234, 59827.82676696777, 61073.96692276001, 57819.806732177734, 59247.96705055237, 58274.20671463013, 61468.69357299805, 57501.353342175484, 56913.09359741211, 58931.613540649414, 55427.073738098145, 57353.7737197876, 60369.440200805664, 56162.51368904114, 60803.06709289551, 61671.333587646484, 58342.58674621582], "episode_lengths": [136, 136, 138, 137, 137, 136, 136, 137, 135, 136, 136, 136, 136, 138, 136, 136, 137, 137, 137, 137, 137, 137, 134, 138, 137, 137, 137, 136, 136, 136, 137, 137, 137, 135, 136, 136, 137, 137, 136, 136, 138, 136, 137, 136, 137, 136, 136, 138, 137, 135, 135, 136, 136, 137, 136, 135, 136, 137, 135, 136, 135, 138, 137, 136, 136, 136, 136, 136, 136, 137, 138, 135, 137, 136, 137, 135, 136, 136, 137, 136, 137, 135, 137, 137, 136, 136, 136, 135, 138, 137, 136, 137, 137, 138, 137, 135, 137, 137, 137, 137, 135, 137, 136, 138, 136, 137, 137, 135, 136, 137, 136, 137, 137, 136], "policy_agent_0_reward": [59042.1867980957, 59238.706954956055, 60788.693450927734, 58674.373516082764, 58711.8069152832, 57058.14706802368, 55913.48669433594, 58817.48020553589, 57508.97360229492, 59018.56684231758, 56503.253257751465, 57206.83353805542, 55480.66023826599, 60072.7737121582, 56826.93359422684, 57285.34671783447, 59921.880197525024, 60164.6203918457, 58990.94013977051, 58760.96686553955, 60483.880432128906, 60453.98678588867, 53520.26024436951, 60582.193420410156, 55760.96010494232, 58186.227127075195, 58734.287033081055, 56653.47378921509, 54663.42686533928, 56493.00024795532, 60563.28704071045, 60222.01998901367, 61818.38021850586, 54575.680278778076, 58141.38687133789, 56604.28040981293, 59528.586990356445, 55795.16011810303, 54125.746643066406, 59207.03999328613, 61614.786682128906, 58228.62688446045, 56524.733406066895, 57785.24701690674, 60063.059997558594, 56906.127002716064, 57099.326652526855, 61072.29345703125, 58178.72003173828, 53904.660161972046, 54642.97331285477, 56688.48675823212, 57951.17367553711, 60158.52028656006, 56385.253695487976, 54030.226989746094, 55520.04034900665, 56206.80702972412, 54232.9334564209, 58310.66680908203, 56580.933576881886, 59325.780223846436, 58782.84680175781, 52710.72681045532, 56549.54699707031, 57989.37345504761, 57005.860074043274, 58311.533824920654, 56918.380321502686, 59309.38681411743, 62400.18719482422, 52214.886779785156, 56897.32670211792, 57842.46023821831, 60616.6936340332, 55096.85998535156, 59225.106872558594, 55550.26022481918, 58412.72686767578, 56346.3935174942, 57958.426736831665, 55031.52685165405, 59759.667167663574, 59697.70684051514, 57407.33359146118, 59265.8936920166, 58119.753509521484, 52312.36674118042, 60488.026947021484, 58275.593421936035, 58756.72009277344, 59716.36693096161, 60086.5133972168, 61745.01348876953, 57482.77383995056, 54565.6669921875, 60656.08712768555, 60303.053802490234, 59827.82676696777, 61073.96692276001, 57819.806732177734, 59247.96705055237, 58274.20671463013, 61468.69357299805, 57501.353342175484, 56913.09359741211, 58931.613540649414, 55427.073738098145, 57353.7737197876, 60369.440200805664, 56162.51368904114, 60803.06709289551, 61671.333587646484, 58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.474287069641857, "mean_inference_ms": 6.710393648499842, "mean_action_processing_ms": 0.19796705063981496, "mean_env_wait_ms": 228.5030477887572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04147751289501525, "StateBufferConnector_ms": 0.0058337261802271796, "ViewRequirementAgentConnector_ms": 0.19775608129668654}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.92116692416292, "num_env_steps_trained_throughput_per_sec": 235.92116692416292, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 14655.509, "sample_time_ms": 11603.171, "learn_time_ms": 2896.814, "learn_throughput": 1380.828, "synch_weights_time_ms": 154.832}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 4496, "training_iteration": 153, "trial_id": "32397_00000", "date": "2025-03-21_09-14-04", "timestamp": 1742548444, "time_this_iter_s": 17.024433612823486, "time_total_s": 2212.428398132324, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2212.428398132324, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 95.56086956521737, "ram_util_percent": 13.491304347826087}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98924732208252, "policy_loss": -0.010827039368450642, "vf_loss": 10.0, "vf_explained_var": -2.0737449091257076e-08, "kl": 0.011881415732204914, "entropy": 0.28338560461997986, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": 58342.58674621582, "episode_reward_min": 58342.58674621582, "episode_reward_mean": 58342.58674621582, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58342.58674621582}, "policy_reward_max": {"agent_0": 58342.58674621582}, "policy_reward_mean": {"agent_0": 58342.58674621582}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58342.58674621582], "episode_lengths": [136], "policy_agent_0_reward": [58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.42996412319676, "mean_inference_ms": 6.726466126896689, "mean_action_processing_ms": 0.19314071463642737, "mean_env_wait_ms": 228.65336696444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03654956817626953, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.16243457794189453}}, "episode_reward_max": 58342.58674621582, "episode_reward_min": 58342.58674621582, "episode_reward_mean": 58342.58674621582, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58342.58674621582}, "policy_reward_max": {"agent_0": 58342.58674621582}, "policy_reward_mean": {"agent_0": 58342.58674621582}, "hist_stats": {"episode_reward": [58342.58674621582], "episode_lengths": [136], "policy_agent_0_reward": [58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.42996412319676, "mean_inference_ms": 6.726466126896689, "mean_action_processing_ms": 0.19314071463642737, "mean_env_wait_ms": 228.65336696444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03654956817626953, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.16243457794189453}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.31797545174356, "num_env_steps_trained_throughput_per_sec": 297.31797545174356, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 14538.308, "sample_time_ms": 11440.148, "learn_time_ms": 2936.424, "learn_throughput": 1362.201, "synch_weights_time_ms": 161.049}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 4496, "training_iteration": 154, "trial_id": "32397_00000", "date": "2025-03-21_09-14-17", "timestamp": 1742548457, "time_this_iter_s": 13.498734951019287, "time_total_s": 2225.9271330833435, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb491a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2225.9271330833435, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 99.51578947368422, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986360549926758, "policy_loss": -0.01371588371694088, "vf_loss": 10.0, "vf_explained_var": 4.315127810627928e-08, "kl": 0.012177604250609875, "entropy": 0.28021439909935, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": 58342.58674621582, "episode_reward_min": 58342.58674621582, "episode_reward_mean": 58342.58674621582, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58342.58674621582}, "policy_reward_max": {"agent_0": 58342.58674621582}, "policy_reward_mean": {"agent_0": 58342.58674621582}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58342.58674621582], "episode_lengths": [136], "policy_agent_0_reward": [58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.42996412319676, "mean_inference_ms": 6.726466126896689, "mean_action_processing_ms": 0.19314071463642737, "mean_env_wait_ms": 228.65336696444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03654956817626953, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.16243457794189453}}, "episode_reward_max": 58342.58674621582, "episode_reward_min": 58342.58674621582, "episode_reward_mean": 58342.58674621582, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58342.58674621582}, "policy_reward_max": {"agent_0": 58342.58674621582}, "policy_reward_mean": {"agent_0": 58342.58674621582}, "hist_stats": {"episode_reward": [58342.58674621582], "episode_lengths": [136], "policy_agent_0_reward": [58342.58674621582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.42996412319676, "mean_inference_ms": 6.726466126896689, "mean_action_processing_ms": 0.19314071463642737, "mean_env_wait_ms": 228.65336696444808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03654956817626953, "StateBufferConnector_ms": 0.0053882598876953125, "ViewRequirementAgentConnector_ms": 0.16243457794189453}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.84133358228735, "num_env_steps_trained_throughput_per_sec": 296.84133358228735, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 14062.549, "sample_time_ms": 10968.964, "learn_time_ms": 2939.237, "learn_throughput": 1360.897, "synch_weights_time_ms": 153.658}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 4496, "training_iteration": 155, "trial_id": "32397_00000", "date": "2025-03-21_09-14-31", "timestamp": 1742548471, "time_this_iter_s": 13.526231050491333, "time_total_s": 2239.453364133835, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49fac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2239.453364133835, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 99.54736842105264, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.980509757995605, "policy_loss": -0.012245338410139084, "vf_loss": 9.99267578125, "vf_explained_var": 2.6760002214132328e-08, "kl": 0.012527968734502792, "entropy": 0.30601513385772705, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 56516.76025772095, "episode_reward_min": 54979.13991546631, "episode_reward_mean": 55734.00456047058, "episode_len_mean": 136.33333333333334, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 54979.13991546631}, "policy_reward_max": {"agent_0": 56516.76025772095}, "policy_reward_mean": {"agent_0": 55734.00456047058}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55706.11350822449, 56516.76025772095, 54979.13991546631], "episode_lengths": [136, 137, 136], "policy_agent_0_reward": [55706.11350822449, 56516.76025772095, 54979.13991546631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.838668642471916, "mean_inference_ms": 6.599445701718153, "mean_action_processing_ms": 0.1985213668120905, "mean_env_wait_ms": 219.71457285611555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04284381866455078, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.4583438237508138}}, "episode_reward_max": 56516.76025772095, "episode_reward_min": 54979.13991546631, "episode_reward_mean": 55734.00456047058, "episode_len_mean": 136.33333333333334, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 54979.13991546631}, "policy_reward_max": {"agent_0": 56516.76025772095}, "policy_reward_mean": {"agent_0": 55734.00456047058}, "hist_stats": {"episode_reward": [55706.11350822449, 56516.76025772095, 54979.13991546631], "episode_lengths": [136, 137, 136], "policy_agent_0_reward": [55706.11350822449, 56516.76025772095, 54979.13991546631]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.838668642471916, "mean_inference_ms": 6.599445701718153, "mean_action_processing_ms": 0.1985213668120905, "mean_env_wait_ms": 219.71457285611555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04284381866455078, "StateBufferConnector_ms": 0.006198883056640625, "ViewRequirementAgentConnector_ms": 0.4583438237508138}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.0762104543333, "num_env_steps_trained_throughput_per_sec": 310.0762104543333, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 14015.321, "sample_time_ms": 10955.015, "learn_time_ms": 2906.028, "learn_throughput": 1376.449, "synch_weights_time_ms": 153.579}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 4499, "training_iteration": 156, "trial_id": "32397_00000", "date": "2025-03-21_09-14-44", "timestamp": 1742548484, "time_this_iter_s": 12.95346188545227, "time_total_s": 2252.406826019287, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49fb50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2252.406826019287, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 99.26315789473684, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.047169811320755, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.723885536193848, "policy_loss": -0.01179131492972374, "vf_loss": 9.735595703125, "vf_explained_var": -7.7237686468834e-08, "kl": 0.012987745925784111, "entropy": 0.314256489276886, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": 62732.03387451172, "episode_reward_min": 51220.066948890686, "episode_reward_mean": 57536.38591030887, "episode_len_mean": 136.4245283018868, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {"agent_0": 51220.066948890686}, "policy_reward_max": {"agent_0": 62732.03387451172}, "policy_reward_mean": {"agent_0": 57536.38591030887}, "custom_metrics": {"num_batches_mean": 5.047169811320755, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [62732.03387451172, 60732.07308959961, 59921.72038269043, 59970.44033050537, 60268.873626708984, 57571.08675003052, 60202.33364868164, 53919.66015815735, 56023.32019710541, 61076.49383544922, 61283.513580322266, 58006.48661804199, 58481.24000930786, 54063.32665729523, 58760.853701114655, 58547.44017982483, 58378.37349510193, 57247.75363922119, 57953.246715545654, 55939.08685684204, 55910.93385505676, 55294.01347541809, 57102.78014564514, 59169.09342956543, 59279.16014099121, 57655.426891326904, 54324.340312957764, 58955.386810302734, 57374.6936416626, 55646.173416137695, 55391.44708442688, 60982.72036743164, 54067.120173454285, 57083.05340576172, 59493.38677215576, 58536.926933288574, 58382.04684448242, 53939.24703979492, 58305.12030792236, 52723.22675704956, 59155.65351867676, 51220.066948890686, 57588.68029689789, 56198.42032814026, 56990.97364807129, 57653.08673667908, 53286.56037449837, 59171.613677978516, 60671.12015724182, 59100.640197753906, 57676.10038757324, 60525.12032318115, 60514.04014587402, 60278.13346862793, 52558.06702899933, 56618.74684715271, 60541.140281677246, 51905.30702495575, 53243.10014820099, 59991.00670623779, 57928.74687957764, 60707.633239746094, 58331.07334899902, 60719.020263671875, 54293.1067905426, 56456.680419921875, 57548.466847896576, 58004.09342956543, 56907.36673736572, 59141.96682739258, 56944.160175323486, 60818.34008026123, 60376.21356201172, 56579.39327430725, 57495.33348083496, 53497.106620788574, 58520.093673706055, 55121.20691585541, 61426.727142333984, 59960.06661987305, 61041.77322387695, 55839.13340950012, 57226.92014503479, 56102.80672836304, 55437.98662498593, 55014.70679759979, 58314.2067489624, 60091.01348876953, 58117.0068359375, 60761.033630371094, 57162.20690155029, 58952.66000366211, 55045.320096969604, 54881.16691207886, 53814.38675403595, 58379.66672897339, 57308.766817092896, 59689.17999267578, 57076.8265953064, 53441.507120132446, 56530.12706947327, 57383.41342163086, 56342.320220947266, 57203.446853637695, 57469.04676437378, 53870.24687862396], "episode_lengths": [138, 137, 137, 137, 137, 136, 137, 135, 137, 137, 138, 136, 137, 136, 137, 137, 137, 136, 137, 136, 136, 136, 136, 136, 137, 137, 136, 138, 137, 136, 136, 137, 135, 136, 137, 137, 137, 136, 136, 135, 137, 135, 136, 136, 136, 137, 135, 137, 138, 136, 136, 137, 137, 137, 136, 136, 137, 136, 135, 137, 137, 137, 138, 137, 136, 136, 137, 136, 137, 137, 136, 137, 137, 136, 136, 135, 136, 136, 138, 137, 137, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 137, 136, 134, 135, 136, 136, 137, 135, 136, 135, 136, 136, 137, 136, 135], "policy_agent_0_reward": [62732.03387451172, 60732.07308959961, 59921.72038269043, 59970.44033050537, 60268.873626708984, 57571.08675003052, 60202.33364868164, 53919.66015815735, 56023.32019710541, 61076.49383544922, 61283.513580322266, 58006.48661804199, 58481.24000930786, 54063.32665729523, 58760.853701114655, 58547.44017982483, 58378.37349510193, 57247.75363922119, 57953.246715545654, 55939.08685684204, 55910.93385505676, 55294.01347541809, 57102.78014564514, 59169.09342956543, 59279.16014099121, 57655.426891326904, 54324.340312957764, 58955.386810302734, 57374.6936416626, 55646.173416137695, 55391.44708442688, 60982.72036743164, 54067.120173454285, 57083.05340576172, 59493.38677215576, 58536.926933288574, 58382.04684448242, 53939.24703979492, 58305.12030792236, 52723.22675704956, 59155.65351867676, 51220.066948890686, 57588.68029689789, 56198.42032814026, 56990.97364807129, 57653.08673667908, 53286.56037449837, 59171.613677978516, 60671.12015724182, 59100.640197753906, 57676.10038757324, 60525.12032318115, 60514.04014587402, 60278.13346862793, 52558.06702899933, 56618.74684715271, 60541.140281677246, 51905.30702495575, 53243.10014820099, 59991.00670623779, 57928.74687957764, 60707.633239746094, 58331.07334899902, 60719.020263671875, 54293.1067905426, 56456.680419921875, 57548.466847896576, 58004.09342956543, 56907.36673736572, 59141.96682739258, 56944.160175323486, 60818.34008026123, 60376.21356201172, 56579.39327430725, 57495.33348083496, 53497.106620788574, 58520.093673706055, 55121.20691585541, 61426.727142333984, 59960.06661987305, 61041.77322387695, 55839.13340950012, 57226.92014503479, 56102.80672836304, 55437.98662498593, 55014.70679759979, 58314.2067489624, 60091.01348876953, 58117.0068359375, 60761.033630371094, 57162.20690155029, 58952.66000366211, 55045.320096969604, 54881.16691207886, 53814.38675403595, 58379.66672897339, 57308.766817092896, 59689.17999267578, 57076.8265953064, 53441.507120132446, 56530.12706947327, 57383.41342163086, 56342.320220947266, 57203.446853637695, 57469.04676437378, 53870.24687862396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.515855441456367, "mean_inference_ms": 6.672553837297984, "mean_action_processing_ms": 0.1981766487954149, "mean_env_wait_ms": 227.65782762712576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040904306015878356, "StateBufferConnector_ms": 0.005822811486586085, "ViewRequirementAgentConnector_ms": 0.23096484958000904}}, "episode_reward_max": 62732.03387451172, "episode_reward_min": 51220.066948890686, "episode_reward_mean": 57536.38591030887, "episode_len_mean": 136.4245283018868, "episodes_this_iter": 106, "policy_reward_min": {"agent_0": 51220.066948890686}, "policy_reward_max": {"agent_0": 62732.03387451172}, "policy_reward_mean": {"agent_0": 57536.38591030887}, "hist_stats": {"episode_reward": [62732.03387451172, 60732.07308959961, 59921.72038269043, 59970.44033050537, 60268.873626708984, 57571.08675003052, 60202.33364868164, 53919.66015815735, 56023.32019710541, 61076.49383544922, 61283.513580322266, 58006.48661804199, 58481.24000930786, 54063.32665729523, 58760.853701114655, 58547.44017982483, 58378.37349510193, 57247.75363922119, 57953.246715545654, 55939.08685684204, 55910.93385505676, 55294.01347541809, 57102.78014564514, 59169.09342956543, 59279.16014099121, 57655.426891326904, 54324.340312957764, 58955.386810302734, 57374.6936416626, 55646.173416137695, 55391.44708442688, 60982.72036743164, 54067.120173454285, 57083.05340576172, 59493.38677215576, 58536.926933288574, 58382.04684448242, 53939.24703979492, 58305.12030792236, 52723.22675704956, 59155.65351867676, 51220.066948890686, 57588.68029689789, 56198.42032814026, 56990.97364807129, 57653.08673667908, 53286.56037449837, 59171.613677978516, 60671.12015724182, 59100.640197753906, 57676.10038757324, 60525.12032318115, 60514.04014587402, 60278.13346862793, 52558.06702899933, 56618.74684715271, 60541.140281677246, 51905.30702495575, 53243.10014820099, 59991.00670623779, 57928.74687957764, 60707.633239746094, 58331.07334899902, 60719.020263671875, 54293.1067905426, 56456.680419921875, 57548.466847896576, 58004.09342956543, 56907.36673736572, 59141.96682739258, 56944.160175323486, 60818.34008026123, 60376.21356201172, 56579.39327430725, 57495.33348083496, 53497.106620788574, 58520.093673706055, 55121.20691585541, 61426.727142333984, 59960.06661987305, 61041.77322387695, 55839.13340950012, 57226.92014503479, 56102.80672836304, 55437.98662498593, 55014.70679759979, 58314.2067489624, 60091.01348876953, 58117.0068359375, 60761.033630371094, 57162.20690155029, 58952.66000366211, 55045.320096969604, 54881.16691207886, 53814.38675403595, 58379.66672897339, 57308.766817092896, 59689.17999267578, 57076.8265953064, 53441.507120132446, 56530.12706947327, 57383.41342163086, 56342.320220947266, 57203.446853637695, 57469.04676437378, 53870.24687862396], "episode_lengths": [138, 137, 137, 137, 137, 136, 137, 135, 137, 137, 138, 136, 137, 136, 137, 137, 137, 136, 137, 136, 136, 136, 136, 136, 137, 137, 136, 138, 137, 136, 136, 137, 135, 136, 137, 137, 137, 136, 136, 135, 137, 135, 136, 136, 136, 137, 135, 137, 138, 136, 136, 137, 137, 137, 136, 136, 137, 136, 135, 137, 137, 137, 138, 137, 136, 136, 137, 136, 137, 137, 136, 137, 137, 136, 136, 135, 136, 136, 138, 137, 137, 136, 137, 136, 136, 136, 137, 137, 137, 137, 137, 137, 136, 134, 135, 136, 136, 137, 135, 136, 135, 136, 136, 137, 136, 135], "policy_agent_0_reward": [62732.03387451172, 60732.07308959961, 59921.72038269043, 59970.44033050537, 60268.873626708984, 57571.08675003052, 60202.33364868164, 53919.66015815735, 56023.32019710541, 61076.49383544922, 61283.513580322266, 58006.48661804199, 58481.24000930786, 54063.32665729523, 58760.853701114655, 58547.44017982483, 58378.37349510193, 57247.75363922119, 57953.246715545654, 55939.08685684204, 55910.93385505676, 55294.01347541809, 57102.78014564514, 59169.09342956543, 59279.16014099121, 57655.426891326904, 54324.340312957764, 58955.386810302734, 57374.6936416626, 55646.173416137695, 55391.44708442688, 60982.72036743164, 54067.120173454285, 57083.05340576172, 59493.38677215576, 58536.926933288574, 58382.04684448242, 53939.24703979492, 58305.12030792236, 52723.22675704956, 59155.65351867676, 51220.066948890686, 57588.68029689789, 56198.42032814026, 56990.97364807129, 57653.08673667908, 53286.56037449837, 59171.613677978516, 60671.12015724182, 59100.640197753906, 57676.10038757324, 60525.12032318115, 60514.04014587402, 60278.13346862793, 52558.06702899933, 56618.74684715271, 60541.140281677246, 51905.30702495575, 53243.10014820099, 59991.00670623779, 57928.74687957764, 60707.633239746094, 58331.07334899902, 60719.020263671875, 54293.1067905426, 56456.680419921875, 57548.466847896576, 58004.09342956543, 56907.36673736572, 59141.96682739258, 56944.160175323486, 60818.34008026123, 60376.21356201172, 56579.39327430725, 57495.33348083496, 53497.106620788574, 58520.093673706055, 55121.20691585541, 61426.727142333984, 59960.06661987305, 61041.77322387695, 55839.13340950012, 57226.92014503479, 56102.80672836304, 55437.98662498593, 55014.70679759979, 58314.2067489624, 60091.01348876953, 58117.0068359375, 60761.033630371094, 57162.20690155029, 58952.66000366211, 55045.320096969604, 54881.16691207886, 53814.38675403595, 58379.66672897339, 57308.766817092896, 59689.17999267578, 57076.8265953064, 53441.507120132446, 56530.12706947327, 57383.41342163086, 56342.320220947266, 57203.446853637695, 57469.04676437378, 53870.24687862396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.515855441456367, "mean_inference_ms": 6.672553837297984, "mean_action_processing_ms": 0.1981766487954149, "mean_env_wait_ms": 227.65782762712576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040904306015878356, "StateBufferConnector_ms": 0.005822811486586085, "ViewRequirementAgentConnector_ms": 0.23096484958000904}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.09769377656772, "num_env_steps_trained_throughput_per_sec": 230.09769377656772, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 14372.208, "sample_time_ms": 11411.889, "learn_time_ms": 2814.579, "learn_throughput": 1421.172, "synch_weights_time_ms": 145.048}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 4605, "training_iteration": 157, "trial_id": "32397_00000", "date": "2025-03-21_09-15-01", "timestamp": 1742548501, "time_this_iter_s": 17.432698726654053, "time_total_s": 2269.839524745941, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49e3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2269.839524745941, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 95.4857142857143, "ram_util_percent": 13.495238095238093}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.95068359375, "policy_loss": -0.011290599592030048, "vf_loss": 9.9619140625, "vf_explained_var": 1.0604659905766312e-07, "kl": 0.009434191510081291, "entropy": 0.29657065868377686, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": 61214.460357666016, "episode_reward_min": 50719.800201416016, "episode_reward_mean": 57917.305613454184, "episode_len_mean": 136.53333333333333, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {"agent_0": 50719.800201416016}, "policy_reward_max": {"agent_0": 61214.460357666016}, "policy_reward_mean": {"agent_0": 57917.305613454184}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59801.653717041016, 58227.620361328125, 60389.327056884766, 56455.27367782593, 61214.460357666016, 57099.333448410034, 56481.62710618973, 58943.29357910156, 50719.800201416016, 56832.00032424927, 59345.4137802124, 58900.72697877884, 58776.360429763794, 55172.57324886322, 60400.11993408203], "episode_lengths": [137, 137, 137, 137, 138, 136, 136, 136, 135, 136, 136, 137, 137, 136, 137], "policy_agent_0_reward": [59801.653717041016, 58227.620361328125, 60389.327056884766, 56455.27367782593, 61214.460357666016, 57099.333448410034, 56481.62710618973, 58943.29357910156, 50719.800201416016, 56832.00032424927, 59345.4137802124, 58900.72697877884, 58776.360429763794, 55172.57324886322, 60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449997790714214, "mean_inference_ms": 6.8391150251452295, "mean_action_processing_ms": 0.19648150380603344, "mean_env_wait_ms": 228.78980397408046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0356896718343099, "StateBufferConnector_ms": 0.005671183268229167, "ViewRequirementAgentConnector_ms": 0.1564296086629232}}, "episode_reward_max": 61214.460357666016, "episode_reward_min": 50719.800201416016, "episode_reward_mean": 57917.305613454184, "episode_len_mean": 136.53333333333333, "episodes_this_iter": 15, "policy_reward_min": {"agent_0": 50719.800201416016}, "policy_reward_max": {"agent_0": 61214.460357666016}, "policy_reward_mean": {"agent_0": 57917.305613454184}, "hist_stats": {"episode_reward": [59801.653717041016, 58227.620361328125, 60389.327056884766, 56455.27367782593, 61214.460357666016, 57099.333448410034, 56481.62710618973, 58943.29357910156, 50719.800201416016, 56832.00032424927, 59345.4137802124, 58900.72697877884, 58776.360429763794, 55172.57324886322, 60400.11993408203], "episode_lengths": [137, 137, 137, 137, 138, 136, 136, 136, 135, 136, 136, 137, 137, 136, 137], "policy_agent_0_reward": [59801.653717041016, 58227.620361328125, 60389.327056884766, 56455.27367782593, 61214.460357666016, 57099.333448410034, 56481.62710618973, 58943.29357910156, 50719.800201416016, 56832.00032424927, 59345.4137802124, 58900.72697877884, 58776.360429763794, 55172.57324886322, 60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449997790714214, "mean_inference_ms": 6.8391150251452295, "mean_action_processing_ms": 0.19648150380603344, "mean_env_wait_ms": 228.78980397408046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0356896718343099, "StateBufferConnector_ms": 0.005671183268229167, "ViewRequirementAgentConnector_ms": 0.1564296086629232}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6339160004854, "num_env_steps_trained_throughput_per_sec": 300.6339160004854, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 14423.022, "sample_time_ms": 11430.247, "learn_time_ms": 2851.076, "learn_throughput": 1402.979, "synch_weights_time_ms": 140.996}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 4620, "training_iteration": 158, "trial_id": "32397_00000", "date": "2025-03-21_09-15-15", "timestamp": 1742548515, "time_this_iter_s": 13.355313777923584, "time_total_s": 2283.1948385238647, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2283.1948385238647, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 99.23157894736842, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984124183654785, "policy_loss": -0.015954289585351944, "vf_loss": 10.0, "vf_explained_var": 5.227824217968191e-08, "kl": 0.012481785379350185, "entropy": 0.33486658334732056, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 60400.11993408203, "episode_reward_min": 60400.11993408203, "episode_reward_mean": 60400.11993408203, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60400.11993408203}, "policy_reward_max": {"agent_0": 60400.11993408203}, "policy_reward_mean": {"agent_0": 60400.11993408203}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60400.11993408203], "episode_lengths": [137], "policy_agent_0_reward": [60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.97542953679796, "mean_inference_ms": 6.58569402885173, "mean_action_processing_ms": 0.1905344917247577, "mean_env_wait_ms": 227.66108477047268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035834312438964844, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15113353729248047}}, "episode_reward_max": 60400.11993408203, "episode_reward_min": 60400.11993408203, "episode_reward_mean": 60400.11993408203, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60400.11993408203}, "policy_reward_max": {"agent_0": 60400.11993408203}, "policy_reward_mean": {"agent_0": 60400.11993408203}, "hist_stats": {"episode_reward": [60400.11993408203], "episode_lengths": [137], "policy_agent_0_reward": [60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.97542953679796, "mean_inference_ms": 6.58569402885173, "mean_action_processing_ms": 0.1905344917247577, "mean_env_wait_ms": 227.66108477047268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035834312438964844, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15113353729248047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.403774662601, "num_env_steps_trained_throughput_per_sec": 310.403774662601, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 13904.112, "sample_time_ms": 10896.754, "learn_time_ms": 2862.093, "learn_throughput": 1397.579, "synch_weights_time_ms": 144.561}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 4620, "training_iteration": 159, "trial_id": "32397_00000", "date": "2025-03-21_09-15-28", "timestamp": 1742548528, "time_this_iter_s": 12.940146446228027, "time_total_s": 2296.134984970093, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2296.134984970093, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 99.63684210526317, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985398292541504, "policy_loss": -0.01222175918519497, "vf_loss": 9.99755859375, "vf_explained_var": 7.580965899478542e-08, "kl": 0.009862731210887432, "entropy": 0.32837238907814026, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": 60400.11993408203, "episode_reward_min": 60400.11993408203, "episode_reward_mean": 60400.11993408203, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60400.11993408203}, "policy_reward_max": {"agent_0": 60400.11993408203}, "policy_reward_mean": {"agent_0": 60400.11993408203}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60400.11993408203], "episode_lengths": [137], "policy_agent_0_reward": [60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.97542953679796, "mean_inference_ms": 6.58569402885173, "mean_action_processing_ms": 0.1905344917247577, "mean_env_wait_ms": 227.66108477047268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035834312438964844, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15113353729248047}}, "episode_reward_max": 60400.11993408203, "episode_reward_min": 60400.11993408203, "episode_reward_mean": 60400.11993408203, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60400.11993408203}, "policy_reward_max": {"agent_0": 60400.11993408203}, "policy_reward_mean": {"agent_0": 60400.11993408203}, "hist_stats": {"episode_reward": [60400.11993408203], "episode_lengths": [137], "policy_agent_0_reward": [60400.11993408203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.97542953679796, "mean_inference_ms": 6.58569402885173, "mean_action_processing_ms": 0.1905344917247577, "mean_env_wait_ms": 227.66108477047268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035834312438964844, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15113353729248047}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.20156235025314, "num_env_steps_trained_throughput_per_sec": 317.20156235025314, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 13863.763, "sample_time_ms": 10876.865, "learn_time_ms": 2847.744, "learn_throughput": 1404.62, "synch_weights_time_ms": 138.444}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 4620, "training_iteration": 160, "trial_id": "32397_00000", "date": "2025-03-21_09-15-41", "timestamp": 1742548541, "time_this_iter_s": 12.663087606430054, "time_total_s": 2308.798072576523, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb491b40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2308.798072576523, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 99.36315789473684, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0344827586206895, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.844049453735352, "policy_loss": -0.01050517987459898, "vf_loss": 9.8544921875, "vf_explained_var": 1.4714896856560244e-08, "kl": 0.009762274101376534, "entropy": 0.32514727115631104, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": 61470.373443603516, "episode_reward_min": 45958.6471157074, "episode_reward_mean": 55874.2762099972, "episode_len_mean": 135.86206896551724, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {"agent_0": 45958.6471157074}, "policy_reward_max": {"agent_0": 61470.373443603516}, "policy_reward_mean": {"agent_0": 55874.2762099972}, "custom_metrics": {"num_batches_mean": 5.0344827586206895, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58971.48683166504, 59311.92691040039, 53497.11975860596, 52647.04021835327, 55244.33351135254, 56318.50008201599, 59880.44696044922, 58244.40026664734, 55060.233379364014, 57352.75366401672, 60683.773262023926, 57256.63333892822, 61470.373443603516, 54955.35349750519, 59437.27346801758, 58716.34663772583, 58805.646938323975, 57080.520195007324, 55029.726791381836, 56648.25339508057, 59292.16680431366, 55867.28680419922, 53904.32681274414, 46050.006705760956, 56179.64702296257, 52471.81348514557, 58509.180084228516, 60162.18688964844, 56126.086864471436, 58298.40006637573, 55351.52046108246, 55499.23984527588, 53925.726791381836, 57231.333587646484, 56764.220222473145, 55585.479988098145, 47933.50668096542, 58202.86691856384, 52335.81357002258, 58205.12643432617, 53587.820011138916, 53885.43344402313, 58609.56658744812, 57506.24682760239, 49767.83326148987, 59038.37335205078, 52467.05342340469, 57755.49989128113, 51733.65336084366, 59003.30010223389, 55585.16674789786, 61342.000396728516, 58740.14685058594, 51585.44657754898, 45958.6471157074, 59210.28023338318, 54126.893364429474, 46296.580041885376], "episode_lengths": [136, 136, 135, 135, 135, 135, 137, 136, 136, 136, 137, 136, 137, 135, 136, 137, 137, 135, 135, 136, 137, 136, 136, 134, 136, 134, 136, 137, 136, 136, 136, 137, 136, 137, 136, 136, 135, 137, 135, 136, 136, 136, 136, 137, 134, 136, 135, 136, 135, 137, 136, 138, 137, 134, 133, 137, 136, 134], "policy_agent_0_reward": [58971.48683166504, 59311.92691040039, 53497.11975860596, 52647.04021835327, 55244.33351135254, 56318.50008201599, 59880.44696044922, 58244.40026664734, 55060.233379364014, 57352.75366401672, 60683.773262023926, 57256.63333892822, 61470.373443603516, 54955.35349750519, 59437.27346801758, 58716.34663772583, 58805.646938323975, 57080.520195007324, 55029.726791381836, 56648.25339508057, 59292.16680431366, 55867.28680419922, 53904.32681274414, 46050.006705760956, 56179.64702296257, 52471.81348514557, 58509.180084228516, 60162.18688964844, 56126.086864471436, 58298.40006637573, 55351.52046108246, 55499.23984527588, 53925.726791381836, 57231.333587646484, 56764.220222473145, 55585.479988098145, 47933.50668096542, 58202.86691856384, 52335.81357002258, 58205.12643432617, 53587.820011138916, 53885.43344402313, 58609.56658744812, 57506.24682760239, 49767.83326148987, 59038.37335205078, 52467.05342340469, 57755.49989128113, 51733.65336084366, 59003.30010223389, 55585.16674789786, 61342.000396728516, 58740.14685058594, 51585.44657754898, 45958.6471157074, 59210.28023338318, 54126.893364429474, 46296.580041885376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.702133139978358, "mean_inference_ms": 6.553102501347583, "mean_action_processing_ms": 0.19903005638142643, "mean_env_wait_ms": 224.53733093865472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03814039559199892, "StateBufferConnector_ms": 0.005895515968059671, "ViewRequirementAgentConnector_ms": 0.2966638269095585}}, "episode_reward_max": 61470.373443603516, "episode_reward_min": 45958.6471157074, "episode_reward_mean": 55874.2762099972, "episode_len_mean": 135.86206896551724, "episodes_this_iter": 58, "policy_reward_min": {"agent_0": 45958.6471157074}, "policy_reward_max": {"agent_0": 61470.373443603516}, "policy_reward_mean": {"agent_0": 55874.2762099972}, "hist_stats": {"episode_reward": [58971.48683166504, 59311.92691040039, 53497.11975860596, 52647.04021835327, 55244.33351135254, 56318.50008201599, 59880.44696044922, 58244.40026664734, 55060.233379364014, 57352.75366401672, 60683.773262023926, 57256.63333892822, 61470.373443603516, 54955.35349750519, 59437.27346801758, 58716.34663772583, 58805.646938323975, 57080.520195007324, 55029.726791381836, 56648.25339508057, 59292.16680431366, 55867.28680419922, 53904.32681274414, 46050.006705760956, 56179.64702296257, 52471.81348514557, 58509.180084228516, 60162.18688964844, 56126.086864471436, 58298.40006637573, 55351.52046108246, 55499.23984527588, 53925.726791381836, 57231.333587646484, 56764.220222473145, 55585.479988098145, 47933.50668096542, 58202.86691856384, 52335.81357002258, 58205.12643432617, 53587.820011138916, 53885.43344402313, 58609.56658744812, 57506.24682760239, 49767.83326148987, 59038.37335205078, 52467.05342340469, 57755.49989128113, 51733.65336084366, 59003.30010223389, 55585.16674789786, 61342.000396728516, 58740.14685058594, 51585.44657754898, 45958.6471157074, 59210.28023338318, 54126.893364429474, 46296.580041885376], "episode_lengths": [136, 136, 135, 135, 135, 135, 137, 136, 136, 136, 137, 136, 137, 135, 136, 137, 137, 135, 135, 136, 137, 136, 136, 134, 136, 134, 136, 137, 136, 136, 136, 137, 136, 137, 136, 136, 135, 137, 135, 136, 136, 136, 136, 137, 134, 136, 135, 136, 135, 137, 136, 138, 137, 134, 133, 137, 136, 134], "policy_agent_0_reward": [58971.48683166504, 59311.92691040039, 53497.11975860596, 52647.04021835327, 55244.33351135254, 56318.50008201599, 59880.44696044922, 58244.40026664734, 55060.233379364014, 57352.75366401672, 60683.773262023926, 57256.63333892822, 61470.373443603516, 54955.35349750519, 59437.27346801758, 58716.34663772583, 58805.646938323975, 57080.520195007324, 55029.726791381836, 56648.25339508057, 59292.16680431366, 55867.28680419922, 53904.32681274414, 46050.006705760956, 56179.64702296257, 52471.81348514557, 58509.180084228516, 60162.18688964844, 56126.086864471436, 58298.40006637573, 55351.52046108246, 55499.23984527588, 53925.726791381836, 57231.333587646484, 56764.220222473145, 55585.479988098145, 47933.50668096542, 58202.86691856384, 52335.81357002258, 58205.12643432617, 53587.820011138916, 53885.43344402313, 58609.56658744812, 57506.24682760239, 49767.83326148987, 59038.37335205078, 52467.05342340469, 57755.49989128113, 51733.65336084366, 59003.30010223389, 55585.16674789786, 61342.000396728516, 58740.14685058594, 51585.44657754898, 45958.6471157074, 59210.28023338318, 54126.893364429474, 46296.580041885376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.702133139978358, "mean_inference_ms": 6.553102501347583, "mean_action_processing_ms": 0.19903005638142643, "mean_env_wait_ms": 224.53733093865472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03814039559199892, "StateBufferConnector_ms": 0.005895515968059671, "ViewRequirementAgentConnector_ms": 0.2966638269095585}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.48539882607642, "num_env_steps_trained_throughput_per_sec": 246.48539882607642, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 14231.123, "sample_time_ms": 11320.088, "learn_time_ms": 2771.545, "learn_throughput": 1443.238, "synch_weights_time_ms": 138.806}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 4678, "training_iteration": 161, "trial_id": "32397_00000", "date": "2025-03-21_09-15-58", "timestamp": 1742548558, "time_this_iter_s": 16.27543330192566, "time_total_s": 2325.0735058784485, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49fb50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2325.0735058784485, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 98.30000000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.666666666666667, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.823674201965332, "policy_loss": -0.011345461942255497, "vf_loss": 9.8349609375, "vf_explained_var": 1.2349337907835434e-07, "kl": 0.009357522241771221, "entropy": 0.31646066904067993, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 62421.66696166992, "episode_reward_min": 47091.14031612873, "episode_reward_mean": 57160.19011959253, "episode_len_mean": 136.36363636363637, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {"agent_0": 47091.14031612873}, "policy_reward_max": {"agent_0": 62421.66696166992}, "policy_reward_mean": {"agent_0": 57160.19011959253}, "custom_metrics": {"num_batches_mean": 5.666666666666667, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57253.45334815979, 53931.09997725487, 58313.19365501404, 57547.966804504395, 48947.20027542114, 53939.813306331635, 59917.673431396484, 53024.75998687744, 59802.860149383545, 54110.05340409279, 59484.84698486328, 47091.14031612873, 57800.666957855225, 59444.886810302734, 60255.24035644531, 59447.2269077301, 55553.64021587372, 50608.24030208588, 62421.66696166992, 55589.993616104126, 59070.566986083984, 59782.313720703125, 61644.07357788086, 58903.186809539795, 61740.8337097168, 57864.140060424805, 59643.72046661377, 56952.466789245605, 58783.02688598633, 56248.807067871094, 52193.10008662939, 55109.26010990143, 53390.89362716675, 58235.953483104706, 54721.546880722046, 58629.39328765869, 61176.773529052734, 58377.74044036865, 56482.873458862305, 61841.767124176025, 53742.0870885849, 57242.0267829895, 55639.18690490723, 54810.80676460266, 52056.58693695068, 58278.026783943176, 58845.120388031006, 60323.02703857422, 55864.88719177246, 52755.51347160339, 58489.65361022949, 60212.76672363281, 58970.48677825928, 57602.1803817749, 57044.107078552246, 58648.34014129639, 56146.946880340576, 57803.97333526611, 59249.98668670654, 56545.76705169678, 57158.44672012329, 55829.73352813721, 62376.59338378906, 55841.293442726135, 59167.1139831543, 56649.826946258545], "episode_lengths": [136, 135, 136, 137, 136, 135, 137, 136, 137, 136, 137, 134, 136, 137, 137, 137, 136, 135, 138, 137, 137, 137, 138, 137, 138, 136, 137, 136, 137, 136, 135, 136, 135, 137, 136, 137, 137, 137, 136, 138, 135, 135, 136, 136, 136, 137, 136, 137, 136, 135, 137, 137, 136, 136, 136, 136, 136, 136, 137, 136, 137, 136, 138, 136, 137, 136], "policy_agent_0_reward": [57253.45334815979, 53931.09997725487, 58313.19365501404, 57547.966804504395, 48947.20027542114, 53939.813306331635, 59917.673431396484, 53024.75998687744, 59802.860149383545, 54110.05340409279, 59484.84698486328, 47091.14031612873, 57800.666957855225, 59444.886810302734, 60255.24035644531, 59447.2269077301, 55553.64021587372, 50608.24030208588, 62421.66696166992, 55589.993616104126, 59070.566986083984, 59782.313720703125, 61644.07357788086, 58903.186809539795, 61740.8337097168, 57864.140060424805, 59643.72046661377, 56952.466789245605, 58783.02688598633, 56248.807067871094, 52193.10008662939, 55109.26010990143, 53390.89362716675, 58235.953483104706, 54721.546880722046, 58629.39328765869, 61176.773529052734, 58377.74044036865, 56482.873458862305, 61841.767124176025, 53742.0870885849, 57242.0267829895, 55639.18690490723, 54810.80676460266, 52056.58693695068, 58278.026783943176, 58845.120388031006, 60323.02703857422, 55864.88719177246, 52755.51347160339, 58489.65361022949, 60212.76672363281, 58970.48677825928, 57602.1803817749, 57044.107078552246, 58648.34014129639, 56146.946880340576, 57803.97333526611, 59249.98668670654, 56545.76705169678, 57158.44672012329, 55829.73352813721, 62376.59338378906, 55841.293442726135, 59167.1139831543, 56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.901048258058, "mean_inference_ms": 6.798169235341412, "mean_action_processing_ms": 0.19723507088679335, "mean_env_wait_ms": 230.70831629761838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04786722587816643, "StateBufferConnector_ms": 0.006146141977021189, "ViewRequirementAgentConnector_ms": 0.17745422594475024}}, "episode_reward_max": 62421.66696166992, "episode_reward_min": 47091.14031612873, "episode_reward_mean": 57160.19011959253, "episode_len_mean": 136.36363636363637, "episodes_this_iter": 66, "policy_reward_min": {"agent_0": 47091.14031612873}, "policy_reward_max": {"agent_0": 62421.66696166992}, "policy_reward_mean": {"agent_0": 57160.19011959253}, "hist_stats": {"episode_reward": [57253.45334815979, 53931.09997725487, 58313.19365501404, 57547.966804504395, 48947.20027542114, 53939.813306331635, 59917.673431396484, 53024.75998687744, 59802.860149383545, 54110.05340409279, 59484.84698486328, 47091.14031612873, 57800.666957855225, 59444.886810302734, 60255.24035644531, 59447.2269077301, 55553.64021587372, 50608.24030208588, 62421.66696166992, 55589.993616104126, 59070.566986083984, 59782.313720703125, 61644.07357788086, 58903.186809539795, 61740.8337097168, 57864.140060424805, 59643.72046661377, 56952.466789245605, 58783.02688598633, 56248.807067871094, 52193.10008662939, 55109.26010990143, 53390.89362716675, 58235.953483104706, 54721.546880722046, 58629.39328765869, 61176.773529052734, 58377.74044036865, 56482.873458862305, 61841.767124176025, 53742.0870885849, 57242.0267829895, 55639.18690490723, 54810.80676460266, 52056.58693695068, 58278.026783943176, 58845.120388031006, 60323.02703857422, 55864.88719177246, 52755.51347160339, 58489.65361022949, 60212.76672363281, 58970.48677825928, 57602.1803817749, 57044.107078552246, 58648.34014129639, 56146.946880340576, 57803.97333526611, 59249.98668670654, 56545.76705169678, 57158.44672012329, 55829.73352813721, 62376.59338378906, 55841.293442726135, 59167.1139831543, 56649.826946258545], "episode_lengths": [136, 135, 136, 137, 136, 135, 137, 136, 137, 136, 137, 134, 136, 137, 137, 137, 136, 135, 138, 137, 137, 137, 138, 137, 138, 136, 137, 136, 137, 136, 135, 136, 135, 137, 136, 137, 137, 137, 136, 138, 135, 135, 136, 136, 136, 137, 136, 137, 136, 135, 137, 137, 136, 136, 136, 136, 136, 136, 137, 136, 137, 136, 138, 136, 137, 136], "policy_agent_0_reward": [57253.45334815979, 53931.09997725487, 58313.19365501404, 57547.966804504395, 48947.20027542114, 53939.813306331635, 59917.673431396484, 53024.75998687744, 59802.860149383545, 54110.05340409279, 59484.84698486328, 47091.14031612873, 57800.666957855225, 59444.886810302734, 60255.24035644531, 59447.2269077301, 55553.64021587372, 50608.24030208588, 62421.66696166992, 55589.993616104126, 59070.566986083984, 59782.313720703125, 61644.07357788086, 58903.186809539795, 61740.8337097168, 57864.140060424805, 59643.72046661377, 56952.466789245605, 58783.02688598633, 56248.807067871094, 52193.10008662939, 55109.26010990143, 53390.89362716675, 58235.953483104706, 54721.546880722046, 58629.39328765869, 61176.773529052734, 58377.74044036865, 56482.873458862305, 61841.767124176025, 53742.0870885849, 57242.0267829895, 55639.18690490723, 54810.80676460266, 52056.58693695068, 58278.026783943176, 58845.120388031006, 60323.02703857422, 55864.88719177246, 52755.51347160339, 58489.65361022949, 60212.76672363281, 58970.48677825928, 57602.1803817749, 57044.107078552246, 58648.34014129639, 56146.946880340576, 57803.97333526611, 59249.98668670654, 56545.76705169678, 57158.44672012329, 55829.73352813721, 62376.59338378906, 55841.293442726135, 59167.1139831543, 56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.901048258058, "mean_inference_ms": 6.798169235341412, "mean_action_processing_ms": 0.19723507088679335, "mean_env_wait_ms": 230.70831629761838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04786722587816643, "StateBufferConnector_ms": 0.006146141977021189, "ViewRequirementAgentConnector_ms": 0.17745422594475024}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.17860901374837, "num_env_steps_trained_throughput_per_sec": 222.17860901374837, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 14720.07, "sample_time_ms": 11779.551, "learn_time_ms": 2802.674, "learn_throughput": 1427.208, "synch_weights_time_ms": 137.16}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 4744, "training_iteration": 162, "trial_id": "32397_00000", "date": "2025-03-21_09-16-16", "timestamp": 1742548576, "time_this_iter_s": 18.0622615814209, "time_total_s": 2343.1357674598694, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2343.1357674598694, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 98.60416666666667, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98794174194336, "policy_loss": -0.012120571918785572, "vf_loss": 10.0, "vf_explained_var": -2.3841858265427618e-08, "kl": 0.009923307225108147, "entropy": 0.27506306767463684, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": 56649.826946258545, "episode_reward_min": 56649.826946258545, "episode_reward_mean": 56649.826946258545, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56649.826946258545}, "policy_reward_max": {"agent_0": 56649.826946258545}, "policy_reward_mean": {"agent_0": 56649.826946258545}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56649.826946258545], "episode_lengths": [136], "policy_agent_0_reward": [56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.89227241950187, "mean_inference_ms": 6.695785218977307, "mean_action_processing_ms": 0.19312189997909385, "mean_env_wait_ms": 228.67977400754893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03476142883300781, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15687942504882812}}, "episode_reward_max": 56649.826946258545, "episode_reward_min": 56649.826946258545, "episode_reward_mean": 56649.826946258545, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56649.826946258545}, "policy_reward_max": {"agent_0": 56649.826946258545}, "policy_reward_mean": {"agent_0": 56649.826946258545}, "hist_stats": {"episode_reward": [56649.826946258545], "episode_lengths": [136], "policy_agent_0_reward": [56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.89227241950187, "mean_inference_ms": 6.695785218977307, "mean_action_processing_ms": 0.19312189997909385, "mean_env_wait_ms": 228.67977400754893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03476142883300781, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15687942504882812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.517271252668, "num_env_steps_trained_throughput_per_sec": 327.517271252668, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 14245.901, "sample_time_ms": 11321.105, "learn_time_ms": 2786.571, "learn_throughput": 1435.456, "synch_weights_time_ms": 137.532}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 4744, "training_iteration": 163, "trial_id": "32397_00000", "date": "2025-03-21_09-16-28", "timestamp": 1742548588, "time_this_iter_s": 12.267894983291626, "time_total_s": 2355.403662443161, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d6c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2355.403662443161, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 99.4888888888889, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9848051071167, "policy_loss": -0.0152638740837574, "vf_loss": 10.0, "vf_explained_var": 2.9491880937371207e-08, "kl": 0.01100896205753088, "entropy": 0.2896307408809662, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": 56649.826946258545, "episode_reward_min": 56649.826946258545, "episode_reward_mean": 56649.826946258545, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56649.826946258545}, "policy_reward_max": {"agent_0": 56649.826946258545}, "policy_reward_mean": {"agent_0": 56649.826946258545}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56649.826946258545], "episode_lengths": [136], "policy_agent_0_reward": [56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.89227241950187, "mean_inference_ms": 6.695785218977307, "mean_action_processing_ms": 0.19312189997909385, "mean_env_wait_ms": 228.67977400754893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03476142883300781, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15687942504882812}}, "episode_reward_max": 56649.826946258545, "episode_reward_min": 56649.826946258545, "episode_reward_mean": 56649.826946258545, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56649.826946258545}, "policy_reward_max": {"agent_0": 56649.826946258545}, "policy_reward_mean": {"agent_0": 56649.826946258545}, "hist_stats": {"episode_reward": [56649.826946258545], "episode_lengths": [136], "policy_agent_0_reward": [56649.826946258545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.89227241950187, "mean_inference_ms": 6.695785218977307, "mean_action_processing_ms": 0.19312189997909385, "mean_env_wait_ms": 228.67977400754893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03476142883300781, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15687942504882812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.04812097632, "num_env_steps_trained_throughput_per_sec": 315.04812097632, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 14170.187, "sample_time_ms": 11226.431, "learn_time_ms": 2808.538, "learn_throughput": 1424.228, "synch_weights_time_ms": 134.519}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 4744, "training_iteration": 164, "trial_id": "32397_00000", "date": "2025-03-21_09-16-41", "timestamp": 1742548601, "time_this_iter_s": 12.75117015838623, "time_total_s": 2368.1548326015472, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2368.1548326015472, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 99.56666666666666, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9050931930542, "policy_loss": -0.012218222953379154, "vf_loss": 9.917236328125, "vf_explained_var": 5.1533182165997005e-09, "kl": 0.01198602095246315, "entropy": 0.3637983202934265, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 60813.073638916016, "episode_reward_min": 52073.653327941895, "episode_reward_mean": 57366.903219425316, "episode_len_mean": 136.24242424242425, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {"agent_0": 52073.653327941895}, "policy_reward_max": {"agent_0": 60813.073638916016}, "policy_reward_mean": {"agent_0": 57366.903219425316}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57695.993743896484, 52073.653327941895, 59873.08038330078, 52398.153621673584, 54481.966782569885, 56614.453625679016, 54498.63339424133, 60524.0133895874, 59390.17324447632, 58284.40672302246, 59519.426666259766, 60802.32052612305, 54818.93336677551, 59309.50011444092, 60284.093505859375, 56970.68016433716, 60770.426849365234, 52578.40680503845, 56114.653467178345, 60126.40017127991, 60813.073638916016, 55602.80030822754, 58984.72671508789, 57833.367181777954, 54870.10674858093, 55679.40038394928, 58559.9404296875, 56219.1003112793, 57428.100105285645, 59214.293533325195, 57833.673278808594, 56850.98015213013, 56088.87358093262], "episode_lengths": [136, 135, 137, 136, 135, 136, 135, 137, 137, 136, 138, 137, 134, 137, 137, 136, 137, 135, 136, 137, 137, 136, 136, 136, 136, 136, 137, 136, 135, 137, 137, 137, 136], "policy_agent_0_reward": [57695.993743896484, 52073.653327941895, 59873.08038330078, 52398.153621673584, 54481.966782569885, 56614.453625679016, 54498.63339424133, 60524.0133895874, 59390.17324447632, 58284.40672302246, 59519.426666259766, 60802.32052612305, 54818.93336677551, 59309.50011444092, 60284.093505859375, 56970.68016433716, 60770.426849365234, 52578.40680503845, 56114.653467178345, 60126.40017127991, 60813.073638916016, 55602.80030822754, 58984.72671508789, 57833.367181777954, 54870.10674858093, 55679.40038394928, 58559.9404296875, 56219.1003112793, 57428.100105285645, 59214.293533325195, 57833.673278808594, 56850.98015213013, 56088.87358093262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.56775612731461, "mean_inference_ms": 6.434142467071217, "mean_action_processing_ms": 0.2004213742072788, "mean_env_wait_ms": 219.0756645906541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07480997027772845, "StateBufferConnector_ms": 0.006177931120901397, "ViewRequirementAgentConnector_ms": 0.1951297124226888}}, "episode_reward_max": 60813.073638916016, "episode_reward_min": 52073.653327941895, "episode_reward_mean": 57366.903219425316, "episode_len_mean": 136.24242424242425, "episodes_this_iter": 33, "policy_reward_min": {"agent_0": 52073.653327941895}, "policy_reward_max": {"agent_0": 60813.073638916016}, "policy_reward_mean": {"agent_0": 57366.903219425316}, "hist_stats": {"episode_reward": [57695.993743896484, 52073.653327941895, 59873.08038330078, 52398.153621673584, 54481.966782569885, 56614.453625679016, 54498.63339424133, 60524.0133895874, 59390.17324447632, 58284.40672302246, 59519.426666259766, 60802.32052612305, 54818.93336677551, 59309.50011444092, 60284.093505859375, 56970.68016433716, 60770.426849365234, 52578.40680503845, 56114.653467178345, 60126.40017127991, 60813.073638916016, 55602.80030822754, 58984.72671508789, 57833.367181777954, 54870.10674858093, 55679.40038394928, 58559.9404296875, 56219.1003112793, 57428.100105285645, 59214.293533325195, 57833.673278808594, 56850.98015213013, 56088.87358093262], "episode_lengths": [136, 135, 137, 136, 135, 136, 135, 137, 137, 136, 138, 137, 134, 137, 137, 136, 137, 135, 136, 137, 137, 136, 136, 136, 136, 136, 137, 136, 135, 137, 137, 137, 136], "policy_agent_0_reward": [57695.993743896484, 52073.653327941895, 59873.08038330078, 52398.153621673584, 54481.966782569885, 56614.453625679016, 54498.63339424133, 60524.0133895874, 59390.17324447632, 58284.40672302246, 59519.426666259766, 60802.32052612305, 54818.93336677551, 59309.50011444092, 60284.093505859375, 56970.68016433716, 60770.426849365234, 52578.40680503845, 56114.653467178345, 60126.40017127991, 60813.073638916016, 55602.80030822754, 58984.72671508789, 57833.367181777954, 54870.10674858093, 55679.40038394928, 58559.9404296875, 56219.1003112793, 57428.100105285645, 59214.293533325195, 57833.673278808594, 56850.98015213013, 56088.87358093262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.56775612731461, "mean_inference_ms": 6.434142467071217, "mean_action_processing_ms": 0.2004213742072788, "mean_env_wait_ms": 219.0756645906541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07480997027772845, "StateBufferConnector_ms": 0.006177931120901397, "ViewRequirementAgentConnector_ms": 0.1951297124226888}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.72065750074773, "num_env_steps_trained_throughput_per_sec": 275.72065750074773, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 14273.407, "sample_time_ms": 11416.271, "learn_time_ms": 2720.499, "learn_throughput": 1470.318, "synch_weights_time_ms": 135.942}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 4777, "training_iteration": 165, "trial_id": "32397_00000", "date": "2025-03-21_09-16-56", "timestamp": 1742548616, "time_this_iter_s": 14.559616327285767, "time_total_s": 2382.714448928833, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb490700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2382.714448928833, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 99.30499999999999, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.208791208791209, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.762969970703125, "policy_loss": -0.012012901715934277, "vf_loss": 9.77490234375, "vf_explained_var": 5.8487056975309315e-08, "kl": 0.012831495143473148, "entropy": 0.36666810512542725, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": 62621.81335449219, "episode_reward_min": 43852.30017089844, "episode_reward_mean": 56466.5283130499, "episode_len_mean": 136.25274725274724, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43852.30017089844}, "policy_reward_max": {"agent_0": 62621.81335449219}, "policy_reward_mean": {"agent_0": 56466.5283130499}, "custom_metrics": {"num_batches_mean": 5.208791208791209, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58715.740226745605, 53549.28698348999, 59989.120445251465, 61896.7335357666, 58796.9001159668, 57583.22659301758, 59403.86703872681, 47170.82003593445, 61231.200103759766, 52242.80715942383, 56801.720180511475, 58304.120178222656, 61335.00698852539, 60078.4469909668, 54423.64678478241, 57511.65346908569, 57664.62704658508, 61114.78695678711, 55493.246710300446, 57417.126693725586, 57950.626750946045, 56680.62037277222, 48777.333404421806, 57373.50699043274, 59812.92667007446, 59824.23370742798, 56351.58003950119, 57869.22719192505, 58104.94665527344, 59546.59963989258, 55103.20692253113, 54713.68031692505, 60616.60696411133, 57594.90682601929, 62621.81335449219, 54065.26024436951, 60127.107330322266, 60181.986907958984, 57886.15330505371, 53323.673644542694, 59110.540340423584, 51177.07330560684, 51625.41361236572, 55552.72040939331, 43852.30017089844, 59739.453552246094, 51504.69358563423, 54416.427101135254, 52991.626680374146, 59985.120332717896, 54175.57353210449, 58989.85355377197, 51111.84017133713, 49594.46044784784, 57182.666989564896, 58733.80029296875, 59787.1203918457, 52449.820118010044, 60197.61354446411, 56925.406618118286, 57711.92668533325, 50187.27335000038, 56952.62682342529, 53642.62690258026, 56615.38685417175, 55864.10688018799, 54796.16670417786, 60021.99341583252, 54938.680134773254, 55305.846762657166, 59080.42691040039, 54832.68014431, 58112.71337890625, 60133.940185546875, 59677.419982910156, 57082.01364898682, 56147.89330291748, 57101.55327606201, 58164.2400970459, 54522.026807785034, 55610.79357910156, 55958.26006126404, 57634.24689865112, 52329.92670249939, 58194.0802154541, 55376.84001469612, 45720.53333282471, 58971.533531188965, 52438.70014190674, 56550.65330505371, 60423.36022949219], "episode_lengths": [136, 135, 136, 138, 137, 137, 137, 135, 137, 134, 137, 137, 138, 137, 136, 136, 137, 138, 136, 135, 135, 137, 135, 136, 136, 137, 136, 137, 136, 137, 135, 136, 138, 136, 137, 136, 137, 137, 136, 136, 137, 136, 135, 136, 133, 137, 136, 137, 135, 138, 136, 136, 134, 136, 137, 137, 137, 136, 138, 137, 137, 135, 137, 135, 136, 136, 135, 137, 136, 136, 137, 136, 136, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 135, 137, 135, 135, 137, 136, 136, 138], "policy_agent_0_reward": [58715.740226745605, 53549.28698348999, 59989.120445251465, 61896.7335357666, 58796.9001159668, 57583.22659301758, 59403.86703872681, 47170.82003593445, 61231.200103759766, 52242.80715942383, 56801.720180511475, 58304.120178222656, 61335.00698852539, 60078.4469909668, 54423.64678478241, 57511.65346908569, 57664.62704658508, 61114.78695678711, 55493.246710300446, 57417.126693725586, 57950.626750946045, 56680.62037277222, 48777.333404421806, 57373.50699043274, 59812.92667007446, 59824.23370742798, 56351.58003950119, 57869.22719192505, 58104.94665527344, 59546.59963989258, 55103.20692253113, 54713.68031692505, 60616.60696411133, 57594.90682601929, 62621.81335449219, 54065.26024436951, 60127.107330322266, 60181.986907958984, 57886.15330505371, 53323.673644542694, 59110.540340423584, 51177.07330560684, 51625.41361236572, 55552.72040939331, 43852.30017089844, 59739.453552246094, 51504.69358563423, 54416.427101135254, 52991.626680374146, 59985.120332717896, 54175.57353210449, 58989.85355377197, 51111.84017133713, 49594.46044784784, 57182.666989564896, 58733.80029296875, 59787.1203918457, 52449.820118010044, 60197.61354446411, 56925.406618118286, 57711.92668533325, 50187.27335000038, 56952.62682342529, 53642.62690258026, 56615.38685417175, 55864.10688018799, 54796.16670417786, 60021.99341583252, 54938.680134773254, 55305.846762657166, 59080.42691040039, 54832.68014431, 58112.71337890625, 60133.940185546875, 59677.419982910156, 57082.01364898682, 56147.89330291748, 57101.55327606201, 58164.2400970459, 54522.026807785034, 55610.79357910156, 55958.26006126404, 57634.24689865112, 52329.92670249939, 58194.0802154541, 55376.84001469612, 45720.53333282471, 58971.533531188965, 52438.70014190674, 56550.65330505371, 60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.71161456351925, "mean_inference_ms": 6.760447190146539, "mean_action_processing_ms": 0.19714734139092532, "mean_env_wait_ms": 231.10402200579844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04122571630792304, "StateBufferConnector_ms": 0.010325358464167668, "ViewRequirementAgentConnector_ms": 0.21161692483084543}}, "episode_reward_max": 62621.81335449219, "episode_reward_min": 43852.30017089844, "episode_reward_mean": 56466.5283130499, "episode_len_mean": 136.25274725274724, "episodes_this_iter": 91, "policy_reward_min": {"agent_0": 43852.30017089844}, "policy_reward_max": {"agent_0": 62621.81335449219}, "policy_reward_mean": {"agent_0": 56466.5283130499}, "hist_stats": {"episode_reward": [58715.740226745605, 53549.28698348999, 59989.120445251465, 61896.7335357666, 58796.9001159668, 57583.22659301758, 59403.86703872681, 47170.82003593445, 61231.200103759766, 52242.80715942383, 56801.720180511475, 58304.120178222656, 61335.00698852539, 60078.4469909668, 54423.64678478241, 57511.65346908569, 57664.62704658508, 61114.78695678711, 55493.246710300446, 57417.126693725586, 57950.626750946045, 56680.62037277222, 48777.333404421806, 57373.50699043274, 59812.92667007446, 59824.23370742798, 56351.58003950119, 57869.22719192505, 58104.94665527344, 59546.59963989258, 55103.20692253113, 54713.68031692505, 60616.60696411133, 57594.90682601929, 62621.81335449219, 54065.26024436951, 60127.107330322266, 60181.986907958984, 57886.15330505371, 53323.673644542694, 59110.540340423584, 51177.07330560684, 51625.41361236572, 55552.72040939331, 43852.30017089844, 59739.453552246094, 51504.69358563423, 54416.427101135254, 52991.626680374146, 59985.120332717896, 54175.57353210449, 58989.85355377197, 51111.84017133713, 49594.46044784784, 57182.666989564896, 58733.80029296875, 59787.1203918457, 52449.820118010044, 60197.61354446411, 56925.406618118286, 57711.92668533325, 50187.27335000038, 56952.62682342529, 53642.62690258026, 56615.38685417175, 55864.10688018799, 54796.16670417786, 60021.99341583252, 54938.680134773254, 55305.846762657166, 59080.42691040039, 54832.68014431, 58112.71337890625, 60133.940185546875, 59677.419982910156, 57082.01364898682, 56147.89330291748, 57101.55327606201, 58164.2400970459, 54522.026807785034, 55610.79357910156, 55958.26006126404, 57634.24689865112, 52329.92670249939, 58194.0802154541, 55376.84001469612, 45720.53333282471, 58971.533531188965, 52438.70014190674, 56550.65330505371, 60423.36022949219], "episode_lengths": [136, 135, 136, 138, 137, 137, 137, 135, 137, 134, 137, 137, 138, 137, 136, 136, 137, 138, 136, 135, 135, 137, 135, 136, 136, 137, 136, 137, 136, 137, 135, 136, 138, 136, 137, 136, 137, 137, 136, 136, 137, 136, 135, 136, 133, 137, 136, 137, 135, 138, 136, 136, 134, 136, 137, 137, 137, 136, 138, 137, 137, 135, 137, 135, 136, 136, 135, 137, 136, 136, 137, 136, 136, 137, 136, 136, 136, 136, 136, 136, 136, 136, 137, 135, 137, 135, 135, 137, 136, 136, 138], "policy_agent_0_reward": [58715.740226745605, 53549.28698348999, 59989.120445251465, 61896.7335357666, 58796.9001159668, 57583.22659301758, 59403.86703872681, 47170.82003593445, 61231.200103759766, 52242.80715942383, 56801.720180511475, 58304.120178222656, 61335.00698852539, 60078.4469909668, 54423.64678478241, 57511.65346908569, 57664.62704658508, 61114.78695678711, 55493.246710300446, 57417.126693725586, 57950.626750946045, 56680.62037277222, 48777.333404421806, 57373.50699043274, 59812.92667007446, 59824.23370742798, 56351.58003950119, 57869.22719192505, 58104.94665527344, 59546.59963989258, 55103.20692253113, 54713.68031692505, 60616.60696411133, 57594.90682601929, 62621.81335449219, 54065.26024436951, 60127.107330322266, 60181.986907958984, 57886.15330505371, 53323.673644542694, 59110.540340423584, 51177.07330560684, 51625.41361236572, 55552.72040939331, 43852.30017089844, 59739.453552246094, 51504.69358563423, 54416.427101135254, 52991.626680374146, 59985.120332717896, 54175.57353210449, 58989.85355377197, 51111.84017133713, 49594.46044784784, 57182.666989564896, 58733.80029296875, 59787.1203918457, 52449.820118010044, 60197.61354446411, 56925.406618118286, 57711.92668533325, 50187.27335000038, 56952.62682342529, 53642.62690258026, 56615.38685417175, 55864.10688018799, 54796.16670417786, 60021.99341583252, 54938.680134773254, 55305.846762657166, 59080.42691040039, 54832.68014431, 58112.71337890625, 60133.940185546875, 59677.419982910156, 57082.01364898682, 56147.89330291748, 57101.55327606201, 58164.2400970459, 54522.026807785034, 55610.79357910156, 55958.26006126404, 57634.24689865112, 52329.92670249939, 58194.0802154541, 55376.84001469612, 45720.53333282471, 58971.533531188965, 52438.70014190674, 56550.65330505371, 60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.71161456351925, "mean_inference_ms": 6.760447190146539, "mean_action_processing_ms": 0.19714734139092532, "mean_env_wait_ms": 231.10402200579844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04122571630792304, "StateBufferConnector_ms": 0.010325358464167668, "ViewRequirementAgentConnector_ms": 0.21161692483084543}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.55157641669723, "num_env_steps_trained_throughput_per_sec": 239.55157641669723, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 14653.192, "sample_time_ms": 11812.867, "learn_time_ms": 2705.319, "learn_throughput": 1478.569, "synch_weights_time_ms": 134.309}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 4868, "training_iteration": 166, "trial_id": "32397_00000", "date": "2025-03-21_09-17-12", "timestamp": 1742548632, "time_this_iter_s": 16.749050855636597, "time_total_s": 2399.4634997844696, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2399.4634997844696, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 97.29545454545455, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986042976379395, "policy_loss": -0.014040402136743069, "vf_loss": 10.0, "vf_explained_var": -2.135833021554845e-08, "kl": 0.01333671621978283, "entropy": 0.3024071753025055, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": 60423.36022949219, "episode_reward_min": 60423.36022949219, "episode_reward_mean": 60423.36022949219, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60423.36022949219}, "policy_reward_max": {"agent_0": 60423.36022949219}, "policy_reward_mean": {"agent_0": 60423.36022949219}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60423.36022949219], "episode_lengths": [138], "policy_agent_0_reward": [60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13998787411633, "mean_inference_ms": 6.661527466015607, "mean_action_processing_ms": 0.19384211298437998, "mean_env_wait_ms": 228.6093056863835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037598609924316406, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1667022705078125}}, "episode_reward_max": 60423.36022949219, "episode_reward_min": 60423.36022949219, "episode_reward_mean": 60423.36022949219, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60423.36022949219}, "policy_reward_max": {"agent_0": 60423.36022949219}, "policy_reward_mean": {"agent_0": 60423.36022949219}, "hist_stats": {"episode_reward": [60423.36022949219], "episode_lengths": [138], "policy_agent_0_reward": [60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13998787411633, "mean_inference_ms": 6.661527466015607, "mean_action_processing_ms": 0.19384211298437998, "mean_env_wait_ms": 228.6093056863835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037598609924316406, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1667022705078125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.96046422378515, "num_env_steps_trained_throughput_per_sec": 305.96046422378515, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 14222.159, "sample_time_ms": 11372.43, "learn_time_ms": 2708.87, "learn_throughput": 1476.63, "synch_weights_time_ms": 140.164}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 4868, "training_iteration": 167, "trial_id": "32397_00000", "date": "2025-03-21_09-17-26", "timestamp": 1742548646, "time_this_iter_s": 13.133240461349487, "time_total_s": 2412.596740245819, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2412.596740245819, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 99.56111111111113, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98986530303955, "policy_loss": -0.010201151482760906, "vf_loss": 10.0, "vf_explained_var": -4.203369385891165e-08, "kl": 0.010518950410187244, "entropy": 0.3017292320728302, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 60423.36022949219, "episode_reward_min": 60423.36022949219, "episode_reward_mean": 60423.36022949219, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60423.36022949219}, "policy_reward_max": {"agent_0": 60423.36022949219}, "policy_reward_mean": {"agent_0": 60423.36022949219}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60423.36022949219], "episode_lengths": [138], "policy_agent_0_reward": [60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13998787411633, "mean_inference_ms": 6.661527466015607, "mean_action_processing_ms": 0.19384211298437998, "mean_env_wait_ms": 228.6093056863835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037598609924316406, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1667022705078125}}, "episode_reward_max": 60423.36022949219, "episode_reward_min": 60423.36022949219, "episode_reward_mean": 60423.36022949219, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60423.36022949219}, "policy_reward_max": {"agent_0": 60423.36022949219}, "policy_reward_mean": {"agent_0": 60423.36022949219}, "hist_stats": {"episode_reward": [60423.36022949219], "episode_lengths": [138], "policy_agent_0_reward": [60423.36022949219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13998787411633, "mean_inference_ms": 6.661527466015607, "mean_action_processing_ms": 0.19384211298437998, "mean_env_wait_ms": 228.6093056863835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037598609924316406, "StateBufferConnector_ms": 0.0061511993408203125, "ViewRequirementAgentConnector_ms": 0.1667022705078125}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.3920081085385, "num_env_steps_trained_throughput_per_sec": 305.3920081085385, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 14201.427, "sample_time_ms": 11339.699, "learn_time_ms": 2716.007, "learn_throughput": 1472.75, "synch_weights_time_ms": 145.019}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 4868, "training_iteration": 168, "trial_id": "32397_00000", "date": "2025-03-21_09-17-39", "timestamp": 1742548659, "time_this_iter_s": 13.151416540145874, "time_total_s": 2425.748156785965, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493f40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2425.748156785965, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 99.6263157894737, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.902164459228516, "policy_loss": -0.017366038635373116, "vf_loss": 9.919439315795898, "vf_explained_var": -2.5490298867225647e-06, "kl": 0.01448622066527605, "entropy": 0.34142398834228516, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": 60437.50695800781, "episode_reward_min": 47790.90016889572, "episode_reward_mean": 56192.617680545896, "episode_len_mean": 135.9375, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47790.90016889572}, "policy_reward_max": {"agent_0": 60437.50695800781}, "policy_reward_mean": {"agent_0": 56192.617680545896}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56129.42008590698, 57491.37989807129, 55068.90683197975, 60437.50695800781, 57776.9401550293, 51160.553314208984, 51700.319982886314, 56647.580078125, 59357.63330078125, 58810.52020263672, 58473.6270942688, 58702.067054748535, 55563.09386444092, 54473.580545425415, 54229.75355529785, 57597.513385772705, 56682.333585739136, 59433.486724853516, 52536.580486774445, 47790.90016889572, 56483.44674682617, 53476.506918907166, 58556.37350463867, 56741.9732170105, 58280.33354187012, 56714.89334106445, 55824.31362438202, 59164.0467338562, 57708.43352127075, 55138.07355642319, 55200.72675681114, 54810.94704055786], "episode_lengths": [136, 136, 134, 137, 136, 135, 136, 135, 137, 137, 137, 137, 136, 135, 136, 137, 136, 137, 136, 133, 136, 135, 136, 136, 136, 136, 136, 137, 136, 136, 135, 136], "policy_agent_0_reward": [56129.42008590698, 57491.37989807129, 55068.90683197975, 60437.50695800781, 57776.9401550293, 51160.553314208984, 51700.319982886314, 56647.580078125, 59357.63330078125, 58810.52020263672, 58473.6270942688, 58702.067054748535, 55563.09386444092, 54473.580545425415, 54229.75355529785, 57597.513385772705, 56682.333585739136, 59433.486724853516, 52536.580486774445, 47790.90016889572, 56483.44674682617, 53476.506918907166, 58556.37350463867, 56741.9732170105, 58280.33354187012, 56714.89334106445, 55824.31362438202, 59164.0467338562, 57708.43352127075, 55138.07355642319, 55200.72675681114, 54810.94704055786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.195353289548535, "mean_inference_ms": 6.417716645284039, "mean_action_processing_ms": 0.20044311138411583, "mean_env_wait_ms": 218.68130487084989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08996501564979553, "StateBufferConnector_ms": 0.006406009197235107, "ViewRequirementAgentConnector_ms": 0.273701548576355}}, "episode_reward_max": 60437.50695800781, "episode_reward_min": 47790.90016889572, "episode_reward_mean": 56192.617680545896, "episode_len_mean": 135.9375, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 47790.90016889572}, "policy_reward_max": {"agent_0": 60437.50695800781}, "policy_reward_mean": {"agent_0": 56192.617680545896}, "hist_stats": {"episode_reward": [56129.42008590698, 57491.37989807129, 55068.90683197975, 60437.50695800781, 57776.9401550293, 51160.553314208984, 51700.319982886314, 56647.580078125, 59357.63330078125, 58810.52020263672, 58473.6270942688, 58702.067054748535, 55563.09386444092, 54473.580545425415, 54229.75355529785, 57597.513385772705, 56682.333585739136, 59433.486724853516, 52536.580486774445, 47790.90016889572, 56483.44674682617, 53476.506918907166, 58556.37350463867, 56741.9732170105, 58280.33354187012, 56714.89334106445, 55824.31362438202, 59164.0467338562, 57708.43352127075, 55138.07355642319, 55200.72675681114, 54810.94704055786], "episode_lengths": [136, 136, 134, 137, 136, 135, 136, 135, 137, 137, 137, 137, 136, 135, 136, 137, 136, 137, 136, 133, 136, 135, 136, 136, 136, 136, 136, 137, 136, 136, 135, 136], "policy_agent_0_reward": [56129.42008590698, 57491.37989807129, 55068.90683197975, 60437.50695800781, 57776.9401550293, 51160.553314208984, 51700.319982886314, 56647.580078125, 59357.63330078125, 58810.52020263672, 58473.6270942688, 58702.067054748535, 55563.09386444092, 54473.580545425415, 54229.75355529785, 57597.513385772705, 56682.333585739136, 59433.486724853516, 52536.580486774445, 47790.90016889572, 56483.44674682617, 53476.506918907166, 58556.37350463867, 56741.9732170105, 58280.33354187012, 56714.89334106445, 55824.31362438202, 59164.0467338562, 57708.43352127075, 55138.07355642319, 55200.72675681114, 54810.94704055786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.195353289548535, "mean_inference_ms": 6.417716645284039, "mean_action_processing_ms": 0.20044311138411583, "mean_env_wait_ms": 218.68130487084989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08996501564979553, "StateBufferConnector_ms": 0.006406009197235107, "ViewRequirementAgentConnector_ms": 0.273701548576355}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.70405413065214, "num_env_steps_trained_throughput_per_sec": 283.70405413065214, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 14322.705, "sample_time_ms": 11423.493, "learn_time_ms": 2756.103, "learn_throughput": 1451.325, "synch_weights_time_ms": 142.412}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 4900, "training_iteration": 169, "trial_id": "32397_00000", "date": "2025-03-21_09-17-53", "timestamp": 1742548673, "time_this_iter_s": 14.153682231903076, "time_total_s": 2439.901839017868, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d6c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2439.901839017868, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 99.49000000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.757794380187988, "policy_loss": -0.011346315033733845, "vf_loss": 9.769071578979492, "vf_explained_var": -2.2413830436107673e-07, "kl": 0.010940772481262684, "entropy": 0.3058378994464874, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": 60890.266845703125, "episode_reward_min": 47799.0935382843, "episode_reward_mean": 56643.758300671114, "episode_len_mean": 136.17391304347825, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47799.0935382843}, "policy_reward_max": {"agent_0": 60890.266845703125}, "policy_reward_mean": {"agent_0": 56643.758300671114}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59165.76013183594, 50506.5800344944, 57948.79349517822, 59098.24678039551, 58323.313254356384, 57829.10010910034, 52341.71356391907, 59120.36036682129, 56794.91349411011, 59558.9469909668, 51220.380207538605, 60179.646728515625, 53978.61339187622, 57540.10008811951, 53617.126972198486, 56053.00011634827, 58751.90022277832, 53833.09341239929, 59231.42678833008, 47799.0935382843, 59903.35383605957, 59907.3870010376, 56998.08043670654, 59712.42692184448, 60462.58031272888, 57873.42678833008, 59325.0068359375, 54310.40014791489, 56943.64691543579, 56383.28679275513, 59836.286712646484, 53199.573499679565, 57895.940059661865, 56842.4333152771, 55787.90702724457, 57450.12685775757, 53394.686693906784, 50836.440136909485, 55197.493580818176, 58519.67352628708, 55815.246577739716, 54344.12684249878, 58071.106776714325, 53999.76020812988, 53731.480397224426, 56519.08027648926, 58282.70685195923, 60082.386978149414, 59677.946716308594, 50302.84002113342, 57205.059997558594, 54259.40705871582, 53919.37363243103, 59741.680740356445, 58304.98043823242, 52278.72675704956, 57520.52027130127, 59464.6869468689, 57063.28698539734, 53600.0535030365, 60620.66011047363, 58645.920110702515, 59310.73324584961, 59026.88687133789, 53543.96692085266, 53150.00686264038, 60124.8869934082, 58479.22671508789, 59302.88673400879, 56701.1601600647, 57581.433181762695, 49740.08687400818, 56859.01349258423, 54869.85353851318, 60890.266845703125, 60409.10693359375, 60435.56655883789, 58869.48010253906, 59149.58018493652, 56081.31367301941, 60361.03366088867, 56102.48681926727, 59082.79351043701, 53043.033588409424, 52602.0733165741, 54125.11368370056, 60596.88040161133, 55770.75352859497, 54550.66708087921, 51582.89344704151, 56526.15998363495, 55233.11346697807], "episode_lengths": [136, 135, 136, 137, 137, 136, 135, 136, 136, 137, 135, 137, 136, 136, 136, 136, 136, 136, 137, 135, 137, 138, 136, 137, 137, 137, 137, 135, 135, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 137, 135, 137, 137, 136, 136, 136, 136, 137, 137, 134, 136, 136, 135, 137, 136, 136, 136, 137, 136, 135, 137, 138, 137, 136, 136, 135, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 137, 136, 137, 136, 137, 136, 136, 135, 135, 137, 137, 135, 137, 135, 137, 135], "policy_agent_0_reward": [59165.76013183594, 50506.5800344944, 57948.79349517822, 59098.24678039551, 58323.313254356384, 57829.10010910034, 52341.71356391907, 59120.36036682129, 56794.91349411011, 59558.9469909668, 51220.380207538605, 60179.646728515625, 53978.61339187622, 57540.10008811951, 53617.126972198486, 56053.00011634827, 58751.90022277832, 53833.09341239929, 59231.42678833008, 47799.0935382843, 59903.35383605957, 59907.3870010376, 56998.08043670654, 59712.42692184448, 60462.58031272888, 57873.42678833008, 59325.0068359375, 54310.40014791489, 56943.64691543579, 56383.28679275513, 59836.286712646484, 53199.573499679565, 57895.940059661865, 56842.4333152771, 55787.90702724457, 57450.12685775757, 53394.686693906784, 50836.440136909485, 55197.493580818176, 58519.67352628708, 55815.246577739716, 54344.12684249878, 58071.106776714325, 53999.76020812988, 53731.480397224426, 56519.08027648926, 58282.70685195923, 60082.386978149414, 59677.946716308594, 50302.84002113342, 57205.059997558594, 54259.40705871582, 53919.37363243103, 59741.680740356445, 58304.98043823242, 52278.72675704956, 57520.52027130127, 59464.6869468689, 57063.28698539734, 53600.0535030365, 60620.66011047363, 58645.920110702515, 59310.73324584961, 59026.88687133789, 53543.96692085266, 53150.00686264038, 60124.8869934082, 58479.22671508789, 59302.88673400879, 56701.1601600647, 57581.433181762695, 49740.08687400818, 56859.01349258423, 54869.85353851318, 60890.266845703125, 60409.10693359375, 60435.56655883789, 58869.48010253906, 59149.58018493652, 56081.31367301941, 60361.03366088867, 56102.48681926727, 59082.79351043701, 53043.033588409424, 52602.0733165741, 54125.11368370056, 60596.88040161133, 55770.75352859497, 54550.66708087921, 51582.89344704151, 56526.15998363495, 55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.676320991624483, "mean_inference_ms": 6.760289708988262, "mean_action_processing_ms": 0.1971023933372115, "mean_env_wait_ms": 230.90775514143755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08220283881477687, "StateBufferConnector_ms": 0.006004001783288043, "ViewRequirementAgentConnector_ms": 0.20380693933238153}}, "episode_reward_max": 60890.266845703125, "episode_reward_min": 47799.0935382843, "episode_reward_mean": 56643.758300671114, "episode_len_mean": 136.17391304347825, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 47799.0935382843}, "policy_reward_max": {"agent_0": 60890.266845703125}, "policy_reward_mean": {"agent_0": 56643.758300671114}, "hist_stats": {"episode_reward": [59165.76013183594, 50506.5800344944, 57948.79349517822, 59098.24678039551, 58323.313254356384, 57829.10010910034, 52341.71356391907, 59120.36036682129, 56794.91349411011, 59558.9469909668, 51220.380207538605, 60179.646728515625, 53978.61339187622, 57540.10008811951, 53617.126972198486, 56053.00011634827, 58751.90022277832, 53833.09341239929, 59231.42678833008, 47799.0935382843, 59903.35383605957, 59907.3870010376, 56998.08043670654, 59712.42692184448, 60462.58031272888, 57873.42678833008, 59325.0068359375, 54310.40014791489, 56943.64691543579, 56383.28679275513, 59836.286712646484, 53199.573499679565, 57895.940059661865, 56842.4333152771, 55787.90702724457, 57450.12685775757, 53394.686693906784, 50836.440136909485, 55197.493580818176, 58519.67352628708, 55815.246577739716, 54344.12684249878, 58071.106776714325, 53999.76020812988, 53731.480397224426, 56519.08027648926, 58282.70685195923, 60082.386978149414, 59677.946716308594, 50302.84002113342, 57205.059997558594, 54259.40705871582, 53919.37363243103, 59741.680740356445, 58304.98043823242, 52278.72675704956, 57520.52027130127, 59464.6869468689, 57063.28698539734, 53600.0535030365, 60620.66011047363, 58645.920110702515, 59310.73324584961, 59026.88687133789, 53543.96692085266, 53150.00686264038, 60124.8869934082, 58479.22671508789, 59302.88673400879, 56701.1601600647, 57581.433181762695, 49740.08687400818, 56859.01349258423, 54869.85353851318, 60890.266845703125, 60409.10693359375, 60435.56655883789, 58869.48010253906, 59149.58018493652, 56081.31367301941, 60361.03366088867, 56102.48681926727, 59082.79351043701, 53043.033588409424, 52602.0733165741, 54125.11368370056, 60596.88040161133, 55770.75352859497, 54550.66708087921, 51582.89344704151, 56526.15998363495, 55233.11346697807], "episode_lengths": [136, 135, 136, 137, 137, 136, 135, 136, 136, 137, 135, 137, 136, 136, 136, 136, 136, 136, 137, 135, 137, 138, 136, 137, 137, 137, 137, 135, 135, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 137, 135, 137, 137, 136, 136, 136, 136, 137, 137, 134, 136, 136, 135, 137, 136, 136, 136, 137, 136, 135, 137, 138, 137, 136, 136, 135, 136, 136, 137, 137, 136, 136, 137, 136, 137, 137, 137, 136, 137, 136, 137, 136, 136, 135, 135, 137, 137, 135, 137, 135, 137, 135], "policy_agent_0_reward": [59165.76013183594, 50506.5800344944, 57948.79349517822, 59098.24678039551, 58323.313254356384, 57829.10010910034, 52341.71356391907, 59120.36036682129, 56794.91349411011, 59558.9469909668, 51220.380207538605, 60179.646728515625, 53978.61339187622, 57540.10008811951, 53617.126972198486, 56053.00011634827, 58751.90022277832, 53833.09341239929, 59231.42678833008, 47799.0935382843, 59903.35383605957, 59907.3870010376, 56998.08043670654, 59712.42692184448, 60462.58031272888, 57873.42678833008, 59325.0068359375, 54310.40014791489, 56943.64691543579, 56383.28679275513, 59836.286712646484, 53199.573499679565, 57895.940059661865, 56842.4333152771, 55787.90702724457, 57450.12685775757, 53394.686693906784, 50836.440136909485, 55197.493580818176, 58519.67352628708, 55815.246577739716, 54344.12684249878, 58071.106776714325, 53999.76020812988, 53731.480397224426, 56519.08027648926, 58282.70685195923, 60082.386978149414, 59677.946716308594, 50302.84002113342, 57205.059997558594, 54259.40705871582, 53919.37363243103, 59741.680740356445, 58304.98043823242, 52278.72675704956, 57520.52027130127, 59464.6869468689, 57063.28698539734, 53600.0535030365, 60620.66011047363, 58645.920110702515, 59310.73324584961, 59026.88687133789, 53543.96692085266, 53150.00686264038, 60124.8869934082, 58479.22671508789, 59302.88673400879, 56701.1601600647, 57581.433181762695, 49740.08687400818, 56859.01349258423, 54869.85353851318, 60890.266845703125, 60409.10693359375, 60435.56655883789, 58869.48010253906, 59149.58018493652, 56081.31367301941, 60361.03366088867, 56102.48681926727, 59082.79351043701, 53043.033588409424, 52602.0733165741, 54125.11368370056, 60596.88040161133, 55770.75352859497, 54550.66708087921, 51582.89344704151, 56526.15998363495, 55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.676320991624483, "mean_inference_ms": 6.760289708988262, "mean_action_processing_ms": 0.1971023933372115, "mean_env_wait_ms": 230.90775514143755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08220283881477687, "StateBufferConnector_ms": 0.006004001783288043, "ViewRequirementAgentConnector_ms": 0.20380693933238153}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.15188509906463, "num_env_steps_trained_throughput_per_sec": 246.15188509906463, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 14686.696, "sample_time_ms": 11782.128, "learn_time_ms": 2757.278, "learn_throughput": 1450.706, "synch_weights_time_ms": 146.592}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 4992, "training_iteration": 170, "trial_id": "32397_00000", "date": "2025-03-21_09-18-09", "timestamp": 1742548689, "time_this_iter_s": 16.297592639923096, "time_total_s": 2456.199431657791, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2456.199431657791, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 96.5521739130435, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985526084899902, "policy_loss": -0.014554453082382679, "vf_loss": 10.0, "vf_explained_var": 2.678483781437535e-07, "kl": 0.013017422519624233, "entropy": 0.3341202139854431, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 55233.11346697807, "episode_reward_min": 55233.11346697807, "episode_reward_mean": 55233.11346697807, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55233.11346697807}, "policy_reward_max": {"agent_0": 55233.11346697807}, "policy_reward_mean": {"agent_0": 55233.11346697807}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55233.11346697807], "episode_lengths": [135], "policy_agent_0_reward": [55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.915826317931426, "mean_inference_ms": 6.612117008741365, "mean_action_processing_ms": 0.193604430913969, "mean_env_wait_ms": 229.90632806492957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044155120849609375, "StateBufferConnector_ms": 0.006747245788574219, "ViewRequirementAgentConnector_ms": 0.19283294677734375}}, "episode_reward_max": 55233.11346697807, "episode_reward_min": 55233.11346697807, "episode_reward_mean": 55233.11346697807, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55233.11346697807}, "policy_reward_max": {"agent_0": 55233.11346697807}, "policy_reward_mean": {"agent_0": 55233.11346697807}, "hist_stats": {"episode_reward": [55233.11346697807], "episode_lengths": [135], "policy_agent_0_reward": [55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.915826317931426, "mean_inference_ms": 6.612117008741365, "mean_action_processing_ms": 0.193604430913969, "mean_env_wait_ms": 229.90632806492957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044155120849609375, "StateBufferConnector_ms": 0.006747245788574219, "ViewRequirementAgentConnector_ms": 0.19283294677734375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.5038723341591, "num_env_steps_trained_throughput_per_sec": 318.5038723341591, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 14319.75, "sample_time_ms": 11382.785, "learn_time_ms": 2786.276, "learn_throughput": 1435.608, "synch_weights_time_ms": 149.994}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 4992, "training_iteration": 171, "trial_id": "32397_00000", "date": "2025-03-21_09-18-22", "timestamp": 1742548702, "time_this_iter_s": 12.616164207458496, "time_total_s": 2468.8155958652496, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49fac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2468.8155958652496, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 99.54444444444445, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98056411743164, "policy_loss": -0.017092322930693626, "vf_loss": 9.99755859375, "vf_explained_var": 1.015886709865299e-06, "kl": 0.015750443562865257, "entropy": 0.3642924129962921, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": 55233.11346697807, "episode_reward_min": 55233.11346697807, "episode_reward_mean": 55233.11346697807, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55233.11346697807}, "policy_reward_max": {"agent_0": 55233.11346697807}, "policy_reward_mean": {"agent_0": 55233.11346697807}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55233.11346697807], "episode_lengths": [135], "policy_agent_0_reward": [55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.915826317931426, "mean_inference_ms": 6.612117008741365, "mean_action_processing_ms": 0.193604430913969, "mean_env_wait_ms": 229.90632806492957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044155120849609375, "StateBufferConnector_ms": 0.006747245788574219, "ViewRequirementAgentConnector_ms": 0.19283294677734375}}, "episode_reward_max": 55233.11346697807, "episode_reward_min": 55233.11346697807, "episode_reward_mean": 55233.11346697807, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55233.11346697807}, "policy_reward_max": {"agent_0": 55233.11346697807}, "policy_reward_mean": {"agent_0": 55233.11346697807}, "hist_stats": {"episode_reward": [55233.11346697807], "episode_lengths": [135], "policy_agent_0_reward": [55233.11346697807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.915826317931426, "mean_inference_ms": 6.612117008741365, "mean_action_processing_ms": 0.193604430913969, "mean_env_wait_ms": 229.90632806492957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044155120849609375, "StateBufferConnector_ms": 0.006747245788574219, "ViewRequirementAgentConnector_ms": 0.19283294677734375}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.8244988563901, "num_env_steps_trained_throughput_per_sec": 322.8244988563901, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 13758.463, "sample_time_ms": 10841.544, "learn_time_ms": 2766.974, "learn_throughput": 1445.623, "synch_weights_time_ms": 149.254}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 4992, "training_iteration": 172, "trial_id": "32397_00000", "date": "2025-03-21_09-18-34", "timestamp": 1742548714, "time_this_iter_s": 12.433192491531372, "time_total_s": 2481.248788356781, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2481.248788356781, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 99.66470588235295, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.911551475524902, "policy_loss": -0.011361909098923206, "vf_loss": 9.9228515625, "vf_explained_var": -2.1525968918467697e-07, "kl": 0.00986653845757246, "entropy": 0.31947675347328186, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": 61111.707122802734, "episode_reward_min": 43704.506875157356, "episode_reward_mean": 56483.73542815255, "episode_len_mean": 136.06451612903226, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 43704.506875157356}, "policy_reward_max": {"agent_0": 61111.707122802734}, "policy_reward_mean": {"agent_0": 56483.73542815255}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58957.34020805359, 55669.373626708984, 60110.84648132324, 58489.80009317398, 56761.4666595459, 59148.80661010742, 57530.27352523804, 57028.10006713867, 50042.12001037598, 52935.46033143997, 55963.1868019104, 55248.160079956055, 58032.5469493866, 60108.92678833008, 58943.933362960815, 59292.013679504395, 54608.92046928406, 60205.54025268555, 51186.64677810669, 54364.793462753296, 55838.96039009094, 59687.006576538086, 60247.9669342041, 43704.506875157356, 61111.707122802734, 56938.419921875, 55054.50025558472, 51316.55354261398, 55701.19347190857, 56718.30018615723, 60048.4267578125], "episode_lengths": [137, 137, 137, 136, 136, 137, 136, 136, 134, 135, 136, 136, 136, 136, 137, 136, 136, 137, 135, 136, 136, 137, 137, 134, 137, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [58957.34020805359, 55669.373626708984, 60110.84648132324, 58489.80009317398, 56761.4666595459, 59148.80661010742, 57530.27352523804, 57028.10006713867, 50042.12001037598, 52935.46033143997, 55963.1868019104, 55248.160079956055, 58032.5469493866, 60108.92678833008, 58943.933362960815, 59292.013679504395, 54608.92046928406, 60205.54025268555, 51186.64677810669, 54364.793462753296, 55838.96039009094, 59687.006576538086, 60247.9669342041, 43704.506875157356, 61111.707122802734, 56938.419921875, 55054.50025558472, 51316.55354261398, 55701.19347190857, 56718.30018615723, 60048.4267578125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.97053769593669, "mean_inference_ms": 6.412717642928778, "mean_action_processing_ms": 0.20017618513681087, "mean_env_wait_ms": 218.76521285634473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06323937446840348, "StateBufferConnector_ms": 0.006343472388482863, "ViewRequirementAgentConnector_ms": 0.3225641865884104}}, "episode_reward_max": 61111.707122802734, "episode_reward_min": 43704.506875157356, "episode_reward_mean": 56483.73542815255, "episode_len_mean": 136.06451612903226, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 43704.506875157356}, "policy_reward_max": {"agent_0": 61111.707122802734}, "policy_reward_mean": {"agent_0": 56483.73542815255}, "hist_stats": {"episode_reward": [58957.34020805359, 55669.373626708984, 60110.84648132324, 58489.80009317398, 56761.4666595459, 59148.80661010742, 57530.27352523804, 57028.10006713867, 50042.12001037598, 52935.46033143997, 55963.1868019104, 55248.160079956055, 58032.5469493866, 60108.92678833008, 58943.933362960815, 59292.013679504395, 54608.92046928406, 60205.54025268555, 51186.64677810669, 54364.793462753296, 55838.96039009094, 59687.006576538086, 60247.9669342041, 43704.506875157356, 61111.707122802734, 56938.419921875, 55054.50025558472, 51316.55354261398, 55701.19347190857, 56718.30018615723, 60048.4267578125], "episode_lengths": [137, 137, 137, 136, 136, 137, 136, 136, 134, 135, 136, 136, 136, 136, 137, 136, 136, 137, 135, 136, 136, 137, 137, 134, 137, 136, 135, 135, 136, 136, 137], "policy_agent_0_reward": [58957.34020805359, 55669.373626708984, 60110.84648132324, 58489.80009317398, 56761.4666595459, 59148.80661010742, 57530.27352523804, 57028.10006713867, 50042.12001037598, 52935.46033143997, 55963.1868019104, 55248.160079956055, 58032.5469493866, 60108.92678833008, 58943.933362960815, 59292.013679504395, 54608.92046928406, 60205.54025268555, 51186.64677810669, 54364.793462753296, 55838.96039009094, 59687.006576538086, 60247.9669342041, 43704.506875157356, 61111.707122802734, 56938.419921875, 55054.50025558472, 51316.55354261398, 55701.19347190857, 56718.30018615723, 60048.4267578125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.97053769593669, "mean_inference_ms": 6.412717642928778, "mean_action_processing_ms": 0.20017618513681087, "mean_env_wait_ms": 218.76521285634473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06323937446840348, "StateBufferConnector_ms": 0.006343472388482863, "ViewRequirementAgentConnector_ms": 0.3225641865884104}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.34241939427903, "num_env_steps_trained_throughput_per_sec": 280.34241939427903, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 13963.98, "sample_time_ms": 11058.116, "learn_time_ms": 2762.157, "learn_throughput": 1448.144, "synch_weights_time_ms": 143.042}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 5023, "training_iteration": 173, "trial_id": "32397_00000", "date": "2025-03-21_09-18-49", "timestamp": 1742548729, "time_this_iter_s": 14.32081913948059, "time_total_s": 2495.5696074962616, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb508820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2495.5696074962616, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 99.27894736842104, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.013333333333334, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.802533149719238, "policy_loss": -0.012479172088205814, "vf_loss": 9.814942359924316, "vf_explained_var": -4.035731038243284e-08, "kl": 0.011132613755762577, "entropy": 0.33421653509140015, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 61564.053649902344, "episode_reward_min": 46680.96683692932, "episode_reward_mean": 56148.35876867374, "episode_len_mean": 135.89333333333335, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 46680.96683692932}, "policy_reward_max": {"agent_0": 61564.053649902344}, "policy_reward_mean": {"agent_0": 56148.35876867374}, "custom_metrics": {"num_batches_mean": 5.013333333333334, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61564.053649902344, 52055.9067363739, 59735.133796691895, 58643.16687011719, 54656.58676338196, 58635.426681518555, 57160.34037780762, 56637.88672065735, 57655.046936035156, 51296.30032348633, 52244.22014451027, 54756.31335258484, 55643.1334400177, 56961.32650375366, 53606.72690200806, 56537.96685028076, 52912.133314073086, 58135.986976623535, 55685.980041503906, 60830.073638916016, 59084.74673461914, 57129.50686740875, 55835.66037750244, 55502.35331439972, 51568.1398973465, 46680.96683692932, 58251.0336227417, 58145.91363334656, 59234.49349975586, 53927.607006073, 51201.43335723877, 52863.693640232086, 60191.84701538086, 57943.41359710693, 52272.9669406414, 57379.1868019104, 55169.32028579712, 49499.80030441284, 57028.966552734375, 55356.880208969116, 56697.98678588867, 54551.113679885864, 60290.25357055664, 60877.12742614746, 60513.660095214844, 55500.773341178894, 56426.80702972412, 54656.2534365654, 58131.25322723389, 56737.740089416504, 55789.68018245697, 54314.20690917969, 55051.200117111206, 56013.52006340027, 60573.82041931152, 51128.82028102875, 56251.280225753784, 55605.68033313751, 52753.593479156494, 55170.06011581421, 59144.58674621582, 57658.626892089844, 56623.76689147949, 52174.88675236702, 56733.42018890381, 58331.600021362305, 59170.62664794922, 57381.33346557617, 59197.246978759766, 55934.1404838562, 58256.36692941189, 56846.32684326172, 52768.993478775024, 57155.95372390747, 57092.56028366089], "episode_lengths": [138, 134, 137, 136, 135, 137, 136, 136, 137, 135, 136, 135, 136, 137, 135, 136, 136, 136, 136, 138, 136, 136, 135, 135, 136, 135, 136, 137, 137, 135, 135, 136, 136, 136, 134, 136, 135, 134, 136, 135, 135, 135, 137, 137, 137, 135, 135, 136, 137, 135, 137, 136, 136, 136, 137, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136], "policy_agent_0_reward": [61564.053649902344, 52055.9067363739, 59735.133796691895, 58643.16687011719, 54656.58676338196, 58635.426681518555, 57160.34037780762, 56637.88672065735, 57655.046936035156, 51296.30032348633, 52244.22014451027, 54756.31335258484, 55643.1334400177, 56961.32650375366, 53606.72690200806, 56537.96685028076, 52912.133314073086, 58135.986976623535, 55685.980041503906, 60830.073638916016, 59084.74673461914, 57129.50686740875, 55835.66037750244, 55502.35331439972, 51568.1398973465, 46680.96683692932, 58251.0336227417, 58145.91363334656, 59234.49349975586, 53927.607006073, 51201.43335723877, 52863.693640232086, 60191.84701538086, 57943.41359710693, 52272.9669406414, 57379.1868019104, 55169.32028579712, 49499.80030441284, 57028.966552734375, 55356.880208969116, 56697.98678588867, 54551.113679885864, 60290.25357055664, 60877.12742614746, 60513.660095214844, 55500.773341178894, 56426.80702972412, 54656.2534365654, 58131.25322723389, 56737.740089416504, 55789.68018245697, 54314.20690917969, 55051.200117111206, 56013.52006340027, 60573.82041931152, 51128.82028102875, 56251.280225753784, 55605.68033313751, 52753.593479156494, 55170.06011581421, 59144.58674621582, 57658.626892089844, 56623.76689147949, 52174.88675236702, 56733.42018890381, 58331.600021362305, 59170.62664794922, 57381.33346557617, 59197.246978759766, 55934.1404838562, 58256.36692941189, 56846.32684326172, 52768.993478775024, 57155.95372390747, 57092.56028366089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.735092282619892, "mean_inference_ms": 6.737888790706415, "mean_action_processing_ms": 0.19701399137606274, "mean_env_wait_ms": 231.15379964970222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07855224609375, "StateBufferConnector_ms": 0.006342252095540364, "ViewRequirementAgentConnector_ms": 0.22971216837565103}}, "episode_reward_max": 61564.053649902344, "episode_reward_min": 46680.96683692932, "episode_reward_mean": 56148.35876867374, "episode_len_mean": 135.89333333333335, "episodes_this_iter": 75, "policy_reward_min": {"agent_0": 46680.96683692932}, "policy_reward_max": {"agent_0": 61564.053649902344}, "policy_reward_mean": {"agent_0": 56148.35876867374}, "hist_stats": {"episode_reward": [61564.053649902344, 52055.9067363739, 59735.133796691895, 58643.16687011719, 54656.58676338196, 58635.426681518555, 57160.34037780762, 56637.88672065735, 57655.046936035156, 51296.30032348633, 52244.22014451027, 54756.31335258484, 55643.1334400177, 56961.32650375366, 53606.72690200806, 56537.96685028076, 52912.133314073086, 58135.986976623535, 55685.980041503906, 60830.073638916016, 59084.74673461914, 57129.50686740875, 55835.66037750244, 55502.35331439972, 51568.1398973465, 46680.96683692932, 58251.0336227417, 58145.91363334656, 59234.49349975586, 53927.607006073, 51201.43335723877, 52863.693640232086, 60191.84701538086, 57943.41359710693, 52272.9669406414, 57379.1868019104, 55169.32028579712, 49499.80030441284, 57028.966552734375, 55356.880208969116, 56697.98678588867, 54551.113679885864, 60290.25357055664, 60877.12742614746, 60513.660095214844, 55500.773341178894, 56426.80702972412, 54656.2534365654, 58131.25322723389, 56737.740089416504, 55789.68018245697, 54314.20690917969, 55051.200117111206, 56013.52006340027, 60573.82041931152, 51128.82028102875, 56251.280225753784, 55605.68033313751, 52753.593479156494, 55170.06011581421, 59144.58674621582, 57658.626892089844, 56623.76689147949, 52174.88675236702, 56733.42018890381, 58331.600021362305, 59170.62664794922, 57381.33346557617, 59197.246978759766, 55934.1404838562, 58256.36692941189, 56846.32684326172, 52768.993478775024, 57155.95372390747, 57092.56028366089], "episode_lengths": [138, 134, 137, 136, 135, 137, 136, 136, 137, 135, 136, 135, 136, 137, 135, 136, 136, 136, 136, 138, 136, 136, 135, 135, 136, 135, 136, 137, 137, 135, 135, 136, 136, 136, 134, 136, 135, 134, 136, 135, 135, 135, 137, 137, 137, 135, 135, 136, 137, 135, 137, 136, 136, 136, 137, 136, 136, 136, 135, 135, 136, 136, 136, 135, 136, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136], "policy_agent_0_reward": [61564.053649902344, 52055.9067363739, 59735.133796691895, 58643.16687011719, 54656.58676338196, 58635.426681518555, 57160.34037780762, 56637.88672065735, 57655.046936035156, 51296.30032348633, 52244.22014451027, 54756.31335258484, 55643.1334400177, 56961.32650375366, 53606.72690200806, 56537.96685028076, 52912.133314073086, 58135.986976623535, 55685.980041503906, 60830.073638916016, 59084.74673461914, 57129.50686740875, 55835.66037750244, 55502.35331439972, 51568.1398973465, 46680.96683692932, 58251.0336227417, 58145.91363334656, 59234.49349975586, 53927.607006073, 51201.43335723877, 52863.693640232086, 60191.84701538086, 57943.41359710693, 52272.9669406414, 57379.1868019104, 55169.32028579712, 49499.80030441284, 57028.966552734375, 55356.880208969116, 56697.98678588867, 54551.113679885864, 60290.25357055664, 60877.12742614746, 60513.660095214844, 55500.773341178894, 56426.80702972412, 54656.2534365654, 58131.25322723389, 56737.740089416504, 55789.68018245697, 54314.20690917969, 55051.200117111206, 56013.52006340027, 60573.82041931152, 51128.82028102875, 56251.280225753784, 55605.68033313751, 52753.593479156494, 55170.06011581421, 59144.58674621582, 57658.626892089844, 56623.76689147949, 52174.88675236702, 56733.42018890381, 58331.600021362305, 59170.62664794922, 57381.33346557617, 59197.246978759766, 55934.1404838562, 58256.36692941189, 56846.32684326172, 52768.993478775024, 57155.95372390747, 57092.56028366089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.735092282619892, "mean_inference_ms": 6.737888790706415, "mean_action_processing_ms": 0.19701399137606274, "mean_env_wait_ms": 231.15379964970222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07855224609375, "StateBufferConnector_ms": 0.006342252095540364, "ViewRequirementAgentConnector_ms": 0.22971216837565103}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.2702416254245, "num_env_steps_trained_throughput_per_sec": 274.2702416254245, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 14152.745, "sample_time_ms": 11300.968, "learn_time_ms": 2710.855, "learn_throughput": 1475.549, "synch_weights_time_ms": 140.257}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 5098, "training_iteration": 174, "trial_id": "32397_00000", "date": "2025-03-21_09-19-05", "timestamp": 1742548745, "time_this_iter_s": 14.633869171142578, "time_total_s": 2510.203476667404, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2510.203476667404, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 97.4681818181818, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.940596580505371, "policy_loss": -0.013091979548335075, "vf_loss": 9.95361328125, "vf_explained_var": 2.839912838226155e-07, "kl": 0.012043693102896214, "entropy": 0.3508487641811371, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": 61524.98043823242, "episode_reward_min": 51513.8535861969, "episode_reward_mean": 56907.53394109673, "episode_len_mean": 136.33333333333334, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"agent_0": 51513.8535861969}, "policy_reward_max": {"agent_0": 61524.98043823242}, "policy_reward_mean": {"agent_0": 56907.53394109673}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59623.62689590454, 55576.34019088745, 58428.6604385376, 56504.01998901367, 56560.48696184158, 60520.70016479492, 58125.94717025757, 59115.37375450134, 56292.31339645386, 61524.98043823242, 52624.553612947464, 57034.74010467529, 60596.446979522705, 51513.8535861969, 56888.366934776306, 54663.04001522064, 55850.066781044006, 52892.09352493286], "episode_lengths": [137, 135, 136, 136, 135, 137, 136, 137, 136, 138, 136, 137, 138, 135, 137, 136, 136, 136], "policy_agent_0_reward": [59623.62689590454, 55576.34019088745, 58428.6604385376, 56504.01998901367, 56560.48696184158, 60520.70016479492, 58125.94717025757, 59115.37375450134, 56292.31339645386, 61524.98043823242, 52624.553612947464, 57034.74010467529, 60596.446979522705, 51513.8535861969, 56888.366934776306, 54663.04001522064, 55850.066781044006, 52892.09352493286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.41080299565797, "mean_inference_ms": 6.851037844689474, "mean_action_processing_ms": 0.19763895622897715, "mean_env_wait_ms": 229.057581738433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041359000735812716, "StateBufferConnector_ms": 0.005867746141221788, "ViewRequirementAgentConnector_ms": 0.24297767215304905}}, "episode_reward_max": 61524.98043823242, "episode_reward_min": 51513.8535861969, "episode_reward_mean": 56907.53394109673, "episode_len_mean": 136.33333333333334, "episodes_this_iter": 18, "policy_reward_min": {"agent_0": 51513.8535861969}, "policy_reward_max": {"agent_0": 61524.98043823242}, "policy_reward_mean": {"agent_0": 56907.53394109673}, "hist_stats": {"episode_reward": [59623.62689590454, 55576.34019088745, 58428.6604385376, 56504.01998901367, 56560.48696184158, 60520.70016479492, 58125.94717025757, 59115.37375450134, 56292.31339645386, 61524.98043823242, 52624.553612947464, 57034.74010467529, 60596.446979522705, 51513.8535861969, 56888.366934776306, 54663.04001522064, 55850.066781044006, 52892.09352493286], "episode_lengths": [137, 135, 136, 136, 135, 137, 136, 137, 136, 138, 136, 137, 138, 135, 137, 136, 136, 136], "policy_agent_0_reward": [59623.62689590454, 55576.34019088745, 58428.6604385376, 56504.01998901367, 56560.48696184158, 60520.70016479492, 58125.94717025757, 59115.37375450134, 56292.31339645386, 61524.98043823242, 52624.553612947464, 57034.74010467529, 60596.446979522705, 51513.8535861969, 56888.366934776306, 54663.04001522064, 55850.066781044006, 52892.09352493286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.41080299565797, "mean_inference_ms": 6.851037844689474, "mean_action_processing_ms": 0.19763895622897715, "mean_env_wait_ms": 229.057581738433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041359000735812716, "StateBufferConnector_ms": 0.005867746141221788, "ViewRequirementAgentConnector_ms": 0.24297767215304905}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.0367017149354, "num_env_steps_trained_throughput_per_sec": 264.0367017149354, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 14216.946, "sample_time_ms": 11333.543, "learn_time_ms": 2747.268, "learn_throughput": 1455.992, "synch_weights_time_ms": 135.475}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 5116, "training_iteration": 175, "trial_id": "32397_00000", "date": "2025-03-21_09-19-20", "timestamp": 1742548760, "time_this_iter_s": 15.1941556930542, "time_total_s": 2525.3976323604584, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2525.3976323604584, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 99.32380952380953, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9859619140625, "policy_loss": -0.011664509773254395, "vf_loss": 9.99755859375, "vf_explained_var": -9.524325861320904e-08, "kl": 0.010934381745755672, "entropy": 0.3515971601009369, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": 52892.09352493286, "episode_reward_min": 52892.09352493286, "episode_reward_mean": 52892.09352493286, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52892.09352493286}, "policy_reward_max": {"agent_0": 52892.09352493286}, "policy_reward_mean": {"agent_0": 52892.09352493286}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52892.09352493286], "episode_lengths": [136], "policy_agent_0_reward": [52892.09352493286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.70543896498541, "mean_inference_ms": 6.595349103249603, "mean_action_processing_ms": 0.20472051160417695, "mean_env_wait_ms": 233.31439871805904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.15115737915039062}}, "episode_reward_max": 52892.09352493286, "episode_reward_min": 52892.09352493286, "episode_reward_mean": 52892.09352493286, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 52892.09352493286}, "policy_reward_max": {"agent_0": 52892.09352493286}, "policy_reward_mean": {"agent_0": 52892.09352493286}, "hist_stats": {"episode_reward": [52892.09352493286], "episode_lengths": [136], "policy_agent_0_reward": [52892.09352493286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.70543896498541, "mean_inference_ms": 6.595349103249603, "mean_action_processing_ms": 0.20472051160417695, "mean_env_wait_ms": 233.31439871805904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.15115737915039062}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.3204720174402, "num_env_steps_trained_throughput_per_sec": 317.3204720174402, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13807.714, "sample_time_ms": 10914.259, "learn_time_ms": 2755.658, "learn_throughput": 1451.559, "synch_weights_time_ms": 137.131}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 5116, "training_iteration": 176, "trial_id": "32397_00000", "date": "2025-03-21_09-19-33", "timestamp": 1742548773, "time_this_iter_s": 12.66775369644165, "time_total_s": 2538.0653860569, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb493130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2538.0653860569, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 99.63333333333335, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91445541381836, "policy_loss": -0.010898834094405174, "vf_loss": 9.92529296875, "vf_explained_var": 3.080814963141165e-07, "kl": 0.00973550509661436, "entropy": 0.3304767608642578, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 62177.11993408203, "episode_reward_min": 50416.19340133667, "episode_reward_mean": 57155.15531491836, "episode_len_mean": 135.96666666666667, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 50416.19340133667}, "policy_reward_max": {"agent_0": 62177.11993408203}, "policy_reward_mean": {"agent_0": 57155.15531491836}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60262.84048461914, 55376.046786785126, 52653.25347137451, 55575.973553180695, 54651.86679840088, 55346.32025909424, 58698.26689147949, 61327.82696533203, 55000.05356788635, 60470.473541259766, 59944.46694946289, 59731.55359649658, 59727.606548309326, 54934.66015434265, 59936.05355834961, 57652.00018310547, 53360.03343248367, 59128.48025512695, 55191.253467559814, 62177.11993408203, 56502.7735748291, 58880.300384521484, 60262.22708129883, 58286.026755690575, 58236.93355560303, 55019.40025520325, 53601.56014537811, 50416.19340133667, 55175.82689285278, 57127.26700210571], "episode_lengths": [136, 136, 135, 136, 135, 136, 135, 137, 136, 137, 137, 136, 137, 135, 137, 136, 136, 136, 137, 138, 135, 136, 136, 137, 137, 135, 134, 134, 135, 136], "policy_agent_0_reward": [60262.84048461914, 55376.046786785126, 52653.25347137451, 55575.973553180695, 54651.86679840088, 55346.32025909424, 58698.26689147949, 61327.82696533203, 55000.05356788635, 60470.473541259766, 59944.46694946289, 59731.55359649658, 59727.606548309326, 54934.66015434265, 59936.05355834961, 57652.00018310547, 53360.03343248367, 59128.48025512695, 55191.253467559814, 62177.11993408203, 56502.7735748291, 58880.300384521484, 60262.22708129883, 58286.026755690575, 58236.93355560303, 55019.40025520325, 53601.56014537811, 50416.19340133667, 55175.82689285278, 57127.26700210571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.587556308716735, "mean_inference_ms": 6.414558732943571, "mean_action_processing_ms": 0.20021204805314294, "mean_env_wait_ms": 219.09357254246416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05376497904459635, "StateBufferConnector_ms": 0.006277561187744141, "ViewRequirementAgentConnector_ms": 0.2152109146118164}}, "episode_reward_max": 62177.11993408203, "episode_reward_min": 50416.19340133667, "episode_reward_mean": 57155.15531491836, "episode_len_mean": 135.96666666666667, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 50416.19340133667}, "policy_reward_max": {"agent_0": 62177.11993408203}, "policy_reward_mean": {"agent_0": 57155.15531491836}, "hist_stats": {"episode_reward": [60262.84048461914, 55376.046786785126, 52653.25347137451, 55575.973553180695, 54651.86679840088, 55346.32025909424, 58698.26689147949, 61327.82696533203, 55000.05356788635, 60470.473541259766, 59944.46694946289, 59731.55359649658, 59727.606548309326, 54934.66015434265, 59936.05355834961, 57652.00018310547, 53360.03343248367, 59128.48025512695, 55191.253467559814, 62177.11993408203, 56502.7735748291, 58880.300384521484, 60262.22708129883, 58286.026755690575, 58236.93355560303, 55019.40025520325, 53601.56014537811, 50416.19340133667, 55175.82689285278, 57127.26700210571], "episode_lengths": [136, 136, 135, 136, 135, 136, 135, 137, 136, 137, 137, 136, 137, 135, 137, 136, 136, 136, 137, 138, 135, 136, 136, 137, 137, 135, 134, 134, 135, 136], "policy_agent_0_reward": [60262.84048461914, 55376.046786785126, 52653.25347137451, 55575.973553180695, 54651.86679840088, 55346.32025909424, 58698.26689147949, 61327.82696533203, 55000.05356788635, 60470.473541259766, 59944.46694946289, 59731.55359649658, 59727.606548309326, 54934.66015434265, 59936.05355834961, 57652.00018310547, 53360.03343248367, 59128.48025512695, 55191.253467559814, 62177.11993408203, 56502.7735748291, 58880.300384521484, 60262.22708129883, 58286.026755690575, 58236.93355560303, 55019.40025520325, 53601.56014537811, 50416.19340133667, 55175.82689285278, 57127.26700210571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.587556308716735, "mean_inference_ms": 6.414558732943571, "mean_action_processing_ms": 0.20021204805314294, "mean_env_wait_ms": 219.09357254246416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05376497904459635, "StateBufferConnector_ms": 0.006277561187744141, "ViewRequirementAgentConnector_ms": 0.2152109146118164}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.2795496806873, "num_env_steps_trained_throughput_per_sec": 314.2795496806873, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 13773.107, "sample_time_ms": 10891.549, "learn_time_ms": 2750.275, "learn_throughput": 1454.4, "synch_weights_time_ms": 130.595}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 5146, "training_iteration": 177, "trial_id": "32397_00000", "date": "2025-03-21_09-19-46", "timestamp": 1742548786, "time_this_iter_s": 12.784936428070068, "time_total_s": 2550.85032248497, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2550.85032248497, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 99.41111111111111, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.035714285714286, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91361141204834, "policy_loss": -0.012980526313185692, "vf_loss": 9.926514625549316, "vf_explained_var": 9.240582699021616e-07, "kl": 0.012351775541901588, "entropy": 0.3764921724796295, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": 60197.70684814453, "episode_reward_min": 50286.98703765869, "episode_reward_mean": 55621.60779961518, "episode_len_mean": 135.60714285714286, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 50286.98703765869}, "policy_reward_max": {"agent_0": 60197.70684814453}, "policy_reward_mean": {"agent_0": 55621.60779961518}, "custom_metrics": {"num_batches_mean": 5.035714285714286, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58873.34701538086, 53697.50011444092, 51366.94033050537, 57268.84020996094, 58658.0400428772, 52119.8268532753, 54570.99370741844, 52314.00011134148, 57662.380310058594, 54851.5733795166, 52537.62022638321, 57242.40697097778, 58327.44666099548, 50646.59358501434, 55575.20698547363, 58330.16017913818, 57448.77336883545, 50459.10008239746, 58638.88024139404, 59384.56678771973, 59142.9465713501, 60197.70684814453, 52407.86691093445, 50286.98703765869, 56528.086740493774, 57979.78002357483, 53998.84686279297, 56888.600231170654], "episode_lengths": [136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 134, 136, 136, 136, 133, 137, 137, 137, 137, 133, 135, 136, 136, 136, 136], "policy_agent_0_reward": [58873.34701538086, 53697.50011444092, 51366.94033050537, 57268.84020996094, 58658.0400428772, 52119.8268532753, 54570.99370741844, 52314.00011134148, 57662.380310058594, 54851.5733795166, 52537.62022638321, 57242.40697097778, 58327.44666099548, 50646.59358501434, 55575.20698547363, 58330.16017913818, 57448.77336883545, 50459.10008239746, 58638.88024139404, 59384.56678771973, 59142.9465713501, 60197.70684814453, 52407.86691093445, 50286.98703765869, 56528.086740493774, 57979.78002357483, 53998.84686279297, 56888.600231170654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.561938174668587, "mean_inference_ms": 6.613970741609065, "mean_action_processing_ms": 0.19690004052341953, "mean_env_wait_ms": 230.96802263184438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038823911121913364, "StateBufferConnector_ms": 0.0059664249420166016, "ViewRequirementAgentConnector_ms": 0.2740919589996338}}, "episode_reward_max": 60197.70684814453, "episode_reward_min": 50286.98703765869, "episode_reward_mean": 55621.60779961518, "episode_len_mean": 135.60714285714286, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 50286.98703765869}, "policy_reward_max": {"agent_0": 60197.70684814453}, "policy_reward_mean": {"agent_0": 55621.60779961518}, "hist_stats": {"episode_reward": [58873.34701538086, 53697.50011444092, 51366.94033050537, 57268.84020996094, 58658.0400428772, 52119.8268532753, 54570.99370741844, 52314.00011134148, 57662.380310058594, 54851.5733795166, 52537.62022638321, 57242.40697097778, 58327.44666099548, 50646.59358501434, 55575.20698547363, 58330.16017913818, 57448.77336883545, 50459.10008239746, 58638.88024139404, 59384.56678771973, 59142.9465713501, 60197.70684814453, 52407.86691093445, 50286.98703765869, 56528.086740493774, 57979.78002357483, 53998.84686279297, 56888.600231170654], "episode_lengths": [136, 135, 135, 135, 136, 136, 136, 135, 136, 135, 135, 136, 136, 134, 136, 136, 136, 133, 137, 137, 137, 137, 133, 135, 136, 136, 136, 136], "policy_agent_0_reward": [58873.34701538086, 53697.50011444092, 51366.94033050537, 57268.84020996094, 58658.0400428772, 52119.8268532753, 54570.99370741844, 52314.00011134148, 57662.380310058594, 54851.5733795166, 52537.62022638321, 57242.40697097778, 58327.44666099548, 50646.59358501434, 55575.20698547363, 58330.16017913818, 57448.77336883545, 50459.10008239746, 58638.88024139404, 59384.56678771973, 59142.9465713501, 60197.70684814453, 52407.86691093445, 50286.98703765869, 56528.086740493774, 57979.78002357483, 53998.84686279297, 56888.600231170654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.561938174668587, "mean_inference_ms": 6.613970741609065, "mean_action_processing_ms": 0.19690004052341953, "mean_env_wait_ms": 230.96802263184438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038823911121913364, "StateBufferConnector_ms": 0.0059664249420166016, "ViewRequirementAgentConnector_ms": 0.2740919589996338}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.25493261996763, "num_env_steps_trained_throughput_per_sec": 322.25493261996763, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 13704.57, "sample_time_ms": 10888.071, "learn_time_ms": 2688.46, "learn_throughput": 1487.841, "synch_weights_time_ms": 127.368}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 5174, "training_iteration": 178, "trial_id": "32397_00000", "date": "2025-03-21_09-19-58", "timestamp": 1742548798, "time_this_iter_s": 12.45846939086914, "time_total_s": 2563.3087918758392, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2563.3087918758392, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 98.75882352941176, "ram_util_percent": 13.541176470588237}}
{"custom_metrics": {"num_batches_mean": 5.666666666666667, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.824609756469727, "policy_loss": -0.010907215066254139, "vf_loss": 9.835450172424316, "vf_explained_var": 3.775581660647731e-07, "kl": 0.01045280136168003, "entropy": 0.3279561698436737, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": 62499.53356933594, "episode_reward_min": 47228.58684396744, "episode_reward_mean": 56905.470021749985, "episode_len_mean": 135.8939393939394, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {"agent_0": 47228.58684396744}, "policy_reward_max": {"agent_0": 62499.53356933594}, "policy_reward_mean": {"agent_0": 56905.470021749985}, "custom_metrics": {"num_batches_mean": 5.666666666666667, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53584.68015003204, 59341.32711791992, 56493.9599609375, 52028.30693984032, 56663.15344238281, 62041.79384613037, 57101.65343093872, 53062.60672187805, 58013.74699783325, 59428.56032562256, 59152.66706085205, 57673.16004943848, 62499.53356933594, 57989.77341270447, 58660.40017700195, 57743.90706253052, 59014.560455322266, 60011.49996948242, 60826.04699707031, 54468.11340713501, 59482.6336517334, 57374.82021331787, 51496.713552474976, 59971.84720993042, 59225.77367401123, 47408.420199394226, 62272.49378204346, 57813.42691040039, 52276.16681456566, 57047.56686401367, 55738.973423719406, 57572.87346291542, 58451.400382995605, 58079.807037353516, 56298.89364051819, 55760.12021231651, 56446.640209198, 57943.3468170166, 56444.46710205078, 59424.626861572266, 56624.886657714844, 60666.88053894043, 47228.58684396744, 55368.11365509033, 51128.860052108765, 53788.713530540466, 59640.827056884766, 58689.35348510742, 59039.83340072632, 58880.260272979736, 58847.72689819336, 60583.73377990723, 55466.24669075012, 53909.10016584396, 59306.83375930786, 57464.36009979248, 59410.873291015625, 50631.840265750885, 53622.56676340103, 58159.326889038086, 58058.56008338928, 50345.573550224304, 54532.75342512131, 58463.61354446411, 56353.1068687439, 57218.026750564575], "episode_lengths": [135, 137, 135, 136, 136, 138, 136, 135, 136, 136, 137, 136, 138, 136, 136, 136, 137, 137, 138, 135, 136, 135, 136, 137, 137, 135, 138, 135, 134, 138, 134, 137, 136, 135, 135, 135, 136, 135, 134, 137, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 137, 137, 136, 135, 137, 136, 136, 134, 135, 136, 137, 134, 135, 135, 135, 136], "policy_agent_0_reward": [53584.68015003204, 59341.32711791992, 56493.9599609375, 52028.30693984032, 56663.15344238281, 62041.79384613037, 57101.65343093872, 53062.60672187805, 58013.74699783325, 59428.56032562256, 59152.66706085205, 57673.16004943848, 62499.53356933594, 57989.77341270447, 58660.40017700195, 57743.90706253052, 59014.560455322266, 60011.49996948242, 60826.04699707031, 54468.11340713501, 59482.6336517334, 57374.82021331787, 51496.713552474976, 59971.84720993042, 59225.77367401123, 47408.420199394226, 62272.49378204346, 57813.42691040039, 52276.16681456566, 57047.56686401367, 55738.973423719406, 57572.87346291542, 58451.400382995605, 58079.807037353516, 56298.89364051819, 55760.12021231651, 56446.640209198, 57943.3468170166, 56444.46710205078, 59424.626861572266, 56624.886657714844, 60666.88053894043, 47228.58684396744, 55368.11365509033, 51128.860052108765, 53788.713530540466, 59640.827056884766, 58689.35348510742, 59039.83340072632, 58880.260272979736, 58847.72689819336, 60583.73377990723, 55466.24669075012, 53909.10016584396, 59306.83375930786, 57464.36009979248, 59410.873291015625, 50631.840265750885, 53622.56676340103, 58159.326889038086, 58058.56008338928, 50345.573550224304, 54532.75342512131, 58463.61354446411, 56353.1068687439, 57218.026750564575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.078311693022876, "mean_inference_ms": 6.81727844876435, "mean_action_processing_ms": 0.19715902495187615, "mean_env_wait_ms": 230.71876116593492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04180705908573035, "StateBufferConnector_ms": 0.005958658276182233, "ViewRequirementAgentConnector_ms": 0.17555952072143555}}, "episode_reward_max": 62499.53356933594, "episode_reward_min": 47228.58684396744, "episode_reward_mean": 56905.470021749985, "episode_len_mean": 135.8939393939394, "episodes_this_iter": 66, "policy_reward_min": {"agent_0": 47228.58684396744}, "policy_reward_max": {"agent_0": 62499.53356933594}, "policy_reward_mean": {"agent_0": 56905.470021749985}, "hist_stats": {"episode_reward": [53584.68015003204, 59341.32711791992, 56493.9599609375, 52028.30693984032, 56663.15344238281, 62041.79384613037, 57101.65343093872, 53062.60672187805, 58013.74699783325, 59428.56032562256, 59152.66706085205, 57673.16004943848, 62499.53356933594, 57989.77341270447, 58660.40017700195, 57743.90706253052, 59014.560455322266, 60011.49996948242, 60826.04699707031, 54468.11340713501, 59482.6336517334, 57374.82021331787, 51496.713552474976, 59971.84720993042, 59225.77367401123, 47408.420199394226, 62272.49378204346, 57813.42691040039, 52276.16681456566, 57047.56686401367, 55738.973423719406, 57572.87346291542, 58451.400382995605, 58079.807037353516, 56298.89364051819, 55760.12021231651, 56446.640209198, 57943.3468170166, 56444.46710205078, 59424.626861572266, 56624.886657714844, 60666.88053894043, 47228.58684396744, 55368.11365509033, 51128.860052108765, 53788.713530540466, 59640.827056884766, 58689.35348510742, 59039.83340072632, 58880.260272979736, 58847.72689819336, 60583.73377990723, 55466.24669075012, 53909.10016584396, 59306.83375930786, 57464.36009979248, 59410.873291015625, 50631.840265750885, 53622.56676340103, 58159.326889038086, 58058.56008338928, 50345.573550224304, 54532.75342512131, 58463.61354446411, 56353.1068687439, 57218.026750564575], "episode_lengths": [135, 137, 135, 136, 136, 138, 136, 135, 136, 136, 137, 136, 138, 136, 136, 136, 137, 137, 138, 135, 136, 135, 136, 137, 137, 135, 138, 135, 134, 138, 134, 137, 136, 135, 135, 135, 136, 135, 134, 137, 136, 136, 135, 135, 135, 136, 136, 136, 136, 136, 137, 137, 136, 135, 137, 136, 136, 134, 135, 136, 137, 134, 135, 135, 135, 136], "policy_agent_0_reward": [53584.68015003204, 59341.32711791992, 56493.9599609375, 52028.30693984032, 56663.15344238281, 62041.79384613037, 57101.65343093872, 53062.60672187805, 58013.74699783325, 59428.56032562256, 59152.66706085205, 57673.16004943848, 62499.53356933594, 57989.77341270447, 58660.40017700195, 57743.90706253052, 59014.560455322266, 60011.49996948242, 60826.04699707031, 54468.11340713501, 59482.6336517334, 57374.82021331787, 51496.713552474976, 59971.84720993042, 59225.77367401123, 47408.420199394226, 62272.49378204346, 57813.42691040039, 52276.16681456566, 57047.56686401367, 55738.973423719406, 57572.87346291542, 58451.400382995605, 58079.807037353516, 56298.89364051819, 55760.12021231651, 56446.640209198, 57943.3468170166, 56444.46710205078, 59424.626861572266, 56624.886657714844, 60666.88053894043, 47228.58684396744, 55368.11365509033, 51128.860052108765, 53788.713530540466, 59640.827056884766, 58689.35348510742, 59039.83340072632, 58880.260272979736, 58847.72689819336, 60583.73377990723, 55466.24669075012, 53909.10016584396, 59306.83375930786, 57464.36009979248, 59410.873291015625, 50631.840265750885, 53622.56676340103, 58159.326889038086, 58058.56008338928, 50345.573550224304, 54532.75342512131, 58463.61354446411, 56353.1068687439, 57218.026750564575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.078311693022876, "mean_inference_ms": 6.81727844876435, "mean_action_processing_ms": 0.19715902495187615, "mean_env_wait_ms": 230.71876116593492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04180705908573035, "StateBufferConnector_ms": 0.005958658276182233, "ViewRequirementAgentConnector_ms": 0.17555952072143555}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.82706602789864, "num_env_steps_trained_throughput_per_sec": 218.82706602789864, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 14122.577, "sample_time_ms": 11342.665, "learn_time_ms": 2653.105, "learn_throughput": 1507.667, "synch_weights_time_ms": 126.142}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 5240, "training_iteration": 179, "trial_id": "32397_00000", "date": "2025-03-21_09-20-16", "timestamp": 1742548816, "time_this_iter_s": 18.342747688293457, "time_total_s": 2581.6515395641327, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49d750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2581.6515395641327, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 98.42800000000001, "ram_util_percent": 13.504000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983194351196289, "policy_loss": -0.016893651336431503, "vf_loss": 10.0, "vf_explained_var": -2.0352503327103477e-07, "kl": 0.013998963870108128, "entropy": 0.32194384932518005, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 57218.026750564575, "episode_reward_min": 57218.026750564575, "episode_reward_mean": 57218.026750564575, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57218.026750564575}, "policy_reward_max": {"agent_0": 57218.026750564575}, "policy_reward_mean": {"agent_0": 57218.026750564575}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57218.026750564575], "episode_lengths": [136], "policy_agent_0_reward": [57218.026750564575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.90431835323047, "mean_inference_ms": 6.604052064389246, "mean_action_processing_ms": 0.19318376209207763, "mean_env_wait_ms": 229.7598035532385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04029273986816406, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.1727581024169922}}, "episode_reward_max": 57218.026750564575, "episode_reward_min": 57218.026750564575, "episode_reward_mean": 57218.026750564575, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57218.026750564575}, "policy_reward_max": {"agent_0": 57218.026750564575}, "policy_reward_mean": {"agent_0": 57218.026750564575}, "hist_stats": {"episode_reward": [57218.026750564575], "episode_lengths": [136], "policy_agent_0_reward": [57218.026750564575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.90431835323047, "mean_inference_ms": 6.604052064389246, "mean_action_processing_ms": 0.19318376209207763, "mean_env_wait_ms": 229.7598035532385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04029273986816406, "StateBufferConnector_ms": 0.006222724914550781, "ViewRequirementAgentConnector_ms": 0.1727581024169922}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.01142190385895, "num_env_steps_trained_throughput_per_sec": 315.01142190385895, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13767.359, "sample_time_ms": 10972.952, "learn_time_ms": 2665.355, "learn_throughput": 1500.738, "synch_weights_time_ms": 128.395}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 5240, "training_iteration": 180, "trial_id": "32397_00000", "date": "2025-03-21_09-20-29", "timestamp": 1742548829, "time_this_iter_s": 12.762062549591064, "time_total_s": 2594.4136021137238, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb490700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2594.4136021137238, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 99.59444444444446, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.937390327453613, "policy_loss": -0.012893587350845337, "vf_loss": 9.9501953125, "vf_explained_var": -4.916141165267618e-07, "kl": 0.014036862179636955, "entropy": 0.4032187759876251, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": 61136.56033325195, "episode_reward_min": 45814.57346582413, "episode_reward_mean": 56236.68621394038, "episode_len_mean": 135.6, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 45814.57346582413}, "policy_reward_max": {"agent_0": 61136.56033325195}, "policy_reward_mean": {"agent_0": 56236.68621394038}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51858.626918792725, 57296.3133764267, 56197.33361816406, 55816.393674850464, 60811.206939697266, 52899.20003128052, 59268.767181396484, 55333.05345916748, 57126.553619384766, 59535.72665596008, 55227.213349699974, 59614.913513183594, 57960.599947452545, 61136.56033325195, 56079.320362091064, 52405.98036766052, 55314.566928863525, 56888.43359375, 45814.57346582413, 58148.38694190979], "episode_lengths": [134, 136, 134, 135, 137, 135, 136, 135, 136, 136, 135, 137, 136, 138, 135, 136, 135, 135, 134, 137], "policy_agent_0_reward": [51858.626918792725, 57296.3133764267, 56197.33361816406, 55816.393674850464, 60811.206939697266, 52899.20003128052, 59268.767181396484, 55333.05345916748, 57126.553619384766, 59535.72665596008, 55227.213349699974, 59614.913513183594, 57960.599947452545, 61136.56033325195, 56079.320362091064, 52405.98036766052, 55314.566928863525, 56888.43359375, 45814.57346582413, 58148.38694190979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.535386634503553, "mean_inference_ms": 6.440192319335528, "mean_action_processing_ms": 0.19995968677864295, "mean_env_wait_ms": 219.66970056285422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04317164421081543, "StateBufferConnector_ms": 0.028208494186401367, "ViewRequirementAgentConnector_ms": 0.18251419067382812}}, "episode_reward_max": 61136.56033325195, "episode_reward_min": 45814.57346582413, "episode_reward_mean": 56236.68621394038, "episode_len_mean": 135.6, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 45814.57346582413}, "policy_reward_max": {"agent_0": 61136.56033325195}, "policy_reward_mean": {"agent_0": 56236.68621394038}, "hist_stats": {"episode_reward": [51858.626918792725, 57296.3133764267, 56197.33361816406, 55816.393674850464, 60811.206939697266, 52899.20003128052, 59268.767181396484, 55333.05345916748, 57126.553619384766, 59535.72665596008, 55227.213349699974, 59614.913513183594, 57960.599947452545, 61136.56033325195, 56079.320362091064, 52405.98036766052, 55314.566928863525, 56888.43359375, 45814.57346582413, 58148.38694190979], "episode_lengths": [134, 136, 134, 135, 137, 135, 136, 135, 136, 136, 135, 137, 136, 138, 135, 136, 135, 135, 134, 137], "policy_agent_0_reward": [51858.626918792725, 57296.3133764267, 56197.33361816406, 55816.393674850464, 60811.206939697266, 52899.20003128052, 59268.767181396484, 55333.05345916748, 57126.553619384766, 59535.72665596008, 55227.213349699974, 59614.913513183594, 57960.599947452545, 61136.56033325195, 56079.320362091064, 52405.98036766052, 55314.566928863525, 56888.43359375, 45814.57346582413, 58148.38694190979]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.535386634503553, "mean_inference_ms": 6.440192319335528, "mean_action_processing_ms": 0.19995968677864295, "mean_env_wait_ms": 219.66970056285422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04317164421081543, "StateBufferConnector_ms": 0.028208494186401367, "ViewRequirementAgentConnector_ms": 0.18251419067382812}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6095839330612, "num_env_steps_trained_throughput_per_sec": 299.6095839330612, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 13846.561, "sample_time_ms": 11036.509, "learn_time_ms": 2683.937, "learn_throughput": 1490.348, "synch_weights_time_ms": 125.451}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 5260, "training_iteration": 181, "trial_id": "32397_00000", "date": "2025-03-21_09-20-43", "timestamp": 1742548843, "time_this_iter_s": 13.398124694824219, "time_total_s": 2607.811726808548, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922b400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2607.811726808548, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 98.60000000000002, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.956435203552246, "policy_loss": -0.014110768213868141, "vf_loss": 9.970458984375, "vf_explained_var": -1.648440957069397e-07, "kl": 0.013858121819794178, "entropy": 0.36737167835235596, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": 59973.893630981445, "episode_reward_min": 52549.480281829834, "episode_reward_mean": 57323.38687465588, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 52549.480281829834}, "policy_reward_max": {"agent_0": 59973.893630981445}, "policy_reward_mean": {"agent_0": 57323.38687465588}, "custom_metrics": {"num_batches_mean": 5.75, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [52549.480281829834, 57760.86018180847, 59973.893630981445, 59737.6335144043, 55158.12696671486, 55638.81334686279, 58554.093353271484, 55364.60681152344, 56580.44689941406, 58290.88038396835, 59040.033504486084, 59231.77362060547], "episode_lengths": [135, 136, 137, 137, 135, 136, 136, 135, 136, 136, 137, 136], "policy_agent_0_reward": [52549.480281829834, 57760.86018180847, 59973.893630981445, 59737.6335144043, 55158.12696671486, 55638.81334686279, 58554.093353271484, 55364.60681152344, 56580.44689941406, 58290.88038396835, 59040.033504486084, 59231.77362060547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.92943403801691, "mean_inference_ms": 6.3740396650456255, "mean_action_processing_ms": 0.20047623880575907, "mean_env_wait_ms": 218.5007423025198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0409384568532308, "StateBufferConnector_ms": 0.006878376007080078, "ViewRequirementAgentConnector_ms": 0.17230709393819174}}, "episode_reward_max": 59973.893630981445, "episode_reward_min": 52549.480281829834, "episode_reward_mean": 57323.38687465588, "episode_len_mean": 136.0, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 52549.480281829834}, "policy_reward_max": {"agent_0": 59973.893630981445}, "policy_reward_mean": {"agent_0": 57323.38687465588}, "hist_stats": {"episode_reward": [52549.480281829834, 57760.86018180847, 59973.893630981445, 59737.6335144043, 55158.12696671486, 55638.81334686279, 58554.093353271484, 55364.60681152344, 56580.44689941406, 58290.88038396835, 59040.033504486084, 59231.77362060547], "episode_lengths": [135, 136, 137, 137, 135, 136, 136, 135, 136, 136, 137, 136], "policy_agent_0_reward": [52549.480281829834, 57760.86018180847, 59973.893630981445, 59737.6335144043, 55158.12696671486, 55638.81334686279, 58554.093353271484, 55364.60681152344, 56580.44689941406, 58290.88038396835, 59040.033504486084, 59231.77362060547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.92943403801691, "mean_inference_ms": 6.3740396650456255, "mean_action_processing_ms": 0.20047623880575907, "mean_env_wait_ms": 218.5007423025198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0409384568532308, "StateBufferConnector_ms": 0.006878376007080078, "ViewRequirementAgentConnector_ms": 0.17230709393819174}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.37058320890503, "num_env_steps_trained_throughput_per_sec": 277.37058320890503, "timesteps_total": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 14049.612, "sample_time_ms": 11175.377, "learn_time_ms": 2743.512, "learn_throughput": 1457.985, "synch_weights_time_ms": 130.051}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 5272, "training_iteration": 182, "trial_id": "32397_00000", "date": "2025-03-21_09-20-57", "timestamp": 1742548857, "time_this_iter_s": 14.485121250152588, "time_total_s": 2622.2968480587006, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922a440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2622.2968480587006, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 99.53157894736844, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.195652173913044, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.750926971435547, "policy_loss": -0.015274807810783386, "vf_loss": 9.76611328125, "vf_explained_var": 7.821867598067911e-07, "kl": 0.013977826572954655, "entropy": 0.3362487256526947, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 62588.20687866211, "episode_reward_min": 43735.593476355076, "episode_reward_mean": 56430.82700454606, "episode_len_mean": 135.84782608695653, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43735.593476355076}, "policy_reward_max": {"agent_0": 62588.20687866211}, "policy_reward_mean": {"agent_0": 56430.82700454606}, "custom_metrics": {"num_batches_mean": 5.195652173913044, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56289.54015159607, 54574.0734539032, 60699.153564453125, 50660.45998835564, 60731.06674194336, 58975.32719421387, 53672.38688468933, 59280.11349487305, 49038.83340859413, 54301.639921188354, 62588.20687866211, 56377.893463134766, 56716.10680389404, 57036.58698272705, 53892.946910858154, 57026.68020629883, 58650.740173339844, 58374.14024353027, 56513.77338600159, 51306.226764678955, 57060.59355163574, 59510.49369812012, 56612.260410785675, 60831.11346435547, 58399.48671722412, 54071.1802239418, 58651.473388671875, 48564.18008804321, 59584.87353515625, 53942.51348686218, 54425.8400015831, 59248.57345581055, 56982.58679533005, 51036.55992627144, 58423.03329086304, 59155.893463134766, 58394.82076263428, 56192.32693481445, 56839.32682418823, 52413.61345863342, 51244.04675865173, 56780.94688796997, 47970.42677116394, 57366.81367492676, 55287.39370346069, 57577.18037033081, 58445.21356201172, 56771.98016357422, 56917.426834106445, 56025.380056381226, 43735.593476355076, 57872.973403930664, 57696.80687713623, 52883.49360656738, 61090.820068359375, 57987.7201461792, 59034.37353515625, 55508.76675605774, 53012.70671272278, 55211.3200378418, 60271.26713562012, 55319.16019773483, 55640.606884002686, 58201.246841430664, 60413.64047241211, 56029.01351571083, 59569.57360839844, 56714.1003036499, 59134.42727661133, 60811.06024169922, 58260.33351135254, 57823.26664352417, 62369.74035644531, 55328.560208678246, 58888.99362182617, 52932.85353946686, 55156.540180683136, 53825.70676612854, 60739.36011886597, 60829.6335144043, 56972.5201625824, 55929.23356628418, 58140.64026641846, 52496.9334936142, 54732.66675186157, 57963.30032348633, 48636.553298950195, 58119.546827316284, 59063.07349395752, 49495.96031951904, 60426.026916503906, 55932.52056121826], "episode_lengths": [136, 134, 138, 135, 138, 136, 135, 136, 135, 135, 138, 136, 135, 137, 135, 135, 136, 136, 135, 135, 134, 137, 134, 137, 136, 135, 136, 135, 137, 135, 136, 136, 135, 135, 136, 136, 137, 136, 137, 136, 135, 135, 135, 136, 136, 136, 135, 135, 137, 136, 134, 136, 136, 135, 137, 136, 137, 135, 135, 134, 136, 136, 135, 136, 137, 136, 136, 137, 137, 137, 136, 136, 138, 135, 137, 134, 136, 134, 137, 138, 137, 135, 136, 135, 136, 137, 136, 135, 136, 136, 137, 135], "policy_agent_0_reward": [56289.54015159607, 54574.0734539032, 60699.153564453125, 50660.45998835564, 60731.06674194336, 58975.32719421387, 53672.38688468933, 59280.11349487305, 49038.83340859413, 54301.639921188354, 62588.20687866211, 56377.893463134766, 56716.10680389404, 57036.58698272705, 53892.946910858154, 57026.68020629883, 58650.740173339844, 58374.14024353027, 56513.77338600159, 51306.226764678955, 57060.59355163574, 59510.49369812012, 56612.260410785675, 60831.11346435547, 58399.48671722412, 54071.1802239418, 58651.473388671875, 48564.18008804321, 59584.87353515625, 53942.51348686218, 54425.8400015831, 59248.57345581055, 56982.58679533005, 51036.55992627144, 58423.03329086304, 59155.893463134766, 58394.82076263428, 56192.32693481445, 56839.32682418823, 52413.61345863342, 51244.04675865173, 56780.94688796997, 47970.42677116394, 57366.81367492676, 55287.39370346069, 57577.18037033081, 58445.21356201172, 56771.98016357422, 56917.426834106445, 56025.380056381226, 43735.593476355076, 57872.973403930664, 57696.80687713623, 52883.49360656738, 61090.820068359375, 57987.7201461792, 59034.37353515625, 55508.76675605774, 53012.70671272278, 55211.3200378418, 60271.26713562012, 55319.16019773483, 55640.606884002686, 58201.246841430664, 60413.64047241211, 56029.01351571083, 59569.57360839844, 56714.1003036499, 59134.42727661133, 60811.06024169922, 58260.33351135254, 57823.26664352417, 62369.74035644531, 55328.560208678246, 58888.99362182617, 52932.85353946686, 55156.540180683136, 53825.70676612854, 60739.36011886597, 60829.6335144043, 56972.5201625824, 55929.23356628418, 58140.64026641846, 52496.9334936142, 54732.66675186157, 57963.30032348633, 48636.553298950195, 58119.546827316284, 59063.07349395752, 49495.96031951904, 60426.026916503906, 55932.52056121826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.628828282181438, "mean_inference_ms": 6.765441284339257, "mean_action_processing_ms": 0.19686496677856435, "mean_env_wait_ms": 231.11610954137075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04941898843516474, "StateBufferConnector_ms": 0.005983269732931386, "ViewRequirementAgentConnector_ms": 0.24220632470172385}}, "episode_reward_max": 62588.20687866211, "episode_reward_min": 43735.593476355076, "episode_reward_mean": 56430.82700454606, "episode_len_mean": 135.84782608695653, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 43735.593476355076}, "policy_reward_max": {"agent_0": 62588.20687866211}, "policy_reward_mean": {"agent_0": 56430.82700454606}, "hist_stats": {"episode_reward": [56289.54015159607, 54574.0734539032, 60699.153564453125, 50660.45998835564, 60731.06674194336, 58975.32719421387, 53672.38688468933, 59280.11349487305, 49038.83340859413, 54301.639921188354, 62588.20687866211, 56377.893463134766, 56716.10680389404, 57036.58698272705, 53892.946910858154, 57026.68020629883, 58650.740173339844, 58374.14024353027, 56513.77338600159, 51306.226764678955, 57060.59355163574, 59510.49369812012, 56612.260410785675, 60831.11346435547, 58399.48671722412, 54071.1802239418, 58651.473388671875, 48564.18008804321, 59584.87353515625, 53942.51348686218, 54425.8400015831, 59248.57345581055, 56982.58679533005, 51036.55992627144, 58423.03329086304, 59155.893463134766, 58394.82076263428, 56192.32693481445, 56839.32682418823, 52413.61345863342, 51244.04675865173, 56780.94688796997, 47970.42677116394, 57366.81367492676, 55287.39370346069, 57577.18037033081, 58445.21356201172, 56771.98016357422, 56917.426834106445, 56025.380056381226, 43735.593476355076, 57872.973403930664, 57696.80687713623, 52883.49360656738, 61090.820068359375, 57987.7201461792, 59034.37353515625, 55508.76675605774, 53012.70671272278, 55211.3200378418, 60271.26713562012, 55319.16019773483, 55640.606884002686, 58201.246841430664, 60413.64047241211, 56029.01351571083, 59569.57360839844, 56714.1003036499, 59134.42727661133, 60811.06024169922, 58260.33351135254, 57823.26664352417, 62369.74035644531, 55328.560208678246, 58888.99362182617, 52932.85353946686, 55156.540180683136, 53825.70676612854, 60739.36011886597, 60829.6335144043, 56972.5201625824, 55929.23356628418, 58140.64026641846, 52496.9334936142, 54732.66675186157, 57963.30032348633, 48636.553298950195, 58119.546827316284, 59063.07349395752, 49495.96031951904, 60426.026916503906, 55932.52056121826], "episode_lengths": [136, 134, 138, 135, 138, 136, 135, 136, 135, 135, 138, 136, 135, 137, 135, 135, 136, 136, 135, 135, 134, 137, 134, 137, 136, 135, 136, 135, 137, 135, 136, 136, 135, 135, 136, 136, 137, 136, 137, 136, 135, 135, 135, 136, 136, 136, 135, 135, 137, 136, 134, 136, 136, 135, 137, 136, 137, 135, 135, 134, 136, 136, 135, 136, 137, 136, 136, 137, 137, 137, 136, 136, 138, 135, 137, 134, 136, 134, 137, 138, 137, 135, 136, 135, 136, 137, 136, 135, 136, 136, 137, 135], "policy_agent_0_reward": [56289.54015159607, 54574.0734539032, 60699.153564453125, 50660.45998835564, 60731.06674194336, 58975.32719421387, 53672.38688468933, 59280.11349487305, 49038.83340859413, 54301.639921188354, 62588.20687866211, 56377.893463134766, 56716.10680389404, 57036.58698272705, 53892.946910858154, 57026.68020629883, 58650.740173339844, 58374.14024353027, 56513.77338600159, 51306.226764678955, 57060.59355163574, 59510.49369812012, 56612.260410785675, 60831.11346435547, 58399.48671722412, 54071.1802239418, 58651.473388671875, 48564.18008804321, 59584.87353515625, 53942.51348686218, 54425.8400015831, 59248.57345581055, 56982.58679533005, 51036.55992627144, 58423.03329086304, 59155.893463134766, 58394.82076263428, 56192.32693481445, 56839.32682418823, 52413.61345863342, 51244.04675865173, 56780.94688796997, 47970.42677116394, 57366.81367492676, 55287.39370346069, 57577.18037033081, 58445.21356201172, 56771.98016357422, 56917.426834106445, 56025.380056381226, 43735.593476355076, 57872.973403930664, 57696.80687713623, 52883.49360656738, 61090.820068359375, 57987.7201461792, 59034.37353515625, 55508.76675605774, 53012.70671272278, 55211.3200378418, 60271.26713562012, 55319.16019773483, 55640.606884002686, 58201.246841430664, 60413.64047241211, 56029.01351571083, 59569.57360839844, 56714.1003036499, 59134.42727661133, 60811.06024169922, 58260.33351135254, 57823.26664352417, 62369.74035644531, 55328.560208678246, 58888.99362182617, 52932.85353946686, 55156.540180683136, 53825.70676612854, 60739.36011886597, 60829.6335144043, 56972.5201625824, 55929.23356628418, 58140.64026641846, 52496.9334936142, 54732.66675186157, 57963.30032348633, 48636.553298950195, 58119.546827316284, 59063.07349395752, 49495.96031951904, 60426.026916503906, 55932.52056121826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.628828282181438, "mean_inference_ms": 6.765441284339257, "mean_action_processing_ms": 0.19686496677856435, "mean_env_wait_ms": 231.11610954137075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04941898843516474, "StateBufferConnector_ms": 0.005983269732931386, "ViewRequirementAgentConnector_ms": 0.24220632470172385}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.7928434804495, "num_env_steps_trained_throughput_per_sec": 236.7928434804495, "timesteps_total": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 14312.026, "sample_time_ms": 11419.024, "learn_time_ms": 2758.336, "learn_throughput": 1450.15, "synch_weights_time_ms": 133.992}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 5364, "training_iteration": 183, "trial_id": "32397_00000", "date": "2025-03-21_09-21-14", "timestamp": 1742548874, "time_this_iter_s": 16.950117826461792, "time_total_s": 2639.2469658851624, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922a830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2639.2469658851624, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 97.56521739130434, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987451553344727, "policy_loss": -0.012628858909010887, "vf_loss": 10.0, "vf_explained_var": 2.3966034490285892e-08, "kl": 0.012751479633152485, "entropy": 0.32391947507858276, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "sampler_results": {"episode_reward_max": 55932.52056121826, "episode_reward_min": 55932.52056121826, "episode_reward_mean": 55932.52056121826, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55932.52056121826}, "policy_reward_max": {"agent_0": 55932.52056121826}, "policy_reward_mean": {"agent_0": 55932.52056121826}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55932.52056121826], "episode_lengths": [135], "policy_agent_0_reward": [55932.52056121826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.36373270219435, "mean_inference_ms": 6.599103832521678, "mean_action_processing_ms": 0.19293814892448904, "mean_env_wait_ms": 230.29144058175433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03917217254638672, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1619100570678711}}, "episode_reward_max": 55932.52056121826, "episode_reward_min": 55932.52056121826, "episode_reward_mean": 55932.52056121826, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55932.52056121826}, "policy_reward_max": {"agent_0": 55932.52056121826}, "policy_reward_mean": {"agent_0": 55932.52056121826}, "hist_stats": {"episode_reward": [55932.52056121826], "episode_lengths": [135], "policy_agent_0_reward": [55932.52056121826]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.36373270219435, "mean_inference_ms": 6.599103832521678, "mean_action_processing_ms": 0.19293814892448904, "mean_env_wait_ms": 230.29144058175433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03917217254638672, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1619100570678711}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.69016062423157, "num_env_steps_trained_throughput_per_sec": 321.69016062423157, "timesteps_total": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 14097.045, "sample_time_ms": 11169.423, "learn_time_ms": 2790.193, "learn_throughput": 1433.593, "synch_weights_time_ms": 136.756}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "episodes_total": 5364, "training_iteration": 184, "trial_id": "32397_00000", "date": "2025-03-21_09-21-27", "timestamp": 1742548887, "time_this_iter_s": 12.490315675735474, "time_total_s": 2651.737281560898, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922a680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2651.737281560898, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 99.61111111111113, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.958149909973145, "policy_loss": -0.012382219545543194, "vf_loss": 9.970459938049316, "vf_explained_var": -3.537784039053804e-07, "kl": 0.011639511212706566, "entropy": 0.3225754201412201, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "sampler_results": {"episode_reward_max": 61610.96060180664, "episode_reward_min": 51096.76681667566, "episode_reward_mean": 55815.474044946335, "episode_len_mean": 135.58333333333334, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 51096.76681667566}, "policy_reward_max": {"agent_0": 61610.96060180664}, "policy_reward_mean": {"agent_0": 55815.474044946335}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57860.49341392517, 57424.32665061951, 51973.84702566266, 51096.76681667566, 57355.82667541504, 57320.153693675995, 52779.72671127319, 61610.96060180664, 56740.28685760498, 56797.299797058105, 51738.00679206848, 57087.99350357056], "episode_lengths": [136, 135, 135, 135, 135, 136, 135, 137, 137, 136, 135, 135], "policy_agent_0_reward": [57860.49341392517, 57424.32665061951, 51973.84702566266, 51096.76681667566, 57355.82667541504, 57320.153693675995, 52779.72671127319, 61610.96060180664, 56740.28685760498, 56797.299797058105, 51738.00679206848, 57087.99350357056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.927201719182012, "mean_inference_ms": 6.411186767491285, "mean_action_processing_ms": 0.19981205391823978, "mean_env_wait_ms": 218.7166376325524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03825624783833822, "StateBufferConnector_ms": 0.0058909257253011065, "ViewRequirementAgentConnector_ms": 0.24701952934265137}}, "episode_reward_max": 61610.96060180664, "episode_reward_min": 51096.76681667566, "episode_reward_mean": 55815.474044946335, "episode_len_mean": 135.58333333333334, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 51096.76681667566}, "policy_reward_max": {"agent_0": 61610.96060180664}, "policy_reward_mean": {"agent_0": 55815.474044946335}, "hist_stats": {"episode_reward": [57860.49341392517, 57424.32665061951, 51973.84702566266, 51096.76681667566, 57355.82667541504, 57320.153693675995, 52779.72671127319, 61610.96060180664, 56740.28685760498, 56797.299797058105, 51738.00679206848, 57087.99350357056], "episode_lengths": [136, 135, 135, 135, 135, 136, 135, 137, 137, 136, 135, 135], "policy_agent_0_reward": [57860.49341392517, 57424.32665061951, 51973.84702566266, 51096.76681667566, 57355.82667541504, 57320.153693675995, 52779.72671127319, 61610.96060180664, 56740.28685760498, 56797.299797058105, 51738.00679206848, 57087.99350357056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.927201719182012, "mean_inference_ms": 6.411186767491285, "mean_action_processing_ms": 0.19981205391823978, "mean_env_wait_ms": 218.7166376325524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03825624783833822, "StateBufferConnector_ms": 0.0058909257253011065, "ViewRequirementAgentConnector_ms": 0.24701952934265137}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.57310326127214, "num_env_steps_trained_throughput_per_sec": 325.57310326127214, "timesteps_total": 740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 740000, "timers": {"training_iteration_time_ms": 13810.705, "sample_time_ms": 10908.654, "learn_time_ms": 2763.747, "learn_throughput": 1447.31, "synch_weights_time_ms": 137.611}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 740000, "num_agent_steps_trained": 740000}, "done": false, "episodes_total": 5376, "training_iteration": 185, "trial_id": "32397_00000", "date": "2025-03-21_09-21-39", "timestamp": 1742548899, "time_this_iter_s": 12.337127685546875, "time_total_s": 2664.0744092464447, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922b400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2664.0744092464447, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 99.31764705882352, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.35, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.935221672058105, "policy_loss": -0.012408969923853874, "vf_loss": 9.947562217712402, "vf_explained_var": -4.547275693767006e-06, "kl": 0.01072460412979126, "entropy": 0.2809968888759613, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 61584.45358276367, "episode_reward_min": 45311.58001804352, "episode_reward_mean": 56386.39552895725, "episode_len_mean": 135.75, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 45311.58001804352}, "policy_reward_max": {"agent_0": 61584.45358276367}, "policy_reward_mean": {"agent_0": 56386.39552895725}, "custom_metrics": {"num_batches_mean": 5.35, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55645.70010089874, 57286.34008026123, 57130.62022590637, 52650.826847076416, 57725.86715221405, 45311.58001804352, 57320.2068939209, 56677.23993110657, 56609.50689125061, 55923.89356994629, 56855.80676460266, 56833.64029824734, 54270.80704307556, 51875.240226745605, 59526.139907836914, 57686.58721834421, 58628.12698364258, 60174.42678833008, 61584.45358276367, 58010.90005493164], "episode_lengths": [136, 136, 136, 135, 137, 133, 136, 135, 136, 135, 136, 135, 134, 135, 137, 136, 137, 136, 138, 136], "policy_agent_0_reward": [55645.70010089874, 57286.34008026123, 57130.62022590637, 52650.826847076416, 57725.86715221405, 45311.58001804352, 57320.2068939209, 56677.23993110657, 56609.50689125061, 55923.89356994629, 56855.80676460266, 56833.64029824734, 54270.80704307556, 51875.240226745605, 59526.139907836914, 57686.58721834421, 58628.12698364258, 60174.42678833008, 61584.45358276367, 58010.90005493164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.82789837030503, "mean_inference_ms": 6.410067761870623, "mean_action_processing_ms": 0.20007213137984414, "mean_env_wait_ms": 219.42582478991625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08053898811340332, "StateBufferConnector_ms": 0.006104707717895508, "ViewRequirementAgentConnector_ms": 0.17341256141662598}}, "episode_reward_max": 61584.45358276367, "episode_reward_min": 45311.58001804352, "episode_reward_mean": 56386.39552895725, "episode_len_mean": 135.75, "episodes_this_iter": 20, "policy_reward_min": {"agent_0": 45311.58001804352}, "policy_reward_max": {"agent_0": 61584.45358276367}, "policy_reward_mean": {"agent_0": 56386.39552895725}, "hist_stats": {"episode_reward": [55645.70010089874, 57286.34008026123, 57130.62022590637, 52650.826847076416, 57725.86715221405, 45311.58001804352, 57320.2068939209, 56677.23993110657, 56609.50689125061, 55923.89356994629, 56855.80676460266, 56833.64029824734, 54270.80704307556, 51875.240226745605, 59526.139907836914, 57686.58721834421, 58628.12698364258, 60174.42678833008, 61584.45358276367, 58010.90005493164], "episode_lengths": [136, 136, 136, 135, 137, 133, 136, 135, 136, 135, 136, 135, 134, 135, 137, 136, 137, 136, 138, 136], "policy_agent_0_reward": [55645.70010089874, 57286.34008026123, 57130.62022590637, 52650.826847076416, 57725.86715221405, 45311.58001804352, 57320.2068939209, 56677.23993110657, 56609.50689125061, 55923.89356994629, 56855.80676460266, 56833.64029824734, 54270.80704307556, 51875.240226745605, 59526.139907836914, 57686.58721834421, 58628.12698364258, 60174.42678833008, 61584.45358276367, 58010.90005493164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.82789837030503, "mean_inference_ms": 6.410067761870623, "mean_action_processing_ms": 0.20007213137984414, "mean_env_wait_ms": 219.42582478991625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08053898811340332, "StateBufferConnector_ms": 0.006104707717895508, "ViewRequirementAgentConnector_ms": 0.17341256141662598}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.1533338952038, "num_env_steps_trained_throughput_per_sec": 251.1533338952038, "timesteps_total": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 14142.801, "sample_time_ms": 11219.366, "learn_time_ms": 2785.15, "learn_throughput": 1436.189, "synch_weights_time_ms": 137.61}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 5396, "training_iteration": 186, "trial_id": "32397_00000", "date": "2025-03-21_09-21-55", "timestamp": 1742548915, "time_this_iter_s": 15.974430322647095, "time_total_s": 2680.048839569092, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f9229d80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2680.048839569092, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 99.34761904761906, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.759374618530273, "policy_loss": -0.012203930877149105, "vf_loss": 9.771503448486328, "vf_explained_var": 8.204331152228406e-07, "kl": 0.012065357528626919, "entropy": 0.26205316185951233, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "sampler_results": {"episode_reward_max": 61072.53356933594, "episode_reward_min": 50547.1933555603, "episode_reward_mean": 57206.51967742812, "episode_len_mean": 135.9673913043478, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50547.1933555603}, "policy_reward_max": {"agent_0": 61072.53356933594}, "policy_reward_mean": {"agent_0": 57206.51967742812}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56109.94023513794, 53969.2534866333, 59952.040267944336, 55800.0135345459, 55141.73342132568, 59678.1533203125, 60834.94689941406, 52835.75352072716, 59337.140075683594, 56336.66674041748, 57414.82015132904, 55434.12014389038, 57722.25338745117, 58556.126625061035, 56813.70670127869, 56159.500383377075, 56243.12009239197, 54243.34705162048, 56551.580057144165, 53774.200125694275, 58283.76015472412, 58708.667006492615, 58740.72004699707, 57398.95371246338, 51831.706941604614, 57061.593463897705, 58060.24021911621, 57041.706926465034, 57273.98011779785, 58776.80042266846, 55978.580223083496, 58646.41997528076, 59646.92010498047, 58480.09372711182, 59190.273597717285, 59534.28672790527, 60445.00015258789, 51715.13333463669, 57581.02021789551, 59186.60691833496, 57081.5334854126, 50547.1933555603, 54083.14001083374, 59684.91354370117, 59360.3536529541, 55528.420236587524, 58665.806816101074, 53804.953550606966, 60874.2600402832, 57211.64031600952, 59996.007004737854, 57194.633361816406, 58213.43367767334, 57919.226959228516, 53497.91337585449, 56621.700355529785, 58346.386810302734, 56878.813371658325, 50660.70666265488, 60816.966888427734, 54867.93358373642, 58166.053705215454, 52961.50660133362, 55713.02695465088, 54444.16021156311, 58355.9605140686, 60315.25344848633, 52710.333532333374, 61072.53356933594, 58941.62033081055, 58526.19357299805, 50725.32691478729, 57200.02004241943, 59323.767028808594, 55767.42662239075, 58886.533264160156, 59664.78674316406, 58965.2336730957, 58256.22007751465, 52034.340145111084, 59059.00030517578, 58832.11344909668, 58945.16683959961, 56341.96036529541, 60523.00701904297, 54739.086641311646, 59017.987129211426, 59381.81358337402, 60801.033599853516, 58514.140075683594, 60865.16696166992, 55602.22012901306], "episode_lengths": [136, 136, 137, 136, 135, 137, 137, 135, 137, 136, 136, 136, 136, 137, 135, 135, 136, 135, 136, 135, 137, 137, 136, 137, 135, 136, 136, 137, 136, 136, 136, 136, 137, 136, 137, 137, 137, 134, 135, 136, 136, 135, 135, 136, 136, 136, 136, 136, 137, 135, 136, 137, 137, 135, 135, 135, 136, 136, 134, 137, 135, 137, 135, 136, 135, 137, 137, 135, 137, 136, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 136, 135, 136, 135, 137, 135, 137, 136, 137, 137, 137, 136], "policy_agent_0_reward": [56109.94023513794, 53969.2534866333, 59952.040267944336, 55800.0135345459, 55141.73342132568, 59678.1533203125, 60834.94689941406, 52835.75352072716, 59337.140075683594, 56336.66674041748, 57414.82015132904, 55434.12014389038, 57722.25338745117, 58556.126625061035, 56813.70670127869, 56159.500383377075, 56243.12009239197, 54243.34705162048, 56551.580057144165, 53774.200125694275, 58283.76015472412, 58708.667006492615, 58740.72004699707, 57398.95371246338, 51831.706941604614, 57061.593463897705, 58060.24021911621, 57041.706926465034, 57273.98011779785, 58776.80042266846, 55978.580223083496, 58646.41997528076, 59646.92010498047, 58480.09372711182, 59190.273597717285, 59534.28672790527, 60445.00015258789, 51715.13333463669, 57581.02021789551, 59186.60691833496, 57081.5334854126, 50547.1933555603, 54083.14001083374, 59684.91354370117, 59360.3536529541, 55528.420236587524, 58665.806816101074, 53804.953550606966, 60874.2600402832, 57211.64031600952, 59996.007004737854, 57194.633361816406, 58213.43367767334, 57919.226959228516, 53497.91337585449, 56621.700355529785, 58346.386810302734, 56878.813371658325, 50660.70666265488, 60816.966888427734, 54867.93358373642, 58166.053705215454, 52961.50660133362, 55713.02695465088, 54444.16021156311, 58355.9605140686, 60315.25344848633, 52710.333532333374, 61072.53356933594, 58941.62033081055, 58526.19357299805, 50725.32691478729, 57200.02004241943, 59323.767028808594, 55767.42662239075, 58886.533264160156, 59664.78674316406, 58965.2336730957, 58256.22007751465, 52034.340145111084, 59059.00030517578, 58832.11344909668, 58945.16683959961, 56341.96036529541, 60523.00701904297, 54739.086641311646, 59017.987129211426, 59381.81358337402, 60801.033599853516, 58514.140075683594, 60865.16696166992, 55602.22012901306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.62429218462665, "mean_inference_ms": 6.764902312870503, "mean_action_processing_ms": 0.19677295387256707, "mean_env_wait_ms": 231.2446158133453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04543195600095003, "StateBufferConnector_ms": 0.006037691365117612, "ViewRequirementAgentConnector_ms": 0.22517002147176993}}, "episode_reward_max": 61072.53356933594, "episode_reward_min": 50547.1933555603, "episode_reward_mean": 57206.51967742812, "episode_len_mean": 135.9673913043478, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 50547.1933555603}, "policy_reward_max": {"agent_0": 61072.53356933594}, "policy_reward_mean": {"agent_0": 57206.51967742812}, "hist_stats": {"episode_reward": [56109.94023513794, 53969.2534866333, 59952.040267944336, 55800.0135345459, 55141.73342132568, 59678.1533203125, 60834.94689941406, 52835.75352072716, 59337.140075683594, 56336.66674041748, 57414.82015132904, 55434.12014389038, 57722.25338745117, 58556.126625061035, 56813.70670127869, 56159.500383377075, 56243.12009239197, 54243.34705162048, 56551.580057144165, 53774.200125694275, 58283.76015472412, 58708.667006492615, 58740.72004699707, 57398.95371246338, 51831.706941604614, 57061.593463897705, 58060.24021911621, 57041.706926465034, 57273.98011779785, 58776.80042266846, 55978.580223083496, 58646.41997528076, 59646.92010498047, 58480.09372711182, 59190.273597717285, 59534.28672790527, 60445.00015258789, 51715.13333463669, 57581.02021789551, 59186.60691833496, 57081.5334854126, 50547.1933555603, 54083.14001083374, 59684.91354370117, 59360.3536529541, 55528.420236587524, 58665.806816101074, 53804.953550606966, 60874.2600402832, 57211.64031600952, 59996.007004737854, 57194.633361816406, 58213.43367767334, 57919.226959228516, 53497.91337585449, 56621.700355529785, 58346.386810302734, 56878.813371658325, 50660.70666265488, 60816.966888427734, 54867.93358373642, 58166.053705215454, 52961.50660133362, 55713.02695465088, 54444.16021156311, 58355.9605140686, 60315.25344848633, 52710.333532333374, 61072.53356933594, 58941.62033081055, 58526.19357299805, 50725.32691478729, 57200.02004241943, 59323.767028808594, 55767.42662239075, 58886.533264160156, 59664.78674316406, 58965.2336730957, 58256.22007751465, 52034.340145111084, 59059.00030517578, 58832.11344909668, 58945.16683959961, 56341.96036529541, 60523.00701904297, 54739.086641311646, 59017.987129211426, 59381.81358337402, 60801.033599853516, 58514.140075683594, 60865.16696166992, 55602.22012901306], "episode_lengths": [136, 136, 137, 136, 135, 137, 137, 135, 137, 136, 136, 136, 136, 137, 135, 135, 136, 135, 136, 135, 137, 137, 136, 137, 135, 136, 136, 137, 136, 136, 136, 136, 137, 136, 137, 137, 137, 134, 135, 136, 136, 135, 135, 136, 136, 136, 136, 136, 137, 135, 136, 137, 137, 135, 135, 135, 136, 136, 134, 137, 135, 137, 135, 136, 135, 137, 137, 135, 137, 136, 136, 135, 135, 136, 135, 136, 136, 136, 136, 135, 136, 135, 136, 135, 137, 135, 137, 136, 137, 137, 137, 136], "policy_agent_0_reward": [56109.94023513794, 53969.2534866333, 59952.040267944336, 55800.0135345459, 55141.73342132568, 59678.1533203125, 60834.94689941406, 52835.75352072716, 59337.140075683594, 56336.66674041748, 57414.82015132904, 55434.12014389038, 57722.25338745117, 58556.126625061035, 56813.70670127869, 56159.500383377075, 56243.12009239197, 54243.34705162048, 56551.580057144165, 53774.200125694275, 58283.76015472412, 58708.667006492615, 58740.72004699707, 57398.95371246338, 51831.706941604614, 57061.593463897705, 58060.24021911621, 57041.706926465034, 57273.98011779785, 58776.80042266846, 55978.580223083496, 58646.41997528076, 59646.92010498047, 58480.09372711182, 59190.273597717285, 59534.28672790527, 60445.00015258789, 51715.13333463669, 57581.02021789551, 59186.60691833496, 57081.5334854126, 50547.1933555603, 54083.14001083374, 59684.91354370117, 59360.3536529541, 55528.420236587524, 58665.806816101074, 53804.953550606966, 60874.2600402832, 57211.64031600952, 59996.007004737854, 57194.633361816406, 58213.43367767334, 57919.226959228516, 53497.91337585449, 56621.700355529785, 58346.386810302734, 56878.813371658325, 50660.70666265488, 60816.966888427734, 54867.93358373642, 58166.053705215454, 52961.50660133362, 55713.02695465088, 54444.16021156311, 58355.9605140686, 60315.25344848633, 52710.333532333374, 61072.53356933594, 58941.62033081055, 58526.19357299805, 50725.32691478729, 57200.02004241943, 59323.767028808594, 55767.42662239075, 58886.533264160156, 59664.78674316406, 58965.2336730957, 58256.22007751465, 52034.340145111084, 59059.00030517578, 58832.11344909668, 58945.16683959961, 56341.96036529541, 60523.00701904297, 54739.086641311646, 59017.987129211426, 59381.81358337402, 60801.033599853516, 58514.140075683594, 60865.16696166992, 55602.22012901306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.62429218462665, "mean_inference_ms": 6.764902312870503, "mean_action_processing_ms": 0.19677295387256707, "mean_env_wait_ms": 231.2446158133453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04543195600095003, "StateBufferConnector_ms": 0.006037691365117612, "ViewRequirementAgentConnector_ms": 0.22517002147176993}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.78304848311, "num_env_steps_trained_throughput_per_sec": 240.78304848311, "timesteps_total": 748000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 748000, "timers": {"training_iteration_time_ms": 14531.296, "sample_time_ms": 11549.909, "learn_time_ms": 2835.227, "learn_throughput": 1410.822, "synch_weights_time_ms": 145.501}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 748000, "num_agent_steps_trained": 748000}, "done": false, "episodes_total": 5488, "training_iteration": 187, "trial_id": "32397_00000", "date": "2025-03-21_09-22-12", "timestamp": 1742548932, "time_this_iter_s": 16.66624879837036, "time_total_s": 2696.715088367462, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922a710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2696.715088367462, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 97.04090909090907, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986956596374512, "policy_loss": -0.013124551624059677, "vf_loss": 10.0, "vf_explained_var": -5.042863449489232e-06, "kl": 0.013136673718690872, "entropy": 0.33106935024261475, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "sampler_results": {"episode_reward_max": 55602.22012901306, "episode_reward_min": 55602.22012901306, "episode_reward_mean": 55602.22012901306, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55602.22012901306}, "policy_reward_max": {"agent_0": 55602.22012901306}, "policy_reward_mean": {"agent_0": 55602.22012901306}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55602.22012901306], "episode_lengths": [136], "policy_agent_0_reward": [55602.22012901306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.24394815647313, "mean_inference_ms": 6.589714168207587, "mean_action_processing_ms": 0.19272216280600182, "mean_env_wait_ms": 230.40742515621326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035262107849121094, "StateBufferConnector_ms": 0.005340576171875, "ViewRequirementAgentConnector_ms": 0.4511833190917969}}, "episode_reward_max": 55602.22012901306, "episode_reward_min": 55602.22012901306, "episode_reward_mean": 55602.22012901306, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55602.22012901306}, "policy_reward_max": {"agent_0": 55602.22012901306}, "policy_reward_mean": {"agent_0": 55602.22012901306}, "hist_stats": {"episode_reward": [55602.22012901306], "episode_lengths": [136], "policy_agent_0_reward": [55602.22012901306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.24394815647313, "mean_inference_ms": 6.589714168207587, "mean_action_processing_ms": 0.19272216280600182, "mean_env_wait_ms": 230.40742515621326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035262107849121094, "StateBufferConnector_ms": 0.005340576171875, "ViewRequirementAgentConnector_ms": 0.4511833190917969}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.24242413417096, "num_env_steps_trained_throughput_per_sec": 295.24242413417096, "timesteps_total": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 14644.862, "sample_time_ms": 11574.89, "learn_time_ms": 2915.173, "learn_throughput": 1372.131, "synch_weights_time_ms": 154.141}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "episodes_total": 5488, "training_iteration": 188, "trial_id": "32397_00000", "date": "2025-03-21_09-22-26", "timestamp": 1742548946, "time_this_iter_s": 13.603657007217407, "time_total_s": 2710.3187453746796, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922b400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2710.3187453746796, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 99.55263157894737, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.975658416748047, "policy_loss": -0.014197278767824173, "vf_loss": 9.989749908447266, "vf_explained_var": 4.15307766843398e-07, "kl": 0.016808073967695236, "entropy": 0.3704262375831604, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 60328.893646240234, "episode_reward_min": 54948.38692474365, "episode_reward_mean": 57794.26857757568, "episode_len_mean": 136.25, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 54948.38692474365}, "policy_reward_max": {"agent_0": 60328.893646240234}, "policy_reward_mean": {"agent_0": 57794.26857757568}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57717.086906433105, 54948.38692474365, 60328.893646240234, 58182.70683288574], "episode_lengths": [136, 136, 137, 136], "policy_agent_0_reward": [57717.086906433105, 54948.38692474365, 60328.893646240234, 58182.70683288574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.011730972258242, "mean_inference_ms": 6.332642071214231, "mean_action_processing_ms": 0.19593196214869757, "mean_env_wait_ms": 218.16654759899626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0565648078918457, "StateBufferConnector_ms": 0.005561113357543945, "ViewRequirementAgentConnector_ms": 0.26293396949768066}}, "episode_reward_max": 60328.893646240234, "episode_reward_min": 54948.38692474365, "episode_reward_mean": 57794.26857757568, "episode_len_mean": 136.25, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 54948.38692474365}, "policy_reward_max": {"agent_0": 60328.893646240234}, "policy_reward_mean": {"agent_0": 57794.26857757568}, "hist_stats": {"episode_reward": [57717.086906433105, 54948.38692474365, 60328.893646240234, 58182.70683288574], "episode_lengths": [136, 136, 137, 136], "policy_agent_0_reward": [57717.086906433105, 54948.38692474365, 60328.893646240234, 58182.70683288574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.011730972258242, "mean_inference_ms": 6.332642071214231, "mean_action_processing_ms": 0.19593196214869757, "mean_env_wait_ms": 218.16654759899626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0565648078918457, "StateBufferConnector_ms": 0.005561113357543945, "ViewRequirementAgentConnector_ms": 0.26293396949768066}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.94230808465403, "num_env_steps_trained_throughput_per_sec": 298.94230808465403, "timesteps_total": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 14154.985, "sample_time_ms": 11041.382, "learn_time_ms": 2956.009, "learn_throughput": 1353.176, "synch_weights_time_ms": 156.935}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 5492, "training_iteration": 189, "trial_id": "32397_00000", "date": "2025-03-21_09-22-39", "timestamp": 1742548959, "time_this_iter_s": 13.435861110687256, "time_total_s": 2723.754606485367, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922add0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2723.754606485367, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 99.6263157894737, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.91673755645752, "policy_loss": -0.013023501262068748, "vf_loss": 9.9296875, "vf_explained_var": 2.2947787670091202e-07, "kl": 0.01181863248348236, "entropy": 0.3631555140018463, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "sampler_results": {"episode_reward_max": 61056.67349243164, "episode_reward_min": 55546.606939315796, "episode_reward_mean": 58266.780455998014, "episode_len_mean": 136.53571428571428, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 55546.606939315796}, "policy_reward_max": {"agent_0": 61056.67349243164}, "policy_reward_mean": {"agent_0": 58266.780455998014}, "custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59086.82696533203, 56687.52022743225, 60125.54724121094, 57901.81304168701, 56284.86677932739, 57151.92676925659, 59633.480407714844, 59081.400314331055, 58954.67349243164, 56916.233642578125, 57098.599944114685, 56270.653537750244, 59295.16052246094, 57359.24644470215, 58424.55352783203, 56954.39365005493, 56919.33331108093, 55546.606939315796, 57194.76680278778, 60842.160400390625, 58604.62673950195, 61056.67349243164, 57128.07347488403, 60166.447021484375, 57357.086990356445, 59352.507064819336, 60664.74714279175, 59409.92687988281], "episode_lengths": [137, 136, 137, 136, 135, 137, 137, 136, 137, 137, 137, 137, 136, 136, 136, 136, 136, 136, 137, 138, 136, 137, 136, 137, 136, 137, 138, 136], "policy_agent_0_reward": [59086.82696533203, 56687.52022743225, 60125.54724121094, 57901.81304168701, 56284.86677932739, 57151.92676925659, 59633.480407714844, 59081.400314331055, 58954.67349243164, 56916.233642578125, 57098.599944114685, 56270.653537750244, 59295.16052246094, 57359.24644470215, 58424.55352783203, 56954.39365005493, 56919.33331108093, 55546.606939315796, 57194.76680278778, 60842.160400390625, 58604.62673950195, 61056.67349243164, 57128.07347488403, 60166.447021484375, 57357.086990356445, 59352.507064819336, 60664.74714279175, 59409.92687988281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.77702068004542, "mean_inference_ms": 6.421855171549567, "mean_action_processing_ms": 0.20038814081060405, "mean_env_wait_ms": 219.36416461136054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041736023766653876, "StateBufferConnector_ms": 0.0064100537981305805, "ViewRequirementAgentConnector_ms": 0.22159133638654435}}, "episode_reward_max": 61056.67349243164, "episode_reward_min": 55546.606939315796, "episode_reward_mean": 58266.780455998014, "episode_len_mean": 136.53571428571428, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 55546.606939315796}, "policy_reward_max": {"agent_0": 61056.67349243164}, "policy_reward_mean": {"agent_0": 58266.780455998014}, "hist_stats": {"episode_reward": [59086.82696533203, 56687.52022743225, 60125.54724121094, 57901.81304168701, 56284.86677932739, 57151.92676925659, 59633.480407714844, 59081.400314331055, 58954.67349243164, 56916.233642578125, 57098.599944114685, 56270.653537750244, 59295.16052246094, 57359.24644470215, 58424.55352783203, 56954.39365005493, 56919.33331108093, 55546.606939315796, 57194.76680278778, 60842.160400390625, 58604.62673950195, 61056.67349243164, 57128.07347488403, 60166.447021484375, 57357.086990356445, 59352.507064819336, 60664.74714279175, 59409.92687988281], "episode_lengths": [137, 136, 137, 136, 135, 137, 137, 136, 137, 137, 137, 137, 136, 136, 136, 136, 136, 136, 137, 138, 136, 137, 136, 137, 136, 137, 138, 136], "policy_agent_0_reward": [59086.82696533203, 56687.52022743225, 60125.54724121094, 57901.81304168701, 56284.86677932739, 57151.92676925659, 59633.480407714844, 59081.400314331055, 58954.67349243164, 56916.233642578125, 57098.599944114685, 56270.653537750244, 59295.16052246094, 57359.24644470215, 58424.55352783203, 56954.39365005493, 56919.33331108093, 55546.606939315796, 57194.76680278778, 60842.160400390625, 58604.62673950195, 61056.67349243164, 57128.07347488403, 60166.447021484375, 57357.086990356445, 59352.507064819336, 60664.74714279175, 59409.92687988281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.77702068004542, "mean_inference_ms": 6.421855171549567, "mean_action_processing_ms": 0.20038814081060405, "mean_env_wait_ms": 219.36416461136054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041736023766653876, "StateBufferConnector_ms": 0.0064100537981305805, "ViewRequirementAgentConnector_ms": 0.22159133638654435}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.6451628890142, "num_env_steps_trained_throughput_per_sec": 248.6451628890142, "timesteps_total": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 14493.906, "sample_time_ms": 11369.992, "learn_time_ms": 2965.3, "learn_throughput": 1348.936, "synch_weights_time_ms": 157.951}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "episodes_total": 5520, "training_iteration": 190, "trial_id": "32397_00000", "date": "2025-03-21_09-22-55", "timestamp": 1742548975, "time_this_iter_s": 16.14592981338501, "time_total_s": 2739.900536298752, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f9229c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2739.900536298752, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 99.33999999999999, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.806478500366211, "policy_loss": -0.01146311592310667, "vf_loss": 9.81787109375, "vf_explained_var": -1.621743024315947e-07, "kl": 0.01122501865029335, "entropy": 0.2821011245250702, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "sampler_results": {"episode_reward_max": 61803.66680908203, "episode_reward_min": 51156.29345417023, "episode_reward_mean": 56877.552149837145, "episode_len_mean": 135.94520547945206, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 51156.29345417023}, "policy_reward_max": {"agent_0": 61803.66680908203}, "policy_reward_mean": {"agent_0": 56877.552149837145}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [61560.00704956055, 54753.33341217041, 57518.180713653564, 58792.72007751465, 55068.540159225464, 61803.66680908203, 57611.32678985596, 56604.17347717285, 61335.546783447266, 54479.513624191284, 54123.866894841194, 56609.3535118103, 61164.38009643555, 59006.10015106201, 59980.333435058594, 56854.646659851074, 57135.26052856445, 61412.06675720215, 56947.8268737793, 53234.85348320007, 58900.06011009216, 56591.91349411011, 55385.86696624756, 53567.10678219795, 60547.126953125, 56939.106689453125, 58317.44682312012, 54514.0267534256, 53367.886627197266, 60399.42694091797, 56216.74021911621, 54052.54694747925, 58658.28042602539, 59709.09343671799, 53588.9667930603, 60643.04022216797, 53025.44661664963, 59205.12685394287, 54843.35995101929, 55148.24023962021, 55733.8335981369, 59951.987045288086, 59662.13338470459, 60723.666931152344, 58420.49349975586, 55415.526666641235, 55363.21336746216, 54131.50685310364, 60954.28698730469, 55058.44670677185, 54983.98702335358, 61144.266998291016, 53130.33341217041, 52557.040172576904, 56472.84029006958, 51156.29345417023, 60216.78704071045, 56895.566818237305, 55463.4603472352, 59130.32653808594, 52645.46671104431, 57053.840465545654, 55571.426694869995, 54332.760219573975, 56147.22025299072, 56587.100158691406, 58361.34689331055, 54357.233629226685, 57411.200256347656, 55371.11353111267, 58785.77365112305, 52430.073333740234, 56824.24687194824], "episode_lengths": [138, 136, 137, 137, 136, 138, 136, 136, 138, 136, 134, 136, 137, 136, 137, 136, 136, 138, 136, 135, 137, 136, 135, 135, 137, 137, 136, 135, 134, 137, 136, 135, 136, 137, 135, 137, 135, 137, 135, 135, 135, 137, 136, 137, 136, 136, 135, 136, 137, 135, 135, 137, 136, 135, 136, 135, 137, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 137, 134, 136], "policy_agent_0_reward": [61560.00704956055, 54753.33341217041, 57518.180713653564, 58792.72007751465, 55068.540159225464, 61803.66680908203, 57611.32678985596, 56604.17347717285, 61335.546783447266, 54479.513624191284, 54123.866894841194, 56609.3535118103, 61164.38009643555, 59006.10015106201, 59980.333435058594, 56854.646659851074, 57135.26052856445, 61412.06675720215, 56947.8268737793, 53234.85348320007, 58900.06011009216, 56591.91349411011, 55385.86696624756, 53567.10678219795, 60547.126953125, 56939.106689453125, 58317.44682312012, 54514.0267534256, 53367.886627197266, 60399.42694091797, 56216.74021911621, 54052.54694747925, 58658.28042602539, 59709.09343671799, 53588.9667930603, 60643.04022216797, 53025.44661664963, 59205.12685394287, 54843.35995101929, 55148.24023962021, 55733.8335981369, 59951.987045288086, 59662.13338470459, 60723.666931152344, 58420.49349975586, 55415.526666641235, 55363.21336746216, 54131.50685310364, 60954.28698730469, 55058.44670677185, 54983.98702335358, 61144.266998291016, 53130.33341217041, 52557.040172576904, 56472.84029006958, 51156.29345417023, 60216.78704071045, 56895.566818237305, 55463.4603472352, 59130.32653808594, 52645.46671104431, 57053.840465545654, 55571.426694869995, 54332.760219573975, 56147.22025299072, 56587.100158691406, 58361.34689331055, 54357.233629226685, 57411.200256347656, 55371.11353111267, 58785.77365112305, 52430.073333740234, 56824.24687194824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.686858187552076, "mean_inference_ms": 6.7642117199298175, "mean_action_processing_ms": 0.196838682159334, "mean_env_wait_ms": 231.89680332199316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04408163567111917, "StateBufferConnector_ms": 0.006040481671895066, "ViewRequirementAgentConnector_ms": 0.2042087790084212}}, "episode_reward_max": 61803.66680908203, "episode_reward_min": 51156.29345417023, "episode_reward_mean": 56877.552149837145, "episode_len_mean": 135.94520547945206, "episodes_this_iter": 73, "policy_reward_min": {"agent_0": 51156.29345417023}, "policy_reward_max": {"agent_0": 61803.66680908203}, "policy_reward_mean": {"agent_0": 56877.552149837145}, "hist_stats": {"episode_reward": [61560.00704956055, 54753.33341217041, 57518.180713653564, 58792.72007751465, 55068.540159225464, 61803.66680908203, 57611.32678985596, 56604.17347717285, 61335.546783447266, 54479.513624191284, 54123.866894841194, 56609.3535118103, 61164.38009643555, 59006.10015106201, 59980.333435058594, 56854.646659851074, 57135.26052856445, 61412.06675720215, 56947.8268737793, 53234.85348320007, 58900.06011009216, 56591.91349411011, 55385.86696624756, 53567.10678219795, 60547.126953125, 56939.106689453125, 58317.44682312012, 54514.0267534256, 53367.886627197266, 60399.42694091797, 56216.74021911621, 54052.54694747925, 58658.28042602539, 59709.09343671799, 53588.9667930603, 60643.04022216797, 53025.44661664963, 59205.12685394287, 54843.35995101929, 55148.24023962021, 55733.8335981369, 59951.987045288086, 59662.13338470459, 60723.666931152344, 58420.49349975586, 55415.526666641235, 55363.21336746216, 54131.50685310364, 60954.28698730469, 55058.44670677185, 54983.98702335358, 61144.266998291016, 53130.33341217041, 52557.040172576904, 56472.84029006958, 51156.29345417023, 60216.78704071045, 56895.566818237305, 55463.4603472352, 59130.32653808594, 52645.46671104431, 57053.840465545654, 55571.426694869995, 54332.760219573975, 56147.22025299072, 56587.100158691406, 58361.34689331055, 54357.233629226685, 57411.200256347656, 55371.11353111267, 58785.77365112305, 52430.073333740234, 56824.24687194824], "episode_lengths": [138, 136, 137, 137, 136, 138, 136, 136, 138, 136, 134, 136, 137, 136, 137, 136, 136, 138, 136, 135, 137, 136, 135, 135, 137, 137, 136, 135, 134, 137, 136, 135, 136, 137, 135, 137, 135, 137, 135, 135, 135, 137, 136, 137, 136, 136, 135, 136, 137, 135, 135, 137, 136, 135, 136, 135, 137, 135, 135, 136, 135, 136, 135, 135, 135, 135, 136, 136, 135, 136, 137, 134, 136], "policy_agent_0_reward": [61560.00704956055, 54753.33341217041, 57518.180713653564, 58792.72007751465, 55068.540159225464, 61803.66680908203, 57611.32678985596, 56604.17347717285, 61335.546783447266, 54479.513624191284, 54123.866894841194, 56609.3535118103, 61164.38009643555, 59006.10015106201, 59980.333435058594, 56854.646659851074, 57135.26052856445, 61412.06675720215, 56947.8268737793, 53234.85348320007, 58900.06011009216, 56591.91349411011, 55385.86696624756, 53567.10678219795, 60547.126953125, 56939.106689453125, 58317.44682312012, 54514.0267534256, 53367.886627197266, 60399.42694091797, 56216.74021911621, 54052.54694747925, 58658.28042602539, 59709.09343671799, 53588.9667930603, 60643.04022216797, 53025.44661664963, 59205.12685394287, 54843.35995101929, 55148.24023962021, 55733.8335981369, 59951.987045288086, 59662.13338470459, 60723.666931152344, 58420.49349975586, 55415.526666641235, 55363.21336746216, 54131.50685310364, 60954.28698730469, 55058.44670677185, 54983.98702335358, 61144.266998291016, 53130.33341217041, 52557.040172576904, 56472.84029006958, 51156.29345417023, 60216.78704071045, 56895.566818237305, 55463.4603472352, 59130.32653808594, 52645.46671104431, 57053.840465545654, 55571.426694869995, 54332.760219573975, 56147.22025299072, 56587.100158691406, 58361.34689331055, 54357.233629226685, 57411.200256347656, 55371.11353111267, 58785.77365112305, 52430.073333740234, 56824.24687194824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.686858187552076, "mean_inference_ms": 6.7642117199298175, "mean_action_processing_ms": 0.196838682159334, "mean_env_wait_ms": 231.89680332199316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04408163567111917, "StateBufferConnector_ms": 0.006040481671895066, "ViewRequirementAgentConnector_ms": 0.2042087790084212}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.28461654152267, "num_env_steps_trained_throughput_per_sec": 275.28461654152267, "timesteps_total": 764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 764000, "timers": {"training_iteration_time_ms": 14611.877, "sample_time_ms": 11534.858, "learn_time_ms": 2919.435, "learn_throughput": 1370.128, "synch_weights_time_ms": 156.932}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 764000, "num_agent_steps_trained": 764000}, "done": false, "episodes_total": 5593, "training_iteration": 191, "trial_id": "32397_00000", "date": "2025-03-21_09-23-10", "timestamp": 1742548990, "time_this_iter_s": 14.576789379119873, "time_total_s": 2754.4773256778717, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922a710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2754.4773256778717, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 97.325, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.939677238464355, "policy_loss": -0.013041054829955101, "vf_loss": 9.95263671875, "vf_explained_var": 2.424543197321327e-07, "kl": 0.012974174693226814, "entropy": 0.29018262028694153, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 61441.006896972656, "episode_reward_min": 52112.86671257019, "episode_reward_mean": 56588.041540836035, "episode_len_mean": 135.94736842105263, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 52112.86671257019}, "policy_reward_max": {"agent_0": 61441.006896972656}, "policy_reward_mean": {"agent_0": 56588.041540836035}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55959.93989944458, 54719.03339099884, 55991.20029449463, 61441.006896972656, 56380.926834106445, 58167.36032104492, 57083.91338348389, 57984.40686869621, 58181.28685569763, 59022.00015258789, 52112.86671257019, 55908.6266784668, 58374.28019142151, 59620.3536529541, 54856.86013793945, 53709.93334674835, 52209.720213890076, 57862.753452301025, 55586.31999206543], "episode_lengths": [136, 136, 135, 138, 137, 136, 136, 137, 136, 136, 135, 135, 136, 136, 136, 135, 136, 137, 134], "policy_agent_0_reward": [55959.93989944458, 54719.03339099884, 55991.20029449463, 61441.006896972656, 56380.926834106445, 58167.36032104492, 57083.91338348389, 57984.40686869621, 58181.28685569763, 59022.00015258789, 52112.86671257019, 55908.6266784668, 58374.28019142151, 59620.3536529541, 54856.86013793945, 53709.93334674835, 52209.720213890076, 57862.753452301025, 55586.31999206543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46547836526539, "mean_inference_ms": 6.797609624911272, "mean_action_processing_ms": 0.19625000338815557, "mean_env_wait_ms": 229.97945944434147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04767995131643195, "StateBufferConnector_ms": 0.006176296033357319, "ViewRequirementAgentConnector_ms": 0.16220117870130038}}, "episode_reward_max": 61441.006896972656, "episode_reward_min": 52112.86671257019, "episode_reward_mean": 56588.041540836035, "episode_len_mean": 135.94736842105263, "episodes_this_iter": 19, "policy_reward_min": {"agent_0": 52112.86671257019}, "policy_reward_max": {"agent_0": 61441.006896972656}, "policy_reward_mean": {"agent_0": 56588.041540836035}, "hist_stats": {"episode_reward": [55959.93989944458, 54719.03339099884, 55991.20029449463, 61441.006896972656, 56380.926834106445, 58167.36032104492, 57083.91338348389, 57984.40686869621, 58181.28685569763, 59022.00015258789, 52112.86671257019, 55908.6266784668, 58374.28019142151, 59620.3536529541, 54856.86013793945, 53709.93334674835, 52209.720213890076, 57862.753452301025, 55586.31999206543], "episode_lengths": [136, 136, 135, 138, 137, 136, 136, 137, 136, 136, 135, 135, 136, 136, 136, 135, 136, 137, 134], "policy_agent_0_reward": [55959.93989944458, 54719.03339099884, 55991.20029449463, 61441.006896972656, 56380.926834106445, 58167.36032104492, 57083.91338348389, 57984.40686869621, 58181.28685569763, 59022.00015258789, 52112.86671257019, 55908.6266784668, 58374.28019142151, 59620.3536529541, 54856.86013793945, 53709.93334674835, 52209.720213890076, 57862.753452301025, 55586.31999206543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.46547836526539, "mean_inference_ms": 6.797609624911272, "mean_action_processing_ms": 0.19625000338815557, "mean_env_wait_ms": 229.97945944434147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04767995131643195, "StateBufferConnector_ms": 0.006176296033357319, "ViewRequirementAgentConnector_ms": 0.16220117870130038}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.11587243675683, "num_env_steps_trained_throughput_per_sec": 275.11587243675683, "timesteps_total": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 14623.696, "sample_time_ms": 11635.599, "learn_time_ms": 2833.783, "learn_throughput": 1411.54, "synch_weights_time_ms": 153.621}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 5612, "training_iteration": 192, "trial_id": "32397_00000", "date": "2025-03-21_09-23-24", "timestamp": 1742549004, "time_this_iter_s": 14.591254472732544, "time_total_s": 2769.0685801506042, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f922bbe0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2769.0685801506042, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 99.1842105263158, "ram_util_percent": 13.521052631578947}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982460975646973, "policy_loss": -0.012477255426347256, "vf_loss": 9.994873046875, "vf_explained_var": 5.116686452311114e-07, "kl": 0.010430159978568554, "entropy": 0.32080909609794617, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "sampler_results": {"episode_reward_max": 60076.90003967285, "episode_reward_min": 56343.266693115234, "episode_reward_mean": 58210.08336639404, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56343.266693115234}, "policy_reward_max": {"agent_0": 60076.90003967285}, "policy_reward_mean": {"agent_0": 58210.08336639404}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60076.90003967285, 56343.266693115234], "episode_lengths": [137, 134], "policy_agent_0_reward": [60076.90003967285, 56343.266693115234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.661924172046607, "mean_inference_ms": 6.5331090001895245, "mean_action_processing_ms": 0.19648501786931155, "mean_env_wait_ms": 221.54429812259164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03691911697387695, "StateBufferConnector_ms": 0.005424022674560547, "ViewRequirementAgentConnector_ms": 0.15343427658081055}}, "episode_reward_max": 60076.90003967285, "episode_reward_min": 56343.266693115234, "episode_reward_mean": 58210.08336639404, "episode_len_mean": 135.5, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56343.266693115234}, "policy_reward_max": {"agent_0": 60076.90003967285}, "policy_reward_mean": {"agent_0": 58210.08336639404}, "hist_stats": {"episode_reward": [60076.90003967285, 56343.266693115234], "episode_lengths": [137, 134], "policy_agent_0_reward": [60076.90003967285, 56343.266693115234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 18.661924172046607, "mean_inference_ms": 6.5331090001895245, "mean_action_processing_ms": 0.19648501786931155, "mean_env_wait_ms": 221.54429812259164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03691911697387695, "StateBufferConnector_ms": 0.005424022674560547, "ViewRequirementAgentConnector_ms": 0.15343427658081055}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.36299786823474, "num_env_steps_trained_throughput_per_sec": 296.36299786823474, "timesteps_total": 772000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 772000, "timers": {"training_iteration_time_ms": 14284.15, "sample_time_ms": 11284.702, "learn_time_ms": 2846.375, "learn_throughput": 1405.296, "synch_weights_time_ms": 152.381}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 772000, "num_agent_steps_trained": 772000}, "done": false, "episodes_total": 5614, "training_iteration": 193, "trial_id": "32397_00000", "date": "2025-03-21_09-23-38", "timestamp": 1742549018, "time_this_iter_s": 13.545641422271729, "time_total_s": 2782.614221572876, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb492b00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2782.614221572876, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 99.56499999999998, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.066666666666666, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.914015769958496, "policy_loss": -0.00964382104575634, "vf_loss": 9.923583984375, "vf_explained_var": 1.0043382872026996e-06, "kl": 0.012016350403428078, "entropy": 0.34456679224967957, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "sampler_results": {"episode_reward_max": 61003.42022705078, "episode_reward_min": 47142.34006500244, "episode_reward_mean": 56882.174858164784, "episode_len_mean": 136.03333333333333, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 47142.34006500244}, "policy_reward_max": {"agent_0": 61003.42022705078}, "policy_reward_mean": {"agent_0": 56882.174858164784}, "custom_metrics": {"num_batches_mean": 5.066666666666666, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56711.373416900635, 57493.866565704346, 57679.30667114258, 58994.6934967041, 52245.84679603577, 60303.75369262695, 58359.7268371582, 60947.287048339844, 57246.88009643555, 56851.333557128906, 57966.37366294861, 60077.04682922363, 59257.106994628906, 51382.993408083916, 61003.42022705078, 55705.60011291504, 58575.406997680664, 52814.85359895229, 47142.34006500244, 59504.74688720703, 58139.746768951416, 57670.24044799805, 60967.020446777344, 52181.333377838135, 55062.52697658539, 54108.24677371979, 56123.006801605225, 56100.84035015106, 56932.06681442261, 58916.260025024414], "episode_lengths": [137, 136, 137, 136, 135, 137, 137, 137, 135, 136, 137, 137, 136, 135, 137, 135, 136, 135, 134, 136, 135, 136, 137, 135, 136, 136, 136, 136, 136, 137], "policy_agent_0_reward": [56711.373416900635, 57493.866565704346, 57679.30667114258, 58994.6934967041, 52245.84679603577, 60303.75369262695, 58359.7268371582, 60947.287048339844, 57246.88009643555, 56851.333557128906, 57966.37366294861, 60077.04682922363, 59257.106994628906, 51382.993408083916, 61003.42022705078, 55705.60011291504, 58575.406997680664, 52814.85359895229, 47142.34006500244, 59504.74688720703, 58139.746768951416, 57670.24044799805, 60967.020446777344, 52181.333377838135, 55062.52697658539, 54108.24677371979, 56123.006801605225, 56100.84035015106, 56932.06681442261, 58916.260025024414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.755640000764284, "mean_inference_ms": 6.405945749892009, "mean_action_processing_ms": 0.19992984956614931, "mean_env_wait_ms": 219.55370022272652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11262734731038411, "StateBufferConnector_ms": 0.006553332010904948, "ViewRequirementAgentConnector_ms": 0.24465560913085938}}, "episode_reward_max": 61003.42022705078, "episode_reward_min": 47142.34006500244, "episode_reward_mean": 56882.174858164784, "episode_len_mean": 136.03333333333333, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 47142.34006500244}, "policy_reward_max": {"agent_0": 61003.42022705078}, "policy_reward_mean": {"agent_0": 56882.174858164784}, "hist_stats": {"episode_reward": [56711.373416900635, 57493.866565704346, 57679.30667114258, 58994.6934967041, 52245.84679603577, 60303.75369262695, 58359.7268371582, 60947.287048339844, 57246.88009643555, 56851.333557128906, 57966.37366294861, 60077.04682922363, 59257.106994628906, 51382.993408083916, 61003.42022705078, 55705.60011291504, 58575.406997680664, 52814.85359895229, 47142.34006500244, 59504.74688720703, 58139.746768951416, 57670.24044799805, 60967.020446777344, 52181.333377838135, 55062.52697658539, 54108.24677371979, 56123.006801605225, 56100.84035015106, 56932.06681442261, 58916.260025024414], "episode_lengths": [137, 136, 137, 136, 135, 137, 137, 137, 135, 136, 137, 137, 136, 135, 137, 135, 136, 135, 134, 136, 135, 136, 137, 135, 136, 136, 136, 136, 136, 137], "policy_agent_0_reward": [56711.373416900635, 57493.866565704346, 57679.30667114258, 58994.6934967041, 52245.84679603577, 60303.75369262695, 58359.7268371582, 60947.287048339844, 57246.88009643555, 56851.333557128906, 57966.37366294861, 60077.04682922363, 59257.106994628906, 51382.993408083916, 61003.42022705078, 55705.60011291504, 58575.406997680664, 52814.85359895229, 47142.34006500244, 59504.74688720703, 58139.746768951416, 57670.24044799805, 60967.020446777344, 52181.333377838135, 55062.52697658539, 54108.24677371979, 56123.006801605225, 56100.84035015106, 56932.06681442261, 58916.260025024414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.755640000764284, "mean_inference_ms": 6.405945749892009, "mean_action_processing_ms": 0.19992984956614931, "mean_env_wait_ms": 219.55370022272652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11262734731038411, "StateBufferConnector_ms": 0.006553332010904948, "ViewRequirementAgentConnector_ms": 0.24465560913085938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.865713681937, "num_env_steps_trained_throughput_per_sec": 257.865713681937, "timesteps_total": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 14591.913, "sample_time_ms": 11595.129, "learn_time_ms": 2843.548, "learn_throughput": 1406.693, "synch_weights_time_ms": 152.546}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "episodes_total": 5644, "training_iteration": 194, "trial_id": "32397_00000", "date": "2025-03-21_09-23-54", "timestamp": 1742549034, "time_this_iter_s": 15.567340612411499, "time_total_s": 2798.1815621852875, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49e5f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2798.1815621852875, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 99.4190476190476, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908849716186523, "policy_loss": -0.01602337136864662, "vf_loss": 9.9248046875, "vf_explained_var": -7.21650792456785e-07, "kl": 0.010878964327275753, "entropy": 0.34738433361053467, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 60847.48030090332, "episode_reward_min": 49836.88698577881, "episode_reward_mean": 55898.88663932085, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 49836.88698577881}, "policy_reward_max": {"agent_0": 60847.48030090332}, "policy_reward_mean": {"agent_0": 55898.88663932085}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60537.23327636719, 55747.30696105957, 58586.0339050293, 52038.88026762009, 59669.3935546875, 59367.580078125, 56732.00703430176, 58624.12010192871, 54452.96677017212, 55241.7203540802, 59387.7068939209, 52895.79349708557, 56295.69359874725, 54114.673568725586, 54698.07322883606, 50049.6201210022, 52201.259899139404, 55501.43355560303, 56391.733543395996, 55993.6000328064, 49836.88698577881, 56181.513442993164, 54446.31353187561, 58965.307052612305, 55954.886947631836, 60847.48030090332, 57333.82676696777, 58553.97354507446, 50451.82009649277, 55867.760266661644], "episode_lengths": [138, 134, 136, 134, 137, 136, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 134, 134, 135, 135, 135, 135, 137, 135, 135, 135, 135], "policy_agent_0_reward": [60537.23327636719, 55747.30696105957, 58586.0339050293, 52038.88026762009, 59669.3935546875, 59367.580078125, 56732.00703430176, 58624.12010192871, 54452.96677017212, 55241.7203540802, 59387.7068939209, 52895.79349708557, 56295.69359874725, 54114.673568725586, 54698.07322883606, 50049.6201210022, 52201.259899139404, 55501.43355560303, 56391.733543395996, 55993.6000328064, 49836.88698577881, 56181.513442993164, 54446.31353187561, 58965.307052612305, 55954.886947631836, 60847.48030090332, 57333.82676696777, 58553.97354507446, 50451.82009649277, 55867.760266661644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.061966599660668, "mean_inference_ms": 6.689359886692239, "mean_action_processing_ms": 0.19612347080699533, "mean_env_wait_ms": 232.94762544561155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03815015157063802, "StateBufferConnector_ms": 0.006439685821533203, "ViewRequirementAgentConnector_ms": 0.1874812444051107}}, "episode_reward_max": 60847.48030090332, "episode_reward_min": 49836.88698577881, "episode_reward_mean": 55898.88663932085, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 30, "policy_reward_min": {"agent_0": 49836.88698577881}, "policy_reward_max": {"agent_0": 60847.48030090332}, "policy_reward_mean": {"agent_0": 55898.88663932085}, "hist_stats": {"episode_reward": [60537.23327636719, 55747.30696105957, 58586.0339050293, 52038.88026762009, 59669.3935546875, 59367.580078125, 56732.00703430176, 58624.12010192871, 54452.96677017212, 55241.7203540802, 59387.7068939209, 52895.79349708557, 56295.69359874725, 54114.673568725586, 54698.07322883606, 50049.6201210022, 52201.259899139404, 55501.43355560303, 56391.733543395996, 55993.6000328064, 49836.88698577881, 56181.513442993164, 54446.31353187561, 58965.307052612305, 55954.886947631836, 60847.48030090332, 57333.82676696777, 58553.97354507446, 50451.82009649277, 55867.760266661644], "episode_lengths": [138, 134, 136, 134, 137, 136, 136, 135, 135, 136, 136, 136, 135, 135, 135, 135, 135, 135, 136, 134, 134, 135, 135, 135, 135, 137, 135, 135, 135, 135], "policy_agent_0_reward": [60537.23327636719, 55747.30696105957, 58586.0339050293, 52038.88026762009, 59669.3935546875, 59367.580078125, 56732.00703430176, 58624.12010192871, 54452.96677017212, 55241.7203540802, 59387.7068939209, 52895.79349708557, 56295.69359874725, 54114.673568725586, 54698.07322883606, 50049.6201210022, 52201.259899139404, 55501.43355560303, 56391.733543395996, 55993.6000328064, 49836.88698577881, 56181.513442993164, 54446.31353187561, 58965.307052612305, 55954.886947631836, 60847.48030090332, 57333.82676696777, 58553.97354507446, 50451.82009649277, 55867.760266661644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.061966599660668, "mean_inference_ms": 6.689359886692239, "mean_action_processing_ms": 0.19612347080699533, "mean_env_wait_ms": 232.94762544561155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03815015157063802, "StateBufferConnector_ms": 0.006439685821533203, "ViewRequirementAgentConnector_ms": 0.1874812444051107}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.4132594597048, "num_env_steps_trained_throughput_per_sec": 298.4132594597048, "timesteps_total": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 14703.735, "sample_time_ms": 11712.633, "learn_time_ms": 2833.853, "learn_throughput": 1411.506, "synch_weights_time_ms": 156.574}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 5674, "training_iteration": 195, "trial_id": "32397_00000", "date": "2025-03-21_09-24-07", "timestamp": 1742549047, "time_this_iter_s": 13.454768657684326, "time_total_s": 2811.636330842972, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91030a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2811.636330842972, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 98.29473684210525, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.612903225806452, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.828338623046875, "policy_loss": -0.016230257228016853, "vf_loss": 9.844483375549316, "vf_explained_var": 7.173667313509213e-07, "kl": 0.013691416941583157, "entropy": 0.34933778643608093, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "sampler_results": {"episode_reward_max": 62060.06689453125, "episode_reward_min": 48161.54690885544, "episode_reward_mean": 56647.5840258257, "episode_len_mean": 135.91935483870967, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {"agent_0": 48161.54690885544}, "policy_reward_max": {"agent_0": 62060.06689453125}, "policy_reward_mean": {"agent_0": 56647.5840258257}, "custom_metrics": {"num_batches_mean": 5.612903225806452, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57893.02020263672, 56465.533489227295, 59884.393421173096, 60035.773498535156, 59270.59343338013, 60004.126708984375, 52672.979988098145, 57170.32703399658, 58971.30683898926, 58196.1335067749, 50333.46671581268, 52464.10683917999, 56636.74013519287, 60492.92022705078, 58647.71999359131, 50107.17333102226, 51577.58649635315, 59337.453674316406, 61626.286880493164, 62060.06689453125, 61016.787048339844, 56964.160190582275, 57098.60673522949, 58375.52682495117, 57555.02025985718, 57587.5803527832, 54047.54027175903, 56466.533351421356, 48687.71992492676, 54188.653369903564, 58421.35362243652, 59521.853515625, 55245.79339790344, 61724.59997558594, 56267.65354537964, 60988.27340698242, 58334.98677062988, 48161.54690885544, 53949.08695411682, 56188.55367207527, 53835.53338432312, 57517.00021362305, 57559.76005554199, 59626.85340118408, 56303.36650085449, 60056.14682006836, 57636.85364151001, 59873.2071056366, 59118.060150146484, 52887.65334415436, 52880.91357019544, 59602.340103149414, 60632.21365356445, 55569.20013046265, 50242.99353981018, 49420.42684841156, 56875.84019470215, 56019.433490753174, 54429.90015029907, 53430.36009979248, 60292.50045013428, 53700.113344192505], "episode_lengths": [136, 136, 137, 137, 137, 136, 135, 135, 136, 136, 136, 137, 136, 138, 136, 135, 135, 136, 137, 137, 137, 137, 136, 135, 136, 135, 136, 136, 133, 136, 136, 136, 135, 138, 136, 137, 135, 134, 135, 137, 136, 137, 136, 137, 136, 136, 136, 136, 135, 136, 136, 136, 137, 135, 135, 134, 135, 135, 135, 135, 137, 136], "policy_agent_0_reward": [57893.02020263672, 56465.533489227295, 59884.393421173096, 60035.773498535156, 59270.59343338013, 60004.126708984375, 52672.979988098145, 57170.32703399658, 58971.30683898926, 58196.1335067749, 50333.46671581268, 52464.10683917999, 56636.74013519287, 60492.92022705078, 58647.71999359131, 50107.17333102226, 51577.58649635315, 59337.453674316406, 61626.286880493164, 62060.06689453125, 61016.787048339844, 56964.160190582275, 57098.60673522949, 58375.52682495117, 57555.02025985718, 57587.5803527832, 54047.54027175903, 56466.533351421356, 48687.71992492676, 54188.653369903564, 58421.35362243652, 59521.853515625, 55245.79339790344, 61724.59997558594, 56267.65354537964, 60988.27340698242, 58334.98677062988, 48161.54690885544, 53949.08695411682, 56188.55367207527, 53835.53338432312, 57517.00021362305, 57559.76005554199, 59626.85340118408, 56303.36650085449, 60056.14682006836, 57636.85364151001, 59873.2071056366, 59118.060150146484, 52887.65334415436, 52880.91357019544, 59602.340103149414, 60632.21365356445, 55569.20013046265, 50242.99353981018, 49420.42684841156, 56875.84019470215, 56019.433490753174, 54429.90015029907, 53430.36009979248, 60292.50045013428, 53700.113344192505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.21507498355385, "mean_inference_ms": 6.805549980354405, "mean_action_processing_ms": 0.1968725524443473, "mean_env_wait_ms": 231.37688917419356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05963194754815871, "StateBufferConnector_ms": 0.012537356345884262, "ViewRequirementAgentConnector_ms": 0.18619145116498392}}, "episode_reward_max": 62060.06689453125, "episode_reward_min": 48161.54690885544, "episode_reward_mean": 56647.5840258257, "episode_len_mean": 135.91935483870967, "episodes_this_iter": 62, "policy_reward_min": {"agent_0": 48161.54690885544}, "policy_reward_max": {"agent_0": 62060.06689453125}, "policy_reward_mean": {"agent_0": 56647.5840258257}, "hist_stats": {"episode_reward": [57893.02020263672, 56465.533489227295, 59884.393421173096, 60035.773498535156, 59270.59343338013, 60004.126708984375, 52672.979988098145, 57170.32703399658, 58971.30683898926, 58196.1335067749, 50333.46671581268, 52464.10683917999, 56636.74013519287, 60492.92022705078, 58647.71999359131, 50107.17333102226, 51577.58649635315, 59337.453674316406, 61626.286880493164, 62060.06689453125, 61016.787048339844, 56964.160190582275, 57098.60673522949, 58375.52682495117, 57555.02025985718, 57587.5803527832, 54047.54027175903, 56466.533351421356, 48687.71992492676, 54188.653369903564, 58421.35362243652, 59521.853515625, 55245.79339790344, 61724.59997558594, 56267.65354537964, 60988.27340698242, 58334.98677062988, 48161.54690885544, 53949.08695411682, 56188.55367207527, 53835.53338432312, 57517.00021362305, 57559.76005554199, 59626.85340118408, 56303.36650085449, 60056.14682006836, 57636.85364151001, 59873.2071056366, 59118.060150146484, 52887.65334415436, 52880.91357019544, 59602.340103149414, 60632.21365356445, 55569.20013046265, 50242.99353981018, 49420.42684841156, 56875.84019470215, 56019.433490753174, 54429.90015029907, 53430.36009979248, 60292.50045013428, 53700.113344192505], "episode_lengths": [136, 136, 137, 137, 137, 136, 135, 135, 136, 136, 136, 137, 136, 138, 136, 135, 135, 136, 137, 137, 137, 137, 136, 135, 136, 135, 136, 136, 133, 136, 136, 136, 135, 138, 136, 137, 135, 134, 135, 137, 136, 137, 136, 137, 136, 136, 136, 136, 135, 136, 136, 136, 137, 135, 135, 134, 135, 135, 135, 135, 137, 136], "policy_agent_0_reward": [57893.02020263672, 56465.533489227295, 59884.393421173096, 60035.773498535156, 59270.59343338013, 60004.126708984375, 52672.979988098145, 57170.32703399658, 58971.30683898926, 58196.1335067749, 50333.46671581268, 52464.10683917999, 56636.74013519287, 60492.92022705078, 58647.71999359131, 50107.17333102226, 51577.58649635315, 59337.453674316406, 61626.286880493164, 62060.06689453125, 61016.787048339844, 56964.160190582275, 57098.60673522949, 58375.52682495117, 57555.02025985718, 57587.5803527832, 54047.54027175903, 56466.533351421356, 48687.71992492676, 54188.653369903564, 58421.35362243652, 59521.853515625, 55245.79339790344, 61724.59997558594, 56267.65354537964, 60988.27340698242, 58334.98677062988, 48161.54690885544, 53949.08695411682, 56188.55367207527, 53835.53338432312, 57517.00021362305, 57559.76005554199, 59626.85340118408, 56303.36650085449, 60056.14682006836, 57636.85364151001, 59873.2071056366, 59118.060150146484, 52887.65334415436, 52880.91357019544, 59602.340103149414, 60632.21365356445, 55569.20013046265, 50242.99353981018, 49420.42684841156, 56875.84019470215, 56019.433490753174, 54429.90015029907, 53430.36009979248, 60292.50045013428, 53700.113344192505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.21507498355385, "mean_inference_ms": 6.805549980354405, "mean_action_processing_ms": 0.1968725524443473, "mean_env_wait_ms": 231.37688917419356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05963194754815871, "StateBufferConnector_ms": 0.012537356345884262, "ViewRequirementAgentConnector_ms": 0.18619145116498392}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.0869329702244, "num_env_steps_trained_throughput_per_sec": 209.0869329702244, "timesteps_total": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 15024.162, "sample_time_ms": 12019.885, "learn_time_ms": 2848.477, "learn_throughput": 1404.259, "synch_weights_time_ms": 155.111}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "episodes_total": 5736, "training_iteration": 196, "trial_id": "32397_00000", "date": "2025-03-21_09-24-26", "timestamp": 1742549066, "time_this_iter_s": 19.17989420890808, "time_total_s": 2830.81622505188, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb33b1c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2830.81622505188, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 98.70370370370372, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9799165725708, "policy_loss": -0.015315411612391472, "vf_loss": 9.995133399963379, "vf_explained_var": 4.903848093817942e-06, "kl": 0.015590081922709942, "entropy": 0.3567017912864685, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "sampler_results": {"episode_reward_max": 53700.113344192505, "episode_reward_min": 53700.113344192505, "episode_reward_mean": 53700.113344192505, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53700.113344192505}, "policy_reward_max": {"agent_0": 53700.113344192505}, "policy_reward_mean": {"agent_0": 53700.113344192505}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53700.113344192505], "episode_lengths": [136], "policy_agent_0_reward": [53700.113344192505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.76754550608497, "mean_inference_ms": 6.578967842249214, "mean_action_processing_ms": 0.19244096428512217, "mean_env_wait_ms": 230.4590931543794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039196014404296875, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.1669168472290039}}, "episode_reward_max": 53700.113344192505, "episode_reward_min": 53700.113344192505, "episode_reward_mean": 53700.113344192505, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53700.113344192505}, "policy_reward_max": {"agent_0": 53700.113344192505}, "policy_reward_mean": {"agent_0": 53700.113344192505}, "hist_stats": {"episode_reward": [53700.113344192505], "episode_lengths": [136], "policy_agent_0_reward": [53700.113344192505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.76754550608497, "mean_inference_ms": 6.578967842249214, "mean_action_processing_ms": 0.19244096428512217, "mean_env_wait_ms": 230.4590931543794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039196014404296875, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.1669168472290039}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3126564955748, "num_env_steps_trained_throughput_per_sec": 313.3126564955748, "timesteps_total": 788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 788000, "timers": {"training_iteration_time_ms": 14639.596, "sample_time_ms": 11648.14, "learn_time_ms": 2835.212, "learn_throughput": 1410.829, "synch_weights_time_ms": 155.557}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 788000, "num_agent_steps_trained": 788000}, "done": false, "episodes_total": 5736, "training_iteration": 197, "trial_id": "32397_00000", "date": "2025-03-21_09-24-39", "timestamp": 1742549079, "time_this_iter_s": 12.809660196304321, "time_total_s": 2843.625885248184, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e01f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2843.625885248184, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 99.59444444444443, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908296585083008, "policy_loss": -0.012463998049497604, "vf_loss": 9.920689582824707, "vf_explained_var": 6.204471105775156e-07, "kl": 0.011174729093909264, "entropy": 0.3525911271572113, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 62567.02716064453, "episode_reward_min": 45119.640308856964, "episode_reward_mean": 56062.61166235618, "episode_len_mean": 136.0625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45119.640308856964}, "policy_reward_max": {"agent_0": 62567.02716064453}, "policy_reward_mean": {"agent_0": 56062.61166235618}, "custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58011.76686859131, 62567.02716064453, 61922.27325439453, 53539.55337142944, 59469.580017089844, 58813.38682556152, 57717.96047973633, 57761.43363952637, 57006.21343612671, 45119.640308856964, 58739.7936706543, 54369.66673070192, 56569.600147247314, 52383.31351971626, 56280.34671974182, 54064.54684448242, 53335.1605796814, 56339.66012573242, 55398.80681800842, 53013.99996948242, 56034.79385948181, 47835.94016587734, 58379.260314941406, 58384.9801940918, 56497.833280563354, 57287.13346481323, 56673.08687591553, 53755.34688568115, 56393.39386796951, 54878.753536224365, 54875.053328990936, 60584.26693344116], "episode_lengths": [136, 138, 137, 136, 137, 136, 136, 136, 136, 134, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136, 137, 135, 136, 136, 136, 137, 136, 136, 135, 134, 136, 137], "policy_agent_0_reward": [58011.76686859131, 62567.02716064453, 61922.27325439453, 53539.55337142944, 59469.580017089844, 58813.38682556152, 57717.96047973633, 57761.43363952637, 57006.21343612671, 45119.640308856964, 58739.7936706543, 54369.66673070192, 56569.600147247314, 52383.31351971626, 56280.34671974182, 54064.54684448242, 53335.1605796814, 56339.66012573242, 55398.80681800842, 53013.99996948242, 56034.79385948181, 47835.94016587734, 58379.260314941406, 58384.9801940918, 56497.833280563354, 57287.13346481323, 56673.08687591553, 53755.34688568115, 56393.39386796951, 54878.753536224365, 54875.053328990936, 60584.26693344116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.364126508392808, "mean_inference_ms": 6.406456624266749, "mean_action_processing_ms": 0.19969054894677168, "mean_env_wait_ms": 220.05296145332798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06731599569320679, "StateBufferConnector_ms": 0.006368011236190796, "ViewRequirementAgentConnector_ms": 0.28922557830810547}}, "episode_reward_max": 62567.02716064453, "episode_reward_min": 45119.640308856964, "episode_reward_mean": 56062.61166235618, "episode_len_mean": 136.0625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 45119.640308856964}, "policy_reward_max": {"agent_0": 62567.02716064453}, "policy_reward_mean": {"agent_0": 56062.61166235618}, "hist_stats": {"episode_reward": [58011.76686859131, 62567.02716064453, 61922.27325439453, 53539.55337142944, 59469.580017089844, 58813.38682556152, 57717.96047973633, 57761.43363952637, 57006.21343612671, 45119.640308856964, 58739.7936706543, 54369.66673070192, 56569.600147247314, 52383.31351971626, 56280.34671974182, 54064.54684448242, 53335.1605796814, 56339.66012573242, 55398.80681800842, 53013.99996948242, 56034.79385948181, 47835.94016587734, 58379.260314941406, 58384.9801940918, 56497.833280563354, 57287.13346481323, 56673.08687591553, 53755.34688568115, 56393.39386796951, 54878.753536224365, 54875.053328990936, 60584.26693344116], "episode_lengths": [136, 138, 137, 136, 137, 136, 136, 136, 136, 134, 137, 136, 136, 136, 137, 136, 136, 135, 136, 136, 137, 135, 136, 136, 136, 137, 136, 136, 135, 134, 136, 137], "policy_agent_0_reward": [58011.76686859131, 62567.02716064453, 61922.27325439453, 53539.55337142944, 59469.580017089844, 58813.38682556152, 57717.96047973633, 57761.43363952637, 57006.21343612671, 45119.640308856964, 58739.7936706543, 54369.66673070192, 56569.600147247314, 52383.31351971626, 56280.34671974182, 54064.54684448242, 53335.1605796814, 56339.66012573242, 55398.80681800842, 53013.99996948242, 56034.79385948181, 47835.94016587734, 58379.260314941406, 58384.9801940918, 56497.833280563354, 57287.13346481323, 56673.08687591553, 53755.34688568115, 56393.39386796951, 54878.753536224365, 54875.053328990936, 60584.26693344116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.364126508392808, "mean_inference_ms": 6.406456624266749, "mean_action_processing_ms": 0.19969054894677168, "mean_env_wait_ms": 220.05296145332798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06731599569320679, "StateBufferConnector_ms": 0.006368011236190796, "ViewRequirementAgentConnector_ms": 0.28922557830810547}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.5087521622248, "num_env_steps_trained_throughput_per_sec": 278.5087521622248, "timesteps_total": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 14720.998, "sample_time_ms": 11775.637, "learn_time_ms": 2799.114, "learn_throughput": 1429.023, "synch_weights_time_ms": 145.565}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 5768, "training_iteration": 198, "trial_id": "32397_00000", "date": "2025-03-21_09-24-54", "timestamp": 1742549094, "time_this_iter_s": 14.408896207809448, "time_total_s": 2858.0347814559937, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2858.0347814559937, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 99.43000000000002, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981403350830078, "policy_loss": -0.011095182970166206, "vf_loss": 9.992431640625, "vf_explained_var": 1.0900199640673236e-06, "kl": 0.010667920112609863, "entropy": 0.2966729998588562, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "sampler_results": {"episode_reward_max": 58697.22677612305, "episode_reward_min": 52601.526916503906, "episode_reward_mean": 55268.25566609701, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 52601.526916503906}, "policy_reward_max": {"agent_0": 58697.22677612305}, "policy_reward_mean": {"agent_0": 55268.25566609701}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52601.526916503906, 58697.22677612305, 54506.01330566406], "episode_lengths": [135, 136, 135], "policy_agent_0_reward": [52601.526916503906, 58697.22677612305, 54506.01330566406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.749646850911763, "mean_inference_ms": 6.495178865726324, "mean_action_processing_ms": 0.1922131533050497, "mean_env_wait_ms": 234.44440494983965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883043924967448, "StateBufferConnector_ms": 0.00797112782796224, "ViewRequirementAgentConnector_ms": 0.15420118967692056}}, "episode_reward_max": 58697.22677612305, "episode_reward_min": 52601.526916503906, "episode_reward_mean": 55268.25566609701, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 52601.526916503906}, "policy_reward_max": {"agent_0": 58697.22677612305}, "policy_reward_mean": {"agent_0": 55268.25566609701}, "hist_stats": {"episode_reward": [52601.526916503906, 58697.22677612305, 54506.01330566406], "episode_lengths": [135, 136, 135], "policy_agent_0_reward": [52601.526916503906, 58697.22677612305, 54506.01330566406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.749646850911763, "mean_inference_ms": 6.495178865726324, "mean_action_processing_ms": 0.1922131533050497, "mean_env_wait_ms": 234.44440494983965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883043924967448, "StateBufferConnector_ms": 0.00797112782796224, "ViewRequirementAgentConnector_ms": 0.15420118967692056}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.9630132815254, "num_env_steps_trained_throughput_per_sec": 304.9630132815254, "timesteps_total": 796000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 796000, "timers": {"training_iteration_time_ms": 14694.582, "sample_time_ms": 11805.017, "learn_time_ms": 2739.966, "learn_throughput": 1459.872, "synch_weights_time_ms": 148.908}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 796000, "num_agent_steps_trained": 796000}, "done": false, "episodes_total": 5771, "training_iteration": 199, "trial_id": "32397_00000", "date": "2025-03-21_09-25-07", "timestamp": 1742549107, "time_this_iter_s": 13.16142725944519, "time_total_s": 2871.196208715439, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f9229d80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2871.196208715439, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 99.63333333333334, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.235955056179775, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.7651948928833, "policy_loss": -0.013212237507104874, "vf_loss": 9.7783203125, "vf_explained_var": 2.4425486344625824e-07, "kl": 0.013842994347214699, "entropy": 0.32973331212997437, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "sampler_results": {"episode_reward_max": 61924.420349121094, "episode_reward_min": 48089.40695858002, "episode_reward_mean": 56029.81755035781, "episode_len_mean": 135.79775280898878, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 48089.40695858002}, "policy_reward_max": {"agent_0": 61924.420349121094}, "policy_reward_mean": {"agent_0": 56029.81755035781}, "custom_metrics": {"num_batches_mean": 5.235955056179775, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57941.4201335907, 59658.447036743164, 52089.28673744202, 56204.70008087158, 59294.32730102539, 59450.82669067383, 60667.207122802734, 54458.77350997925, 58756.96011352539, 59014.07376098633, 48810.79368400574, 60117.46678161621, 58408.12028121948, 59284.59375, 51115.9067786932, 52826.586841106415, 56960.353424072266, 57818.56661987305, 48089.40695858002, 52151.846917152405, 60000.50017929077, 61924.420349121094, 55241.22708129883, 56141.75991821289, 50845.53349876404, 58674.16018676758, 54850.22669219971, 55399.0535697937, 56209.93356323242, 57609.040130615234, 51009.360224723816, 59742.97364807129, 56417.75349998474, 57988.293518066406, 52962.63977432251, 56384.93371963501, 52003.56680679321, 52046.900037288666, 57441.05999994278, 56234.08027458191, 57077.51342010498, 54136.99994659424, 59510.13360595703, 60635.78024291992, 59706.98681640625, 57280.32690811157, 52502.33331871033, 58074.24692726135, 55115.29342651367, 52730.76014351845, 59622.780292510986, 49239.94009912014, 58308.999938964844, 57070.55337524414, 60134.626953125, 51963.553505182266, 51563.580107688904, 56328.22009277344, 58658.093521118164, 56446.83364868164, 57594.84673690796, 51120.646867752075, 58477.08010864258, 52075.320217609406, 53738.28668022156, 59364.8268737793, 51224.139897584915, 54844.53337097168, 56527.246680259705, 56261.6135969162, 58901.5334854126, 53461.5403842926, 56642.36028420925, 54183.65347290039, 59630.053634643555, 57390.72002410889, 53452.506702423096, 60802.06033325195, 54690.77332878113, 59835.21363067627, 52094.866775512695, 58988.12699890137, 53164.693470954895, 58588.333587646484, 52197.15364742279, 56572.3733215332, 56451.43342208862, 52168.566756248474, 57854.62020301819], "episode_lengths": [136, 137, 136, 136, 136, 136, 137, 136, 137, 137, 135, 137, 137, 137, 134, 136, 135, 136, 135, 134, 137, 137, 135, 136, 135, 137, 136, 135, 136, 136, 135, 137, 136, 135, 136, 137, 134, 133, 136, 136, 136, 136, 136, 136, 136, 136, 134, 137, 135, 136, 136, 135, 136, 136, 137, 135, 135, 136, 136, 135, 137, 135, 137, 135, 135, 136, 135, 135, 136, 134, 136, 135, 136, 136, 137, 136, 135, 137, 136, 137, 135, 136, 135, 137, 135, 135, 137, 134, 136], "policy_agent_0_reward": [57941.4201335907, 59658.447036743164, 52089.28673744202, 56204.70008087158, 59294.32730102539, 59450.82669067383, 60667.207122802734, 54458.77350997925, 58756.96011352539, 59014.07376098633, 48810.79368400574, 60117.46678161621, 58408.12028121948, 59284.59375, 51115.9067786932, 52826.586841106415, 56960.353424072266, 57818.56661987305, 48089.40695858002, 52151.846917152405, 60000.50017929077, 61924.420349121094, 55241.22708129883, 56141.75991821289, 50845.53349876404, 58674.16018676758, 54850.22669219971, 55399.0535697937, 56209.93356323242, 57609.040130615234, 51009.360224723816, 59742.97364807129, 56417.75349998474, 57988.293518066406, 52962.63977432251, 56384.93371963501, 52003.56680679321, 52046.900037288666, 57441.05999994278, 56234.08027458191, 57077.51342010498, 54136.99994659424, 59510.13360595703, 60635.78024291992, 59706.98681640625, 57280.32690811157, 52502.33331871033, 58074.24692726135, 55115.29342651367, 52730.76014351845, 59622.780292510986, 49239.94009912014, 58308.999938964844, 57070.55337524414, 60134.626953125, 51963.553505182266, 51563.580107688904, 56328.22009277344, 58658.093521118164, 56446.83364868164, 57594.84673690796, 51120.646867752075, 58477.08010864258, 52075.320217609406, 53738.28668022156, 59364.8268737793, 51224.139897584915, 54844.53337097168, 56527.246680259705, 56261.6135969162, 58901.5334854126, 53461.5403842926, 56642.36028420925, 54183.65347290039, 59630.053634643555, 57390.72002410889, 53452.506702423096, 60802.06033325195, 54690.77332878113, 59835.21363067627, 52094.866775512695, 58988.12699890137, 53164.693470954895, 58588.333587646484, 52197.15364742279, 56572.3733215332, 56451.43342208862, 52168.566756248474, 57854.62020301819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.78067092695428, "mean_inference_ms": 6.768684639616703, "mean_action_processing_ms": 0.19665820413509397, "mean_env_wait_ms": 231.75950106174412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04154403557938136, "StateBufferConnector_ms": 0.005985913651712825, "ViewRequirementAgentConnector_ms": 0.22422490494974542}}, "episode_reward_max": 61924.420349121094, "episode_reward_min": 48089.40695858002, "episode_reward_mean": 56029.81755035781, "episode_len_mean": 135.79775280898878, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 48089.40695858002}, "policy_reward_max": {"agent_0": 61924.420349121094}, "policy_reward_mean": {"agent_0": 56029.81755035781}, "hist_stats": {"episode_reward": [57941.4201335907, 59658.447036743164, 52089.28673744202, 56204.70008087158, 59294.32730102539, 59450.82669067383, 60667.207122802734, 54458.77350997925, 58756.96011352539, 59014.07376098633, 48810.79368400574, 60117.46678161621, 58408.12028121948, 59284.59375, 51115.9067786932, 52826.586841106415, 56960.353424072266, 57818.56661987305, 48089.40695858002, 52151.846917152405, 60000.50017929077, 61924.420349121094, 55241.22708129883, 56141.75991821289, 50845.53349876404, 58674.16018676758, 54850.22669219971, 55399.0535697937, 56209.93356323242, 57609.040130615234, 51009.360224723816, 59742.97364807129, 56417.75349998474, 57988.293518066406, 52962.63977432251, 56384.93371963501, 52003.56680679321, 52046.900037288666, 57441.05999994278, 56234.08027458191, 57077.51342010498, 54136.99994659424, 59510.13360595703, 60635.78024291992, 59706.98681640625, 57280.32690811157, 52502.33331871033, 58074.24692726135, 55115.29342651367, 52730.76014351845, 59622.780292510986, 49239.94009912014, 58308.999938964844, 57070.55337524414, 60134.626953125, 51963.553505182266, 51563.580107688904, 56328.22009277344, 58658.093521118164, 56446.83364868164, 57594.84673690796, 51120.646867752075, 58477.08010864258, 52075.320217609406, 53738.28668022156, 59364.8268737793, 51224.139897584915, 54844.53337097168, 56527.246680259705, 56261.6135969162, 58901.5334854126, 53461.5403842926, 56642.36028420925, 54183.65347290039, 59630.053634643555, 57390.72002410889, 53452.506702423096, 60802.06033325195, 54690.77332878113, 59835.21363067627, 52094.866775512695, 58988.12699890137, 53164.693470954895, 58588.333587646484, 52197.15364742279, 56572.3733215332, 56451.43342208862, 52168.566756248474, 57854.62020301819], "episode_lengths": [136, 137, 136, 136, 136, 136, 137, 136, 137, 137, 135, 137, 137, 137, 134, 136, 135, 136, 135, 134, 137, 137, 135, 136, 135, 137, 136, 135, 136, 136, 135, 137, 136, 135, 136, 137, 134, 133, 136, 136, 136, 136, 136, 136, 136, 136, 134, 137, 135, 136, 136, 135, 136, 136, 137, 135, 135, 136, 136, 135, 137, 135, 137, 135, 135, 136, 135, 135, 136, 134, 136, 135, 136, 136, 137, 136, 135, 137, 136, 137, 135, 136, 135, 137, 135, 135, 137, 134, 136], "policy_agent_0_reward": [57941.4201335907, 59658.447036743164, 52089.28673744202, 56204.70008087158, 59294.32730102539, 59450.82669067383, 60667.207122802734, 54458.77350997925, 58756.96011352539, 59014.07376098633, 48810.79368400574, 60117.46678161621, 58408.12028121948, 59284.59375, 51115.9067786932, 52826.586841106415, 56960.353424072266, 57818.56661987305, 48089.40695858002, 52151.846917152405, 60000.50017929077, 61924.420349121094, 55241.22708129883, 56141.75991821289, 50845.53349876404, 58674.16018676758, 54850.22669219971, 55399.0535697937, 56209.93356323242, 57609.040130615234, 51009.360224723816, 59742.97364807129, 56417.75349998474, 57988.293518066406, 52962.63977432251, 56384.93371963501, 52003.56680679321, 52046.900037288666, 57441.05999994278, 56234.08027458191, 57077.51342010498, 54136.99994659424, 59510.13360595703, 60635.78024291992, 59706.98681640625, 57280.32690811157, 52502.33331871033, 58074.24692726135, 55115.29342651367, 52730.76014351845, 59622.780292510986, 49239.94009912014, 58308.999938964844, 57070.55337524414, 60134.626953125, 51963.553505182266, 51563.580107688904, 56328.22009277344, 58658.093521118164, 56446.83364868164, 57594.84673690796, 51120.646867752075, 58477.08010864258, 52075.320217609406, 53738.28668022156, 59364.8268737793, 51224.139897584915, 54844.53337097168, 56527.246680259705, 56261.6135969162, 58901.5334854126, 53461.5403842926, 56642.36028420925, 54183.65347290039, 59630.053634643555, 57390.72002410889, 53452.506702423096, 60802.06033325195, 54690.77332878113, 59835.21363067627, 52094.866775512695, 58988.12699890137, 53164.693470954895, 58588.333587646484, 52197.15364742279, 56572.3733215332, 56451.43342208862, 52168.566756248474, 57854.62020301819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.78067092695428, "mean_inference_ms": 6.768684639616703, "mean_action_processing_ms": 0.19665820413509397, "mean_env_wait_ms": 231.75950106174412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04154403557938136, "StateBufferConnector_ms": 0.005985913651712825, "ViewRequirementAgentConnector_ms": 0.22422490494974542}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.36026190472586, "num_env_steps_trained_throughput_per_sec": 237.36026190472586, "timesteps_total": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 14771.067, "sample_time_ms": 11927.942, "learn_time_ms": 2695.378, "learn_throughput": 1484.022, "synch_weights_time_ms": 147.054}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "episodes_total": 5860, "training_iteration": 200, "trial_id": "32397_00000", "date": "2025-03-21_09-25-24", "timestamp": 1742549124, "time_this_iter_s": 16.914873361587524, "time_total_s": 2888.1110820770264, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f9103640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2888.1110820770264, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 97.70434782608694, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.979610443115234, "policy_loss": -0.015605242922902107, "vf_loss": 9.9951171875, "vf_explained_var": 7.16124986865907e-07, "kl": 0.01570003293454647, "entropy": 0.3578251004219055, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 57854.62020301819, "episode_reward_min": 57854.62020301819, "episode_reward_mean": 57854.62020301819, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57854.62020301819}, "policy_reward_max": {"agent_0": 57854.62020301819}, "policy_reward_mean": {"agent_0": 57854.62020301819}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57854.62020301819], "episode_lengths": [136], "policy_agent_0_reward": [57854.62020301819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13793109517752, "mean_inference_ms": 6.5551666408158, "mean_action_processing_ms": 0.19232825625037758, "mean_env_wait_ms": 229.95975881307464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04277229309082031, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.1934051513671875}}, "episode_reward_max": 57854.62020301819, "episode_reward_min": 57854.62020301819, "episode_reward_mean": 57854.62020301819, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57854.62020301819}, "policy_reward_max": {"agent_0": 57854.62020301819}, "policy_reward_mean": {"agent_0": 57854.62020301819}, "hist_stats": {"episode_reward": [57854.62020301819], "episode_lengths": [136], "policy_agent_0_reward": [57854.62020301819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.13793109517752, "mean_inference_ms": 6.5551666408158, "mean_action_processing_ms": 0.19232825625037758, "mean_env_wait_ms": 229.95975881307464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04277229309082031, "StateBufferConnector_ms": 0.0068187713623046875, "ViewRequirementAgentConnector_ms": 0.1934051513671875}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6640829776435, "num_env_steps_trained_throughput_per_sec": 299.6640829776435, "timesteps_total": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 14652.853, "sample_time_ms": 11741.014, "learn_time_ms": 2765.709, "learn_throughput": 1446.284, "synch_weights_time_ms": 145.437}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 5860, "training_iteration": 201, "trial_id": "32397_00000", "date": "2025-03-21_09-25-37", "timestamp": 1742549137, "time_this_iter_s": 13.397167205810547, "time_total_s": 2901.508249282837, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91012d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2901.508249282837, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 99.63684210526316, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.901491165161133, "policy_loss": -0.013273910619318485, "vf_loss": 9.914690971374512, "vf_explained_var": 1.6559288269490935e-05, "kl": 0.01180195715278387, "entropy": 0.3661561906337738, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "sampler_results": {"episode_reward_max": 61040.806884765625, "episode_reward_min": 48694.57988548279, "episode_reward_mean": 56629.39099634439, "episode_len_mean": 136.03125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48694.57988548279}, "policy_reward_max": {"agent_0": 61040.806884765625}, "policy_reward_mean": {"agent_0": 56629.39099634439}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53391.3002884388, 60644.89340209961, 57744.82670593262, 57481.347091674805, 59325.507064819336, 57304.23335266113, 50094.70036029816, 55567.1734085083, 57700.839988708496, 54058.76686382294, 55249.13352203369, 55742.28018951416, 60482.26705932617, 53055.280091285706, 60486.89370727539, 60302.00697898865, 58357.94696044922, 52484.97360801697, 61040.806884765625, 54141.54009628296, 48694.57988548279, 58023.74654006958, 52003.306730270386, 52707.52009391785, 58480.573471069336, 59152.91370391846, 59795.8068523407, 55911.31328201294, 57494.246505737305, 56692.073375701904, 59480.74688720703, 59046.966930389404], "episode_lengths": [136, 138, 135, 136, 136, 135, 134, 136, 135, 135, 136, 136, 138, 136, 137, 138, 136, 136, 137, 135, 134, 136, 135, 135, 137, 137, 137, 136, 136, 136, 136, 137], "policy_agent_0_reward": [53391.3002884388, 60644.89340209961, 57744.82670593262, 57481.347091674805, 59325.507064819336, 57304.23335266113, 50094.70036029816, 55567.1734085083, 57700.839988708496, 54058.76686382294, 55249.13352203369, 55742.28018951416, 60482.26705932617, 53055.280091285706, 60486.89370727539, 60302.00697898865, 58357.94696044922, 52484.97360801697, 61040.806884765625, 54141.54009628296, 48694.57988548279, 58023.74654006958, 52003.306730270386, 52707.52009391785, 58480.573471069336, 59152.91370391846, 59795.8068523407, 55911.31328201294, 57494.246505737305, 56692.073375701904, 59480.74688720703, 59046.966930389404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.35845000097128, "mean_inference_ms": 6.396138730195037, "mean_action_processing_ms": 0.19967200960089496, "mean_env_wait_ms": 219.86991909444464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914453744888306, "StateBufferConnector_ms": 0.006382167339324951, "ViewRequirementAgentConnector_ms": 0.2620019018650055}}, "episode_reward_max": 61040.806884765625, "episode_reward_min": 48694.57988548279, "episode_reward_mean": 56629.39099634439, "episode_len_mean": 136.03125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48694.57988548279}, "policy_reward_max": {"agent_0": 61040.806884765625}, "policy_reward_mean": {"agent_0": 56629.39099634439}, "hist_stats": {"episode_reward": [53391.3002884388, 60644.89340209961, 57744.82670593262, 57481.347091674805, 59325.507064819336, 57304.23335266113, 50094.70036029816, 55567.1734085083, 57700.839988708496, 54058.76686382294, 55249.13352203369, 55742.28018951416, 60482.26705932617, 53055.280091285706, 60486.89370727539, 60302.00697898865, 58357.94696044922, 52484.97360801697, 61040.806884765625, 54141.54009628296, 48694.57988548279, 58023.74654006958, 52003.306730270386, 52707.52009391785, 58480.573471069336, 59152.91370391846, 59795.8068523407, 55911.31328201294, 57494.246505737305, 56692.073375701904, 59480.74688720703, 59046.966930389404], "episode_lengths": [136, 138, 135, 136, 136, 135, 134, 136, 135, 135, 136, 136, 138, 136, 137, 138, 136, 136, 137, 135, 134, 136, 135, 135, 137, 137, 137, 136, 136, 136, 136, 137], "policy_agent_0_reward": [53391.3002884388, 60644.89340209961, 57744.82670593262, 57481.347091674805, 59325.507064819336, 57304.23335266113, 50094.70036029816, 55567.1734085083, 57700.839988708496, 54058.76686382294, 55249.13352203369, 55742.28018951416, 60482.26705932617, 53055.280091285706, 60486.89370727539, 60302.00697898865, 58357.94696044922, 52484.97360801697, 61040.806884765625, 54141.54009628296, 48694.57988548279, 58023.74654006958, 52003.306730270386, 52707.52009391785, 58480.573471069336, 59152.91370391846, 59795.8068523407, 55911.31328201294, 57494.246505737305, 56692.073375701904, 59480.74688720703, 59046.966930389404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.35845000097128, "mean_inference_ms": 6.396138730195037, "mean_action_processing_ms": 0.19967200960089496, "mean_env_wait_ms": 219.86991909444464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07914453744888306, "StateBufferConnector_ms": 0.006382167339324951, "ViewRequirementAgentConnector_ms": 0.2620019018650055}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000, "num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.95279769083453, "num_env_steps_trained_throughput_per_sec": 280.95279769083453, "timesteps_total": 808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 808000, "timers": {"training_iteration_time_ms": 14622.647, "sample_time_ms": 11712.781, "learn_time_ms": 2761.896, "learn_throughput": 1448.281, "synch_weights_time_ms": 147.328}, "counters": {"num_env_steps_sampled": 808000, "num_env_steps_trained": 808000, "num_agent_steps_sampled": 808000, "num_agent_steps_trained": 808000}, "done": false, "episodes_total": 5892, "training_iteration": 202, "trial_id": "32397_00000", "date": "2025-03-21_09-25-52", "timestamp": 1742549152, "time_this_iter_s": 14.28932523727417, "time_total_s": 2915.797574520111, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79fb49e5f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2915.797574520111, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 99.34, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986411094665527, "policy_loss": -0.013665646314620972, "vf_loss": 10.0, "vf_explained_var": -3.2654652386554517e-06, "kl": 0.012279683724045753, "entropy": 0.34188613295555115, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "sampler_results": {"episode_reward_max": 59046.966930389404, "episode_reward_min": 59046.966930389404, "episode_reward_mean": 59046.966930389404, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59046.966930389404}, "policy_reward_max": {"agent_0": 59046.966930389404}, "policy_reward_mean": {"agent_0": 59046.966930389404}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59046.966930389404], "episode_lengths": [137], "policy_agent_0_reward": [59046.966930389404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161551746307182, "mean_inference_ms": 6.03558245816652, "mean_action_processing_ms": 0.1956551833472474, "mean_env_wait_ms": 224.05792162374377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06251335144042969, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.18589496612548828}}, "episode_reward_max": 59046.966930389404, "episode_reward_min": 59046.966930389404, "episode_reward_mean": 59046.966930389404, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59046.966930389404}, "policy_reward_max": {"agent_0": 59046.966930389404}, "policy_reward_mean": {"agent_0": 59046.966930389404}, "hist_stats": {"episode_reward": [59046.966930389404], "episode_lengths": [137], "policy_agent_0_reward": [59046.966930389404]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.161551746307182, "mean_inference_ms": 6.03558245816652, "mean_action_processing_ms": 0.1956551833472474, "mean_env_wait_ms": 224.05792162374377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06251335144042969, "StateBufferConnector_ms": 0.005936622619628906, "ViewRequirementAgentConnector_ms": 0.18589496612548828}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000, "num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.63474034831114, "num_env_steps_trained_throughput_per_sec": 325.63474034831114, "timesteps_total": 812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 812000, "timers": {"training_iteration_time_ms": 14501.323, "sample_time_ms": 11611.325, "learn_time_ms": 2745.646, "learn_throughput": 1456.852, "synch_weights_time_ms": 143.709}, "counters": {"num_env_steps_sampled": 812000, "num_env_steps_trained": 812000, "num_agent_steps_sampled": 812000, "num_agent_steps_trained": 812000}, "done": false, "episodes_total": 5892, "training_iteration": 203, "trial_id": "32397_00000", "date": "2025-03-21_09-26-04", "timestamp": 1742549164, "time_this_iter_s": 12.323877334594727, "time_total_s": 2928.121451854706, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91031c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2928.121451854706, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 99.52777777777777, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.755437850952148, "policy_loss": -0.01301807165145874, "vf_loss": 9.768388748168945, "vf_explained_var": -1.3142202988092322e-06, "kl": 0.010739102028310299, "entropy": 0.34278449416160583, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 61417.00665283203, "episode_reward_min": 45169.193450927734, "episode_reward_mean": 55606.35016652618, "episode_len_mean": 135.80434782608697, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45169.193450927734}, "policy_reward_max": {"agent_0": 61417.00665283203}, "policy_reward_mean": {"agent_0": 55606.35016652618}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57440.92681121826, 57933.63326767087, 51204.82021856308, 58490.660064697266, 59487.9801940918, 50684.24680459499, 57924.75366592407, 60149.40692901611, 49648.61338400841, 52723.70672014356, 54494.146832466125, 54136.7467212677, 59806.680236816406, 51557.48020172119, 55226.04040527344, 54914.806725502014, 60351.94689941406, 61040.66049194336, 53355.10680770874, 54531.64673757553, 54878.32674217224, 56262.17358016968, 60012.706802368164, 51536.4734916687, 53018.12023925781, 56924.420192718506, 58134.99364280701, 58609.88694000244, 58975.1668510437, 54730.38002490997, 57990.62018585205, 48546.08005619049, 54834.99342536926, 51045.14027738571, 60524.3935546875, 53186.93349790573, 52558.28683280945, 50387.866609334946, 57939.25361824036, 48184.14002609253, 54870.06693840027, 53524.22671127319, 55768.213455200195, 56223.740158081055, 50913.24026632309, 57285.92680025101, 53588.926876068115, 50403.62687206268, 57483.10704231262, 61330.00021362305, 58361.29364013672, 56048.033546447754, 57230.400020599365, 58908.746799468994, 53699.466733932495, 48756.593435287476, 61417.00665283203, 49276.79354763031, 55732.64689254761, 58159.35348510742, 56139.86668395996, 59015.22686767578, 58455.546783447266, 57687.00690984726, 55032.09344005585, 56562.75360870361, 54863.28677368164, 45169.193450927734, 59573.28056335449, 53933.146874427795, 52693.61349391937, 56931.11338996887, 57594.22688293457, 60085.29345703125, 55444.840019226074, 60871.373626708984, 58940.48011779785, 56644.84687042236, 53030.11987495422, 55794.387172698975, 53465.859998703, 55545.43365097046, 59390.03338623047, 52595.686814785004, 57430.15354156494, 60569.02673339844, 58264.16039657593, 60661.42011260986, 52392.91329193115, 48935.966846466064, 58690.920166015625, 51015.166721224785], "episode_lengths": [136, 137, 135, 136, 137, 134, 137, 137, 134, 136, 136, 134, 137, 134, 136, 136, 137, 138, 135, 136, 135, 136, 137, 134, 134, 136, 137, 137, 137, 134, 136, 134, 136, 135, 136, 136, 136, 133, 137, 135, 136, 135, 134, 136, 135, 136, 135, 135, 136, 137, 136, 136, 136, 137, 136, 134, 137, 136, 135, 137, 135, 137, 136, 136, 136, 137, 136, 134, 137, 136, 135, 135, 135, 137, 135, 137, 136, 136, 135, 136, 136, 136, 136, 135, 137, 137, 136, 137, 136, 136, 136, 135], "policy_agent_0_reward": [57440.92681121826, 57933.63326767087, 51204.82021856308, 58490.660064697266, 59487.9801940918, 50684.24680459499, 57924.75366592407, 60149.40692901611, 49648.61338400841, 52723.70672014356, 54494.146832466125, 54136.7467212677, 59806.680236816406, 51557.48020172119, 55226.04040527344, 54914.806725502014, 60351.94689941406, 61040.66049194336, 53355.10680770874, 54531.64673757553, 54878.32674217224, 56262.17358016968, 60012.706802368164, 51536.4734916687, 53018.12023925781, 56924.420192718506, 58134.99364280701, 58609.88694000244, 58975.1668510437, 54730.38002490997, 57990.62018585205, 48546.08005619049, 54834.99342536926, 51045.14027738571, 60524.3935546875, 53186.93349790573, 52558.28683280945, 50387.866609334946, 57939.25361824036, 48184.14002609253, 54870.06693840027, 53524.22671127319, 55768.213455200195, 56223.740158081055, 50913.24026632309, 57285.92680025101, 53588.926876068115, 50403.62687206268, 57483.10704231262, 61330.00021362305, 58361.29364013672, 56048.033546447754, 57230.400020599365, 58908.746799468994, 53699.466733932495, 48756.593435287476, 61417.00665283203, 49276.79354763031, 55732.64689254761, 58159.35348510742, 56139.86668395996, 59015.22686767578, 58455.546783447266, 57687.00690984726, 55032.09344005585, 56562.75360870361, 54863.28677368164, 45169.193450927734, 59573.28056335449, 53933.146874427795, 52693.61349391937, 56931.11338996887, 57594.22688293457, 60085.29345703125, 55444.840019226074, 60871.373626708984, 58940.48011779785, 56644.84687042236, 53030.11987495422, 55794.387172698975, 53465.859998703, 55545.43365097046, 59390.03338623047, 52595.686814785004, 57430.15354156494, 60569.02673339844, 58264.16039657593, 60661.42011260986, 52392.91329193115, 48935.966846466064, 58690.920166015625, 51015.166721224785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.65893115077852, "mean_inference_ms": 6.752768965637574, "mean_action_processing_ms": 0.19651193413390897, "mean_env_wait_ms": 231.87044937356424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03954016644021739, "StateBufferConnector_ms": 0.006121915319691534, "ViewRequirementAgentConnector_ms": 0.27884296748949133}}, "episode_reward_max": 61417.00665283203, "episode_reward_min": 45169.193450927734, "episode_reward_mean": 55606.35016652618, "episode_len_mean": 135.80434782608697, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 45169.193450927734}, "policy_reward_max": {"agent_0": 61417.00665283203}, "policy_reward_mean": {"agent_0": 55606.35016652618}, "hist_stats": {"episode_reward": [57440.92681121826, 57933.63326767087, 51204.82021856308, 58490.660064697266, 59487.9801940918, 50684.24680459499, 57924.75366592407, 60149.40692901611, 49648.61338400841, 52723.70672014356, 54494.146832466125, 54136.7467212677, 59806.680236816406, 51557.48020172119, 55226.04040527344, 54914.806725502014, 60351.94689941406, 61040.66049194336, 53355.10680770874, 54531.64673757553, 54878.32674217224, 56262.17358016968, 60012.706802368164, 51536.4734916687, 53018.12023925781, 56924.420192718506, 58134.99364280701, 58609.88694000244, 58975.1668510437, 54730.38002490997, 57990.62018585205, 48546.08005619049, 54834.99342536926, 51045.14027738571, 60524.3935546875, 53186.93349790573, 52558.28683280945, 50387.866609334946, 57939.25361824036, 48184.14002609253, 54870.06693840027, 53524.22671127319, 55768.213455200195, 56223.740158081055, 50913.24026632309, 57285.92680025101, 53588.926876068115, 50403.62687206268, 57483.10704231262, 61330.00021362305, 58361.29364013672, 56048.033546447754, 57230.400020599365, 58908.746799468994, 53699.466733932495, 48756.593435287476, 61417.00665283203, 49276.79354763031, 55732.64689254761, 58159.35348510742, 56139.86668395996, 59015.22686767578, 58455.546783447266, 57687.00690984726, 55032.09344005585, 56562.75360870361, 54863.28677368164, 45169.193450927734, 59573.28056335449, 53933.146874427795, 52693.61349391937, 56931.11338996887, 57594.22688293457, 60085.29345703125, 55444.840019226074, 60871.373626708984, 58940.48011779785, 56644.84687042236, 53030.11987495422, 55794.387172698975, 53465.859998703, 55545.43365097046, 59390.03338623047, 52595.686814785004, 57430.15354156494, 60569.02673339844, 58264.16039657593, 60661.42011260986, 52392.91329193115, 48935.966846466064, 58690.920166015625, 51015.166721224785], "episode_lengths": [136, 137, 135, 136, 137, 134, 137, 137, 134, 136, 136, 134, 137, 134, 136, 136, 137, 138, 135, 136, 135, 136, 137, 134, 134, 136, 137, 137, 137, 134, 136, 134, 136, 135, 136, 136, 136, 133, 137, 135, 136, 135, 134, 136, 135, 136, 135, 135, 136, 137, 136, 136, 136, 137, 136, 134, 137, 136, 135, 137, 135, 137, 136, 136, 136, 137, 136, 134, 137, 136, 135, 135, 135, 137, 135, 137, 136, 136, 135, 136, 136, 136, 136, 135, 137, 137, 136, 137, 136, 136, 136, 135], "policy_agent_0_reward": [57440.92681121826, 57933.63326767087, 51204.82021856308, 58490.660064697266, 59487.9801940918, 50684.24680459499, 57924.75366592407, 60149.40692901611, 49648.61338400841, 52723.70672014356, 54494.146832466125, 54136.7467212677, 59806.680236816406, 51557.48020172119, 55226.04040527344, 54914.806725502014, 60351.94689941406, 61040.66049194336, 53355.10680770874, 54531.64673757553, 54878.32674217224, 56262.17358016968, 60012.706802368164, 51536.4734916687, 53018.12023925781, 56924.420192718506, 58134.99364280701, 58609.88694000244, 58975.1668510437, 54730.38002490997, 57990.62018585205, 48546.08005619049, 54834.99342536926, 51045.14027738571, 60524.3935546875, 53186.93349790573, 52558.28683280945, 50387.866609334946, 57939.25361824036, 48184.14002609253, 54870.06693840027, 53524.22671127319, 55768.213455200195, 56223.740158081055, 50913.24026632309, 57285.92680025101, 53588.926876068115, 50403.62687206268, 57483.10704231262, 61330.00021362305, 58361.29364013672, 56048.033546447754, 57230.400020599365, 58908.746799468994, 53699.466733932495, 48756.593435287476, 61417.00665283203, 49276.79354763031, 55732.64689254761, 58159.35348510742, 56139.86668395996, 59015.22686767578, 58455.546783447266, 57687.00690984726, 55032.09344005585, 56562.75360870361, 54863.28677368164, 45169.193450927734, 59573.28056335449, 53933.146874427795, 52693.61349391937, 56931.11338996887, 57594.22688293457, 60085.29345703125, 55444.840019226074, 60871.373626708984, 58940.48011779785, 56644.84687042236, 53030.11987495422, 55794.387172698975, 53465.859998703, 55545.43365097046, 59390.03338623047, 52595.686814785004, 57430.15354156494, 60569.02673339844, 58264.16039657593, 60661.42011260986, 52392.91329193115, 48935.966846466064, 58690.920166015625, 51015.166721224785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.65893115077852, "mean_inference_ms": 6.752768965637574, "mean_action_processing_ms": 0.19651193413390897, "mean_env_wait_ms": 231.87044937356424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03954016644021739, "StateBufferConnector_ms": 0.006121915319691534, "ViewRequirementAgentConnector_ms": 0.27884296748949133}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.92672770115206, "num_env_steps_trained_throughput_per_sec": 241.92672770115206, "timesteps_total": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 14603.522, "sample_time_ms": 11695.321, "learn_time_ms": 2760.931, "learn_throughput": 1448.787, "synch_weights_time_ms": 146.626}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 5984, "training_iteration": 204, "trial_id": "32397_00000", "date": "2025-03-21_09-26-21", "timestamp": 1742549181, "time_this_iter_s": 16.59132671356201, "time_total_s": 2944.712778568268, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f9229d80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2944.712778568268, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 97.33043478260869, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983067512512207, "policy_loss": -0.017042843624949455, "vf_loss": 10.0, "vf_explained_var": -1.4925996083547943e-07, "kl": 0.017714906483888626, "entropy": 0.4019584655761719, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "sampler_results": {"episode_reward_max": 51015.166721224785, "episode_reward_min": 51015.166721224785, "episode_reward_mean": 51015.166721224785, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51015.166721224785}, "policy_reward_max": {"agent_0": 51015.166721224785}, "policy_reward_mean": {"agent_0": 51015.166721224785}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51015.166721224785], "episode_lengths": [135], "policy_agent_0_reward": [51015.166721224785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.3969754452617, "mean_inference_ms": 6.568231011517911, "mean_action_processing_ms": 0.19211571182622575, "mean_env_wait_ms": 230.32163222545614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039005279541015625, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16012191772460938}}, "episode_reward_max": 51015.166721224785, "episode_reward_min": 51015.166721224785, "episode_reward_mean": 51015.166721224785, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 51015.166721224785}, "policy_reward_max": {"agent_0": 51015.166721224785}, "policy_reward_mean": {"agent_0": 51015.166721224785}, "hist_stats": {"episode_reward": [51015.166721224785], "episode_lengths": [135], "policy_agent_0_reward": [51015.166721224785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.3969754452617, "mean_inference_ms": 6.568231011517911, "mean_action_processing_ms": 0.19211571182622575, "mean_env_wait_ms": 230.32163222545614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039005279541015625, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.16012191772460938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000, "num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.43900204248257, "num_env_steps_trained_throughput_per_sec": 300.43900204248257, "timesteps_total": 820000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 820000, "timers": {"training_iteration_time_ms": 14594.484, "sample_time_ms": 11648.788, "learn_time_ms": 2794.002, "learn_throughput": 1431.638, "synch_weights_time_ms": 151.047}, "counters": {"num_env_steps_sampled": 820000, "num_env_steps_trained": 820000, "num_agent_steps_sampled": 820000, "num_agent_steps_trained": 820000}, "done": false, "episodes_total": 5984, "training_iteration": 205, "trial_id": "32397_00000", "date": "2025-03-21_09-26-34", "timestamp": 1742549194, "time_this_iter_s": 13.38471508026123, "time_total_s": 2958.097493648529, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91031c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2958.097493648529, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 99.54736842105264, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.908890724182129, "policy_loss": -0.013546446338295937, "vf_loss": 9.92236328125, "vf_explained_var": -7.577240239697858e-07, "kl": 0.011819550767540932, "entropy": 0.3447481393814087, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "sampler_results": {"episode_reward_max": 61345.8537902832, "episode_reward_min": 48894.193459391594, "episode_reward_mean": 55967.55628924216, "episode_len_mean": 135.80645161290323, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 48894.193459391594}, "policy_reward_max": {"agent_0": 61345.8537902832}, "policy_reward_mean": {"agent_0": 55967.55628924216}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58542.600189208984, 49861.280190467834, 56544.6003074646, 58756.73336791992, 51178.186940193176, 59330.253662109375, 58182.56683635712, 60356.673400878906, 60469.066986083984, 58535.77991485596, 49065.673340797424, 61345.8537902832, 55556.1003112793, 58995.15996551514, 58413.8669128418, 55842.46664428711, 48894.193459391594, 59161.586853027344, 57703.73344421387, 56828.073526382446, 57524.046615600586, 49778.15342903137, 52070.853516578674, 57619.60673522949, 59660.28700256348, 50554.47354888916, 57720.713317871094, 53680.780321121216, 56558.00018799305, 52929.286838531494, 53333.59340953827], "episode_lengths": [136, 135, 135, 136, 135, 137, 136, 137, 137, 136, 135, 138, 135, 136, 136, 137, 135, 138, 135, 137, 135, 133, 135, 136, 136, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [58542.600189208984, 49861.280190467834, 56544.6003074646, 58756.73336791992, 51178.186940193176, 59330.253662109375, 58182.56683635712, 60356.673400878906, 60469.066986083984, 58535.77991485596, 49065.673340797424, 61345.8537902832, 55556.1003112793, 58995.15996551514, 58413.8669128418, 55842.46664428711, 48894.193459391594, 59161.586853027344, 57703.73344421387, 56828.073526382446, 57524.046615600586, 49778.15342903137, 52070.853516578674, 57619.60673522949, 59660.28700256348, 50554.47354888916, 57720.713317871094, 53680.780321121216, 56558.00018799305, 52929.286838531494, 53333.59340953827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.19040530962816, "mean_inference_ms": 6.3989331545806065, "mean_action_processing_ms": 0.19962582917755023, "mean_env_wait_ms": 219.814143371497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07284610502181514, "StateBufferConnector_ms": 0.006297326857043851, "ViewRequirementAgentConnector_ms": 0.30299309761293475}}, "episode_reward_max": 61345.8537902832, "episode_reward_min": 48894.193459391594, "episode_reward_mean": 55967.55628924216, "episode_len_mean": 135.80645161290323, "episodes_this_iter": 31, "policy_reward_min": {"agent_0": 48894.193459391594}, "policy_reward_max": {"agent_0": 61345.8537902832}, "policy_reward_mean": {"agent_0": 55967.55628924216}, "hist_stats": {"episode_reward": [58542.600189208984, 49861.280190467834, 56544.6003074646, 58756.73336791992, 51178.186940193176, 59330.253662109375, 58182.56683635712, 60356.673400878906, 60469.066986083984, 58535.77991485596, 49065.673340797424, 61345.8537902832, 55556.1003112793, 58995.15996551514, 58413.8669128418, 55842.46664428711, 48894.193459391594, 59161.586853027344, 57703.73344421387, 56828.073526382446, 57524.046615600586, 49778.15342903137, 52070.853516578674, 57619.60673522949, 59660.28700256348, 50554.47354888916, 57720.713317871094, 53680.780321121216, 56558.00018799305, 52929.286838531494, 53333.59340953827], "episode_lengths": [136, 135, 135, 136, 135, 137, 136, 137, 137, 136, 135, 138, 135, 136, 136, 137, 135, 138, 135, 137, 135, 133, 135, 136, 136, 135, 136, 135, 136, 136, 135], "policy_agent_0_reward": [58542.600189208984, 49861.280190467834, 56544.6003074646, 58756.73336791992, 51178.186940193176, 59330.253662109375, 58182.56683635712, 60356.673400878906, 60469.066986083984, 58535.77991485596, 49065.673340797424, 61345.8537902832, 55556.1003112793, 58995.15996551514, 58413.8669128418, 55842.46664428711, 48894.193459391594, 59161.586853027344, 57703.73344421387, 56828.073526382446, 57524.046615600586, 49778.15342903137, 52070.853516578674, 57619.60673522949, 59660.28700256348, 50554.47354888916, 57720.713317871094, 53680.780321121216, 56558.00018799305, 52929.286838531494, 53333.59340953827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.19040530962816, "mean_inference_ms": 6.3989331545806065, "mean_action_processing_ms": 0.19962582917755023, "mean_env_wait_ms": 219.814143371497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07284610502181514, "StateBufferConnector_ms": 0.006297326857043851, "ViewRequirementAgentConnector_ms": 0.30299309761293475}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000, "num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.67592153960476, "num_env_steps_trained_throughput_per_sec": 274.67592153960476, "timesteps_total": 824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 824000, "timers": {"training_iteration_time_ms": 14137.664, "sample_time_ms": 11238.066, "learn_time_ms": 2752.151, "learn_throughput": 1453.409, "synch_weights_time_ms": 146.803}, "counters": {"num_env_steps_sampled": 824000, "num_env_steps_trained": 824000, "num_agent_steps_sampled": 824000, "num_agent_steps_trained": 824000}, "done": false, "episodes_total": 6015, "training_iteration": 206, "trial_id": "32397_00000", "date": "2025-03-21_09-26-49", "timestamp": 1742549209, "time_this_iter_s": 14.621865034103394, "time_total_s": 2972.7193586826324, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e01f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2972.7193586826324, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 99.27894736842104, "ram_util_percent": 13.510526315789473}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98058795928955, "policy_loss": -0.01706630364060402, "vf_loss": 9.99755859375, "vf_explained_var": -1.2944763057021191e-06, "kl": 0.015291264280676842, "entropy": 0.36925315856933594, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 56973.80013656616, "episode_reward_min": 56973.80013656616, "episode_reward_mean": 56973.80013656616, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56973.80013656616}, "policy_reward_max": {"agent_0": 56973.80013656616}, "policy_reward_mean": {"agent_0": 56973.80013656616}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56973.80013656616], "episode_lengths": [136], "policy_agent_0_reward": [56973.80013656616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.934061826252545, "mean_inference_ms": 6.195393009263961, "mean_action_processing_ms": 0.19537446370448663, "mean_env_wait_ms": 221.84532639991482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034546852111816406, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.17232894897460938}}, "episode_reward_max": 56973.80013656616, "episode_reward_min": 56973.80013656616, "episode_reward_mean": 56973.80013656616, "episode_len_mean": 136.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 56973.80013656616}, "policy_reward_max": {"agent_0": 56973.80013656616}, "policy_reward_mean": {"agent_0": 56973.80013656616}, "hist_stats": {"episode_reward": [56973.80013656616], "episode_lengths": [136], "policy_agent_0_reward": [56973.80013656616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.934061826252545, "mean_inference_ms": 6.195393009263961, "mean_action_processing_ms": 0.19537446370448663, "mean_env_wait_ms": 221.84532639991482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034546852111816406, "StateBufferConnector_ms": 0.005745887756347656, "ViewRequirementAgentConnector_ms": 0.17232894897460938}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.90466828702597, "num_env_steps_trained_throughput_per_sec": 320.90466828702597, "timesteps_total": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 14107.46, "sample_time_ms": 11256.172, "learn_time_ms": 2710.764, "learn_throughput": 1475.599, "synch_weights_time_ms": 139.884}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 6016, "training_iteration": 207, "trial_id": "32397_00000", "date": "2025-03-21_09-27-02", "timestamp": 1742549222, "time_this_iter_s": 12.502506017684937, "time_total_s": 2985.2218647003174, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91031c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 2985.2218647003174, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 99.52777777777779, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.797557830810547, "policy_loss": -0.012813308276236057, "vf_loss": 9.810302734375, "vf_explained_var": 1.3327846772881458e-06, "kl": 0.010813627392053604, "entropy": 0.33583465218544006, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "sampler_results": {"episode_reward_max": 61019.90711975098, "episode_reward_min": 47231.37349176407, "episode_reward_mean": 55439.40095413908, "episode_len_mean": 135.60526315789474, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {"agent_0": 47231.37349176407}, "policy_reward_max": {"agent_0": 61019.90711975098}, "policy_reward_mean": {"agent_0": 55439.40095413908}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55380.86692619324, 55660.33335876465, 53424.886810302734, 58742.82716369629, 52638.2002954483, 52735.12029361725, 55269.00024032593, 56925.280181884766, 52351.58000946045, 57169.09342956543, 52313.16001069546, 56085.33374398947, 58082.9468460083, 55373.54667663574, 51589.14679527283, 59822.1936340332, 56878.093605041504, 50328.02003097534, 48861.11341667175, 54420.306913375854, 58505.213470458984, 54060.033447265625, 57320.9402923584, 57577.73348045349, 60227.180084228516, 50974.05358695984, 57552.16702270508, 60787.46710205078, 56656.70677566528, 52998.60012054443, 51215.20649909973, 58582.08660697937, 61019.90711975098, 58064.0803527832, 56677.91339683533, 59272.006896972656, 54112.88005673885, 55647.79349517822, 60951.7868347168, 57980.7000579834, 53632.72679519653, 57714.500175476074, 51656.45344924927, 54955.54030036926, 54783.56678152084, 57284.433601379395, 57392.23346328735, 55451.82014465332, 60080.02685546875, 51692.83336520195, 55696.78011512756, 53955.140254974365, 50417.94673371315, 57619.673491477966, 54958.873668670654, 52887.16674995422, 52780.22668552399, 52181.060141563416, 53403.653443574905, 54600.6669960022, 55819.14030408859, 55391.47344970703, 51489.94006919861, 53871.95343399048, 53246.373353004456, 47231.37349176407, 55406.13348388672, 58526.200313568115, 53283.513540267944, 57043.160066604614, 53965.91345024109, 55186.62003326416, 56770.766721725464, 60505.126708984375, 57555.753452301025, 60720.20034790039], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 134, 137, 136, 135, 135, 137, 135, 134, 133, 136, 136, 136, 136, 135, 136, 135, 136, 137, 135, 135, 134, 136, 137, 136, 136, 136, 136, 136, 137, 136, 135, 136, 135, 136, 137, 136, 136, 136, 136, 133, 135, 136, 136, 136, 136, 136, 136, 134, 134, 135, 136, 135, 136, 133, 134, 134, 136, 137, 135, 137, 136, 136, 137, 137, 136, 137], "policy_agent_0_reward": [55380.86692619324, 55660.33335876465, 53424.886810302734, 58742.82716369629, 52638.2002954483, 52735.12029361725, 55269.00024032593, 56925.280181884766, 52351.58000946045, 57169.09342956543, 52313.16001069546, 56085.33374398947, 58082.9468460083, 55373.54667663574, 51589.14679527283, 59822.1936340332, 56878.093605041504, 50328.02003097534, 48861.11341667175, 54420.306913375854, 58505.213470458984, 54060.033447265625, 57320.9402923584, 57577.73348045349, 60227.180084228516, 50974.05358695984, 57552.16702270508, 60787.46710205078, 56656.70677566528, 52998.60012054443, 51215.20649909973, 58582.08660697937, 61019.90711975098, 58064.0803527832, 56677.91339683533, 59272.006896972656, 54112.88005673885, 55647.79349517822, 60951.7868347168, 57980.7000579834, 53632.72679519653, 57714.500175476074, 51656.45344924927, 54955.54030036926, 54783.56678152084, 57284.433601379395, 57392.23346328735, 55451.82014465332, 60080.02685546875, 51692.83336520195, 55696.78011512756, 53955.140254974365, 50417.94673371315, 57619.673491477966, 54958.873668670654, 52887.16674995422, 52780.22668552399, 52181.060141563416, 53403.653443574905, 54600.6669960022, 55819.14030408859, 55391.47344970703, 51489.94006919861, 53871.95343399048, 53246.373353004456, 47231.37349176407, 55406.13348388672, 58526.200313568115, 53283.513540267944, 57043.160066604614, 53965.91345024109, 55186.62003326416, 56770.766721725464, 60505.126708984375, 57555.753452301025, 60720.20034790039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.990861347083698, "mean_inference_ms": 6.750379198477774, "mean_action_processing_ms": 0.19656059985759006, "mean_env_wait_ms": 232.25264133314542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05463455852709318, "StateBufferConnector_ms": 0.006016932035747327, "ViewRequirementAgentConnector_ms": 0.19036594190095601}}, "episode_reward_max": 61019.90711975098, "episode_reward_min": 47231.37349176407, "episode_reward_mean": 55439.40095413908, "episode_len_mean": 135.60526315789474, "episodes_this_iter": 76, "policy_reward_min": {"agent_0": 47231.37349176407}, "policy_reward_max": {"agent_0": 61019.90711975098}, "policy_reward_mean": {"agent_0": 55439.40095413908}, "hist_stats": {"episode_reward": [55380.86692619324, 55660.33335876465, 53424.886810302734, 58742.82716369629, 52638.2002954483, 52735.12029361725, 55269.00024032593, 56925.280181884766, 52351.58000946045, 57169.09342956543, 52313.16001069546, 56085.33374398947, 58082.9468460083, 55373.54667663574, 51589.14679527283, 59822.1936340332, 56878.093605041504, 50328.02003097534, 48861.11341667175, 54420.306913375854, 58505.213470458984, 54060.033447265625, 57320.9402923584, 57577.73348045349, 60227.180084228516, 50974.05358695984, 57552.16702270508, 60787.46710205078, 56656.70677566528, 52998.60012054443, 51215.20649909973, 58582.08660697937, 61019.90711975098, 58064.0803527832, 56677.91339683533, 59272.006896972656, 54112.88005673885, 55647.79349517822, 60951.7868347168, 57980.7000579834, 53632.72679519653, 57714.500175476074, 51656.45344924927, 54955.54030036926, 54783.56678152084, 57284.433601379395, 57392.23346328735, 55451.82014465332, 60080.02685546875, 51692.83336520195, 55696.78011512756, 53955.140254974365, 50417.94673371315, 57619.673491477966, 54958.873668670654, 52887.16674995422, 52780.22668552399, 52181.060141563416, 53403.653443574905, 54600.6669960022, 55819.14030408859, 55391.47344970703, 51489.94006919861, 53871.95343399048, 53246.373353004456, 47231.37349176407, 55406.13348388672, 58526.200313568115, 53283.513540267944, 57043.160066604614, 53965.91345024109, 55186.62003326416, 56770.766721725464, 60505.126708984375, 57555.753452301025, 60720.20034790039], "episode_lengths": [136, 135, 135, 136, 135, 135, 135, 136, 136, 136, 134, 137, 136, 135, 135, 137, 135, 134, 133, 136, 136, 136, 136, 135, 136, 135, 136, 137, 135, 135, 134, 136, 137, 136, 136, 136, 136, 136, 137, 136, 135, 136, 135, 136, 137, 136, 136, 136, 136, 133, 135, 136, 136, 136, 136, 136, 136, 134, 134, 135, 136, 135, 136, 133, 134, 134, 136, 137, 135, 137, 136, 136, 137, 137, 136, 137], "policy_agent_0_reward": [55380.86692619324, 55660.33335876465, 53424.886810302734, 58742.82716369629, 52638.2002954483, 52735.12029361725, 55269.00024032593, 56925.280181884766, 52351.58000946045, 57169.09342956543, 52313.16001069546, 56085.33374398947, 58082.9468460083, 55373.54667663574, 51589.14679527283, 59822.1936340332, 56878.093605041504, 50328.02003097534, 48861.11341667175, 54420.306913375854, 58505.213470458984, 54060.033447265625, 57320.9402923584, 57577.73348045349, 60227.180084228516, 50974.05358695984, 57552.16702270508, 60787.46710205078, 56656.70677566528, 52998.60012054443, 51215.20649909973, 58582.08660697937, 61019.90711975098, 58064.0803527832, 56677.91339683533, 59272.006896972656, 54112.88005673885, 55647.79349517822, 60951.7868347168, 57980.7000579834, 53632.72679519653, 57714.500175476074, 51656.45344924927, 54955.54030036926, 54783.56678152084, 57284.433601379395, 57392.23346328735, 55451.82014465332, 60080.02685546875, 51692.83336520195, 55696.78011512756, 53955.140254974365, 50417.94673371315, 57619.673491477966, 54958.873668670654, 52887.16674995422, 52780.22668552399, 52181.060141563416, 53403.653443574905, 54600.6669960022, 55819.14030408859, 55391.47344970703, 51489.94006919861, 53871.95343399048, 53246.373353004456, 47231.37349176407, 55406.13348388672, 58526.200313568115, 53283.513540267944, 57043.160066604614, 53965.91345024109, 55186.62003326416, 56770.766721725464, 60505.126708984375, 57555.753452301025, 60720.20034790039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.990861347083698, "mean_inference_ms": 6.750379198477774, "mean_action_processing_ms": 0.19656059985759006, "mean_env_wait_ms": 232.25264133314542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05463455852709318, "StateBufferConnector_ms": 0.006016932035747327, "ViewRequirementAgentConnector_ms": 0.19036594190095601}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.42226680349836, "num_env_steps_trained_throughput_per_sec": 268.42226680349836, "timesteps_total": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14161.428, "sample_time_ms": 11361.352, "learn_time_ms": 2660.142, "learn_throughput": 1503.679, "synch_weights_time_ms": 139.282}, "counters": {"num_env_steps_sampled": 832000, "num_env_steps_trained": 832000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "episodes_total": 6092, "training_iteration": 208, "trial_id": "32397_00000", "date": "2025-03-21_09-27-17", "timestamp": 1742549237, "time_this_iter_s": 14.94869589805603, "time_total_s": 3000.1705605983734, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3000.1705605983734, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 96.62499999999999, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.946163177490234, "policy_loss": -0.013627625070512295, "vf_loss": 9.959716796875, "vf_explained_var": 1.058727548297611e-06, "kl": 0.01167905144393444, "entropy": 0.32861387729644775, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "sampler_results": {"episode_reward_max": 59856.360604286194, "episode_reward_min": 45929.933426856995, "episode_reward_mean": 55707.57519650459, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 45929.933426856995}, "policy_reward_max": {"agent_0": 59856.360604286194}, "policy_reward_mean": {"agent_0": 55707.57519650459}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59093.02017211914, 56833.99362564087, 45929.933426856995, 59856.360604286194, 52663.87335395813, 54593.24018192291, 56342.27365684509, 56313.25357055664, 58510.360176086426, 58184.28015136719, 58179.88006591797, 50257.90667819977, 55937.85341644287, 57068.42036819458, 53630.75352478027, 57925.80017089844], "episode_lengths": [136, 136, 134, 137, 135, 137, 137, 137, 137, 137, 136, 135, 136, 136, 135, 135], "policy_agent_0_reward": [59093.02017211914, 56833.99362564087, 45929.933426856995, 59856.360604286194, 52663.87335395813, 54593.24018192291, 56342.27365684509, 56313.25357055664, 58510.360176086426, 58184.28015136719, 58179.88006591797, 50257.90667819977, 55937.85341644287, 57068.42036819458, 53630.75352478027, 57925.80017089844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.028010085231784, "mean_inference_ms": 6.777284950093671, "mean_action_processing_ms": 0.19632799820722457, "mean_env_wait_ms": 230.22530928626153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05070120096206665, "StateBufferConnector_ms": 0.0055730342864990234, "ViewRequirementAgentConnector_ms": 0.17498880624771118}}, "episode_reward_max": 59856.360604286194, "episode_reward_min": 45929.933426856995, "episode_reward_mean": 55707.57519650459, "episode_len_mean": 136.0, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 45929.933426856995}, "policy_reward_max": {"agent_0": 59856.360604286194}, "policy_reward_mean": {"agent_0": 55707.57519650459}, "hist_stats": {"episode_reward": [59093.02017211914, 56833.99362564087, 45929.933426856995, 59856.360604286194, 52663.87335395813, 54593.24018192291, 56342.27365684509, 56313.25357055664, 58510.360176086426, 58184.28015136719, 58179.88006591797, 50257.90667819977, 55937.85341644287, 57068.42036819458, 53630.75352478027, 57925.80017089844], "episode_lengths": [136, 136, 134, 137, 135, 137, 137, 137, 137, 137, 136, 135, 136, 136, 135, 135], "policy_agent_0_reward": [59093.02017211914, 56833.99362564087, 45929.933426856995, 59856.360604286194, 52663.87335395813, 54593.24018192291, 56342.27365684509, 56313.25357055664, 58510.360176086426, 58184.28015136719, 58179.88006591797, 50257.90667819977, 55937.85341644287, 57068.42036819458, 53630.75352478027, 57925.80017089844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.028010085231784, "mean_inference_ms": 6.777284950093671, "mean_action_processing_ms": 0.19632799820722457, "mean_env_wait_ms": 230.22530928626153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05070120096206665, "StateBufferConnector_ms": 0.0055730342864990234, "ViewRequirementAgentConnector_ms": 0.17498880624771118}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000, "num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.0180040217998, "num_env_steps_trained_throughput_per_sec": 268.0180040217998, "timesteps_total": 836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 836000, "timers": {"training_iteration_time_ms": 14342.23, "sample_time_ms": 11503.498, "learn_time_ms": 2699.687, "learn_throughput": 1481.653, "synch_weights_time_ms": 138.391}, "counters": {"num_env_steps_sampled": 836000, "num_env_steps_trained": 836000, "num_agent_steps_sampled": 836000, "num_agent_steps_trained": 836000}, "done": false, "episodes_total": 6108, "training_iteration": 209, "trial_id": "32397_00000", "date": "2025-03-21_09-27-32", "timestamp": 1742549252, "time_this_iter_s": 14.97528886795044, "time_total_s": 3015.145849466324, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e01f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3015.145849466324, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 99.42999999999999, "ram_util_percent": 13.585000000000003}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.918326377868652, "policy_loss": -0.01217314787209034, "vf_loss": 9.930420875549316, "vf_explained_var": 3.7302572764019715e-07, "kl": 0.01267964020371437, "entropy": 0.3055388033390045, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 61129.16076660156, "episode_reward_min": 51979.31343269348, "episode_reward_mean": 57268.512363587106, "episode_len_mean": 135.89285714285714, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 51979.31343269348}, "policy_reward_max": {"agent_0": 61129.16076660156}, "policy_reward_mean": {"agent_0": 57268.512363587106}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55300.920082092285, 57973.813537597656, 52046.40015220642, 58501.96025085449, 55317.100273132324, 59635.926834106445, 57047.47993469238, 58339.49366569519, 59511.960372924805, 56403.97367858887, 54598.680223464966, 51979.31343269348, 57599.493225097656, 58141.08038330078, 58285.280029296875, 58613.06019592285, 60695.98049926758, 58451.640045166016, 57961.99352121353, 57104.553258895874, 53907.146911621094, 54050.14675331116, 57568.86031913757, 57542.906829833984, 59204.427154541016, 61129.16076660156, 57501.30687332153, 59104.286975860596], "episode_lengths": [135, 137, 135, 136, 134, 136, 135, 137, 137, 136, 135, 135, 136, 135, 136, 136, 137, 136, 136, 136, 136, 135, 136, 135, 137, 137, 136, 137], "policy_agent_0_reward": [55300.920082092285, 57973.813537597656, 52046.40015220642, 58501.96025085449, 55317.100273132324, 59635.926834106445, 57047.47993469238, 58339.49366569519, 59511.960372924805, 56403.97367858887, 54598.680223464966, 51979.31343269348, 57599.493225097656, 58141.08038330078, 58285.280029296875, 58613.06019592285, 60695.98049926758, 58451.640045166016, 57961.99352121353, 57104.553258895874, 53907.146911621094, 54050.14675331116, 57568.86031913757, 57542.906829833984, 59204.427154541016, 61129.16076660156, 57501.30687332153, 59104.286975860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.832105552830512, "mean_inference_ms": 6.4060035066789185, "mean_action_processing_ms": 0.19928566844440204, "mean_env_wait_ms": 220.41702117924248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11120779173714775, "StateBufferConnector_ms": 0.00646625246320452, "ViewRequirementAgentConnector_ms": 0.30743309429713656}}, "episode_reward_max": 61129.16076660156, "episode_reward_min": 51979.31343269348, "episode_reward_mean": 57268.512363587106, "episode_len_mean": 135.89285714285714, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 51979.31343269348}, "policy_reward_max": {"agent_0": 61129.16076660156}, "policy_reward_mean": {"agent_0": 57268.512363587106}, "hist_stats": {"episode_reward": [55300.920082092285, 57973.813537597656, 52046.40015220642, 58501.96025085449, 55317.100273132324, 59635.926834106445, 57047.47993469238, 58339.49366569519, 59511.960372924805, 56403.97367858887, 54598.680223464966, 51979.31343269348, 57599.493225097656, 58141.08038330078, 58285.280029296875, 58613.06019592285, 60695.98049926758, 58451.640045166016, 57961.99352121353, 57104.553258895874, 53907.146911621094, 54050.14675331116, 57568.86031913757, 57542.906829833984, 59204.427154541016, 61129.16076660156, 57501.30687332153, 59104.286975860596], "episode_lengths": [135, 137, 135, 136, 134, 136, 135, 137, 137, 136, 135, 135, 136, 135, 136, 136, 137, 136, 136, 136, 136, 135, 136, 135, 137, 137, 136, 137], "policy_agent_0_reward": [55300.920082092285, 57973.813537597656, 52046.40015220642, 58501.96025085449, 55317.100273132324, 59635.926834106445, 57047.47993469238, 58339.49366569519, 59511.960372924805, 56403.97367858887, 54598.680223464966, 51979.31343269348, 57599.493225097656, 58141.08038330078, 58285.280029296875, 58613.06019592285, 60695.98049926758, 58451.640045166016, 57961.99352121353, 57104.553258895874, 53907.146911621094, 54050.14675331116, 57568.86031913757, 57542.906829833984, 59204.427154541016, 61129.16076660156, 57501.30687332153, 59104.286975860596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.832105552830512, "mean_inference_ms": 6.4060035066789185, "mean_action_processing_ms": 0.19928566844440204, "mean_env_wait_ms": 220.41702117924248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11120779173714775, "StateBufferConnector_ms": 0.00646625246320452, "ViewRequirementAgentConnector_ms": 0.30743309429713656}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.0937897140959, "num_env_steps_trained_throughput_per_sec": 276.0937897140959, "timesteps_total": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 14105.813, "sample_time_ms": 11217.524, "learn_time_ms": 2751.369, "learn_throughput": 1453.822, "synch_weights_time_ms": 136.263}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 6136, "training_iteration": 210, "trial_id": "32397_00000", "date": "2025-03-21_09-27-46", "timestamp": 1742549266, "time_this_iter_s": 14.533239364624023, "time_total_s": 3029.679088830948, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3029.679088830948, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 99.02499999999999, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.971278190612793, "policy_loss": -0.013905514031648636, "vf_loss": 9.985111236572266, "vf_explained_var": -1.9025678739126306e-06, "kl": 0.011587818153202534, "entropy": 0.330339252948761, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "sampler_results": {"episode_reward_max": 58891.55337524414, "episode_reward_min": 50512.413378715515, "episode_reward_mean": 54528.35839809477, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 50512.413378715515}, "policy_reward_max": {"agent_0": 58891.55337524414}, "policy_reward_mean": {"agent_0": 54528.35839809477}, "custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56757.68682843447, 58891.55337524414, 51951.78000998497, 50512.413378715515], "episode_lengths": [137, 136, 136, 135], "policy_agent_0_reward": [56757.68682843447, 58891.55337524414, 51951.78000998497, 50512.413378715515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.801283220803853, "mean_inference_ms": 6.334042365971412, "mean_action_processing_ms": 0.2009669454668802, "mean_env_wait_ms": 218.8850501140324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037223100662231445, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.16103386878967285}}, "episode_reward_max": 58891.55337524414, "episode_reward_min": 50512.413378715515, "episode_reward_mean": 54528.35839809477, "episode_len_mean": 136.0, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 50512.413378715515}, "policy_reward_max": {"agent_0": 58891.55337524414}, "policy_reward_mean": {"agent_0": 54528.35839809477}, "hist_stats": {"episode_reward": [56757.68682843447, 58891.55337524414, 51951.78000998497, 50512.413378715515], "episode_lengths": [137, 136, 136, 135], "policy_agent_0_reward": [56757.68682843447, 58891.55337524414, 51951.78000998497, 50512.413378715515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.801283220803853, "mean_inference_ms": 6.334042365971412, "mean_action_processing_ms": 0.2009669454668802, "mean_env_wait_ms": 218.8850501140324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037223100662231445, "StateBufferConnector_ms": 0.005996227264404297, "ViewRequirementAgentConnector_ms": 0.16103386878967285}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000, "num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.7910643193341, "num_env_steps_trained_throughput_per_sec": 314.7910643193341, "timesteps_total": 844000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 844000, "timers": {"training_iteration_time_ms": 14041.669, "sample_time_ms": 11148.303, "learn_time_ms": 2760.21, "learn_throughput": 1449.165, "synch_weights_time_ms": 132.5}, "counters": {"num_env_steps_sampled": 844000, "num_env_steps_trained": 844000, "num_agent_steps_sampled": 844000, "num_agent_steps_trained": 844000}, "done": false, "episodes_total": 6140, "training_iteration": 211, "trial_id": "32397_00000", "date": "2025-03-21_09-27-59", "timestamp": 1742549279, "time_this_iter_s": 12.754689455032349, "time_total_s": 3042.43377828598, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e3130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3042.43377828598, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 99.57777777777778, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.891461372375488, "policy_loss": -0.014390579424798489, "vf_loss": 9.90576457977295, "vf_explained_var": 6.026277787896106e-07, "kl": 0.013889162801206112, "entropy": 0.33928197622299194, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "sampler_results": {"episode_reward_max": 60217.84045410156, "episode_reward_min": 47095.78684639931, "episode_reward_mean": 56425.10810551047, "episode_len_mean": 135.68421052631578, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {"agent_0": 47095.78684639931}, "policy_reward_max": {"agent_0": 60217.84045410156}, "policy_reward_mean": {"agent_0": 56425.10810551047}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56274.11368560791, 60217.84045410156, 52465.60674858093, 59283.47342681885, 50296.633811712265, 57747.833475112915, 55258.9268989563, 53372.1667804718, 59031.186950683594, 59064.89385986328, 54899.58015060425, 59295.033462524414, 57618.57347869873, 55489.333488464355, 54711.10001373291, 59136.18682861328, 47095.78684639931, 58527.1535949707, 57904.12022399902, 57030.4401550293, 57276.94683074951, 59278.88032531738, 55003.486961364746, 53747.87362962961, 53806.81993865967, 53322.38680076599, 58844.220123291016, 60199.066833496094, 52758.16004562378, 59685.55368900299, 59169.726989746094, 57302.220348358154, 54985.786933898926, 53383.9404296875, 58519.94696044922, 59069.73976135254, 58524.99333190918, 54554.3737411499], "episode_lengths": [135, 136, 136, 136, 134, 135, 136, 135, 136, 135, 136, 136, 136, 134, 135, 136, 135, 136, 136, 137, 136, 136, 136, 135, 135, 134, 136, 136, 135, 137, 137, 136, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [56274.11368560791, 60217.84045410156, 52465.60674858093, 59283.47342681885, 50296.633811712265, 57747.833475112915, 55258.9268989563, 53372.1667804718, 59031.186950683594, 59064.89385986328, 54899.58015060425, 59295.033462524414, 57618.57347869873, 55489.333488464355, 54711.10001373291, 59136.18682861328, 47095.78684639931, 58527.1535949707, 57904.12022399902, 57030.4401550293, 57276.94683074951, 59278.88032531738, 55003.486961364746, 53747.87362962961, 53806.81993865967, 53322.38680076599, 58844.220123291016, 60199.066833496094, 52758.16004562378, 59685.55368900299, 59169.726989746094, 57302.220348358154, 54985.786933898926, 53383.9404296875, 58519.94696044922, 59069.73976135254, 58524.99333190918, 54554.3737411499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.712244863502363, "mean_inference_ms": 6.695550763153455, "mean_action_processing_ms": 0.19590625870945855, "mean_env_wait_ms": 232.63436492658343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06557263826069079, "StateBufferConnector_ms": 0.006101005955746299, "ViewRequirementAgentConnector_ms": 0.19010870080245168}}, "episode_reward_max": 60217.84045410156, "episode_reward_min": 47095.78684639931, "episode_reward_mean": 56425.10810551047, "episode_len_mean": 135.68421052631578, "episodes_this_iter": 38, "policy_reward_min": {"agent_0": 47095.78684639931}, "policy_reward_max": {"agent_0": 60217.84045410156}, "policy_reward_mean": {"agent_0": 56425.10810551047}, "hist_stats": {"episode_reward": [56274.11368560791, 60217.84045410156, 52465.60674858093, 59283.47342681885, 50296.633811712265, 57747.833475112915, 55258.9268989563, 53372.1667804718, 59031.186950683594, 59064.89385986328, 54899.58015060425, 59295.033462524414, 57618.57347869873, 55489.333488464355, 54711.10001373291, 59136.18682861328, 47095.78684639931, 58527.1535949707, 57904.12022399902, 57030.4401550293, 57276.94683074951, 59278.88032531738, 55003.486961364746, 53747.87362962961, 53806.81993865967, 53322.38680076599, 58844.220123291016, 60199.066833496094, 52758.16004562378, 59685.55368900299, 59169.726989746094, 57302.220348358154, 54985.786933898926, 53383.9404296875, 58519.94696044922, 59069.73976135254, 58524.99333190918, 54554.3737411499], "episode_lengths": [135, 136, 136, 136, 134, 135, 136, 135, 136, 135, 136, 136, 136, 134, 135, 136, 135, 136, 136, 137, 136, 136, 136, 135, 135, 134, 136, 136, 135, 137, 137, 136, 137, 136, 135, 136, 136, 136], "policy_agent_0_reward": [56274.11368560791, 60217.84045410156, 52465.60674858093, 59283.47342681885, 50296.633811712265, 57747.833475112915, 55258.9268989563, 53372.1667804718, 59031.186950683594, 59064.89385986328, 54899.58015060425, 59295.033462524414, 57618.57347869873, 55489.333488464355, 54711.10001373291, 59136.18682861328, 47095.78684639931, 58527.1535949707, 57904.12022399902, 57030.4401550293, 57276.94683074951, 59278.88032531738, 55003.486961364746, 53747.87362962961, 53806.81993865967, 53322.38680076599, 58844.220123291016, 60199.066833496094, 52758.16004562378, 59685.55368900299, 59169.726989746094, 57302.220348358154, 54985.786933898926, 53383.9404296875, 58519.94696044922, 59069.73976135254, 58524.99333190918, 54554.3737411499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.712244863502363, "mean_inference_ms": 6.695550763153455, "mean_action_processing_ms": 0.19590625870945855, "mean_env_wait_ms": 232.63436492658343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06557263826069079, "StateBufferConnector_ms": 0.006101005955746299, "ViewRequirementAgentConnector_ms": 0.19010870080245168}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.14537596456995, "num_env_steps_trained_throughput_per_sec": 307.14537596456995, "timesteps_total": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 13920.256, "sample_time_ms": 11013.118, "learn_time_ms": 2774.15, "learn_throughput": 1441.883, "synch_weights_time_ms": 132.325}, "counters": {"num_env_steps_sampled": 848000, "num_env_steps_trained": 848000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "episodes_total": 6178, "training_iteration": 212, "trial_id": "32397_00000", "date": "2025-03-21_09-28-12", "timestamp": 1742549292, "time_this_iter_s": 13.071166753768921, "time_total_s": 3055.504945039749, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3055.504945039749, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 98.70555555555556, "ram_util_percent": 13.544444444444444}}
{"custom_metrics": {"num_batches_mean": 5.611111111111111, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.853031158447266, "policy_loss": -0.012776708230376244, "vf_loss": 9.865723609924316, "vf_explained_var": 3.5893171457246353e-07, "kl": 0.0136332456022501, "entropy": 0.35658612847328186, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 61888.280212402344, "episode_reward_min": 46077.93344143033, "episode_reward_mean": 56552.94018028456, "episode_len_mean": 135.85185185185185, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {"agent_0": 46077.93344143033}, "policy_reward_max": {"agent_0": 61888.280212402344}, "policy_reward_mean": {"agent_0": 56552.94018028456}, "custom_metrics": {"num_batches_mean": 5.611111111111111, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51614.793394088745, 51783.8334376812, 57917.72699737549, 59862.54684448242, 52697.32684087753, 57822.60005187988, 57214.51336669922, 57600.76691055298, 50582.84683609009, 59645.646881103516, 59035.50033569336, 53159.380254268646, 53620.44023704529, 61366.67349243164, 58499.3803062439, 58838.706871032715, 57937.01360321045, 57578.15368652344, 58510.0870552063, 60629.49349975586, 50894.1802585125, 54472.653398394585, 55242.00686979294, 46077.93344143033, 53977.9934387207, 61749.81359863281, 57801.33354187012, 55987.6132774353, 58815.54672241211, 55903.33349990845, 60272.293518066406, 61020.08679199219, 56804.17357635498, 57385.26022338867, 52352.62685775757, 60602.033630371094, 60018.77348327637, 54173.66014766693, 57259.806816101074, 53002.1333694458, 57897.673431396484, 54930.37368774414, 54483.813400268555, 58045.526847839355, 52210.56016385555, 54180.113510131836, 56234.45358133316, 61888.280212402344, 53112.45317649841, 57713.353507995605, 57310.726806640625, 58530.4202747345, 59438.786712646484, 58151.54705810547], "episode_lengths": [135, 135, 135, 137, 135, 136, 136, 136, 134, 137, 136, 135, 135, 138, 136, 137, 135, 135, 136, 137, 135, 136, 136, 134, 135, 138, 136, 135, 136, 136, 136, 138, 136, 135, 135, 137, 137, 135, 135, 136, 135, 137, 134, 136, 134, 136, 136, 138, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [51614.793394088745, 51783.8334376812, 57917.72699737549, 59862.54684448242, 52697.32684087753, 57822.60005187988, 57214.51336669922, 57600.76691055298, 50582.84683609009, 59645.646881103516, 59035.50033569336, 53159.380254268646, 53620.44023704529, 61366.67349243164, 58499.3803062439, 58838.706871032715, 57937.01360321045, 57578.15368652344, 58510.0870552063, 60629.49349975586, 50894.1802585125, 54472.653398394585, 55242.00686979294, 46077.93344143033, 53977.9934387207, 61749.81359863281, 57801.33354187012, 55987.6132774353, 58815.54672241211, 55903.33349990845, 60272.293518066406, 61020.08679199219, 56804.17357635498, 57385.26022338867, 52352.62685775757, 60602.033630371094, 60018.77348327637, 54173.66014766693, 57259.806816101074, 53002.1333694458, 57897.673431396484, 54930.37368774414, 54483.813400268555, 58045.526847839355, 52210.56016385555, 54180.113510131836, 56234.45358133316, 61888.280212402344, 53112.45317649841, 57713.353507995605, 57310.726806640625, 58530.4202747345, 59438.786712646484, 58151.54705810547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.495330973075497, "mean_inference_ms": 6.8007863496205445, "mean_action_processing_ms": 0.19680013030139043, "mean_env_wait_ms": 231.55125509076723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04545361907393844, "StateBufferConnector_ms": 0.006232879779956959, "ViewRequirementAgentConnector_ms": 0.19587190062911422}}, "episode_reward_max": 61888.280212402344, "episode_reward_min": 46077.93344143033, "episode_reward_mean": 56552.94018028456, "episode_len_mean": 135.85185185185185, "episodes_this_iter": 54, "policy_reward_min": {"agent_0": 46077.93344143033}, "policy_reward_max": {"agent_0": 61888.280212402344}, "policy_reward_mean": {"agent_0": 56552.94018028456}, "hist_stats": {"episode_reward": [51614.793394088745, 51783.8334376812, 57917.72699737549, 59862.54684448242, 52697.32684087753, 57822.60005187988, 57214.51336669922, 57600.76691055298, 50582.84683609009, 59645.646881103516, 59035.50033569336, 53159.380254268646, 53620.44023704529, 61366.67349243164, 58499.3803062439, 58838.706871032715, 57937.01360321045, 57578.15368652344, 58510.0870552063, 60629.49349975586, 50894.1802585125, 54472.653398394585, 55242.00686979294, 46077.93344143033, 53977.9934387207, 61749.81359863281, 57801.33354187012, 55987.6132774353, 58815.54672241211, 55903.33349990845, 60272.293518066406, 61020.08679199219, 56804.17357635498, 57385.26022338867, 52352.62685775757, 60602.033630371094, 60018.77348327637, 54173.66014766693, 57259.806816101074, 53002.1333694458, 57897.673431396484, 54930.37368774414, 54483.813400268555, 58045.526847839355, 52210.56016385555, 54180.113510131836, 56234.45358133316, 61888.280212402344, 53112.45317649841, 57713.353507995605, 57310.726806640625, 58530.4202747345, 59438.786712646484, 58151.54705810547], "episode_lengths": [135, 135, 135, 137, 135, 136, 136, 136, 134, 137, 136, 135, 135, 138, 136, 137, 135, 135, 136, 137, 135, 136, 136, 134, 135, 138, 136, 135, 136, 136, 136, 138, 136, 135, 135, 137, 137, 135, 135, 136, 135, 137, 134, 136, 134, 136, 136, 138, 136, 136, 136, 136, 137, 136], "policy_agent_0_reward": [51614.793394088745, 51783.8334376812, 57917.72699737549, 59862.54684448242, 52697.32684087753, 57822.60005187988, 57214.51336669922, 57600.76691055298, 50582.84683609009, 59645.646881103516, 59035.50033569336, 53159.380254268646, 53620.44023704529, 61366.67349243164, 58499.3803062439, 58838.706871032715, 57937.01360321045, 57578.15368652344, 58510.0870552063, 60629.49349975586, 50894.1802585125, 54472.653398394585, 55242.00686979294, 46077.93344143033, 53977.9934387207, 61749.81359863281, 57801.33354187012, 55987.6132774353, 58815.54672241211, 55903.33349990845, 60272.293518066406, 61020.08679199219, 56804.17357635498, 57385.26022338867, 52352.62685775757, 60602.033630371094, 60018.77348327637, 54173.66014766693, 57259.806816101074, 53002.1333694458, 57897.673431396484, 54930.37368774414, 54483.813400268555, 58045.526847839355, 52210.56016385555, 54180.113510131836, 56234.45358133316, 61888.280212402344, 53112.45317649841, 57713.353507995605, 57310.726806640625, 58530.4202747345, 59438.786712646484, 58151.54705810547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.495330973075497, "mean_inference_ms": 6.8007863496205445, "mean_action_processing_ms": 0.19680013030139043, "mean_env_wait_ms": 231.55125509076723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04545361907393844, "StateBufferConnector_ms": 0.006232879779956959, "ViewRequirementAgentConnector_ms": 0.19587190062911422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.6052694289161, "num_env_steps_trained_throughput_per_sec": 222.6052694289161, "timesteps_total": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 14488.786, "sample_time_ms": 11585.942, "learn_time_ms": 2764.236, "learn_throughput": 1447.054, "synch_weights_time_ms": 137.949}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 6232, "training_iteration": 213, "trial_id": "32397_00000", "date": "2025-03-21_09-28-30", "timestamp": 1742549310, "time_this_iter_s": 18.023773193359375, "time_total_s": 3073.5287182331085, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3073.5287182331085, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 98.8625, "ram_util_percent": 13.550000000000002}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.926325798034668, "policy_loss": -0.013696977868676186, "vf_loss": 9.939942359924316, "vf_explained_var": -6.238619221221597e-07, "kl": 0.012865504249930382, "entropy": 0.3169098496437073, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "sampler_results": {"episode_reward_max": 60226.07368469238, "episode_reward_min": 42514.65315246582, "episode_reward_mean": 55299.01047030091, "episode_len_mean": 135.41666666666666, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 42514.65315246582}, "policy_reward_max": {"agent_0": 60226.07368469238}, "policy_reward_mean": {"agent_0": 55299.01047030091}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [55624.26026535034, 59087.54670715332, 57365.55355834961, 59219.48036193848, 55158.153509140015, 46471.07352232933, 57052.79364013672, 60226.07368469238, 49037.19342327118, 54562.346868515015, 59610.17337036133, 59998.100158691406, 55894.58674240112, 53913.253591537476, 54645.00057411194, 42514.65315246582, 51445.459955215454, 58772.51983642578, 53188.72692775726, 56855.8869934082, 51218.87345504761, 56386.7338180542, 60154.52029418945, 58773.28687667847], "episode_lengths": [136, 136, 136, 135, 135, 134, 136, 137, 134, 135, 137, 137, 136, 135, 136, 133, 134, 136, 135, 135, 134, 136, 136, 136], "policy_agent_0_reward": [55624.26026535034, 59087.54670715332, 57365.55355834961, 59219.48036193848, 55158.153509140015, 46471.07352232933, 57052.79364013672, 60226.07368469238, 49037.19342327118, 54562.346868515015, 59610.17337036133, 59998.100158691406, 55894.58674240112, 53913.253591537476, 54645.00057411194, 42514.65315246582, 51445.459955215454, 58772.51983642578, 53188.72692775726, 56855.8869934082, 51218.87345504761, 56386.7338180542, 60154.52029418945, 58773.28687667847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.185001623602957, "mean_inference_ms": 6.427790575262859, "mean_action_processing_ms": 0.19904009358238953, "mean_env_wait_ms": 220.50798394021896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051496426264444985, "StateBufferConnector_ms": 0.006223718325297038, "ViewRequirementAgentConnector_ms": 0.2703646818796794}}, "episode_reward_max": 60226.07368469238, "episode_reward_min": 42514.65315246582, "episode_reward_mean": 55299.01047030091, "episode_len_mean": 135.41666666666666, "episodes_this_iter": 24, "policy_reward_min": {"agent_0": 42514.65315246582}, "policy_reward_max": {"agent_0": 60226.07368469238}, "policy_reward_mean": {"agent_0": 55299.01047030091}, "hist_stats": {"episode_reward": [55624.26026535034, 59087.54670715332, 57365.55355834961, 59219.48036193848, 55158.153509140015, 46471.07352232933, 57052.79364013672, 60226.07368469238, 49037.19342327118, 54562.346868515015, 59610.17337036133, 59998.100158691406, 55894.58674240112, 53913.253591537476, 54645.00057411194, 42514.65315246582, 51445.459955215454, 58772.51983642578, 53188.72692775726, 56855.8869934082, 51218.87345504761, 56386.7338180542, 60154.52029418945, 58773.28687667847], "episode_lengths": [136, 136, 136, 135, 135, 134, 136, 137, 134, 135, 137, 137, 136, 135, 136, 133, 134, 136, 135, 135, 134, 136, 136, 136], "policy_agent_0_reward": [55624.26026535034, 59087.54670715332, 57365.55355834961, 59219.48036193848, 55158.153509140015, 46471.07352232933, 57052.79364013672, 60226.07368469238, 49037.19342327118, 54562.346868515015, 59610.17337036133, 59998.100158691406, 55894.58674240112, 53913.253591537476, 54645.00057411194, 42514.65315246582, 51445.459955215454, 58772.51983642578, 53188.72692775726, 56855.8869934082, 51218.87345504761, 56386.7338180542, 60154.52029418945, 58773.28687667847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.185001623602957, "mean_inference_ms": 6.427790575262859, "mean_action_processing_ms": 0.19904009358238953, "mean_env_wait_ms": 220.50798394021896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051496426264444985, "StateBufferConnector_ms": 0.006223718325297038, "ViewRequirementAgentConnector_ms": 0.2703646818796794}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000, "num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.36198627844254, "num_env_steps_trained_throughput_per_sec": 319.36198627844254, "timesteps_total": 856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 856000, "timers": {"training_iteration_time_ms": 14087.89, "sample_time_ms": 11218.624, "learn_time_ms": 2733.149, "learn_throughput": 1463.514, "synch_weights_time_ms": 135.453}, "counters": {"num_env_steps_sampled": 856000, "num_env_steps_trained": 856000, "num_agent_steps_sampled": 856000, "num_agent_steps_trained": 856000}, "done": false, "episodes_total": 6256, "training_iteration": 214, "trial_id": "32397_00000", "date": "2025-03-21_09-28-43", "timestamp": 1742549323, "time_this_iter_s": 12.585492610931396, "time_total_s": 3086.11421084404, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907edd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3086.11421084404, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 99.48333333333333, "ram_util_percent": 13.56111111111111}}
{"custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.96590805053711, "policy_loss": -0.014144397340714931, "vf_loss": 9.97998046875, "vf_explained_var": 1.4460334796240204e-07, "kl": 0.011512106284499168, "entropy": 0.31573206186294556, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "sampler_results": {"episode_reward_max": 62575.06704711914, "episode_reward_min": 44645.120080947876, "episode_reward_mean": 55892.235173389316, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 44645.120080947876}, "policy_reward_max": {"agent_0": 62575.06704711914}, "policy_reward_mean": {"agent_0": 55892.235173389316}, "custom_metrics": {"num_batches_mean": 5.375, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58074.500259399414, 62575.06704711914, 58627.01343917847, 54482.72010040283, 54536.42029380798, 55433.02005517483, 58764.020111083984, 44645.120080947876], "episode_lengths": [136, 139, 137, 135, 136, 135, 137, 133], "policy_agent_0_reward": [58074.500259399414, 62575.06704711914, 58627.01343917847, 54482.72010040283, 54536.42029380798, 55433.02005517483, 58764.020111083984, 44645.120080947876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.57981725267251, "mean_inference_ms": 6.313373537349862, "mean_action_processing_ms": 0.20128073172881072, "mean_env_wait_ms": 220.2441782271647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0429302453994751, "StateBufferConnector_ms": 0.006243586540222168, "ViewRequirementAgentConnector_ms": 0.18098056316375732}}, "episode_reward_max": 62575.06704711914, "episode_reward_min": 44645.120080947876, "episode_reward_mean": 55892.235173389316, "episode_len_mean": 136.0, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 44645.120080947876}, "policy_reward_max": {"agent_0": 62575.06704711914}, "policy_reward_mean": {"agent_0": 55892.235173389316}, "hist_stats": {"episode_reward": [58074.500259399414, 62575.06704711914, 58627.01343917847, 54482.72010040283, 54536.42029380798, 55433.02005517483, 58764.020111083984, 44645.120080947876], "episode_lengths": [136, 139, 137, 135, 136, 135, 137, 133], "policy_agent_0_reward": [58074.500259399414, 62575.06704711914, 58627.01343917847, 54482.72010040283, 54536.42029380798, 55433.02005517483, 58764.020111083984, 44645.120080947876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.57981725267251, "mean_inference_ms": 6.313373537349862, "mean_action_processing_ms": 0.20128073172881072, "mean_env_wait_ms": 220.2441782271647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0429302453994751, "StateBufferConnector_ms": 0.006243586540222168, "ViewRequirementAgentConnector_ms": 0.18098056316375732}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000, "num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0002653475955, "num_env_steps_trained_throughput_per_sec": 301.0002653475955, "timesteps_total": 860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 860000, "timers": {"training_iteration_time_ms": 14085.407, "sample_time_ms": 11185.185, "learn_time_ms": 2767.814, "learn_throughput": 1445.184, "synch_weights_time_ms": 131.751}, "counters": {"num_env_steps_sampled": 860000, "num_env_steps_trained": 860000, "num_agent_steps_sampled": 860000, "num_agent_steps_trained": 860000}, "done": false, "episodes_total": 6264, "training_iteration": 215, "trial_id": "32397_00000", "date": "2025-03-21_09-28-56", "timestamp": 1742549336, "time_this_iter_s": 13.34533953666687, "time_total_s": 3099.459550380707, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3099.459550380707, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 99.5, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.973918914794922, "policy_loss": -0.01396490540355444, "vf_loss": 9.987793922424316, "vf_explained_var": 7.580965899478542e-08, "kl": 0.014359754510223866, "entropy": 0.3173186182975769, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 59117.273082733154, "episode_reward_min": 50686.713363170624, "episode_reward_mean": 54334.10143995285, "episode_len_mean": 135.2, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"agent_0": 50686.713363170624}, "policy_reward_max": {"agent_0": 59117.273082733154}, "policy_reward_mean": {"agent_0": 54334.10143995285}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56043.32675743103, 50686.713363170624, 53673.18045806885, 59117.273082733154, 52150.013538360596], "episode_lengths": [136, 134, 135, 136, 135], "policy_agent_0_reward": [56043.32675743103, 50686.713363170624, 53673.18045806885, 59117.273082733154, 52150.013538360596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.7826952278295, "mean_inference_ms": 6.409457560025643, "mean_action_processing_ms": 0.19469921278156868, "mean_env_wait_ms": 234.94677726428864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02979278564453125, "StateBufferConnector_ms": 0.004944801330566406, "ViewRequirementAgentConnector_ms": 0.21326541900634766}}, "episode_reward_max": 59117.273082733154, "episode_reward_min": 50686.713363170624, "episode_reward_mean": 54334.10143995285, "episode_len_mean": 135.2, "episodes_this_iter": 5, "policy_reward_min": {"agent_0": 50686.713363170624}, "policy_reward_max": {"agent_0": 59117.273082733154}, "policy_reward_mean": {"agent_0": 54334.10143995285}, "hist_stats": {"episode_reward": [56043.32675743103, 50686.713363170624, 53673.18045806885, 59117.273082733154, 52150.013538360596], "episode_lengths": [136, 134, 135, 136, 135], "policy_agent_0_reward": [56043.32675743103, 50686.713363170624, 53673.18045806885, 59117.273082733154, 52150.013538360596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.7826952278295, "mean_inference_ms": 6.409457560025643, "mean_action_processing_ms": 0.19469921278156868, "mean_env_wait_ms": 234.94677726428864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02979278564453125, "StateBufferConnector_ms": 0.004944801330566406, "ViewRequirementAgentConnector_ms": 0.21326541900634766}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.05065040933545, "num_env_steps_trained_throughput_per_sec": 294.05065040933545, "timesteps_total": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 13989.458, "sample_time_ms": 11025.767, "learn_time_ms": 2826.95, "learn_throughput": 1414.953, "synch_weights_time_ms": 136.078}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 6269, "training_iteration": 216, "trial_id": "32397_00000", "date": "2025-03-21_09-29-10", "timestamp": 1742549350, "time_this_iter_s": 13.655311822891235, "time_total_s": 3113.114862203598, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907fd90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3113.114862203598, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 99.53684210526318, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.2988505747126435, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.769649505615234, "policy_loss": -0.012411772273480892, "vf_loss": 9.781982421875, "vf_explained_var": 3.4868716625169327e-07, "kl": 0.012468797154724598, "entropy": 0.34700486063957214, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "sampler_results": {"episode_reward_max": 61513.89343261719, "episode_reward_min": 46819.48015868664, "episode_reward_mean": 56677.38427501403, "episode_len_mean": 135.89655172413794, "episode_media": {}, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 46819.48015868664}, "policy_reward_max": {"agent_0": 61513.89343261719}, "policy_reward_mean": {"agent_0": 56677.38427501403}, "custom_metrics": {"num_batches_mean": 5.2988505747126435, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60345.43328857422, 53448.986774683, 50494.93348503113, 54607.21356725693, 56066.3798828125, 59499.52053833008, 58000.34010505676, 59600.42007446289, 49649.52019765973, 57842.740295410156, 56982.013563871384, 56484.68681716919, 46819.48015868664, 60991.2536315918, 54580.38703536987, 59555.460388183594, 52678.80673980713, 51810.32013320923, 59985.33352661133, 55523.92021369934, 57819.246826171875, 57563.07353925705, 54675.973462581635, 58224.81350708008, 59098.46072816849, 54409.12681007385, 61286.52029418945, 50774.19347381592, 55941.08675956726, 60881.07354736328, 59171.213623046875, 59957.98031616211, 58957.60688781738, 57565.60041999817, 58974.45379638672, 57821.62681007385, 59255.14673614502, 56858.30679702759, 57763.24692153931, 55669.346771240234, 56302.24028778076, 57107.27367401123, 51371.026834487915, 60229.586822509766, 58592.45363044739, 56400.206886291504, 60631.00032043457, 57660.35347747803, 53671.82692909241, 57216.88010406494, 52312.693546295166, 52124.45363616943, 53333.119992256165, 57761.76021003723, 52213.993362009525, 58144.78029632568, 54730.63340759277, 56590.226806640625, 59809.107192993164, 54932.2137298584, 55981.58669281006, 53294.320283174515, 57522.146827697754, 57478.39337158203, 58004.04684352875, 58660.0270690918, 55835.380029678345, 59380.90034484863, 59703.13374710083, 59357.89370727539, 57302.680114746094, 58484.193504333496, 53609.326807022095, 55210.10643196106, 56304.060032367706, 54799.04704093933, 61426.440185546875, 59557.88691329956, 57879.280265808105, 58670.560220718384, 61513.89343261719, 58790.84044647217, 52919.96026754379, 55947.67375564575, 53597.90701389313, 58882.373474121094, 52047.29351043701], "episode_lengths": [137, 134, 135, 135, 135, 136, 138, 138, 134, 136, 136, 136, 134, 138, 136, 136, 135, 134, 137, 136, 136, 136, 135, 135, 137, 135, 137, 135, 136, 137, 136, 137, 137, 136, 137, 136, 137, 136, 136, 135, 135, 136, 135, 137, 137, 136, 137, 137, 135, 136, 135, 134, 135, 136, 133, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 137, 136, 137, 136, 136, 135, 136, 137, 135, 136, 135, 138, 137, 136, 136, 138, 137, 136, 135, 136, 136, 134], "policy_agent_0_reward": [60345.43328857422, 53448.986774683, 50494.93348503113, 54607.21356725693, 56066.3798828125, 59499.52053833008, 58000.34010505676, 59600.42007446289, 49649.52019765973, 57842.740295410156, 56982.013563871384, 56484.68681716919, 46819.48015868664, 60991.2536315918, 54580.38703536987, 59555.460388183594, 52678.80673980713, 51810.32013320923, 59985.33352661133, 55523.92021369934, 57819.246826171875, 57563.07353925705, 54675.973462581635, 58224.81350708008, 59098.46072816849, 54409.12681007385, 61286.52029418945, 50774.19347381592, 55941.08675956726, 60881.07354736328, 59171.213623046875, 59957.98031616211, 58957.60688781738, 57565.60041999817, 58974.45379638672, 57821.62681007385, 59255.14673614502, 56858.30679702759, 57763.24692153931, 55669.346771240234, 56302.24028778076, 57107.27367401123, 51371.026834487915, 60229.586822509766, 58592.45363044739, 56400.206886291504, 60631.00032043457, 57660.35347747803, 53671.82692909241, 57216.88010406494, 52312.693546295166, 52124.45363616943, 53333.119992256165, 57761.76021003723, 52213.993362009525, 58144.78029632568, 54730.63340759277, 56590.226806640625, 59809.107192993164, 54932.2137298584, 55981.58669281006, 53294.320283174515, 57522.146827697754, 57478.39337158203, 58004.04684352875, 58660.0270690918, 55835.380029678345, 59380.90034484863, 59703.13374710083, 59357.89370727539, 57302.680114746094, 58484.193504333496, 53609.326807022095, 55210.10643196106, 56304.060032367706, 54799.04704093933, 61426.440185546875, 59557.88691329956, 57879.280265808105, 58670.560220718384, 61513.89343261719, 58790.84044647217, 52919.96026754379, 55947.67375564575, 53597.90701389313, 58882.373474121094, 52047.29351043701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.92087663037301, "mean_inference_ms": 6.773735928553021, "mean_action_processing_ms": 0.19646236086673413, "mean_env_wait_ms": 231.6800889804485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044961085264710175, "StateBufferConnector_ms": 0.005976085005135372, "ViewRequirementAgentConnector_ms": 0.24987308458350171}}, "episode_reward_max": 61513.89343261719, "episode_reward_min": 46819.48015868664, "episode_reward_mean": 56677.38427501403, "episode_len_mean": 135.89655172413794, "episodes_this_iter": 87, "policy_reward_min": {"agent_0": 46819.48015868664}, "policy_reward_max": {"agent_0": 61513.89343261719}, "policy_reward_mean": {"agent_0": 56677.38427501403}, "hist_stats": {"episode_reward": [60345.43328857422, 53448.986774683, 50494.93348503113, 54607.21356725693, 56066.3798828125, 59499.52053833008, 58000.34010505676, 59600.42007446289, 49649.52019765973, 57842.740295410156, 56982.013563871384, 56484.68681716919, 46819.48015868664, 60991.2536315918, 54580.38703536987, 59555.460388183594, 52678.80673980713, 51810.32013320923, 59985.33352661133, 55523.92021369934, 57819.246826171875, 57563.07353925705, 54675.973462581635, 58224.81350708008, 59098.46072816849, 54409.12681007385, 61286.52029418945, 50774.19347381592, 55941.08675956726, 60881.07354736328, 59171.213623046875, 59957.98031616211, 58957.60688781738, 57565.60041999817, 58974.45379638672, 57821.62681007385, 59255.14673614502, 56858.30679702759, 57763.24692153931, 55669.346771240234, 56302.24028778076, 57107.27367401123, 51371.026834487915, 60229.586822509766, 58592.45363044739, 56400.206886291504, 60631.00032043457, 57660.35347747803, 53671.82692909241, 57216.88010406494, 52312.693546295166, 52124.45363616943, 53333.119992256165, 57761.76021003723, 52213.993362009525, 58144.78029632568, 54730.63340759277, 56590.226806640625, 59809.107192993164, 54932.2137298584, 55981.58669281006, 53294.320283174515, 57522.146827697754, 57478.39337158203, 58004.04684352875, 58660.0270690918, 55835.380029678345, 59380.90034484863, 59703.13374710083, 59357.89370727539, 57302.680114746094, 58484.193504333496, 53609.326807022095, 55210.10643196106, 56304.060032367706, 54799.04704093933, 61426.440185546875, 59557.88691329956, 57879.280265808105, 58670.560220718384, 61513.89343261719, 58790.84044647217, 52919.96026754379, 55947.67375564575, 53597.90701389313, 58882.373474121094, 52047.29351043701], "episode_lengths": [137, 134, 135, 135, 135, 136, 138, 138, 134, 136, 136, 136, 134, 138, 136, 136, 135, 134, 137, 136, 136, 136, 135, 135, 137, 135, 137, 135, 136, 137, 136, 137, 137, 136, 137, 136, 137, 136, 136, 135, 135, 136, 135, 137, 137, 136, 137, 137, 135, 136, 135, 134, 135, 136, 133, 136, 135, 136, 136, 136, 135, 135, 136, 135, 136, 137, 136, 137, 136, 136, 135, 136, 137, 135, 136, 135, 138, 137, 136, 136, 138, 137, 136, 135, 136, 136, 134], "policy_agent_0_reward": [60345.43328857422, 53448.986774683, 50494.93348503113, 54607.21356725693, 56066.3798828125, 59499.52053833008, 58000.34010505676, 59600.42007446289, 49649.52019765973, 57842.740295410156, 56982.013563871384, 56484.68681716919, 46819.48015868664, 60991.2536315918, 54580.38703536987, 59555.460388183594, 52678.80673980713, 51810.32013320923, 59985.33352661133, 55523.92021369934, 57819.246826171875, 57563.07353925705, 54675.973462581635, 58224.81350708008, 59098.46072816849, 54409.12681007385, 61286.52029418945, 50774.19347381592, 55941.08675956726, 60881.07354736328, 59171.213623046875, 59957.98031616211, 58957.60688781738, 57565.60041999817, 58974.45379638672, 57821.62681007385, 59255.14673614502, 56858.30679702759, 57763.24692153931, 55669.346771240234, 56302.24028778076, 57107.27367401123, 51371.026834487915, 60229.586822509766, 58592.45363044739, 56400.206886291504, 60631.00032043457, 57660.35347747803, 53671.82692909241, 57216.88010406494, 52312.693546295166, 52124.45363616943, 53333.119992256165, 57761.76021003723, 52213.993362009525, 58144.78029632568, 54730.63340759277, 56590.226806640625, 59809.107192993164, 54932.2137298584, 55981.58669281006, 53294.320283174515, 57522.146827697754, 57478.39337158203, 58004.04684352875, 58660.0270690918, 55835.380029678345, 59380.90034484863, 59703.13374710083, 59357.89370727539, 57302.680114746094, 58484.193504333496, 53609.326807022095, 55210.10643196106, 56304.060032367706, 54799.04704093933, 61426.440185546875, 59557.88691329956, 57879.280265808105, 58670.560220718384, 61513.89343261719, 58790.84044647217, 52919.96026754379, 55947.67375564575, 53597.90701389313, 58882.373474121094, 52047.29351043701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.92087663037301, "mean_inference_ms": 6.773735928553021, "mean_action_processing_ms": 0.19646236086673413, "mean_env_wait_ms": 231.6800889804485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044961085264710175, "StateBufferConnector_ms": 0.005976085005135372, "ViewRequirementAgentConnector_ms": 0.24987308458350171}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000, "num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.75734889450993, "num_env_steps_trained_throughput_per_sec": 243.75734889450993, "timesteps_total": 868000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 868000, "timers": {"training_iteration_time_ms": 14383.958, "sample_time_ms": 11412.813, "learn_time_ms": 2830.666, "learn_throughput": 1413.095, "synch_weights_time_ms": 139.806}, "counters": {"num_env_steps_sampled": 868000, "num_env_steps_trained": 868000, "num_agent_steps_sampled": 868000, "num_agent_steps_trained": 868000}, "done": false, "episodes_total": 6356, "training_iteration": 217, "trial_id": "32397_00000", "date": "2025-03-21_09-29-26", "timestamp": 1742549366, "time_this_iter_s": 16.465632677078247, "time_total_s": 3129.5804948806763, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907e320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3129.5804948806763, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 97.53750000000001, "ram_util_percent": 13.566666666666668}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.94205379486084, "policy_loss": -0.0133926747366786, "vf_loss": 9.955343246459961, "vf_explained_var": -9.725739801069722e-06, "kl": 0.01642126403748989, "entropy": 0.3799493610858917, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "sampler_results": {"episode_reward_max": 60302.080474853516, "episode_reward_min": 51014.626651763916, "episode_reward_mean": 56071.124345332384, "episode_len_mean": 135.375, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51014.626651763916}, "policy_reward_max": {"agent_0": 60302.080474853516}, "policy_reward_mean": {"agent_0": 56071.124345332384}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58993.63342285156, 55101.659969329834, 57870.89317321777, 55021.13367462158, 51014.626651763916, 52698.13342666626, 57496.40690612793, 56842.700019836426, 54666.067084789276, 53384.9933719635, 57809.720375061035, 55478.94009780884, 60019.93380737305, 58690.75369262695, 60302.080474853516, 51746.3133764267], "episode_lengths": [136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 137, 135], "policy_agent_0_reward": [58993.63342285156, 55101.659969329834, 57870.89317321777, 55021.13367462158, 51014.626651763916, 52698.13342666626, 57496.40690612793, 56842.700019836426, 54666.067084789276, 53384.9933719635, 57809.720375061035, 55478.94009780884, 60019.93380737305, 58690.75369262695, 60302.080474853516, 51746.3133764267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.340392349742203, "mean_inference_ms": 6.358322511537777, "mean_action_processing_ms": 0.19894421639087884, "mean_env_wait_ms": 220.35729447075525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13758987188339233, "StateBufferConnector_ms": 0.005917251110076904, "ViewRequirementAgentConnector_ms": 0.17733722925186157}}, "episode_reward_max": 60302.080474853516, "episode_reward_min": 51014.626651763916, "episode_reward_mean": 56071.124345332384, "episode_len_mean": 135.375, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 51014.626651763916}, "policy_reward_max": {"agent_0": 60302.080474853516}, "policy_reward_mean": {"agent_0": 56071.124345332384}, "hist_stats": {"episode_reward": [58993.63342285156, 55101.659969329834, 57870.89317321777, 55021.13367462158, 51014.626651763916, 52698.13342666626, 57496.40690612793, 56842.700019836426, 54666.067084789276, 53384.9933719635, 57809.720375061035, 55478.94009780884, 60019.93380737305, 58690.75369262695, 60302.080474853516, 51746.3133764267], "episode_lengths": [136, 136, 135, 135, 135, 135, 135, 135, 135, 135, 135, 135, 137, 135, 137, 135], "policy_agent_0_reward": [58993.63342285156, 55101.659969329834, 57870.89317321777, 55021.13367462158, 51014.626651763916, 52698.13342666626, 57496.40690612793, 56842.700019836426, 54666.067084789276, 53384.9933719635, 57809.720375061035, 55478.94009780884, 60019.93380737305, 58690.75369262695, 60302.080474853516, 51746.3133764267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.340392349742203, "mean_inference_ms": 6.358322511537777, "mean_action_processing_ms": 0.19894421639087884, "mean_env_wait_ms": 220.35729447075525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.13758987188339233, "StateBufferConnector_ms": 0.005917251110076904, "ViewRequirementAgentConnector_ms": 0.17733722925186157}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000, "num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4250942170829, "num_env_steps_trained_throughput_per_sec": 311.4250942170829, "timesteps_total": 872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 872000, "timers": {"training_iteration_time_ms": 14178.186, "sample_time_ms": 11195.025, "learn_time_ms": 2843.828, "learn_throughput": 1406.555, "synch_weights_time_ms": 138.657}, "counters": {"num_env_steps_sampled": 872000, "num_env_steps_trained": 872000, "num_agent_steps_sampled": 872000, "num_agent_steps_trained": 872000}, "done": false, "episodes_total": 6372, "training_iteration": 218, "trial_id": "32397_00000", "date": "2025-03-21_09-29-39", "timestamp": 1742549379, "time_this_iter_s": 12.896643877029419, "time_total_s": 3142.4771387577057, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907e3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3142.4771387577057, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 99.13333333333334, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.4375, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.946699142456055, "policy_loss": -0.01359094213694334, "vf_loss": 9.960205078125, "vf_explained_var": -3.7050494938739575e-06, "kl": 0.013444344513118267, "entropy": 0.40413373708724976, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 61508.060546875, "episode_reward_min": 49423.85340118408, "episode_reward_mean": 56554.4438932091, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 49423.85340118408}, "policy_reward_max": {"agent_0": 61508.060546875}, "policy_reward_mean": {"agent_0": 56554.4438932091}, "custom_metrics": {"num_batches_mean": 5.4375, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55781.96673202515, 54482.33330535889, 54320.34650039673, 57743.393394470215, 57232.913427352905, 59938.45343017578, 58228.96017098427, 51339.41345787048, 61508.060546875, 49423.85340118408, 57059.553661346436, 60589.32040977478, 58270.84662723541, 60253.380058288574, 55129.5003118515, 53568.806856155396], "episode_lengths": [135, 135, 135, 136, 136, 137, 137, 135, 137, 134, 138, 137, 136, 137, 136, 135], "policy_agent_0_reward": [55781.96673202515, 54482.33330535889, 54320.34650039673, 57743.393394470215, 57232.913427352905, 59938.45343017578, 58228.96017098427, 51339.41345787048, 61508.060546875, 49423.85340118408, 57059.553661346436, 60589.32040977478, 58270.84662723541, 60253.380058288574, 55129.5003118515, 53568.806856155396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.7532894054235, "mean_inference_ms": 6.425029845051695, "mean_action_processing_ms": 0.20008126410846894, "mean_env_wait_ms": 220.16016459870752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04014819860458374, "StateBufferConnector_ms": 0.00635683536529541, "ViewRequirementAgentConnector_ms": 0.17121285200119019}}, "episode_reward_max": 61508.060546875, "episode_reward_min": 49423.85340118408, "episode_reward_mean": 56554.4438932091, "episode_len_mean": 136.0, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 49423.85340118408}, "policy_reward_max": {"agent_0": 61508.060546875}, "policy_reward_mean": {"agent_0": 56554.4438932091}, "hist_stats": {"episode_reward": [55781.96673202515, 54482.33330535889, 54320.34650039673, 57743.393394470215, 57232.913427352905, 59938.45343017578, 58228.96017098427, 51339.41345787048, 61508.060546875, 49423.85340118408, 57059.553661346436, 60589.32040977478, 58270.84662723541, 60253.380058288574, 55129.5003118515, 53568.806856155396], "episode_lengths": [135, 135, 135, 136, 136, 137, 137, 135, 137, 134, 138, 137, 136, 137, 136, 135], "policy_agent_0_reward": [55781.96673202515, 54482.33330535889, 54320.34650039673, 57743.393394470215, 57232.913427352905, 59938.45343017578, 58228.96017098427, 51339.41345787048, 61508.060546875, 49423.85340118408, 57059.553661346436, 60589.32040977478, 58270.84662723541, 60253.380058288574, 55129.5003118515, 53568.806856155396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.7532894054235, "mean_inference_ms": 6.425029845051695, "mean_action_processing_ms": 0.20008126410846894, "mean_env_wait_ms": 220.16016459870752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04014819860458374, "StateBufferConnector_ms": 0.00635683536529541, "ViewRequirementAgentConnector_ms": 0.17121285200119019}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.665147358066, "num_env_steps_trained_throughput_per_sec": 292.665147358066, "timesteps_total": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 14052.497, "sample_time_ms": 11110.661, "learn_time_ms": 2800.056, "learn_throughput": 1428.543, "synch_weights_time_ms": 141.116}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 6388, "training_iteration": 219, "trial_id": "32397_00000", "date": "2025-03-21_09-29-53", "timestamp": 1742549393, "time_this_iter_s": 13.721967220306396, "time_total_s": 3156.199105978012, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f7f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3156.199105978012, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 99.41052631578948, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986153602600098, "policy_loss": -0.013928034342825413, "vf_loss": 10.0, "vf_explained_var": -1.3236577842690167e-06, "kl": 0.012994498014450073, "entropy": 0.3075345456600189, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "sampler_results": {"episode_reward_max": 53568.806856155396, "episode_reward_min": 53568.806856155396, "episode_reward_mean": 53568.806856155396, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53568.806856155396}, "policy_reward_max": {"agent_0": 53568.806856155396}, "policy_reward_mean": {"agent_0": 53568.806856155396}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53568.806856155396], "episode_lengths": [135], "policy_agent_0_reward": [53568.806856155396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.220507018791753, "mean_inference_ms": 6.0149000768972885, "mean_action_processing_ms": 0.19772968440010988, "mean_env_wait_ms": 224.14429836267917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039768218994140625, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16222000122070312}}, "episode_reward_max": 53568.806856155396, "episode_reward_min": 53568.806856155396, "episode_reward_mean": 53568.806856155396, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53568.806856155396}, "policy_reward_max": {"agent_0": 53568.806856155396}, "policy_reward_mean": {"agent_0": 53568.806856155396}, "hist_stats": {"episode_reward": [53568.806856155396], "episode_lengths": [135], "policy_agent_0_reward": [53568.806856155396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.220507018791753, "mean_inference_ms": 6.0149000768972885, "mean_action_processing_ms": 0.19772968440010988, "mean_env_wait_ms": 224.14429836267917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039768218994140625, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.16222000122070312}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.6200048817613, "num_env_steps_trained_throughput_per_sec": 293.6200048817613, "timesteps_total": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 13966.019, "sample_time_ms": 10974.966, "learn_time_ms": 2847.508, "learn_throughput": 1404.737, "synch_weights_time_ms": 142.874}, "counters": {"num_env_steps_sampled": 880000, "num_env_steps_trained": 880000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "episodes_total": 6388, "training_iteration": 220, "trial_id": "32397_00000", "date": "2025-03-21_09-30-07", "timestamp": 1742549407, "time_this_iter_s": 13.68049430847168, "time_total_s": 3169.8796002864838, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f95bd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3169.8796002864838, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 99.60000000000001, "ram_util_percent": 13.557894736842107}}
{"custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.749432563781738, "policy_loss": -0.013833139091730118, "vf_loss": 9.763184547424316, "vf_explained_var": -4.115203864785144e-06, "kl": 0.012835630215704441, "entropy": 0.29496127367019653, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "sampler_results": {"episode_reward_max": 61389.23352050781, "episode_reward_min": 46239.90674448013, "episode_reward_mean": 55956.64930902551, "episode_len_mean": 135.75, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46239.90674448013}, "policy_reward_max": {"agent_0": 61389.23352050781}, "policy_reward_mean": {"agent_0": 55956.64930902551}, "custom_metrics": {"num_batches_mean": 5.032608695652174, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58493.47344970703, 53883.77345466614, 56202.09341049194, 58481.853424072266, 59833.90042114258, 47954.54016041756, 55389.95324420929, 50636.36661142111, 54854.23342323303, 53373.813343048096, 51199.76016998291, 57132.52688121796, 57001.466970443726, 58666.62699890137, 60795.100189208984, 52338.04674911499, 51909.23361182213, 59429.97361755371, 58490.83363342285, 54630.61357975006, 56630.460136413574, 50711.44021129608, 57609.953426361084, 56278.113673210144, 57748.78673171997, 54473.77323246002, 59307.30725097656, 58945.293716430664, 57692.09338951111, 53704.466651916504, 58647.18651199341, 55065.72003555298, 58248.4001159668, 53242.77330040932, 58455.846839904785, 55647.88673233986, 52490.366596221924, 56274.09362030029, 57792.966857910156, 57882.44666099548, 55652.226821899414, 54959.02016830444, 58963.20031738281, 51689.06022620201, 54958.5469121933, 58853.800201416016, 58469.54018783569, 57653.09327697754, 54313.06004142761, 57554.5136680603, 58752.146728515625, 56586.95362949371, 51989.693449020386, 57891.360511779785, 52605.03350067139, 56791.22673034668, 49840.893446445465, 60163.37356567383, 56084.78685760498, 54815.20005321503, 56083.78685975075, 49826.087052583694, 58338.56690979004, 57672.40701293945, 50878.08676338196, 57437.44031906128, 49941.76676940918, 52901.4001083374, 57004.6869430542, 57435.607067108154, 52477.833377838135, 58370.54007053375, 50530.64686155319, 58766.607025146484, 61389.23352050781, 54384.46015357971, 58547.860206604004, 58911.006774902344, 56890.38695335388, 59990.75345611572, 59782.11331176758, 58745.83370780945, 57616.02668571472, 57678.48696899414, 49234.686898231506, 59213.120376586914, 60479.39366149902, 56995.066915512085, 52017.21341228485, 56877.73355102539, 59218.70066070557, 46239.90674448013], "episode_lengths": [136, 136, 136, 136, 136, 135, 135, 135, 135, 135, 134, 136, 136, 136, 137, 136, 134, 135, 136, 136, 135, 136, 137, 136, 137, 135, 136, 136, 136, 135, 135, 136, 136, 133, 137, 136, 135, 136, 136, 137, 135, 136, 138, 135, 135, 136, 136, 135, 136, 137, 137, 136, 134, 136, 135, 136, 133, 137, 135, 136, 136, 135, 136, 136, 133, 136, 134, 135, 136, 136, 135, 136, 135, 136, 137, 135, 136, 136, 137, 137, 137, 136, 137, 137, 135, 137, 137, 137, 135, 137, 137, 133], "policy_agent_0_reward": [58493.47344970703, 53883.77345466614, 56202.09341049194, 58481.853424072266, 59833.90042114258, 47954.54016041756, 55389.95324420929, 50636.36661142111, 54854.23342323303, 53373.813343048096, 51199.76016998291, 57132.52688121796, 57001.466970443726, 58666.62699890137, 60795.100189208984, 52338.04674911499, 51909.23361182213, 59429.97361755371, 58490.83363342285, 54630.61357975006, 56630.460136413574, 50711.44021129608, 57609.953426361084, 56278.113673210144, 57748.78673171997, 54473.77323246002, 59307.30725097656, 58945.293716430664, 57692.09338951111, 53704.466651916504, 58647.18651199341, 55065.72003555298, 58248.4001159668, 53242.77330040932, 58455.846839904785, 55647.88673233986, 52490.366596221924, 56274.09362030029, 57792.966857910156, 57882.44666099548, 55652.226821899414, 54959.02016830444, 58963.20031738281, 51689.06022620201, 54958.5469121933, 58853.800201416016, 58469.54018783569, 57653.09327697754, 54313.06004142761, 57554.5136680603, 58752.146728515625, 56586.95362949371, 51989.693449020386, 57891.360511779785, 52605.03350067139, 56791.22673034668, 49840.893446445465, 60163.37356567383, 56084.78685760498, 54815.20005321503, 56083.78685975075, 49826.087052583694, 58338.56690979004, 57672.40701293945, 50878.08676338196, 57437.44031906128, 49941.76676940918, 52901.4001083374, 57004.6869430542, 57435.607067108154, 52477.833377838135, 58370.54007053375, 50530.64686155319, 58766.607025146484, 61389.23352050781, 54384.46015357971, 58547.860206604004, 58911.006774902344, 56890.38695335388, 59990.75345611572, 59782.11331176758, 58745.83370780945, 57616.02668571472, 57678.48696899414, 49234.686898231506, 59213.120376586914, 60479.39366149902, 56995.066915512085, 52017.21341228485, 56877.73355102539, 59218.70066070557, 46239.90674448013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.65005008633211, "mean_inference_ms": 6.751117888455377, "mean_action_processing_ms": 0.19632990338759992, "mean_env_wait_ms": 231.76556324850205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04774487536886464, "StateBufferConnector_ms": 0.005981455678525178, "ViewRequirementAgentConnector_ms": 0.16946507536846658}}, "episode_reward_max": 61389.23352050781, "episode_reward_min": 46239.90674448013, "episode_reward_mean": 55956.64930902551, "episode_len_mean": 135.75, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46239.90674448013}, "policy_reward_max": {"agent_0": 61389.23352050781}, "policy_reward_mean": {"agent_0": 55956.64930902551}, "hist_stats": {"episode_reward": [58493.47344970703, 53883.77345466614, 56202.09341049194, 58481.853424072266, 59833.90042114258, 47954.54016041756, 55389.95324420929, 50636.36661142111, 54854.23342323303, 53373.813343048096, 51199.76016998291, 57132.52688121796, 57001.466970443726, 58666.62699890137, 60795.100189208984, 52338.04674911499, 51909.23361182213, 59429.97361755371, 58490.83363342285, 54630.61357975006, 56630.460136413574, 50711.44021129608, 57609.953426361084, 56278.113673210144, 57748.78673171997, 54473.77323246002, 59307.30725097656, 58945.293716430664, 57692.09338951111, 53704.466651916504, 58647.18651199341, 55065.72003555298, 58248.4001159668, 53242.77330040932, 58455.846839904785, 55647.88673233986, 52490.366596221924, 56274.09362030029, 57792.966857910156, 57882.44666099548, 55652.226821899414, 54959.02016830444, 58963.20031738281, 51689.06022620201, 54958.5469121933, 58853.800201416016, 58469.54018783569, 57653.09327697754, 54313.06004142761, 57554.5136680603, 58752.146728515625, 56586.95362949371, 51989.693449020386, 57891.360511779785, 52605.03350067139, 56791.22673034668, 49840.893446445465, 60163.37356567383, 56084.78685760498, 54815.20005321503, 56083.78685975075, 49826.087052583694, 58338.56690979004, 57672.40701293945, 50878.08676338196, 57437.44031906128, 49941.76676940918, 52901.4001083374, 57004.6869430542, 57435.607067108154, 52477.833377838135, 58370.54007053375, 50530.64686155319, 58766.607025146484, 61389.23352050781, 54384.46015357971, 58547.860206604004, 58911.006774902344, 56890.38695335388, 59990.75345611572, 59782.11331176758, 58745.83370780945, 57616.02668571472, 57678.48696899414, 49234.686898231506, 59213.120376586914, 60479.39366149902, 56995.066915512085, 52017.21341228485, 56877.73355102539, 59218.70066070557, 46239.90674448013], "episode_lengths": [136, 136, 136, 136, 136, 135, 135, 135, 135, 135, 134, 136, 136, 136, 137, 136, 134, 135, 136, 136, 135, 136, 137, 136, 137, 135, 136, 136, 136, 135, 135, 136, 136, 133, 137, 136, 135, 136, 136, 137, 135, 136, 138, 135, 135, 136, 136, 135, 136, 137, 137, 136, 134, 136, 135, 136, 133, 137, 135, 136, 136, 135, 136, 136, 133, 136, 134, 135, 136, 136, 135, 136, 135, 136, 137, 135, 136, 136, 137, 137, 137, 136, 137, 137, 135, 137, 137, 137, 135, 137, 137, 133], "policy_agent_0_reward": [58493.47344970703, 53883.77345466614, 56202.09341049194, 58481.853424072266, 59833.90042114258, 47954.54016041756, 55389.95324420929, 50636.36661142111, 54854.23342323303, 53373.813343048096, 51199.76016998291, 57132.52688121796, 57001.466970443726, 58666.62699890137, 60795.100189208984, 52338.04674911499, 51909.23361182213, 59429.97361755371, 58490.83363342285, 54630.61357975006, 56630.460136413574, 50711.44021129608, 57609.953426361084, 56278.113673210144, 57748.78673171997, 54473.77323246002, 59307.30725097656, 58945.293716430664, 57692.09338951111, 53704.466651916504, 58647.18651199341, 55065.72003555298, 58248.4001159668, 53242.77330040932, 58455.846839904785, 55647.88673233986, 52490.366596221924, 56274.09362030029, 57792.966857910156, 57882.44666099548, 55652.226821899414, 54959.02016830444, 58963.20031738281, 51689.06022620201, 54958.5469121933, 58853.800201416016, 58469.54018783569, 57653.09327697754, 54313.06004142761, 57554.5136680603, 58752.146728515625, 56586.95362949371, 51989.693449020386, 57891.360511779785, 52605.03350067139, 56791.22673034668, 49840.893446445465, 60163.37356567383, 56084.78685760498, 54815.20005321503, 56083.78685975075, 49826.087052583694, 58338.56690979004, 57672.40701293945, 50878.08676338196, 57437.44031906128, 49941.76676940918, 52901.4001083374, 57004.6869430542, 57435.607067108154, 52477.833377838135, 58370.54007053375, 50530.64686155319, 58766.607025146484, 61389.23352050781, 54384.46015357971, 58547.860206604004, 58911.006774902344, 56890.38695335388, 59990.75345611572, 59782.11331176758, 58745.83370780945, 57616.02668571472, 57678.48696899414, 49234.686898231506, 59213.120376586914, 60479.39366149902, 56995.066915512085, 52017.21341228485, 56877.73355102539, 59218.70066070557, 46239.90674448013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.65005008633211, "mean_inference_ms": 6.751117888455377, "mean_action_processing_ms": 0.19632990338759992, "mean_env_wait_ms": 231.76556324850205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04774487536886464, "StateBufferConnector_ms": 0.005981455678525178, "ViewRequirementAgentConnector_ms": 0.16946507536846658}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000, "num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.5869926633957, "num_env_steps_trained_throughput_per_sec": 234.5869926633957, "timesteps_total": 884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 884000, "timers": {"training_iteration_time_ms": 14400.459, "sample_time_ms": 11437.19, "learn_time_ms": 2813.939, "learn_throughput": 1421.495, "synch_weights_time_ms": 148.654}, "counters": {"num_env_steps_sampled": 884000, "num_env_steps_trained": 884000, "num_agent_steps_sampled": 884000, "num_agent_steps_trained": 884000}, "done": false, "episodes_total": 6480, "training_iteration": 221, "trial_id": "32397_00000", "date": "2025-03-21_09-30-24", "timestamp": 1742549424, "time_this_iter_s": 17.099881887435913, "time_total_s": 3186.9794821739197, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3186.9794821739197, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 97.67500000000001, "ram_util_percent": 13.545833333333334}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.960587501525879, "policy_loss": -0.008986856788396835, "vf_loss": 9.969499588012695, "vf_explained_var": -8.069351679296233e-06, "kl": 0.011849972419440746, "entropy": 0.31723275780677795, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 60673.99378967285, "episode_reward_min": 51387.233510017395, "episode_reward_mean": 55674.53648100959, "episode_len_mean": 135.55555555555554, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 51387.233510017395}, "policy_reward_max": {"agent_0": 60673.99378967285}, "policy_reward_mean": {"agent_0": 55674.53648100959}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56183.78024291992, 55605.10026931763, 57029.400215148926, 52537.51342964172, 54073.71341228485, 57318.70676422119, 51387.233510017395, 60673.99378967285, 56261.38669586182], "episode_lengths": [135, 136, 136, 136, 134, 136, 135, 137, 135], "policy_agent_0_reward": [56183.78024291992, 55605.10026931763, 57029.400215148926, 52537.51342964172, 54073.71341228485, 57318.70676422119, 51387.233510017395, 60673.99378967285, 56261.38669586182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.168369875948784, "mean_inference_ms": 6.339285546256764, "mean_action_processing_ms": 0.19843999221913058, "mean_env_wait_ms": 219.98885952251138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039948357476128474, "StateBufferConnector_ms": 0.006283654106987847, "ViewRequirementAgentConnector_ms": 0.16691419813368055}}, "episode_reward_max": 60673.99378967285, "episode_reward_min": 51387.233510017395, "episode_reward_mean": 55674.53648100959, "episode_len_mean": 135.55555555555554, "episodes_this_iter": 9, "policy_reward_min": {"agent_0": 51387.233510017395}, "policy_reward_max": {"agent_0": 60673.99378967285}, "policy_reward_mean": {"agent_0": 55674.53648100959}, "hist_stats": {"episode_reward": [56183.78024291992, 55605.10026931763, 57029.400215148926, 52537.51342964172, 54073.71341228485, 57318.70676422119, 51387.233510017395, 60673.99378967285, 56261.38669586182], "episode_lengths": [135, 136, 136, 136, 134, 136, 135, 137, 135], "policy_agent_0_reward": [56183.78024291992, 55605.10026931763, 57029.400215148926, 52537.51342964172, 54073.71341228485, 57318.70676422119, 51387.233510017395, 60673.99378967285, 56261.38669586182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 19.168369875948784, "mean_inference_ms": 6.339285546256764, "mean_action_processing_ms": 0.19843999221913058, "mean_env_wait_ms": 219.98885952251138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039948357476128474, "StateBufferConnector_ms": 0.006283654106987847, "ViewRequirementAgentConnector_ms": 0.16691419813368055}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.5023843069713, "num_env_steps_trained_throughput_per_sec": 290.5023843069713, "timesteps_total": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 14475.071, "sample_time_ms": 11410.208, "learn_time_ms": 2914.275, "learn_throughput": 1372.554, "synch_weights_time_ms": 149.921}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 6489, "training_iteration": 222, "trial_id": "32397_00000", "date": "2025-03-21_09-30-38", "timestamp": 1742549438, "time_this_iter_s": 13.820770978927612, "time_total_s": 3200.8002531528473, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f952d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3200.8002531528473, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 99.50526315789475, "ram_util_percent": 13.573684210526315}}
{"custom_metrics": {"num_batches_mean": 5.173913043478261, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.914892196655273, "policy_loss": -0.015123636461794376, "vf_loss": 9.929944038391113, "vf_explained_var": -8.100892046059016e-06, "kl": 0.011616211384534836, "entropy": 0.3318440616130829, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "sampler_results": {"episode_reward_max": 61060.61352729797, "episode_reward_min": 43427.913513183594, "episode_reward_mean": 55733.60888592056, "episode_len_mean": 135.7391304347826, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 43427.913513183594}, "policy_reward_max": {"agent_0": 61060.61352729797}, "policy_reward_mean": {"agent_0": 55733.60888592056}, "custom_metrics": {"num_batches_mean": 5.173913043478261, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55731.400188446045, 56844.746967315674, 58469.760234832764, 59120.01351928711, 54041.533532857895, 55098.32012748718, 58547.44016265869, 58625.953479766846, 59627.60694885254, 58392.90008544922, 61060.61352729797, 57713.606842041016, 50550.06013202667, 54670.32047080994, 43427.913513183594, 56043.08020019531, 55039.16018295288, 52642.17364883423, 50441.34005737305, 58112.9535446167, 58796.840114593506, 55376.18032455444, 53499.086570739746], "episode_lengths": [136, 135, 137, 136, 137, 136, 136, 136, 137, 137, 138, 135, 134, 136, 133, 136, 135, 135, 135, 136, 136, 136, 134], "policy_agent_0_reward": [55731.400188446045, 56844.746967315674, 58469.760234832764, 59120.01351928711, 54041.533532857895, 55098.32012748718, 58547.44016265869, 58625.953479766846, 59627.60694885254, 58392.90008544922, 61060.61352729797, 57713.606842041016, 50550.06013202667, 54670.32047080994, 43427.913513183594, 56043.08020019531, 55039.16018295288, 52642.17364883423, 50441.34005737305, 58112.9535446167, 58796.840114593506, 55376.18032455444, 53499.086570739746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.502950698644316, "mean_inference_ms": 6.419166314128667, "mean_action_processing_ms": 0.1997668120045292, "mean_env_wait_ms": 220.48237230523094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2831987712694251, "StateBufferConnector_ms": 0.0059563180674677306, "ViewRequirementAgentConnector_ms": 0.23052381432574728}}, "episode_reward_max": 61060.61352729797, "episode_reward_min": 43427.913513183594, "episode_reward_mean": 55733.60888592056, "episode_len_mean": 135.7391304347826, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 43427.913513183594}, "policy_reward_max": {"agent_0": 61060.61352729797}, "policy_reward_mean": {"agent_0": 55733.60888592056}, "hist_stats": {"episode_reward": [55731.400188446045, 56844.746967315674, 58469.760234832764, 59120.01351928711, 54041.533532857895, 55098.32012748718, 58547.44016265869, 58625.953479766846, 59627.60694885254, 58392.90008544922, 61060.61352729797, 57713.606842041016, 50550.06013202667, 54670.32047080994, 43427.913513183594, 56043.08020019531, 55039.16018295288, 52642.17364883423, 50441.34005737305, 58112.9535446167, 58796.840114593506, 55376.18032455444, 53499.086570739746], "episode_lengths": [136, 135, 137, 136, 137, 136, 136, 136, 137, 137, 138, 135, 134, 136, 133, 136, 135, 135, 135, 136, 136, 136, 134], "policy_agent_0_reward": [55731.400188446045, 56844.746967315674, 58469.760234832764, 59120.01351928711, 54041.533532857895, 55098.32012748718, 58547.44016265869, 58625.953479766846, 59627.60694885254, 58392.90008544922, 61060.61352729797, 57713.606842041016, 50550.06013202667, 54670.32047080994, 43427.913513183594, 56043.08020019531, 55039.16018295288, 52642.17364883423, 50441.34005737305, 58112.9535446167, 58796.840114593506, 55376.18032455444, 53499.086570739746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.502950698644316, "mean_inference_ms": 6.419166314128667, "mean_action_processing_ms": 0.1997668120045292, "mean_env_wait_ms": 220.48237230523094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2831987712694251, "StateBufferConnector_ms": 0.0059563180674677306, "ViewRequirementAgentConnector_ms": 0.23052381432574728}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000, "num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.8689623466909, "num_env_steps_trained_throughput_per_sec": 239.8689623466909, "timesteps_total": 892000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 892000, "timers": {"training_iteration_time_ms": 14345.747, "sample_time_ms": 11225.648, "learn_time_ms": 2970.484, "learn_throughput": 1346.582, "synch_weights_time_ms": 148.939}, "counters": {"num_env_steps_sampled": 892000, "num_env_steps_trained": 892000, "num_agent_steps_sampled": 892000, "num_agent_steps_trained": 892000}, "done": false, "episodes_total": 6512, "training_iteration": 223, "trial_id": "32397_00000", "date": "2025-03-21_09-30-55", "timestamp": 1742549455, "time_this_iter_s": 16.729146242141724, "time_total_s": 3217.529399394989, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3217.529399394989, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 99.3304347826087, "ram_util_percent": 13.565217391304353}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.986207962036133, "policy_loss": -0.013874306343495846, "vf_loss": 10.0, "vf_explained_var": -4.950910806655884e-06, "kl": 0.013122131116688251, "entropy": 0.3395315110683441, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "sampler_results": {"episode_reward_max": 53499.086570739746, "episode_reward_min": 53499.086570739746, "episode_reward_mean": 53499.086570739746, "episode_len_mean": 134.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53499.086570739746}, "policy_reward_max": {"agent_0": 53499.086570739746}, "policy_reward_mean": {"agent_0": 53499.086570739746}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [53499.086570739746], "episode_lengths": [134], "policy_agent_0_reward": [53499.086570739746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.48855218420858, "mean_inference_ms": 6.0278985163439875, "mean_action_processing_ms": 0.19750374814738397, "mean_env_wait_ms": 223.96135294566983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 4.44943904876709, "StateBufferConnector_ms": 0.006270408630371094, "ViewRequirementAgentConnector_ms": 0.18002986907958984}}, "episode_reward_max": 53499.086570739746, "episode_reward_min": 53499.086570739746, "episode_reward_mean": 53499.086570739746, "episode_len_mean": 134.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 53499.086570739746}, "policy_reward_max": {"agent_0": 53499.086570739746}, "policy_reward_mean": {"agent_0": 53499.086570739746}, "hist_stats": {"episode_reward": [53499.086570739746], "episode_lengths": [134], "policy_agent_0_reward": [53499.086570739746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.48855218420858, "mean_inference_ms": 6.0278985163439875, "mean_action_processing_ms": 0.19750374814738397, "mean_env_wait_ms": 223.96135294566983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 4.44943904876709, "StateBufferConnector_ms": 0.006270408630371094, "ViewRequirementAgentConnector_ms": 0.18002986907958984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.08425044689113, "num_env_steps_trained_throughput_per_sec": 297.08425044689113, "timesteps_total": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14439.668, "sample_time_ms": 11211.899, "learn_time_ms": 3072.633, "learn_throughput": 1301.815, "synch_weights_time_ms": 154.464}, "counters": {"num_env_steps_sampled": 896000, "num_env_steps_trained": 896000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "episodes_total": 6512, "training_iteration": 224, "trial_id": "32397_00000", "date": "2025-03-21_09-31-08", "timestamp": 1742549468, "time_this_iter_s": 13.524570941925049, "time_total_s": 3231.053970336914, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f95240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3231.053970336914, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 99.66000000000001, "ram_util_percent": 13.5}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.792264938354492, "policy_loss": -0.011531081050634384, "vf_loss": 9.803720474243164, "vf_explained_var": -2.4167820811271667e-06, "kl": 0.012044650502502918, "entropy": 0.3076134920120239, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 62828.753509521484, "episode_reward_min": 43913.106760025024, "episode_reward_mean": 56669.68391477421, "episode_len_mean": 135.9240506329114, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {"agent_0": 43913.106760025024}, "policy_reward_max": {"agent_0": 62828.753509521484}, "policy_reward_mean": {"agent_0": 56669.68391477421}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [60819.70713806152, 53922.8866314888, 55712.81345939636, 52719.02695274353, 53977.40012741089, 62828.753509521484, 58068.6335144043, 58427.660217285156, 60060.21356201172, 58628.726959228516, 57918.28681755066, 58462.64016723633, 53068.95362663269, 60330.80687332153, 58409.766839027405, 56916.493644714355, 56287.1735496521, 52785.5201420784, 43913.106760025024, 57431.67358207703, 59380.847175598145, 59276.40683746338, 57434.07343387604, 58356.44666290283, 58270.10022735596, 54413.71339517832, 56858.56687164307, 49760.24013710022, 59484.95350074768, 57595.246643066406, 56054.8538608551, 57915.58674430847, 60124.527267456055, 49327.51336097717, 53046.45359802246, 54189.92011642456, 55782.16683769226, 60415.74031829834, 61865.213623046875, 59145.88006591797, 54816.24698638916, 59246.38008117676, 55310.60008430481, 60238.04032897949, 54798.09348678589, 51901.39370799065, 60482.1602935791, 56569.04674911499, 57536.02696990967, 56212.966777801514, 57899.226989746094, 55708.64696931839, 52674.08674001694, 58069.113708496094, 56387.746786117554, 52681.95344975591, 58092.5668258667, 54550.420000076294, 55944.74032020569, 52166.61352443695, 59260.52696609497, 56732.88690185547, 57873.32701873779, 57022.99346160889, 59656.57357788086, 58743.34014892578, 58246.093505859375, 57938.23363113403, 56825.51370239258, 50209.826711177826, 52711.073618888855, 56972.39337158203, 59097.15348625183, 58173.253509521484, 59019.00687408447, 57115.660002708435, 57076.94685459137, 54429.786823272705, 59125.673568725586], "episode_lengths": [137, 134, 136, 135, 135, 138, 136, 136, 137, 137, 137, 137, 136, 137, 137, 135, 136, 136, 135, 137, 137, 136, 136, 136, 136, 136, 135, 134, 136, 136, 136, 135, 137, 135, 136, 136, 136, 137, 138, 136, 135, 136, 135, 137, 136, 135, 137, 136, 136, 136, 136, 136, 134, 135, 136, 135, 137, 135, 136, 136, 137, 135, 136, 136, 136, 136, 135, 136, 136, 134, 134, 135, 136, 136, 137, 137, 136, 135, 136], "policy_agent_0_reward": [60819.70713806152, 53922.8866314888, 55712.81345939636, 52719.02695274353, 53977.40012741089, 62828.753509521484, 58068.6335144043, 58427.660217285156, 60060.21356201172, 58628.726959228516, 57918.28681755066, 58462.64016723633, 53068.95362663269, 60330.80687332153, 58409.766839027405, 56916.493644714355, 56287.1735496521, 52785.5201420784, 43913.106760025024, 57431.67358207703, 59380.847175598145, 59276.40683746338, 57434.07343387604, 58356.44666290283, 58270.10022735596, 54413.71339517832, 56858.56687164307, 49760.24013710022, 59484.95350074768, 57595.246643066406, 56054.8538608551, 57915.58674430847, 60124.527267456055, 49327.51336097717, 53046.45359802246, 54189.92011642456, 55782.16683769226, 60415.74031829834, 61865.213623046875, 59145.88006591797, 54816.24698638916, 59246.38008117676, 55310.60008430481, 60238.04032897949, 54798.09348678589, 51901.39370799065, 60482.1602935791, 56569.04674911499, 57536.02696990967, 56212.966777801514, 57899.226989746094, 55708.64696931839, 52674.08674001694, 58069.113708496094, 56387.746786117554, 52681.95344975591, 58092.5668258667, 54550.420000076294, 55944.74032020569, 52166.61352443695, 59260.52696609497, 56732.88690185547, 57873.32701873779, 57022.99346160889, 59656.57357788086, 58743.34014892578, 58246.093505859375, 57938.23363113403, 56825.51370239258, 50209.826711177826, 52711.073618888855, 56972.39337158203, 59097.15348625183, 58173.253509521484, 59019.00687408447, 57115.660002708435, 57076.94685459137, 54429.786823272705, 59125.673568725586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.072284643583902, "mean_inference_ms": 6.754712331630694, "mean_action_processing_ms": 0.1962919119004002, "mean_env_wait_ms": 232.33070836961878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037852118286905406, "StateBufferConnector_ms": 0.014837482307530656, "ViewRequirementAgentConnector_ms": 0.1834386511694027}}, "episode_reward_max": 62828.753509521484, "episode_reward_min": 43913.106760025024, "episode_reward_mean": 56669.68391477421, "episode_len_mean": 135.9240506329114, "episodes_this_iter": 79, "policy_reward_min": {"agent_0": 43913.106760025024}, "policy_reward_max": {"agent_0": 62828.753509521484}, "policy_reward_mean": {"agent_0": 56669.68391477421}, "hist_stats": {"episode_reward": [60819.70713806152, 53922.8866314888, 55712.81345939636, 52719.02695274353, 53977.40012741089, 62828.753509521484, 58068.6335144043, 58427.660217285156, 60060.21356201172, 58628.726959228516, 57918.28681755066, 58462.64016723633, 53068.95362663269, 60330.80687332153, 58409.766839027405, 56916.493644714355, 56287.1735496521, 52785.5201420784, 43913.106760025024, 57431.67358207703, 59380.847175598145, 59276.40683746338, 57434.07343387604, 58356.44666290283, 58270.10022735596, 54413.71339517832, 56858.56687164307, 49760.24013710022, 59484.95350074768, 57595.246643066406, 56054.8538608551, 57915.58674430847, 60124.527267456055, 49327.51336097717, 53046.45359802246, 54189.92011642456, 55782.16683769226, 60415.74031829834, 61865.213623046875, 59145.88006591797, 54816.24698638916, 59246.38008117676, 55310.60008430481, 60238.04032897949, 54798.09348678589, 51901.39370799065, 60482.1602935791, 56569.04674911499, 57536.02696990967, 56212.966777801514, 57899.226989746094, 55708.64696931839, 52674.08674001694, 58069.113708496094, 56387.746786117554, 52681.95344975591, 58092.5668258667, 54550.420000076294, 55944.74032020569, 52166.61352443695, 59260.52696609497, 56732.88690185547, 57873.32701873779, 57022.99346160889, 59656.57357788086, 58743.34014892578, 58246.093505859375, 57938.23363113403, 56825.51370239258, 50209.826711177826, 52711.073618888855, 56972.39337158203, 59097.15348625183, 58173.253509521484, 59019.00687408447, 57115.660002708435, 57076.94685459137, 54429.786823272705, 59125.673568725586], "episode_lengths": [137, 134, 136, 135, 135, 138, 136, 136, 137, 137, 137, 137, 136, 137, 137, 135, 136, 136, 135, 137, 137, 136, 136, 136, 136, 136, 135, 134, 136, 136, 136, 135, 137, 135, 136, 136, 136, 137, 138, 136, 135, 136, 135, 137, 136, 135, 137, 136, 136, 136, 136, 136, 134, 135, 136, 135, 137, 135, 136, 136, 137, 135, 136, 136, 136, 136, 135, 136, 136, 134, 134, 135, 136, 136, 137, 137, 136, 135, 136], "policy_agent_0_reward": [60819.70713806152, 53922.8866314888, 55712.81345939636, 52719.02695274353, 53977.40012741089, 62828.753509521484, 58068.6335144043, 58427.660217285156, 60060.21356201172, 58628.726959228516, 57918.28681755066, 58462.64016723633, 53068.95362663269, 60330.80687332153, 58409.766839027405, 56916.493644714355, 56287.1735496521, 52785.5201420784, 43913.106760025024, 57431.67358207703, 59380.847175598145, 59276.40683746338, 57434.07343387604, 58356.44666290283, 58270.10022735596, 54413.71339517832, 56858.56687164307, 49760.24013710022, 59484.95350074768, 57595.246643066406, 56054.8538608551, 57915.58674430847, 60124.527267456055, 49327.51336097717, 53046.45359802246, 54189.92011642456, 55782.16683769226, 60415.74031829834, 61865.213623046875, 59145.88006591797, 54816.24698638916, 59246.38008117676, 55310.60008430481, 60238.04032897949, 54798.09348678589, 51901.39370799065, 60482.1602935791, 56569.04674911499, 57536.02696990967, 56212.966777801514, 57899.226989746094, 55708.64696931839, 52674.08674001694, 58069.113708496094, 56387.746786117554, 52681.95344975591, 58092.5668258667, 54550.420000076294, 55944.74032020569, 52166.61352443695, 59260.52696609497, 56732.88690185547, 57873.32701873779, 57022.99346160889, 59656.57357788086, 58743.34014892578, 58246.093505859375, 57938.23363113403, 56825.51370239258, 50209.826711177826, 52711.073618888855, 56972.39337158203, 59097.15348625183, 58173.253509521484, 59019.00687408447, 57115.660002708435, 57076.94685459137, 54429.786823272705, 59125.673568725586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.072284643583902, "mean_inference_ms": 6.754712331630694, "mean_action_processing_ms": 0.1962919119004002, "mean_env_wait_ms": 232.33070836961878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037852118286905406, "StateBufferConnector_ms": 0.014837482307530656, "ViewRequirementAgentConnector_ms": 0.1834386511694027}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.2769520861386, "num_env_steps_trained_throughput_per_sec": 260.2769520861386, "timesteps_total": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 14647.589, "sample_time_ms": 11491.565, "learn_time_ms": 3005.798, "learn_throughput": 1330.761, "synch_weights_time_ms": 149.551}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 6591, "training_iteration": 225, "trial_id": "32397_00000", "date": "2025-03-21_09-31-24", "timestamp": 1742549484, "time_this_iter_s": 15.426162719726562, "time_total_s": 3246.4801330566406, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f952d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3246.4801330566406, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 97.215, "ram_util_percent": 13.545000000000002}}
{"custom_metrics": {"num_batches_mean": 5.764705882352941, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.944994926452637, "policy_loss": -0.012374695390462875, "vf_loss": 9.957275390625, "vf_explained_var": -7.041419394226978e-07, "kl": 0.015072139911353588, "entropy": 0.36274397373199463, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "sampler_results": {"episode_reward_max": 61253.660247802734, "episode_reward_min": 47083.033584713936, "episode_reward_mean": 56657.782195606655, "episode_len_mean": 136.52941176470588, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {"agent_0": 47083.033584713936}, "policy_reward_max": {"agent_0": 61253.660247802734}, "policy_reward_mean": {"agent_0": 56657.782195606655}, "custom_metrics": {"num_batches_mean": 5.764705882352941, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59125.420318603516, 53945.200103759766, 56505.893590927124, 57946.58049964905, 56840.27361679077, 48587.12693506479, 58280.633529663086, 47083.033584713936, 58838.33321380615, 60244.56020641327, 61253.660247802734, 56329.39365577698, 57079.240129470825, 56068.72680854797, 55765.68705558777, 60226.44019317627, 59062.09363555908], "episode_lengths": [137, 136, 136, 137, 136, 135, 137, 134, 136, 137, 138, 137, 136, 137, 137, 138, 137], "policy_agent_0_reward": [59125.420318603516, 53945.200103759766, 56505.893590927124, 57946.58049964905, 56840.27361679077, 48587.12693506479, 58280.633529663086, 47083.033584713936, 58838.33321380615, 60244.56020641327, 61253.660247802734, 56329.39365577698, 57079.240129470825, 56068.72680854797, 55765.68705558777, 60226.44019317627, 59062.09363555908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.170875832025086, "mean_inference_ms": 6.644737087520419, "mean_action_processing_ms": 0.19620544807532156, "mean_env_wait_ms": 227.30066813482551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037578975453096276, "StateBufferConnector_ms": 0.005838450263528263, "ViewRequirementAgentConnector_ms": 0.16015838174258962}}, "episode_reward_max": 61253.660247802734, "episode_reward_min": 47083.033584713936, "episode_reward_mean": 56657.782195606655, "episode_len_mean": 136.52941176470588, "episodes_this_iter": 17, "policy_reward_min": {"agent_0": 47083.033584713936}, "policy_reward_max": {"agent_0": 61253.660247802734}, "policy_reward_mean": {"agent_0": 56657.782195606655}, "hist_stats": {"episode_reward": [59125.420318603516, 53945.200103759766, 56505.893590927124, 57946.58049964905, 56840.27361679077, 48587.12693506479, 58280.633529663086, 47083.033584713936, 58838.33321380615, 60244.56020641327, 61253.660247802734, 56329.39365577698, 57079.240129470825, 56068.72680854797, 55765.68705558777, 60226.44019317627, 59062.09363555908], "episode_lengths": [137, 136, 136, 137, 136, 135, 137, 134, 136, 137, 138, 137, 136, 137, 137, 138, 137], "policy_agent_0_reward": [59125.420318603516, 53945.200103759766, 56505.893590927124, 57946.58049964905, 56840.27361679077, 48587.12693506479, 58280.633529663086, 47083.033584713936, 58838.33321380615, 60244.56020641327, 61253.660247802734, 56329.39365577698, 57079.240129470825, 56068.72680854797, 55765.68705558777, 60226.44019317627, 59062.09363555908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.170875832025086, "mean_inference_ms": 6.644737087520419, "mean_action_processing_ms": 0.19620544807532156, "mean_env_wait_ms": 227.30066813482551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037578975453096276, "StateBufferConnector_ms": 0.005838450263528263, "ViewRequirementAgentConnector_ms": 0.16015838174258962}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000, "num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.6470037340936, "num_env_steps_trained_throughput_per_sec": 296.6470037340936, "timesteps_total": 904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 904000, "timers": {"training_iteration_time_ms": 14635.682, "sample_time_ms": 11561.748, "learn_time_ms": 2928.55, "learn_throughput": 1365.864, "synch_weights_time_ms": 144.724}, "counters": {"num_env_steps_sampled": 904000, "num_env_steps_trained": 904000, "num_agent_steps_sampled": 904000, "num_agent_steps_trained": 904000}, "done": false, "episodes_total": 6608, "training_iteration": 226, "trial_id": "32397_00000", "date": "2025-03-21_09-31-37", "timestamp": 1742549497, "time_this_iter_s": 13.529407501220703, "time_total_s": 3260.0095405578613, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907e3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3260.0095405578613, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 99.23684210526315, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.178571428571429, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.919095993041992, "policy_loss": -0.011148282326757908, "vf_loss": 9.93017578125, "vf_explained_var": 4.5883158605874996e-08, "kl": 0.010754378512501717, "entropy": 0.3074251115322113, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "sampler_results": {"episode_reward_max": 61624.98025512695, "episode_reward_min": 51228.46676969528, "episode_reward_mean": 55938.86112863464, "episode_len_mean": 135.53571428571428, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 51228.46676969528}, "policy_reward_max": {"agent_0": 61624.98025512695}, "policy_reward_mean": {"agent_0": 55938.86112863464}, "custom_metrics": {"num_batches_mean": 5.178571428571429, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57796.62036418915, 51228.46676969528, 57653.34037780762, 56117.13349819183, 57093.66004562378, 57274.773612976074, 53454.64003753662, 59386.920166015625, 51332.4134016037, 57612.66002655029, 58342.1403503418, 59759.24041748047, 54492.88677889109, 52574.99353981018, 61624.98025512695, 57477.38694000244, 57369.00672912598, 51259.34684944153, 54786.76012992859, 56782.90011024475, 52658.65340042114, 55556.38003766537, 55289.34683609009, 54984.193408966064, 53601.053683280945, 56923.55335998535, 57555.006927490234, 56299.65354728699], "episode_lengths": [137, 135, 136, 136, 135, 136, 135, 136, 136, 135, 136, 136, 135, 135, 137, 136, 136, 134, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [57796.62036418915, 51228.46676969528, 57653.34037780762, 56117.13349819183, 57093.66004562378, 57274.773612976074, 53454.64003753662, 59386.920166015625, 51332.4134016037, 57612.66002655029, 58342.1403503418, 59759.24041748047, 54492.88677889109, 52574.99353981018, 61624.98025512695, 57477.38694000244, 57369.00672912598, 51259.34684944153, 54786.76012992859, 56782.90011024475, 52658.65340042114, 55556.38003766537, 55289.34683609009, 54984.193408966064, 53601.053683280945, 56923.55335998535, 57555.006927490234, 56299.65354728699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.984292470284124, "mean_inference_ms": 6.401356368468216, "mean_action_processing_ms": 0.19972437775186866, "mean_env_wait_ms": 220.95534275788464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04042046410696847, "StateBufferConnector_ms": 0.006262745176042829, "ViewRequirementAgentConnector_ms": 0.2825524125780378}}, "episode_reward_max": 61624.98025512695, "episode_reward_min": 51228.46676969528, "episode_reward_mean": 55938.86112863464, "episode_len_mean": 135.53571428571428, "episodes_this_iter": 28, "policy_reward_min": {"agent_0": 51228.46676969528}, "policy_reward_max": {"agent_0": 61624.98025512695}, "policy_reward_mean": {"agent_0": 55938.86112863464}, "hist_stats": {"episode_reward": [57796.62036418915, 51228.46676969528, 57653.34037780762, 56117.13349819183, 57093.66004562378, 57274.773612976074, 53454.64003753662, 59386.920166015625, 51332.4134016037, 57612.66002655029, 58342.1403503418, 59759.24041748047, 54492.88677889109, 52574.99353981018, 61624.98025512695, 57477.38694000244, 57369.00672912598, 51259.34684944153, 54786.76012992859, 56782.90011024475, 52658.65340042114, 55556.38003766537, 55289.34683609009, 54984.193408966064, 53601.053683280945, 56923.55335998535, 57555.006927490234, 56299.65354728699], "episode_lengths": [137, 135, 136, 136, 135, 136, 135, 136, 136, 135, 136, 136, 135, 135, 137, 136, 136, 134, 135, 136, 136, 135, 135, 135, 135, 135, 135, 136], "policy_agent_0_reward": [57796.62036418915, 51228.46676969528, 57653.34037780762, 56117.13349819183, 57093.66004562378, 57274.773612976074, 53454.64003753662, 59386.920166015625, 51332.4134016037, 57612.66002655029, 58342.1403503418, 59759.24041748047, 54492.88677889109, 52574.99353981018, 61624.98025512695, 57477.38694000244, 57369.00672912598, 51259.34684944153, 54786.76012992859, 56782.90011024475, 52658.65340042114, 55556.38003766537, 55289.34683609009, 54984.193408966064, 53601.053683280945, 56923.55335998535, 57555.006927490234, 56299.65354728699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.984292470284124, "mean_inference_ms": 6.401356368468216, "mean_action_processing_ms": 0.19972437775186866, "mean_env_wait_ms": 220.95534275788464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04042046410696847, "StateBufferConnector_ms": 0.006262745176042829, "ViewRequirementAgentConnector_ms": 0.2825524125780378}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000, "num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.5651306826966, "num_env_steps_trained_throughput_per_sec": 254.5651306826966, "timesteps_total": 908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 908000, "timers": {"training_iteration_time_ms": 14566.013, "sample_time_ms": 11484.152, "learn_time_ms": 2940.517, "learn_throughput": 1360.305, "synch_weights_time_ms": 140.687}, "counters": {"num_env_steps_sampled": 908000, "num_env_steps_trained": 908000, "num_agent_steps_sampled": 908000, "num_agent_steps_trained": 908000}, "done": false, "episodes_total": 6636, "training_iteration": 227, "trial_id": "32397_00000", "date": "2025-03-21_09-31-53", "timestamp": 1742549513, "time_this_iter_s": 15.761309385299683, "time_total_s": 3275.770849943161, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f95240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3275.770849943161, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 99.22380952380954, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985756874084473, "policy_loss": -0.014327365905046463, "vf_loss": 10.0, "vf_explained_var": -7.390354994640802e-07, "kl": 0.013502776622772217, "entropy": 0.31218135356903076, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 56299.65354728699, "episode_reward_min": 56299.65354728699, "episode_reward_mean": 56299.65354728699, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56299.65354728699}, "policy_reward_max": {"agent_0": 56299.65354728699}, "policy_reward_mean": {"agent_0": 56299.65354728699}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56299.65354728699], "episode_lengths": [136], "policy_agent_0_reward": [56299.65354728699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.702498913575035, "mean_inference_ms": 6.047701237358261, "mean_action_processing_ms": 0.19745745890546598, "mean_env_wait_ms": 224.39767196734704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045371055603027344, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.7149457931518555}}, "episode_reward_max": 56299.65354728699, "episode_reward_min": 56299.65354728699, "episode_reward_mean": 56299.65354728699, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56299.65354728699}, "policy_reward_max": {"agent_0": 56299.65354728699}, "policy_reward_mean": {"agent_0": 56299.65354728699}, "hist_stats": {"episode_reward": [56299.65354728699], "episode_lengths": [136], "policy_agent_0_reward": [56299.65354728699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.702498913575035, "mean_inference_ms": 6.047701237358261, "mean_action_processing_ms": 0.19745745890546598, "mean_env_wait_ms": 224.39767196734704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045371055603027344, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.7149457931518555}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.75568543416705, "num_env_steps_trained_throughput_per_sec": 306.75568543416705, "timesteps_total": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14585.565, "sample_time_ms": 11426.646, "learn_time_ms": 3014.931, "learn_throughput": 1326.73, "synch_weights_time_ms": 143.341}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 6636, "training_iteration": 228, "trial_id": "32397_00000", "date": "2025-03-21_09-32-06", "timestamp": 1742549526, "time_this_iter_s": 13.082028865814209, "time_total_s": 3288.852878808975, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907f520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3288.852878808975, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 99.67222222222223, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.884573936462402, "policy_loss": -0.015179278329014778, "vf_loss": 9.899659156799316, "vf_explained_var": -3.214304626908415e-07, "kl": 0.015114638954401016, "entropy": 0.3553714156150818, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "sampler_results": {"episode_reward_max": 60394.55368041992, "episode_reward_min": 46170.68008327484, "episode_reward_mean": 56195.15751420856, "episode_len_mean": 135.6, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 46170.68008327484}, "policy_reward_max": {"agent_0": 60394.55368041992}, "policy_reward_mean": {"agent_0": 56195.15751420856}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58535.71343612671, 52980.50681591034, 56036.59353637695, 54802.82681655884, 53259.5468416214, 58429.706928253174, 57642.66026306152, 59667.86686325073, 53896.9401550293, 54375.98021364212, 55674.1134223938, 56461.23337364197, 56108.927017211914, 55345.953548908234, 57224.28017997742, 50469.8200545311, 60117.573150634766, 59870.98678588867, 56356.10038852692, 56833.08685684204, 56656.433502197266, 60394.55368041992, 56777.300340652466, 60326.7268371582, 53972.553586006165, 46170.68008327484, 56571.06032752991, 56996.60669708252, 58260.12005805969, 59280.21350097656, 56359.11366271973, 58184.12008666992, 58458.8602142334, 58423.960119485855, 52774.23354911804, 56528.600189208984, 55370.020119190216, 53364.00693368912, 54268.913701057434, 54577.80673122406], "episode_lengths": [136, 136, 135, 135, 134, 137, 136, 138, 135, 135, 134, 135, 135, 136, 136, 134, 137, 136, 137, 136, 135, 137, 135, 136, 135, 134, 136, 136, 136, 137, 136, 136, 135, 138, 134, 136, 135, 134, 135, 135], "policy_agent_0_reward": [58535.71343612671, 52980.50681591034, 56036.59353637695, 54802.82681655884, 53259.5468416214, 58429.706928253174, 57642.66026306152, 59667.86686325073, 53896.9401550293, 54375.98021364212, 55674.1134223938, 56461.23337364197, 56108.927017211914, 55345.953548908234, 57224.28017997742, 50469.8200545311, 60117.573150634766, 59870.98678588867, 56356.10038852692, 56833.08685684204, 56656.433502197266, 60394.55368041992, 56777.300340652466, 60326.7268371582, 53972.553586006165, 46170.68008327484, 56571.06032752991, 56996.60669708252, 58260.12005805969, 59280.21350097656, 56359.11366271973, 58184.12008666992, 58458.8602142334, 58423.960119485855, 52774.23354911804, 56528.600189208984, 55370.020119190216, 53364.00693368912, 54268.913701057434, 54577.80673122406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.183915328029588, "mean_inference_ms": 6.710409845657182, "mean_action_processing_ms": 0.19598204257755328, "mean_env_wait_ms": 233.23953505882477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08967339992523193, "StateBufferConnector_ms": 0.006063580513000488, "ViewRequirementAgentConnector_ms": 0.21673858165740967}}, "episode_reward_max": 60394.55368041992, "episode_reward_min": 46170.68008327484, "episode_reward_mean": 56195.15751420856, "episode_len_mean": 135.6, "episodes_this_iter": 40, "policy_reward_min": {"agent_0": 46170.68008327484}, "policy_reward_max": {"agent_0": 60394.55368041992}, "policy_reward_mean": {"agent_0": 56195.15751420856}, "hist_stats": {"episode_reward": [58535.71343612671, 52980.50681591034, 56036.59353637695, 54802.82681655884, 53259.5468416214, 58429.706928253174, 57642.66026306152, 59667.86686325073, 53896.9401550293, 54375.98021364212, 55674.1134223938, 56461.23337364197, 56108.927017211914, 55345.953548908234, 57224.28017997742, 50469.8200545311, 60117.573150634766, 59870.98678588867, 56356.10038852692, 56833.08685684204, 56656.433502197266, 60394.55368041992, 56777.300340652466, 60326.7268371582, 53972.553586006165, 46170.68008327484, 56571.06032752991, 56996.60669708252, 58260.12005805969, 59280.21350097656, 56359.11366271973, 58184.12008666992, 58458.8602142334, 58423.960119485855, 52774.23354911804, 56528.600189208984, 55370.020119190216, 53364.00693368912, 54268.913701057434, 54577.80673122406], "episode_lengths": [136, 136, 135, 135, 134, 137, 136, 138, 135, 135, 134, 135, 135, 136, 136, 134, 137, 136, 137, 136, 135, 137, 135, 136, 135, 134, 136, 136, 136, 137, 136, 136, 135, 138, 134, 136, 135, 134, 135, 135], "policy_agent_0_reward": [58535.71343612671, 52980.50681591034, 56036.59353637695, 54802.82681655884, 53259.5468416214, 58429.706928253174, 57642.66026306152, 59667.86686325073, 53896.9401550293, 54375.98021364212, 55674.1134223938, 56461.23337364197, 56108.927017211914, 55345.953548908234, 57224.28017997742, 50469.8200545311, 60117.573150634766, 59870.98678588867, 56356.10038852692, 56833.08685684204, 56656.433502197266, 60394.55368041992, 56777.300340652466, 60326.7268371582, 53972.553586006165, 46170.68008327484, 56571.06032752991, 56996.60669708252, 58260.12005805969, 59280.21350097656, 56359.11366271973, 58184.12008666992, 58458.8602142334, 58423.960119485855, 52774.23354911804, 56528.600189208984, 55370.020119190216, 53364.00693368912, 54268.913701057434, 54577.80673122406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.183915328029588, "mean_inference_ms": 6.710409845657182, "mean_action_processing_ms": 0.19598204257755328, "mean_env_wait_ms": 233.23953505882477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08967339992523193, "StateBufferConnector_ms": 0.006063580513000488, "ViewRequirementAgentConnector_ms": 0.21673858165740967}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000, "num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.3068093261001, "num_env_steps_trained_throughput_per_sec": 296.3068093261001, "timesteps_total": 916000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 916000, "timers": {"training_iteration_time_ms": 14568.768, "sample_time_ms": 11452.047, "learn_time_ms": 2980.764, "learn_throughput": 1341.938, "synch_weights_time_ms": 135.315}, "counters": {"num_env_steps_sampled": 916000, "num_env_steps_trained": 916000, "num_agent_steps_sampled": 916000, "num_agent_steps_trained": 916000}, "done": false, "episodes_total": 6676, "training_iteration": 229, "trial_id": "32397_00000", "date": "2025-03-21_09-32-20", "timestamp": 1742549540, "time_this_iter_s": 13.540857076644897, "time_total_s": 3302.39373588562, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8f97d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3302.39373588562, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 98.48947368421052, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.653846153846154, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.855731010437012, "policy_loss": -0.013989944942295551, "vf_loss": 9.86962890625, "vf_explained_var": 1.695627958042678e-07, "kl": 0.01467619463801384, "entropy": 0.38893482089042664, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "sampler_results": {"episode_reward_max": 60936.147216796875, "episode_reward_min": 51473.0271320343, "episode_reward_mean": 57247.470999307356, "episode_len_mean": 136.09615384615384, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"agent_0": 51473.0271320343}, "policy_reward_max": {"agent_0": 60936.147216796875}, "policy_reward_mean": {"agent_0": 57247.470999307356}, "custom_metrics": {"num_batches_mean": 5.653846153846154, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59022.45344543457, 60160.620056152344, 57249.007205963135, 60525.920349121094, 59014.70009422302, 53974.28656578064, 54965.04686832428, 58712.50012207031, 59885.04034805298, 57238.60681915283, 53322.100326538086, 60308.10693359375, 56751.85370826721, 60936.147216796875, 55897.42680597305, 57883.58676147461, 60689.620208740234, 60351.700439453125, 57404.14017486572, 56300.13375091553, 60480.79348754883, 51719.40687561035, 54364.72680926323, 55347.06022262573, 57047.86688995361, 59014.81344604492, 55425.90020942688, 55565.16678619385, 59281.34665298462, 51600.306820869446, 58625.70036315918, 58158.1668548584, 57802.12059593201, 60249.90045547485, 54288.986797332764, 53995.68035888672, 58938.067178726196, 60654.5400390625, 52574.55346107483, 56131.786915779114, 54799.56680202484, 58101.80017089844, 59335.92011260986, 58891.32002258301, 60453.67364501953, 60805.61358642578, 54891.567098617554, 51473.0271320343, 59709.553649902344, 56811.67324733734, 51527.69366586208, 58207.193408966064], "episode_lengths": [137, 137, 136, 137, 137, 135, 134, 136, 136, 136, 135, 137, 135, 137, 137, 136, 137, 137, 137, 136, 137, 136, 136, 135, 136, 136, 135, 135, 136, 136, 136, 137, 136, 138, 136, 135, 136, 137, 135, 136, 136, 136, 136, 136, 137, 137, 135, 135, 137, 135, 134, 138], "policy_agent_0_reward": [59022.45344543457, 60160.620056152344, 57249.007205963135, 60525.920349121094, 59014.70009422302, 53974.28656578064, 54965.04686832428, 58712.50012207031, 59885.04034805298, 57238.60681915283, 53322.100326538086, 60308.10693359375, 56751.85370826721, 60936.147216796875, 55897.42680597305, 57883.58676147461, 60689.620208740234, 60351.700439453125, 57404.14017486572, 56300.13375091553, 60480.79348754883, 51719.40687561035, 54364.72680926323, 55347.06022262573, 57047.86688995361, 59014.81344604492, 55425.90020942688, 55565.16678619385, 59281.34665298462, 51600.306820869446, 58625.70036315918, 58158.1668548584, 57802.12059593201, 60249.90045547485, 54288.986797332764, 53995.68035888672, 58938.067178726196, 60654.5400390625, 52574.55346107483, 56131.786915779114, 54799.56680202484, 58101.80017089844, 59335.92011260986, 58891.32002258301, 60453.67364501953, 60805.61358642578, 54891.567098617554, 51473.0271320343, 59709.553649902344, 56811.67324733734, 51527.69366586208, 58207.193408966064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.41335780146219, "mean_inference_ms": 6.777778878120837, "mean_action_processing_ms": 0.1963696414719528, "mean_env_wait_ms": 231.61816395983547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07490744957557091, "StateBufferConnector_ms": 0.006023278603186974, "ViewRequirementAgentConnector_ms": 0.188597349020151}}, "episode_reward_max": 60936.147216796875, "episode_reward_min": 51473.0271320343, "episode_reward_mean": 57247.470999307356, "episode_len_mean": 136.09615384615384, "episodes_this_iter": 52, "policy_reward_min": {"agent_0": 51473.0271320343}, "policy_reward_max": {"agent_0": 60936.147216796875}, "policy_reward_mean": {"agent_0": 57247.470999307356}, "hist_stats": {"episode_reward": [59022.45344543457, 60160.620056152344, 57249.007205963135, 60525.920349121094, 59014.70009422302, 53974.28656578064, 54965.04686832428, 58712.50012207031, 59885.04034805298, 57238.60681915283, 53322.100326538086, 60308.10693359375, 56751.85370826721, 60936.147216796875, 55897.42680597305, 57883.58676147461, 60689.620208740234, 60351.700439453125, 57404.14017486572, 56300.13375091553, 60480.79348754883, 51719.40687561035, 54364.72680926323, 55347.06022262573, 57047.86688995361, 59014.81344604492, 55425.90020942688, 55565.16678619385, 59281.34665298462, 51600.306820869446, 58625.70036315918, 58158.1668548584, 57802.12059593201, 60249.90045547485, 54288.986797332764, 53995.68035888672, 58938.067178726196, 60654.5400390625, 52574.55346107483, 56131.786915779114, 54799.56680202484, 58101.80017089844, 59335.92011260986, 58891.32002258301, 60453.67364501953, 60805.61358642578, 54891.567098617554, 51473.0271320343, 59709.553649902344, 56811.67324733734, 51527.69366586208, 58207.193408966064], "episode_lengths": [137, 137, 136, 137, 137, 135, 134, 136, 136, 136, 135, 137, 135, 137, 137, 136, 137, 137, 137, 136, 137, 136, 136, 135, 136, 136, 135, 135, 136, 136, 136, 137, 136, 138, 136, 135, 136, 137, 135, 136, 136, 136, 136, 136, 137, 137, 135, 135, 137, 135, 134, 138], "policy_agent_0_reward": [59022.45344543457, 60160.620056152344, 57249.007205963135, 60525.920349121094, 59014.70009422302, 53974.28656578064, 54965.04686832428, 58712.50012207031, 59885.04034805298, 57238.60681915283, 53322.100326538086, 60308.10693359375, 56751.85370826721, 60936.147216796875, 55897.42680597305, 57883.58676147461, 60689.620208740234, 60351.700439453125, 57404.14017486572, 56300.13375091553, 60480.79348754883, 51719.40687561035, 54364.72680926323, 55347.06022262573, 57047.86688995361, 59014.81344604492, 55425.90020942688, 55565.16678619385, 59281.34665298462, 51600.306820869446, 58625.70036315918, 58158.1668548584, 57802.12059593201, 60249.90045547485, 54288.986797332764, 53995.68035888672, 58938.067178726196, 60654.5400390625, 52574.55346107483, 56131.786915779114, 54799.56680202484, 58101.80017089844, 59335.92011260986, 58891.32002258301, 60453.67364501953, 60805.61358642578, 54891.567098617554, 51473.0271320343, 59709.553649902344, 56811.67324733734, 51527.69366586208, 58207.193408966064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.41335780146219, "mean_inference_ms": 6.777778878120837, "mean_action_processing_ms": 0.1963696414719528, "mean_env_wait_ms": 231.61816395983547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07490744957557091, "StateBufferConnector_ms": 0.006023278603186974, "ViewRequirementAgentConnector_ms": 0.188597349020151}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.4417126648332, "num_env_steps_trained_throughput_per_sec": 231.4417126648332, "timesteps_total": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 14934.759, "sample_time_ms": 11919.667, "learn_time_ms": 2880.588, "learn_throughput": 1388.606, "synch_weights_time_ms": 133.878}, "counters": {"num_env_steps_sampled": 920000, "num_env_steps_trained": 920000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "episodes_total": 6728, "training_iteration": 230, "trial_id": "32397_00000", "date": "2025-03-21_09-32-37", "timestamp": 1742549557, "time_this_iter_s": 17.342724561691284, "time_total_s": 3319.7364604473114, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907e3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3319.7364604473114, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 98.75, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.898834228515625, "policy_loss": -0.015083960257470608, "vf_loss": 9.913818359375, "vf_explained_var": 6.221235082648491e-08, "kl": 0.015972783789038658, "entropy": 0.38082224130630493, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 59956.50717544556, "episode_reward_min": 46675.24669837952, "episode_reward_mean": 55805.24721689522, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46675.24669837952}, "policy_reward_max": {"agent_0": 59956.50717544556}, "policy_reward_mean": {"agent_0": 55805.24721689522}, "custom_metrics": {"num_batches_mean": 5.03125, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [53762.94000649452, 57999.58022880554, 53473.1066570282, 56194.546646118164, 53572.846824645996, 57191.50003242493, 58938.3999710083, 55446.02003479004, 57944.46008300781, 56390.48677635193, 53193.52670669556, 46675.24669837952, 55360.02703666687, 58904.33322143555, 55665.2601852417, 53152.4734954834, 55455.18004989624, 59115.88694047928, 54722.326652526855, 59956.50717544556, 57910.62022399902, 57403.193534851074, 54566.313426971436, 58928.98666381836, 54570.013478040695, 56959.640100479126, 55559.54683685303, 55044.06016635895, 52177.493408203125, 55593.940366744995, 54990.46014404297, 58948.9871673584], "episode_lengths": [134, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 135, 134, 134, 137, 135, 138, 136, 135, 136, 136, 135, 136, 135, 136, 134, 135, 135, 136], "policy_agent_0_reward": [53762.94000649452, 57999.58022880554, 53473.1066570282, 56194.546646118164, 53572.846824645996, 57191.50003242493, 58938.3999710083, 55446.02003479004, 57944.46008300781, 56390.48677635193, 53193.52670669556, 46675.24669837952, 55360.02703666687, 58904.33322143555, 55665.2601852417, 53152.4734954834, 55455.18004989624, 59115.88694047928, 54722.326652526855, 59956.50717544556, 57910.62022399902, 57403.193534851074, 54566.313426971436, 58928.98666381836, 54570.013478040695, 56959.640100479126, 55559.54683685303, 55044.06016635895, 52177.493408203125, 55593.940366744995, 54990.46014404297, 58948.9871673584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.6223970436709, "mean_inference_ms": 6.396358529768361, "mean_action_processing_ms": 0.19932376926399353, "mean_env_wait_ms": 221.24928373604985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0421084463596344, "StateBufferConnector_ms": 0.006172806024551392, "ViewRequirementAgentConnector_ms": 0.287541002035141}}, "episode_reward_max": 59956.50717544556, "episode_reward_min": 46675.24669837952, "episode_reward_mean": 55805.24721689522, "episode_len_mean": 135.5, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 46675.24669837952}, "policy_reward_max": {"agent_0": 59956.50717544556}, "policy_reward_mean": {"agent_0": 55805.24721689522}, "hist_stats": {"episode_reward": [53762.94000649452, 57999.58022880554, 53473.1066570282, 56194.546646118164, 53572.846824645996, 57191.50003242493, 58938.3999710083, 55446.02003479004, 57944.46008300781, 56390.48677635193, 53193.52670669556, 46675.24669837952, 55360.02703666687, 58904.33322143555, 55665.2601852417, 53152.4734954834, 55455.18004989624, 59115.88694047928, 54722.326652526855, 59956.50717544556, 57910.62022399902, 57403.193534851074, 54566.313426971436, 58928.98666381836, 54570.013478040695, 56959.640100479126, 55559.54683685303, 55044.06016635895, 52177.493408203125, 55593.940366744995, 54990.46014404297, 58948.9871673584], "episode_lengths": [134, 136, 135, 135, 136, 136, 136, 136, 136, 136, 136, 135, 135, 136, 135, 134, 134, 137, 135, 138, 136, 135, 136, 136, 135, 136, 135, 136, 134, 135, 135, 136], "policy_agent_0_reward": [53762.94000649452, 57999.58022880554, 53473.1066570282, 56194.546646118164, 53572.846824645996, 57191.50003242493, 58938.3999710083, 55446.02003479004, 57944.46008300781, 56390.48677635193, 53193.52670669556, 46675.24669837952, 55360.02703666687, 58904.33322143555, 55665.2601852417, 53152.4734954834, 55455.18004989624, 59115.88694047928, 54722.326652526855, 59956.50717544556, 57910.62022399902, 57403.193534851074, 54566.313426971436, 58928.98666381836, 54570.013478040695, 56959.640100479126, 55559.54683685303, 55044.06016635895, 52177.493408203125, 55593.940366744995, 54990.46014404297, 58948.9871673584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.6223970436709, "mean_inference_ms": 6.396358529768361, "mean_action_processing_ms": 0.19932376926399353, "mean_env_wait_ms": 221.24928373604985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0421084463596344, "StateBufferConnector_ms": 0.006172806024551392, "ViewRequirementAgentConnector_ms": 0.287541002035141}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.15634074606962, "num_env_steps_trained_throughput_per_sec": 253.15634074606962, "timesteps_total": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 14809.686, "sample_time_ms": 11813.911, "learn_time_ms": 2859.384, "learn_throughput": 1398.903, "synch_weights_time_ms": 135.761}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 6760, "training_iteration": 231, "trial_id": "32397_00000", "date": "2025-03-21_09-32-53", "timestamp": 1742549573, "time_this_iter_s": 15.856727361679077, "time_total_s": 3335.5931878089905, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3335.5931878089905, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 99.18095238095239, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985479354858398, "policy_loss": -0.014600571244955063, "vf_loss": 10.0, "vf_explained_var": -1.8769254950257164e-07, "kl": 0.012789533473551273, "entropy": 0.3426211476325989, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "sampler_results": {"episode_reward_max": 58948.9871673584, "episode_reward_min": 58948.9871673584, "episode_reward_mean": 58948.9871673584, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58948.9871673584}, "policy_reward_max": {"agent_0": 58948.9871673584}, "policy_reward_mean": {"agent_0": 58948.9871673584}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58948.9871673584], "episode_lengths": [136], "policy_agent_0_reward": [58948.9871673584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.767167829891818, "mean_inference_ms": 6.043464508286804, "mean_action_processing_ms": 0.19731595408628771, "mean_env_wait_ms": 224.97151771722537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.18460750579833984}}, "episode_reward_max": 58948.9871673584, "episode_reward_min": 58948.9871673584, "episode_reward_mean": 58948.9871673584, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58948.9871673584}, "policy_reward_max": {"agent_0": 58948.9871673584}, "policy_reward_mean": {"agent_0": 58948.9871673584}, "hist_stats": {"episode_reward": [58948.9871673584], "episode_lengths": [136], "policy_agent_0_reward": [58948.9871673584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.767167829891818, "mean_inference_ms": 6.043464508286804, "mean_action_processing_ms": 0.19731595408628771, "mean_env_wait_ms": 224.97151771722537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0438690185546875, "StateBufferConnector_ms": 0.00629425048828125, "ViewRequirementAgentConnector_ms": 0.18460750579833984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.68513001630333, "num_env_steps_trained_throughput_per_sec": 297.68513001630333, "timesteps_total": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 14776.461, "sample_time_ms": 11821.102, "learn_time_ms": 2814.764, "learn_throughput": 1421.078, "synch_weights_time_ms": 139.962}, "counters": {"num_env_steps_sampled": 928000, "num_env_steps_trained": 928000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "episodes_total": 6760, "training_iteration": 232, "trial_id": "32397_00000", "date": "2025-03-21_09-33-07", "timestamp": 1742549587, "time_this_iter_s": 13.48633885383606, "time_total_s": 3349.0795266628265, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907e3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3349.0795266628265, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 99.62631578947368, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.96977710723877, "policy_loss": -0.015417685732245445, "vf_loss": 9.985107421875, "vf_explained_var": 1.8353263442349999e-07, "kl": 0.013937306590378284, "entropy": 0.39053553342819214, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "sampler_results": {"episode_reward_max": 57687.0733628273, "episode_reward_min": 44159.73352718353, "episode_reward_mean": 52048.31904870272, "episode_len_mean": 135.16666666666666, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 44159.73352718353}, "policy_reward_max": {"agent_0": 57687.0733628273}, "policy_reward_mean": {"agent_0": 52048.31904870272}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [44159.73352718353, 53995.37355232239, 49875.59342563152, 52207.66012144089, 57687.0733628273, 54364.48030281067], "episode_lengths": [133, 135, 136, 136, 136, 135], "policy_agent_0_reward": [44159.73352718353, 53995.37355232239, 49875.59342563152, 52207.66012144089, 57687.0733628273, 54364.48030281067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.86530202845394, "mean_inference_ms": 6.42178313977589, "mean_action_processing_ms": 0.19502729293375118, "mean_env_wait_ms": 234.36708869369662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05199511845906576, "StateBufferConnector_ms": 0.005757808685302734, "ViewRequirementAgentConnector_ms": 0.15556414922078451}}, "episode_reward_max": 57687.0733628273, "episode_reward_min": 44159.73352718353, "episode_reward_mean": 52048.31904870272, "episode_len_mean": 135.16666666666666, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 44159.73352718353}, "policy_reward_max": {"agent_0": 57687.0733628273}, "policy_reward_mean": {"agent_0": 52048.31904870272}, "hist_stats": {"episode_reward": [44159.73352718353, 53995.37355232239, 49875.59342563152, 52207.66012144089, 57687.0733628273, 54364.48030281067], "episode_lengths": [133, 135, 136, 136, 136, 135], "policy_agent_0_reward": [44159.73352718353, 53995.37355232239, 49875.59342563152, 52207.66012144089, 57687.0733628273, 54364.48030281067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.86530202845394, "mean_inference_ms": 6.42178313977589, "mean_action_processing_ms": 0.19502729293375118, "mean_env_wait_ms": 234.36708869369662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05199511845906576, "StateBufferConnector_ms": 0.005757808685302734, "ViewRequirementAgentConnector_ms": 0.15556414922078451}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000, "num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.1963561926841, "num_env_steps_trained_throughput_per_sec": 304.1963561926841, "timesteps_total": 932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 932000, "timers": {"training_iteration_time_ms": 14423.824, "sample_time_ms": 11537.879, "learn_time_ms": 2744.719, "learn_throughput": 1457.344, "synch_weights_time_ms": 140.594}, "counters": {"num_env_steps_sampled": 932000, "num_env_steps_trained": 932000, "num_agent_steps_sampled": 932000, "num_agent_steps_trained": 932000}, "done": false, "episodes_total": 6766, "training_iteration": 233, "trial_id": "32397_00000", "date": "2025-03-21_09-33-20", "timestamp": 1742549600, "time_this_iter_s": 13.19802188873291, "time_total_s": 3362.2775485515594, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f907edd0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3362.2775485515594, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 99.17894736842105, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.325581395348837, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.769485473632812, "policy_loss": -0.015267848037183285, "vf_loss": 9.78466796875, "vf_explained_var": 2.752368573055719e-07, "kl": 0.013573485426604748, "entropy": 0.370731920003891, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 60909.12028312683, "episode_reward_min": 49069.40009498596, "episode_reward_mean": 55863.13561871509, "episode_len_mean": 135.59302325581396, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 49069.40009498596}, "policy_reward_max": {"agent_0": 60909.12028312683}, "policy_reward_mean": {"agent_0": 55863.13561871509}, "custom_metrics": {"num_batches_mean": 5.325581395348837, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57678.41324996948, 55438.76021575928, 54504.17344379425, 58859.72003173828, 50850.04694747925, 52890.77347326279, 53009.82026529312, 58516.91374206543, 59370.09353637695, 58590.9668006897, 56807.68698120117, 58788.16694641113, 58086.71346282959, 58497.37338256836, 57043.79348182678, 53293.21344423294, 51973.786754608154, 54991.36025863886, 56168.033323287964, 58146.30039978027, 58510.55348968506, 50293.32676410675, 56163.28045654297, 54095.093608379364, 56797.20677947998, 60158.486907958984, 57304.58712387085, 56517.52672958374, 53098.40022087097, 54216.48021411896, 52446.700284957886, 58039.38698577881, 52207.94001054764, 54315.32698869705, 51596.693665504456, 54528.79343128204, 60909.12028312683, 53131.82691383362, 59389.92672729492, 54789.3268032074, 52510.093519210815, 59307.23366546631, 58602.76024246216, 52045.60026168823, 52842.95355927944, 56354.47364616394, 56583.473388671875, 55359.11368942261, 55777.0335483551, 56996.066986083984, 49099.4402217865, 55482.3733291626, 56441.64012145996, 56202.10023164749, 59988.08044433594, 56846.28684234619, 54892.14026641846, 58877.220054626465, 57024.52006530762, 56658.80027675629, 56251.62035369873, 49069.40009498596, 56712.85356140137, 57146.000215530396, 53513.00677013397, 58472.446632385254, 54177.87365913391, 60153.59361743927, 56017.96688747406, 55837.42682266235, 56662.053703308105, 58105.68032836914, 58433.360092163086, 56830.78682136536, 55329.05344200134, 58081.56660461426, 58950.233459472656, 56644.83345413208, 54282.020124435425, 58862.013763427734, 54426.95336604118, 51355.540056586266, 55793.2465801239, 53104.46034812927, 54983.1533870697, 55125.02017211914], "episode_lengths": [136, 135, 136, 136, 135, 135, 135, 136, 137, 136, 135, 136, 137, 135, 136, 135, 134, 135, 135, 136, 136, 134, 135, 135, 136, 137, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 138, 135, 136, 136, 136, 137, 136, 135, 134, 135, 135, 135, 135, 136, 134, 135, 135, 136, 136, 136, 135, 137, 135, 137, 136, 134, 136, 135, 135, 136, 135, 137, 136, 135, 137, 136, 136, 136, 135, 137, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [57678.41324996948, 55438.76021575928, 54504.17344379425, 58859.72003173828, 50850.04694747925, 52890.77347326279, 53009.82026529312, 58516.91374206543, 59370.09353637695, 58590.9668006897, 56807.68698120117, 58788.16694641113, 58086.71346282959, 58497.37338256836, 57043.79348182678, 53293.21344423294, 51973.786754608154, 54991.36025863886, 56168.033323287964, 58146.30039978027, 58510.55348968506, 50293.32676410675, 56163.28045654297, 54095.093608379364, 56797.20677947998, 60158.486907958984, 57304.58712387085, 56517.52672958374, 53098.40022087097, 54216.48021411896, 52446.700284957886, 58039.38698577881, 52207.94001054764, 54315.32698869705, 51596.693665504456, 54528.79343128204, 60909.12028312683, 53131.82691383362, 59389.92672729492, 54789.3268032074, 52510.093519210815, 59307.23366546631, 58602.76024246216, 52045.60026168823, 52842.95355927944, 56354.47364616394, 56583.473388671875, 55359.11368942261, 55777.0335483551, 56996.066986083984, 49099.4402217865, 55482.3733291626, 56441.64012145996, 56202.10023164749, 59988.08044433594, 56846.28684234619, 54892.14026641846, 58877.220054626465, 57024.52006530762, 56658.80027675629, 56251.62035369873, 49069.40009498596, 56712.85356140137, 57146.000215530396, 53513.00677013397, 58472.446632385254, 54177.87365913391, 60153.59361743927, 56017.96688747406, 55837.42682266235, 56662.053703308105, 58105.68032836914, 58433.360092163086, 56830.78682136536, 55329.05344200134, 58081.56660461426, 58950.233459472656, 56644.83345413208, 54282.020124435425, 58862.013763427734, 54426.95336604118, 51355.540056586266, 55793.2465801239, 53104.46034812927, 54983.1533870697, 55125.02017211914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.096573192297424, "mean_inference_ms": 6.766081822133674, "mean_action_processing_ms": 0.19623859382074557, "mean_env_wait_ms": 232.38849036381364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04753068436023801, "StateBufferConnector_ms": 0.005856225656908612, "ViewRequirementAgentConnector_ms": 0.2123167348462482}}, "episode_reward_max": 60909.12028312683, "episode_reward_min": 49069.40009498596, "episode_reward_mean": 55863.13561871509, "episode_len_mean": 135.59302325581396, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 49069.40009498596}, "policy_reward_max": {"agent_0": 60909.12028312683}, "policy_reward_mean": {"agent_0": 55863.13561871509}, "hist_stats": {"episode_reward": [57678.41324996948, 55438.76021575928, 54504.17344379425, 58859.72003173828, 50850.04694747925, 52890.77347326279, 53009.82026529312, 58516.91374206543, 59370.09353637695, 58590.9668006897, 56807.68698120117, 58788.16694641113, 58086.71346282959, 58497.37338256836, 57043.79348182678, 53293.21344423294, 51973.786754608154, 54991.36025863886, 56168.033323287964, 58146.30039978027, 58510.55348968506, 50293.32676410675, 56163.28045654297, 54095.093608379364, 56797.20677947998, 60158.486907958984, 57304.58712387085, 56517.52672958374, 53098.40022087097, 54216.48021411896, 52446.700284957886, 58039.38698577881, 52207.94001054764, 54315.32698869705, 51596.693665504456, 54528.79343128204, 60909.12028312683, 53131.82691383362, 59389.92672729492, 54789.3268032074, 52510.093519210815, 59307.23366546631, 58602.76024246216, 52045.60026168823, 52842.95355927944, 56354.47364616394, 56583.473388671875, 55359.11368942261, 55777.0335483551, 56996.066986083984, 49099.4402217865, 55482.3733291626, 56441.64012145996, 56202.10023164749, 59988.08044433594, 56846.28684234619, 54892.14026641846, 58877.220054626465, 57024.52006530762, 56658.80027675629, 56251.62035369873, 49069.40009498596, 56712.85356140137, 57146.000215530396, 53513.00677013397, 58472.446632385254, 54177.87365913391, 60153.59361743927, 56017.96688747406, 55837.42682266235, 56662.053703308105, 58105.68032836914, 58433.360092163086, 56830.78682136536, 55329.05344200134, 58081.56660461426, 58950.233459472656, 56644.83345413208, 54282.020124435425, 58862.013763427734, 54426.95336604118, 51355.540056586266, 55793.2465801239, 53104.46034812927, 54983.1533870697, 55125.02017211914], "episode_lengths": [136, 135, 136, 136, 135, 135, 135, 136, 137, 136, 135, 136, 137, 135, 136, 135, 134, 135, 135, 136, 136, 134, 135, 135, 136, 137, 136, 135, 136, 135, 135, 136, 136, 136, 135, 136, 138, 135, 136, 136, 136, 137, 136, 135, 134, 135, 135, 135, 135, 136, 134, 135, 135, 136, 136, 136, 135, 137, 135, 137, 136, 134, 136, 135, 135, 136, 135, 137, 136, 135, 137, 136, 136, 136, 135, 137, 136, 135, 135, 136, 136, 135, 135, 135, 136, 135], "policy_agent_0_reward": [57678.41324996948, 55438.76021575928, 54504.17344379425, 58859.72003173828, 50850.04694747925, 52890.77347326279, 53009.82026529312, 58516.91374206543, 59370.09353637695, 58590.9668006897, 56807.68698120117, 58788.16694641113, 58086.71346282959, 58497.37338256836, 57043.79348182678, 53293.21344423294, 51973.786754608154, 54991.36025863886, 56168.033323287964, 58146.30039978027, 58510.55348968506, 50293.32676410675, 56163.28045654297, 54095.093608379364, 56797.20677947998, 60158.486907958984, 57304.58712387085, 56517.52672958374, 53098.40022087097, 54216.48021411896, 52446.700284957886, 58039.38698577881, 52207.94001054764, 54315.32698869705, 51596.693665504456, 54528.79343128204, 60909.12028312683, 53131.82691383362, 59389.92672729492, 54789.3268032074, 52510.093519210815, 59307.23366546631, 58602.76024246216, 52045.60026168823, 52842.95355927944, 56354.47364616394, 56583.473388671875, 55359.11368942261, 55777.0335483551, 56996.066986083984, 49099.4402217865, 55482.3733291626, 56441.64012145996, 56202.10023164749, 59988.08044433594, 56846.28684234619, 54892.14026641846, 58877.220054626465, 57024.52006530762, 56658.80027675629, 56251.62035369873, 49069.40009498596, 56712.85356140137, 57146.000215530396, 53513.00677013397, 58472.446632385254, 54177.87365913391, 60153.59361743927, 56017.96688747406, 55837.42682266235, 56662.053703308105, 58105.68032836914, 58433.360092163086, 56830.78682136536, 55329.05344200134, 58081.56660461426, 58950.233459472656, 56644.83345413208, 54282.020124435425, 58862.013763427734, 54426.95336604118, 51355.540056586266, 55793.2465801239, 53104.46034812927, 54983.1533870697, 55125.02017211914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.096573192297424, "mean_inference_ms": 6.766081822133674, "mean_action_processing_ms": 0.19623859382074557, "mean_env_wait_ms": 232.38849036381364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04753068436023801, "StateBufferConnector_ms": 0.005856225656908612, "ViewRequirementAgentConnector_ms": 0.2123167348462482}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.12319343472018, "num_env_steps_trained_throughput_per_sec": 227.12319343472018, "timesteps_total": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 14838.564, "sample_time_ms": 12014.308, "learn_time_ms": 2691.164, "learn_throughput": 1486.346, "synch_weights_time_ms": 132.461}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 6852, "training_iteration": 234, "trial_id": "32397_00000", "date": "2025-03-21_09-33-38", "timestamp": 1742549618, "time_this_iter_s": 17.66577410697937, "time_total_s": 3379.943322658539, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3379.943322658539, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 98.25, "ram_util_percent": 13.579166666666666}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906187057495117, "policy_loss": -0.014299128204584122, "vf_loss": 9.92041015625, "vf_explained_var": 2.1575640118953743e-07, "kl": 0.012096185237169266, "entropy": 0.3390851318836212, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "sampler_results": {"episode_reward_max": 60343.60708618164, "episode_reward_min": 48592.786749362946, "episode_reward_mean": 55223.25209330022, "episode_len_mean": 135.5625, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48592.786749362946}, "policy_reward_max": {"agent_0": 60343.60708618164}, "policy_reward_mean": {"agent_0": 55223.25209330022}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56227.680000305176, 59746.04698181152, 55726.273723602295, 53614.240005493164, 55351.04691314697, 50689.48693847656, 56030.58033370972, 49880.14663696289, 49947.36010789871, 59366.320152282715, 54271.63338851929, 56473.613748550415, 52859.76677894592, 57415.61361694336, 49074.76022720337, 60343.60708618164, 52849.95342254639, 57447.206911087036, 54710.19356250763, 55463.50035905838, 48592.786749362946, 55063.05351448059, 59451.16696166992, 56932.58711242676, 54073.33346748352, 58054.48015975952, 59282.96681213379, 58336.71369934082, 50624.173382759094, 52836.287075042725, 58405.286781311035, 58002.20037460327], "episode_lengths": [136, 136, 135, 135, 136, 134, 136, 134, 134, 137, 136, 136, 135, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 136, 135, 137, 137, 136, 134, 135, 136, 136], "policy_agent_0_reward": [56227.680000305176, 59746.04698181152, 55726.273723602295, 53614.240005493164, 55351.04691314697, 50689.48693847656, 56030.58033370972, 49880.14663696289, 49947.36010789871, 59366.320152282715, 54271.63338851929, 56473.613748550415, 52859.76677894592, 57415.61361694336, 49074.76022720337, 60343.60708618164, 52849.95342254639, 57447.206911087036, 54710.19356250763, 55463.50035905838, 48592.786749362946, 55063.05351448059, 59451.16696166992, 56932.58711242676, 54073.33346748352, 58054.48015975952, 59282.96681213379, 58336.71369934082, 50624.173382759094, 52836.287075042725, 58405.286781311035, 58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.56320786801978, "mean_inference_ms": 6.389786266923996, "mean_action_processing_ms": 0.1993349601061704, "mean_env_wait_ms": 221.1807763829343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044211745262145996, "StateBufferConnector_ms": 0.04211589694023132, "ViewRequirementAgentConnector_ms": 0.28160884976387024}}, "episode_reward_max": 60343.60708618164, "episode_reward_min": 48592.786749362946, "episode_reward_mean": 55223.25209330022, "episode_len_mean": 135.5625, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48592.786749362946}, "policy_reward_max": {"agent_0": 60343.60708618164}, "policy_reward_mean": {"agent_0": 55223.25209330022}, "hist_stats": {"episode_reward": [56227.680000305176, 59746.04698181152, 55726.273723602295, 53614.240005493164, 55351.04691314697, 50689.48693847656, 56030.58033370972, 49880.14663696289, 49947.36010789871, 59366.320152282715, 54271.63338851929, 56473.613748550415, 52859.76677894592, 57415.61361694336, 49074.76022720337, 60343.60708618164, 52849.95342254639, 57447.206911087036, 54710.19356250763, 55463.50035905838, 48592.786749362946, 55063.05351448059, 59451.16696166992, 56932.58711242676, 54073.33346748352, 58054.48015975952, 59282.96681213379, 58336.71369934082, 50624.173382759094, 52836.287075042725, 58405.286781311035, 58002.20037460327], "episode_lengths": [136, 136, 135, 135, 136, 134, 136, 134, 134, 137, 136, 136, 135, 135, 135, 137, 136, 136, 135, 136, 135, 135, 136, 136, 135, 137, 137, 136, 134, 135, 136, 136], "policy_agent_0_reward": [56227.680000305176, 59746.04698181152, 55726.273723602295, 53614.240005493164, 55351.04691314697, 50689.48693847656, 56030.58033370972, 49880.14663696289, 49947.36010789871, 59366.320152282715, 54271.63338851929, 56473.613748550415, 52859.76677894592, 57415.61361694336, 49074.76022720337, 60343.60708618164, 52849.95342254639, 57447.206911087036, 54710.19356250763, 55463.50035905838, 48592.786749362946, 55063.05351448059, 59451.16696166992, 56932.58711242676, 54073.33346748352, 58054.48015975952, 59282.96681213379, 58336.71369934082, 50624.173382759094, 52836.287075042725, 58405.286781311035, 58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.56320786801978, "mean_inference_ms": 6.389786266923996, "mean_action_processing_ms": 0.1993349601061704, "mean_env_wait_ms": 221.1807763829343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044211745262145996, "StateBufferConnector_ms": 0.04211589694023132, "ViewRequirementAgentConnector_ms": 0.28160884976387024}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000, "num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.5727503899994, "num_env_steps_trained_throughput_per_sec": 268.5727503899994, "timesteps_total": 940000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 940000, "timers": {"training_iteration_time_ms": 14791.092, "sample_time_ms": 11924.735, "learn_time_ms": 2731.428, "learn_throughput": 1464.435, "synch_weights_time_ms": 134.304}, "counters": {"num_env_steps_sampled": 940000, "num_env_steps_trained": 940000, "num_agent_steps_sampled": 940000, "num_agent_steps_trained": 940000}, "done": false, "episodes_total": 6884, "training_iteration": 235, "trial_id": "32397_00000", "date": "2025-03-21_09-33-53", "timestamp": 1742549633, "time_this_iter_s": 14.943163633346558, "time_total_s": 3394.8864862918854, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3394.8864862918854, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 99.33333333333333, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985827445983887, "policy_loss": -0.014260528609156609, "vf_loss": 10.0, "vf_explained_var": 1.9837170839309692e-07, "kl": 0.014049346558749676, "entropy": 0.3385368883609772, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "sampler_results": {"episode_reward_max": 58002.20037460327, "episode_reward_min": 58002.20037460327, "episode_reward_mean": 58002.20037460327, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58002.20037460327}, "policy_reward_max": {"agent_0": 58002.20037460327}, "policy_reward_mean": {"agent_0": 58002.20037460327}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58002.20037460327], "episode_lengths": [136], "policy_agent_0_reward": [58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.723488946130683, "mean_inference_ms": 6.018068816257298, "mean_action_processing_ms": 0.19713109642528515, "mean_env_wait_ms": 224.38206824523508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04146099090576172, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1774311065673828}}, "episode_reward_max": 58002.20037460327, "episode_reward_min": 58002.20037460327, "episode_reward_mean": 58002.20037460327, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58002.20037460327}, "policy_reward_max": {"agent_0": 58002.20037460327}, "policy_reward_mean": {"agent_0": 58002.20037460327}, "hist_stats": {"episode_reward": [58002.20037460327], "episode_lengths": [136], "policy_agent_0_reward": [58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.723488946130683, "mean_inference_ms": 6.018068816257298, "mean_action_processing_ms": 0.19713109642528515, "mean_env_wait_ms": 224.38206824523508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04146099090576172, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1774311065673828}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6634479518778, "num_env_steps_trained_throughput_per_sec": 309.6634479518778, "timesteps_total": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 14734.412, "sample_time_ms": 11833.332, "learn_time_ms": 2767.07, "learn_throughput": 1445.572, "synch_weights_time_ms": 133.378}, "counters": {"num_env_steps_sampled": 944000, "num_env_steps_trained": 944000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "episodes_total": 6884, "training_iteration": 236, "trial_id": "32397_00000", "date": "2025-03-21_09-34-06", "timestamp": 1742549646, "time_this_iter_s": 12.971598386764526, "time_total_s": 3407.85808467865, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3407.85808467865, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 99.61052631578949, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.978586196899414, "policy_loss": -0.019085954874753952, "vf_loss": 9.99755859375, "vf_explained_var": 9.071082018863308e-08, "kl": 0.017962757498025894, "entropy": 0.35792747139930725, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 58002.20037460327, "episode_reward_min": 58002.20037460327, "episode_reward_mean": 58002.20037460327, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58002.20037460327}, "policy_reward_max": {"agent_0": 58002.20037460327}, "policy_reward_mean": {"agent_0": 58002.20037460327}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58002.20037460327], "episode_lengths": [136], "policy_agent_0_reward": [58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.723488946130683, "mean_inference_ms": 6.018068816257298, "mean_action_processing_ms": 0.19713109642528515, "mean_env_wait_ms": 224.38206824523508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04146099090576172, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1774311065673828}}, "episode_reward_max": 58002.20037460327, "episode_reward_min": 58002.20037460327, "episode_reward_mean": 58002.20037460327, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58002.20037460327}, "policy_reward_max": {"agent_0": 58002.20037460327}, "policy_reward_mean": {"agent_0": 58002.20037460327}, "hist_stats": {"episode_reward": [58002.20037460327], "episode_lengths": [136], "policy_agent_0_reward": [58002.20037460327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.723488946130683, "mean_inference_ms": 6.018068816257298, "mean_action_processing_ms": 0.19713109642528515, "mean_env_wait_ms": 224.38206824523508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04146099090576172, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1774311065673828}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.14015228661043, "num_env_steps_trained_throughput_per_sec": 307.14015228661043, "timesteps_total": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 14465.443, "sample_time_ms": 11547.171, "learn_time_ms": 2778.833, "learn_throughput": 1439.453, "synch_weights_time_ms": 138.809}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 6884, "training_iteration": 237, "trial_id": "32397_00000", "date": "2025-03-21_09-34-19", "timestamp": 1742549659, "time_this_iter_s": 13.074573516845703, "time_total_s": 3420.9326581954956, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3420.9326581954956, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 99.61111111111111, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.054347826086956, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.753478050231934, "policy_loss": -0.01641600765287876, "vf_loss": 9.769775390625, "vf_explained_var": -2.55803271898003e-08, "kl": 0.018848547711968422, "entropy": 0.3343605101108551, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "sampler_results": {"episode_reward_max": 62349.260314941406, "episode_reward_min": 46842.74012041092, "episode_reward_mean": 56217.70381387582, "episode_len_mean": 135.80434782608697, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46842.74012041092}, "policy_reward_max": {"agent_0": 62349.260314941406}, "policy_reward_mean": {"agent_0": 56217.70381387582}, "custom_metrics": {"num_batches_mean": 5.054347826086956, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54193.48682928085, 55093.94688415527, 57148.64677429199, 59443.54704284668, 61020.30052947998, 52720.480239868164, 56669.55352783203, 57187.46675491333, 55664.84669303894, 48059.70014476776, 56026.89318418503, 57108.42677307129, 55144.70042228699, 56388.2668800354, 58570.16677856445, 57411.640197753906, 57425.66032218933, 54244.620175123215, 57830.386878967285, 58929.086612701416, 55008.999950408936, 46842.74012041092, 52801.960247039795, 52981.13335609436, 55126.9535908699, 51043.52033996582, 56843.160247802734, 57694.313302993774, 57921.52696990967, 58372.72700500488, 55496.246764183044, 59789.76025390625, 58159.64002990723, 56360.49346733093, 51410.466760635376, 61307.1335144043, 54318.593492507935, 59045.793659210205, 51857.17348790169, 55491.27341461182, 61044.62028503418, 54532.83379936218, 60560.09370422363, 55378.613594055176, 57167.94683074951, 57095.013558387756, 61923.60708618164, 57942.22687149048, 52300.76678323746, 62349.260314941406, 58894.29333496094, 56896.140155792236, 55633.41339111328, 61184.93371582031, 50387.96012508869, 52092.0400390625, 58636.6602935791, 60010.426834106445, 54680.76008796692, 58581.00680732727, 49392.04670715332, 58248.02006530762, 58659.36003494263, 60464.273864746094, 56575.71339416504, 55485.820096969604, 56837.69333076477, 58044.46674633026, 59247.993644714355, 57350.986755371094, 61061.57382965088, 56725.613609313965, 55966.99333190918, 55004.466797828674, 55052.53353309631, 60804.80026245117, 58783.80699157715, 58523.66023635864, 53416.020334243774, 53085.83354127407, 56153.38688182831, 56957.053784161806, 51990.4467754364, 59003.013580322266, 48365.28689336777, 53188.246768951416, 54525.666625499725, 51757.68014335632, 61733.82719421387, 47643.12666833401, 56075.960205078125, 54455.327014923096], "episode_lengths": [136, 135, 136, 137, 137, 135, 136, 136, 136, 134, 136, 136, 136, 135, 136, 136, 135, 135, 136, 137, 135, 134, 135, 135, 135, 134, 135, 136, 137, 136, 136, 137, 136, 137, 135, 138, 135, 137, 136, 135, 137, 135, 137, 135, 136, 136, 137, 136, 134, 138, 136, 135, 135, 138, 135, 136, 135, 137, 135, 137, 134, 136, 136, 137, 135, 136, 136, 137, 137, 135, 137, 135, 135, 135, 135, 137, 136, 137, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 138, 134, 135, 136], "policy_agent_0_reward": [54193.48682928085, 55093.94688415527, 57148.64677429199, 59443.54704284668, 61020.30052947998, 52720.480239868164, 56669.55352783203, 57187.46675491333, 55664.84669303894, 48059.70014476776, 56026.89318418503, 57108.42677307129, 55144.70042228699, 56388.2668800354, 58570.16677856445, 57411.640197753906, 57425.66032218933, 54244.620175123215, 57830.386878967285, 58929.086612701416, 55008.999950408936, 46842.74012041092, 52801.960247039795, 52981.13335609436, 55126.9535908699, 51043.52033996582, 56843.160247802734, 57694.313302993774, 57921.52696990967, 58372.72700500488, 55496.246764183044, 59789.76025390625, 58159.64002990723, 56360.49346733093, 51410.466760635376, 61307.1335144043, 54318.593492507935, 59045.793659210205, 51857.17348790169, 55491.27341461182, 61044.62028503418, 54532.83379936218, 60560.09370422363, 55378.613594055176, 57167.94683074951, 57095.013558387756, 61923.60708618164, 57942.22687149048, 52300.76678323746, 62349.260314941406, 58894.29333496094, 56896.140155792236, 55633.41339111328, 61184.93371582031, 50387.96012508869, 52092.0400390625, 58636.6602935791, 60010.426834106445, 54680.76008796692, 58581.00680732727, 49392.04670715332, 58248.02006530762, 58659.36003494263, 60464.273864746094, 56575.71339416504, 55485.820096969604, 56837.69333076477, 58044.46674633026, 59247.993644714355, 57350.986755371094, 61061.57382965088, 56725.613609313965, 55966.99333190918, 55004.466797828674, 55052.53353309631, 60804.80026245117, 58783.80699157715, 58523.66023635864, 53416.020334243774, 53085.83354127407, 56153.38688182831, 56957.053784161806, 51990.4467754364, 59003.013580322266, 48365.28689336777, 53188.246768951416, 54525.666625499725, 51757.68014335632, 61733.82719421387, 47643.12666833401, 56075.960205078125, 54455.327014923096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.68459649410738, "mean_inference_ms": 6.7343733447212, "mean_action_processing_ms": 0.19608998053545754, "mean_env_wait_ms": 232.6165042889168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07262463155000107, "StateBufferConnector_ms": 0.00590552454409392, "ViewRequirementAgentConnector_ms": 0.17954862636068594}}, "episode_reward_max": 62349.260314941406, "episode_reward_min": 46842.74012041092, "episode_reward_mean": 56217.70381387582, "episode_len_mean": 135.80434782608697, "episodes_this_iter": 92, "policy_reward_min": {"agent_0": 46842.74012041092}, "policy_reward_max": {"agent_0": 62349.260314941406}, "policy_reward_mean": {"agent_0": 56217.70381387582}, "hist_stats": {"episode_reward": [54193.48682928085, 55093.94688415527, 57148.64677429199, 59443.54704284668, 61020.30052947998, 52720.480239868164, 56669.55352783203, 57187.46675491333, 55664.84669303894, 48059.70014476776, 56026.89318418503, 57108.42677307129, 55144.70042228699, 56388.2668800354, 58570.16677856445, 57411.640197753906, 57425.66032218933, 54244.620175123215, 57830.386878967285, 58929.086612701416, 55008.999950408936, 46842.74012041092, 52801.960247039795, 52981.13335609436, 55126.9535908699, 51043.52033996582, 56843.160247802734, 57694.313302993774, 57921.52696990967, 58372.72700500488, 55496.246764183044, 59789.76025390625, 58159.64002990723, 56360.49346733093, 51410.466760635376, 61307.1335144043, 54318.593492507935, 59045.793659210205, 51857.17348790169, 55491.27341461182, 61044.62028503418, 54532.83379936218, 60560.09370422363, 55378.613594055176, 57167.94683074951, 57095.013558387756, 61923.60708618164, 57942.22687149048, 52300.76678323746, 62349.260314941406, 58894.29333496094, 56896.140155792236, 55633.41339111328, 61184.93371582031, 50387.96012508869, 52092.0400390625, 58636.6602935791, 60010.426834106445, 54680.76008796692, 58581.00680732727, 49392.04670715332, 58248.02006530762, 58659.36003494263, 60464.273864746094, 56575.71339416504, 55485.820096969604, 56837.69333076477, 58044.46674633026, 59247.993644714355, 57350.986755371094, 61061.57382965088, 56725.613609313965, 55966.99333190918, 55004.466797828674, 55052.53353309631, 60804.80026245117, 58783.80699157715, 58523.66023635864, 53416.020334243774, 53085.83354127407, 56153.38688182831, 56957.053784161806, 51990.4467754364, 59003.013580322266, 48365.28689336777, 53188.246768951416, 54525.666625499725, 51757.68014335632, 61733.82719421387, 47643.12666833401, 56075.960205078125, 54455.327014923096], "episode_lengths": [136, 135, 136, 137, 137, 135, 136, 136, 136, 134, 136, 136, 136, 135, 136, 136, 135, 135, 136, 137, 135, 134, 135, 135, 135, 134, 135, 136, 137, 136, 136, 137, 136, 137, 135, 138, 135, 137, 136, 135, 137, 135, 137, 135, 136, 136, 137, 136, 134, 138, 136, 135, 135, 138, 135, 136, 135, 137, 135, 137, 134, 136, 136, 137, 135, 136, 136, 137, 137, 135, 137, 135, 135, 135, 135, 137, 136, 137, 136, 136, 135, 136, 136, 136, 135, 135, 135, 135, 138, 134, 135, 136], "policy_agent_0_reward": [54193.48682928085, 55093.94688415527, 57148.64677429199, 59443.54704284668, 61020.30052947998, 52720.480239868164, 56669.55352783203, 57187.46675491333, 55664.84669303894, 48059.70014476776, 56026.89318418503, 57108.42677307129, 55144.70042228699, 56388.2668800354, 58570.16677856445, 57411.640197753906, 57425.66032218933, 54244.620175123215, 57830.386878967285, 58929.086612701416, 55008.999950408936, 46842.74012041092, 52801.960247039795, 52981.13335609436, 55126.9535908699, 51043.52033996582, 56843.160247802734, 57694.313302993774, 57921.52696990967, 58372.72700500488, 55496.246764183044, 59789.76025390625, 58159.64002990723, 56360.49346733093, 51410.466760635376, 61307.1335144043, 54318.593492507935, 59045.793659210205, 51857.17348790169, 55491.27341461182, 61044.62028503418, 54532.83379936218, 60560.09370422363, 55378.613594055176, 57167.94683074951, 57095.013558387756, 61923.60708618164, 57942.22687149048, 52300.76678323746, 62349.260314941406, 58894.29333496094, 56896.140155792236, 55633.41339111328, 61184.93371582031, 50387.96012508869, 52092.0400390625, 58636.6602935791, 60010.426834106445, 54680.76008796692, 58581.00680732727, 49392.04670715332, 58248.02006530762, 58659.36003494263, 60464.273864746094, 56575.71339416504, 55485.820096969604, 56837.69333076477, 58044.46674633026, 59247.993644714355, 57350.986755371094, 61061.57382965088, 56725.613609313965, 55966.99333190918, 55004.466797828674, 55052.53353309631, 60804.80026245117, 58783.80699157715, 58523.66023635864, 53416.020334243774, 53085.83354127407, 56153.38688182831, 56957.053784161806, 51990.4467754364, 59003.013580322266, 48365.28689336777, 53188.246768951416, 54525.666625499725, 51757.68014335632, 61733.82719421387, 47643.12666833401, 56075.960205078125, 54455.327014923096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.68459649410738, "mean_inference_ms": 6.7343733447212, "mean_action_processing_ms": 0.19608998053545754, "mean_env_wait_ms": 232.6165042889168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07262463155000107, "StateBufferConnector_ms": 0.00590552454409392, "ViewRequirementAgentConnector_ms": 0.17954862636068594}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000, "num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.70043275107847, "num_env_steps_trained_throughput_per_sec": 239.70043275107847, "timesteps_total": 952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 952000, "timers": {"training_iteration_time_ms": 14830.223, "sample_time_ms": 11979.293, "learn_time_ms": 2704.021, "learn_throughput": 1479.279, "synch_weights_time_ms": 146.276}, "counters": {"num_env_steps_sampled": 952000, "num_env_steps_trained": 952000, "num_agent_steps_sampled": 952000, "num_agent_steps_trained": 952000}, "done": false, "episodes_total": 6976, "training_iteration": 238, "trial_id": "32397_00000", "date": "2025-03-21_09-34-35", "timestamp": 1742549675, "time_this_iter_s": 16.730077266693115, "time_total_s": 3437.6627354621887, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea96c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3437.6627354621887, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 97.02727272727272, "ram_util_percent": 13.581818181818186}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.906362533569336, "policy_loss": -0.012910930439829826, "vf_loss": 9.919189453125, "vf_explained_var": 1.5472372183467087e-07, "kl": 0.013495874591171741, "entropy": 0.31226399540901184, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "sampler_results": {"episode_reward_max": 60475.0735168457, "episode_reward_min": 48112.92680811882, "episode_reward_mean": 56584.03600781411, "episode_len_mean": 135.8125, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48112.92680811882}, "policy_reward_max": {"agent_0": 60475.0735168457}, "policy_reward_mean": {"agent_0": 56584.03600781411}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57411.04016113281, 54386.56024169922, 51398.47350692749, 56386.08664178848, 58979.93346977234, 57213.22674560547, 56795.820220947266, 59019.040351867676, 59526.64680480957, 58226.120178222656, 56761.63334655762, 51579.41360485554, 60292.5270690918, 58014.28692436218, 57168.62678527832, 55472.68668496609, 53348.493516922, 54498.75352859497, 54602.273533821106, 60475.0735168457, 59917.39379119873, 57852.186767578125, 56647.5598449707, 56537.52038383484, 53361.62005996704, 57802.84027481079, 59793.67332458496, 48112.92680811882, 55469.09362411499, 56115.43329620361, 59980.653732299805, 57541.53350830078], "episode_lengths": [137, 134, 134, 136, 136, 136, 136, 136, 136, 136, 136, 135, 137, 135, 136, 135, 136, 134, 136, 137, 136, 136, 136, 137, 134, 136, 136, 135, 136, 135, 138, 137], "policy_agent_0_reward": [57411.04016113281, 54386.56024169922, 51398.47350692749, 56386.08664178848, 58979.93346977234, 57213.22674560547, 56795.820220947266, 59019.040351867676, 59526.64680480957, 58226.120178222656, 56761.63334655762, 51579.41360485554, 60292.5270690918, 58014.28692436218, 57168.62678527832, 55472.68668496609, 53348.493516922, 54498.75352859497, 54602.273533821106, 60475.0735168457, 59917.39379119873, 57852.186767578125, 56647.5598449707, 56537.52038383484, 53361.62005996704, 57802.84027481079, 59793.67332458496, 48112.92680811882, 55469.09362411499, 56115.43329620361, 59980.653732299805, 57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.493618134749227, "mean_inference_ms": 6.383721485288161, "mean_action_processing_ms": 0.19938193080270508, "mean_env_wait_ms": 221.12041239534142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03954842686653137, "StateBufferConnector_ms": 0.006140023469924927, "ViewRequirementAgentConnector_ms": 0.25740042328834534}}, "episode_reward_max": 60475.0735168457, "episode_reward_min": 48112.92680811882, "episode_reward_mean": 56584.03600781411, "episode_len_mean": 135.8125, "episodes_this_iter": 32, "policy_reward_min": {"agent_0": 48112.92680811882}, "policy_reward_max": {"agent_0": 60475.0735168457}, "policy_reward_mean": {"agent_0": 56584.03600781411}, "hist_stats": {"episode_reward": [57411.04016113281, 54386.56024169922, 51398.47350692749, 56386.08664178848, 58979.93346977234, 57213.22674560547, 56795.820220947266, 59019.040351867676, 59526.64680480957, 58226.120178222656, 56761.63334655762, 51579.41360485554, 60292.5270690918, 58014.28692436218, 57168.62678527832, 55472.68668496609, 53348.493516922, 54498.75352859497, 54602.273533821106, 60475.0735168457, 59917.39379119873, 57852.186767578125, 56647.5598449707, 56537.52038383484, 53361.62005996704, 57802.84027481079, 59793.67332458496, 48112.92680811882, 55469.09362411499, 56115.43329620361, 59980.653732299805, 57541.53350830078], "episode_lengths": [137, 134, 134, 136, 136, 136, 136, 136, 136, 136, 136, 135, 137, 135, 136, 135, 136, 134, 136, 137, 136, 136, 136, 137, 134, 136, 136, 135, 136, 135, 138, 137], "policy_agent_0_reward": [57411.04016113281, 54386.56024169922, 51398.47350692749, 56386.08664178848, 58979.93346977234, 57213.22674560547, 56795.820220947266, 59019.040351867676, 59526.64680480957, 58226.120178222656, 56761.63334655762, 51579.41360485554, 60292.5270690918, 58014.28692436218, 57168.62678527832, 55472.68668496609, 53348.493516922, 54498.75352859497, 54602.273533821106, 60475.0735168457, 59917.39379119873, 57852.186767578125, 56647.5598449707, 56537.52038383484, 53361.62005996704, 57802.84027481079, 59793.67332458496, 48112.92680811882, 55469.09362411499, 56115.43329620361, 59980.653732299805, 57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.493618134749227, "mean_inference_ms": 6.383721485288161, "mean_action_processing_ms": 0.19938193080270508, "mean_env_wait_ms": 221.12041239534142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03954842686653137, "StateBufferConnector_ms": 0.006140023469924927, "ViewRequirementAgentConnector_ms": 0.25740042328834534}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000, "num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.32656264372315, "num_env_steps_trained_throughput_per_sec": 260.32656264372315, "timesteps_total": 956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 956000, "timers": {"training_iteration_time_ms": 15016.804, "sample_time_ms": 12085.674, "learn_time_ms": 2783.537, "learn_throughput": 1437.021, "synch_weights_time_ms": 146.959}, "counters": {"num_env_steps_sampled": 956000, "num_env_steps_trained": 956000, "num_agent_steps_sampled": 956000, "num_agent_steps_trained": 956000}, "done": false, "episodes_total": 7008, "training_iteration": 239, "trial_id": "32397_00000", "date": "2025-03-21_09-34-51", "timestamp": 1742549691, "time_this_iter_s": 15.423229932785034, "time_total_s": 3453.0859653949738, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8eab910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3453.0859653949738, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 99.28095238095241, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982843399047852, "policy_loss": -0.017243528738617897, "vf_loss": 10.0, "vf_explained_var": -4.482766158275808e-08, "kl": 0.01400123629719019, "entropy": 0.32692423462867737, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 57541.53350830078, "episode_reward_min": 57541.53350830078, "episode_reward_mean": 57541.53350830078, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57541.53350830078}, "policy_reward_max": {"agent_0": 57541.53350830078}, "policy_reward_mean": {"agent_0": 57541.53350830078}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57541.53350830078], "episode_lengths": [137], "policy_agent_0_reward": [57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.819567372059, "mean_inference_ms": 6.008844588397725, "mean_action_processing_ms": 0.19705640133205823, "mean_env_wait_ms": 224.02788196930297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15895366668701172}}, "episode_reward_max": 57541.53350830078, "episode_reward_min": 57541.53350830078, "episode_reward_mean": 57541.53350830078, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57541.53350830078}, "policy_reward_max": {"agent_0": 57541.53350830078}, "policy_reward_mean": {"agent_0": 57541.53350830078}, "hist_stats": {"episode_reward": [57541.53350830078], "episode_lengths": [137], "policy_agent_0_reward": [57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.819567372059, "mean_inference_ms": 6.008844588397725, "mean_action_processing_ms": 0.19705640133205823, "mean_env_wait_ms": 224.02788196930297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15895366668701172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.7470340399958, "num_env_steps_trained_throughput_per_sec": 300.7470340399958, "timesteps_total": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 14618.529, "sample_time_ms": 11625.374, "learn_time_ms": 2842.225, "learn_throughput": 1407.348, "synch_weights_time_ms": 150.295}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 7008, "training_iteration": 240, "trial_id": "32397_00000", "date": "2025-03-21_09-35-04", "timestamp": 1742549704, "time_this_iter_s": 13.35478401184082, "time_total_s": 3466.4407494068146, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea95a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3466.4407494068146, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 99.51578947368421, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.988981246948242, "policy_loss": -0.011097942478954792, "vf_loss": 10.0, "vf_explained_var": 5.438923977862942e-08, "kl": 0.012532979249954224, "entropy": 0.29700157046318054, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "sampler_results": {"episode_reward_max": 57541.53350830078, "episode_reward_min": 57541.53350830078, "episode_reward_mean": 57541.53350830078, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57541.53350830078}, "policy_reward_max": {"agent_0": 57541.53350830078}, "policy_reward_mean": {"agent_0": 57541.53350830078}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57541.53350830078], "episode_lengths": [137], "policy_agent_0_reward": [57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.819567372059, "mean_inference_ms": 6.008844588397725, "mean_action_processing_ms": 0.19705640133205823, "mean_env_wait_ms": 224.02788196930297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15895366668701172}}, "episode_reward_max": 57541.53350830078, "episode_reward_min": 57541.53350830078, "episode_reward_mean": 57541.53350830078, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57541.53350830078}, "policy_reward_max": {"agent_0": 57541.53350830078}, "policy_reward_mean": {"agent_0": 57541.53350830078}, "hist_stats": {"episode_reward": [57541.53350830078], "episode_lengths": [137], "policy_agent_0_reward": [57541.53350830078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.819567372059, "mean_inference_ms": 6.008844588397725, "mean_action_processing_ms": 0.19705640133205823, "mean_env_wait_ms": 224.02788196930297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.005459785461425781, "ViewRequirementAgentConnector_ms": 0.15895366668701172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000, "num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1764389318491, "num_env_steps_trained_throughput_per_sec": 314.1764389318491, "timesteps_total": 964000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 964000, "timers": {"training_iteration_time_ms": 14311.649, "sample_time_ms": 11293.305, "learn_time_ms": 2872.017, "learn_throughput": 1392.749, "synch_weights_time_ms": 145.7}, "counters": {"num_env_steps_sampled": 964000, "num_env_steps_trained": 964000, "num_agent_steps_sampled": 964000, "num_agent_steps_trained": 964000}, "done": false, "episodes_total": 7008, "training_iteration": 241, "trial_id": "32397_00000", "date": "2025-03-21_09-35-17", "timestamp": 1742549717, "time_this_iter_s": 12.778321266174316, "time_total_s": 3479.219070672989, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea88b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3479.219070672989, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 99.5888888888889, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.794573783874512, "policy_loss": -0.01582803949713707, "vf_loss": 9.810302734375, "vf_explained_var": -5.936871048106696e-07, "kl": 0.01570182666182518, "entropy": 0.30097803473472595, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "sampler_results": {"episode_reward_max": 62003.99377441406, "episode_reward_min": 46627.88011598587, "episode_reward_mean": 56527.26746778597, "episode_len_mean": 135.94805194805195, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 46627.88011598587}, "policy_reward_max": {"agent_0": 62003.99377441406}, "policy_reward_mean": {"agent_0": 56527.26746778597}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52374.22682785988, 49635.51369476318, 60102.286865234375, 55815.05346775055, 59813.78045654297, 59621.546966552734, 58996.09359169006, 56622.43347930908, 59863.91361999512, 48986.75355911255, 55502.120208740234, 59394.62680053711, 56066.83363342285, 60379.70704650879, 58883.66665649414, 58134.10015106201, 54966.580209732056, 53717.21354675293, 60130.24731063843, 60228.36001586914, 54455.08024406433, 58540.02013206482, 61793.38687133789, 56816.920349121094, 58701.45345687866, 57468.713441848755, 58244.02677154541, 55696.14694786072, 52109.853435754776, 56509.559980392456, 54993.793560028076, 55296.03998851776, 54426.05347156525, 56504.666894197464, 57972.813635766506, 57674.72002410889, 58943.86032104492, 59371.6201171875, 55260.48016166687, 54864.26678466797, 56675.84015369415, 56606.16679382324, 56960.90696525574, 61310.25360107422, 52449.046926021576, 60619.7204284668, 56889.766593933105, 55249.50036096573, 56571.64685058594, 50188.546699523926, 52744.93334579468, 57642.66667175293, 58003.24694442749, 59370.31343078613, 54711.20025062561, 58842.14018249512, 57779.56704711914, 62003.99377441406, 54730.36693382263, 60877.26698303223, 55021.753452301025, 46627.88011598587, 52738.5535030365, 52960.57369232178, 54523.45372009277, 55485.866958618164, 58527.43383026123, 54982.87993812561, 57961.4933013916, 57709.84694099426, 54246.75347709656, 56155.180097579956, 54092.72671890259, 57129.33322143555, 55618.973264694214, 56527.38042449951, 57183.886726379395], "episode_lengths": [134, 134, 138, 135, 136, 137, 136, 136, 137, 133, 136, 137, 136, 137, 136, 136, 135, 135, 136, 137, 136, 136, 138, 137, 137, 136, 136, 136, 135, 137, 136, 135, 136, 137, 137, 136, 136, 136, 137, 136, 137, 135, 136, 138, 135, 137, 135, 135, 136, 133, 135, 136, 137, 136, 136, 137, 136, 138, 135, 137, 136, 134, 135, 135, 135, 136, 136, 137, 136, 136, 134, 137, 136, 135, 136, 135, 136], "policy_agent_0_reward": [52374.22682785988, 49635.51369476318, 60102.286865234375, 55815.05346775055, 59813.78045654297, 59621.546966552734, 58996.09359169006, 56622.43347930908, 59863.91361999512, 48986.75355911255, 55502.120208740234, 59394.62680053711, 56066.83363342285, 60379.70704650879, 58883.66665649414, 58134.10015106201, 54966.580209732056, 53717.21354675293, 60130.24731063843, 60228.36001586914, 54455.08024406433, 58540.02013206482, 61793.38687133789, 56816.920349121094, 58701.45345687866, 57468.713441848755, 58244.02677154541, 55696.14694786072, 52109.853435754776, 56509.559980392456, 54993.793560028076, 55296.03998851776, 54426.05347156525, 56504.666894197464, 57972.813635766506, 57674.72002410889, 58943.86032104492, 59371.6201171875, 55260.48016166687, 54864.26678466797, 56675.84015369415, 56606.16679382324, 56960.90696525574, 61310.25360107422, 52449.046926021576, 60619.7204284668, 56889.766593933105, 55249.50036096573, 56571.64685058594, 50188.546699523926, 52744.93334579468, 57642.66667175293, 58003.24694442749, 59370.31343078613, 54711.20025062561, 58842.14018249512, 57779.56704711914, 62003.99377441406, 54730.36693382263, 60877.26698303223, 55021.753452301025, 46627.88011598587, 52738.5535030365, 52960.57369232178, 54523.45372009277, 55485.866958618164, 58527.43383026123, 54982.87993812561, 57961.4933013916, 57709.84694099426, 54246.75347709656, 56155.180097579956, 54092.72671890259, 57129.33322143555, 55618.973264694214, 56527.38042449951, 57183.886726379395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.978309323272303, "mean_inference_ms": 6.738499909539162, "mean_action_processing_ms": 0.19614330518282977, "mean_env_wait_ms": 233.11429237708325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03836216864647803, "StateBufferConnector_ms": 0.006021772112165179, "ViewRequirementAgentConnector_ms": 0.21709250165270522}}, "episode_reward_max": 62003.99377441406, "episode_reward_min": 46627.88011598587, "episode_reward_mean": 56527.26746778597, "episode_len_mean": 135.94805194805195, "episodes_this_iter": 77, "policy_reward_min": {"agent_0": 46627.88011598587}, "policy_reward_max": {"agent_0": 62003.99377441406}, "policy_reward_mean": {"agent_0": 56527.26746778597}, "hist_stats": {"episode_reward": [52374.22682785988, 49635.51369476318, 60102.286865234375, 55815.05346775055, 59813.78045654297, 59621.546966552734, 58996.09359169006, 56622.43347930908, 59863.91361999512, 48986.75355911255, 55502.120208740234, 59394.62680053711, 56066.83363342285, 60379.70704650879, 58883.66665649414, 58134.10015106201, 54966.580209732056, 53717.21354675293, 60130.24731063843, 60228.36001586914, 54455.08024406433, 58540.02013206482, 61793.38687133789, 56816.920349121094, 58701.45345687866, 57468.713441848755, 58244.02677154541, 55696.14694786072, 52109.853435754776, 56509.559980392456, 54993.793560028076, 55296.03998851776, 54426.05347156525, 56504.666894197464, 57972.813635766506, 57674.72002410889, 58943.86032104492, 59371.6201171875, 55260.48016166687, 54864.26678466797, 56675.84015369415, 56606.16679382324, 56960.90696525574, 61310.25360107422, 52449.046926021576, 60619.7204284668, 56889.766593933105, 55249.50036096573, 56571.64685058594, 50188.546699523926, 52744.93334579468, 57642.66667175293, 58003.24694442749, 59370.31343078613, 54711.20025062561, 58842.14018249512, 57779.56704711914, 62003.99377441406, 54730.36693382263, 60877.26698303223, 55021.753452301025, 46627.88011598587, 52738.5535030365, 52960.57369232178, 54523.45372009277, 55485.866958618164, 58527.43383026123, 54982.87993812561, 57961.4933013916, 57709.84694099426, 54246.75347709656, 56155.180097579956, 54092.72671890259, 57129.33322143555, 55618.973264694214, 56527.38042449951, 57183.886726379395], "episode_lengths": [134, 134, 138, 135, 136, 137, 136, 136, 137, 133, 136, 137, 136, 137, 136, 136, 135, 135, 136, 137, 136, 136, 138, 137, 137, 136, 136, 136, 135, 137, 136, 135, 136, 137, 137, 136, 136, 136, 137, 136, 137, 135, 136, 138, 135, 137, 135, 135, 136, 133, 135, 136, 137, 136, 136, 137, 136, 138, 135, 137, 136, 134, 135, 135, 135, 136, 136, 137, 136, 136, 134, 137, 136, 135, 136, 135, 136], "policy_agent_0_reward": [52374.22682785988, 49635.51369476318, 60102.286865234375, 55815.05346775055, 59813.78045654297, 59621.546966552734, 58996.09359169006, 56622.43347930908, 59863.91361999512, 48986.75355911255, 55502.120208740234, 59394.62680053711, 56066.83363342285, 60379.70704650879, 58883.66665649414, 58134.10015106201, 54966.580209732056, 53717.21354675293, 60130.24731063843, 60228.36001586914, 54455.08024406433, 58540.02013206482, 61793.38687133789, 56816.920349121094, 58701.45345687866, 57468.713441848755, 58244.02677154541, 55696.14694786072, 52109.853435754776, 56509.559980392456, 54993.793560028076, 55296.03998851776, 54426.05347156525, 56504.666894197464, 57972.813635766506, 57674.72002410889, 58943.86032104492, 59371.6201171875, 55260.48016166687, 54864.26678466797, 56675.84015369415, 56606.16679382324, 56960.90696525574, 61310.25360107422, 52449.046926021576, 60619.7204284668, 56889.766593933105, 55249.50036096573, 56571.64685058594, 50188.546699523926, 52744.93334579468, 57642.66667175293, 58003.24694442749, 59370.31343078613, 54711.20025062561, 58842.14018249512, 57779.56704711914, 62003.99377441406, 54730.36693382263, 60877.26698303223, 55021.753452301025, 46627.88011598587, 52738.5535030365, 52960.57369232178, 54523.45372009277, 55485.866958618164, 58527.43383026123, 54982.87993812561, 57961.4933013916, 57709.84694099426, 54246.75347709656, 56155.180097579956, 54092.72671890259, 57129.33322143555, 55618.973264694214, 56527.38042449951, 57183.886726379395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.978309323272303, "mean_inference_ms": 6.738499909539162, "mean_action_processing_ms": 0.19614330518282977, "mean_env_wait_ms": 233.11429237708325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03836216864647803, "StateBufferConnector_ms": 0.006021772112165179, "ViewRequirementAgentConnector_ms": 0.21709250165270522}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000, "num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.3598170554249, "num_env_steps_trained_throughput_per_sec": 263.3598170554249, "timesteps_total": 968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 968000, "timers": {"training_iteration_time_ms": 14486.783, "sample_time_ms": 11572.399, "learn_time_ms": 2774.416, "learn_throughput": 1441.745, "synch_weights_time_ms": 139.343}, "counters": {"num_env_steps_sampled": 968000, "num_env_steps_trained": 968000, "num_agent_steps_sampled": 968000, "num_agent_steps_trained": 968000}, "done": false, "episodes_total": 7085, "training_iteration": 242, "trial_id": "32397_00000", "date": "2025-03-21_09-35-33", "timestamp": 1742549733, "time_this_iter_s": 15.240463018417358, "time_total_s": 3494.4595336914062, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3494.4595336914062, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 97.24090909090908, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.873653411865234, "policy_loss": -0.01364152692258358, "vf_loss": 9.887207984924316, "vf_explained_var": 4.470348358154297e-08, "kl": 0.013748710975050926, "entropy": 0.32692235708236694, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 60594.10693359375, "episode_reward_min": 50143.28015935421, "episode_reward_mean": 56891.578840552436, "episode_len_mean": 136.04444444444445, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {"agent_0": 50143.28015935421}, "policy_reward_max": {"agent_0": 60594.10693359375}, "policy_reward_mean": {"agent_0": 56891.578840552436}, "custom_metrics": {"num_batches_mean": 5.333333333333333, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56512.48680114746, 58826.866790771484, 55980.860219955444, 60255.20693206787, 57775.86024475098, 57144.81359863281, 57802.95341491699, 52833.9534894228, 58402.0334482193, 57620.526821136475, 57792.20679473877, 56637.25330162048, 57067.69324493408, 54377.780019283295, 59354.44004821777, 59773.22039794922, 58555.11347961426, 58255.833641052246, 59990.973472595215, 58222.6468334198, 60078.10038757324, 56710.52020263672, 58502.60009765625, 58090.200384140015, 55940.360176086426, 53499.3467798233, 57532.07380485535, 57550.97381210327, 54415.36686706543, 59813.57356262207, 52044.28679275513, 58693.52003479004, 60055.43341064453, 56455.45345878601, 60594.10693359375, 50618.140226364136, 58861.81326675415, 57805.0267868042, 55916.3338432312, 50984.50035381317, 55598.67335128784, 50143.28015935421, 56514.76690578461, 55183.586503982544, 55336.28672790527], "episode_lengths": [135, 136, 136, 137, 136, 135, 137, 135, 137, 136, 136, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 135, 136, 136, 135, 135, 137, 136, 136, 137, 136, 136, 137, 136, 137, 135, 136, 136, 135, 136, 136, 135, 136, 136, 136], "policy_agent_0_reward": [56512.48680114746, 58826.866790771484, 55980.860219955444, 60255.20693206787, 57775.86024475098, 57144.81359863281, 57802.95341491699, 52833.9534894228, 58402.0334482193, 57620.526821136475, 57792.20679473877, 56637.25330162048, 57067.69324493408, 54377.780019283295, 59354.44004821777, 59773.22039794922, 58555.11347961426, 58255.833641052246, 59990.973472595215, 58222.6468334198, 60078.10038757324, 56710.52020263672, 58502.60009765625, 58090.200384140015, 55940.360176086426, 53499.3467798233, 57532.07380485535, 57550.97381210327, 54415.36686706543, 59813.57356262207, 52044.28679275513, 58693.52003479004, 60055.43341064453, 56455.45345878601, 60594.10693359375, 50618.140226364136, 58861.81326675415, 57805.0267868042, 55916.3338432312, 50984.50035381317, 55598.67335128784, 50143.28015935421, 56514.76690578461, 55183.586503982544, 55336.28672790527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.107417233273285, "mean_inference_ms": 6.487290420532609, "mean_action_processing_ms": 0.19804106241982905, "mean_env_wait_ms": 224.13320320806585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07374763488769531, "StateBufferConnector_ms": 0.01404179467095269, "ViewRequirementAgentConnector_ms": 0.21745840708414713}}, "episode_reward_max": 60594.10693359375, "episode_reward_min": 50143.28015935421, "episode_reward_mean": 56891.578840552436, "episode_len_mean": 136.04444444444445, "episodes_this_iter": 45, "policy_reward_min": {"agent_0": 50143.28015935421}, "policy_reward_max": {"agent_0": 60594.10693359375}, "policy_reward_mean": {"agent_0": 56891.578840552436}, "hist_stats": {"episode_reward": [56512.48680114746, 58826.866790771484, 55980.860219955444, 60255.20693206787, 57775.86024475098, 57144.81359863281, 57802.95341491699, 52833.9534894228, 58402.0334482193, 57620.526821136475, 57792.20679473877, 56637.25330162048, 57067.69324493408, 54377.780019283295, 59354.44004821777, 59773.22039794922, 58555.11347961426, 58255.833641052246, 59990.973472595215, 58222.6468334198, 60078.10038757324, 56710.52020263672, 58502.60009765625, 58090.200384140015, 55940.360176086426, 53499.3467798233, 57532.07380485535, 57550.97381210327, 54415.36686706543, 59813.57356262207, 52044.28679275513, 58693.52003479004, 60055.43341064453, 56455.45345878601, 60594.10693359375, 50618.140226364136, 58861.81326675415, 57805.0267868042, 55916.3338432312, 50984.50035381317, 55598.67335128784, 50143.28015935421, 56514.76690578461, 55183.586503982544, 55336.28672790527], "episode_lengths": [135, 136, 136, 137, 136, 135, 137, 135, 137, 136, 136, 136, 136, 136, 137, 137, 136, 136, 137, 136, 137, 135, 136, 136, 135, 135, 137, 136, 136, 137, 136, 136, 137, 136, 137, 135, 136, 136, 135, 136, 136, 135, 136, 136, 136], "policy_agent_0_reward": [56512.48680114746, 58826.866790771484, 55980.860219955444, 60255.20693206787, 57775.86024475098, 57144.81359863281, 57802.95341491699, 52833.9534894228, 58402.0334482193, 57620.526821136475, 57792.20679473877, 56637.25330162048, 57067.69324493408, 54377.780019283295, 59354.44004821777, 59773.22039794922, 58555.11347961426, 58255.833641052246, 59990.973472595215, 58222.6468334198, 60078.10038757324, 56710.52020263672, 58502.60009765625, 58090.200384140015, 55940.360176086426, 53499.3467798233, 57532.07380485535, 57550.97381210327, 54415.36686706543, 59813.57356262207, 52044.28679275513, 58693.52003479004, 60055.43341064453, 56455.45345878601, 60594.10693359375, 50618.140226364136, 58861.81326675415, 57805.0267868042, 55916.3338432312, 50984.50035381317, 55598.67335128784, 50143.28015935421, 56514.76690578461, 55183.586503982544, 55336.28672790527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.107417233273285, "mean_inference_ms": 6.487290420532609, "mean_action_processing_ms": 0.19804106241982905, "mean_env_wait_ms": 224.13320320806585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07374763488769531, "StateBufferConnector_ms": 0.01404179467095269, "ViewRequirementAgentConnector_ms": 0.21745840708414713}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.8407440022405, "num_env_steps_trained_throughput_per_sec": 265.8407440022405, "timesteps_total": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 14676.502, "sample_time_ms": 11751.252, "learn_time_ms": 2787.034, "learn_throughput": 1435.217, "synch_weights_time_ms": 137.586}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 7130, "training_iteration": 243, "trial_id": "32397_00000", "date": "2025-03-21_09-35-48", "timestamp": 1742549748, "time_this_iter_s": 15.099228382110596, "time_total_s": 3509.558762073517, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3509.558762073517, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 99.42999999999999, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.977829933166504, "policy_loss": -0.014695064164698124, "vf_loss": 9.992431640625, "vf_explained_var": -1.0095536850940334e-07, "kl": 0.015049213543534279, "entropy": 0.3226589262485504, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "sampler_results": {"episode_reward_max": 59013.49328613281, "episode_reward_min": 56384.02695465088, "episode_reward_mean": 57698.760120391846, "episode_len_mean": 136.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56384.02695465088}, "policy_reward_max": {"agent_0": 59013.49328613281}, "policy_reward_mean": {"agent_0": 57698.760120391846}, "custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59013.49328613281, 56384.02695465088], "episode_lengths": [137, 136], "policy_agent_0_reward": [59013.49328613281, 56384.02695465088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.549881059724058, "mean_inference_ms": 6.26785126322177, "mean_action_processing_ms": 0.20010553057054903, "mean_env_wait_ms": 222.8592783564235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03560781478881836, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1559138298034668}}, "episode_reward_max": 59013.49328613281, "episode_reward_min": 56384.02695465088, "episode_reward_mean": 57698.760120391846, "episode_len_mean": 136.5, "episodes_this_iter": 2, "policy_reward_min": {"agent_0": 56384.02695465088}, "policy_reward_max": {"agent_0": 59013.49328613281}, "policy_reward_mean": {"agent_0": 57698.760120391846}, "hist_stats": {"episode_reward": [59013.49328613281, 56384.02695465088], "episode_lengths": [137, 136], "policy_agent_0_reward": [59013.49328613281, 56384.02695465088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.549881059724058, "mean_inference_ms": 6.26785126322177, "mean_action_processing_ms": 0.20010553057054903, "mean_env_wait_ms": 222.8592783564235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03560781478881836, "StateBufferConnector_ms": 0.005841255187988281, "ViewRequirementAgentConnector_ms": 0.1559138298034668}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.18380430487053, "num_env_steps_trained_throughput_per_sec": 324.18380430487053, "timesteps_total": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 14149.211, "sample_time_ms": 11269.069, "learn_time_ms": 2743.165, "learn_throughput": 1458.17, "synch_weights_time_ms": 136.345}, "counters": {"num_env_steps_sampled": 976000, "num_env_steps_trained": 976000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "episodes_total": 7132, "training_iteration": 244, "trial_id": "32397_00000", "date": "2025-03-21_09-36-00", "timestamp": 1742549760, "time_this_iter_s": 12.387162208557129, "time_total_s": 3521.945924282074, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3521.945924282074, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 99.51111111111112, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98540210723877, "policy_loss": -0.014682144857943058, "vf_loss": 10.0, "vf_explained_var": -9.238719655968453e-08, "kl": 0.013519654981791973, "entropy": 0.35110124945640564, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "sampler_results": {"episode_reward_max": 56384.02695465088, "episode_reward_min": 56384.02695465088, "episode_reward_mean": 56384.02695465088, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56384.02695465088}, "policy_reward_max": {"agent_0": 56384.02695465088}, "policy_reward_mean": {"agent_0": 56384.02695465088}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56384.02695465088], "episode_lengths": [136], "policy_agent_0_reward": [56384.02695465088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.02743964986921, "mean_inference_ms": 6.2097033165884685, "mean_action_processing_ms": 0.19469001227160587, "mean_env_wait_ms": 223.5470949071365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030350685119628906, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.1333475112915039}}, "episode_reward_max": 56384.02695465088, "episode_reward_min": 56384.02695465088, "episode_reward_mean": 56384.02695465088, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56384.02695465088}, "policy_reward_max": {"agent_0": 56384.02695465088}, "policy_reward_mean": {"agent_0": 56384.02695465088}, "hist_stats": {"episode_reward": [56384.02695465088], "episode_lengths": [136], "policy_agent_0_reward": [56384.02695465088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.02743964986921, "mean_inference_ms": 6.2097033165884685, "mean_action_processing_ms": 0.19469001227160587, "mean_env_wait_ms": 223.5470949071365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030350685119628906, "StateBufferConnector_ms": 0.004887580871582031, "ViewRequirementAgentConnector_ms": 0.1333475112915039}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000, "num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1761934531222, "num_env_steps_trained_throughput_per_sec": 306.1761934531222, "timesteps_total": 980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 980000, "timers": {"training_iteration_time_ms": 13966.298, "sample_time_ms": 11082.839, "learn_time_ms": 2747.223, "learn_throughput": 1456.016, "synch_weights_time_ms": 135.596}, "counters": {"num_env_steps_sampled": 980000, "num_env_steps_trained": 980000, "num_agent_steps_sampled": 980000, "num_agent_steps_trained": 980000}, "done": false, "episodes_total": 7132, "training_iteration": 245, "trial_id": "32397_00000", "date": "2025-03-21_09-36-13", "timestamp": 1742549773, "time_this_iter_s": 13.1165931224823, "time_total_s": 3535.0625174045563, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8eab910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3535.0625174045563, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 99.53157894736843, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.87723445892334, "policy_loss": -0.014933568425476551, "vf_loss": 9.89208984375, "vf_explained_var": -7.065634122227493e-08, "kl": 0.012586466036736965, "entropy": 0.342792809009552, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 61458.8667640686, "episode_reward_min": 46806.240038871765, "episode_reward_mean": 56154.99737691879, "episode_len_mean": 135.86046511627907, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {"agent_0": 46806.240038871765}, "policy_reward_max": {"agent_0": 61458.8667640686}, "policy_reward_mean": {"agent_0": 56154.99737691879}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57771.346685409546, 57221.886936187744, 57492.51377105713, 56237.5467376709, 55955.35359573364, 56632.600175857544, 55164.313510894775, 60394.913650512695, 61458.8667640686, 59451.066986083984, 58716.0401763916, 52328.76679229736, 56185.26689529419, 46806.240038871765, 57462.56014633179, 58333.08004760742, 56752.64673995972, 58939.08686828613, 52696.05341434479, 59288.20658874512, 55567.80683040619, 57737.840211868286, 57326.0602722168, 58198.900131225586, 57007.30672454834, 53563.70691585541, 59614.30694580078, 58462.92674064636, 54198.080028533936, 54189.846866607666, 56119.49355316162, 53247.32704734802, 53991.11999130249, 47867.426653862, 56603.2868347168, 56895.60022163391, 60053.74011230469, 48657.840000629425, 58195.14682006836, 59427.17369842529, 55470.28030586243, 53549.940218925476, 53431.37355995178], "episode_lengths": [136, 136, 136, 135, 136, 135, 135, 137, 137, 137, 136, 134, 135, 134, 136, 137, 136, 137, 135, 137, 137, 136, 137, 136, 136, 136, 136, 137, 136, 136, 135, 135, 136, 136, 135, 136, 137, 133, 136, 137, 136, 136, 134], "policy_agent_0_reward": [57771.346685409546, 57221.886936187744, 57492.51377105713, 56237.5467376709, 55955.35359573364, 56632.600175857544, 55164.313510894775, 60394.913650512695, 61458.8667640686, 59451.066986083984, 58716.0401763916, 52328.76679229736, 56185.26689529419, 46806.240038871765, 57462.56014633179, 58333.08004760742, 56752.64673995972, 58939.08686828613, 52696.05341434479, 59288.20658874512, 55567.80683040619, 57737.840211868286, 57326.0602722168, 58198.900131225586, 57007.30672454834, 53563.70691585541, 59614.30694580078, 58462.92674064636, 54198.080028533936, 54189.846866607666, 56119.49355316162, 53247.32704734802, 53991.11999130249, 47867.426653862, 56603.2868347168, 56895.60022163391, 60053.74011230469, 48657.840000629425, 58195.14682006836, 59427.17369842529, 55470.28030586243, 53549.940218925476, 53431.37355995178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.07039064884649, "mean_inference_ms": 6.65562312637414, "mean_action_processing_ms": 0.19551608685566627, "mean_env_wait_ms": 233.5966352622196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039296371992244276, "StateBufferConnector_ms": 0.006108505781306777, "ViewRequirementAgentConnector_ms": 0.2820037132085756}}, "episode_reward_max": 61458.8667640686, "episode_reward_min": 46806.240038871765, "episode_reward_mean": 56154.99737691879, "episode_len_mean": 135.86046511627907, "episodes_this_iter": 43, "policy_reward_min": {"agent_0": 46806.240038871765}, "policy_reward_max": {"agent_0": 61458.8667640686}, "policy_reward_mean": {"agent_0": 56154.99737691879}, "hist_stats": {"episode_reward": [57771.346685409546, 57221.886936187744, 57492.51377105713, 56237.5467376709, 55955.35359573364, 56632.600175857544, 55164.313510894775, 60394.913650512695, 61458.8667640686, 59451.066986083984, 58716.0401763916, 52328.76679229736, 56185.26689529419, 46806.240038871765, 57462.56014633179, 58333.08004760742, 56752.64673995972, 58939.08686828613, 52696.05341434479, 59288.20658874512, 55567.80683040619, 57737.840211868286, 57326.0602722168, 58198.900131225586, 57007.30672454834, 53563.70691585541, 59614.30694580078, 58462.92674064636, 54198.080028533936, 54189.846866607666, 56119.49355316162, 53247.32704734802, 53991.11999130249, 47867.426653862, 56603.2868347168, 56895.60022163391, 60053.74011230469, 48657.840000629425, 58195.14682006836, 59427.17369842529, 55470.28030586243, 53549.940218925476, 53431.37355995178], "episode_lengths": [136, 136, 136, 135, 136, 135, 135, 137, 137, 137, 136, 134, 135, 134, 136, 137, 136, 137, 135, 137, 137, 136, 137, 136, 136, 136, 136, 137, 136, 136, 135, 135, 136, 136, 135, 136, 137, 133, 136, 137, 136, 136, 134], "policy_agent_0_reward": [57771.346685409546, 57221.886936187744, 57492.51377105713, 56237.5467376709, 55955.35359573364, 56632.600175857544, 55164.313510894775, 60394.913650512695, 61458.8667640686, 59451.066986083984, 58716.0401763916, 52328.76679229736, 56185.26689529419, 46806.240038871765, 57462.56014633179, 58333.08004760742, 56752.64673995972, 58939.08686828613, 52696.05341434479, 59288.20658874512, 55567.80683040619, 57737.840211868286, 57326.0602722168, 58198.900131225586, 57007.30672454834, 53563.70691585541, 59614.30694580078, 58462.92674064636, 54198.080028533936, 54189.846866607666, 56119.49355316162, 53247.32704734802, 53991.11999130249, 47867.426653862, 56603.2868347168, 56895.60022163391, 60053.74011230469, 48657.840000629425, 58195.14682006836, 59427.17369842529, 55470.28030586243, 53549.940218925476, 53431.37355995178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.07039064884649, "mean_inference_ms": 6.65562312637414, "mean_action_processing_ms": 0.19551608685566627, "mean_env_wait_ms": 233.5966352622196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039296371992244276, "StateBufferConnector_ms": 0.006108505781306777, "ViewRequirementAgentConnector_ms": 0.2820037132085756}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.0952091082452, "num_env_steps_trained_throughput_per_sec": 298.0952091082452, "timesteps_total": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 14016.428, "sample_time_ms": 11196.733, "learn_time_ms": 2682.984, "learn_throughput": 1490.877, "synch_weights_time_ms": 136.082}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 7175, "training_iteration": 246, "trial_id": "32397_00000", "date": "2025-03-21_09-36-27", "timestamp": 1742549787, "time_this_iter_s": 13.469372987747192, "time_total_s": 3548.5318903923035, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3548.5318903923035, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 98.55789473684212, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.423076923076923, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.788874626159668, "policy_loss": -0.014435351826250553, "vf_loss": 9.80322265625, "vf_explained_var": -3.080814963141165e-07, "kl": 0.013856129720807076, "entropy": 0.34020739793777466, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "sampler_results": {"episode_reward_max": 60973.76010131836, "episode_reward_min": 46542.36008787155, "episode_reward_mean": 56449.84706182434, "episode_len_mean": 135.85897435897436, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {"agent_0": 46542.36008787155}, "policy_reward_max": {"agent_0": 60973.76010131836}, "policy_reward_mean": {"agent_0": 56449.84706182434}, "custom_metrics": {"num_batches_mean": 5.423076923076923, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56474.43356895447, 59746.04665374756, 55903.16677856445, 58468.06008148193, 58450.48014640808, 58081.25996398926, 57708.740121245384, 56751.28664779663, 58000.106855392456, 56869.33353805542, 56392.36019897461, 52040.86682701111, 50485.88004338741, 53314.213497161865, 46542.36008787155, 54873.71348428726, 57195.05372619629, 56120.9467754364, 57930.51348114014, 56663.85367393494, 58328.55334472656, 53436.19329357147, 56478.080139160156, 50421.706823349, 58041.55362319946, 59348.573501586914, 59767.28015899658, 53450.27990913391, 57237.64012145996, 58453.04678964615, 50873.40025138855, 57322.893421173096, 58420.573711395264, 57789.53985595703, 55958.72690296173, 55935.00027179718, 59878.31346130371, 59400.886878967285, 57964.546875, 58728.20681762695, 60551.77340698242, 59613.4801940918, 58461.11366271973, 57918.413414001465, 58013.42672729492, 50720.34020650387, 50642.94684559107, 58609.0802154541, 54352.213509082794, 59183.86666870117, 53759.67360687256, 54870.453437805176, 57434.83382034302, 59173.31336975098, 55230.293504714966, 55557.90022659302, 54226.273584365845, 58319.49329376221, 58094.19338512421, 48671.78024327755, 55745.36675643921, 54911.966853141785, 60053.2668838501, 58862.62675857544, 58936.17363739014, 49848.5466132164, 54377.34677886963, 58547.51326370239, 60973.76010131836, 51385.280009269714, 58959.35354614258, 56839.67990112305, 53819.72657394409, 56355.40007019043, 58229.020223617554, 59483.339904785156, 58320.32025909424, 58786.84706115723], "episode_lengths": [137, 137, 135, 136, 137, 136, 136, 136, 137, 136, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 135, 137, 136, 137, 136, 135, 136, 135, 136, 136, 136, 137, 136, 137, 137, 136, 137, 137, 136, 136, 136, 136, 135, 135, 137, 135, 136, 134, 136, 136, 137, 135, 135, 135, 136, 137, 134, 135, 136, 137, 136, 136, 135, 135, 136, 137, 135, 136, 136, 135, 135, 136, 136, 136, 136], "policy_agent_0_reward": [56474.43356895447, 59746.04665374756, 55903.16677856445, 58468.06008148193, 58450.48014640808, 58081.25996398926, 57708.740121245384, 56751.28664779663, 58000.106855392456, 56869.33353805542, 56392.36019897461, 52040.86682701111, 50485.88004338741, 53314.213497161865, 46542.36008787155, 54873.71348428726, 57195.05372619629, 56120.9467754364, 57930.51348114014, 56663.85367393494, 58328.55334472656, 53436.19329357147, 56478.080139160156, 50421.706823349, 58041.55362319946, 59348.573501586914, 59767.28015899658, 53450.27990913391, 57237.64012145996, 58453.04678964615, 50873.40025138855, 57322.893421173096, 58420.573711395264, 57789.53985595703, 55958.72690296173, 55935.00027179718, 59878.31346130371, 59400.886878967285, 57964.546875, 58728.20681762695, 60551.77340698242, 59613.4801940918, 58461.11366271973, 57918.413414001465, 58013.42672729492, 50720.34020650387, 50642.94684559107, 58609.0802154541, 54352.213509082794, 59183.86666870117, 53759.67360687256, 54870.453437805176, 57434.83382034302, 59173.31336975098, 55230.293504714966, 55557.90022659302, 54226.273584365845, 58319.49329376221, 58094.19338512421, 48671.78024327755, 55745.36675643921, 54911.966853141785, 60053.2668838501, 58862.62675857544, 58936.17363739014, 49848.5466132164, 54377.34677886963, 58547.51326370239, 60973.76010131836, 51385.280009269714, 58959.35354614258, 56839.67990112305, 53819.72657394409, 56355.40007019043, 58229.020223617554, 59483.339904785156, 58320.32025909424, 58786.84706115723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.991867061909605, "mean_inference_ms": 6.64816593435861, "mean_action_processing_ms": 0.19736678235626545, "mean_env_wait_ms": 227.9370206055152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04209127181615585, "StateBufferConnector_ms": 0.006084564404609876, "ViewRequirementAgentConnector_ms": 0.21137182529156023}}, "episode_reward_max": 60973.76010131836, "episode_reward_min": 46542.36008787155, "episode_reward_mean": 56449.84706182434, "episode_len_mean": 135.85897435897436, "episodes_this_iter": 78, "policy_reward_min": {"agent_0": 46542.36008787155}, "policy_reward_max": {"agent_0": 60973.76010131836}, "policy_reward_mean": {"agent_0": 56449.84706182434}, "hist_stats": {"episode_reward": [56474.43356895447, 59746.04665374756, 55903.16677856445, 58468.06008148193, 58450.48014640808, 58081.25996398926, 57708.740121245384, 56751.28664779663, 58000.106855392456, 56869.33353805542, 56392.36019897461, 52040.86682701111, 50485.88004338741, 53314.213497161865, 46542.36008787155, 54873.71348428726, 57195.05372619629, 56120.9467754364, 57930.51348114014, 56663.85367393494, 58328.55334472656, 53436.19329357147, 56478.080139160156, 50421.706823349, 58041.55362319946, 59348.573501586914, 59767.28015899658, 53450.27990913391, 57237.64012145996, 58453.04678964615, 50873.40025138855, 57322.893421173096, 58420.573711395264, 57789.53985595703, 55958.72690296173, 55935.00027179718, 59878.31346130371, 59400.886878967285, 57964.546875, 58728.20681762695, 60551.77340698242, 59613.4801940918, 58461.11366271973, 57918.413414001465, 58013.42672729492, 50720.34020650387, 50642.94684559107, 58609.0802154541, 54352.213509082794, 59183.86666870117, 53759.67360687256, 54870.453437805176, 57434.83382034302, 59173.31336975098, 55230.293504714966, 55557.90022659302, 54226.273584365845, 58319.49329376221, 58094.19338512421, 48671.78024327755, 55745.36675643921, 54911.966853141785, 60053.2668838501, 58862.62675857544, 58936.17363739014, 49848.5466132164, 54377.34677886963, 58547.51326370239, 60973.76010131836, 51385.280009269714, 58959.35354614258, 56839.67990112305, 53819.72657394409, 56355.40007019043, 58229.020223617554, 59483.339904785156, 58320.32025909424, 58786.84706115723], "episode_lengths": [137, 137, 135, 136, 137, 136, 136, 136, 137, 136, 135, 135, 136, 135, 135, 135, 136, 135, 136, 136, 136, 135, 136, 135, 137, 136, 137, 136, 135, 136, 135, 136, 136, 136, 137, 136, 137, 137, 136, 137, 137, 136, 136, 136, 136, 135, 135, 137, 135, 136, 134, 136, 136, 137, 135, 135, 135, 136, 137, 134, 135, 136, 137, 136, 136, 135, 135, 136, 137, 135, 136, 136, 135, 135, 136, 136, 136, 136], "policy_agent_0_reward": [56474.43356895447, 59746.04665374756, 55903.16677856445, 58468.06008148193, 58450.48014640808, 58081.25996398926, 57708.740121245384, 56751.28664779663, 58000.106855392456, 56869.33353805542, 56392.36019897461, 52040.86682701111, 50485.88004338741, 53314.213497161865, 46542.36008787155, 54873.71348428726, 57195.05372619629, 56120.9467754364, 57930.51348114014, 56663.85367393494, 58328.55334472656, 53436.19329357147, 56478.080139160156, 50421.706823349, 58041.55362319946, 59348.573501586914, 59767.28015899658, 53450.27990913391, 57237.64012145996, 58453.04678964615, 50873.40025138855, 57322.893421173096, 58420.573711395264, 57789.53985595703, 55958.72690296173, 55935.00027179718, 59878.31346130371, 59400.886878967285, 57964.546875, 58728.20681762695, 60551.77340698242, 59613.4801940918, 58461.11366271973, 57918.413414001465, 58013.42672729492, 50720.34020650387, 50642.94684559107, 58609.0802154541, 54352.213509082794, 59183.86666870117, 53759.67360687256, 54870.453437805176, 57434.83382034302, 59173.31336975098, 55230.293504714966, 55557.90022659302, 54226.273584365845, 58319.49329376221, 58094.19338512421, 48671.78024327755, 55745.36675643921, 54911.966853141785, 60053.2668838501, 58862.62675857544, 58936.17363739014, 49848.5466132164, 54377.34677886963, 58547.51326370239, 60973.76010131836, 51385.280009269714, 58959.35354614258, 56839.67990112305, 53819.72657394409, 56355.40007019043, 58229.020223617554, 59483.339904785156, 58320.32025909424, 58786.84706115723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.991867061909605, "mean_inference_ms": 6.64816593435861, "mean_action_processing_ms": 0.19736678235626545, "mean_env_wait_ms": 227.9370206055152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04209127181615585, "StateBufferConnector_ms": 0.006084564404609876, "ViewRequirementAgentConnector_ms": 0.21137182529156023}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000, "num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.95987360799762, "num_env_steps_trained_throughput_per_sec": 211.95987360799762, "timesteps_total": 988000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 988000, "timers": {"training_iteration_time_ms": 14601.241, "sample_time_ms": 11817.718, "learn_time_ms": 2650.568, "learn_throughput": 1509.11, "synch_weights_time_ms": 132.328}, "counters": {"num_env_steps_sampled": 988000, "num_env_steps_trained": 988000, "num_agent_steps_sampled": 988000, "num_agent_steps_trained": 988000}, "done": false, "episodes_total": 7253, "training_iteration": 247, "trial_id": "32397_00000", "date": "2025-03-21_09-36-46", "timestamp": 1742549806, "time_this_iter_s": 18.93112802505493, "time_total_s": 3567.4630184173584, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91031c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3567.4630184173584, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 98.76363636363637, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.980969429016113, "policy_loss": -0.011784972622990608, "vf_loss": 9.99267578125, "vf_explained_var": -3.0423203956075895e-09, "kl": 0.012535286135971546, "entropy": 0.36041685938835144, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "sampler_results": {"episode_reward_max": 58492.69359588623, "episode_reward_min": 51800.16692352295, "episode_reward_mean": 54132.06688181559, "episode_len_mean": 135.66666666666666, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 51800.16692352295}, "policy_reward_max": {"agent_0": 58492.69359588623}, "policy_reward_mean": {"agent_0": 54132.06688181559}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52103.3401260376, 51800.16692352295, 58492.69359588623], "episode_lengths": [135, 135, 137], "policy_agent_0_reward": [52103.3401260376, 51800.16692352295, 58492.69359588623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.918830063745514, "mean_inference_ms": 6.236448047166442, "mean_action_processing_ms": 0.20082733388880172, "mean_env_wait_ms": 220.9716130021487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061194101969401045, "ViewRequirementAgentConnector_ms": 0.16318957010904947}}, "episode_reward_max": 58492.69359588623, "episode_reward_min": 51800.16692352295, "episode_reward_mean": 54132.06688181559, "episode_len_mean": 135.66666666666666, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 51800.16692352295}, "policy_reward_max": {"agent_0": 58492.69359588623}, "policy_reward_mean": {"agent_0": 54132.06688181559}, "hist_stats": {"episode_reward": [52103.3401260376, 51800.16692352295, 58492.69359588623], "episode_lengths": [135, 135, 137], "policy_agent_0_reward": [52103.3401260376, 51800.16692352295, 58492.69359588623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.918830063745514, "mean_inference_ms": 6.236448047166442, "mean_action_processing_ms": 0.20082733388880172, "mean_env_wait_ms": 220.9716130021487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03838539123535156, "StateBufferConnector_ms": 0.0061194101969401045, "ViewRequirementAgentConnector_ms": 0.16318957010904947}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8952944065161, "num_env_steps_trained_throughput_per_sec": 306.8952944065161, "timesteps_total": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 14235.866, "sample_time_ms": 11444.414, "learn_time_ms": 2665.923, "learn_throughput": 1500.418, "synch_weights_time_ms": 124.866}, "counters": {"num_env_steps_sampled": 992000, "num_env_steps_trained": 992000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "episodes_total": 7256, "training_iteration": 248, "trial_id": "32397_00000", "date": "2025-03-21_09-36-59", "timestamp": 1742549819, "time_this_iter_s": 13.082811117172241, "time_total_s": 3580.5458295345306, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3580.5458295345306, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 99.37368421052632, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982806205749512, "policy_loss": -0.017277976498007774, "vf_loss": 10.0, "vf_explained_var": -7.978329819025021e-08, "kl": 0.013594628311693668, "entropy": 0.34442099928855896, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 58492.69359588623, "episode_reward_min": 58492.69359588623, "episode_reward_mean": 58492.69359588623, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58492.69359588623}, "policy_reward_max": {"agent_0": 58492.69359588623}, "policy_reward_mean": {"agent_0": 58492.69359588623}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58492.69359588623], "episode_lengths": [137], "policy_agent_0_reward": [58492.69359588623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.79482550437522, "mean_inference_ms": 6.193311081911342, "mean_action_processing_ms": 0.1944892932237032, "mean_env_wait_ms": 223.93115791665684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04420280456542969, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.17812252044677734}}, "episode_reward_max": 58492.69359588623, "episode_reward_min": 58492.69359588623, "episode_reward_mean": 58492.69359588623, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58492.69359588623}, "policy_reward_max": {"agent_0": 58492.69359588623}, "policy_reward_mean": {"agent_0": 58492.69359588623}, "hist_stats": {"episode_reward": [58492.69359588623], "episode_lengths": [137], "policy_agent_0_reward": [58492.69359588623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 20.79482550437522, "mean_inference_ms": 6.193311081911342, "mean_action_processing_ms": 0.1944892932237032, "mean_env_wait_ms": 223.93115791665684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04420280456542969, "StateBufferConnector_ms": 0.0063419342041015625, "ViewRequirementAgentConnector_ms": 0.17812252044677734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.69308891543443, "num_env_steps_trained_throughput_per_sec": 300.69308891543443, "timesteps_total": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 14029.594, "sample_time_ms": 11243.539, "learn_time_ms": 2656.671, "learn_throughput": 1505.644, "synch_weights_time_ms": 128.716}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 7256, "training_iteration": 249, "trial_id": "32397_00000", "date": "2025-03-21_09-37-12", "timestamp": 1742549832, "time_this_iter_s": 13.350327968597412, "time_total_s": 3593.896157503128, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f91e2440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3593.896157503128, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 99.55263157894736, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.969622611999512, "policy_loss": -0.013128075748682022, "vf_loss": 9.982666015625, "vf_explained_var": -3.967434025753391e-08, "kl": 0.013536658138036728, "entropy": 0.38441184163093567, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "sampler_results": {"episode_reward_max": 59738.22674560547, "episode_reward_min": 49393.7600479126, "episode_reward_mean": 55619.019115550174, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"agent_0": 49393.7600479126}, "policy_reward_max": {"agent_0": 59738.22674560547}, "policy_reward_mean": {"agent_0": 55619.019115550174}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59290.153327941895, 59464.200103759766, 54686.62672805786, 49393.7600479126, 59738.22674560547, 50187.63348841667, 56572.53336715698], "episode_lengths": [137, 136, 136, 134, 137, 136, 136], "policy_agent_0_reward": [59290.153327941895, 59464.200103759766, 54686.62672805786, 49393.7600479126, 59738.22674560547, 50187.63348841667, 56572.53336715698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.751298187958497, "mean_inference_ms": 6.426147267195532, "mean_action_processing_ms": 0.19389258660946104, "mean_env_wait_ms": 233.7242701118027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036222594124930244, "StateBufferConnector_ms": 0.0056062425885881695, "ViewRequirementAgentConnector_ms": 0.15517984117780412}}, "episode_reward_max": 59738.22674560547, "episode_reward_min": 49393.7600479126, "episode_reward_mean": 55619.019115550174, "episode_len_mean": 136.0, "episodes_this_iter": 7, "policy_reward_min": {"agent_0": 49393.7600479126}, "policy_reward_max": {"agent_0": 59738.22674560547}, "policy_reward_mean": {"agent_0": 55619.019115550174}, "hist_stats": {"episode_reward": [59290.153327941895, 59464.200103759766, 54686.62672805786, 49393.7600479126, 59738.22674560547, 50187.63348841667, 56572.53336715698], "episode_lengths": [137, 136, 136, 134, 137, 136, 136], "policy_agent_0_reward": [59290.153327941895, 59464.200103759766, 54686.62672805786, 49393.7600479126, 59738.22674560547, 50187.63348841667, 56572.53336715698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 24.751298187958497, "mean_inference_ms": 6.426147267195532, "mean_action_processing_ms": 0.19389258660946104, "mean_env_wait_ms": 233.7242701118027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036222594124930244, "StateBufferConnector_ms": 0.0056062425885881695, "ViewRequirementAgentConnector_ms": 0.15517984117780412}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.52429254920247, "num_env_steps_trained_throughput_per_sec": 323.52429254920247, "timesteps_total": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 13935.956, "sample_time_ms": 11228.684, "learn_time_ms": 2584.126, "learn_throughput": 1547.912, "synch_weights_time_ms": 122.48}, "counters": {"num_env_steps_sampled": 1000000, "num_env_steps_trained": 1000000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "episodes_total": 7263, "training_iteration": 250, "trial_id": "32397_00000", "date": "2025-03-21_09-37-25", "timestamp": 1742549845, "time_this_iter_s": 12.403316736221313, "time_total_s": 3606.2994742393494, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d37250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3606.2994742393494, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 98.81764705882354, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.3119266055045875, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.710108757019043, "policy_loss": -0.014812312088906765, "vf_loss": 9.724853515625, "vf_explained_var": 9.058664574013164e-08, "kl": 0.010749607346951962, "entropy": 0.35953202843666077, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "sampler_results": {"episode_reward_max": 62181.19348144531, "episode_reward_min": 44139.38667845726, "episode_reward_mean": 55597.496552837554, "episode_len_mean": 135.76146788990826, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {"agent_0": 44139.38667845726}, "policy_reward_max": {"agent_0": 62181.19348144531}, "policy_reward_mean": {"agent_0": 55597.496552837554}, "custom_metrics": {"num_batches_mean": 5.3119266055045875, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55527.433480262756, 58012.99346923828, 51952.2400932312, 56532.63986206055, 49955.953453063965, 54670.927185058594, 49262.33353817463, 53281.960079193115, 62181.19348144531, 54291.20695114136, 53384.060024261475, 58196.91354370117, 54272.36003494263, 57326.20684051514, 59528.17367553711, 49789.62009835243, 58263.30665588379, 55951.27330970764, 55165.16032218933, 55475.646911621094, 51085.32014083862, 58574.04006958008, 53579.20687794685, 50573.033250808716, 59371.10037994385, 60377.41369628906, 56821.06019592285, 56075.14034843445, 58726.566942214966, 57529.006816864014, 54394.46679210663, 55392.593605041504, 59074.04019165039, 57472.633560180664, 55118.740268707275, 60170.18063735962, 59340.273569107056, 55162.440143585205, 55535.513370513916, 54551.153663635254, 56261.080070495605, 53484.79334259033, 51655.27343514562, 55707.04671669006, 53528.859832286835, 53031.9870300293, 49947.906785964966, 57423.32028198242, 54186.73364639282, 54993.213413238525, 54366.24002838135, 56256.947092056274, 57794.593170166016, 56142.47364234924, 57754.07339477539, 56180.87366104126, 55980.79362487793, 59121.58010864258, 57163.86674499512, 57082.7268447876, 48668.0270665884, 54139.8934841156, 52274.49344587326, 48361.91992929578, 55297.54012489319, 57649.96649169922, 57914.320251464844, 56450.31373023987, 59589.15328979492, 58479.180084228516, 60661.0133972168, 47411.66682434082, 57140.960401535034, 55481.66017436981, 56500.43353652954, 44139.38667845726, 56895.22006607056, 60474.16667175293, 59643.80694580078, 59262.34686279297, 49513.77337217331, 56736.03363800049, 56228.79337501526, 57514.88668823242, 56448.70011520386, 57021.58026123047, 53794.56005477905, 57425.45370864868, 50628.69347000122, 55553.95351409912, 55480.44680786133, 62139.94692993164, 51245.06686210632, 54204.75341796875, 56107.31335258484, 61254.33369445801, 56844.73350524902, 55225.76675701141, 59013.720153808594, 58191.04685974121, 55468.62671661377, 51477.41344165802, 55580.72025489807, 60475.12020111084, 54016.60684299469, 52153.46019744873, 50742.52675127983, 54658.45331764221, 58535.26014328003], "episode_lengths": [136, 137, 134, 135, 135, 134, 134, 135, 138, 135, 134, 136, 135, 136, 137, 135, 137, 136, 135, 136, 135, 136, 135, 135, 136, 137, 136, 136, 137, 136, 135, 136, 137, 136, 137, 137, 137, 135, 135, 137, 135, 136, 134, 136, 134, 135, 137, 135, 135, 134, 135, 137, 136, 136, 136, 135, 134, 136, 135, 136, 135, 136, 135, 134, 136, 136, 136, 136, 136, 136, 138, 135, 136, 136, 137, 135, 136, 137, 137, 136, 136, 136, 136, 136, 135, 136, 135, 137, 137, 135, 136, 138, 134, 136, 136, 138, 136, 136, 136, 136, 136, 134, 136, 137, 136, 135, 135, 135, 136], "policy_agent_0_reward": [55527.433480262756, 58012.99346923828, 51952.2400932312, 56532.63986206055, 49955.953453063965, 54670.927185058594, 49262.33353817463, 53281.960079193115, 62181.19348144531, 54291.20695114136, 53384.060024261475, 58196.91354370117, 54272.36003494263, 57326.20684051514, 59528.17367553711, 49789.62009835243, 58263.30665588379, 55951.27330970764, 55165.16032218933, 55475.646911621094, 51085.32014083862, 58574.04006958008, 53579.20687794685, 50573.033250808716, 59371.10037994385, 60377.41369628906, 56821.06019592285, 56075.14034843445, 58726.566942214966, 57529.006816864014, 54394.46679210663, 55392.593605041504, 59074.04019165039, 57472.633560180664, 55118.740268707275, 60170.18063735962, 59340.273569107056, 55162.440143585205, 55535.513370513916, 54551.153663635254, 56261.080070495605, 53484.79334259033, 51655.27343514562, 55707.04671669006, 53528.859832286835, 53031.9870300293, 49947.906785964966, 57423.32028198242, 54186.73364639282, 54993.213413238525, 54366.24002838135, 56256.947092056274, 57794.593170166016, 56142.47364234924, 57754.07339477539, 56180.87366104126, 55980.79362487793, 59121.58010864258, 57163.86674499512, 57082.7268447876, 48668.0270665884, 54139.8934841156, 52274.49344587326, 48361.91992929578, 55297.54012489319, 57649.96649169922, 57914.320251464844, 56450.31373023987, 59589.15328979492, 58479.180084228516, 60661.0133972168, 47411.66682434082, 57140.960401535034, 55481.66017436981, 56500.43353652954, 44139.38667845726, 56895.22006607056, 60474.16667175293, 59643.80694580078, 59262.34686279297, 49513.77337217331, 56736.03363800049, 56228.79337501526, 57514.88668823242, 56448.70011520386, 57021.58026123047, 53794.56005477905, 57425.45370864868, 50628.69347000122, 55553.95351409912, 55480.44680786133, 62139.94692993164, 51245.06686210632, 54204.75341796875, 56107.31335258484, 61254.33369445801, 56844.73350524902, 55225.76675701141, 59013.720153808594, 58191.04685974121, 55468.62671661377, 51477.41344165802, 55580.72025489807, 60475.12020111084, 54016.60684299469, 52153.46019744873, 50742.52675127983, 54658.45331764221, 58535.26014328003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.1035615483234, "mean_inference_ms": 6.6742195571714955, "mean_action_processing_ms": 0.19669564301102987, "mean_env_wait_ms": 230.02427010294977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03675845784878512, "StateBufferConnector_ms": 0.0057992585208437855, "ViewRequirementAgentConnector_ms": 0.1696945330418578}}, "episode_reward_max": 62181.19348144531, "episode_reward_min": 44139.38667845726, "episode_reward_mean": 55597.496552837554, "episode_len_mean": 135.76146788990826, "episodes_this_iter": 109, "policy_reward_min": {"agent_0": 44139.38667845726}, "policy_reward_max": {"agent_0": 62181.19348144531}, "policy_reward_mean": {"agent_0": 55597.496552837554}, "hist_stats": {"episode_reward": [55527.433480262756, 58012.99346923828, 51952.2400932312, 56532.63986206055, 49955.953453063965, 54670.927185058594, 49262.33353817463, 53281.960079193115, 62181.19348144531, 54291.20695114136, 53384.060024261475, 58196.91354370117, 54272.36003494263, 57326.20684051514, 59528.17367553711, 49789.62009835243, 58263.30665588379, 55951.27330970764, 55165.16032218933, 55475.646911621094, 51085.32014083862, 58574.04006958008, 53579.20687794685, 50573.033250808716, 59371.10037994385, 60377.41369628906, 56821.06019592285, 56075.14034843445, 58726.566942214966, 57529.006816864014, 54394.46679210663, 55392.593605041504, 59074.04019165039, 57472.633560180664, 55118.740268707275, 60170.18063735962, 59340.273569107056, 55162.440143585205, 55535.513370513916, 54551.153663635254, 56261.080070495605, 53484.79334259033, 51655.27343514562, 55707.04671669006, 53528.859832286835, 53031.9870300293, 49947.906785964966, 57423.32028198242, 54186.73364639282, 54993.213413238525, 54366.24002838135, 56256.947092056274, 57794.593170166016, 56142.47364234924, 57754.07339477539, 56180.87366104126, 55980.79362487793, 59121.58010864258, 57163.86674499512, 57082.7268447876, 48668.0270665884, 54139.8934841156, 52274.49344587326, 48361.91992929578, 55297.54012489319, 57649.96649169922, 57914.320251464844, 56450.31373023987, 59589.15328979492, 58479.180084228516, 60661.0133972168, 47411.66682434082, 57140.960401535034, 55481.66017436981, 56500.43353652954, 44139.38667845726, 56895.22006607056, 60474.16667175293, 59643.80694580078, 59262.34686279297, 49513.77337217331, 56736.03363800049, 56228.79337501526, 57514.88668823242, 56448.70011520386, 57021.58026123047, 53794.56005477905, 57425.45370864868, 50628.69347000122, 55553.95351409912, 55480.44680786133, 62139.94692993164, 51245.06686210632, 54204.75341796875, 56107.31335258484, 61254.33369445801, 56844.73350524902, 55225.76675701141, 59013.720153808594, 58191.04685974121, 55468.62671661377, 51477.41344165802, 55580.72025489807, 60475.12020111084, 54016.60684299469, 52153.46019744873, 50742.52675127983, 54658.45331764221, 58535.26014328003], "episode_lengths": [136, 137, 134, 135, 135, 134, 134, 135, 138, 135, 134, 136, 135, 136, 137, 135, 137, 136, 135, 136, 135, 136, 135, 135, 136, 137, 136, 136, 137, 136, 135, 136, 137, 136, 137, 137, 137, 135, 135, 137, 135, 136, 134, 136, 134, 135, 137, 135, 135, 134, 135, 137, 136, 136, 136, 135, 134, 136, 135, 136, 135, 136, 135, 134, 136, 136, 136, 136, 136, 136, 138, 135, 136, 136, 137, 135, 136, 137, 137, 136, 136, 136, 136, 136, 135, 136, 135, 137, 137, 135, 136, 138, 134, 136, 136, 138, 136, 136, 136, 136, 136, 134, 136, 137, 136, 135, 135, 135, 136], "policy_agent_0_reward": [55527.433480262756, 58012.99346923828, 51952.2400932312, 56532.63986206055, 49955.953453063965, 54670.927185058594, 49262.33353817463, 53281.960079193115, 62181.19348144531, 54291.20695114136, 53384.060024261475, 58196.91354370117, 54272.36003494263, 57326.20684051514, 59528.17367553711, 49789.62009835243, 58263.30665588379, 55951.27330970764, 55165.16032218933, 55475.646911621094, 51085.32014083862, 58574.04006958008, 53579.20687794685, 50573.033250808716, 59371.10037994385, 60377.41369628906, 56821.06019592285, 56075.14034843445, 58726.566942214966, 57529.006816864014, 54394.46679210663, 55392.593605041504, 59074.04019165039, 57472.633560180664, 55118.740268707275, 60170.18063735962, 59340.273569107056, 55162.440143585205, 55535.513370513916, 54551.153663635254, 56261.080070495605, 53484.79334259033, 51655.27343514562, 55707.04671669006, 53528.859832286835, 53031.9870300293, 49947.906785964966, 57423.32028198242, 54186.73364639282, 54993.213413238525, 54366.24002838135, 56256.947092056274, 57794.593170166016, 56142.47364234924, 57754.07339477539, 56180.87366104126, 55980.79362487793, 59121.58010864258, 57163.86674499512, 57082.7268447876, 48668.0270665884, 54139.8934841156, 52274.49344587326, 48361.91992929578, 55297.54012489319, 57649.96649169922, 57914.320251464844, 56450.31373023987, 59589.15328979492, 58479.180084228516, 60661.0133972168, 47411.66682434082, 57140.960401535034, 55481.66017436981, 56500.43353652954, 44139.38667845726, 56895.22006607056, 60474.16667175293, 59643.80694580078, 59262.34686279297, 49513.77337217331, 56736.03363800049, 56228.79337501526, 57514.88668823242, 56448.70011520386, 57021.58026123047, 53794.56005477905, 57425.45370864868, 50628.69347000122, 55553.95351409912, 55480.44680786133, 62139.94692993164, 51245.06686210632, 54204.75341796875, 56107.31335258484, 61254.33369445801, 56844.73350524902, 55225.76675701141, 59013.720153808594, 58191.04685974121, 55468.62671661377, 51477.41344165802, 55580.72025489807, 60475.12020111084, 54016.60684299469, 52153.46019744873, 50742.52675127983, 54658.45331764221, 58535.26014328003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.1035615483234, "mean_inference_ms": 6.6742195571714955, "mean_action_processing_ms": 0.19669564301102987, "mean_env_wait_ms": 230.02427010294977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03675845784878512, "StateBufferConnector_ms": 0.0057992585208437855, "ViewRequirementAgentConnector_ms": 0.1696945330418578}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000, "num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.2609533775126, "num_env_steps_trained_throughput_per_sec": 231.2609533775126, "timesteps_total": 1004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1004000, "timers": {"training_iteration_time_ms": 14392.434, "sample_time_ms": 11704.943, "learn_time_ms": 2560.005, "learn_throughput": 1562.497, "synch_weights_time_ms": 126.818}, "counters": {"num_env_steps_sampled": 1004000, "num_env_steps_trained": 1004000, "num_agent_steps_sampled": 1004000, "num_agent_steps_trained": 1004000}, "done": false, "episodes_total": 7372, "training_iteration": 251, "trial_id": "32397_00000", "date": "2025-03-21_09-37-42", "timestamp": 1742549862, "time_this_iter_s": 17.35384249687195, "time_total_s": 3623.6533167362213, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d37880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3623.6533167362213, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 97.16250000000001, "ram_util_percent": 13.575000000000001}}
{"custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.962915420532227, "policy_loss": -0.01521208044141531, "vf_loss": 9.97802734375, "vf_explained_var": 8.878608959150824e-09, "kl": 0.015870453789830208, "entropy": 0.3731153607368469, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 60304.600158691406, "episode_reward_min": 51417.346698760986, "episode_reward_mean": 56893.46773529053, "episode_len_mean": 136.125, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 51417.346698760986}, "policy_reward_max": {"agent_0": 60304.600158691406}, "policy_reward_mean": {"agent_0": 56893.46773529053}, "custom_metrics": {"num_batches_mean": 5.5, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [51417.346698760986, 57574.51346588135, 55095.10694694519, 60304.600158691406, 58125.34713745117, 58166.70043754578, 59451.66702270508, 55012.46001434326], "episode_lengths": [135, 136, 135, 137, 136, 137, 137, 136], "policy_agent_0_reward": [51417.346698760986, 57574.51346588135, 55095.10694694519, 60304.600158691406, 58125.34713745117, 58166.70043754578, 59451.66702270508, 55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.703963384843867, "mean_inference_ms": 6.338330652903834, "mean_action_processing_ms": 0.19995145991514462, "mean_env_wait_ms": 221.70295443502744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036779046058654785, "StateBufferConnector_ms": 0.005868077278137207, "ViewRequirementAgentConnector_ms": 0.15916228294372559}}, "episode_reward_max": 60304.600158691406, "episode_reward_min": 51417.346698760986, "episode_reward_mean": 56893.46773529053, "episode_len_mean": 136.125, "episodes_this_iter": 8, "policy_reward_min": {"agent_0": 51417.346698760986}, "policy_reward_max": {"agent_0": 60304.600158691406}, "policy_reward_mean": {"agent_0": 56893.46773529053}, "hist_stats": {"episode_reward": [51417.346698760986, 57574.51346588135, 55095.10694694519, 60304.600158691406, 58125.34713745117, 58166.70043754578, 59451.66702270508, 55012.46001434326], "episode_lengths": [135, 136, 135, 137, 136, 137, 137, 136], "policy_agent_0_reward": [51417.346698760986, 57574.51346588135, 55095.10694694519, 60304.600158691406, 58125.34713745117, 58166.70043754578, 59451.66702270508, 55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.703963384843867, "mean_inference_ms": 6.338330652903834, "mean_action_processing_ms": 0.19995145991514462, "mean_env_wait_ms": 221.70295443502744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036779046058654785, "StateBufferConnector_ms": 0.005868077278137207, "ViewRequirementAgentConnector_ms": 0.15916228294372559}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.65089897105236, "num_env_steps_trained_throughput_per_sec": 307.65089897105236, "timesteps_total": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 14173.773, "sample_time_ms": 11420.835, "learn_time_ms": 2624.331, "learn_throughput": 1524.198, "synch_weights_time_ms": 127.919}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 7380, "training_iteration": 252, "trial_id": "32397_00000", "date": "2025-03-21_09-37-55", "timestamp": 1742549875, "time_this_iter_s": 13.052258253097534, "time_total_s": 3636.705574989319, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d379a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3636.705574989319, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 99.22105263157896, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.980683326721191, "policy_loss": -0.01942908577620983, "vf_loss": 10.0, "vf_explained_var": -3.8618843234417e-08, "kl": 0.01795073412358761, "entropy": 0.39053550362586975, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "sampler_results": {"episode_reward_max": 55012.46001434326, "episode_reward_min": 55012.46001434326, "episode_reward_mean": 55012.46001434326, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55012.46001434326}, "policy_reward_max": {"agent_0": 55012.46001434326}, "policy_reward_mean": {"agent_0": 55012.46001434326}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55012.46001434326], "episode_lengths": [136], "policy_agent_0_reward": [55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.703182740811762, "mean_inference_ms": 6.056549716227987, "mean_action_processing_ms": 0.19695366949677912, "mean_env_wait_ms": 223.3271117793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1711130142211914}}, "episode_reward_max": 55012.46001434326, "episode_reward_min": 55012.46001434326, "episode_reward_mean": 55012.46001434326, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55012.46001434326}, "policy_reward_max": {"agent_0": 55012.46001434326}, "policy_reward_mean": {"agent_0": 55012.46001434326}, "hist_stats": {"episode_reward": [55012.46001434326], "episode_lengths": [136], "policy_agent_0_reward": [55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.703182740811762, "mean_inference_ms": 6.056549716227987, "mean_action_processing_ms": 0.19695366949677912, "mean_env_wait_ms": 223.3271117793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1711130142211914}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000, "num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.98759403045733, "num_env_steps_trained_throughput_per_sec": 302.98759403045733, "timesteps_total": 1012000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1012000, "timers": {"training_iteration_time_ms": 13989.299, "sample_time_ms": 11198.272, "learn_time_ms": 2662.929, "learn_throughput": 1502.106, "synch_weights_time_ms": 127.416}, "counters": {"num_env_steps_sampled": 1012000, "num_env_steps_trained": 1012000, "num_agent_steps_sampled": 1012000, "num_agent_steps_trained": 1012000}, "done": false, "episodes_total": 7380, "training_iteration": 253, "trial_id": "32397_00000", "date": "2025-03-21_09-38-09", "timestamp": 1742549889, "time_this_iter_s": 13.249832391738892, "time_total_s": 3649.9554073810577, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3649.9554073810577, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 99.7388888888889, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985336303710938, "policy_loss": -0.01475189533084631, "vf_loss": 10.0, "vf_explained_var": -8.003165419268043e-08, "kl": 0.014086877927184105, "entropy": 0.413055419921875, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "sampler_results": {"episode_reward_max": 55012.46001434326, "episode_reward_min": 55012.46001434326, "episode_reward_mean": 55012.46001434326, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55012.46001434326}, "policy_reward_max": {"agent_0": 55012.46001434326}, "policy_reward_mean": {"agent_0": 55012.46001434326}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55012.46001434326], "episode_lengths": [136], "policy_agent_0_reward": [55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.703182740811762, "mean_inference_ms": 6.056549716227987, "mean_action_processing_ms": 0.19695366949677912, "mean_env_wait_ms": 223.3271117793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1711130142211914}}, "episode_reward_max": 55012.46001434326, "episode_reward_min": 55012.46001434326, "episode_reward_mean": 55012.46001434326, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 55012.46001434326}, "policy_reward_max": {"agent_0": 55012.46001434326}, "policy_reward_mean": {"agent_0": 55012.46001434326}, "hist_stats": {"episode_reward": [55012.46001434326], "episode_lengths": [136], "policy_agent_0_reward": [55012.46001434326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.703182740811762, "mean_inference_ms": 6.056549716227987, "mean_action_processing_ms": 0.19695366949677912, "mean_env_wait_ms": 223.3271117793463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040221214294433594, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.1711130142211914}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000, "num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65622030123944, "num_env_steps_trained_throughput_per_sec": 300.65622030123944, "timesteps_total": 1016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1016000, "timers": {"training_iteration_time_ms": 14085.854, "sample_time_ms": 11288.263, "learn_time_ms": 2670.357, "learn_throughput": 1497.927, "synch_weights_time_ms": 126.552}, "counters": {"num_env_steps_sampled": 1016000, "num_env_steps_trained": 1016000, "num_agent_steps_sampled": 1016000, "num_agent_steps_trained": 1016000}, "done": false, "episodes_total": 7380, "training_iteration": 254, "trial_id": "32397_00000", "date": "2025-03-21_09-38-22", "timestamp": 1742549902, "time_this_iter_s": 13.348706722259521, "time_total_s": 3663.3041141033173, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3663.3041141033173, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 99.6421052631579, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.046296296296297, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.713298797607422, "policy_loss": -0.017289690673351288, "vf_loss": 9.73046875, "vf_explained_var": -1.27715367170822e-07, "kl": 0.018955733627080917, "entropy": 0.3525114059448242, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 62464.113677978516, "episode_reward_min": 41446.820226073265, "episode_reward_mean": 55238.78274190481, "episode_len_mean": 135.7037037037037, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {"agent_0": 41446.820226073265}, "policy_reward_max": {"agent_0": 62464.113677978516}, "policy_reward_mean": {"agent_0": 55238.78274190481}, "custom_metrics": {"num_batches_mean": 5.046296296296297, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50976.266839027405, 52299.34680366516, 55976.91353607178, 50374.28663921356, 49214.21357536316, 55333.993520736694, 52500.147136211395, 51696.800287127495, 58443.37358856201, 55906.06678771973, 57325.66014099121, 61826.31335449219, 51802.93341064453, 57442.760025024414, 58147.4067401886, 53091.63355636597, 51350.2732963562, 56195.39333343506, 57928.12698364258, 52892.93352216482, 56370.64684867859, 48887.50023460388, 57835.95365905762, 58410.26036834717, 54291.146743774414, 54676.933601379395, 57820.6668548584, 51689.353370666504, 54766.37366485596, 52785.59336948395, 52090.62035751343, 57294.70703125, 47193.660091876984, 52251.646528959274, 49811.35357475281, 48919.15350341797, 41446.820226073265, 54556.74020195007, 52883.320013046265, 53862.13361001015, 60218.5202331543, 53686.473333358765, 52395.746810913086, 55181.81345367432, 60406.88009643555, 54699.12009429932, 57346.88689613342, 54698.82007598877, 56611.67352390289, 54466.253273010254, 57710.726959228516, 60955.38684082031, 56128.746643066406, 52923.120086193085, 54034.8868598938, 50909.66010642052, 60031.45365142822, 59434.526596069336, 49027.213384628296, 54853.74681186676, 58447.35366821289, 54458.820110321045, 59317.66687011719, 48895.5867511034, 59260.660095214844, 57903.52683258057, 55008.206892967224, 58389.91357421875, 57077.12000274658, 60949.86003112793, 57748.68018770218, 51684.5000705719, 56379.09323120117, 52516.34684276581, 58986.033599853516, 58055.65361785889, 56213.56678771973, 53650.300104141235, 56814.26668357849, 60886.13375854492, 56585.81999588013, 53988.053416252136, 48276.84003829956, 57035.706687927246, 54663.94017791748, 59502.360622406006, 58645.88009643555, 57918.9868144989, 53209.306743621826, 55275.52008628845, 52300.12014961243, 59032.147064208984, 56258.24018859863, 58490.22024536133, 56487.91342163086, 61338.62673950195, 50919.96679735184, 57797.35340881348, 59453.54016113281, 62464.113677978516, 48147.593477249146, 58297.56000518799, 57690.20660972595, 59361.36038208008, 55014.580085754395, 55854.459911346436, 50796.32678604126, 54047.41996002197], "episode_lengths": [135, 135, 135, 134, 135, 136, 135, 135, 136, 135, 136, 138, 134, 135, 137, 135, 135, 135, 136, 135, 136, 135, 137, 136, 135, 136, 136, 136, 136, 135, 135, 135, 134, 136, 135, 134, 133, 135, 136, 136, 137, 134, 136, 135, 137, 135, 136, 136, 136, 135, 136, 137, 135, 135, 135, 135, 138, 137, 135, 136, 137, 136, 137, 135, 136, 136, 135, 136, 136, 138, 136, 135, 136, 135, 137, 136, 136, 136, 136, 137, 136, 137, 133, 135, 135, 137, 137, 136, 136, 136, 136, 136, 137, 137, 136, 138, 134, 136, 136, 138, 134, 136, 136, 137, 135, 136, 135, 133], "policy_agent_0_reward": [50976.266839027405, 52299.34680366516, 55976.91353607178, 50374.28663921356, 49214.21357536316, 55333.993520736694, 52500.147136211395, 51696.800287127495, 58443.37358856201, 55906.06678771973, 57325.66014099121, 61826.31335449219, 51802.93341064453, 57442.760025024414, 58147.4067401886, 53091.63355636597, 51350.2732963562, 56195.39333343506, 57928.12698364258, 52892.93352216482, 56370.64684867859, 48887.50023460388, 57835.95365905762, 58410.26036834717, 54291.146743774414, 54676.933601379395, 57820.6668548584, 51689.353370666504, 54766.37366485596, 52785.59336948395, 52090.62035751343, 57294.70703125, 47193.660091876984, 52251.646528959274, 49811.35357475281, 48919.15350341797, 41446.820226073265, 54556.74020195007, 52883.320013046265, 53862.13361001015, 60218.5202331543, 53686.473333358765, 52395.746810913086, 55181.81345367432, 60406.88009643555, 54699.12009429932, 57346.88689613342, 54698.82007598877, 56611.67352390289, 54466.253273010254, 57710.726959228516, 60955.38684082031, 56128.746643066406, 52923.120086193085, 54034.8868598938, 50909.66010642052, 60031.45365142822, 59434.526596069336, 49027.213384628296, 54853.74681186676, 58447.35366821289, 54458.820110321045, 59317.66687011719, 48895.5867511034, 59260.660095214844, 57903.52683258057, 55008.206892967224, 58389.91357421875, 57077.12000274658, 60949.86003112793, 57748.68018770218, 51684.5000705719, 56379.09323120117, 52516.34684276581, 58986.033599853516, 58055.65361785889, 56213.56678771973, 53650.300104141235, 56814.26668357849, 60886.13375854492, 56585.81999588013, 53988.053416252136, 48276.84003829956, 57035.706687927246, 54663.94017791748, 59502.360622406006, 58645.88009643555, 57918.9868144989, 53209.306743621826, 55275.52008628845, 52300.12014961243, 59032.147064208984, 56258.24018859863, 58490.22024536133, 56487.91342163086, 61338.62673950195, 50919.96679735184, 57797.35340881348, 59453.54016113281, 62464.113677978516, 48147.593477249146, 58297.56000518799, 57690.20660972595, 59361.36038208008, 55014.580085754395, 55854.459911346436, 50796.32678604126, 54047.41996002197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.310823470121065, "mean_inference_ms": 6.6626363848623, "mean_action_processing_ms": 0.19620043295489198, "mean_env_wait_ms": 230.8110867610752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06026117889969437, "StateBufferConnector_ms": 0.0059787873868589044, "ViewRequirementAgentConnector_ms": 0.1919565377412019}}, "episode_reward_max": 62464.113677978516, "episode_reward_min": 41446.820226073265, "episode_reward_mean": 55238.78274190481, "episode_len_mean": 135.7037037037037, "episodes_this_iter": 108, "policy_reward_min": {"agent_0": 41446.820226073265}, "policy_reward_max": {"agent_0": 62464.113677978516}, "policy_reward_mean": {"agent_0": 55238.78274190481}, "hist_stats": {"episode_reward": [50976.266839027405, 52299.34680366516, 55976.91353607178, 50374.28663921356, 49214.21357536316, 55333.993520736694, 52500.147136211395, 51696.800287127495, 58443.37358856201, 55906.06678771973, 57325.66014099121, 61826.31335449219, 51802.93341064453, 57442.760025024414, 58147.4067401886, 53091.63355636597, 51350.2732963562, 56195.39333343506, 57928.12698364258, 52892.93352216482, 56370.64684867859, 48887.50023460388, 57835.95365905762, 58410.26036834717, 54291.146743774414, 54676.933601379395, 57820.6668548584, 51689.353370666504, 54766.37366485596, 52785.59336948395, 52090.62035751343, 57294.70703125, 47193.660091876984, 52251.646528959274, 49811.35357475281, 48919.15350341797, 41446.820226073265, 54556.74020195007, 52883.320013046265, 53862.13361001015, 60218.5202331543, 53686.473333358765, 52395.746810913086, 55181.81345367432, 60406.88009643555, 54699.12009429932, 57346.88689613342, 54698.82007598877, 56611.67352390289, 54466.253273010254, 57710.726959228516, 60955.38684082031, 56128.746643066406, 52923.120086193085, 54034.8868598938, 50909.66010642052, 60031.45365142822, 59434.526596069336, 49027.213384628296, 54853.74681186676, 58447.35366821289, 54458.820110321045, 59317.66687011719, 48895.5867511034, 59260.660095214844, 57903.52683258057, 55008.206892967224, 58389.91357421875, 57077.12000274658, 60949.86003112793, 57748.68018770218, 51684.5000705719, 56379.09323120117, 52516.34684276581, 58986.033599853516, 58055.65361785889, 56213.56678771973, 53650.300104141235, 56814.26668357849, 60886.13375854492, 56585.81999588013, 53988.053416252136, 48276.84003829956, 57035.706687927246, 54663.94017791748, 59502.360622406006, 58645.88009643555, 57918.9868144989, 53209.306743621826, 55275.52008628845, 52300.12014961243, 59032.147064208984, 56258.24018859863, 58490.22024536133, 56487.91342163086, 61338.62673950195, 50919.96679735184, 57797.35340881348, 59453.54016113281, 62464.113677978516, 48147.593477249146, 58297.56000518799, 57690.20660972595, 59361.36038208008, 55014.580085754395, 55854.459911346436, 50796.32678604126, 54047.41996002197], "episode_lengths": [135, 135, 135, 134, 135, 136, 135, 135, 136, 135, 136, 138, 134, 135, 137, 135, 135, 135, 136, 135, 136, 135, 137, 136, 135, 136, 136, 136, 136, 135, 135, 135, 134, 136, 135, 134, 133, 135, 136, 136, 137, 134, 136, 135, 137, 135, 136, 136, 136, 135, 136, 137, 135, 135, 135, 135, 138, 137, 135, 136, 137, 136, 137, 135, 136, 136, 135, 136, 136, 138, 136, 135, 136, 135, 137, 136, 136, 136, 136, 137, 136, 137, 133, 135, 135, 137, 137, 136, 136, 136, 136, 136, 137, 137, 136, 138, 134, 136, 136, 138, 134, 136, 136, 137, 135, 136, 135, 133], "policy_agent_0_reward": [50976.266839027405, 52299.34680366516, 55976.91353607178, 50374.28663921356, 49214.21357536316, 55333.993520736694, 52500.147136211395, 51696.800287127495, 58443.37358856201, 55906.06678771973, 57325.66014099121, 61826.31335449219, 51802.93341064453, 57442.760025024414, 58147.4067401886, 53091.63355636597, 51350.2732963562, 56195.39333343506, 57928.12698364258, 52892.93352216482, 56370.64684867859, 48887.50023460388, 57835.95365905762, 58410.26036834717, 54291.146743774414, 54676.933601379395, 57820.6668548584, 51689.353370666504, 54766.37366485596, 52785.59336948395, 52090.62035751343, 57294.70703125, 47193.660091876984, 52251.646528959274, 49811.35357475281, 48919.15350341797, 41446.820226073265, 54556.74020195007, 52883.320013046265, 53862.13361001015, 60218.5202331543, 53686.473333358765, 52395.746810913086, 55181.81345367432, 60406.88009643555, 54699.12009429932, 57346.88689613342, 54698.82007598877, 56611.67352390289, 54466.253273010254, 57710.726959228516, 60955.38684082031, 56128.746643066406, 52923.120086193085, 54034.8868598938, 50909.66010642052, 60031.45365142822, 59434.526596069336, 49027.213384628296, 54853.74681186676, 58447.35366821289, 54458.820110321045, 59317.66687011719, 48895.5867511034, 59260.660095214844, 57903.52683258057, 55008.206892967224, 58389.91357421875, 57077.12000274658, 60949.86003112793, 57748.68018770218, 51684.5000705719, 56379.09323120117, 52516.34684276581, 58986.033599853516, 58055.65361785889, 56213.56678771973, 53650.300104141235, 56814.26668357849, 60886.13375854492, 56585.81999588013, 53988.053416252136, 48276.84003829956, 57035.706687927246, 54663.94017791748, 59502.360622406006, 58645.88009643555, 57918.9868144989, 53209.306743621826, 55275.52008628845, 52300.12014961243, 59032.147064208984, 56258.24018859863, 58490.22024536133, 56487.91342163086, 61338.62673950195, 50919.96679735184, 57797.35340881348, 59453.54016113281, 62464.113677978516, 48147.593477249146, 58297.56000518799, 57690.20660972595, 59361.36038208008, 55014.580085754395, 55854.459911346436, 50796.32678604126, 54047.41996002197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.310823470121065, "mean_inference_ms": 6.6626363848623, "mean_action_processing_ms": 0.19620043295489198, "mean_env_wait_ms": 230.8110867610752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06026117889969437, "StateBufferConnector_ms": 0.0059787873868589044, "ViewRequirementAgentConnector_ms": 0.1919565377412019}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.81396904901175, "num_env_steps_trained_throughput_per_sec": 227.81396904901175, "timesteps_total": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 14535.235, "sample_time_ms": 11771.867, "learn_time_ms": 2633.108, "learn_throughput": 1519.117, "synch_weights_time_ms": 129.574}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 7488, "training_iteration": 255, "trial_id": "32397_00000", "date": "2025-03-21_09-38-40", "timestamp": 1742549920, "time_this_iter_s": 17.608072519302368, "time_total_s": 3680.9121866226196, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36c20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3680.9121866226196, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 96.12400000000001, "ram_util_percent": 13.584000000000001}}
{"custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.945276260375977, "policy_loss": -0.015021766535937786, "vf_loss": 9.960205078125, "vf_explained_var": 1.213823708212658e-07, "kl": 0.014872817322611809, "entropy": 0.35169702768325806, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "sampler_results": {"episode_reward_max": 59215.84004974365, "episode_reward_min": 47105.6934094429, "episode_reward_mean": 55188.50803634524, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 47105.6934094429}, "policy_reward_max": {"agent_0": 59215.84004974365}, "policy_reward_mean": {"agent_0": 55188.50803634524}, "custom_metrics": {"num_batches_mean": 5.25, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55777.486713409424, 53086.03336143494, 57376.51370239258, 56584.0465927124, 57512.106967926025, 53171.426763534546, 52807.16674041748, 52075.54681587219, 53772.460107803345, 58729.046783447266, 59215.84004974365, 57440.45346260071, 53037.14020347595, 47105.6934094429, 57087.18673324585, 58237.980174064636], "episode_lengths": [136, 135, 136, 135, 137, 135, 135, 135, 135, 136, 137, 136, 135, 134, 135, 136], "policy_agent_0_reward": [55777.486713409424, 53086.03336143494, 57376.51370239258, 56584.0465927124, 57512.106967926025, 53171.426763534546, 52807.16674041748, 52075.54681587219, 53772.460107803345, 58729.046783447266, 59215.84004974365, 57440.45346260071, 53037.14020347595, 47105.6934094429, 57087.18673324585, 58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.864312482015634, "mean_inference_ms": 6.468528270340485, "mean_action_processing_ms": 0.2002393879090728, "mean_env_wait_ms": 221.42344182349476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03814995288848877, "StateBufferConnector_ms": 0.0058144330978393555, "ViewRequirementAgentConnector_ms": 0.2724990248680115}}, "episode_reward_max": 59215.84004974365, "episode_reward_min": 47105.6934094429, "episode_reward_mean": 55188.50803634524, "episode_len_mean": 135.5, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 47105.6934094429}, "policy_reward_max": {"agent_0": 59215.84004974365}, "policy_reward_mean": {"agent_0": 55188.50803634524}, "hist_stats": {"episode_reward": [55777.486713409424, 53086.03336143494, 57376.51370239258, 56584.0465927124, 57512.106967926025, 53171.426763534546, 52807.16674041748, 52075.54681587219, 53772.460107803345, 58729.046783447266, 59215.84004974365, 57440.45346260071, 53037.14020347595, 47105.6934094429, 57087.18673324585, 58237.980174064636], "episode_lengths": [136, 135, 136, 135, 137, 135, 135, 135, 135, 136, 137, 136, 135, 134, 135, 136], "policy_agent_0_reward": [55777.486713409424, 53086.03336143494, 57376.51370239258, 56584.0465927124, 57512.106967926025, 53171.426763534546, 52807.16674041748, 52075.54681587219, 53772.460107803345, 58729.046783447266, 59215.84004974365, 57440.45346260071, 53037.14020347595, 47105.6934094429, 57087.18673324585, 58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.864312482015634, "mean_inference_ms": 6.468528270340485, "mean_action_processing_ms": 0.2002393879090728, "mean_env_wait_ms": 221.42344182349476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03814995288848877, "StateBufferConnector_ms": 0.0058144330978393555, "ViewRequirementAgentConnector_ms": 0.2724990248680115}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.6831633159819, "num_env_steps_trained_throughput_per_sec": 285.6831633159819, "timesteps_total": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 14593.534, "sample_time_ms": 11776.421, "learn_time_ms": 2676.364, "learn_throughput": 1494.565, "synch_weights_time_ms": 140.059}, "counters": {"num_env_steps_sampled": 1024000, "num_env_steps_trained": 1024000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "episodes_total": 7504, "training_iteration": 256, "trial_id": "32397_00000", "date": "2025-03-21_09-38-54", "timestamp": 1742549934, "time_this_iter_s": 14.059468269348145, "time_total_s": 3694.971654891968, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d37a30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3694.971654891968, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 99.44210526315788, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98735523223877, "policy_loss": -0.012724610976874828, "vf_loss": 10.0, "vf_explained_var": 5.06639494801675e-08, "kl": 0.012901665642857552, "entropy": 0.32624590396881104, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "sampler_results": {"episode_reward_max": 58237.980174064636, "episode_reward_min": 58237.980174064636, "episode_reward_mean": 58237.980174064636, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58237.980174064636}, "policy_reward_max": {"agent_0": 58237.980174064636}, "policy_reward_mean": {"agent_0": 58237.980174064636}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58237.980174064636], "episode_lengths": [136], "policy_agent_0_reward": [58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.641972502641725, "mean_inference_ms": 6.075898970862312, "mean_action_processing_ms": 0.19751456887471716, "mean_env_wait_ms": 223.25519652518454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039076805114746094, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.16438961029052734}}, "episode_reward_max": 58237.980174064636, "episode_reward_min": 58237.980174064636, "episode_reward_mean": 58237.980174064636, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58237.980174064636}, "policy_reward_max": {"agent_0": 58237.980174064636}, "policy_reward_mean": {"agent_0": 58237.980174064636}, "hist_stats": {"episode_reward": [58237.980174064636], "episode_lengths": [136], "policy_agent_0_reward": [58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.641972502641725, "mean_inference_ms": 6.075898970862312, "mean_action_processing_ms": 0.19751456887471716, "mean_env_wait_ms": 223.25519652518454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039076805114746094, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.16438961029052734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000, "num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4192730687534, "num_env_steps_trained_throughput_per_sec": 311.4192730687534, "timesteps_total": 1028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1028000, "timers": {"training_iteration_time_ms": 13990.825, "sample_time_ms": 11113.184, "learn_time_ms": 2725.763, "learn_throughput": 1467.479, "synch_weights_time_ms": 151.181}, "counters": {"num_env_steps_sampled": 1028000, "num_env_steps_trained": 1028000, "num_agent_steps_sampled": 1028000, "num_agent_steps_trained": 1028000}, "done": false, "episodes_total": 7504, "training_iteration": 257, "trial_id": "32397_00000", "date": "2025-03-21_09-39-07", "timestamp": 1742549947, "time_this_iter_s": 12.905235052108765, "time_total_s": 3707.8768899440765, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d368c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3707.8768899440765, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 99.63157894736844, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.979191780090332, "policy_loss": -0.0184754841029644, "vf_loss": 9.99755859375, "vf_explained_var": 1.1492520712863552e-07, "kl": 0.017496738582849503, "entropy": 0.36097317934036255, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 58237.980174064636, "episode_reward_min": 58237.980174064636, "episode_reward_mean": 58237.980174064636, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58237.980174064636}, "policy_reward_max": {"agent_0": 58237.980174064636}, "policy_reward_mean": {"agent_0": 58237.980174064636}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [58237.980174064636], "episode_lengths": [136], "policy_agent_0_reward": [58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.641972502641725, "mean_inference_ms": 6.075898970862312, "mean_action_processing_ms": 0.19751456887471716, "mean_env_wait_ms": 223.25519652518454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039076805114746094, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.16438961029052734}}, "episode_reward_max": 58237.980174064636, "episode_reward_min": 58237.980174064636, "episode_reward_mean": 58237.980174064636, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58237.980174064636}, "policy_reward_max": {"agent_0": 58237.980174064636}, "policy_reward_mean": {"agent_0": 58237.980174064636}, "hist_stats": {"episode_reward": [58237.980174064636], "episode_lengths": [136], "policy_agent_0_reward": [58237.980174064636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.641972502641725, "mean_inference_ms": 6.075898970862312, "mean_action_processing_ms": 0.19751456887471716, "mean_env_wait_ms": 223.25519652518454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039076805114746094, "StateBufferConnector_ms": 0.005793571472167969, "ViewRequirementAgentConnector_ms": 0.16438961029052734}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0919177326627, "num_env_steps_trained_throughput_per_sec": 302.0919177326627, "timesteps_total": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 14011.549, "sample_time_ms": 11070.878, "learn_time_ms": 2783.021, "learn_throughput": 1437.287, "synch_weights_time_ms": 156.978}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 7504, "training_iteration": 258, "trial_id": "32397_00000", "date": "2025-03-21_09-39-20", "timestamp": 1742549960, "time_this_iter_s": 13.289659023284912, "time_total_s": 3721.1665489673615, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d37a30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3721.1665489673615, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 99.56842105263158, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 4.999999873689376e-05, "total_loss": 9.755148887634277, "policy_loss": -0.0196473877876997, "vf_loss": 9.774666786193848, "vf_explained_var": -1.3676161643161322e-06, "kl": 0.02069181390106678, "entropy": 0.37657615542411804, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "sampler_results": {"episode_reward_max": 61507.55375671387, "episode_reward_min": 45838.67999172211, "episode_reward_mean": 55370.455442091385, "episode_len_mean": 135.76404494382024, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 45838.67999172211}, "policy_reward_max": {"agent_0": 61507.55375671387}, "policy_reward_mean": {"agent_0": 55370.455442091385}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47129.76006555557, 56772.5467376709, 57019.806848526, 48540.66673374176, 51194.09340047836, 57961.90673446655, 48388.25995063782, 58079.693504333496, 49497.39356422424, 57419.24658203125, 55310.420206069946, 57228.833755493164, 56569.573389053345, 55922.55354309082, 58023.67335510254, 56512.760135650635, 52366.72680854797, 51471.34001207352, 54210.23358228803, 57917.07370567322, 56334.1000957489, 52196.50039291382, 54286.47333431244, 57716.526611328125, 56298.45355987549, 53675.240082740784, 53108.2202835083, 60768.260162353516, 54312.36011886597, 52846.9469127655, 55165.28017234802, 58639.08693695068, 59207.860260009766, 56955.25326538086, 59657.82029724121, 45838.67999172211, 56245.359954833984, 59409.226905822754, 60368.37335205078, 54833.960399627686, 54084.40663146973, 55452.34697341919, 57035.9335899353, 58194.9334564209, 57977.93369293213, 53136.62672138214, 59084.43371963501, 57255.58026123047, 55680.160160303116, 58396.940185546875, 48418.44686317444, 58080.186920166016, 55917.62005805969, 56593.786975860596, 50431.15355491638, 60668.36038208008, 57168.806701660156, 56495.04035568237, 50373.04023838043, 57065.94666862488, 57464.16653728485, 47710.55341529846, 54452.386878967285, 57768.71348571777, 58739.62664413452, 50404.18013763428, 52517.95336723328, 56231.74005126953, 53002.03352737427, 57984.40013885498, 51570.76678276062, 56472.28035926819, 52361.25354576111, 59929.87365722656, 59410.0001373291, 57044.406871795654, 57616.34676361084, 56843.07378387451, 54077.06016731262, 52926.133355140686, 55898.566858291626, 48560.073526382446, 56252.58668231964, 59711.84683227539, 54506.02014923096, 56586.02038574219, 58704.43339538574, 61507.55375671387, 48804.25333595276], "episode_lengths": [134, 136, 136, 135, 134, 136, 134, 137, 134, 136, 135, 135, 136, 137, 136, 137, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 137, 135, 136, 135, 137, 136, 135, 136, 133, 136, 138, 137, 136, 135, 136, 136, 137, 136, 135, 137, 136, 137, 136, 135, 136, 136, 136, 135, 137, 135, 136, 136, 137, 136, 135, 135, 136, 136, 134, 136, 136, 136, 136, 135, 136, 135, 136, 137, 136, 136, 136, 137, 135, 136, 136, 136, 137, 135, 136, 136, 138, 133], "policy_agent_0_reward": [47129.76006555557, 56772.5467376709, 57019.806848526, 48540.66673374176, 51194.09340047836, 57961.90673446655, 48388.25995063782, 58079.693504333496, 49497.39356422424, 57419.24658203125, 55310.420206069946, 57228.833755493164, 56569.573389053345, 55922.55354309082, 58023.67335510254, 56512.760135650635, 52366.72680854797, 51471.34001207352, 54210.23358228803, 57917.07370567322, 56334.1000957489, 52196.50039291382, 54286.47333431244, 57716.526611328125, 56298.45355987549, 53675.240082740784, 53108.2202835083, 60768.260162353516, 54312.36011886597, 52846.9469127655, 55165.28017234802, 58639.08693695068, 59207.860260009766, 56955.25326538086, 59657.82029724121, 45838.67999172211, 56245.359954833984, 59409.226905822754, 60368.37335205078, 54833.960399627686, 54084.40663146973, 55452.34697341919, 57035.9335899353, 58194.9334564209, 57977.93369293213, 53136.62672138214, 59084.43371963501, 57255.58026123047, 55680.160160303116, 58396.940185546875, 48418.44686317444, 58080.186920166016, 55917.62005805969, 56593.786975860596, 50431.15355491638, 60668.36038208008, 57168.806701660156, 56495.04035568237, 50373.04023838043, 57065.94666862488, 57464.16653728485, 47710.55341529846, 54452.386878967285, 57768.71348571777, 58739.62664413452, 50404.18013763428, 52517.95336723328, 56231.74005126953, 53002.03352737427, 57984.40013885498, 51570.76678276062, 56472.28035926819, 52361.25354576111, 59929.87365722656, 59410.0001373291, 57044.406871795654, 57616.34676361084, 56843.07378387451, 54077.06016731262, 52926.133355140686, 55898.566858291626, 48560.073526382446, 56252.58668231964, 59711.84683227539, 54506.02014923096, 56586.02038574219, 58704.43339538574, 61507.55375671387, 48804.25333595276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.181777097130013, "mean_inference_ms": 6.700532021133079, "mean_action_processing_ms": 0.19621227640744654, "mean_env_wait_ms": 231.9713125586543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039568911777453475, "StateBufferConnector_ms": 0.015018227395046962, "ViewRequirementAgentConnector_ms": 0.21507900752378314}}, "episode_reward_max": 61507.55375671387, "episode_reward_min": 45838.67999172211, "episode_reward_mean": 55370.455442091385, "episode_len_mean": 135.76404494382024, "episodes_this_iter": 89, "policy_reward_min": {"agent_0": 45838.67999172211}, "policy_reward_max": {"agent_0": 61507.55375671387}, "policy_reward_mean": {"agent_0": 55370.455442091385}, "hist_stats": {"episode_reward": [47129.76006555557, 56772.5467376709, 57019.806848526, 48540.66673374176, 51194.09340047836, 57961.90673446655, 48388.25995063782, 58079.693504333496, 49497.39356422424, 57419.24658203125, 55310.420206069946, 57228.833755493164, 56569.573389053345, 55922.55354309082, 58023.67335510254, 56512.760135650635, 52366.72680854797, 51471.34001207352, 54210.23358228803, 57917.07370567322, 56334.1000957489, 52196.50039291382, 54286.47333431244, 57716.526611328125, 56298.45355987549, 53675.240082740784, 53108.2202835083, 60768.260162353516, 54312.36011886597, 52846.9469127655, 55165.28017234802, 58639.08693695068, 59207.860260009766, 56955.25326538086, 59657.82029724121, 45838.67999172211, 56245.359954833984, 59409.226905822754, 60368.37335205078, 54833.960399627686, 54084.40663146973, 55452.34697341919, 57035.9335899353, 58194.9334564209, 57977.93369293213, 53136.62672138214, 59084.43371963501, 57255.58026123047, 55680.160160303116, 58396.940185546875, 48418.44686317444, 58080.186920166016, 55917.62005805969, 56593.786975860596, 50431.15355491638, 60668.36038208008, 57168.806701660156, 56495.04035568237, 50373.04023838043, 57065.94666862488, 57464.16653728485, 47710.55341529846, 54452.386878967285, 57768.71348571777, 58739.62664413452, 50404.18013763428, 52517.95336723328, 56231.74005126953, 53002.03352737427, 57984.40013885498, 51570.76678276062, 56472.28035926819, 52361.25354576111, 59929.87365722656, 59410.0001373291, 57044.406871795654, 57616.34676361084, 56843.07378387451, 54077.06016731262, 52926.133355140686, 55898.566858291626, 48560.073526382446, 56252.58668231964, 59711.84683227539, 54506.02014923096, 56586.02038574219, 58704.43339538574, 61507.55375671387, 48804.25333595276], "episode_lengths": [134, 136, 136, 135, 134, 136, 134, 137, 134, 136, 135, 135, 136, 137, 136, 137, 135, 136, 135, 136, 136, 135, 135, 136, 135, 135, 136, 137, 135, 136, 135, 137, 136, 135, 136, 133, 136, 138, 137, 136, 135, 136, 136, 137, 136, 135, 137, 136, 137, 136, 135, 136, 136, 136, 135, 137, 135, 136, 136, 137, 136, 135, 135, 136, 136, 134, 136, 136, 136, 136, 135, 136, 135, 136, 137, 136, 136, 136, 137, 135, 136, 136, 136, 137, 135, 136, 136, 138, 133], "policy_agent_0_reward": [47129.76006555557, 56772.5467376709, 57019.806848526, 48540.66673374176, 51194.09340047836, 57961.90673446655, 48388.25995063782, 58079.693504333496, 49497.39356422424, 57419.24658203125, 55310.420206069946, 57228.833755493164, 56569.573389053345, 55922.55354309082, 58023.67335510254, 56512.760135650635, 52366.72680854797, 51471.34001207352, 54210.23358228803, 57917.07370567322, 56334.1000957489, 52196.50039291382, 54286.47333431244, 57716.526611328125, 56298.45355987549, 53675.240082740784, 53108.2202835083, 60768.260162353516, 54312.36011886597, 52846.9469127655, 55165.28017234802, 58639.08693695068, 59207.860260009766, 56955.25326538086, 59657.82029724121, 45838.67999172211, 56245.359954833984, 59409.226905822754, 60368.37335205078, 54833.960399627686, 54084.40663146973, 55452.34697341919, 57035.9335899353, 58194.9334564209, 57977.93369293213, 53136.62672138214, 59084.43371963501, 57255.58026123047, 55680.160160303116, 58396.940185546875, 48418.44686317444, 58080.186920166016, 55917.62005805969, 56593.786975860596, 50431.15355491638, 60668.36038208008, 57168.806701660156, 56495.04035568237, 50373.04023838043, 57065.94666862488, 57464.16653728485, 47710.55341529846, 54452.386878967285, 57768.71348571777, 58739.62664413452, 50404.18013763428, 52517.95336723328, 56231.74005126953, 53002.03352737427, 57984.40013885498, 51570.76678276062, 56472.28035926819, 52361.25354576111, 59929.87365722656, 59410.0001373291, 57044.406871795654, 57616.34676361084, 56843.07378387451, 54077.06016731262, 52926.133355140686, 55898.566858291626, 48560.073526382446, 56252.58668231964, 59711.84683227539, 54506.02014923096, 56586.02038574219, 58704.43339538574, 61507.55375671387, 48804.25333595276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.181777097130013, "mean_inference_ms": 6.700532021133079, "mean_action_processing_ms": 0.19621227640744654, "mean_env_wait_ms": 231.9713125586543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039568911777453475, "StateBufferConnector_ms": 0.015018227395046962, "ViewRequirementAgentConnector_ms": 0.21507900752378314}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000, "num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.98011368070615, "num_env_steps_trained_throughput_per_sec": 263.98011368070615, "timesteps_total": 1036000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1036000, "timers": {"training_iteration_time_ms": 14196.554, "sample_time_ms": 11316.779, "learn_time_ms": 2724.777, "learn_throughput": 1468.01, "synch_weights_time_ms": 154.269}, "counters": {"num_env_steps_sampled": 1036000, "num_env_steps_trained": 1036000, "num_agent_steps_sampled": 1036000, "num_agent_steps_trained": 1036000}, "done": false, "episodes_total": 7593, "training_iteration": 259, "trial_id": "32397_00000", "date": "2025-03-21_09-39-35", "timestamp": 1742549975, "time_this_iter_s": 15.198497295379639, "time_total_s": 3736.365046262741, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d34310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3736.365046262741, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 96.12380952380951, "ram_util_percent": 13.580952380952382}}
{"custom_metrics": {"num_batches_mean": 5.457142857142857, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.891640663146973, "policy_loss": -0.01328685600310564, "vf_loss": 9.90478515625, "vf_explained_var": -4.624947962383885e-07, "kl": 0.01517184916883707, "entropy": 0.3691713213920593, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "sampler_results": {"episode_reward_max": 60315.15347290039, "episode_reward_min": 51300.600259780884, "episode_reward_mean": 56167.89365854434, "episode_len_mean": 135.8, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {"agent_0": 51300.600259780884}, "policy_reward_max": {"agent_0": 60315.15347290039}, "policy_reward_mean": {"agent_0": 56167.89365854434}, "custom_metrics": {"num_batches_mean": 5.457142857142857, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59975.28677368164, 54536.18673706055, 53561.01993751526, 57473.906925201416, 58152.85997390747, 56061.01996040344, 60315.15347290039, 59252.686950683594, 58212.960074424744, 55849.60656738281, 56981.1801071167, 54917.24677658081, 56328.08010482788, 58339.16679382324, 59638.86009788513, 55808.51328277588, 56293.9401550293, 54699.953642845154, 51300.600259780884, 57568.640228271484, 51965.200154304504, 56531.54691696167, 51470.98004817963, 51548.373626708984, 54399.00028657913, 54483.10696321726, 56823.526947021484, 55555.653522491455, 52477.72005653381, 57117.75996398926, 58369.18667602539, 57603.40026855469, 58438.97352218628, 56414.95343399048, 57410.02684020996], "episode_lengths": [137, 135, 136, 136, 136, 136, 137, 138, 136, 135, 136, 137, 136, 136, 137, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 135, 135, 137, 136, 136, 136, 136], "policy_agent_0_reward": [59975.28677368164, 54536.18673706055, 53561.01993751526, 57473.906925201416, 58152.85997390747, 56061.01996040344, 60315.15347290039, 59252.686950683594, 58212.960074424744, 55849.60656738281, 56981.1801071167, 54917.24677658081, 56328.08010482788, 58339.16679382324, 59638.86009788513, 55808.51328277588, 56293.9401550293, 54699.953642845154, 51300.600259780884, 57568.640228271484, 51965.200154304504, 56531.54691696167, 51470.98004817963, 51548.373626708984, 54399.00028657913, 54483.10696321726, 56823.526947021484, 55555.653522491455, 52477.72005653381, 57117.75996398926, 58369.18667602539, 57603.40026855469, 58438.97352218628, 56414.95343399048, 57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.148051771678862, "mean_inference_ms": 6.498582523657924, "mean_action_processing_ms": 0.198109508167407, "mean_env_wait_ms": 223.7412615464602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03787449428013393, "StateBufferConnector_ms": 0.005816732134137835, "ViewRequirementAgentConnector_ms": 0.2118948527744838}}, "episode_reward_max": 60315.15347290039, "episode_reward_min": 51300.600259780884, "episode_reward_mean": 56167.89365854434, "episode_len_mean": 135.8, "episodes_this_iter": 35, "policy_reward_min": {"agent_0": 51300.600259780884}, "policy_reward_max": {"agent_0": 60315.15347290039}, "policy_reward_mean": {"agent_0": 56167.89365854434}, "hist_stats": {"episode_reward": [59975.28677368164, 54536.18673706055, 53561.01993751526, 57473.906925201416, 58152.85997390747, 56061.01996040344, 60315.15347290039, 59252.686950683594, 58212.960074424744, 55849.60656738281, 56981.1801071167, 54917.24677658081, 56328.08010482788, 58339.16679382324, 59638.86009788513, 55808.51328277588, 56293.9401550293, 54699.953642845154, 51300.600259780884, 57568.640228271484, 51965.200154304504, 56531.54691696167, 51470.98004817963, 51548.373626708984, 54399.00028657913, 54483.10696321726, 56823.526947021484, 55555.653522491455, 52477.72005653381, 57117.75996398926, 58369.18667602539, 57603.40026855469, 58438.97352218628, 56414.95343399048, 57410.02684020996], "episode_lengths": [137, 135, 136, 136, 136, 136, 137, 138, 136, 135, 136, 137, 136, 136, 137, 135, 136, 135, 135, 135, 135, 136, 135, 134, 136, 135, 135, 136, 135, 135, 137, 136, 136, 136, 136], "policy_agent_0_reward": [59975.28677368164, 54536.18673706055, 53561.01993751526, 57473.906925201416, 58152.85997390747, 56061.01996040344, 60315.15347290039, 59252.686950683594, 58212.960074424744, 55849.60656738281, 56981.1801071167, 54917.24677658081, 56328.08010482788, 58339.16679382324, 59638.86009788513, 55808.51328277588, 56293.9401550293, 54699.953642845154, 51300.600259780884, 57568.640228271484, 51965.200154304504, 56531.54691696167, 51470.98004817963, 51548.373626708984, 54399.00028657913, 54483.10696321726, 56823.526947021484, 55555.653522491455, 52477.72005653381, 57117.75996398926, 58369.18667602539, 57603.40026855469, 58438.97352218628, 56414.95343399048, 57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.148051771678862, "mean_inference_ms": 6.498582523657924, "mean_action_processing_ms": 0.198109508167407, "mean_env_wait_ms": 223.7412615464602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03787449428013393, "StateBufferConnector_ms": 0.005816732134137835, "ViewRequirementAgentConnector_ms": 0.2118948527744838}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.70603973793794, "num_env_steps_trained_throughput_per_sec": 241.70603973793794, "timesteps_total": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 14615.073, "sample_time_ms": 11705.968, "learn_time_ms": 2752.603, "learn_throughput": 1453.17, "synch_weights_time_ms": 155.758}, "counters": {"num_env_steps_sampled": 1040000, "num_env_steps_trained": 1040000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "episodes_total": 7628, "training_iteration": 260, "trial_id": "32397_00000", "date": "2025-03-21_09-39-52", "timestamp": 1742549992, "time_this_iter_s": 16.604363203048706, "time_total_s": 3752.96940946579, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36b90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3752.96940946579, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 99.15714285714287, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982928276062012, "policy_loss": -0.017214663326740265, "vf_loss": 10.0, "vf_explained_var": -4.0940940948530624e-07, "kl": 0.015354965813457966, "entropy": 0.3927237093448639, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 57410.02684020996, "episode_reward_min": 57410.02684020996, "episode_reward_mean": 57410.02684020996, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57410.02684020996}, "policy_reward_max": {"agent_0": 57410.02684020996}, "policy_reward_mean": {"agent_0": 57410.02684020996}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57410.02684020996], "episode_lengths": [136], "policy_agent_0_reward": [57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.9977745252824, "mean_inference_ms": 7.1436053442132685, "mean_action_processing_ms": 0.20283825221850801, "mean_env_wait_ms": 228.37613130644414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050711631774902344, "StateBufferConnector_ms": 0.006651878356933594, "ViewRequirementAgentConnector_ms": 0.20706653594970703}}, "episode_reward_max": 57410.02684020996, "episode_reward_min": 57410.02684020996, "episode_reward_mean": 57410.02684020996, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57410.02684020996}, "policy_reward_max": {"agent_0": 57410.02684020996}, "policy_reward_mean": {"agent_0": 57410.02684020996}, "hist_stats": {"episode_reward": [57410.02684020996], "episode_lengths": [136], "policy_agent_0_reward": [57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.9977745252824, "mean_inference_ms": 7.1436053442132685, "mean_action_processing_ms": 0.20283825221850801, "mean_env_wait_ms": 228.37613130644414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050711631774902344, "StateBufferConnector_ms": 0.006651878356933594, "ViewRequirementAgentConnector_ms": 0.20706653594970703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.431018703926, "num_env_steps_trained_throughput_per_sec": 291.431018703926, "timesteps_total": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 14257.963, "sample_time_ms": 11285.188, "learn_time_ms": 2818.203, "learn_throughput": 1419.344, "synch_weights_time_ms": 153.818}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 7628, "training_iteration": 261, "trial_id": "32397_00000", "date": "2025-03-21_09-40-06", "timestamp": 1742550006, "time_this_iter_s": 13.78426194190979, "time_total_s": 3766.7536714076996, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3766.7536714076996, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 99.675, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.983691215515137, "policy_loss": -0.016466088593006134, "vf_loss": 10.0, "vf_explained_var": -4.835426921090402e-07, "kl": 0.01683104783296585, "entropy": 0.3613652288913727, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "sampler_results": {"episode_reward_max": 57410.02684020996, "episode_reward_min": 57410.02684020996, "episode_reward_mean": 57410.02684020996, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57410.02684020996}, "policy_reward_max": {"agent_0": 57410.02684020996}, "policy_reward_mean": {"agent_0": 57410.02684020996}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57410.02684020996], "episode_lengths": [136], "policy_agent_0_reward": [57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.9977745252824, "mean_inference_ms": 7.1436053442132685, "mean_action_processing_ms": 0.20283825221850801, "mean_env_wait_ms": 228.37613130644414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050711631774902344, "StateBufferConnector_ms": 0.006651878356933594, "ViewRequirementAgentConnector_ms": 0.20706653594970703}}, "episode_reward_max": 57410.02684020996, "episode_reward_min": 57410.02684020996, "episode_reward_mean": 57410.02684020996, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57410.02684020996}, "policy_reward_max": {"agent_0": 57410.02684020996}, "policy_reward_mean": {"agent_0": 57410.02684020996}, "hist_stats": {"episode_reward": [57410.02684020996], "episode_lengths": [136], "policy_agent_0_reward": [57410.02684020996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.9977745252824, "mean_inference_ms": 7.1436053442132685, "mean_action_processing_ms": 0.20283825221850801, "mean_env_wait_ms": 228.37613130644414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050711631774902344, "StateBufferConnector_ms": 0.006651878356933594, "ViewRequirementAgentConnector_ms": 0.20706653594970703}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000, "num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4207382966938, "num_env_steps_trained_throughput_per_sec": 294.4207382966938, "timesteps_total": 1048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1048000, "timers": {"training_iteration_time_ms": 14316.385, "sample_time_ms": 11307.782, "learn_time_ms": 2853.658, "learn_throughput": 1401.71, "synch_weights_time_ms": 154.201}, "counters": {"num_env_steps_sampled": 1048000, "num_env_steps_trained": 1048000, "num_agent_steps_sampled": 1048000, "num_agent_steps_trained": 1048000}, "done": false, "episodes_total": 7628, "training_iteration": 262, "trial_id": "32397_00000", "date": "2025-03-21_09-40-19", "timestamp": 1742550019, "time_this_iter_s": 13.63347601890564, "time_total_s": 3780.387147426605, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d379a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3780.387147426605, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 99.67368421052633, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.847302436828613, "policy_loss": -0.016847090795636177, "vf_loss": 9.864013671875, "vf_explained_var": -4.236896700149373e-07, "kl": 0.014456266537308693, "entropy": 0.33688876032829285, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "sampler_results": {"episode_reward_max": 61333.74710083008, "episode_reward_min": 42844.22010231018, "episode_reward_mean": 54077.05907477682, "episode_len_mean": 135.63636363636363, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {"agent_0": 42844.22010231018}, "policy_reward_max": {"agent_0": 61333.74710083008}, "policy_reward_mean": {"agent_0": 54077.05907477682}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [61333.74710083008, 56536.44675064087, 47741.346898555756, 48198.14020347595, 46132.8000497818, 54633.1734085083, 48339.30038070679, 54294.38022232056, 60379.786865234375, 50960.74671173096, 58783.727113723755, 50092.55350112915, 49655.52006626129, 59085.753646850586, 54646.37331008911, 59155.420097351074, 60658.340240478516, 55102.56680870056, 57316.80012512207, 50847.02671790123, 58986.06016540527, 47890.21337890625, 45114.47344970703, 50564.27358198166, 56980.01375579834, 58007.353523254395, 58952.1535949707, 46417.77332532406, 55454.41995239258, 57461.653259277344, 42844.22010231018, 56628.5401802063, 58116.100118637085, 54774.060130119324, 53911.36041545868, 51325.293278217316, 53535.58674621582, 54219.266686439514, 52231.2334651947, 48763.4467086792, 60150.373443603516, 54144.58709907532, 60334.173599243164, 55903.200271606445, 50817.36020374298, 57971.533615112305, 55498.27356719971, 55768.41360092163, 54001.82657146454, 47894.87344741821, 61017.34048461914, 47605.30685520172, 56157.4401512146, 51170.12662315369, 59731.973541259766], "episode_lengths": [138, 137, 135, 133, 134, 137, 134, 136, 137, 135, 137, 136, 136, 137, 136, 136, 137, 135, 137, 134, 137, 135, 134, 135, 136, 136, 137, 133, 137, 136, 133, 136, 137, 135, 135, 135, 135, 135, 135, 134, 137, 136, 137, 135, 134, 137, 136, 135, 135, 134, 137, 135, 136, 136, 137], "policy_agent_0_reward": [61333.74710083008, 56536.44675064087, 47741.346898555756, 48198.14020347595, 46132.8000497818, 54633.1734085083, 48339.30038070679, 54294.38022232056, 60379.786865234375, 50960.74671173096, 58783.727113723755, 50092.55350112915, 49655.52006626129, 59085.753646850586, 54646.37331008911, 59155.420097351074, 60658.340240478516, 55102.56680870056, 57316.80012512207, 50847.02671790123, 58986.06016540527, 47890.21337890625, 45114.47344970703, 50564.27358198166, 56980.01375579834, 58007.353523254395, 58952.1535949707, 46417.77332532406, 55454.41995239258, 57461.653259277344, 42844.22010231018, 56628.5401802063, 58116.100118637085, 54774.060130119324, 53911.36041545868, 51325.293278217316, 53535.58674621582, 54219.266686439514, 52231.2334651947, 48763.4467086792, 60150.373443603516, 54144.58709907532, 60334.173599243164, 55903.200271606445, 50817.36020374298, 57971.533615112305, 55498.27356719971, 55768.41360092163, 54001.82657146454, 47894.87344741821, 61017.34048461914, 47605.30685520172, 56157.4401512146, 51170.12662315369, 59731.973541259766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.12814806453494, "mean_inference_ms": 6.667777056810521, "mean_action_processing_ms": 0.19559818495303594, "mean_env_wait_ms": 232.77369476110445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0391609018499201, "StateBufferConnector_ms": 0.0060662356289950285, "ViewRequirementAgentConnector_ms": 0.1950814507224343}}, "episode_reward_max": 61333.74710083008, "episode_reward_min": 42844.22010231018, "episode_reward_mean": 54077.05907477682, "episode_len_mean": 135.63636363636363, "episodes_this_iter": 55, "policy_reward_min": {"agent_0": 42844.22010231018}, "policy_reward_max": {"agent_0": 61333.74710083008}, "policy_reward_mean": {"agent_0": 54077.05907477682}, "hist_stats": {"episode_reward": [61333.74710083008, 56536.44675064087, 47741.346898555756, 48198.14020347595, 46132.8000497818, 54633.1734085083, 48339.30038070679, 54294.38022232056, 60379.786865234375, 50960.74671173096, 58783.727113723755, 50092.55350112915, 49655.52006626129, 59085.753646850586, 54646.37331008911, 59155.420097351074, 60658.340240478516, 55102.56680870056, 57316.80012512207, 50847.02671790123, 58986.06016540527, 47890.21337890625, 45114.47344970703, 50564.27358198166, 56980.01375579834, 58007.353523254395, 58952.1535949707, 46417.77332532406, 55454.41995239258, 57461.653259277344, 42844.22010231018, 56628.5401802063, 58116.100118637085, 54774.060130119324, 53911.36041545868, 51325.293278217316, 53535.58674621582, 54219.266686439514, 52231.2334651947, 48763.4467086792, 60150.373443603516, 54144.58709907532, 60334.173599243164, 55903.200271606445, 50817.36020374298, 57971.533615112305, 55498.27356719971, 55768.41360092163, 54001.82657146454, 47894.87344741821, 61017.34048461914, 47605.30685520172, 56157.4401512146, 51170.12662315369, 59731.973541259766], "episode_lengths": [138, 137, 135, 133, 134, 137, 134, 136, 137, 135, 137, 136, 136, 137, 136, 136, 137, 135, 137, 134, 137, 135, 134, 135, 136, 136, 137, 133, 137, 136, 133, 136, 137, 135, 135, 135, 135, 135, 135, 134, 137, 136, 137, 135, 134, 137, 136, 135, 135, 134, 137, 135, 136, 136, 137], "policy_agent_0_reward": [61333.74710083008, 56536.44675064087, 47741.346898555756, 48198.14020347595, 46132.8000497818, 54633.1734085083, 48339.30038070679, 54294.38022232056, 60379.786865234375, 50960.74671173096, 58783.727113723755, 50092.55350112915, 49655.52006626129, 59085.753646850586, 54646.37331008911, 59155.420097351074, 60658.340240478516, 55102.56680870056, 57316.80012512207, 50847.02671790123, 58986.06016540527, 47890.21337890625, 45114.47344970703, 50564.27358198166, 56980.01375579834, 58007.353523254395, 58952.1535949707, 46417.77332532406, 55454.41995239258, 57461.653259277344, 42844.22010231018, 56628.5401802063, 58116.100118637085, 54774.060130119324, 53911.36041545868, 51325.293278217316, 53535.58674621582, 54219.266686439514, 52231.2334651947, 48763.4467086792, 60150.373443603516, 54144.58709907532, 60334.173599243164, 55903.200271606445, 50817.36020374298, 57971.533615112305, 55498.27356719971, 55768.41360092163, 54001.82657146454, 47894.87344741821, 61017.34048461914, 47605.30685520172, 56157.4401512146, 51170.12662315369, 59731.973541259766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.12814806453494, "mean_inference_ms": 6.667777056810521, "mean_action_processing_ms": 0.19559818495303594, "mean_env_wait_ms": 232.77369476110445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0391609018499201, "StateBufferConnector_ms": 0.0060662356289950285, "ViewRequirementAgentConnector_ms": 0.1950814507224343}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000, "num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.014774073284, "num_env_steps_trained_throughput_per_sec": 288.014774073284, "timesteps_total": 1052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1052000, "timers": {"training_iteration_time_ms": 14385.019, "sample_time_ms": 11438.662, "learn_time_ms": 2788.352, "learn_throughput": 1434.539, "synch_weights_time_ms": 157.261}, "counters": {"num_env_steps_sampled": 1052000, "num_env_steps_trained": 1052000, "num_agent_steps_sampled": 1052000, "num_agent_steps_trained": 1052000}, "done": false, "episodes_total": 7683, "training_iteration": 263, "trial_id": "32397_00000", "date": "2025-03-21_09-40-33", "timestamp": 1742550033, "time_this_iter_s": 13.935362815856934, "time_total_s": 3794.322510242462, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8d36b90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3794.322510242462, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 97.63684210526316, "ram_util_percent": 13.594736842105263}}
{"custom_metrics": {"num_batches_mean": 5.463768115942029, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.81186294555664, "policy_loss": -0.017158320173621178, "vf_loss": 9.828857421875, "vf_explained_var": 4.0729840833364506e-08, "kl": 0.017412107437849045, "entropy": 0.3618277311325073, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 62420.29364013672, "episode_reward_min": 45724.16012620926, "episode_reward_mean": 55192.92497603963, "episode_len_mean": 135.768115942029, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {"agent_0": 45724.16012620926}, "policy_reward_max": {"agent_0": 62420.29364013672}, "policy_reward_mean": {"agent_0": 55192.92497603963}, "custom_metrics": {"num_batches_mean": 5.463768115942029, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57507.36701583862, 48824.47361564636, 59766.40020751953, 54013.25330924988, 53987.539989471436, 52172.493368148804, 51828.779829502106, 60420.726989746094, 49958.00684046745, 48432.57348430157, 57812.70022583008, 56417.787017822266, 56254.88000869751, 51509.47347640991, 50962.70674657822, 55275.93997001648, 60746.22692871094, 58293.9333820343, 48802.72036886215, 62420.29364013672, 45724.16012620926, 57638.49346637726, 50475.36013507843, 58816.88702392578, 57375.93315124512, 58561.219970703125, 56853.24685668945, 58645.12021636963, 49086.7934551239, 50918.233483314514, 54455.97355937958, 58827.95347595215, 54476.973751068115, 58319.18005371094, 48223.76686954498, 58215.72009277344, 61635.81369018555, 52053.70002746582, 56166.11345100403, 59564.36697387695, 59136.06014251709, 51519.11986255646, 54657.98017311096, 58588.09341430664, 48652.240058898926, 48686.84013080597, 54052.960052490234, 52484.28015899658, 56469.526737213135, 59483.04037475586, 59643.9535446167, 51604.77344036102, 48454.04005622864, 56308.22679901123, 55064.98016357422, 59865.9933013916, 57504.96700668335, 53988.87329292297, 59706.44055175781, 56818.10693359375, 57926.22019958496, 57644.90671539307, 52630.2867603302, 59601.65357589722, 55009.253571510315, 57110.15336608887, 47993.03325462341, 55021.899936676025, 61240.63352584839], "episode_lengths": [136, 133, 137, 135, 136, 135, 134, 137, 134, 135, 137, 136, 135, 135, 134, 135, 138, 137, 136, 138, 133, 136, 135, 137, 136, 137, 135, 137, 135, 134, 135, 136, 135, 137, 135, 136, 138, 135, 136, 137, 137, 135, 135, 136, 135, 135, 135, 135, 135, 137, 136, 136, 134, 136, 136, 137, 136, 136, 136, 136, 136, 137, 137, 137, 136, 136, 134, 136, 137], "policy_agent_0_reward": [57507.36701583862, 48824.47361564636, 59766.40020751953, 54013.25330924988, 53987.539989471436, 52172.493368148804, 51828.779829502106, 60420.726989746094, 49958.00684046745, 48432.57348430157, 57812.70022583008, 56417.787017822266, 56254.88000869751, 51509.47347640991, 50962.70674657822, 55275.93997001648, 60746.22692871094, 58293.9333820343, 48802.72036886215, 62420.29364013672, 45724.16012620926, 57638.49346637726, 50475.36013507843, 58816.88702392578, 57375.93315124512, 58561.219970703125, 56853.24685668945, 58645.12021636963, 49086.7934551239, 50918.233483314514, 54455.97355937958, 58827.95347595215, 54476.973751068115, 58319.18005371094, 48223.76686954498, 58215.72009277344, 61635.81369018555, 52053.70002746582, 56166.11345100403, 59564.36697387695, 59136.06014251709, 51519.11986255646, 54657.98017311096, 58588.09341430664, 48652.240058898926, 48686.84013080597, 54052.960052490234, 52484.28015899658, 56469.526737213135, 59483.04037475586, 59643.9535446167, 51604.77344036102, 48454.04005622864, 56308.22679901123, 55064.98016357422, 59865.9933013916, 57504.96700668335, 53988.87329292297, 59706.44055175781, 56818.10693359375, 57926.22019958496, 57644.90671539307, 52630.2867603302, 59601.65357589722, 55009.253571510315, 57110.15336608887, 47993.03325462341, 55021.899936676025, 61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.13145765190476, "mean_inference_ms": 6.628365743866047, "mean_action_processing_ms": 0.1976675245071119, "mean_env_wait_ms": 227.27866739942337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038522222767705505, "StateBufferConnector_ms": 0.005818449932595958, "ViewRequirementAgentConnector_ms": 0.2047393632971722}}, "episode_reward_max": 62420.29364013672, "episode_reward_min": 45724.16012620926, "episode_reward_mean": 55192.92497603963, "episode_len_mean": 135.768115942029, "episodes_this_iter": 69, "policy_reward_min": {"agent_0": 45724.16012620926}, "policy_reward_max": {"agent_0": 62420.29364013672}, "policy_reward_mean": {"agent_0": 55192.92497603963}, "hist_stats": {"episode_reward": [57507.36701583862, 48824.47361564636, 59766.40020751953, 54013.25330924988, 53987.539989471436, 52172.493368148804, 51828.779829502106, 60420.726989746094, 49958.00684046745, 48432.57348430157, 57812.70022583008, 56417.787017822266, 56254.88000869751, 51509.47347640991, 50962.70674657822, 55275.93997001648, 60746.22692871094, 58293.9333820343, 48802.72036886215, 62420.29364013672, 45724.16012620926, 57638.49346637726, 50475.36013507843, 58816.88702392578, 57375.93315124512, 58561.219970703125, 56853.24685668945, 58645.12021636963, 49086.7934551239, 50918.233483314514, 54455.97355937958, 58827.95347595215, 54476.973751068115, 58319.18005371094, 48223.76686954498, 58215.72009277344, 61635.81369018555, 52053.70002746582, 56166.11345100403, 59564.36697387695, 59136.06014251709, 51519.11986255646, 54657.98017311096, 58588.09341430664, 48652.240058898926, 48686.84013080597, 54052.960052490234, 52484.28015899658, 56469.526737213135, 59483.04037475586, 59643.9535446167, 51604.77344036102, 48454.04005622864, 56308.22679901123, 55064.98016357422, 59865.9933013916, 57504.96700668335, 53988.87329292297, 59706.44055175781, 56818.10693359375, 57926.22019958496, 57644.90671539307, 52630.2867603302, 59601.65357589722, 55009.253571510315, 57110.15336608887, 47993.03325462341, 55021.899936676025, 61240.63352584839], "episode_lengths": [136, 133, 137, 135, 136, 135, 134, 137, 134, 135, 137, 136, 135, 135, 134, 135, 138, 137, 136, 138, 133, 136, 135, 137, 136, 137, 135, 137, 135, 134, 135, 136, 135, 137, 135, 136, 138, 135, 136, 137, 137, 135, 135, 136, 135, 135, 135, 135, 135, 137, 136, 136, 134, 136, 136, 137, 136, 136, 136, 136, 136, 137, 137, 137, 136, 136, 134, 136, 137], "policy_agent_0_reward": [57507.36701583862, 48824.47361564636, 59766.40020751953, 54013.25330924988, 53987.539989471436, 52172.493368148804, 51828.779829502106, 60420.726989746094, 49958.00684046745, 48432.57348430157, 57812.70022583008, 56417.787017822266, 56254.88000869751, 51509.47347640991, 50962.70674657822, 55275.93997001648, 60746.22692871094, 58293.9333820343, 48802.72036886215, 62420.29364013672, 45724.16012620926, 57638.49346637726, 50475.36013507843, 58816.88702392578, 57375.93315124512, 58561.219970703125, 56853.24685668945, 58645.12021636963, 49086.7934551239, 50918.233483314514, 54455.97355937958, 58827.95347595215, 54476.973751068115, 58319.18005371094, 48223.76686954498, 58215.72009277344, 61635.81369018555, 52053.70002746582, 56166.11345100403, 59564.36697387695, 59136.06014251709, 51519.11986255646, 54657.98017311096, 58588.09341430664, 48652.240058898926, 48686.84013080597, 54052.960052490234, 52484.28015899658, 56469.526737213135, 59483.04037475586, 59643.9535446167, 51604.77344036102, 48454.04005622864, 56308.22679901123, 55064.98016357422, 59865.9933013916, 57504.96700668335, 53988.87329292297, 59706.44055175781, 56818.10693359375, 57926.22019958496, 57644.90671539307, 52630.2867603302, 59601.65357589722, 55009.253571510315, 57110.15336608887, 47993.03325462341, 55021.899936676025, 61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.13145765190476, "mean_inference_ms": 6.628365743866047, "mean_action_processing_ms": 0.1976675245071119, "mean_env_wait_ms": 227.27866739942337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038522222767705505, "StateBufferConnector_ms": 0.005818449932595958, "ViewRequirementAgentConnector_ms": 0.2047393632971722}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.90587175979192, "num_env_steps_trained_throughput_per_sec": 215.90587175979192, "timesteps_total": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 14907.255, "sample_time_ms": 11944.13, "learn_time_ms": 2802.35, "learn_throughput": 1427.373, "synch_weights_time_ms": 160.037}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 7752, "training_iteration": 264, "trial_id": "32397_00000", "date": "2025-03-21_09-40-52", "timestamp": 1742550052, "time_this_iter_s": 18.58515238761902, "time_total_s": 3812.907662630081, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3812.907662630081, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 98.51666666666667, "ram_util_percent": 13.583333333333334}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982462882995605, "policy_loss": -0.017687737941741943, "vf_loss": 10.0, "vf_explained_var": -3.166496753692627e-08, "kl": 0.016138950362801552, "entropy": 0.39000093936920166, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "sampler_results": {"episode_reward_max": 61240.63352584839, "episode_reward_min": 61240.63352584839, "episode_reward_mean": 61240.63352584839, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 61240.63352584839}, "policy_reward_max": {"agent_0": 61240.63352584839}, "policy_reward_mean": {"agent_0": 61240.63352584839}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61240.63352584839], "episode_lengths": [137], "policy_agent_0_reward": [61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449451843398975, "mean_inference_ms": 6.944605070735621, "mean_action_processing_ms": 0.19367117333770545, "mean_env_wait_ms": 233.49489800562336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15261173248291016}}, "episode_reward_max": 61240.63352584839, "episode_reward_min": 61240.63352584839, "episode_reward_mean": 61240.63352584839, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 61240.63352584839}, "policy_reward_max": {"agent_0": 61240.63352584839}, "policy_reward_mean": {"agent_0": 61240.63352584839}, "hist_stats": {"episode_reward": [61240.63352584839], "episode_lengths": [137], "policy_agent_0_reward": [61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449451843398975, "mean_inference_ms": 6.944605070735621, "mean_action_processing_ms": 0.19367117333770545, "mean_env_wait_ms": 233.49489800562336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15261173248291016}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000, "num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.440123954948, "num_env_steps_trained_throughput_per_sec": 314.440123954948, "timesteps_total": 1060000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1060000, "timers": {"training_iteration_time_ms": 14423.538, "sample_time_ms": 11407.659, "learn_time_ms": 2851.872, "learn_throughput": 1402.587, "synch_weights_time_ms": 163.268}, "counters": {"num_env_steps_sampled": 1060000, "num_env_steps_trained": 1060000, "num_agent_steps_sampled": 1060000, "num_agent_steps_trained": 1060000}, "done": false, "episodes_total": 7752, "training_iteration": 265, "trial_id": "32397_00000", "date": "2025-03-21_09-41-05", "timestamp": 1742550065, "time_this_iter_s": 12.77311086654663, "time_total_s": 3825.680773496628, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3825.680773496628, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 99.60555555555557, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985790252685547, "policy_loss": -0.014369009993970394, "vf_loss": 10.0, "vf_explained_var": -2.7318796114172983e-09, "kl": 0.016899343580007553, "entropy": 0.3785811960697174, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "sampler_results": {"episode_reward_max": 61240.63352584839, "episode_reward_min": 61240.63352584839, "episode_reward_mean": 61240.63352584839, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 61240.63352584839}, "policy_reward_max": {"agent_0": 61240.63352584839}, "policy_reward_mean": {"agent_0": 61240.63352584839}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61240.63352584839], "episode_lengths": [137], "policy_agent_0_reward": [61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449451843398975, "mean_inference_ms": 6.944605070735621, "mean_action_processing_ms": 0.19367117333770545, "mean_env_wait_ms": 233.49489800562336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15261173248291016}}, "episode_reward_max": 61240.63352584839, "episode_reward_min": 61240.63352584839, "episode_reward_mean": 61240.63352584839, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 61240.63352584839}, "policy_reward_max": {"agent_0": 61240.63352584839}, "policy_reward_mean": {"agent_0": 61240.63352584839}, "hist_stats": {"episode_reward": [61240.63352584839], "episode_lengths": [137], "policy_agent_0_reward": [61240.63352584839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.449451843398975, "mean_inference_ms": 6.944605070735621, "mean_action_processing_ms": 0.19367117333770545, "mean_env_wait_ms": 233.49489800562336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036716461181640625, "StateBufferConnector_ms": 0.005316734313964844, "ViewRequirementAgentConnector_ms": 0.15261173248291016}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000, "num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4642301186098, "num_env_steps_trained_throughput_per_sec": 303.4642301186098, "timesteps_total": 1064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1064000, "timers": {"training_iteration_time_ms": 14341.496, "sample_time_ms": 11277.25, "learn_time_ms": 2905.995, "learn_throughput": 1376.465, "synch_weights_time_ms": 157.508}, "counters": {"num_env_steps_sampled": 1064000, "num_env_steps_trained": 1064000, "num_agent_steps_sampled": 1064000, "num_agent_steps_trained": 1064000}, "done": false, "episodes_total": 7752, "training_iteration": 266, "trial_id": "32397_00000", "date": "2025-03-21_09-41-18", "timestamp": 1742550078, "time_this_iter_s": 13.225610256195068, "time_total_s": 3838.906383752823, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3838.906383752823, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 99.55789473684213, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.944846153259277, "policy_loss": -0.01793087273836136, "vf_loss": 9.962646484375, "vf_explained_var": 1.875683608432155e-07, "kl": 0.014043537899851799, "entropy": 0.36730968952178955, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 59691.74696350098, "episode_reward_min": 41600.120216846466, "episode_reward_mean": 53761.42502391338, "episode_len_mean": 135.66666666666666, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {"agent_0": 41600.120216846466}, "policy_reward_max": {"agent_0": 59691.74696350098}, "policy_reward_mean": {"agent_0": 53761.42502391338}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51598.37333869934, 41600.120216846466, 57079.80687046051, 57950.686866760254, 54663.753326416016, 59691.74696350098, 54026.940116882324, 52533.366797447205, 58130.59350013733, 53005.3601975441, 51637.84041798115, 56780.46677398682, 49336.320019721985, 50494.680028915405, 57891.31992340088], "episode_lengths": [135, 133, 138, 136, 135, 137, 136, 135, 137, 135, 135, 137, 134, 135, 137], "policy_agent_0_reward": [51598.37333869934, 41600.120216846466, 57079.80687046051, 57950.686866760254, 54663.753326416016, 59691.74696350098, 54026.940116882324, 52533.366797447205, 58130.59350013733, 53005.3601975441, 51637.84041798115, 56780.46677398682, 49336.320019721985, 50494.680028915405, 57891.31992340088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.218680498403305, "mean_inference_ms": 6.66764782585083, "mean_action_processing_ms": 0.19436624563063523, "mean_env_wait_ms": 233.44850653069332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05693753560384115, "StateBufferConnector_ms": 0.0059413909912109375, "ViewRequirementAgentConnector_ms": 0.18230597178141275}}, "episode_reward_max": 59691.74696350098, "episode_reward_min": 41600.120216846466, "episode_reward_mean": 53761.42502391338, "episode_len_mean": 135.66666666666666, "episodes_this_iter": 15, "policy_reward_min": {"agent_0": 41600.120216846466}, "policy_reward_max": {"agent_0": 59691.74696350098}, "policy_reward_mean": {"agent_0": 53761.42502391338}, "hist_stats": {"episode_reward": [51598.37333869934, 41600.120216846466, 57079.80687046051, 57950.686866760254, 54663.753326416016, 59691.74696350098, 54026.940116882324, 52533.366797447205, 58130.59350013733, 53005.3601975441, 51637.84041798115, 56780.46677398682, 49336.320019721985, 50494.680028915405, 57891.31992340088], "episode_lengths": [135, 133, 138, 136, 135, 137, 136, 135, 137, 135, 135, 137, 134, 135, 137], "policy_agent_0_reward": [51598.37333869934, 41600.120216846466, 57079.80687046051, 57950.686866760254, 54663.753326416016, 59691.74696350098, 54026.940116882324, 52533.366797447205, 58130.59350013733, 53005.3601975441, 51637.84041798115, 56780.46677398682, 49336.320019721985, 50494.680028915405, 57891.31992340088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.218680498403305, "mean_inference_ms": 6.66764782585083, "mean_action_processing_ms": 0.19436624563063523, "mean_env_wait_ms": 233.44850653069332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05693753560384115, "StateBufferConnector_ms": 0.0059413909912109375, "ViewRequirementAgentConnector_ms": 0.18230597178141275}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.83271444108885, "num_env_steps_trained_throughput_per_sec": 321.83271444108885, "timesteps_total": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 14299.936, "sample_time_ms": 11306.239, "learn_time_ms": 2847.379, "learn_throughput": 1404.801, "synch_weights_time_ms": 145.567}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 7767, "training_iteration": 267, "trial_id": "32397_00000", "date": "2025-03-21_09-41-31", "timestamp": 1742550091, "time_this_iter_s": 12.472957134246826, "time_total_s": 3851.3793408870697, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3851.3793408870697, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 98.52777777777777, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.284403669724771, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.7056884765625, "policy_loss": -0.017100263386964798, "vf_loss": 9.72265625, "vf_explained_var": 6.192053092490823e-07, "kl": 0.014046428725123405, "entropy": 0.33794787526130676, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "sampler_results": {"episode_reward_max": 62150.5936126709, "episode_reward_min": 47118.77335166931, "episode_reward_mean": 55356.658910576356, "episode_len_mean": 135.69724770642202, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {"agent_0": 47118.77335166931}, "policy_reward_max": {"agent_0": 62150.5936126709}, "policy_reward_mean": {"agent_0": 55356.658910576356}, "custom_metrics": {"num_batches_mean": 5.284403669724771, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58371.24705314636, 58035.32022857666, 57808.00671386719, 54076.42680358887, 54983.53339958191, 55214.719985961914, 57899.67364501953, 49278.63349914551, 60089.19340515137, 57166.060150146484, 57512.74014663696, 53919.773513793945, 57806.27359008789, 58122.820373535156, 54226.61350631714, 55795.68005371094, 55371.19357299805, 59531.880294799805, 55217.90670776367, 47118.77335166931, 51110.566581726074, 55603.98684310913, 60066.22694396973, 55181.57327270508, 53670.74700880051, 54322.24025726318, 59685.7668762207, 53381.700201034546, 62150.5936126709, 55137.44020462036, 54718.92005157471, 53354.64006614685, 61920.179931640625, 58720.87998962402, 60064.26681518555, 54452.9803981781, 55129.49340057373, 56190.54012107849, 51269.58029174805, 58089.78016662598, 54665.79364013672, 56808.60007476807, 48912.34661626816, 52570.366587638855, 53164.63344860077, 55617.31348800659, 56784.113538742065, 55383.50003051758, 48059.246757507324, 55543.466888427734, 57319.60693359375, 56150.300132751465, 59968.500091552734, 55149.34022140503, 55410.593493938446, 54561.48017883301, 52668.3734664917, 50989.646839141846, 56271.45366668701, 60243.58676147461, 55630.400329589844, 56548.43359375, 58426.293491363525, 56140.653163433075, 59238.80699157715, 54730.8200378418, 55016.23346710205, 55845.63369560242, 60142.14683532715, 58524.74687194824, 61215.82015991211, 56662.79341888428, 51948.31342506409, 51097.46687531471, 57824.74034500122, 57628.10029602051, 58780.579875946045, 50078.9467420578, 52268.72002220154, 59247.71327209473, 49181.29992055893, 53640.21326255798, 52580.22698688507, 53771.99996757507, 55944.12678337097, 51196.26668357849, 49133.22016334534, 49481.61346435547, 54759.69349575043, 56957.37343597412, 49360.333230018616, 56453.399909973145, 57696.11351776123, 58418.879959106445, 47548.0866355896, 58999.8134765625, 56720.96001434326, 59413.353424072266, 57975.69351196289, 47968.44672513008, 52873.120129585266, 53525.79336452484, 56078.73338317871, 56473.23344993591, 56052.23338699341, 50998.59350299835, 53643.08029937744, 54258.26678085327, 57763.45359039307], "episode_lengths": [136, 136, 136, 134, 136, 136, 136, 136, 137, 136, 136, 134, 136, 136, 135, 137, 135, 137, 135, 135, 135, 136, 138, 135, 137, 135, 137, 135, 138, 136, 136, 134, 138, 137, 137, 134, 136, 136, 133, 135, 135, 136, 135, 135, 134, 136, 136, 134, 135, 135, 135, 136, 137, 135, 136, 135, 134, 135, 136, 137, 135, 136, 136, 136, 136, 135, 135, 136, 137, 137, 138, 135, 135, 135, 136, 136, 137, 135, 135, 136, 136, 135, 134, 136, 136, 135, 133, 135, 136, 136, 135, 136, 136, 136, 134, 137, 136, 137, 137, 135, 135, 137, 135, 137, 136, 135, 135, 136, 137], "policy_agent_0_reward": [58371.24705314636, 58035.32022857666, 57808.00671386719, 54076.42680358887, 54983.53339958191, 55214.719985961914, 57899.67364501953, 49278.63349914551, 60089.19340515137, 57166.060150146484, 57512.74014663696, 53919.773513793945, 57806.27359008789, 58122.820373535156, 54226.61350631714, 55795.68005371094, 55371.19357299805, 59531.880294799805, 55217.90670776367, 47118.77335166931, 51110.566581726074, 55603.98684310913, 60066.22694396973, 55181.57327270508, 53670.74700880051, 54322.24025726318, 59685.7668762207, 53381.700201034546, 62150.5936126709, 55137.44020462036, 54718.92005157471, 53354.64006614685, 61920.179931640625, 58720.87998962402, 60064.26681518555, 54452.9803981781, 55129.49340057373, 56190.54012107849, 51269.58029174805, 58089.78016662598, 54665.79364013672, 56808.60007476807, 48912.34661626816, 52570.366587638855, 53164.63344860077, 55617.31348800659, 56784.113538742065, 55383.50003051758, 48059.246757507324, 55543.466888427734, 57319.60693359375, 56150.300132751465, 59968.500091552734, 55149.34022140503, 55410.593493938446, 54561.48017883301, 52668.3734664917, 50989.646839141846, 56271.45366668701, 60243.58676147461, 55630.400329589844, 56548.43359375, 58426.293491363525, 56140.653163433075, 59238.80699157715, 54730.8200378418, 55016.23346710205, 55845.63369560242, 60142.14683532715, 58524.74687194824, 61215.82015991211, 56662.79341888428, 51948.31342506409, 51097.46687531471, 57824.74034500122, 57628.10029602051, 58780.579875946045, 50078.9467420578, 52268.72002220154, 59247.71327209473, 49181.29992055893, 53640.21326255798, 52580.22698688507, 53771.99996757507, 55944.12678337097, 51196.26668357849, 49133.22016334534, 49481.61346435547, 54759.69349575043, 56957.37343597412, 49360.333230018616, 56453.399909973145, 57696.11351776123, 58418.879959106445, 47548.0866355896, 58999.8134765625, 56720.96001434326, 59413.353424072266, 57975.69351196289, 47968.44672513008, 52873.120129585266, 53525.79336452484, 56078.73338317871, 56473.23344993591, 56052.23338699341, 50998.59350299835, 53643.08029937744, 54258.26678085327, 57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.93476659090232, "mean_inference_ms": 6.645537435937282, "mean_action_processing_ms": 0.19701799634613024, "mean_env_wait_ms": 229.1553405893936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06038136438492241, "StateBufferConnector_ms": 0.0059775256235665136, "ViewRequirementAgentConnector_ms": 0.20829143874142148}}, "episode_reward_max": 62150.5936126709, "episode_reward_min": 47118.77335166931, "episode_reward_mean": 55356.658910576356, "episode_len_mean": 135.69724770642202, "episodes_this_iter": 109, "policy_reward_min": {"agent_0": 47118.77335166931}, "policy_reward_max": {"agent_0": 62150.5936126709}, "policy_reward_mean": {"agent_0": 55356.658910576356}, "hist_stats": {"episode_reward": [58371.24705314636, 58035.32022857666, 57808.00671386719, 54076.42680358887, 54983.53339958191, 55214.719985961914, 57899.67364501953, 49278.63349914551, 60089.19340515137, 57166.060150146484, 57512.74014663696, 53919.773513793945, 57806.27359008789, 58122.820373535156, 54226.61350631714, 55795.68005371094, 55371.19357299805, 59531.880294799805, 55217.90670776367, 47118.77335166931, 51110.566581726074, 55603.98684310913, 60066.22694396973, 55181.57327270508, 53670.74700880051, 54322.24025726318, 59685.7668762207, 53381.700201034546, 62150.5936126709, 55137.44020462036, 54718.92005157471, 53354.64006614685, 61920.179931640625, 58720.87998962402, 60064.26681518555, 54452.9803981781, 55129.49340057373, 56190.54012107849, 51269.58029174805, 58089.78016662598, 54665.79364013672, 56808.60007476807, 48912.34661626816, 52570.366587638855, 53164.63344860077, 55617.31348800659, 56784.113538742065, 55383.50003051758, 48059.246757507324, 55543.466888427734, 57319.60693359375, 56150.300132751465, 59968.500091552734, 55149.34022140503, 55410.593493938446, 54561.48017883301, 52668.3734664917, 50989.646839141846, 56271.45366668701, 60243.58676147461, 55630.400329589844, 56548.43359375, 58426.293491363525, 56140.653163433075, 59238.80699157715, 54730.8200378418, 55016.23346710205, 55845.63369560242, 60142.14683532715, 58524.74687194824, 61215.82015991211, 56662.79341888428, 51948.31342506409, 51097.46687531471, 57824.74034500122, 57628.10029602051, 58780.579875946045, 50078.9467420578, 52268.72002220154, 59247.71327209473, 49181.29992055893, 53640.21326255798, 52580.22698688507, 53771.99996757507, 55944.12678337097, 51196.26668357849, 49133.22016334534, 49481.61346435547, 54759.69349575043, 56957.37343597412, 49360.333230018616, 56453.399909973145, 57696.11351776123, 58418.879959106445, 47548.0866355896, 58999.8134765625, 56720.96001434326, 59413.353424072266, 57975.69351196289, 47968.44672513008, 52873.120129585266, 53525.79336452484, 56078.73338317871, 56473.23344993591, 56052.23338699341, 50998.59350299835, 53643.08029937744, 54258.26678085327, 57763.45359039307], "episode_lengths": [136, 136, 136, 134, 136, 136, 136, 136, 137, 136, 136, 134, 136, 136, 135, 137, 135, 137, 135, 135, 135, 136, 138, 135, 137, 135, 137, 135, 138, 136, 136, 134, 138, 137, 137, 134, 136, 136, 133, 135, 135, 136, 135, 135, 134, 136, 136, 134, 135, 135, 135, 136, 137, 135, 136, 135, 134, 135, 136, 137, 135, 136, 136, 136, 136, 135, 135, 136, 137, 137, 138, 135, 135, 135, 136, 136, 137, 135, 135, 136, 136, 135, 134, 136, 136, 135, 133, 135, 136, 136, 135, 136, 136, 136, 134, 137, 136, 137, 137, 135, 135, 137, 135, 137, 136, 135, 135, 136, 137], "policy_agent_0_reward": [58371.24705314636, 58035.32022857666, 57808.00671386719, 54076.42680358887, 54983.53339958191, 55214.719985961914, 57899.67364501953, 49278.63349914551, 60089.19340515137, 57166.060150146484, 57512.74014663696, 53919.773513793945, 57806.27359008789, 58122.820373535156, 54226.61350631714, 55795.68005371094, 55371.19357299805, 59531.880294799805, 55217.90670776367, 47118.77335166931, 51110.566581726074, 55603.98684310913, 60066.22694396973, 55181.57327270508, 53670.74700880051, 54322.24025726318, 59685.7668762207, 53381.700201034546, 62150.5936126709, 55137.44020462036, 54718.92005157471, 53354.64006614685, 61920.179931640625, 58720.87998962402, 60064.26681518555, 54452.9803981781, 55129.49340057373, 56190.54012107849, 51269.58029174805, 58089.78016662598, 54665.79364013672, 56808.60007476807, 48912.34661626816, 52570.366587638855, 53164.63344860077, 55617.31348800659, 56784.113538742065, 55383.50003051758, 48059.246757507324, 55543.466888427734, 57319.60693359375, 56150.300132751465, 59968.500091552734, 55149.34022140503, 55410.593493938446, 54561.48017883301, 52668.3734664917, 50989.646839141846, 56271.45366668701, 60243.58676147461, 55630.400329589844, 56548.43359375, 58426.293491363525, 56140.653163433075, 59238.80699157715, 54730.8200378418, 55016.23346710205, 55845.63369560242, 60142.14683532715, 58524.74687194824, 61215.82015991211, 56662.79341888428, 51948.31342506409, 51097.46687531471, 57824.74034500122, 57628.10029602051, 58780.579875946045, 50078.9467420578, 52268.72002220154, 59247.71327209473, 49181.29992055893, 53640.21326255798, 52580.22698688507, 53771.99996757507, 55944.12678337097, 51196.26668357849, 49133.22016334534, 49481.61346435547, 54759.69349575043, 56957.37343597412, 49360.333230018616, 56453.399909973145, 57696.11351776123, 58418.879959106445, 47548.0866355896, 58999.8134765625, 56720.96001434326, 59413.353424072266, 57975.69351196289, 47968.44672513008, 52873.120129585266, 53525.79336452484, 56078.73338317871, 56473.23344993591, 56052.23338699341, 50998.59350299835, 53643.08029937744, 54258.26678085327, 57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.93476659090232, "mean_inference_ms": 6.645537435937282, "mean_action_processing_ms": 0.19701799634613024, "mean_env_wait_ms": 229.1553405893936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06038136438492241, "StateBufferConnector_ms": 0.0059775256235665136, "ViewRequirementAgentConnector_ms": 0.20829143874142148}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.7912307279321, "num_env_steps_trained_throughput_per_sec": 220.7912307279321, "timesteps_total": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 14787.504, "sample_time_ms": 11849.668, "learn_time_ms": 2800.789, "learn_throughput": 1428.169, "synch_weights_time_ms": 136.301}, "counters": {"num_env_steps_sampled": 1072000, "num_env_steps_trained": 1072000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "episodes_total": 7876, "training_iteration": 268, "trial_id": "32397_00000", "date": "2025-03-21_09-41-49", "timestamp": 1742550109, "time_this_iter_s": 18.169838666915894, "time_total_s": 3869.5491795539856, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ea9ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3869.5491795539856, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 96.26666666666667, "ram_util_percent": 13.575000000000001}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987214088439941, "policy_loss": -0.012917941436171532, "vf_loss": 10.0, "vf_explained_var": 7.084260289502708e-08, "kl": 0.014090625569224358, "entropy": 0.34936827421188354, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "sampler_results": {"episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}}, "episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000, "num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1053983104508, "num_env_steps_trained_throughput_per_sec": 303.1053983104508, "timesteps_total": 1076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1076000, "timers": {"training_iteration_time_ms": 14591.912, "sample_time_ms": 11602.935, "learn_time_ms": 2849.726, "learn_throughput": 1403.644, "synch_weights_time_ms": 138.567}, "counters": {"num_env_steps_sampled": 1076000, "num_env_steps_trained": 1076000, "num_agent_steps_sampled": 1076000, "num_agent_steps_trained": 1076000}, "done": false, "episodes_total": 7876, "training_iteration": 269, "trial_id": "32397_00000", "date": "2025-03-21_09-42-02", "timestamp": 1742550122, "time_this_iter_s": 13.254948854446411, "time_total_s": 3882.804128408432, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96cb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3882.804128408432, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 99.61578947368423, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98304271697998, "policy_loss": -0.01440855860710144, "vf_loss": 9.997314453125, "vf_explained_var": 6.494422422065327e-08, "kl": 0.014599843882024288, "entropy": 0.400892436504364, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}}, "episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.7293995201649, "num_env_steps_trained_throughput_per_sec": 306.7293995201649, "timesteps_total": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 14241.086, "sample_time_ms": 11219.899, "learn_time_ms": 2881.318, "learn_throughput": 1388.254, "synch_weights_time_ms": 139.177}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 7876, "training_iteration": 270, "trial_id": "32397_00000", "date": "2025-03-21_09-42-15", "timestamp": 1742550135, "time_this_iter_s": 13.109618425369263, "time_total_s": 3895.9137468338013, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3895.9137468338013, "iterations_since_restore": 270, "perf": {"cpu_util_percent": 99.56315789473685, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981635093688965, "policy_loss": -0.018554186448454857, "vf_loss": 10.0, "vf_explained_var": -5.47617666768474e-08, "kl": 0.02026699297130108, "entropy": 0.3866310715675354, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "sampler_results": {"episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}}, "episode_reward_max": 57763.45359039307, "episode_reward_min": 57763.45359039307, "episode_reward_mean": 57763.45359039307, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 57763.45359039307}, "policy_reward_max": {"agent_0": 57763.45359039307}, "policy_reward_mean": {"agent_0": 57763.45359039307}, "hist_stats": {"episode_reward": [57763.45359039307], "episode_lengths": [137], "policy_agent_0_reward": [57763.45359039307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.66637678592233, "mean_inference_ms": 6.944073988060664, "mean_action_processing_ms": 0.19379155235828685, "mean_env_wait_ms": 232.97104836066202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029587745666503906, "StateBufferConnector_ms": 0.0049591064453125, "ViewRequirementAgentConnector_ms": 0.13337135314941406}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000, "num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9648758393613, "num_env_steps_trained_throughput_per_sec": 323.9648758393613, "timesteps_total": 1084000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1084000, "timers": {"training_iteration_time_ms": 14103.25, "sample_time_ms": 11142.547, "learn_time_ms": 2820.604, "learn_throughput": 1418.136, "synch_weights_time_ms": 139.325}, "counters": {"num_env_steps_sampled": 1084000, "num_env_steps_trained": 1084000, "num_agent_steps_sampled": 1084000, "num_agent_steps_trained": 1084000}, "done": false, "episodes_total": 7876, "training_iteration": 271, "trial_id": "32397_00000", "date": "2025-03-21_09-42-28", "timestamp": 1742550148, "time_this_iter_s": 12.39938759803772, "time_total_s": 3908.313134431839, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96f80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3908.313134431839, "iterations_since_restore": 271, "perf": {"cpu_util_percent": 99.65294117647059, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.056910569105691, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.67601490020752, "policy_loss": -0.015364257618784904, "vf_loss": 9.691162109375, "vf_explained_var": -2.8684734587614003e-08, "kl": 0.015492405742406845, "entropy": 0.3803410232067108, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "sampler_results": {"episode_reward_max": 62370.83361816406, "episode_reward_min": 44301.94010305405, "episode_reward_mean": 55821.6501589604, "episode_len_mean": 135.85365853658536, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 44301.94010305405}, "policy_reward_max": {"agent_0": 62370.83361816406}, "policy_reward_mean": {"agent_0": 55821.6501589604}, "custom_metrics": {"num_batches_mean": 5.056910569105691, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58213.43338012695, 57955.76015472412, 52565.06023311615, 55176.86054483056, 58827.07350349426, 58832.92694854736, 55095.03997039795, 57814.64677810669, 60012.200340270996, 49868.26666742563, 57377.686935424805, 48267.35363483429, 56299.306743621826, 53066.76689338684, 47756.37340927124, 57984.70674133301, 50928.80666255951, 54955.25351333618, 59109.667194366455, 60581.00012207031, 44301.94010305405, 57965.78026199341, 57126.37325286865, 59345.44020843506, 52828.28680610657, 55316.493324279785, 50107.37357902527, 56629.76014709473, 51534.7869553566, 57228.386978149414, 52547.52023220062, 58630.75365829468, 55844.36701965332, 53767.48678588867, 58288.399978637695, 51596.72696685791, 53523.57361602783, 57515.91993331909, 57958.38708305359, 58308.05373382568, 56695.78037261963, 55594.24016571045, 59041.673416137695, 54692.900175094604, 58876.866760253906, 59810.55363845825, 54622.953540802, 57520.713399887085, 59581.86688232422, 57731.1736907959, 59288.54033279419, 51978.706844329834, 55541.106563568115, 59429.920349121094, 57597.91343688965, 57681.20681762695, 49148.720195770264, 55534.62026977539, 56615.573652267456, 59455.406967163086, 57755.60047912598, 47962.740050792694, 47552.01372349262, 57992.33369445801, 46209.29364681244, 49430.28005218506, 47910.613471508026, 58095.247020721436, 62370.83361816406, 57020.2001914978, 56319.44037818909, 60944.78659057617, 52220.293323516846, 58039.25355911255, 57879.360008239746, 51727.69353437424, 56432.70685386658, 57160.553634643555, 55119.58674621582, 57364.50004577637, 58411.806758880615, 53716.66678619385, 58556.93348312378, 57767.653606414795, 60457.41342163086, 56375.13316345215, 57719.533699035645, 57309.1201171875, 52515.900188446045, 56151.93328857422, 56738.56656074524, 57482.64017248154, 54567.02022743225, 56095.75350189209, 57426.94030761719, 59011.13996887207, 55846.36026763916, 56968.50679016113, 57564.48683166504, 57806.360290527344, 58381.48010253906, 53712.700063705444, 61977.90020751953, 52758.140332221985, 53454.84003448486, 55750.63353395462, 54092.18020629883, 57188.42026138306, 58973.373485565186, 58835.75360107422, 51268.2937207818, 59264.00042915344, 58399.26663970947, 53592.726877212524, 49701.2999792099, 56409.92027282715, 58554.1735534668, 57457.34712982178, 60854.69357299805, 49445.58665198088, 47474.25337409973, 58742.140060424805, 58282.206939697266], "episode_lengths": [136, 137, 136, 136, 137, 136, 135, 136, 138, 133, 137, 135, 135, 136, 134, 137, 136, 135, 138, 137, 134, 136, 137, 138, 135, 134, 136, 136, 136, 136, 135, 137, 135, 135, 136, 134, 134, 136, 137, 136, 136, 135, 136, 135, 136, 137, 137, 136, 137, 136, 137, 135, 135, 136, 135, 136, 134, 135, 136, 137, 136, 136, 134, 136, 135, 134, 134, 137, 138, 136, 135, 137, 134, 137, 136, 135, 136, 135, 136, 136, 137, 135, 136, 136, 137, 136, 136, 136, 135, 135, 137, 137, 136, 135, 136, 137, 136, 136, 136, 136, 136, 136, 138, 136, 134, 136, 135, 137, 137, 136, 135, 138, 136, 135, 135, 136, 136, 136, 137, 135, 134, 136, 136], "policy_agent_0_reward": [58213.43338012695, 57955.76015472412, 52565.06023311615, 55176.86054483056, 58827.07350349426, 58832.92694854736, 55095.03997039795, 57814.64677810669, 60012.200340270996, 49868.26666742563, 57377.686935424805, 48267.35363483429, 56299.306743621826, 53066.76689338684, 47756.37340927124, 57984.70674133301, 50928.80666255951, 54955.25351333618, 59109.667194366455, 60581.00012207031, 44301.94010305405, 57965.78026199341, 57126.37325286865, 59345.44020843506, 52828.28680610657, 55316.493324279785, 50107.37357902527, 56629.76014709473, 51534.7869553566, 57228.386978149414, 52547.52023220062, 58630.75365829468, 55844.36701965332, 53767.48678588867, 58288.399978637695, 51596.72696685791, 53523.57361602783, 57515.91993331909, 57958.38708305359, 58308.05373382568, 56695.78037261963, 55594.24016571045, 59041.673416137695, 54692.900175094604, 58876.866760253906, 59810.55363845825, 54622.953540802, 57520.713399887085, 59581.86688232422, 57731.1736907959, 59288.54033279419, 51978.706844329834, 55541.106563568115, 59429.920349121094, 57597.91343688965, 57681.20681762695, 49148.720195770264, 55534.62026977539, 56615.573652267456, 59455.406967163086, 57755.60047912598, 47962.740050792694, 47552.01372349262, 57992.33369445801, 46209.29364681244, 49430.28005218506, 47910.613471508026, 58095.247020721436, 62370.83361816406, 57020.2001914978, 56319.44037818909, 60944.78659057617, 52220.293323516846, 58039.25355911255, 57879.360008239746, 51727.69353437424, 56432.70685386658, 57160.553634643555, 55119.58674621582, 57364.50004577637, 58411.806758880615, 53716.66678619385, 58556.93348312378, 57767.653606414795, 60457.41342163086, 56375.13316345215, 57719.533699035645, 57309.1201171875, 52515.900188446045, 56151.93328857422, 56738.56656074524, 57482.64017248154, 54567.02022743225, 56095.75350189209, 57426.94030761719, 59011.13996887207, 55846.36026763916, 56968.50679016113, 57564.48683166504, 57806.360290527344, 58381.48010253906, 53712.700063705444, 61977.90020751953, 52758.140332221985, 53454.84003448486, 55750.63353395462, 54092.18020629883, 57188.42026138306, 58973.373485565186, 58835.75360107422, 51268.2937207818, 59264.00042915344, 58399.26663970947, 53592.726877212524, 49701.2999792099, 56409.92027282715, 58554.1735534668, 57457.34712982178, 60854.69357299805, 49445.58665198088, 47474.25337409973, 58742.140060424805, 58282.206939697266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.777021263360158, "mean_inference_ms": 6.650756316741601, "mean_action_processing_ms": 0.1966912884344498, "mean_env_wait_ms": 229.51075285614473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03845381542919128, "StateBufferConnector_ms": 0.005938560982060626, "ViewRequirementAgentConnector_ms": 0.19641155149878525}}, "episode_reward_max": 62370.83361816406, "episode_reward_min": 44301.94010305405, "episode_reward_mean": 55821.6501589604, "episode_len_mean": 135.85365853658536, "episodes_this_iter": 123, "policy_reward_min": {"agent_0": 44301.94010305405}, "policy_reward_max": {"agent_0": 62370.83361816406}, "policy_reward_mean": {"agent_0": 55821.6501589604}, "hist_stats": {"episode_reward": [58213.43338012695, 57955.76015472412, 52565.06023311615, 55176.86054483056, 58827.07350349426, 58832.92694854736, 55095.03997039795, 57814.64677810669, 60012.200340270996, 49868.26666742563, 57377.686935424805, 48267.35363483429, 56299.306743621826, 53066.76689338684, 47756.37340927124, 57984.70674133301, 50928.80666255951, 54955.25351333618, 59109.667194366455, 60581.00012207031, 44301.94010305405, 57965.78026199341, 57126.37325286865, 59345.44020843506, 52828.28680610657, 55316.493324279785, 50107.37357902527, 56629.76014709473, 51534.7869553566, 57228.386978149414, 52547.52023220062, 58630.75365829468, 55844.36701965332, 53767.48678588867, 58288.399978637695, 51596.72696685791, 53523.57361602783, 57515.91993331909, 57958.38708305359, 58308.05373382568, 56695.78037261963, 55594.24016571045, 59041.673416137695, 54692.900175094604, 58876.866760253906, 59810.55363845825, 54622.953540802, 57520.713399887085, 59581.86688232422, 57731.1736907959, 59288.54033279419, 51978.706844329834, 55541.106563568115, 59429.920349121094, 57597.91343688965, 57681.20681762695, 49148.720195770264, 55534.62026977539, 56615.573652267456, 59455.406967163086, 57755.60047912598, 47962.740050792694, 47552.01372349262, 57992.33369445801, 46209.29364681244, 49430.28005218506, 47910.613471508026, 58095.247020721436, 62370.83361816406, 57020.2001914978, 56319.44037818909, 60944.78659057617, 52220.293323516846, 58039.25355911255, 57879.360008239746, 51727.69353437424, 56432.70685386658, 57160.553634643555, 55119.58674621582, 57364.50004577637, 58411.806758880615, 53716.66678619385, 58556.93348312378, 57767.653606414795, 60457.41342163086, 56375.13316345215, 57719.533699035645, 57309.1201171875, 52515.900188446045, 56151.93328857422, 56738.56656074524, 57482.64017248154, 54567.02022743225, 56095.75350189209, 57426.94030761719, 59011.13996887207, 55846.36026763916, 56968.50679016113, 57564.48683166504, 57806.360290527344, 58381.48010253906, 53712.700063705444, 61977.90020751953, 52758.140332221985, 53454.84003448486, 55750.63353395462, 54092.18020629883, 57188.42026138306, 58973.373485565186, 58835.75360107422, 51268.2937207818, 59264.00042915344, 58399.26663970947, 53592.726877212524, 49701.2999792099, 56409.92027282715, 58554.1735534668, 57457.34712982178, 60854.69357299805, 49445.58665198088, 47474.25337409973, 58742.140060424805, 58282.206939697266], "episode_lengths": [136, 137, 136, 136, 137, 136, 135, 136, 138, 133, 137, 135, 135, 136, 134, 137, 136, 135, 138, 137, 134, 136, 137, 138, 135, 134, 136, 136, 136, 136, 135, 137, 135, 135, 136, 134, 134, 136, 137, 136, 136, 135, 136, 135, 136, 137, 137, 136, 137, 136, 137, 135, 135, 136, 135, 136, 134, 135, 136, 137, 136, 136, 134, 136, 135, 134, 134, 137, 138, 136, 135, 137, 134, 137, 136, 135, 136, 135, 136, 136, 137, 135, 136, 136, 137, 136, 136, 136, 135, 135, 137, 137, 136, 135, 136, 137, 136, 136, 136, 136, 136, 136, 138, 136, 134, 136, 135, 137, 137, 136, 135, 138, 136, 135, 135, 136, 136, 136, 137, 135, 134, 136, 136], "policy_agent_0_reward": [58213.43338012695, 57955.76015472412, 52565.06023311615, 55176.86054483056, 58827.07350349426, 58832.92694854736, 55095.03997039795, 57814.64677810669, 60012.200340270996, 49868.26666742563, 57377.686935424805, 48267.35363483429, 56299.306743621826, 53066.76689338684, 47756.37340927124, 57984.70674133301, 50928.80666255951, 54955.25351333618, 59109.667194366455, 60581.00012207031, 44301.94010305405, 57965.78026199341, 57126.37325286865, 59345.44020843506, 52828.28680610657, 55316.493324279785, 50107.37357902527, 56629.76014709473, 51534.7869553566, 57228.386978149414, 52547.52023220062, 58630.75365829468, 55844.36701965332, 53767.48678588867, 58288.399978637695, 51596.72696685791, 53523.57361602783, 57515.91993331909, 57958.38708305359, 58308.05373382568, 56695.78037261963, 55594.24016571045, 59041.673416137695, 54692.900175094604, 58876.866760253906, 59810.55363845825, 54622.953540802, 57520.713399887085, 59581.86688232422, 57731.1736907959, 59288.54033279419, 51978.706844329834, 55541.106563568115, 59429.920349121094, 57597.91343688965, 57681.20681762695, 49148.720195770264, 55534.62026977539, 56615.573652267456, 59455.406967163086, 57755.60047912598, 47962.740050792694, 47552.01372349262, 57992.33369445801, 46209.29364681244, 49430.28005218506, 47910.613471508026, 58095.247020721436, 62370.83361816406, 57020.2001914978, 56319.44037818909, 60944.78659057617, 52220.293323516846, 58039.25355911255, 57879.360008239746, 51727.69353437424, 56432.70685386658, 57160.553634643555, 55119.58674621582, 57364.50004577637, 58411.806758880615, 53716.66678619385, 58556.93348312378, 57767.653606414795, 60457.41342163086, 56375.13316345215, 57719.533699035645, 57309.1201171875, 52515.900188446045, 56151.93328857422, 56738.56656074524, 57482.64017248154, 54567.02022743225, 56095.75350189209, 57426.94030761719, 59011.13996887207, 55846.36026763916, 56968.50679016113, 57564.48683166504, 57806.360290527344, 58381.48010253906, 53712.700063705444, 61977.90020751953, 52758.140332221985, 53454.84003448486, 55750.63353395462, 54092.18020629883, 57188.42026138306, 58973.373485565186, 58835.75360107422, 51268.2937207818, 59264.00042915344, 58399.26663970947, 53592.726877212524, 49701.2999792099, 56409.92027282715, 58554.1735534668, 57457.34712982178, 60854.69357299805, 49445.58665198088, 47474.25337409973, 58742.140060424805, 58282.206939697266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.777021263360158, "mean_inference_ms": 6.650756316741601, "mean_action_processing_ms": 0.1966912884344498, "mean_env_wait_ms": 229.51075285614473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03845381542919128, "StateBufferConnector_ms": 0.005938560982060626, "ViewRequirementAgentConnector_ms": 0.19641155149878525}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.42468968843474, "num_env_steps_trained_throughput_per_sec": 228.42468968843474, "timesteps_total": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 14495.774, "sample_time_ms": 11568.34, "learn_time_ms": 2780.453, "learn_throughput": 1438.615, "synch_weights_time_ms": 146.218}, "counters": {"num_env_steps_sampled": 1088000, "num_env_steps_trained": 1088000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "episodes_total": 7999, "training_iteration": 272, "trial_id": "32397_00000", "date": "2025-03-21_09-42-45", "timestamp": 1742550165, "time_this_iter_s": 17.568775415420532, "time_total_s": 3925.8819098472595, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97d90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3925.8819098472595, "iterations_since_restore": 272, "perf": {"cpu_util_percent": 94.97500000000001, "ram_util_percent": 13.570833333333335}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985581398010254, "policy_loss": -0.012165137566626072, "vf_loss": 9.99755859375, "vf_explained_var": -2.5766590638909292e-08, "kl": 0.013318673707544804, "entropy": 0.3287745714187622, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}}, "episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episodes_this_iter": 1, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.5236163977754, "num_env_steps_trained_throughput_per_sec": 297.5236163977754, "timesteps_total": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 14451.385, "sample_time_ms": 11518.005, "learn_time_ms": 2790.387, "learn_throughput": 1433.493, "synch_weights_time_ms": 142.23}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 8000, "training_iteration": 273, "trial_id": "32397_00000", "date": "2025-03-21_09-42-59", "timestamp": 1742550179, "time_this_iter_s": 13.495182752609253, "time_total_s": 3939.377092599869, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c970a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3939.377092599869, "iterations_since_restore": 273, "perf": {"cpu_util_percent": 99.35499999999999, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985926628112793, "policy_loss": -0.014293058775365353, "vf_loss": 10.0, "vf_explained_var": 2.0240744191823978e-08, "kl": 0.015601515769958496, "entropy": 0.37723150849342346, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "sampler_results": {"episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}}, "episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000, "num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.69684904079486, "num_env_steps_trained_throughput_per_sec": 310.69684904079486, "timesteps_total": 1096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1096000, "timers": {"training_iteration_time_ms": 13886.154, "sample_time_ms": 10933.203, "learn_time_ms": 2811.44, "learn_throughput": 1422.758, "synch_weights_time_ms": 140.708}, "counters": {"num_env_steps_sampled": 1096000, "num_env_steps_trained": 1096000, "num_agent_steps_sampled": 1096000, "num_agent_steps_trained": 1096000}, "done": false, "episodes_total": 8000, "training_iteration": 274, "trial_id": "32397_00000", "date": "2025-03-21_09-43-12", "timestamp": 1742550192, "time_this_iter_s": 12.922370433807373, "time_total_s": 3952.299463033676, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97eb0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3952.299463033676, "iterations_since_restore": 274, "perf": {"cpu_util_percent": 99.56666666666666, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.9822359085083, "policy_loss": -0.017979074269533157, "vf_loss": 10.0, "vf_explained_var": -5.662441182607836e-08, "kl": 0.01527972798794508, "entropy": 0.4107065796852112, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "sampler_results": {"episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}}, "episode_reward_max": 59216.37341308594, "episode_reward_min": 59216.37341308594, "episode_reward_mean": 59216.37341308594, "episode_len_mean": 138.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 59216.37341308594}, "policy_reward_max": {"agent_0": 59216.37341308594}, "policy_reward_mean": {"agent_0": 59216.37341308594}, "hist_stats": {"episode_reward": [59216.37341308594], "episode_lengths": [138], "policy_agent_0_reward": [59216.37341308594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.7070285501968, "mean_inference_ms": 6.356167959733046, "mean_action_processing_ms": 0.19661900215895536, "mean_env_wait_ms": 228.47285043651593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030279159545898438, "StateBufferConnector_ms": 0.004506111145019531, "ViewRequirementAgentConnector_ms": 0.12843608856201172}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000, "num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.7708566004292, "num_env_steps_trained_throughput_per_sec": 313.7708566004292, "timesteps_total": 1100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1100000, "timers": {"training_iteration_time_ms": 13888.868, "sample_time_ms": 10942.767, "learn_time_ms": 2803.498, "learn_throughput": 1426.789, "synch_weights_time_ms": 141.809}, "counters": {"num_env_steps_sampled": 1100000, "num_env_steps_trained": 1100000, "num_agent_steps_sampled": 1100000, "num_agent_steps_trained": 1100000}, "done": false, "episodes_total": 8000, "training_iteration": 275, "trial_id": "32397_00000", "date": "2025-03-21_09-43-25", "timestamp": 1742550205, "time_this_iter_s": 12.796520233154297, "time_total_s": 3965.0959832668304, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3965.0959832668304, "iterations_since_restore": 275, "perf": {"cpu_util_percent": 99.61111111111111, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.708292961120605, "policy_loss": -0.010603132657706738, "vf_loss": 9.71875, "vf_explained_var": -3.80476308237121e-07, "kl": 0.010277262888848782, "entropy": 0.3518332540988922, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 62052.34009933472, "episode_reward_min": 45105.7666349411, "episode_reward_mean": 55689.824525595235, "episode_len_mean": 135.73451327433628, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {"agent_0": 45105.7666349411}, "policy_reward_max": {"agent_0": 62052.34009933472}, "policy_reward_mean": {"agent_0": 55689.824525595235}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [56201.14015197754, 60584.55369949341, 61455.71342468262, 55475.02683258057, 58555.19346618652, 61988.460510253906, 53520.10702896118, 58597.460037231445, 53805.19364738464, 56087.693444252014, 56686.71354675293, 58547.29345703125, 58914.52047729492, 56081.6600458622, 57579.88692474365, 61128.607360839844, 54859.093561172485, 45105.7666349411, 55749.54664230347, 55967.16679382324, 57258.226821899414, 54833.11351394653, 51414.1600151062, 51931.653641581535, 50850.653279304504, 54987.786906301975, 56808.586975097656, 60719.353454589844, 54817.04021644592, 60302.3801574707, 50474.359994888306, 55804.35987854004, 59497.87339782715, 57093.293380737305, 58034.906799316406, 52821.44714641571, 55120.22017669678, 50889.199998021126, 50546.820222854614, 58917.113525390625, 56437.95333623886, 53426.306858062744, 59684.8600769043, 53922.520288705826, 56074.233306884766, 54864.520151138306, 58268.50668334961, 53441.31350326538, 53101.49355792999, 54433.173358917236, 50000.03353500366, 46854.73341178894, 52587.693775177, 59054.020080566406, 57149.586921691895, 58708.60697937012, 48807.98658943176, 54877.653549194336, 56066.62684249878, 53933.10671424866, 54088.87355804443, 58259.200019836426, 60783.45346069336, 52869.180384874344, 57450.70666503906, 52773.42021560669, 58082.54010772705, 60356.126708984375, 61739.12026977539, 57852.793365478516, 56103.72668457031, 54615.28021621704, 57139.80010223389, 50019.86682212353, 56470.52000427246, 54108.986844062805, 60755.01360321045, 49700.16672706604, 49356.17344760895, 51918.91355705261, 55883.64012145996, 60844.48024940491, 60905.91340637207, 53610.84683227539, 54072.16030502319, 61115.660217285156, 49303.96002292633, 53377.22673034668, 56501.94676208496, 56962.18691635132, 57794.82014465332, 54146.246744155884, 58010.68674850464, 59133.66689300537, 54457.84684753418, 53242.26022744179, 48599.313549399376, 58834.05334472656, 55055.72015571594, 52701.567335128784, 59186.6669921875, 54311.50014615059, 56153.366846084595, 49160.3467798233, 56329.91349029541, 62052.34009933472, 50197.066799879074, 58362.42010116577, 55060.140186309814, 60276.58670043945, 56644.2801361084, 55330.19993305206, 59179.00015258789], "episode_lengths": [135, 137, 137, 136, 136, 138, 136, 136, 135, 136, 135, 136, 137, 135, 136, 138, 135, 134, 135, 135, 135, 136, 135, 136, 135, 135, 136, 137, 136, 137, 135, 135, 136, 136, 136, 136, 136, 134, 134, 136, 136, 136, 137, 136, 135, 136, 136, 136, 134, 135, 134, 134, 135, 136, 136, 136, 135, 134, 135, 134, 135, 135, 137, 136, 135, 136, 137, 136, 138, 136, 135, 135, 136, 134, 136, 135, 137, 135, 136, 135, 135, 137, 137, 134, 136, 137, 135, 135, 135, 136, 135, 135, 137, 136, 136, 136, 134, 135, 136, 136, 137, 136, 136, 136, 136, 138, 135, 137, 137, 137, 136, 137, 136], "policy_agent_0_reward": [56201.14015197754, 60584.55369949341, 61455.71342468262, 55475.02683258057, 58555.19346618652, 61988.460510253906, 53520.10702896118, 58597.460037231445, 53805.19364738464, 56087.693444252014, 56686.71354675293, 58547.29345703125, 58914.52047729492, 56081.6600458622, 57579.88692474365, 61128.607360839844, 54859.093561172485, 45105.7666349411, 55749.54664230347, 55967.16679382324, 57258.226821899414, 54833.11351394653, 51414.1600151062, 51931.653641581535, 50850.653279304504, 54987.786906301975, 56808.586975097656, 60719.353454589844, 54817.04021644592, 60302.3801574707, 50474.359994888306, 55804.35987854004, 59497.87339782715, 57093.293380737305, 58034.906799316406, 52821.44714641571, 55120.22017669678, 50889.199998021126, 50546.820222854614, 58917.113525390625, 56437.95333623886, 53426.306858062744, 59684.8600769043, 53922.520288705826, 56074.233306884766, 54864.520151138306, 58268.50668334961, 53441.31350326538, 53101.49355792999, 54433.173358917236, 50000.03353500366, 46854.73341178894, 52587.693775177, 59054.020080566406, 57149.586921691895, 58708.60697937012, 48807.98658943176, 54877.653549194336, 56066.62684249878, 53933.10671424866, 54088.87355804443, 58259.200019836426, 60783.45346069336, 52869.180384874344, 57450.70666503906, 52773.42021560669, 58082.54010772705, 60356.126708984375, 61739.12026977539, 57852.793365478516, 56103.72668457031, 54615.28021621704, 57139.80010223389, 50019.86682212353, 56470.52000427246, 54108.986844062805, 60755.01360321045, 49700.16672706604, 49356.17344760895, 51918.91355705261, 55883.64012145996, 60844.48024940491, 60905.91340637207, 53610.84683227539, 54072.16030502319, 61115.660217285156, 49303.96002292633, 53377.22673034668, 56501.94676208496, 56962.18691635132, 57794.82014465332, 54146.246744155884, 58010.68674850464, 59133.66689300537, 54457.84684753418, 53242.26022744179, 48599.313549399376, 58834.05334472656, 55055.72015571594, 52701.567335128784, 59186.6669921875, 54311.50014615059, 56153.366846084595, 49160.3467798233, 56329.91349029541, 62052.34009933472, 50197.066799879074, 58362.42010116577, 55060.140186309814, 60276.58670043945, 56644.2801361084, 55330.19993305206, 59179.00015258789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.3829853612962, "mean_inference_ms": 6.657088095710341, "mean_action_processing_ms": 0.1969017369311634, "mean_env_wait_ms": 229.55182154288968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04657791779104587, "StateBufferConnector_ms": 0.006014477890149682, "ViewRequirementAgentConnector_ms": 0.2035687455033834}}, "episode_reward_max": 62052.34009933472, "episode_reward_min": 45105.7666349411, "episode_reward_mean": 55689.824525595235, "episode_len_mean": 135.73451327433628, "episodes_this_iter": 113, "policy_reward_min": {"agent_0": 45105.7666349411}, "policy_reward_max": {"agent_0": 62052.34009933472}, "policy_reward_mean": {"agent_0": 55689.824525595235}, "hist_stats": {"episode_reward": [56201.14015197754, 60584.55369949341, 61455.71342468262, 55475.02683258057, 58555.19346618652, 61988.460510253906, 53520.10702896118, 58597.460037231445, 53805.19364738464, 56087.693444252014, 56686.71354675293, 58547.29345703125, 58914.52047729492, 56081.6600458622, 57579.88692474365, 61128.607360839844, 54859.093561172485, 45105.7666349411, 55749.54664230347, 55967.16679382324, 57258.226821899414, 54833.11351394653, 51414.1600151062, 51931.653641581535, 50850.653279304504, 54987.786906301975, 56808.586975097656, 60719.353454589844, 54817.04021644592, 60302.3801574707, 50474.359994888306, 55804.35987854004, 59497.87339782715, 57093.293380737305, 58034.906799316406, 52821.44714641571, 55120.22017669678, 50889.199998021126, 50546.820222854614, 58917.113525390625, 56437.95333623886, 53426.306858062744, 59684.8600769043, 53922.520288705826, 56074.233306884766, 54864.520151138306, 58268.50668334961, 53441.31350326538, 53101.49355792999, 54433.173358917236, 50000.03353500366, 46854.73341178894, 52587.693775177, 59054.020080566406, 57149.586921691895, 58708.60697937012, 48807.98658943176, 54877.653549194336, 56066.62684249878, 53933.10671424866, 54088.87355804443, 58259.200019836426, 60783.45346069336, 52869.180384874344, 57450.70666503906, 52773.42021560669, 58082.54010772705, 60356.126708984375, 61739.12026977539, 57852.793365478516, 56103.72668457031, 54615.28021621704, 57139.80010223389, 50019.86682212353, 56470.52000427246, 54108.986844062805, 60755.01360321045, 49700.16672706604, 49356.17344760895, 51918.91355705261, 55883.64012145996, 60844.48024940491, 60905.91340637207, 53610.84683227539, 54072.16030502319, 61115.660217285156, 49303.96002292633, 53377.22673034668, 56501.94676208496, 56962.18691635132, 57794.82014465332, 54146.246744155884, 58010.68674850464, 59133.66689300537, 54457.84684753418, 53242.26022744179, 48599.313549399376, 58834.05334472656, 55055.72015571594, 52701.567335128784, 59186.6669921875, 54311.50014615059, 56153.366846084595, 49160.3467798233, 56329.91349029541, 62052.34009933472, 50197.066799879074, 58362.42010116577, 55060.140186309814, 60276.58670043945, 56644.2801361084, 55330.19993305206, 59179.00015258789], "episode_lengths": [135, 137, 137, 136, 136, 138, 136, 136, 135, 136, 135, 136, 137, 135, 136, 138, 135, 134, 135, 135, 135, 136, 135, 136, 135, 135, 136, 137, 136, 137, 135, 135, 136, 136, 136, 136, 136, 134, 134, 136, 136, 136, 137, 136, 135, 136, 136, 136, 134, 135, 134, 134, 135, 136, 136, 136, 135, 134, 135, 134, 135, 135, 137, 136, 135, 136, 137, 136, 138, 136, 135, 135, 136, 134, 136, 135, 137, 135, 136, 135, 135, 137, 137, 134, 136, 137, 135, 135, 135, 136, 135, 135, 137, 136, 136, 136, 134, 135, 136, 136, 137, 136, 136, 136, 136, 138, 135, 137, 137, 137, 136, 137, 136], "policy_agent_0_reward": [56201.14015197754, 60584.55369949341, 61455.71342468262, 55475.02683258057, 58555.19346618652, 61988.460510253906, 53520.10702896118, 58597.460037231445, 53805.19364738464, 56087.693444252014, 56686.71354675293, 58547.29345703125, 58914.52047729492, 56081.6600458622, 57579.88692474365, 61128.607360839844, 54859.093561172485, 45105.7666349411, 55749.54664230347, 55967.16679382324, 57258.226821899414, 54833.11351394653, 51414.1600151062, 51931.653641581535, 50850.653279304504, 54987.786906301975, 56808.586975097656, 60719.353454589844, 54817.04021644592, 60302.3801574707, 50474.359994888306, 55804.35987854004, 59497.87339782715, 57093.293380737305, 58034.906799316406, 52821.44714641571, 55120.22017669678, 50889.199998021126, 50546.820222854614, 58917.113525390625, 56437.95333623886, 53426.306858062744, 59684.8600769043, 53922.520288705826, 56074.233306884766, 54864.520151138306, 58268.50668334961, 53441.31350326538, 53101.49355792999, 54433.173358917236, 50000.03353500366, 46854.73341178894, 52587.693775177, 59054.020080566406, 57149.586921691895, 58708.60697937012, 48807.98658943176, 54877.653549194336, 56066.62684249878, 53933.10671424866, 54088.87355804443, 58259.200019836426, 60783.45346069336, 52869.180384874344, 57450.70666503906, 52773.42021560669, 58082.54010772705, 60356.126708984375, 61739.12026977539, 57852.793365478516, 56103.72668457031, 54615.28021621704, 57139.80010223389, 50019.86682212353, 56470.52000427246, 54108.986844062805, 60755.01360321045, 49700.16672706604, 49356.17344760895, 51918.91355705261, 55883.64012145996, 60844.48024940491, 60905.91340637207, 53610.84683227539, 54072.16030502319, 61115.660217285156, 49303.96002292633, 53377.22673034668, 56501.94676208496, 56962.18691635132, 57794.82014465332, 54146.246744155884, 58010.68674850464, 59133.66689300537, 54457.84684753418, 53242.26022744179, 48599.313549399376, 58834.05334472656, 55055.72015571594, 52701.567335128784, 59186.6669921875, 54311.50014615059, 56153.366846084595, 49160.3467798233, 56329.91349029541, 62052.34009933472, 50197.066799879074, 58362.42010116577, 55060.140186309814, 60276.58670043945, 56644.2801361084, 55330.19993305206, 59179.00015258789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.3829853612962, "mean_inference_ms": 6.657088095710341, "mean_action_processing_ms": 0.1969017369311634, "mean_env_wait_ms": 229.55182154288968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04657791779104587, "StateBufferConnector_ms": 0.006014477890149682, "ViewRequirementAgentConnector_ms": 0.2035687455033834}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.88922747661167, "num_env_steps_trained_throughput_per_sec": 244.88922747661167, "timesteps_total": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 14204.148, "sample_time_ms": 11341.785, "learn_time_ms": 2723.008, "learn_throughput": 1468.964, "synch_weights_time_ms": 138.558}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 8113, "training_iteration": 276, "trial_id": "32397_00000", "date": "2025-03-21_09-43-41", "timestamp": 1742550221, "time_this_iter_s": 16.38734221458435, "time_total_s": 3981.483325481415, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3981.483325481415, "iterations_since_restore": 276, "perf": {"cpu_util_percent": 94.72727272727273, "ram_util_percent": 13.57727272727273}}
{"custom_metrics": {"num_batches_mean": 5.909090909090909, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.95740795135498, "policy_loss": -0.015246693044900894, "vf_loss": 9.972412109375, "vf_explained_var": 2.257525864024501e-07, "kl": 0.017236126586794853, "entropy": 0.36320698261260986, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "sampler_results": {"episode_reward_max": 60492.70031738281, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 56350.77709393068, "episode_len_mean": 136.0909090909091, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 60492.70031738281}, "policy_reward_mean": {"agent_0": 56350.77709393068}, "custom_metrics": {"num_batches_mean": 5.909090909090909, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58604.173725128174, 54137.00682878494, 55105.1734046936, 58768.31998825073, 59641.64659881592, 60492.70031738281, 59850.44012451172, 55375.11346435547, 53481.69996261597, 54491.42678833008, 49910.84683036804], "episode_lengths": [137, 136, 135, 137, 137, 137, 137, 135, 134, 136, 136], "policy_agent_0_reward": [58604.173725128174, 54137.00682878494, 55105.1734046936, 58768.31998825073, 59641.64659881592, 60492.70031738281, 59850.44012451172, 55375.11346435547, 53481.69996261597, 54491.42678833008, 49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.21957757859267, "mean_inference_ms": 6.5873379053787025, "mean_action_processing_ms": 0.19494854597310984, "mean_env_wait_ms": 228.17309654674827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044111772017045456, "StateBufferConnector_ms": 0.00649582255970348, "ViewRequirementAgentConnector_ms": 0.16775781458074396}}, "episode_reward_max": 60492.70031738281, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 56350.77709393068, "episode_len_mean": 136.0909090909091, "episodes_this_iter": 11, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 60492.70031738281}, "policy_reward_mean": {"agent_0": 56350.77709393068}, "hist_stats": {"episode_reward": [58604.173725128174, 54137.00682878494, 55105.1734046936, 58768.31998825073, 59641.64659881592, 60492.70031738281, 59850.44012451172, 55375.11346435547, 53481.69996261597, 54491.42678833008, 49910.84683036804], "episode_lengths": [137, 136, 135, 137, 137, 137, 137, 135, 134, 136, 136], "policy_agent_0_reward": [58604.173725128174, 54137.00682878494, 55105.1734046936, 58768.31998825073, 59641.64659881592, 60492.70031738281, 59850.44012451172, 55375.11346435547, 53481.69996261597, 54491.42678833008, 49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.21957757859267, "mean_inference_ms": 6.5873379053787025, "mean_action_processing_ms": 0.19494854597310984, "mean_env_wait_ms": 228.17309654674827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044111772017045456, "StateBufferConnector_ms": 0.00649582255970348, "ViewRequirementAgentConnector_ms": 0.16775781458074396}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000, "num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.38748795623553, "num_env_steps_trained_throughput_per_sec": 281.38748795623553, "timesteps_total": 1108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1108000, "timers": {"training_iteration_time_ms": 14382.795, "sample_time_ms": 11456.078, "learn_time_ms": 2777.301, "learn_throughput": 1440.247, "synch_weights_time_ms": 148.627}, "counters": {"num_env_steps_sampled": 1108000, "num_env_steps_trained": 1108000, "num_agent_steps_sampled": 1108000, "num_agent_steps_trained": 1108000}, "done": false, "episodes_total": 8124, "training_iteration": 277, "trial_id": "32397_00000", "date": "2025-03-21_09-43-56", "timestamp": 1742550236, "time_this_iter_s": 14.268130540847778, "time_total_s": 3995.7514560222626, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c970a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 3995.7514560222626, "iterations_since_restore": 277, "perf": {"cpu_util_percent": 99.455, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.98143482208252, "policy_loss": -0.013636437244713306, "vf_loss": 9.994873046875, "vf_explained_var": -8.630255621255856e-09, "kl": 0.01414632797241211, "entropy": 0.34044724702835083, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "sampler_results": {"episode_reward_max": 49910.84683036804, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 49910.84683036804, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 49910.84683036804}, "policy_reward_mean": {"agent_0": 49910.84683036804}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49910.84683036804], "episode_lengths": [136], "policy_agent_0_reward": [49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.23677945769042, "mean_inference_ms": 7.104915612441836, "mean_action_processing_ms": 0.20264573374241002, "mean_env_wait_ms": 227.77629484917844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821849822998047, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16219615936279297}}, "episode_reward_max": 49910.84683036804, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 49910.84683036804, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 49910.84683036804}, "policy_reward_mean": {"agent_0": 49910.84683036804}, "hist_stats": {"episode_reward": [49910.84683036804], "episode_lengths": [136], "policy_agent_0_reward": [49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.23677945769042, "mean_inference_ms": 7.104915612441836, "mean_action_processing_ms": 0.20264573374241002, "mean_env_wait_ms": 227.77629484917844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821849822998047, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16219615936279297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000, "num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.0029204599633, "num_env_steps_trained_throughput_per_sec": 306.0029204599633, "timesteps_total": 1112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1112000, "timers": {"training_iteration_time_ms": 13878.3, "sample_time_ms": 10900.036, "learn_time_ms": 2826.095, "learn_throughput": 1415.381, "synch_weights_time_ms": 151.374}, "counters": {"num_env_steps_sampled": 1112000, "num_env_steps_trained": 1112000, "num_agent_steps_sampled": 1112000, "num_agent_steps_trained": 1112000}, "done": false, "episodes_total": 8124, "training_iteration": 278, "trial_id": "32397_00000", "date": "2025-03-21_09-44-09", "timestamp": 1742550249, "time_this_iter_s": 13.128810167312622, "time_total_s": 4008.880266189575, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4008.880266189575, "iterations_since_restore": 278, "perf": {"cpu_util_percent": 99.63684210526317, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987273216247559, "policy_loss": -0.012939977459609509, "vf_loss": 10.0, "vf_explained_var": -6.767610472024899e-08, "kl": 0.015163605101406574, "entropy": 0.3554994463920593, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 49910.84683036804, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 49910.84683036804, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 49910.84683036804}, "policy_reward_mean": {"agent_0": 49910.84683036804}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49910.84683036804], "episode_lengths": [136], "policy_agent_0_reward": [49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.23677945769042, "mean_inference_ms": 7.104915612441836, "mean_action_processing_ms": 0.20264573374241002, "mean_env_wait_ms": 227.77629484917844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821849822998047, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16219615936279297}}, "episode_reward_max": 49910.84683036804, "episode_reward_min": 49910.84683036804, "episode_reward_mean": 49910.84683036804, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 49910.84683036804}, "policy_reward_max": {"agent_0": 49910.84683036804}, "policy_reward_mean": {"agent_0": 49910.84683036804}, "hist_stats": {"episode_reward": [49910.84683036804], "episode_lengths": [136], "policy_agent_0_reward": [49910.84683036804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.23677945769042, "mean_inference_ms": 7.104915612441836, "mean_action_processing_ms": 0.20264573374241002, "mean_env_wait_ms": 227.77629484917844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821849822998047, "StateBufferConnector_ms": 0.0060558319091796875, "ViewRequirementAgentConnector_ms": 0.16219615936279297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.162086360953, "num_env_steps_trained_throughput_per_sec": 297.162086360953, "timesteps_total": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 13904.694, "sample_time_ms": 10907.939, "learn_time_ms": 2842.027, "learn_throughput": 1407.446, "synch_weights_time_ms": 153.935}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 8124, "training_iteration": 279, "trial_id": "32397_00000", "date": "2025-03-21_09-44-22", "timestamp": 1742550262, "time_this_iter_s": 13.510164022445679, "time_total_s": 4022.390430212021, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be1090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4022.390430212021, "iterations_since_restore": 279, "perf": {"cpu_util_percent": 99.53157894736844, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.777582168579102, "policy_loss": -0.014103681780397892, "vf_loss": 9.79150390625, "vf_explained_var": -1.4627973143888084e-07, "kl": 0.012905389070510864, "entropy": 0.35089582204818726, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "sampler_results": {"episode_reward_max": 62157.40050506592, "episode_reward_min": 46286.786806464195, "episode_reward_mean": 56206.14691454172, "episode_len_mean": 135.74698795180723, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {"agent_0": 46286.786806464195}, "policy_reward_max": {"agent_0": 62157.40050506592}, "policy_reward_mean": {"agent_0": 56206.14691454172}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54432.18671417236, 60468.91355895996, 52828.03340816498, 55162.88656997681, 50858.67329406738, 53532.42014884949, 57470.80006027222, 57704.16669845581, 54739.45339298248, 57533.640197753906, 58222.47344970703, 58632.96701049805, 58633.393604278564, 56183.90702056885, 55447.99351787567, 57039.96683883667, 59388.15336608887, 54034.586747169495, 60264.266914367676, 49841.593505859375, 61735.79382324219, 55227.08677864075, 58769.90019226074, 49473.7598657608, 56084.200194358826, 58194.02687072754, 56836.66053009033, 51069.000106573105, 59176.17346954346, 51958.699942588806, 61213.36047363281, 61542.07354736328, 56996.066732406616, 56529.12016296387, 60262.6999130249, 57661.74678039551, 61222.300537109375, 50092.460218429565, 56219.82004928589, 59527.48030471802, 58649.9737701416, 50102.993463516235, 57336.12692260742, 50663.95340156555, 54315.17361831665, 55177.27342605591, 59942.313537597656, 57677.873710632324, 54017.92007446289, 56976.90687561035, 59962.23994064331, 52081.340196967125, 57663.44016647339, 59138.69334793091, 60589.82696533203, 56026.786657333374, 55704.06688642502, 60437.7734375, 53692.453607559204, 57020.11371231079, 56907.993476867676, 54639.393350601196, 55112.79350280762, 59051.606842041016, 47134.90024280548, 57435.99346160889, 60596.68695640564, 57341.14042663574, 59531.94006729126, 58645.33346557617, 58996.95365524292, 57339.03333282471, 46286.786806464195, 55928.01336288452, 62157.40050506592, 58821.27345275879, 51977.88007736206, 58296.320251464844, 48420.48011600971, 55552.97994571924, 50569.460053920746, 55304.640239715576, 49671.04008388519], "episode_lengths": [136, 137, 135, 135, 133, 136, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 137, 136, 136, 133, 137, 135, 136, 135, 135, 136, 137, 135, 136, 134, 137, 138, 136, 135, 136, 136, 137, 134, 136, 136, 136, 135, 135, 135, 137, 135, 136, 137, 135, 135, 137, 136, 137, 137, 136, 136, 135, 137, 136, 136, 136, 135, 135, 136, 133, 136, 137, 135, 137, 137, 136, 135, 134, 135, 138, 136, 135, 136, 134, 136, 136, 134, 135], "policy_agent_0_reward": [54432.18671417236, 60468.91355895996, 52828.03340816498, 55162.88656997681, 50858.67329406738, 53532.42014884949, 57470.80006027222, 57704.16669845581, 54739.45339298248, 57533.640197753906, 58222.47344970703, 58632.96701049805, 58633.393604278564, 56183.90702056885, 55447.99351787567, 57039.96683883667, 59388.15336608887, 54034.586747169495, 60264.266914367676, 49841.593505859375, 61735.79382324219, 55227.08677864075, 58769.90019226074, 49473.7598657608, 56084.200194358826, 58194.02687072754, 56836.66053009033, 51069.000106573105, 59176.17346954346, 51958.699942588806, 61213.36047363281, 61542.07354736328, 56996.066732406616, 56529.12016296387, 60262.6999130249, 57661.74678039551, 61222.300537109375, 50092.460218429565, 56219.82004928589, 59527.48030471802, 58649.9737701416, 50102.993463516235, 57336.12692260742, 50663.95340156555, 54315.17361831665, 55177.27342605591, 59942.313537597656, 57677.873710632324, 54017.92007446289, 56976.90687561035, 59962.23994064331, 52081.340196967125, 57663.44016647339, 59138.69334793091, 60589.82696533203, 56026.786657333374, 55704.06688642502, 60437.7734375, 53692.453607559204, 57020.11371231079, 56907.993476867676, 54639.393350601196, 55112.79350280762, 59051.606842041016, 47134.90024280548, 57435.99346160889, 60596.68695640564, 57341.14042663574, 59531.94006729126, 58645.33346557617, 58996.95365524292, 57339.03333282471, 46286.786806464195, 55928.01336288452, 62157.40050506592, 58821.27345275879, 51977.88007736206, 58296.320251464844, 48420.48011600971, 55552.97994571924, 50569.460053920746, 55304.640239715576, 49671.04008388519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.941320527412618, "mean_inference_ms": 6.609259780926168, "mean_action_processing_ms": 0.19690089838054015, "mean_env_wait_ms": 229.08905258686227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04218744944377118, "StateBufferConnector_ms": 0.006063013191682747, "ViewRequirementAgentConnector_ms": 0.1889495964509895}}, "episode_reward_max": 62157.40050506592, "episode_reward_min": 46286.786806464195, "episode_reward_mean": 56206.14691454172, "episode_len_mean": 135.74698795180723, "episodes_this_iter": 83, "policy_reward_min": {"agent_0": 46286.786806464195}, "policy_reward_max": {"agent_0": 62157.40050506592}, "policy_reward_mean": {"agent_0": 56206.14691454172}, "hist_stats": {"episode_reward": [54432.18671417236, 60468.91355895996, 52828.03340816498, 55162.88656997681, 50858.67329406738, 53532.42014884949, 57470.80006027222, 57704.16669845581, 54739.45339298248, 57533.640197753906, 58222.47344970703, 58632.96701049805, 58633.393604278564, 56183.90702056885, 55447.99351787567, 57039.96683883667, 59388.15336608887, 54034.586747169495, 60264.266914367676, 49841.593505859375, 61735.79382324219, 55227.08677864075, 58769.90019226074, 49473.7598657608, 56084.200194358826, 58194.02687072754, 56836.66053009033, 51069.000106573105, 59176.17346954346, 51958.699942588806, 61213.36047363281, 61542.07354736328, 56996.066732406616, 56529.12016296387, 60262.6999130249, 57661.74678039551, 61222.300537109375, 50092.460218429565, 56219.82004928589, 59527.48030471802, 58649.9737701416, 50102.993463516235, 57336.12692260742, 50663.95340156555, 54315.17361831665, 55177.27342605591, 59942.313537597656, 57677.873710632324, 54017.92007446289, 56976.90687561035, 59962.23994064331, 52081.340196967125, 57663.44016647339, 59138.69334793091, 60589.82696533203, 56026.786657333374, 55704.06688642502, 60437.7734375, 53692.453607559204, 57020.11371231079, 56907.993476867676, 54639.393350601196, 55112.79350280762, 59051.606842041016, 47134.90024280548, 57435.99346160889, 60596.68695640564, 57341.14042663574, 59531.94006729126, 58645.33346557617, 58996.95365524292, 57339.03333282471, 46286.786806464195, 55928.01336288452, 62157.40050506592, 58821.27345275879, 51977.88007736206, 58296.320251464844, 48420.48011600971, 55552.97994571924, 50569.460053920746, 55304.640239715576, 49671.04008388519], "episode_lengths": [136, 137, 135, 135, 133, 136, 136, 136, 136, 136, 136, 136, 137, 136, 135, 136, 137, 136, 136, 133, 137, 135, 136, 135, 135, 136, 137, 135, 136, 134, 137, 138, 136, 135, 136, 136, 137, 134, 136, 136, 136, 135, 135, 135, 137, 135, 136, 137, 135, 135, 137, 136, 137, 137, 136, 136, 135, 137, 136, 136, 136, 135, 135, 136, 133, 136, 137, 135, 137, 137, 136, 135, 134, 135, 138, 136, 135, 136, 134, 136, 136, 134, 135], "policy_agent_0_reward": [54432.18671417236, 60468.91355895996, 52828.03340816498, 55162.88656997681, 50858.67329406738, 53532.42014884949, 57470.80006027222, 57704.16669845581, 54739.45339298248, 57533.640197753906, 58222.47344970703, 58632.96701049805, 58633.393604278564, 56183.90702056885, 55447.99351787567, 57039.96683883667, 59388.15336608887, 54034.586747169495, 60264.266914367676, 49841.593505859375, 61735.79382324219, 55227.08677864075, 58769.90019226074, 49473.7598657608, 56084.200194358826, 58194.02687072754, 56836.66053009033, 51069.000106573105, 59176.17346954346, 51958.699942588806, 61213.36047363281, 61542.07354736328, 56996.066732406616, 56529.12016296387, 60262.6999130249, 57661.74678039551, 61222.300537109375, 50092.460218429565, 56219.82004928589, 59527.48030471802, 58649.9737701416, 50102.993463516235, 57336.12692260742, 50663.95340156555, 54315.17361831665, 55177.27342605591, 59942.313537597656, 57677.873710632324, 54017.92007446289, 56976.90687561035, 59962.23994064331, 52081.340196967125, 57663.44016647339, 59138.69334793091, 60589.82696533203, 56026.786657333374, 55704.06688642502, 60437.7734375, 53692.453607559204, 57020.11371231079, 56907.993476867676, 54639.393350601196, 55112.79350280762, 59051.606842041016, 47134.90024280548, 57435.99346160889, 60596.68695640564, 57341.14042663574, 59531.94006729126, 58645.33346557617, 58996.95365524292, 57339.03333282471, 46286.786806464195, 55928.01336288452, 62157.40050506592, 58821.27345275879, 51977.88007736206, 58296.320251464844, 48420.48011600971, 55552.97994571924, 50569.460053920746, 55304.640239715576, 49671.04008388519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.941320527412618, "mean_inference_ms": 6.609259780926168, "mean_action_processing_ms": 0.19690089838054015, "mean_env_wait_ms": 229.08905258686227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04218744944377118, "StateBufferConnector_ms": 0.006063013191682747, "ViewRequirementAgentConnector_ms": 0.1889495964509895}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.35601431382486, "num_env_steps_trained_throughput_per_sec": 265.35601431382486, "timesteps_total": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 14108.024, "sample_time_ms": 11155.203, "learn_time_ms": 2802.309, "learn_throughput": 1427.395, "synch_weights_time_ms": 149.733}, "counters": {"num_env_steps_sampled": 1120000, "num_env_steps_trained": 1120000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "episodes_total": 8207, "training_iteration": 280, "trial_id": "32397_00000", "date": "2025-03-21_09-44-37", "timestamp": 1742550277, "time_this_iter_s": 15.129711151123047, "time_total_s": 4037.520141363144, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be36d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4037.520141363144, "iterations_since_restore": 280, "perf": {"cpu_util_percent": 97.16666666666667, "ram_util_percent": 13.595238095238098}}
{"custom_metrics": {"num_batches_mean": 5.634146341463414, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.885614395141602, "policy_loss": -0.01275709830224514, "vf_loss": 9.898193359375, "vf_explained_var": 7.50645980929221e-08, "kl": 0.01264925766736269, "entropy": 0.3568924367427826, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "sampler_results": {"episode_reward_max": 61758.75387573242, "episode_reward_min": 44472.686718940735, "episode_reward_mean": 55707.128144102855, "episode_len_mean": 135.70731707317074, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {"agent_0": 44472.686718940735}, "policy_reward_max": {"agent_0": 61758.75387573242}, "policy_reward_mean": {"agent_0": 55707.128144102855}, "custom_metrics": {"num_batches_mean": 5.634146341463414, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [55144.0867729187, 50794.573247909546, 58912.00686645508, 55741.88688516617, 49265.64680671692, 57094.92008781433, 60530.20690917969, 57496.513385772705, 56537.59339904785, 53303.18006134033, 51352.39353179932, 61758.75387573242, 57410.11343383789, 48801.23353487253, 57023.16664505005, 57384.013538360596, 59301.16018676758, 57732.35339355469, 57073.30015563965, 56379.886768341064, 54405.900161743164, 52700.706996917725, 56261.580139160156, 49189.573534965515, 58448.68690490723, 59318.01364898682, 58939.2338180542, 60717.26696777344, 58674.82032775879, 53791.54024362564, 57121.04036140442, 53094.313373565674, 60483.30685424805, 58369.833557128906, 52981.566734313965, 53073.90003871918, 44472.686718940735, 57345.80030822754, 58024.37989807129, 53007.4469909668, 54533.66684246063], "episode_lengths": [135, 135, 136, 136, 134, 136, 137, 136, 136, 135, 135, 137, 136, 134, 136, 136, 136, 137, 136, 136, 135, 135, 135, 136, 136, 137, 136, 137, 136, 136, 137, 134, 137, 136, 136, 135, 133, 135, 136, 135, 136], "policy_agent_0_reward": [55144.0867729187, 50794.573247909546, 58912.00686645508, 55741.88688516617, 49265.64680671692, 57094.92008781433, 60530.20690917969, 57496.513385772705, 56537.59339904785, 53303.18006134033, 51352.39353179932, 61758.75387573242, 57410.11343383789, 48801.23353487253, 57023.16664505005, 57384.013538360596, 59301.16018676758, 57732.35339355469, 57073.30015563965, 56379.886768341064, 54405.900161743164, 52700.706996917725, 56261.580139160156, 49189.573534965515, 58448.68690490723, 59318.01364898682, 58939.2338180542, 60717.26696777344, 58674.82032775879, 53791.54024362564, 57121.04036140442, 53094.313373565674, 60483.30685424805, 58369.833557128906, 52981.566734313965, 53073.90003871918, 44472.686718940735, 57345.80030822754, 58024.37989807129, 53007.4469909668, 54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.657335622755056, "mean_inference_ms": 6.744087888797486, "mean_action_processing_ms": 0.1963465077305259, "mean_env_wait_ms": 230.15132790832618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03924311661138767, "StateBufferConnector_ms": 0.005915106796636814, "ViewRequirementAgentConnector_ms": 0.20339779737519054}}, "episode_reward_max": 61758.75387573242, "episode_reward_min": 44472.686718940735, "episode_reward_mean": 55707.128144102855, "episode_len_mean": 135.70731707317074, "episodes_this_iter": 41, "policy_reward_min": {"agent_0": 44472.686718940735}, "policy_reward_max": {"agent_0": 61758.75387573242}, "policy_reward_mean": {"agent_0": 55707.128144102855}, "hist_stats": {"episode_reward": [55144.0867729187, 50794.573247909546, 58912.00686645508, 55741.88688516617, 49265.64680671692, 57094.92008781433, 60530.20690917969, 57496.513385772705, 56537.59339904785, 53303.18006134033, 51352.39353179932, 61758.75387573242, 57410.11343383789, 48801.23353487253, 57023.16664505005, 57384.013538360596, 59301.16018676758, 57732.35339355469, 57073.30015563965, 56379.886768341064, 54405.900161743164, 52700.706996917725, 56261.580139160156, 49189.573534965515, 58448.68690490723, 59318.01364898682, 58939.2338180542, 60717.26696777344, 58674.82032775879, 53791.54024362564, 57121.04036140442, 53094.313373565674, 60483.30685424805, 58369.833557128906, 52981.566734313965, 53073.90003871918, 44472.686718940735, 57345.80030822754, 58024.37989807129, 53007.4469909668, 54533.66684246063], "episode_lengths": [135, 135, 136, 136, 134, 136, 137, 136, 136, 135, 135, 137, 136, 134, 136, 136, 136, 137, 136, 136, 135, 135, 135, 136, 136, 137, 136, 137, 136, 136, 137, 134, 137, 136, 136, 135, 133, 135, 136, 135, 136], "policy_agent_0_reward": [55144.0867729187, 50794.573247909546, 58912.00686645508, 55741.88688516617, 49265.64680671692, 57094.92008781433, 60530.20690917969, 57496.513385772705, 56537.59339904785, 53303.18006134033, 51352.39353179932, 61758.75387573242, 57410.11343383789, 48801.23353487253, 57023.16664505005, 57384.013538360596, 59301.16018676758, 57732.35339355469, 57073.30015563965, 56379.886768341064, 54405.900161743164, 52700.706996917725, 56261.580139160156, 49189.573534965515, 58448.68690490723, 59318.01364898682, 58939.2338180542, 60717.26696777344, 58674.82032775879, 53791.54024362564, 57121.04036140442, 53094.313373565674, 60483.30685424805, 58369.833557128906, 52981.566734313965, 53073.90003871918, 44472.686718940735, 57345.80030822754, 58024.37989807129, 53007.4469909668, 54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.657335622755056, "mean_inference_ms": 6.744087888797486, "mean_action_processing_ms": 0.1963465077305259, "mean_env_wait_ms": 230.15132790832618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03924311661138767, "StateBufferConnector_ms": 0.005915106796636814, "ViewRequirementAgentConnector_ms": 0.20339779737519054}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000, "num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.19827407989143, "num_env_steps_trained_throughput_per_sec": 230.19827407989143, "timesteps_total": 1124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1124000, "timers": {"training_iteration_time_ms": 14610.956, "sample_time_ms": 11659.787, "learn_time_ms": 2798.998, "learn_throughput": 1429.083, "synch_weights_time_ms": 151.48}, "counters": {"num_env_steps_sampled": 1124000, "num_env_steps_trained": 1124000, "num_agent_steps_sampled": 1124000, "num_agent_steps_trained": 1124000}, "done": false, "episodes_total": 8248, "training_iteration": 281, "trial_id": "32397_00000", "date": "2025-03-21_09-44-55", "timestamp": 1742550295, "time_this_iter_s": 17.42531967163086, "time_total_s": 4054.945461034775, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ed79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4054.945461034775, "iterations_since_restore": 281, "perf": {"cpu_util_percent": 99.05454545454546, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981836318969727, "policy_loss": -0.01839211769402027, "vf_loss": 10.0, "vf_explained_var": -1.1175870895385742e-08, "kl": 0.01625610515475273, "entropy": 0.3658985197544098, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 54533.66684246063, "episode_reward_min": 54533.66684246063, "episode_reward_mean": 54533.66684246063, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54533.66684246063}, "policy_reward_max": {"agent_0": 54533.66684246063}, "policy_reward_mean": {"agent_0": 54533.66684246063}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54533.66684246063], "episode_lengths": [136], "policy_agent_0_reward": [54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.094700141278096, "mean_inference_ms": 6.942937176073537, "mean_action_processing_ms": 0.19405453644935644, "mean_env_wait_ms": 232.7785723919626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038051605224609375, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.18050670623779297}}, "episode_reward_max": 54533.66684246063, "episode_reward_min": 54533.66684246063, "episode_reward_mean": 54533.66684246063, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54533.66684246063}, "policy_reward_max": {"agent_0": 54533.66684246063}, "policy_reward_mean": {"agent_0": 54533.66684246063}, "hist_stats": {"episode_reward": [54533.66684246063], "episode_lengths": [136], "policy_agent_0_reward": [54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.094700141278096, "mean_inference_ms": 6.942937176073537, "mean_action_processing_ms": 0.19405453644935644, "mean_env_wait_ms": 232.7785723919626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038051605224609375, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.18050670623779297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.62120219856916, "num_env_steps_trained_throughput_per_sec": 293.62120219856916, "timesteps_total": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 14222.135, "sample_time_ms": 11212.766, "learn_time_ms": 2863.171, "learn_throughput": 1397.052, "synch_weights_time_ms": 145.506}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 8248, "training_iteration": 282, "trial_id": "32397_00000", "date": "2025-03-21_09-45-09", "timestamp": 1742550309, "time_this_iter_s": 13.669929504394531, "time_total_s": 4068.6153905391693, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4068.6153905391693, "iterations_since_restore": 282, "perf": {"cpu_util_percent": 99.665, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.982258796691895, "policy_loss": -0.017964953556656837, "vf_loss": 10.0, "vf_explained_var": 4.867712632972143e-08, "kl": 0.01598522812128067, "entropy": 0.36915817856788635, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "sampler_results": {"episode_reward_max": 54533.66684246063, "episode_reward_min": 54533.66684246063, "episode_reward_mean": 54533.66684246063, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54533.66684246063}, "policy_reward_max": {"agent_0": 54533.66684246063}, "policy_reward_mean": {"agent_0": 54533.66684246063}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [54533.66684246063], "episode_lengths": [136], "policy_agent_0_reward": [54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.094700141278096, "mean_inference_ms": 6.942937176073537, "mean_action_processing_ms": 0.19405453644935644, "mean_env_wait_ms": 232.7785723919626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038051605224609375, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.18050670623779297}}, "episode_reward_max": 54533.66684246063, "episode_reward_min": 54533.66684246063, "episode_reward_mean": 54533.66684246063, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54533.66684246063}, "policy_reward_max": {"agent_0": 54533.66684246063}, "policy_reward_mean": {"agent_0": 54533.66684246063}, "hist_stats": {"episode_reward": [54533.66684246063], "episode_lengths": [136], "policy_agent_0_reward": [54533.66684246063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.094700141278096, "mean_inference_ms": 6.942937176073537, "mean_action_processing_ms": 0.19405453644935644, "mean_env_wait_ms": 232.7785723919626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038051605224609375, "StateBufferConnector_ms": 0.005626678466796875, "ViewRequirementAgentConnector_ms": 0.18050670623779297}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000, "num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.0816391238428, "num_env_steps_trained_throughput_per_sec": 315.0816391238428, "timesteps_total": 1132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1132000, "timers": {"training_iteration_time_ms": 14147.218, "sample_time_ms": 11100.467, "learn_time_ms": 2895.008, "learn_throughput": 1381.689, "synch_weights_time_ms": 151.056}, "counters": {"num_env_steps_sampled": 1132000, "num_env_steps_trained": 1132000, "num_agent_steps_sampled": 1132000, "num_agent_steps_trained": 1132000}, "done": false, "episodes_total": 8248, "training_iteration": 283, "trial_id": "32397_00000", "date": "2025-03-21_09-45-21", "timestamp": 1742550321, "time_this_iter_s": 12.753848791122437, "time_total_s": 4081.3692393302917, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f6aafd00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4081.3692393302917, "iterations_since_restore": 283, "perf": {"cpu_util_percent": 99.61111111111111, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.875171661376953, "policy_loss": -0.015391916036605835, "vf_loss": 9.890380859375, "vf_explained_var": -5.6003532478143825e-08, "kl": 0.013017036952078342, "entropy": 0.3572697043418884, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "sampler_results": {"episode_reward_max": 62024.32693481445, "episode_reward_min": 49337.31346154213, "episode_reward_mean": 55459.643490447575, "episode_len_mean": 135.5, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {"agent_0": 49337.31346154213}, "policy_reward_max": {"agent_0": 62024.32693481445}, "policy_reward_mean": {"agent_0": 55459.643490447575}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [52955.84687805176, 59122.36003112793, 55401.68017959595, 54476.720041275024, 51641.20018005371, 53623.953481674194, 54041.91351903975, 55650.107006073, 59502.773529052734, 59435.826442718506, 62024.32693481445, 59148.08708190918, 53559.14668083191, 61100.666931152344, 55570.53370475769, 57214.10047912598, 55931.613414764404, 58062.253774642944, 54501.380084991455, 53476.56673622131, 57107.69338989258, 52365.74026584625, 55588.500175476074, 61647.20684814453, 54097.66676020622, 55811.37982940674, 56999.126625061035, 52111.73352432251, 53856.60679399967, 56538.89353942871, 56035.55995178223, 53710.92011773586, 58694.10688972473, 58595.18696594238, 52413.527030944824, 50570.62010097504, 56246.4801940918, 49425.25334978104, 49337.31346154213, 51826.45339393616, 57809.84006500244, 55495.49354171753, 54612.98013305664, 52884.97351980209], "episode_lengths": [135, 137, 136, 135, 135, 135, 134, 136, 136, 137, 138, 136, 135, 137, 136, 136, 135, 137, 136, 135, 135, 135, 134, 138, 136, 134, 135, 134, 135, 136, 135, 136, 137, 137, 136, 134, 135, 133, 135, 135, 136, 135, 134, 135], "policy_agent_0_reward": [52955.84687805176, 59122.36003112793, 55401.68017959595, 54476.720041275024, 51641.20018005371, 53623.953481674194, 54041.91351903975, 55650.107006073, 59502.773529052734, 59435.826442718506, 62024.32693481445, 59148.08708190918, 53559.14668083191, 61100.666931152344, 55570.53370475769, 57214.10047912598, 55931.613414764404, 58062.253774642944, 54501.380084991455, 53476.56673622131, 57107.69338989258, 52365.74026584625, 55588.500175476074, 61647.20684814453, 54097.66676020622, 55811.37982940674, 56999.126625061035, 52111.73352432251, 53856.60679399967, 56538.89353942871, 56035.55995178223, 53710.92011773586, 58694.10688972473, 58595.18696594238, 52413.527030944824, 50570.62010097504, 56246.4801940918, 49425.25334978104, 49337.31346154213, 51826.45339393616, 57809.84006500244, 55495.49354171753, 54612.98013305664, 52884.97351980209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.93921104650958, "mean_inference_ms": 6.536892859554279, "mean_action_processing_ms": 0.19803207577788526, "mean_env_wait_ms": 226.29125668863506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058219107714566315, "StateBufferConnector_ms": 0.006176666779951615, "ViewRequirementAgentConnector_ms": 0.30650279738686304}}, "episode_reward_max": 62024.32693481445, "episode_reward_min": 49337.31346154213, "episode_reward_mean": 55459.643490447575, "episode_len_mean": 135.5, "episodes_this_iter": 44, "policy_reward_min": {"agent_0": 49337.31346154213}, "policy_reward_max": {"agent_0": 62024.32693481445}, "policy_reward_mean": {"agent_0": 55459.643490447575}, "hist_stats": {"episode_reward": [52955.84687805176, 59122.36003112793, 55401.68017959595, 54476.720041275024, 51641.20018005371, 53623.953481674194, 54041.91351903975, 55650.107006073, 59502.773529052734, 59435.826442718506, 62024.32693481445, 59148.08708190918, 53559.14668083191, 61100.666931152344, 55570.53370475769, 57214.10047912598, 55931.613414764404, 58062.253774642944, 54501.380084991455, 53476.56673622131, 57107.69338989258, 52365.74026584625, 55588.500175476074, 61647.20684814453, 54097.66676020622, 55811.37982940674, 56999.126625061035, 52111.73352432251, 53856.60679399967, 56538.89353942871, 56035.55995178223, 53710.92011773586, 58694.10688972473, 58595.18696594238, 52413.527030944824, 50570.62010097504, 56246.4801940918, 49425.25334978104, 49337.31346154213, 51826.45339393616, 57809.84006500244, 55495.49354171753, 54612.98013305664, 52884.97351980209], "episode_lengths": [135, 137, 136, 135, 135, 135, 134, 136, 136, 137, 138, 136, 135, 137, 136, 136, 135, 137, 136, 135, 135, 135, 134, 138, 136, 134, 135, 134, 135, 136, 135, 136, 137, 137, 136, 134, 135, 133, 135, 135, 136, 135, 134, 135], "policy_agent_0_reward": [52955.84687805176, 59122.36003112793, 55401.68017959595, 54476.720041275024, 51641.20018005371, 53623.953481674194, 54041.91351903975, 55650.107006073, 59502.773529052734, 59435.826442718506, 62024.32693481445, 59148.08708190918, 53559.14668083191, 61100.666931152344, 55570.53370475769, 57214.10047912598, 55931.613414764404, 58062.253774642944, 54501.380084991455, 53476.56673622131, 57107.69338989258, 52365.74026584625, 55588.500175476074, 61647.20684814453, 54097.66676020622, 55811.37982940674, 56999.126625061035, 52111.73352432251, 53856.60679399967, 56538.89353942871, 56035.55995178223, 53710.92011773586, 58694.10688972473, 58595.18696594238, 52413.527030944824, 50570.62010097504, 56246.4801940918, 49425.25334978104, 49337.31346154213, 51826.45339393616, 57809.84006500244, 55495.49354171753, 54612.98013305664, 52884.97351980209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.93921104650958, "mean_inference_ms": 6.536892859554279, "mean_action_processing_ms": 0.19803207577788526, "mean_env_wait_ms": 226.29125668863506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058219107714566315, "StateBufferConnector_ms": 0.006176666779951615, "ViewRequirementAgentConnector_ms": 0.30650279738686304}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.1710803983058, "num_env_steps_trained_throughput_per_sec": 279.1710803983058, "timesteps_total": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 14292.601, "sample_time_ms": 11336.856, "learn_time_ms": 2804.37, "learn_throughput": 1426.345, "synch_weights_time_ms": 150.719}, "counters": {"num_env_steps_sampled": 1136000, "num_env_steps_trained": 1136000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "episodes_total": 8292, "training_iteration": 284, "trial_id": "32397_00000", "date": "2025-03-21_09-45-36", "timestamp": 1742550336, "time_this_iter_s": 14.371325254440308, "time_total_s": 4095.740564584732, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4095.740564584732, "iterations_since_restore": 284, "perf": {"cpu_util_percent": 97.91999999999999, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.45, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.780364990234375, "policy_loss": -0.016983382403850555, "vf_loss": 9.797119140625, "vf_explained_var": 1.2889503864244034e-07, "kl": 0.016290923580527306, "entropy": 0.33994367718696594, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 62240.80700683594, "episode_reward_min": 46624.72009754181, "episode_reward_mean": 56154.20452147722, "episode_len_mean": 135.925, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {"agent_0": 46624.72009754181}, "policy_reward_max": {"agent_0": 62240.80700683594}, "policy_reward_mean": {"agent_0": 56154.20452147722}, "custom_metrics": {"num_batches_mean": 5.45, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57692.05352783203, 56762.880063056946, 58450.33348083496, 54716.793617248535, 52251.28698313236, 58515.07350921631, 57477.20025253296, 60963.76710510254, 58956.53337287903, 54884.733557224274, 52754.55354464054, 57988.86685752869, 57169.540103554726, 51451.27358162403, 57869.53355407715, 58632.44699859619, 46624.72009754181, 56900.86000061035, 52987.05337905884, 54133.84686613083, 57397.89339828491, 51849.2267370224, 54246.70012760162, 56697.700357437134, 55460.8133854866, 58899.15998840332, 53348.74013328552, 58998.660289764404, 60498.30680847168, 57185.87357711792, 56046.16696548462, 56276.56042432785, 53287.420042037964, 57279.7667388916, 57875.6467590332, 54045.460045814514, 57148.60022354126, 60502.120666503906, 62240.80700683594, 56440.75364112854, 54572.34010887146, 55205.78002643585, 57410.10039520264, 56877.153482437134, 57643.16669845581, 58332.32014846802, 55929.440291404724, 60655.58679199219, 55583.60012817383, 59229.32678222656, 58198.6936340332, 53951.146671295166, 56991.94683456421, 58873.680000305176, 52856.47988939285, 49289.16042137146, 58544.80693054199, 57643.77349472046, 53232.74673080444, 50260.98663711548, 51380.26018333435, 57905.447036743164, 53104.71368408203, 59952.35372924805, 60820.76026916504, 60679.747161865234, 55336.72674560547, 52393.56693458557, 56191.24676513672, 48489.99361371994, 59170.893743515015, 52272.060092926025, 61450.42714691162, 57688.43346405029, 56904.80679893494, 53489.92010307312, 53831.693269729614, 52743.0734500885, 59806.8201751709, 54531.45348358154], "episode_lengths": [136, 136, 137, 135, 136, 137, 136, 137, 137, 136, 135, 137, 137, 135, 136, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 136, 135, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 138, 136, 136, 135, 135, 136, 136, 137, 136, 137, 135, 137, 136, 135, 136, 137, 136, 135, 136, 136, 136, 135, 134, 136, 135, 136, 137, 137, 135, 134, 135, 134, 136, 135, 138, 136, 136, 135, 136, 135, 137, 135], "policy_agent_0_reward": [57692.05352783203, 56762.880063056946, 58450.33348083496, 54716.793617248535, 52251.28698313236, 58515.07350921631, 57477.20025253296, 60963.76710510254, 58956.53337287903, 54884.733557224274, 52754.55354464054, 57988.86685752869, 57169.540103554726, 51451.27358162403, 57869.53355407715, 58632.44699859619, 46624.72009754181, 56900.86000061035, 52987.05337905884, 54133.84686613083, 57397.89339828491, 51849.2267370224, 54246.70012760162, 56697.700357437134, 55460.8133854866, 58899.15998840332, 53348.74013328552, 58998.660289764404, 60498.30680847168, 57185.87357711792, 56046.16696548462, 56276.56042432785, 53287.420042037964, 57279.7667388916, 57875.6467590332, 54045.460045814514, 57148.60022354126, 60502.120666503906, 62240.80700683594, 56440.75364112854, 54572.34010887146, 55205.78002643585, 57410.10039520264, 56877.153482437134, 57643.16669845581, 58332.32014846802, 55929.440291404724, 60655.58679199219, 55583.60012817383, 59229.32678222656, 58198.6936340332, 53951.146671295166, 56991.94683456421, 58873.680000305176, 52856.47988939285, 49289.16042137146, 58544.80693054199, 57643.77349472046, 53232.74673080444, 50260.98663711548, 51380.26018333435, 57905.447036743164, 53104.71368408203, 59952.35372924805, 60820.76026916504, 60679.747161865234, 55336.72674560547, 52393.56693458557, 56191.24676513672, 48489.99361371994, 59170.893743515015, 52272.060092926025, 61450.42714691162, 57688.43346405029, 56904.80679893494, 53489.92010307312, 53831.693269729614, 52743.0734500885, 59806.8201751709, 54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.092716903377152, "mean_inference_ms": 6.719840742701615, "mean_action_processing_ms": 0.19590476667146525, "mean_env_wait_ms": 231.38537377320023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10743260383605957, "StateBufferConnector_ms": 0.006223917007446289, "ViewRequirementAgentConnector_ms": 0.19264280796051025}}, "episode_reward_max": 62240.80700683594, "episode_reward_min": 46624.72009754181, "episode_reward_mean": 56154.20452147722, "episode_len_mean": 135.925, "episodes_this_iter": 80, "policy_reward_min": {"agent_0": 46624.72009754181}, "policy_reward_max": {"agent_0": 62240.80700683594}, "policy_reward_mean": {"agent_0": 56154.20452147722}, "hist_stats": {"episode_reward": [57692.05352783203, 56762.880063056946, 58450.33348083496, 54716.793617248535, 52251.28698313236, 58515.07350921631, 57477.20025253296, 60963.76710510254, 58956.53337287903, 54884.733557224274, 52754.55354464054, 57988.86685752869, 57169.540103554726, 51451.27358162403, 57869.53355407715, 58632.44699859619, 46624.72009754181, 56900.86000061035, 52987.05337905884, 54133.84686613083, 57397.89339828491, 51849.2267370224, 54246.70012760162, 56697.700357437134, 55460.8133854866, 58899.15998840332, 53348.74013328552, 58998.660289764404, 60498.30680847168, 57185.87357711792, 56046.16696548462, 56276.56042432785, 53287.420042037964, 57279.7667388916, 57875.6467590332, 54045.460045814514, 57148.60022354126, 60502.120666503906, 62240.80700683594, 56440.75364112854, 54572.34010887146, 55205.78002643585, 57410.10039520264, 56877.153482437134, 57643.16669845581, 58332.32014846802, 55929.440291404724, 60655.58679199219, 55583.60012817383, 59229.32678222656, 58198.6936340332, 53951.146671295166, 56991.94683456421, 58873.680000305176, 52856.47988939285, 49289.16042137146, 58544.80693054199, 57643.77349472046, 53232.74673080444, 50260.98663711548, 51380.26018333435, 57905.447036743164, 53104.71368408203, 59952.35372924805, 60820.76026916504, 60679.747161865234, 55336.72674560547, 52393.56693458557, 56191.24676513672, 48489.99361371994, 59170.893743515015, 52272.060092926025, 61450.42714691162, 57688.43346405029, 56904.80679893494, 53489.92010307312, 53831.693269729614, 52743.0734500885, 59806.8201751709, 54531.45348358154], "episode_lengths": [136, 136, 137, 135, 136, 137, 136, 137, 137, 136, 135, 137, 137, 135, 136, 136, 135, 136, 136, 135, 136, 135, 136, 135, 136, 136, 135, 137, 137, 136, 136, 136, 136, 136, 137, 136, 136, 137, 138, 136, 136, 135, 135, 136, 136, 137, 136, 137, 135, 137, 136, 135, 136, 137, 136, 135, 136, 136, 136, 135, 134, 136, 135, 136, 137, 137, 135, 134, 135, 134, 136, 135, 138, 136, 136, 135, 136, 135, 137, 135], "policy_agent_0_reward": [57692.05352783203, 56762.880063056946, 58450.33348083496, 54716.793617248535, 52251.28698313236, 58515.07350921631, 57477.20025253296, 60963.76710510254, 58956.53337287903, 54884.733557224274, 52754.55354464054, 57988.86685752869, 57169.540103554726, 51451.27358162403, 57869.53355407715, 58632.44699859619, 46624.72009754181, 56900.86000061035, 52987.05337905884, 54133.84686613083, 57397.89339828491, 51849.2267370224, 54246.70012760162, 56697.700357437134, 55460.8133854866, 58899.15998840332, 53348.74013328552, 58998.660289764404, 60498.30680847168, 57185.87357711792, 56046.16696548462, 56276.56042432785, 53287.420042037964, 57279.7667388916, 57875.6467590332, 54045.460045814514, 57148.60022354126, 60502.120666503906, 62240.80700683594, 56440.75364112854, 54572.34010887146, 55205.78002643585, 57410.10039520264, 56877.153482437134, 57643.16669845581, 58332.32014846802, 55929.440291404724, 60655.58679199219, 55583.60012817383, 59229.32678222656, 58198.6936340332, 53951.146671295166, 56991.94683456421, 58873.680000305176, 52856.47988939285, 49289.16042137146, 58544.80693054199, 57643.77349472046, 53232.74673080444, 50260.98663711548, 51380.26018333435, 57905.447036743164, 53104.71368408203, 59952.35372924805, 60820.76026916504, 60679.747161865234, 55336.72674560547, 52393.56693458557, 56191.24676513672, 48489.99361371994, 59170.893743515015, 52272.060092926025, 61450.42714691162, 57688.43346405029, 56904.80679893494, 53489.92010307312, 53831.693269729614, 52743.0734500885, 59806.8201751709, 54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.092716903377152, "mean_inference_ms": 6.719840742701615, "mean_action_processing_ms": 0.19590476667146525, "mean_env_wait_ms": 231.38537377320023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10743260383605957, "StateBufferConnector_ms": 0.006223917007446289, "ViewRequirementAgentConnector_ms": 0.19264280796051025}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.146431337491, "num_env_steps_trained_throughput_per_sec": 227.146431337491, "timesteps_total": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 14778.763, "sample_time_ms": 11872.807, "learn_time_ms": 2759.248, "learn_throughput": 1449.67, "synch_weights_time_ms": 146.045}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 8372, "training_iteration": 285, "trial_id": "32397_00000", "date": "2025-03-21_09-45-54", "timestamp": 1742550354, "time_this_iter_s": 17.6613667011261, "time_total_s": 4113.401931285858, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4113.401931285858, "iterations_since_restore": 285, "perf": {"cpu_util_percent": 98.39565217391304, "ram_util_percent": 13.600000000000003}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984922409057617, "policy_loss": -0.015322436578571796, "vf_loss": 10.0, "vf_explained_var": 1.2516974834397843e-07, "kl": 0.017429444938898087, "entropy": 0.3703782856464386, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "sampler_results": {"episode_reward_max": 54531.45348358154, "episode_reward_min": 54531.45348358154, "episode_reward_mean": 54531.45348358154, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54531.45348358154}, "policy_reward_max": {"agent_0": 54531.45348358154}, "policy_reward_mean": {"agent_0": 54531.45348358154}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54531.45348358154], "episode_lengths": [135], "policy_agent_0_reward": [54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.27641015564607, "mean_inference_ms": 6.921063728361795, "mean_action_processing_ms": 0.19401845774124124, "mean_env_wait_ms": 232.56010071330263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955364227294922, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16617774963378906}}, "episode_reward_max": 54531.45348358154, "episode_reward_min": 54531.45348358154, "episode_reward_mean": 54531.45348358154, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54531.45348358154}, "policy_reward_max": {"agent_0": 54531.45348358154}, "policy_reward_mean": {"agent_0": 54531.45348358154}, "hist_stats": {"episode_reward": [54531.45348358154], "episode_lengths": [135], "policy_agent_0_reward": [54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.27641015564607, "mean_inference_ms": 6.921063728361795, "mean_action_processing_ms": 0.19401845774124124, "mean_env_wait_ms": 232.56010071330263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955364227294922, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16617774963378906}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000, "num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.1652969362042, "num_env_steps_trained_throughput_per_sec": 316.1652969362042, "timesteps_total": 1144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1144000, "timers": {"training_iteration_time_ms": 14410.533, "sample_time_ms": 11457.082, "learn_time_ms": 2806.813, "learn_throughput": 1425.104, "synch_weights_time_ms": 145.984}, "counters": {"num_env_steps_sampled": 1144000, "num_env_steps_trained": 1144000, "num_agent_steps_sampled": 1144000, "num_agent_steps_trained": 1144000}, "done": false, "episodes_total": 8372, "training_iteration": 286, "trial_id": "32397_00000", "date": "2025-03-21_09-46-06", "timestamp": 1742550366, "time_this_iter_s": 12.702561378479004, "time_total_s": 4126.104492664337, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4126.104492664337, "iterations_since_restore": 286, "perf": {"cpu_util_percent": 99.64444444444446, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981195449829102, "policy_loss": -0.014191658236086369, "vf_loss": 9.9951171875, "vf_explained_var": 2.2972623803241277e-09, "kl": 0.019153209403157234, "entropy": 0.36477723717689514, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "sampler_results": {"episode_reward_max": 54531.45348358154, "episode_reward_min": 54531.45348358154, "episode_reward_mean": 54531.45348358154, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54531.45348358154}, "policy_reward_max": {"agent_0": 54531.45348358154}, "policy_reward_mean": {"agent_0": 54531.45348358154}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [54531.45348358154], "episode_lengths": [135], "policy_agent_0_reward": [54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.27641015564607, "mean_inference_ms": 6.921063728361795, "mean_action_processing_ms": 0.19401845774124124, "mean_env_wait_ms": 232.56010071330263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955364227294922, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16617774963378906}}, "episode_reward_max": 54531.45348358154, "episode_reward_min": 54531.45348358154, "episode_reward_mean": 54531.45348358154, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 54531.45348358154}, "policy_reward_max": {"agent_0": 54531.45348358154}, "policy_reward_mean": {"agent_0": 54531.45348358154}, "hist_stats": {"episode_reward": [54531.45348358154], "episode_lengths": [135], "policy_agent_0_reward": [54531.45348358154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.27641015564607, "mean_inference_ms": 6.921063728361795, "mean_action_processing_ms": 0.19401845774124124, "mean_env_wait_ms": 232.56010071330263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955364227294922, "StateBufferConnector_ms": 0.005984306335449219, "ViewRequirementAgentConnector_ms": 0.16617774963378906}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000, "num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.2165751462677, "num_env_steps_trained_throughput_per_sec": 298.2165751462677, "timesteps_total": 1148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1148000, "timers": {"training_iteration_time_ms": 14330.313, "sample_time_ms": 11388.849, "learn_time_ms": 2798.991, "learn_throughput": 1429.086, "synch_weights_time_ms": 141.826}, "counters": {"num_env_steps_sampled": 1148000, "num_env_steps_trained": 1148000, "num_agent_steps_sampled": 1148000, "num_agent_steps_trained": 1148000}, "done": false, "episodes_total": 8372, "training_iteration": 287, "trial_id": "32397_00000", "date": "2025-03-21_09-46-20", "timestamp": 1742550380, "time_this_iter_s": 13.463728904724121, "time_total_s": 4139.568221569061, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ed79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4139.568221569061, "iterations_since_restore": 287, "perf": {"cpu_util_percent": 99.53684210526318, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.921636581420898, "policy_loss": -0.018628694117069244, "vf_loss": 9.940047264099121, "vf_explained_var": -8.527251338819042e-06, "kl": 0.015432373620569706, "entropy": 0.36054617166519165, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 61036.60691833496, "episode_reward_min": 45915.51370429993, "episode_reward_mean": 54303.99231637561, "episode_len_mean": 135.47826086956522, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 45915.51370429993}, "policy_reward_max": {"agent_0": 61036.60691833496}, "policy_reward_mean": {"agent_0": 54303.99231637561}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [51991.78014278412, 57769.61347579956, 57202.32692146301, 53388.1067276001, 57738.72012710571, 45915.51370429993, 52124.96003437042, 54325.60021686554, 53254.42003631592, 57582.52675628662, 53468.22685241699, 47926.72008085251, 61036.60691833496, 52308.70675134659, 50840.81350708008, 53733.30014038086, 58886.926818847656, 57636.733377456665, 60171.946868896484, 57432.82669067383, 50011.793672561646, 47866.04011642933, 56377.61333847046], "episode_lengths": [136, 137, 135, 134, 136, 134, 136, 136, 135, 136, 134, 134, 137, 136, 135, 134, 137, 137, 136, 136, 134, 135, 136], "policy_agent_0_reward": [51991.78014278412, 57769.61347579956, 57202.32692146301, 53388.1067276001, 57738.72012710571, 45915.51370429993, 52124.96003437042, 54325.60021686554, 53254.42003631592, 57582.52675628662, 53468.22685241699, 47926.72008085251, 61036.60691833496, 52308.70675134659, 50840.81350708008, 53733.30014038086, 58886.926818847656, 57636.733377456665, 60171.946868896484, 57432.82669067383, 50011.793672561646, 47866.04011642933, 56377.61333847046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.097604346673936, "mean_inference_ms": 6.461601757030976, "mean_action_processing_ms": 0.19853404250811418, "mean_env_wait_ms": 222.1849901624975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056132026340650475, "StateBufferConnector_ms": 0.006106625432553498, "ViewRequirementAgentConnector_ms": 0.34215450286865234}}, "episode_reward_max": 61036.60691833496, "episode_reward_min": 45915.51370429993, "episode_reward_mean": 54303.99231637561, "episode_len_mean": 135.47826086956522, "episodes_this_iter": 23, "policy_reward_min": {"agent_0": 45915.51370429993}, "policy_reward_max": {"agent_0": 61036.60691833496}, "policy_reward_mean": {"agent_0": 54303.99231637561}, "hist_stats": {"episode_reward": [51991.78014278412, 57769.61347579956, 57202.32692146301, 53388.1067276001, 57738.72012710571, 45915.51370429993, 52124.96003437042, 54325.60021686554, 53254.42003631592, 57582.52675628662, 53468.22685241699, 47926.72008085251, 61036.60691833496, 52308.70675134659, 50840.81350708008, 53733.30014038086, 58886.926818847656, 57636.733377456665, 60171.946868896484, 57432.82669067383, 50011.793672561646, 47866.04011642933, 56377.61333847046], "episode_lengths": [136, 137, 135, 134, 136, 134, 136, 136, 135, 136, 134, 134, 137, 136, 135, 134, 137, 137, 136, 136, 134, 135, 136], "policy_agent_0_reward": [51991.78014278412, 57769.61347579956, 57202.32692146301, 53388.1067276001, 57738.72012710571, 45915.51370429993, 52124.96003437042, 54325.60021686554, 53254.42003631592, 57582.52675628662, 53468.22685241699, 47926.72008085251, 61036.60691833496, 52308.70675134659, 50840.81350708008, 53733.30014038086, 58886.926818847656, 57636.733377456665, 60171.946868896484, 57432.82669067383, 50011.793672561646, 47866.04011642933, 56377.61333847046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 22.097604346673936, "mean_inference_ms": 6.461601757030976, "mean_action_processing_ms": 0.19853404250811418, "mean_env_wait_ms": 222.1849901624975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056132026340650475, "StateBufferConnector_ms": 0.006106625432553498, "ViewRequirementAgentConnector_ms": 0.34215450286865234}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.4017083213659, "num_env_steps_trained_throughput_per_sec": 281.4017083213659, "timesteps_total": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 14444.597, "sample_time_ms": 11507.19, "learn_time_ms": 2788.027, "learn_throughput": 1434.706, "synch_weights_time_ms": 148.744}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 8395, "training_iteration": 288, "trial_id": "32397_00000", "date": "2025-03-21_09-46-34", "timestamp": 1742550394, "time_this_iter_s": 14.277524471282959, "time_total_s": 4153.845746040344, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c970a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4153.845746040344, "iterations_since_restore": 288, "perf": {"cpu_util_percent": 99.465, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.158415841584159, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.723821640014648, "policy_loss": -0.016856228932738304, "vf_loss": 9.740432739257812, "vf_explained_var": -1.7266720533370972e-06, "kl": 0.017434345558285713, "entropy": 0.40408751368522644, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "sampler_results": {"episode_reward_max": 61856.906677246094, "episode_reward_min": 44125.420194625854, "episode_reward_mean": 55531.289617072536, "episode_len_mean": 135.62376237623764, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {"agent_0": 44125.420194625854}, "policy_reward_max": {"agent_0": 61856.906677246094}, "policy_reward_mean": {"agent_0": 55531.289617072536}, "custom_metrics": {"num_batches_mean": 5.158415841584159, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [59589.76681518555, 51877.27353096008, 54872.26002240181, 56720.840326309204, 56502.55362844467, 58719.85349273682, 57563.00668144226, 52400.40657997131, 58912.353843688965, 54211.6468372345, 53692.54021072388, 61856.906677246094, 51025.266882002354, 56800.40016031265, 50446.56007480621, 61025.50680541992, 51108.73333954811, 55617.97351336479, 53437.766671180725, 53927.626625061035, 52102.6134185791, 52629.48661994934, 47555.24697613716, 55986.50681114197, 58253.26031804085, 54361.06671333313, 55496.26020336151, 56907.186767578125, 53149.38016152382, 59398.64690208435, 57848.106925964355, 56000.786739349365, 57320.3000831604, 55191.94680976868, 59741.01350402832, 58334.9667930603, 56259.44013214111, 51811.33343696594, 52944.213397979736, 56667.50024986267, 53202.500098228455, 49025.48684132099, 56080.65332221985, 56716.08707809448, 56130.020000457764, 58603.107162475586, 51820.21325111389, 55807.27365112305, 58510.553440093994, 55346.033279418945, 51177.84690093994, 61135.76028442383, 51849.46008491516, 53777.506954193115, 54464.140303611755, 60148.000244140625, 55804.73350906372, 52685.313672065735, 52845.13359928131, 60720.90026855469, 44125.420194625854, 56026.29359817505, 57275.88694000244, 61147.48693847656, 58910.0467338562, 54398.680112838745, 57457.84692764282, 57775.473529815674, 53655.12019920349, 53610.5135679245, 57318.91344451904, 54861.42012214661, 51256.0537109375, 54521.826791763306, 53802.913519233465, 51744.62669849396, 59618.166889190674, 51795.24676513672, 59839.2403011322, 53378.98687171936, 58788.00680541992, 49927.02030420303, 60794.28031921387, 53863.88041687012, 57621.507205963135, 57572.37341308594, 56725.35357475281, 50697.533541202545, 54598.46015751362, 54397.47346878052, 56317.74004650116, 59195.780014038086, 55150.526836395264, 58880.673278808594, 56112.40702819824, 58664.86018180847, 57457.153745651245, 55400.300117492676, 57258.16032028198, 54031.42655754089, 58565.940505981445], "episode_lengths": [137, 135, 134, 135, 136, 137, 136, 134, 136, 136, 137, 137, 135, 135, 134, 137, 134, 135, 135, 136, 135, 135, 135, 136, 137, 135, 135, 135, 135, 136, 136, 135, 136, 135, 137, 137, 134, 134, 135, 135, 135, 134, 136, 136, 136, 137, 135, 136, 136, 136, 135, 137, 135, 135, 135, 137, 135, 136, 135, 136, 134, 135, 136, 137, 136, 136, 136, 137, 135, 135, 135, 135, 135, 136, 136, 136, 137, 134, 137, 135, 136, 135, 137, 136, 137, 136, 135, 135, 135, 136, 136, 137, 135, 136, 135, 137, 136, 136, 136, 135, 136], "policy_agent_0_reward": [59589.76681518555, 51877.27353096008, 54872.26002240181, 56720.840326309204, 56502.55362844467, 58719.85349273682, 57563.00668144226, 52400.40657997131, 58912.353843688965, 54211.6468372345, 53692.54021072388, 61856.906677246094, 51025.266882002354, 56800.40016031265, 50446.56007480621, 61025.50680541992, 51108.73333954811, 55617.97351336479, 53437.766671180725, 53927.626625061035, 52102.6134185791, 52629.48661994934, 47555.24697613716, 55986.50681114197, 58253.26031804085, 54361.06671333313, 55496.26020336151, 56907.186767578125, 53149.38016152382, 59398.64690208435, 57848.106925964355, 56000.786739349365, 57320.3000831604, 55191.94680976868, 59741.01350402832, 58334.9667930603, 56259.44013214111, 51811.33343696594, 52944.213397979736, 56667.50024986267, 53202.500098228455, 49025.48684132099, 56080.65332221985, 56716.08707809448, 56130.020000457764, 58603.107162475586, 51820.21325111389, 55807.27365112305, 58510.553440093994, 55346.033279418945, 51177.84690093994, 61135.76028442383, 51849.46008491516, 53777.506954193115, 54464.140303611755, 60148.000244140625, 55804.73350906372, 52685.313672065735, 52845.13359928131, 60720.90026855469, 44125.420194625854, 56026.29359817505, 57275.88694000244, 61147.48693847656, 58910.0467338562, 54398.680112838745, 57457.84692764282, 57775.473529815674, 53655.12019920349, 53610.5135679245, 57318.91344451904, 54861.42012214661, 51256.0537109375, 54521.826791763306, 53802.913519233465, 51744.62669849396, 59618.166889190674, 51795.24676513672, 59839.2403011322, 53378.98687171936, 58788.00680541992, 49927.02030420303, 60794.28031921387, 53863.88041687012, 57621.507205963135, 57572.37341308594, 56725.35357475281, 50697.533541202545, 54598.46015751362, 54397.47346878052, 56317.74004650116, 59195.780014038086, 55150.526836395264, 58880.673278808594, 56112.40702819824, 58664.86018180847, 57457.153745651245, 55400.300117492676, 57258.16032028198, 54031.42655754089, 58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.227464009954822, "mean_inference_ms": 6.6909025723365225, "mean_action_processing_ms": 0.19620366070400538, "mean_env_wait_ms": 231.13395524810548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04646353202291054, "StateBufferConnector_ms": 0.015998594831712176, "ViewRequirementAgentConnector_ms": 0.2413480588705233}}, "episode_reward_max": 61856.906677246094, "episode_reward_min": 44125.420194625854, "episode_reward_mean": 55531.289617072536, "episode_len_mean": 135.62376237623764, "episodes_this_iter": 101, "policy_reward_min": {"agent_0": 44125.420194625854}, "policy_reward_max": {"agent_0": 61856.906677246094}, "policy_reward_mean": {"agent_0": 55531.289617072536}, "hist_stats": {"episode_reward": [59589.76681518555, 51877.27353096008, 54872.26002240181, 56720.840326309204, 56502.55362844467, 58719.85349273682, 57563.00668144226, 52400.40657997131, 58912.353843688965, 54211.6468372345, 53692.54021072388, 61856.906677246094, 51025.266882002354, 56800.40016031265, 50446.56007480621, 61025.50680541992, 51108.73333954811, 55617.97351336479, 53437.766671180725, 53927.626625061035, 52102.6134185791, 52629.48661994934, 47555.24697613716, 55986.50681114197, 58253.26031804085, 54361.06671333313, 55496.26020336151, 56907.186767578125, 53149.38016152382, 59398.64690208435, 57848.106925964355, 56000.786739349365, 57320.3000831604, 55191.94680976868, 59741.01350402832, 58334.9667930603, 56259.44013214111, 51811.33343696594, 52944.213397979736, 56667.50024986267, 53202.500098228455, 49025.48684132099, 56080.65332221985, 56716.08707809448, 56130.020000457764, 58603.107162475586, 51820.21325111389, 55807.27365112305, 58510.553440093994, 55346.033279418945, 51177.84690093994, 61135.76028442383, 51849.46008491516, 53777.506954193115, 54464.140303611755, 60148.000244140625, 55804.73350906372, 52685.313672065735, 52845.13359928131, 60720.90026855469, 44125.420194625854, 56026.29359817505, 57275.88694000244, 61147.48693847656, 58910.0467338562, 54398.680112838745, 57457.84692764282, 57775.473529815674, 53655.12019920349, 53610.5135679245, 57318.91344451904, 54861.42012214661, 51256.0537109375, 54521.826791763306, 53802.913519233465, 51744.62669849396, 59618.166889190674, 51795.24676513672, 59839.2403011322, 53378.98687171936, 58788.00680541992, 49927.02030420303, 60794.28031921387, 53863.88041687012, 57621.507205963135, 57572.37341308594, 56725.35357475281, 50697.533541202545, 54598.46015751362, 54397.47346878052, 56317.74004650116, 59195.780014038086, 55150.526836395264, 58880.673278808594, 56112.40702819824, 58664.86018180847, 57457.153745651245, 55400.300117492676, 57258.16032028198, 54031.42655754089, 58565.940505981445], "episode_lengths": [137, 135, 134, 135, 136, 137, 136, 134, 136, 136, 137, 137, 135, 135, 134, 137, 134, 135, 135, 136, 135, 135, 135, 136, 137, 135, 135, 135, 135, 136, 136, 135, 136, 135, 137, 137, 134, 134, 135, 135, 135, 134, 136, 136, 136, 137, 135, 136, 136, 136, 135, 137, 135, 135, 135, 137, 135, 136, 135, 136, 134, 135, 136, 137, 136, 136, 136, 137, 135, 135, 135, 135, 135, 136, 136, 136, 137, 134, 137, 135, 136, 135, 137, 136, 137, 136, 135, 135, 135, 136, 136, 137, 135, 136, 135, 137, 136, 136, 136, 135, 136], "policy_agent_0_reward": [59589.76681518555, 51877.27353096008, 54872.26002240181, 56720.840326309204, 56502.55362844467, 58719.85349273682, 57563.00668144226, 52400.40657997131, 58912.353843688965, 54211.6468372345, 53692.54021072388, 61856.906677246094, 51025.266882002354, 56800.40016031265, 50446.56007480621, 61025.50680541992, 51108.73333954811, 55617.97351336479, 53437.766671180725, 53927.626625061035, 52102.6134185791, 52629.48661994934, 47555.24697613716, 55986.50681114197, 58253.26031804085, 54361.06671333313, 55496.26020336151, 56907.186767578125, 53149.38016152382, 59398.64690208435, 57848.106925964355, 56000.786739349365, 57320.3000831604, 55191.94680976868, 59741.01350402832, 58334.9667930603, 56259.44013214111, 51811.33343696594, 52944.213397979736, 56667.50024986267, 53202.500098228455, 49025.48684132099, 56080.65332221985, 56716.08707809448, 56130.020000457764, 58603.107162475586, 51820.21325111389, 55807.27365112305, 58510.553440093994, 55346.033279418945, 51177.84690093994, 61135.76028442383, 51849.46008491516, 53777.506954193115, 54464.140303611755, 60148.000244140625, 55804.73350906372, 52685.313672065735, 52845.13359928131, 60720.90026855469, 44125.420194625854, 56026.29359817505, 57275.88694000244, 61147.48693847656, 58910.0467338562, 54398.680112838745, 57457.84692764282, 57775.473529815674, 53655.12019920349, 53610.5135679245, 57318.91344451904, 54861.42012214661, 51256.0537109375, 54521.826791763306, 53802.913519233465, 51744.62669849396, 59618.166889190674, 51795.24676513672, 59839.2403011322, 53378.98687171936, 58788.00680541992, 49927.02030420303, 60794.28031921387, 53863.88041687012, 57621.507205963135, 57572.37341308594, 56725.35357475281, 50697.533541202545, 54598.46015751362, 54397.47346878052, 56317.74004650116, 59195.780014038086, 55150.526836395264, 58880.673278808594, 56112.40702819824, 58664.86018180847, 57457.153745651245, 55400.300117492676, 57258.16032028198, 54031.42655754089, 58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.227464009954822, "mean_inference_ms": 6.6909025723365225, "mean_action_processing_ms": 0.19620366070400538, "mean_env_wait_ms": 231.13395524810548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04646353202291054, "StateBufferConnector_ms": 0.015998594831712176, "ViewRequirementAgentConnector_ms": 0.2413480588705233}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000, "num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.76907223333578, "num_env_steps_trained_throughput_per_sec": 246.76907223333578, "timesteps_total": 1156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1156000, "timers": {"training_iteration_time_ms": 14719.479, "sample_time_ms": 11846.47, "learn_time_ms": 2729.466, "learn_throughput": 1465.488, "synch_weights_time_ms": 142.903}, "counters": {"num_env_steps_sampled": 1156000, "num_env_steps_trained": 1156000, "num_agent_steps_sampled": 1156000, "num_agent_steps_trained": 1156000}, "done": false, "episodes_total": 8496, "training_iteration": 289, "trial_id": "32397_00000", "date": "2025-03-21_09-46-50", "timestamp": 1742550410, "time_this_iter_s": 16.259474992752075, "time_total_s": 4170.105221033096, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ed79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4170.105221033096, "iterations_since_restore": 289, "perf": {"cpu_util_percent": 97.65, "ram_util_percent": 13.586363636363638}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.987125396728516, "policy_loss": -0.013095798902213573, "vf_loss": 10.0, "vf_explained_var": 8.537123790119949e-07, "kl": 0.015732521191239357, "entropy": 0.40899622440338135, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "sampler_results": {"episode_reward_max": 58565.940505981445, "episode_reward_min": 58565.940505981445, "episode_reward_mean": 58565.940505981445, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58565.940505981445}, "policy_reward_max": {"agent_0": 58565.940505981445}, "policy_reward_mean": {"agent_0": 58565.940505981445}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58565.940505981445], "episode_lengths": [136], "policy_agent_0_reward": [58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.129409839119933, "mean_inference_ms": 6.43656949556664, "mean_action_processing_ms": 0.19120368355350864, "mean_env_wait_ms": 231.51898283560942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035500526428222656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.15256404876708984}}, "episode_reward_max": 58565.940505981445, "episode_reward_min": 58565.940505981445, "episode_reward_mean": 58565.940505981445, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58565.940505981445}, "policy_reward_max": {"agent_0": 58565.940505981445}, "policy_reward_mean": {"agent_0": 58565.940505981445}, "hist_stats": {"episode_reward": [58565.940505981445], "episode_lengths": [136], "policy_agent_0_reward": [58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.129409839119933, "mean_inference_ms": 6.43656949556664, "mean_action_processing_ms": 0.19120368355350864, "mean_env_wait_ms": 231.51898283560942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035500526428222656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.15256404876708984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0312305660959, "num_env_steps_trained_throughput_per_sec": 317.0312305660959, "timesteps_total": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 14473.776, "sample_time_ms": 11578.368, "learn_time_ms": 2749.958, "learn_throughput": 1454.568, "synch_weights_time_ms": 144.816}, "counters": {"num_env_steps_sampled": 1160000, "num_env_steps_trained": 1160000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "episodes_total": 8496, "training_iteration": 290, "trial_id": "32397_00000", "date": "2025-03-21_09-47-03", "timestamp": 1742550423, "time_this_iter_s": 12.666254758834839, "time_total_s": 4182.771475791931, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be1090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4182.771475791931, "iterations_since_restore": 290, "perf": {"cpu_util_percent": 99.53157894736844, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.984070777893066, "policy_loss": -0.016140731051564217, "vf_loss": 10.0, "vf_explained_var": -1.234126557392301e-06, "kl": 0.015039654448628426, "entropy": 0.3569944500923157, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 58565.940505981445, "episode_reward_min": 58565.940505981445, "episode_reward_mean": 58565.940505981445, "episode_len_mean": 136.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58565.940505981445}, "policy_reward_max": {"agent_0": 58565.940505981445}, "policy_reward_mean": {"agent_0": 58565.940505981445}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [58565.940505981445], "episode_lengths": [136], "policy_agent_0_reward": [58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.129409839119933, "mean_inference_ms": 6.43656949556664, "mean_action_processing_ms": 0.19120368355350864, "mean_env_wait_ms": 231.51898283560942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035500526428222656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.15256404876708984}}, "episode_reward_max": 58565.940505981445, "episode_reward_min": 58565.940505981445, "episode_reward_mean": 58565.940505981445, "episode_len_mean": 136.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 58565.940505981445}, "policy_reward_max": {"agent_0": 58565.940505981445}, "policy_reward_mean": {"agent_0": 58565.940505981445}, "hist_stats": {"episode_reward": [58565.940505981445], "episode_lengths": [136], "policy_agent_0_reward": [58565.940505981445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.129409839119933, "mean_inference_ms": 6.43656949556664, "mean_action_processing_ms": 0.19120368355350864, "mean_env_wait_ms": 231.51898283560942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035500526428222656, "StateBufferConnector_ms": 0.00591278076171875, "ViewRequirementAgentConnector_ms": 0.15256404876708984}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1415384053414, "num_env_steps_trained_throughput_per_sec": 310.1415384053414, "timesteps_total": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 14025.877, "sample_time_ms": 11127.761, "learn_time_ms": 2755.167, "learn_throughput": 1451.817, "synch_weights_time_ms": 142.311}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 8496, "training_iteration": 291, "trial_id": "32397_00000", "date": "2025-03-21_09-47-16", "timestamp": 1742550436, "time_this_iter_s": 12.947932243347168, "time_total_s": 4195.719408035278, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4195.719408035278, "iterations_since_restore": 291, "perf": {"cpu_util_percent": 99.61111111111113, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.938149452209473, "policy_loss": -0.020100852474570274, "vf_loss": 9.95801067352295, "vf_explained_var": -2.4155403934855713e-06, "kl": 0.01696724444627762, "entropy": 0.3696163296699524, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "sampler_results": {"episode_reward_max": 60925.03335571289, "episode_reward_min": 41687.35361766815, "episode_reward_mean": 54729.88844919577, "episode_len_mean": 135.375, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 41687.35361766815}, "policy_reward_max": {"agent_0": 60925.03335571289}, "policy_reward_mean": {"agent_0": 54729.88844919577}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [59165.69359970093, 60925.03335571289, 50569.74014663696, 53665.606830596924, 59529.24691772461, 51678.08675575256, 41687.35361766815, 53389.90008163452, 58667.76662546396, 53551.02666282654, 55112.87989616394, 54745.76012802124, 58490.14025878906, 55466.720027923584, 50751.020193099976, 58282.240089416504], "episode_lengths": [137, 137, 134, 135, 137, 135, 132, 135, 137, 136, 135, 134, 136, 135, 135, 136], "policy_agent_0_reward": [59165.69359970093, 60925.03335571289, 50569.74014663696, 53665.606830596924, 59529.24691772461, 51678.08675575256, 41687.35361766815, 53389.90008163452, 58667.76662546396, 53551.02666282654, 55112.87989616394, 54745.76012802124, 58490.14025878906, 55466.720027923584, 50751.020193099976, 58282.240089416504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.442866981295463, "mean_inference_ms": 6.385065564924199, "mean_action_processing_ms": 0.19811993412448495, "mean_env_wait_ms": 221.90660274293498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053814053535461426, "StateBufferConnector_ms": 0.006225705146789551, "ViewRequirementAgentConnector_ms": 0.22132545709609985}}, "episode_reward_max": 60925.03335571289, "episode_reward_min": 41687.35361766815, "episode_reward_mean": 54729.88844919577, "episode_len_mean": 135.375, "episodes_this_iter": 16, "policy_reward_min": {"agent_0": 41687.35361766815}, "policy_reward_max": {"agent_0": 60925.03335571289}, "policy_reward_mean": {"agent_0": 54729.88844919577}, "hist_stats": {"episode_reward": [59165.69359970093, 60925.03335571289, 50569.74014663696, 53665.606830596924, 59529.24691772461, 51678.08675575256, 41687.35361766815, 53389.90008163452, 58667.76662546396, 53551.02666282654, 55112.87989616394, 54745.76012802124, 58490.14025878906, 55466.720027923584, 50751.020193099976, 58282.240089416504], "episode_lengths": [137, 137, 134, 135, 137, 135, 132, 135, 137, 136, 135, 134, 136, 135, 135, 136], "policy_agent_0_reward": [59165.69359970093, 60925.03335571289, 50569.74014663696, 53665.606830596924, 59529.24691772461, 51678.08675575256, 41687.35361766815, 53389.90008163452, 58667.76662546396, 53551.02666282654, 55112.87989616394, 54745.76012802124, 58490.14025878906, 55466.720027923584, 50751.020193099976, 58282.240089416504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.442866981295463, "mean_inference_ms": 6.385065564924199, "mean_action_processing_ms": 0.19811993412448495, "mean_env_wait_ms": 221.90660274293498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053814053535461426, "StateBufferConnector_ms": 0.006225705146789551, "ViewRequirementAgentConnector_ms": 0.22132545709609985}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.43129019784647, "num_env_steps_trained_throughput_per_sec": 314.43129019784647, "timesteps_total": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 13935.715, "sample_time_ms": 11117.385, "learn_time_ms": 2675.007, "learn_throughput": 1495.323, "synch_weights_time_ms": 142.691}, "counters": {"num_env_steps_sampled": 1168000, "num_env_steps_trained": 1168000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "episodes_total": 8512, "training_iteration": 292, "trial_id": "32397_00000", "date": "2025-03-21_09-47-29", "timestamp": 1742550449, "time_this_iter_s": 12.782844066619873, "time_total_s": 4208.502252101898, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c96d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4208.502252101898, "iterations_since_restore": 292, "perf": {"cpu_util_percent": 99.25, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.030612244897959, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.739457130432129, "policy_loss": -0.015184039250016212, "vf_loss": 9.75439739227295, "vf_explained_var": -1.3125439579653175e-07, "kl": 0.01728661172091961, "entropy": 0.4124889075756073, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "sampler_results": {"episode_reward_max": 61370.85314941406, "episode_reward_min": 42494.273415505886, "episode_reward_mean": 54443.254851323, "episode_len_mean": 135.30612244897958, "episode_media": {}, "episodes_this_iter": 98, "policy_reward_min": {"agent_0": 42494.273415505886}, "policy_reward_max": {"agent_0": 61370.85314941406}, "policy_reward_mean": {"agent_0": 54443.254851323}, "custom_metrics": {"num_batches_mean": 5.030612244897959, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [61370.85314941406, 52286.340143203735, 49237.586745262146, 59884.640480041504, 52799.300033569336, 52083.826768398285, 61318.0202331543, 58773.393463134766, 53838.513595581055, 54524.48686218262, 58545.66650772095, 56379.82679748535, 54908.09351730347, 53405.00018930435, 56096.21324157715, 56345.000228881836, 51568.06674194336, 57958.906814575195, 51052.97997188568, 57799.52012634277, 53481.6136264801, 58650.40675354004, 53144.306941986084, 48724.9134645462, 48252.12007141113, 61184.76696777344, 58258.266677856445, 50666.22695827484, 57276.493423461914, 56325.967248916626, 46048.54692649841, 58585.82662963867, 52819.24681663513, 53691.12692451477, 53461.43362045288, 58809.313415527344, 53983.06678390503, 54925.640085697174, 58226.353523254395, 52634.06667137146, 54090.59383773804, 52135.44023323059, 58332.526763916016, 56226.106899261475, 54101.11363220215, 60130.01368713379, 53036.82021522522, 51675.95363652706, 48719.206631720066, 46299.28675746918, 55954.04036903381, 55834.49361562729, 52841.63342380524, 56132.34673309326, 57906.11341094971, 54003.56666946411, 58617.64695930481, 53625.8000844717, 51972.20011281967, 53921.74680328369, 42494.273415505886, 59819.246810913086, 55270.96691894531, 58473.66011047363, 50359.213245391846, 53436.13345527649, 57784.26690673828, 49568.73329412937, 53528.24673938751, 57125.593658447266, 52402.020290374756, 51047.846757888794, 59542.846923828125, 57869.9069519043, 52418.82021522522, 50117.133432388306, 54181.48685455322, 51158.10017967224, 56311.97344970703, 51955.77978992462, 54402.1401386261, 58455.82696533203, 50433.31335067749, 55496.80697822571, 47344.70669841766, 55542.113525390625, 57233.7133808136, 57764.40019226074, 47501.56682348251, 49560.86031150818, 56938.91380691528, 56886.61339569092, 48431.73342490196, 58914.49353027344, 53903.50699234009, 57060.63326263428, 51282.23345565796, 58536.560176849365], "episode_lengths": [137, 136, 134, 137, 134, 134, 137, 136, 136, 135, 136, 135, 136, 134, 136, 135, 135, 136, 136, 135, 134, 137, 135, 135, 134, 138, 136, 134, 136, 136, 134, 137, 137, 135, 134, 136, 135, 135, 137, 136, 135, 133, 136, 136, 135, 137, 136, 135, 134, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 134, 134, 137, 135, 136, 135, 137, 136, 134, 134, 135, 135, 133, 137, 135, 134, 134, 135, 134, 136, 135, 136, 135, 133, 136, 135, 136, 136, 135, 134, 134, 136, 136, 134, 136, 135, 136, 134, 136], "policy_agent_0_reward": [61370.85314941406, 52286.340143203735, 49237.586745262146, 59884.640480041504, 52799.300033569336, 52083.826768398285, 61318.0202331543, 58773.393463134766, 53838.513595581055, 54524.48686218262, 58545.66650772095, 56379.82679748535, 54908.09351730347, 53405.00018930435, 56096.21324157715, 56345.000228881836, 51568.06674194336, 57958.906814575195, 51052.97997188568, 57799.52012634277, 53481.6136264801, 58650.40675354004, 53144.306941986084, 48724.9134645462, 48252.12007141113, 61184.76696777344, 58258.266677856445, 50666.22695827484, 57276.493423461914, 56325.967248916626, 46048.54692649841, 58585.82662963867, 52819.24681663513, 53691.12692451477, 53461.43362045288, 58809.313415527344, 53983.06678390503, 54925.640085697174, 58226.353523254395, 52634.06667137146, 54090.59383773804, 52135.44023323059, 58332.526763916016, 56226.106899261475, 54101.11363220215, 60130.01368713379, 53036.82021522522, 51675.95363652706, 48719.206631720066, 46299.28675746918, 55954.04036903381, 55834.49361562729, 52841.63342380524, 56132.34673309326, 57906.11341094971, 54003.56666946411, 58617.64695930481, 53625.8000844717, 51972.20011281967, 53921.74680328369, 42494.273415505886, 59819.246810913086, 55270.96691894531, 58473.66011047363, 50359.213245391846, 53436.13345527649, 57784.26690673828, 49568.73329412937, 53528.24673938751, 57125.593658447266, 52402.020290374756, 51047.846757888794, 59542.846923828125, 57869.9069519043, 52418.82021522522, 50117.133432388306, 54181.48685455322, 51158.10017967224, 56311.97344970703, 51955.77978992462, 54402.1401386261, 58455.82696533203, 50433.31335067749, 55496.80697822571, 47344.70669841766, 55542.113525390625, 57233.7133808136, 57764.40019226074, 47501.56682348251, 49560.86031150818, 56938.91380691528, 56886.61339569092, 48431.73342490196, 58914.49353027344, 53903.50699234009, 57060.63326263428, 51282.23345565796, 58536.560176849365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.446760493046334, "mean_inference_ms": 6.696702294448277, "mean_action_processing_ms": 0.19657843547337336, "mean_env_wait_ms": 230.71445010444364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05181297963979293, "StateBufferConnector_ms": 0.005818143182871293, "ViewRequirementAgentConnector_ms": 0.1923726529491191}}, "episode_reward_max": 61370.85314941406, "episode_reward_min": 42494.273415505886, "episode_reward_mean": 54443.254851323, "episode_len_mean": 135.30612244897958, "episodes_this_iter": 98, "policy_reward_min": {"agent_0": 42494.273415505886}, "policy_reward_max": {"agent_0": 61370.85314941406}, "policy_reward_mean": {"agent_0": 54443.254851323}, "hist_stats": {"episode_reward": [61370.85314941406, 52286.340143203735, 49237.586745262146, 59884.640480041504, 52799.300033569336, 52083.826768398285, 61318.0202331543, 58773.393463134766, 53838.513595581055, 54524.48686218262, 58545.66650772095, 56379.82679748535, 54908.09351730347, 53405.00018930435, 56096.21324157715, 56345.000228881836, 51568.06674194336, 57958.906814575195, 51052.97997188568, 57799.52012634277, 53481.6136264801, 58650.40675354004, 53144.306941986084, 48724.9134645462, 48252.12007141113, 61184.76696777344, 58258.266677856445, 50666.22695827484, 57276.493423461914, 56325.967248916626, 46048.54692649841, 58585.82662963867, 52819.24681663513, 53691.12692451477, 53461.43362045288, 58809.313415527344, 53983.06678390503, 54925.640085697174, 58226.353523254395, 52634.06667137146, 54090.59383773804, 52135.44023323059, 58332.526763916016, 56226.106899261475, 54101.11363220215, 60130.01368713379, 53036.82021522522, 51675.95363652706, 48719.206631720066, 46299.28675746918, 55954.04036903381, 55834.49361562729, 52841.63342380524, 56132.34673309326, 57906.11341094971, 54003.56666946411, 58617.64695930481, 53625.8000844717, 51972.20011281967, 53921.74680328369, 42494.273415505886, 59819.246810913086, 55270.96691894531, 58473.66011047363, 50359.213245391846, 53436.13345527649, 57784.26690673828, 49568.73329412937, 53528.24673938751, 57125.593658447266, 52402.020290374756, 51047.846757888794, 59542.846923828125, 57869.9069519043, 52418.82021522522, 50117.133432388306, 54181.48685455322, 51158.10017967224, 56311.97344970703, 51955.77978992462, 54402.1401386261, 58455.82696533203, 50433.31335067749, 55496.80697822571, 47344.70669841766, 55542.113525390625, 57233.7133808136, 57764.40019226074, 47501.56682348251, 49560.86031150818, 56938.91380691528, 56886.61339569092, 48431.73342490196, 58914.49353027344, 53903.50699234009, 57060.63326263428, 51282.23345565796, 58536.560176849365], "episode_lengths": [137, 136, 134, 137, 134, 134, 137, 136, 136, 135, 136, 135, 136, 134, 136, 135, 135, 136, 136, 135, 134, 137, 135, 135, 134, 138, 136, 134, 136, 136, 134, 137, 137, 135, 134, 136, 135, 135, 137, 136, 135, 133, 136, 136, 135, 137, 136, 135, 134, 135, 135, 136, 135, 136, 136, 135, 136, 135, 135, 134, 134, 137, 135, 136, 135, 137, 136, 134, 134, 135, 135, 133, 137, 135, 134, 134, 135, 134, 136, 135, 136, 135, 133, 136, 135, 136, 136, 135, 134, 134, 136, 136, 134, 136, 135, 136, 134, 136], "policy_agent_0_reward": [61370.85314941406, 52286.340143203735, 49237.586745262146, 59884.640480041504, 52799.300033569336, 52083.826768398285, 61318.0202331543, 58773.393463134766, 53838.513595581055, 54524.48686218262, 58545.66650772095, 56379.82679748535, 54908.09351730347, 53405.00018930435, 56096.21324157715, 56345.000228881836, 51568.06674194336, 57958.906814575195, 51052.97997188568, 57799.52012634277, 53481.6136264801, 58650.40675354004, 53144.306941986084, 48724.9134645462, 48252.12007141113, 61184.76696777344, 58258.266677856445, 50666.22695827484, 57276.493423461914, 56325.967248916626, 46048.54692649841, 58585.82662963867, 52819.24681663513, 53691.12692451477, 53461.43362045288, 58809.313415527344, 53983.06678390503, 54925.640085697174, 58226.353523254395, 52634.06667137146, 54090.59383773804, 52135.44023323059, 58332.526763916016, 56226.106899261475, 54101.11363220215, 60130.01368713379, 53036.82021522522, 51675.95363652706, 48719.206631720066, 46299.28675746918, 55954.04036903381, 55834.49361562729, 52841.63342380524, 56132.34673309326, 57906.11341094971, 54003.56666946411, 58617.64695930481, 53625.8000844717, 51972.20011281967, 53921.74680328369, 42494.273415505886, 59819.246810913086, 55270.96691894531, 58473.66011047363, 50359.213245391846, 53436.13345527649, 57784.26690673828, 49568.73329412937, 53528.24673938751, 57125.593658447266, 52402.020290374756, 51047.846757888794, 59542.846923828125, 57869.9069519043, 52418.82021522522, 50117.133432388306, 54181.48685455322, 51158.10017967224, 56311.97344970703, 51955.77978992462, 54402.1401386261, 58455.82696533203, 50433.31335067749, 55496.80697822571, 47344.70669841766, 55542.113525390625, 57233.7133808136, 57764.40019226074, 47501.56682348251, 49560.86031150818, 56938.91380691528, 56886.61339569092, 48431.73342490196, 58914.49353027344, 53903.50699234009, 57060.63326263428, 51282.23345565796, 58536.560176849365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.446760493046334, "mean_inference_ms": 6.696702294448277, "mean_action_processing_ms": 0.19657843547337336, "mean_env_wait_ms": 230.71445010444364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05181297963979293, "StateBufferConnector_ms": 0.005818143182871293, "ViewRequirementAgentConnector_ms": 0.1923726529491191}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000, "num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.62996387050956, "num_env_steps_trained_throughput_per_sec": 232.62996387050956, "timesteps_total": 1172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1172000, "timers": {"training_iteration_time_ms": 14385.672, "sample_time_ms": 11601.594, "learn_time_ms": 2644.32, "learn_throughput": 1512.676, "synch_weights_time_ms": 139.118}, "counters": {"num_env_steps_sampled": 1172000, "num_env_steps_trained": 1172000, "num_agent_steps_sampled": 1172000, "num_agent_steps_trained": 1172000}, "done": false, "episodes_total": 8610, "training_iteration": 293, "trial_id": "32397_00000", "date": "2025-03-21_09-47-46", "timestamp": 1742550466, "time_this_iter_s": 17.240257501602173, "time_total_s": 4225.7425096035, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4225.7425096035, "iterations_since_restore": 293, "perf": {"cpu_util_percent": 96.89999999999999, "ram_util_percent": 13.591666666666667}}
{"custom_metrics": {"num_batches_mean": 5.9, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.957433700561523, "policy_loss": -0.017381969839334488, "vf_loss": 9.974609375, "vf_explained_var": -1.5895814158284338e-06, "kl": 0.014700778760015965, "entropy": 0.39267441630363464, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 60386.90037536621, "episode_reward_min": 50590.14669108391, "episode_reward_mean": 55002.07752187252, "episode_len_mean": 135.9, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 50590.14669108391}, "policy_reward_max": {"agent_0": 60386.90037536621}, "policy_reward_mean": {"agent_0": 55002.07752187252}, "custom_metrics": {"num_batches_mean": 5.9, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [50590.14669108391, 59027.8600769043, 58181.74696350098, 52384.420263290405, 55202.50677871704, 50880.12014770508, 52684.35340023041, 54328.12019920349, 56354.60032272339, 60386.90037536621], "episode_lengths": [135, 137, 137, 135, 136, 134, 136, 136, 136, 137], "policy_agent_0_reward": [50590.14669108391, 59027.8600769043, 58181.74696350098, 52384.420263290405, 55202.50677871704, 50880.12014770508, 52684.35340023041, 54328.12019920349, 56354.60032272339, 60386.90037536621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.075938646440385, "mean_inference_ms": 6.5797598104267125, "mean_action_processing_ms": 0.19512380242588442, "mean_env_wait_ms": 229.05059585232758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03746986389160156, "StateBufferConnector_ms": 0.005772113800048828, "ViewRequirementAgentConnector_ms": 0.16139745712280273}}, "episode_reward_max": 60386.90037536621, "episode_reward_min": 50590.14669108391, "episode_reward_mean": 55002.07752187252, "episode_len_mean": 135.9, "episodes_this_iter": 10, "policy_reward_min": {"agent_0": 50590.14669108391}, "policy_reward_max": {"agent_0": 60386.90037536621}, "policy_reward_mean": {"agent_0": 55002.07752187252}, "hist_stats": {"episode_reward": [50590.14669108391, 59027.8600769043, 58181.74696350098, 52384.420263290405, 55202.50677871704, 50880.12014770508, 52684.35340023041, 54328.12019920349, 56354.60032272339, 60386.90037536621], "episode_lengths": [135, 137, 137, 135, 136, 134, 136, 136, 136, 137], "policy_agent_0_reward": [50590.14669108391, 59027.8600769043, 58181.74696350098, 52384.420263290405, 55202.50677871704, 50880.12014770508, 52684.35340023041, 54328.12019920349, 56354.60032272339, 60386.90037536621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.075938646440385, "mean_inference_ms": 6.5797598104267125, "mean_action_processing_ms": 0.19512380242588442, "mean_env_wait_ms": 229.05059585232758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03746986389160156, "StateBufferConnector_ms": 0.005772113800048828, "ViewRequirementAgentConnector_ms": 0.16139745712280273}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.8941859796772, "num_env_steps_trained_throughput_per_sec": 290.8941859796772, "timesteps_total": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 14327.929, "sample_time_ms": 11522.624, "learn_time_ms": 2661.99, "learn_throughput": 1502.635, "synch_weights_time_ms": 142.667}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 8620, "training_iteration": 294, "trial_id": "32397_00000", "date": "2025-03-21_09-48-00", "timestamp": 1742550480, "time_this_iter_s": 13.80970573425293, "time_total_s": 4239.552215337753, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4239.552215337753, "iterations_since_restore": 294, "perf": {"cpu_util_percent": 99.50526315789473, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.981099128723145, "policy_loss": -0.01670212298631668, "vf_loss": 9.99755859375, "vf_explained_var": -9.62677063398587e-07, "kl": 0.017231740057468414, "entropy": 0.3562636375427246, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "sampler_results": {"episode_reward_max": 60386.90037536621, "episode_reward_min": 60386.90037536621, "episode_reward_mean": 60386.90037536621, "episode_len_mean": 137.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60386.90037536621}, "policy_reward_max": {"agent_0": 60386.90037536621}, "policy_reward_mean": {"agent_0": 60386.90037536621}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [60386.90037536621], "episode_lengths": [137], "policy_agent_0_reward": [60386.90037536621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.39330264097675, "mean_inference_ms": 7.091194679486485, "mean_action_processing_ms": 0.2026663587734187, "mean_env_wait_ms": 227.49264081386747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04889965057373047, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.19457340240478516}}, "episode_reward_max": 60386.90037536621, "episode_reward_min": 60386.90037536621, "episode_reward_mean": 60386.90037536621, "episode_len_mean": 137.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 60386.90037536621}, "policy_reward_max": {"agent_0": 60386.90037536621}, "policy_reward_mean": {"agent_0": 60386.90037536621}, "hist_stats": {"episode_reward": [60386.90037536621], "episode_lengths": [137], "policy_agent_0_reward": [60386.90037536621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.39330264097675, "mean_inference_ms": 7.091194679486485, "mean_action_processing_ms": 0.2026663587734187, "mean_env_wait_ms": 227.49264081386747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04889965057373047, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.19457340240478516}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000, "num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.7857166228507, "num_env_steps_trained_throughput_per_sec": 318.7857166228507, "timesteps_total": 1180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1180000, "timers": {"training_iteration_time_ms": 13821.712, "sample_time_ms": 10959.478, "learn_time_ms": 2713.423, "learn_throughput": 1474.153, "synch_weights_time_ms": 148.154}, "counters": {"num_env_steps_sampled": 1180000, "num_env_steps_trained": 1180000, "num_agent_steps_sampled": 1180000, "num_agent_steps_trained": 1180000}, "done": false, "episodes_total": 8620, "training_iteration": 295, "trial_id": "32397_00000", "date": "2025-03-21_09-48-13", "timestamp": 1742550493, "time_this_iter_s": 12.601816892623901, "time_total_s": 4252.154032230377, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f6aafd00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4252.154032230377, "iterations_since_restore": 295, "perf": {"cpu_util_percent": 99.59444444444446, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.95286750793457, "policy_loss": -0.017304202541708946, "vf_loss": 9.969970703125, "vf_explained_var": 3.5831084232995636e-07, "kl": 0.014247700572013855, "entropy": 0.3753184676170349, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "sampler_results": {"episode_reward_max": 58455.3600769043, "episode_reward_min": 49754.659852296114, "episode_reward_mean": 53449.76737751812, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 49754.659852296114}, "policy_reward_max": {"agent_0": 58455.3600769043}, "policy_reward_mean": {"agent_0": 53449.76737751812}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [50964.65363693237, 56621.2336730957, 56198.646657943726, 53515.666638851166, 49754.659852296114, 53263.6003742218, 58455.3600769043, 54825.733697891235, 52229.38015842438, 50117.79340171814, 55464.03355026245, 49986.446811676025], "episode_lengths": [135, 136, 136, 135, 133, 135, 136, 135, 135, 136, 137, 135], "policy_agent_0_reward": [50964.65363693237, 56621.2336730957, 56198.646657943726, 53515.666638851166, 49754.659852296114, 53263.6003742218, 58455.3600769043, 54825.733697891235, 52229.38015842438, 50117.79340171814, 55464.03355026245, 49986.446811676025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45386920369187, "mean_inference_ms": 6.440015047352369, "mean_action_processing_ms": 0.19790004243153358, "mean_env_wait_ms": 221.92994627423954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03968278566996256, "StateBufferConnector_ms": 0.0076830387115478516, "ViewRequirementAgentConnector_ms": 0.23794968922932944}}, "episode_reward_max": 58455.3600769043, "episode_reward_min": 49754.659852296114, "episode_reward_mean": 53449.76737751812, "episode_len_mean": 135.33333333333334, "episodes_this_iter": 12, "policy_reward_min": {"agent_0": 49754.659852296114}, "policy_reward_max": {"agent_0": 58455.3600769043}, "policy_reward_mean": {"agent_0": 53449.76737751812}, "hist_stats": {"episode_reward": [50964.65363693237, 56621.2336730957, 56198.646657943726, 53515.666638851166, 49754.659852296114, 53263.6003742218, 58455.3600769043, 54825.733697891235, 52229.38015842438, 50117.79340171814, 55464.03355026245, 49986.446811676025], "episode_lengths": [135, 136, 136, 135, 133, 135, 136, 135, 135, 136, 137, 135], "policy_agent_0_reward": [50964.65363693237, 56621.2336730957, 56198.646657943726, 53515.666638851166, 49754.659852296114, 53263.6003742218, 58455.3600769043, 54825.733697891235, 52229.38015842438, 50117.79340171814, 55464.03355026245, 49986.446811676025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45386920369187, "mean_inference_ms": 6.440015047352369, "mean_action_processing_ms": 0.19790004243153358, "mean_env_wait_ms": 221.92994627423954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03968278566996256, "StateBufferConnector_ms": 0.0076830387115478516, "ViewRequirementAgentConnector_ms": 0.23794968922932944}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.8250497788611, "num_env_steps_trained_throughput_per_sec": 327.8250497788611, "timesteps_total": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 13776.711, "sample_time_ms": 10951.753, "learn_time_ms": 2674.179, "learn_throughput": 1495.786, "synch_weights_time_ms": 150.089}, "counters": {"num_env_steps_sampled": 1184000, "num_env_steps_trained": 1184000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "episodes_total": 8632, "training_iteration": 296, "trial_id": "32397_00000", "date": "2025-03-21_09-48-25", "timestamp": 1742550505, "time_this_iter_s": 12.249879360198975, "time_total_s": 4264.403911590576, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8be3520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4264.403911590576, "iterations_since_restore": 296, "perf": {"cpu_util_percent": 99.45555555555555, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.046511627906977, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.766789436340332, "policy_loss": -0.017846228554844856, "vf_loss": 9.784424781799316, "vf_explained_var": 6.947666264522923e-08, "kl": 0.014971357770264149, "entropy": 0.3725053071975708, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 61700.20681762695, "episode_reward_min": 46422.873421669006, "episode_reward_mean": 55147.094263615996, "episode_len_mean": 135.61627906976744, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 46422.873421669006}, "policy_reward_max": {"agent_0": 61700.20681762695}, "policy_reward_mean": {"agent_0": 55147.094263615996}, "custom_metrics": {"num_batches_mean": 5.046511627906977, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [49680.87996864319, 56242.820320129395, 53554.62658691406, 59517.84017944336, 54163.0334148407, 56437.54009628296, 47519.68670129776, 58430.246810913086, 55159.46023750305, 54603.600257873535, 50058.486822128296, 49984.76038169861, 58885.81328582764, 55178.233501434326, 49291.13338470459, 54844.62018561363, 52866.8868970871, 57630.36016082764, 57391.026693344116, 57760.36015892029, 57543.15358352661, 59385.540714263916, 53493.91332054138, 61700.20681762695, 54164.666606903076, 52148.85338592529, 58231.40043258667, 51107.58010101318, 50634.00006842613, 54590.39370316267, 56496.73346328735, 58285.060108184814, 55577.327112197876, 54612.72675323486, 54699.90003967285, 53408.77337181568, 53052.993560791016, 53203.62014579773, 55305.34671783447, 53479.02007102966, 57245.14666938782, 56499.146728515625, 56281.75347137451, 57853.740158081055, 56848.57339477539, 60974.62030029297, 54041.14017486572, 56482.226486206055, 59292.98668670654, 59145.033294677734, 54602.36694097519, 58871.60007286072, 48542.53360462189, 55329.30000305176, 59149.34712982178, 53661.60680294037, 57662.17347717285, 55231.88021111488, 53151.37351226807, 58372.693298339844, 51112.04027175903, 59083.03358459473, 58535.607009887695, 57866.50693184137, 57029.7532119751, 52392.6736664772, 49659.50724411011, 55131.233390808105, 57343.7399597168, 46422.873421669006, 58717.35340881348, 58168.300216674805, 55368.38694381714, 57876.080070495605, 53409.80035972595, 52326.64658641815, 53611.69330024719, 53376.180267333984, 52868.73365020752, 49295.8602142334, 58083.92698287964, 52407.31329727173, 54262.42024612427, 56694.606704711914, 55116.52706718445, 56927.44012069702], "episode_lengths": [135, 135, 135, 137, 135, 136, 134, 137, 137, 135, 135, 135, 137, 136, 135, 135, 135, 135, 136, 136, 136, 137, 135, 137, 135, 136, 135, 134, 135, 136, 136, 136, 137, 135, 136, 135, 136, 136, 136, 134, 136, 136, 135, 135, 135, 137, 136, 136, 137, 137, 136, 137, 134, 134, 137, 136, 136, 136, 136, 136, 134, 137, 136, 138, 136, 135, 135, 135, 136, 134, 137, 135, 136, 136, 135, 136, 134, 135, 136, 134, 136, 134, 135, 135, 136, 135], "policy_agent_0_reward": [49680.87996864319, 56242.820320129395, 53554.62658691406, 59517.84017944336, 54163.0334148407, 56437.54009628296, 47519.68670129776, 58430.246810913086, 55159.46023750305, 54603.600257873535, 50058.486822128296, 49984.76038169861, 58885.81328582764, 55178.233501434326, 49291.13338470459, 54844.62018561363, 52866.8868970871, 57630.36016082764, 57391.026693344116, 57760.36015892029, 57543.15358352661, 59385.540714263916, 53493.91332054138, 61700.20681762695, 54164.666606903076, 52148.85338592529, 58231.40043258667, 51107.58010101318, 50634.00006842613, 54590.39370316267, 56496.73346328735, 58285.060108184814, 55577.327112197876, 54612.72675323486, 54699.90003967285, 53408.77337181568, 53052.993560791016, 53203.62014579773, 55305.34671783447, 53479.02007102966, 57245.14666938782, 56499.146728515625, 56281.75347137451, 57853.740158081055, 56848.57339477539, 60974.62030029297, 54041.14017486572, 56482.226486206055, 59292.98668670654, 59145.033294677734, 54602.36694097519, 58871.60007286072, 48542.53360462189, 55329.30000305176, 59149.34712982178, 53661.60680294037, 57662.17347717285, 55231.88021111488, 53151.37351226807, 58372.693298339844, 51112.04027175903, 59083.03358459473, 58535.607009887695, 57866.50693184137, 57029.7532119751, 52392.6736664772, 49659.50724411011, 55131.233390808105, 57343.7399597168, 46422.873421669006, 58717.35340881348, 58168.300216674805, 55368.38694381714, 57876.080070495605, 53409.80035972595, 52326.64658641815, 53611.69330024719, 53376.180267333984, 52868.73365020752, 49295.8602142334, 58083.92698287964, 52407.31329727173, 54262.42024612427, 56694.606704711914, 55116.52706718445, 56927.44012069702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.322101650745445, "mean_inference_ms": 6.657735063078939, "mean_action_processing_ms": 0.1968460791067004, "mean_env_wait_ms": 230.59149663375183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0529170036315918, "StateBufferConnector_ms": 0.005828779797221339, "ViewRequirementAgentConnector_ms": 0.21419331084850224}}, "episode_reward_max": 61700.20681762695, "episode_reward_min": 46422.873421669006, "episode_reward_mean": 55147.094263615996, "episode_len_mean": 135.61627906976744, "episodes_this_iter": 86, "policy_reward_min": {"agent_0": 46422.873421669006}, "policy_reward_max": {"agent_0": 61700.20681762695}, "policy_reward_mean": {"agent_0": 55147.094263615996}, "hist_stats": {"episode_reward": [49680.87996864319, 56242.820320129395, 53554.62658691406, 59517.84017944336, 54163.0334148407, 56437.54009628296, 47519.68670129776, 58430.246810913086, 55159.46023750305, 54603.600257873535, 50058.486822128296, 49984.76038169861, 58885.81328582764, 55178.233501434326, 49291.13338470459, 54844.62018561363, 52866.8868970871, 57630.36016082764, 57391.026693344116, 57760.36015892029, 57543.15358352661, 59385.540714263916, 53493.91332054138, 61700.20681762695, 54164.666606903076, 52148.85338592529, 58231.40043258667, 51107.58010101318, 50634.00006842613, 54590.39370316267, 56496.73346328735, 58285.060108184814, 55577.327112197876, 54612.72675323486, 54699.90003967285, 53408.77337181568, 53052.993560791016, 53203.62014579773, 55305.34671783447, 53479.02007102966, 57245.14666938782, 56499.146728515625, 56281.75347137451, 57853.740158081055, 56848.57339477539, 60974.62030029297, 54041.14017486572, 56482.226486206055, 59292.98668670654, 59145.033294677734, 54602.36694097519, 58871.60007286072, 48542.53360462189, 55329.30000305176, 59149.34712982178, 53661.60680294037, 57662.17347717285, 55231.88021111488, 53151.37351226807, 58372.693298339844, 51112.04027175903, 59083.03358459473, 58535.607009887695, 57866.50693184137, 57029.7532119751, 52392.6736664772, 49659.50724411011, 55131.233390808105, 57343.7399597168, 46422.873421669006, 58717.35340881348, 58168.300216674805, 55368.38694381714, 57876.080070495605, 53409.80035972595, 52326.64658641815, 53611.69330024719, 53376.180267333984, 52868.73365020752, 49295.8602142334, 58083.92698287964, 52407.31329727173, 54262.42024612427, 56694.606704711914, 55116.52706718445, 56927.44012069702], "episode_lengths": [135, 135, 135, 137, 135, 136, 134, 137, 137, 135, 135, 135, 137, 136, 135, 135, 135, 135, 136, 136, 136, 137, 135, 137, 135, 136, 135, 134, 135, 136, 136, 136, 137, 135, 136, 135, 136, 136, 136, 134, 136, 136, 135, 135, 135, 137, 136, 136, 137, 137, 136, 137, 134, 134, 137, 136, 136, 136, 136, 136, 134, 137, 136, 138, 136, 135, 135, 135, 136, 134, 137, 135, 136, 136, 135, 136, 134, 135, 136, 134, 136, 134, 135, 135, 136, 135], "policy_agent_0_reward": [49680.87996864319, 56242.820320129395, 53554.62658691406, 59517.84017944336, 54163.0334148407, 56437.54009628296, 47519.68670129776, 58430.246810913086, 55159.46023750305, 54603.600257873535, 50058.486822128296, 49984.76038169861, 58885.81328582764, 55178.233501434326, 49291.13338470459, 54844.62018561363, 52866.8868970871, 57630.36016082764, 57391.026693344116, 57760.36015892029, 57543.15358352661, 59385.540714263916, 53493.91332054138, 61700.20681762695, 54164.666606903076, 52148.85338592529, 58231.40043258667, 51107.58010101318, 50634.00006842613, 54590.39370316267, 56496.73346328735, 58285.060108184814, 55577.327112197876, 54612.72675323486, 54699.90003967285, 53408.77337181568, 53052.993560791016, 53203.62014579773, 55305.34671783447, 53479.02007102966, 57245.14666938782, 56499.146728515625, 56281.75347137451, 57853.740158081055, 56848.57339477539, 60974.62030029297, 54041.14017486572, 56482.226486206055, 59292.98668670654, 59145.033294677734, 54602.36694097519, 58871.60007286072, 48542.53360462189, 55329.30000305176, 59149.34712982178, 53661.60680294037, 57662.17347717285, 55231.88021111488, 53151.37351226807, 58372.693298339844, 51112.04027175903, 59083.03358459473, 58535.607009887695, 57866.50693184137, 57029.7532119751, 52392.6736664772, 49659.50724411011, 55131.233390808105, 57343.7399597168, 46422.873421669006, 58717.35340881348, 58168.300216674805, 55368.38694381714, 57876.080070495605, 53409.80035972595, 52326.64658641815, 53611.69330024719, 53376.180267333984, 52868.73365020752, 49295.8602142334, 58083.92698287964, 52407.31329727173, 54262.42024612427, 56694.606704711914, 55116.52706718445, 56927.44012069702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.322101650745445, "mean_inference_ms": 6.657735063078939, "mean_action_processing_ms": 0.1968460791067004, "mean_env_wait_ms": 230.59149663375183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0529170036315918, "StateBufferConnector_ms": 0.005828779797221339, "ViewRequirementAgentConnector_ms": 0.21419331084850224}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.42882435108316, "num_env_steps_trained_throughput_per_sec": 242.42882435108316, "timesteps_total": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 14085.372, "sample_time_ms": 11340.813, "learn_time_ms": 2597.549, "learn_throughput": 1539.913, "synch_weights_time_ms": 146.317}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 8718, "training_iteration": 297, "trial_id": "32397_00000", "date": "2025-03-21_09-48-42", "timestamp": 1742550522, "time_this_iter_s": 16.54995107650757, "time_total_s": 4280.953862667084, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8ed79a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4280.953862667084, "iterations_since_restore": 297, "perf": {"cpu_util_percent": 97.74545454545455, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 5.615384615384615, "num_batches_min": 5, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.916378021240234, "policy_loss": -0.016458800062537193, "vf_loss": 9.932618141174316, "vf_explained_var": 4.307677272663568e-07, "kl": 0.015486542135477066, "entropy": 0.36640262603759766, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "sampler_results": {"episode_reward_max": 61657.360443115234, "episode_reward_min": 43904.04017353058, "episode_reward_mean": 54579.22943144234, "episode_len_mean": 135.30769230769232, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 43904.04017353058}, "policy_reward_max": {"agent_0": 61657.360443115234}, "policy_reward_mean": {"agent_0": 54579.22943144234}, "custom_metrics": {"num_batches_mean": 5.615384615384615, "num_batches_min": 5, "num_batches_max": 6}, "hist_stats": {"episode_reward": [57538.90007972717, 53650.966720581055, 48984.97357416153, 56099.706802368164, 54782.52037525177, 58185.03323364258, 56601.98659515381, 56647.18037414551, 43904.04017353058, 53103.59348297119, 56025.30701351166, 53075.680391311646, 60493.51333618164, 53817.78013896942, 53912.773849487305, 52886.980068326, 51086.40007019043, 58500.066999703646, 57844.56681060791, 61657.360443115234, 54438.68673706055, 49586.420010089874, 46608.60685920715, 57109.20718002319, 55616.74032640457, 56900.973571777344], "episode_lengths": [136, 136, 134, 136, 135, 137, 136, 135, 134, 134, 136, 134, 137, 136, 135, 135, 135, 138, 134, 138, 133, 134, 134, 135, 136, 135], "policy_agent_0_reward": [57538.90007972717, 53650.966720581055, 48984.97357416153, 56099.706802368164, 54782.52037525177, 58185.03323364258, 56601.98659515381, 56647.18037414551, 43904.04017353058, 53103.59348297119, 56025.30701351166, 53075.680391311646, 60493.51333618164, 53817.78013896942, 53912.773849487305, 52886.980068326, 51086.40007019043, 58500.066999703646, 57844.56681060791, 61657.360443115234, 54438.68673706055, 49586.420010089874, 46608.60685920715, 57109.20718002319, 55616.74032640457, 56900.973571777344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.67564245573789, "mean_inference_ms": 6.720356522349811, "mean_action_processing_ms": 0.19529334147750047, "mean_env_wait_ms": 229.8995659297716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057138846470759466, "StateBufferConnector_ms": 0.005999895242544321, "ViewRequirementAgentConnector_ms": 0.21106463212233323}}, "episode_reward_max": 61657.360443115234, "episode_reward_min": 43904.04017353058, "episode_reward_mean": 54579.22943144234, "episode_len_mean": 135.30769230769232, "episodes_this_iter": 26, "policy_reward_min": {"agent_0": 43904.04017353058}, "policy_reward_max": {"agent_0": 61657.360443115234}, "policy_reward_mean": {"agent_0": 54579.22943144234}, "hist_stats": {"episode_reward": [57538.90007972717, 53650.966720581055, 48984.97357416153, 56099.706802368164, 54782.52037525177, 58185.03323364258, 56601.98659515381, 56647.18037414551, 43904.04017353058, 53103.59348297119, 56025.30701351166, 53075.680391311646, 60493.51333618164, 53817.78013896942, 53912.773849487305, 52886.980068326, 51086.40007019043, 58500.066999703646, 57844.56681060791, 61657.360443115234, 54438.68673706055, 49586.420010089874, 46608.60685920715, 57109.20718002319, 55616.74032640457, 56900.973571777344], "episode_lengths": [136, 136, 134, 136, 135, 137, 136, 135, 134, 134, 136, 134, 137, 136, 135, 135, 135, 138, 134, 138, 133, 134, 134, 135, 136, 135], "policy_agent_0_reward": [57538.90007972717, 53650.966720581055, 48984.97357416153, 56099.706802368164, 54782.52037525177, 58185.03323364258, 56601.98659515381, 56647.18037414551, 43904.04017353058, 53103.59348297119, 56025.30701351166, 53075.680391311646, 60493.51333618164, 53817.78013896942, 53912.773849487305, 52886.980068326, 51086.40007019043, 58500.066999703646, 57844.56681060791, 61657.360443115234, 54438.68673706055, 49586.420010089874, 46608.60685920715, 57109.20718002319, 55616.74032640457, 56900.973571777344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.67564245573789, "mean_inference_ms": 6.720356522349811, "mean_action_processing_ms": 0.19529334147750047, "mean_env_wait_ms": 229.8995659297716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057138846470759466, "StateBufferConnector_ms": 0.005999895242544321, "ViewRequirementAgentConnector_ms": 0.21106463212233323}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000, "num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.4055270181961, "num_env_steps_trained_throughput_per_sec": 271.4055270181961, "timesteps_total": 1192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1192000, "timers": {"training_iteration_time_ms": 14137.726, "sample_time_ms": 11443.6, "learn_time_ms": 2552.5, "learn_throughput": 1567.091, "synch_weights_time_ms": 140.924}, "counters": {"num_env_steps_sampled": 1192000, "num_env_steps_trained": 1192000, "num_agent_steps_sampled": 1192000, "num_agent_steps_trained": 1192000}, "done": false, "episodes_total": 8744, "training_iteration": 298, "trial_id": "32397_00000", "date": "2025-03-21_09-48-57", "timestamp": 1742550537, "time_this_iter_s": 14.79696798324585, "time_total_s": 4295.75083065033, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4295.75083065033, "iterations_since_restore": 298, "perf": {"cpu_util_percent": 99.28095238095239, "ram_util_percent": 13.600000000000001}}
{"custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.985411643981934, "policy_loss": -0.014800909906625748, "vf_loss": 10.0, "vf_explained_var": 5.966673199964134e-08, "kl": 0.015130952931940556, "entropy": 0.3567810654640198, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000}, "sampler_results": {"episode_reward_max": 56900.973571777344, "episode_reward_min": 56900.973571777344, "episode_reward_mean": 56900.973571777344, "episode_len_mean": 135.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56900.973571777344}, "policy_reward_max": {"agent_0": 56900.973571777344}, "policy_reward_mean": {"agent_0": 56900.973571777344}, "custom_metrics": {"num_batches_mean": 6.0, "num_batches_min": 6, "num_batches_max": 6}, "hist_stats": {"episode_reward": [56900.973571777344], "episode_lengths": [135], "policy_agent_0_reward": [56900.973571777344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.82567039030558, "mean_inference_ms": 6.941637178380821, "mean_action_processing_ms": 0.194182020445171, "mean_env_wait_ms": 232.8785405514487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030088424682617188, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1437664031982422}}, "episode_reward_max": 56900.973571777344, "episode_reward_min": 56900.973571777344, "episode_reward_mean": 56900.973571777344, "episode_len_mean": 135.0, "episodes_this_iter": 0, "policy_reward_min": {"agent_0": 56900.973571777344}, "policy_reward_max": {"agent_0": 56900.973571777344}, "policy_reward_mean": {"agent_0": 56900.973571777344}, "hist_stats": {"episode_reward": [56900.973571777344], "episode_lengths": [135], "policy_agent_0_reward": [56900.973571777344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.82567039030558, "mean_inference_ms": 6.941637178380821, "mean_action_processing_ms": 0.194182020445171, "mean_env_wait_ms": 232.8785405514487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030088424682617188, "StateBufferConnector_ms": 0.0057697296142578125, "ViewRequirementAgentConnector_ms": 0.1437664031982422}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000, "num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.2281549997882, "num_env_steps_trained_throughput_per_sec": 296.2281549997882, "timesteps_total": 1196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1196000, "timers": {"training_iteration_time_ms": 13867.088, "sample_time_ms": 11076.842, "learn_time_ms": 2646.87, "learn_throughput": 1511.219, "synch_weights_time_ms": 142.668}, "counters": {"num_env_steps_sampled": 1196000, "num_env_steps_trained": 1196000, "num_agent_steps_sampled": 1196000, "num_agent_steps_trained": 1196000}, "done": false, "episodes_total": 8744, "training_iteration": 299, "trial_id": "32397_00000", "date": "2025-03-21_09-49-10", "timestamp": 1742550550, "time_this_iter_s": 13.563824892044067, "time_total_s": 4309.314655542374, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c97d00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4309.314655542374, "iterations_since_restore": 299, "perf": {"cpu_util_percent": 99.63157894736842, "ram_util_percent": 13.6}}
{"custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"cur_kl_coeff": 0.01406249962747097, "cur_lr": 4.999999873689376e-05, "total_loss": 9.971271514892578, "policy_loss": -0.019203832373023033, "vf_loss": 9.990234375, "vf_explained_var": 1.143664150049517e-07, "kl": 0.01714947633445263, "entropy": 0.3747689425945282, "entropy_coeff": 0.0, "model": {}}}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 55890.59323120117, "episode_reward_min": 47509.15348815918, "episode_reward_mean": 51409.828468322754, "episode_len_mean": 134.5, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 47509.15348815918}, "policy_reward_max": {"agent_0": 55890.59323120117}, "policy_reward_mean": {"agent_0": 51409.828468322754}, "custom_metrics": {"num_batches_mean": 5.0, "num_batches_min": 5, "num_batches_max": 5}, "hist_stats": {"episode_reward": [47757.56025886536, 55890.59323120117, 54482.00689506531, 47509.15348815918], "episode_lengths": [135, 135, 135, 133], "policy_agent_0_reward": [47757.56025886536, 55890.59323120117, 54482.00689506531, 47509.15348815918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20350704760446, "mean_inference_ms": 6.394028236210774, "mean_action_processing_ms": 0.1942153085832487, "mean_env_wait_ms": 221.52024051201803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04003643989562988, "StateBufferConnector_ms": 0.006735324859619141, "ViewRequirementAgentConnector_ms": 0.41888952255249023}}, "episode_reward_max": 55890.59323120117, "episode_reward_min": 47509.15348815918, "episode_reward_mean": 51409.828468322754, "episode_len_mean": 134.5, "episodes_this_iter": 4, "policy_reward_min": {"agent_0": 47509.15348815918}, "policy_reward_max": {"agent_0": 55890.59323120117}, "policy_reward_mean": {"agent_0": 51409.828468322754}, "hist_stats": {"episode_reward": [47757.56025886536, 55890.59323120117, 54482.00689506531, 47509.15348815918], "episode_lengths": [135, 135, 135, 133], "policy_agent_0_reward": [47757.56025886536, 55890.59323120117, 54482.00689506531, 47509.15348815918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.20350704760446, "mean_inference_ms": 6.394028236210774, "mean_action_processing_ms": 0.1942153085832487, "mean_env_wait_ms": 221.52024051201803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04003643989562988, "StateBufferConnector_ms": 0.006735324859619141, "ViewRequirementAgentConnector_ms": 0.41888952255249023}, "num_healthy_workers": 124, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2273291088403, "num_env_steps_trained_throughput_per_sec": 304.2273291088403, "timesteps_total": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 13920.188, "sample_time_ms": 11113.017, "learn_time_ms": 2661.796, "learn_throughput": 1502.745, "synch_weights_time_ms": 144.661}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": true, "episodes_total": 8748, "training_iteration": 300, "trial_id": "32397_00000", "date": "2025-03-21_09-49-23", "timestamp": 1742550563, "time_this_iter_s": 13.20191764831543, "time_total_s": 4322.516573190689, "pid": 2830265, "hostname": "cx31", "node_ip": "172.20.32.84", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "defiance", "env_config": {"num_agents": 1, "parallel": 124, "stepTime": "1000", "simTime": "150", "delay": "500", "seed": "1", "runId": 1}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function create_example_training_config.<locals>.policy_mapping_fn at 0x7f79f8c970a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 1, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('cellId': Box(1, 4, (1,), int64), 'rsrps': Box(-1, 97, (4,), int64), 'rsrqs': Box(-1, 34, (4,), int64))", "Box(1, 4, (1,), int64)", null]}, "callbacks": "<class 'defiance.model.agents.ray.DefianceCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "tf", "num_cpus_for_driver": 1, "num_workers": 124}, "time_since_restore": 4322.516573190689, "iterations_since_restore": 300, "perf": {"cpu_util_percent": 99.44210526315788, "ram_util_percent": 13.6}}
